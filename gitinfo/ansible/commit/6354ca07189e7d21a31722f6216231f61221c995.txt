commit 6354ca07189e7d21a31722f6216231f61221c995
Author: Rene Moser <mail@renemoser.net>
Date:   Fri Apr 24 19:16:42 2015 +0200

    cloudstack: add _has_changed() to utils
    
    Generic method to compare values in dict.

diff --git a/lib/ansible/module_utils/cloudstack.py b/lib/ansible/module_utils/cloudstack.py
index d98d00b76c..afffb061f5 100644
--- a/lib/ansible/module_utils/cloudstack.py
+++ b/lib/ansible/module_utils/cloudstack.py
@@ -69,6 +69,27 @@ class AnsibleCloudStack:
             self.cs = CloudStack(**read_config())
 
 
+    def _has_changed(self, want_dict, current_dict, only_keys=None):
+        for key, value in want_dict.iteritems():
+
+            # Optionally limit by a list of keys
+            if only_keys and key not in only_keys:
+                continue;
+
+            if key in current_dict:
+
+                # API returns string for int in some cases, just to make sure
+                if isinstance(value, int):
+                    current_dict[key] = int(current_dict[key])
+                elif isinstance(value, str):
+                    current_dict[key] = str(current_dict[key])
+
+                # Only need to detect a singe change, not every item
+                if value != current_dict[key]:
+                    return True
+        return False
+
+
     def _get_by_key(self, key=None, my_dict={}):
         if key:
             if key in my_dict:
