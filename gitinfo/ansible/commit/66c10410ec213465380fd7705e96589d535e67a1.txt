commit 66c10410ec213465380fd7705e96589d535e67a1
Author: Chris Gardner <chris_g_g@hotmail.com>
Date:   Tue May 28 22:36:09 2013 +0100

    Use kstat for Solaris CPU info

diff --git a/library/system/setup b/library/system/setup
index 23c2ebe8d6..a33d554920 100644
--- a/library/system/setup
+++ b/library/system/setup
@@ -655,13 +655,20 @@ class SunOSHardware(Hardware):
         return self.facts
 
     def get_cpu_facts(self):
-        rc, out, err = module.run_command("/usr/sbin/psrinfo -v")
+        rc, out, err = module.run_command("/usr/sbin/kstat cpu_info")
         self.facts['processor'] = []
         for line in out.split('\n'):
-            if 'processor operates' in line:
+            if len(line) < 1:
+                continue
+            data = line.split(None, 1)
+            key = data[0].strip()
+            # key "brand" works on Solaris 10
+            if key == 'brand':
                 if 'processor' not in self.facts:
                     self.facts['processor'] = []
-                self.facts['processor'].append(line.strip())
+                self.facts['processor'].append(data[1].strip())
+        # Counting cores on Solaris can be complicated. Leave as-is for now.
+        # https://blogs.oracle.com/mandalika/entry/solaris_show_me_the_cpu
         self.facts['processor_cores'] = 'NA'
         self.facts['processor_count'] = len(self.facts['processor'])
 
