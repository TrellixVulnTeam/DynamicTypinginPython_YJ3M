commit 3adddf48369dccc138169173f2172319a0370c60
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Thu Jul 24 20:57:03 2014 -0400

    Add another negative test for the parser logic.

diff --git a/test/integration/Makefile b/test/integration/Makefile
index 85d1bd2092..e2d0f8ee3b 100644
--- a/test/integration/Makefile
+++ b/test/integration/Makefile
@@ -22,6 +22,7 @@ parsing:
 	ansible-playbook bad_parsing.yml -i $(INVENTORY) -e @$(VARS_FILE) $(CREDENTIALS_ARG) -vvv $(TEST_FLAGS) --tags common,scenario1; [ $$? -eq 3 ]
 	ansible-playbook bad_parsing.yml -i $(INVENTORY) -e @$(VARS_FILE) $(CREDENTIALS_ARG) -vvv $(TEST_FLAGS) --tags common,scenario2; [ $$? -eq 3 ]
 	ansible-playbook bad_parsing.yml -i $(INVENTORY) -e @$(VARS_FILE) $(CREDENTIALS_ARG) -vvv $(TEST_FLAGS) --tags common,scenario3; [ $$? -eq 3 ]
+	ansible-playbook bad_parsing.yml -i $(INVENTORY) -e @$(VARS_FILE) $(CREDENTIALS_ARG) -vvv $(TEST_FLAGS) --tags common,scenario4; [ $$? -eq 3 ]
 	ansible-playbook good_parsing.yml -i $(INVENTORY) -e @$(VARS_FILE) $(CREDENTIALS_ARG) -v $(TEST_FLAGS)
 
 non_destructive:
diff --git a/test/integration/roles/test_bad_parsing/tasks/main.yml b/test/integration/roles/test_bad_parsing/tasks/main.yml
index e84878baa6..fae01f2ee9 100644
--- a/test/integration/roles/test_bad_parsing/tasks/main.yml
+++ b/test/integration/roles/test_bad_parsing/tasks/main.yml
@@ -20,8 +20,9 @@
 # otherwise ansible stops at the first one and we want to ensure STOP conditions for each
 
 - set_fact: 
-    test_file: "./ansible_test_file"  # FIXME, use set tempdir
+    test_file: "{{ output_dir }}/ansible_test_file"  # FIXME, use set tempdir
     test_input: "owner=test" 
+    bad_var: "{{ output_dir }}' owner=test"
     chdir: "mom chdir=/tmp"
   tags: common
 
@@ -43,3 +44,10 @@
   failed_when: False
   tags: scenario3
 
+- name: test that we can't go all Little Bobby Droptables on a quoted var to add more
+  file: "name={{ bad_var }}"
+  failed_when: False
+  tags: scenario4
+
+
+
