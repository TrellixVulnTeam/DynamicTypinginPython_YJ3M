commit 4d487112421dc8ed851ebf638a2a1b939e3403b8
Author: Adrien Verg√© <adrienverge@gmail.com>
Date:   Sat Jun 4 19:58:17 2016 +0200

    Fix YAML source and check it on Shippable (#15678)
    
    Fix YAML source and check it on Shippable

diff --git a/.yamllint b/.yamllint
new file mode 100644
index 0000000000..764780d44a
--- /dev/null
+++ b/.yamllint
@@ -0,0 +1,22 @@
+extends: default
+
+# Disable all cosmetic rules
+# (see https://github.com/ansible/ansible/pull/15470#issuecomment-214437876)
+# Only keep 'key-duplicates' and 'new-lines: {type: unix}' checks enabled.
+
+rules:
+  braces: disable
+  brackets: disable
+  colons: disable
+  commas: disable
+  comments: disable
+  comments-indentation: disable
+  document-start: disable
+  empty-lines: disable
+  hyphens: disable
+  indentation: disable
+  key-duplicates: enable
+  line-length: disable
+  new-line-at-end-of-file: disable
+  new-lines: {type: unix}
+  trailing-spaces: disable
diff --git a/shippable.yml b/shippable.yml
index dd79b3fbc9..0a7f3af3d0 100644
--- a/shippable.yml
+++ b/shippable.yml
@@ -2,7 +2,7 @@ language: python
 
 env:
   matrix:
-    - TEST=code-smell
+    - TEST=code-smell INSTALL_DEPS=1
 
 matrix:
   include:
diff --git a/test/integration/roles/test_rax_cdb/tasks/main.yml b/test/integration/roles/test_rax_cdb/tasks/main.yml
index 3ba86375d3..e6d22962e2 100644
--- a/test/integration/roles/test_rax_cdb/tasks/main.yml
+++ b/test/integration/roles/test_rax_cdb/tasks/main.yml
@@ -192,7 +192,6 @@
     volume: 3
     wait: true
     wait_timeout: "{{ rackspace_wait_timeout }}"
-    wait_timeout: 600
   register: rax_cdb
 
 - name: Validate rax_cdb resize volume 2
@@ -251,7 +250,6 @@
     flavor: 2
     wait: true
     wait_timeout: "{{ rackspace_wait_timeout }}"
-    wait_timeout: 600
   register: rax_cdb
 
 - name: Validate rax_cdb resize flavor 2
diff --git a/test/integration/test_environment.yml b/test/integration/test_environment.yml
index ce8d0ed435..35e17d513d 100644
--- a/test/integration/test_environment.yml
+++ b/test/integration/test_environment.yml
@@ -25,7 +25,6 @@
             - '"val1" in test_env2.stdout_lines'
 
 - hosts: testhost
-  tasks:
   vars:
     - test1:
         key1: val1
diff --git a/test/utils/shippable/code-smell.sh b/test/utils/shippable/code-smell.sh
index b88659a37e..7878aa55d7 100755
--- a/test/utils/shippable/code-smell.sh
+++ b/test/utils/shippable/code-smell.sh
@@ -2,8 +2,15 @@
 
 source_root=$(python -c "from os import path; print(path.abspath(path.join(path.dirname('$0'), '../../..')))")
 
+install_deps="${INSTALL_DEPS:-}"
+
 cd "${source_root}"
 
+if [ "${install_deps}" != "" ]; then
+    pip install yamllint
+fi
+
+yamllint .
 test/code-smell/replace-urlopen.sh .
 test/code-smell/use-compat-six.sh lib
 test/code-smell/boilerplate.sh
