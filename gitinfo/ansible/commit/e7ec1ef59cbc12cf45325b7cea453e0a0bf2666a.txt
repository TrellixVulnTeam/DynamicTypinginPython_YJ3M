commit e7ec1ef59cbc12cf45325b7cea453e0a0bf2666a
Author: Zim Kalinowski <zikalino@microsoft.com>
Date:   Tue Sep 4 15:56:10 2018 +0800

    adding tags to container instance (#45142)

diff --git a/lib/ansible/modules/cloud/azure/azure_rm_containerinstance.py b/lib/ansible/modules/cloud/azure/azure_rm_containerinstance.py
index 2ab58cb0b5..3f95e2f45b 100644
--- a/lib/ansible/modules/cloud/azure/azure_rm_containerinstance.py
+++ b/lib/ansible/modules/cloud/azure/azure_rm_containerinstance.py
@@ -97,6 +97,7 @@ options:
 
 extends_documentation_fragment:
     - azure
+    - azure_tags
 
 author:
     - "Zim Kalinowski (@zikalino)"
@@ -256,17 +257,19 @@ class AzureRMContainerInstance(AzureRMModuleBase):
 
         self.containers = None
 
+        self.tags = None
+
         self.results = dict(changed=False, state=dict())
         self.cgmodels = None
 
         super(AzureRMContainerInstance, self).__init__(derived_arg_spec=self.module_arg_spec,
                                                        supports_check_mode=True,
-                                                       supports_tags=False)
+                                                       supports_tags=True)
 
     def exec_module(self, **kwargs):
         """Main module execution method"""
 
-        for key in list(self.module_arg_spec.keys()):
+        for key in list(self.module_arg_spec.keys()) + ['tags']:
             setattr(self, key, kwargs[key])
 
         resource_group = None
@@ -300,6 +303,10 @@ class AzureRMContainerInstance(AzureRMModuleBase):
                 self.log("Container instance deleted")
             elif self.state == 'present':
                 self.log("Need to check if container group has to be deleted or may be updated")
+                update_tags, newtags = self.update_tags(response.get('tags', dict()))
+                if update_tags:
+                    self.tags = newtags
+
                 if self.force_update:
                     self.log('Deleting container instance before update')
                     if not self.check_mode:
@@ -375,7 +382,8 @@ class AzureRMContainerInstance(AzureRMModuleBase):
                                                   restart_policy=None,
                                                   ip_address=ip_address,
                                                   os_type=self.os_type,
-                                                  volumes=None)
+                                                  volumes=None,
+                                                  tags=self.tags)
 
         response = self.containerinstance_client.container_groups.create_or_update(resource_group_name=self.resource_group,
                                                                                    container_group_name=self.name,
