commit 754ef34acbd730d6d6f1446d3309452e16de0ebd
Author: Matthias Bertschy <matthias.bertschy@gmail.com>
Date:   Wed Aug 30 21:26:29 2017 +0200

    Add support for ! in parameters (#25891)
    
    Fixes #25684

diff --git a/lib/ansible/modules/system/iptables.py b/lib/ansible/modules/system/iptables.py
index a5725cde65..dbdd9a9823 100644
--- a/lib/ansible/modules/system/iptables.py
+++ b/lib/ansible/modules/system/iptables.py
@@ -365,7 +365,10 @@ def append_param(rule, param, flag, is_list):
             append_param(rule, item, flag, False)
     else:
         if param is not None:
-            rule.extend([flag, param])
+            if param[0] == '!':
+                rule.extend(['!', flag, param[1:]])
+            else:
+                rule.extend([flag, param])
 
 def append_tcp_flags(rule, param, flag):
     if param:
