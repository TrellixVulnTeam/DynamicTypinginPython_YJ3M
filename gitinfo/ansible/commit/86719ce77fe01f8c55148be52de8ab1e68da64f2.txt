commit 86719ce77fe01f8c55148be52de8ab1e68da64f2
Author: James Tanner <tanner.jc@gmail.com>
Date:   Thu Jan 2 16:17:24 2014 -0500

    Fixes #5040 setup module: do not add primary interface info to the secondary interface data

diff --git a/library/system/setup b/library/system/setup
index 816039469c..542280624e 100755
--- a/library/system/setup
+++ b/library/system/setup
@@ -1540,8 +1540,7 @@ class LinuxNetwork(Network):
                         iface = words[-1]
                         if iface != device:
                             interfaces[iface] = {}
-                            interfaces[iface].update(interfaces[device])
-                        if "ipv4_secondaries" not in interfaces[iface]:
+                        if not secondary and "ipv4_secondaries" not in interfaces[iface]:
                             interfaces[iface]["ipv4_secondaries"] = []
                         if not secondary or "ipv4" not in interfaces[iface]:
                             interfaces[iface]['ipv4'] = {'address': address,
@@ -1553,6 +1552,15 @@ class LinuxNetwork(Network):
                                 'netmask': netmask,
                                 'network': network,
                             })
+
+                        # add this secondary IP to the main device
+                        if secondary:
+                            interfaces[device]["ipv4_secondaries"].append({
+                                'address': address,
+                                'netmask': netmask,
+                                'network': network,
+                            })
+
                         # If this is the default address, update default_ipv4
                         if 'address' in default_ipv4 and default_ipv4['address'] == address:
                             default_ipv4['netmask'] = netmask
