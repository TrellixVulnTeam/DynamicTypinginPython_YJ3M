commit 498c27d09a5b8682a88fe1801050ba7355f1e561
Author: James Cammarata <jimi@sngx.net>
Date:   Thu Oct 22 11:06:47 2015 -0400

    Re-adding role_names magic variable
    
    Fixes #12863

diff --git a/lib/ansible/vars/__init__.py b/lib/ansible/vars/__init__.py
index a3c2e83245..b84747a49a 100644
--- a/lib/ansible/vars/__init__.py
+++ b/lib/ansible/vars/__init__.py
@@ -347,6 +347,9 @@ class VariableManager:
                     variables['hostvars'] = hostvars
                     variables['vars'] = hostvars[host.get_name()]
 
+        if play:
+            variables['role_names'] = [r._role_name for r in play.roles]
+
         if task:
             if task._role:
                 variables['role_path'] = task._role._role_path
