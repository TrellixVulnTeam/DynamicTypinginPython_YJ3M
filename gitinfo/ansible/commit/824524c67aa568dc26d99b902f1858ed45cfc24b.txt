commit 824524c67aa568dc26d99b902f1858ed45cfc24b
Author: Andrew Gaffney <andrew@agaffney.org>
Date:   Tue Jul 10 14:27:44 2018 -0500

    Display task banner before showing file diff (#42573)

diff --git a/lib/ansible/plugins/callback/default.py b/lib/ansible/plugins/callback/default.py
index bee9402d04..38622d0423 100644
--- a/lib/ansible/plugins/callback/default.py
+++ b/lib/ansible/plugins/callback/default.py
@@ -207,6 +207,9 @@ class CallbackModule(CallbackBase):
         self._display.banner(msg)
 
     def v2_on_file_diff(self, result):
+        if self._last_task_banner != result._task._uuid:
+            self._print_task_banner(result._task)
+
         if result._task.loop and 'results' in result._result:
             for res in result._result['results']:
                 if 'diff' in res and res['diff'] and res.get('changed', False):
