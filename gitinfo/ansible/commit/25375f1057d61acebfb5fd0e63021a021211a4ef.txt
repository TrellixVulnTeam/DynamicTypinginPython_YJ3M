commit 25375f1057d61acebfb5fd0e63021a021211a4ef
Author: Peter Sprygada <psprygada@ansible.com>
Date:   Mon Sep 19 12:32:37 2016 -0400

    adds exception handling to nxos_command for FailedConditionalError
    
    This adds exception handling as per ansible/ansible#17638 to the
    nxos_command module.

diff --git a/lib/ansible/modules/network/nxos/nxos_command.py b/lib/ansible/modules/network/nxos/nxos_command.py
index bcd7566dce..9dc01a913c 100644
--- a/lib/ansible/modules/network/nxos/nxos_command.py
+++ b/lib/ansible/modules/network/nxos/nxos_command.py
@@ -148,10 +148,14 @@ failed_conditions:
   type: list
   sample: ['...', '...']
 """
+import ansible.module_utils.nxos
+
 from ansible.module_utils.basic import get_exception
-from ansible.module_utils.netcli import CommandRunner, FailedConditionsError
+from ansible.module_utils.network import NetworkModule, NetworkError
+from ansible.module_utils.netcli import CommandRunner
+from ansible.module_utils.netcli import FailedConditionsError
+from ansible.module_utils.netcli import FailedConditionalError
 from ansible.module_utils.netcli import AddCommandError
-from ansible.module_utils.nxos import NetworkModule, NetworkError
 
 VALID_KEYS = ['command', 'output', 'prompt', 'response']
 
@@ -186,7 +190,6 @@ def main():
     )
 
     module = NetworkModule(argument_spec=spec,
-                           connect_on_load=False,
                            supports_check_mode=True)
 
     commands = list(parse_commands(module))
@@ -223,9 +226,12 @@ def main():
     except FailedConditionsError:
         exc = get_exception()
         module.fail_json(msg=str(exc), failed_conditions=exc.failed_conditions)
+    except FailedConditionalError:
+        exc = get_exception()
+        module.fail_json(msg=str(exc), failed_conditional=exc.failed_conditional)
     except NetworkError:
         exc = get_exception()
-        module.fail_json(msg=str(exc))
+        module.fail_json(msg=str(exc), **exc.kwargs)
 
     result = dict(changed=False)
 
