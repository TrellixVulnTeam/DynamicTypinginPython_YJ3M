commit 4e22677e7d49beeaeb7c7ab531799710873e3081
Author: Brian Coca <bcoca@ansible.com>
Date:   Mon Oct 9 15:22:15 2017 -0400

    revert namespaced facts changes to package/service
    
    fixes #31485

diff --git a/lib/ansible/plugins/action/package.py b/lib/ansible/plugins/action/package.py
index 4a20378497..97660028f9 100644
--- a/lib/ansible/plugins/action/package.py
+++ b/lib/ansible/plugins/action/package.py
@@ -43,9 +43,9 @@ class ActionModule(ActionBase):
         if module == 'auto':
             try:
                 if self._task.delegate_to:  # if we delegate, we should use delegated host's facts
-                    module = self._templar.template("{{hostvars['%s']['ansible_facts']['ansible_pkg_mgr']}}" % self._task.delegate_to)
+                    module = self._templar.template("{{hostvars['%s']['ansible_pkg_mgr']}}" % self._task.delegate_to)
                 else:
-                    module = self._templar.template('{{ansible_facts["ansible_pkg_mgr"]}}')
+                    module = self._templar.template('{{ansible_pkg_mgr}}')
             except:
                 pass  # could not get it from template!
 
diff --git a/lib/ansible/plugins/action/service.py b/lib/ansible/plugins/action/service.py
index d18c3fc4eb..dd0c796539 100644
--- a/lib/ansible/plugins/action/service.py
+++ b/lib/ansible/plugins/action/service.py
@@ -42,9 +42,9 @@ class ActionModule(ActionBase):
         if module == 'auto':
             try:
                 if self._task.delegate_to:  # if we delegate, we should use delegated host's facts
-                    module = self._templar.template("{{hostvars['%s']['ansible_facts']['ansible_service_mgr']}}" % self._task.delegate_to)
+                    module = self._templar.template("{{hostvars['%s']['ansible_service_mgr']}}" % self._task.delegate_to)
                 else:
-                    module = self._templar.template('{{ansible_facts["ansible_service_mgr"]}}')
+                    module = self._templar.template('{{ansible_service_mgr}}')
             except:
                 pass  # could not get it from template!
 
