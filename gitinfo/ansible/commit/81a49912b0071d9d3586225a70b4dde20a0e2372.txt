commit 81a49912b0071d9d3586225a70b4dde20a0e2372
Author: Matt Clay <matt@mystile.com>
Date:   Mon Jun 27 16:34:19 2016 -0700

    Pin yamllint to 1.2.2 to avoid issues in 1.3.0. (#16464)
    
    This also moves shippable test requirements to external files.

diff --git a/test/utils/shippable/code-smell-requirements.txt b/test/utils/shippable/code-smell-requirements.txt
new file mode 100644
index 0000000000..abbfc9d4dc
--- /dev/null
+++ b/test/utils/shippable/code-smell-requirements.txt
@@ -0,0 +1 @@
+yamllint==1.2.2
diff --git a/test/utils/shippable/code-smell.sh b/test/utils/shippable/code-smell.sh
index 7878aa55d7..3dcaafc174 100755
--- a/test/utils/shippable/code-smell.sh
+++ b/test/utils/shippable/code-smell.sh
@@ -7,7 +7,8 @@ install_deps="${INSTALL_DEPS:-}"
 cd "${source_root}"
 
 if [ "${install_deps}" != "" ]; then
-    pip install yamllint
+    pip install -r "${source_root}/test/utils/shippable/code-smell-requirements.txt" --upgrade
+    pip list
 fi
 
 yamllint .
diff --git a/test/utils/shippable/sanity-requirements.txt b/test/utils/shippable/sanity-requirements.txt
new file mode 100644
index 0000000000..094224a844
--- /dev/null
+++ b/test/utils/shippable/sanity-requirements.txt
@@ -0,0 +1,4 @@
+tox
+pyyaml
+jinja2
+setuptools
diff --git a/test/utils/shippable/sanity.sh b/test/utils/shippable/sanity.sh
index 707e5b5ddd..46bc367a24 100755
--- a/test/utils/shippable/sanity.sh
+++ b/test/utils/shippable/sanity.sh
@@ -15,13 +15,7 @@ if [ "${TOXENV}" = 'py24' ]; then
     python2.4 -m compileall -fq -x 'module_utils/(a10|rax|openstack|ec2|gce|docker_common|azure_rm_common|vca|vmware).py' lib/ansible/module_utils
 else
     if [ "${install_deps}" != "" ]; then
-        pip install \
-            tox \
-            pyyaml \
-            jinja2 \
-            setuptools \
-            --upgrade
-
+        pip install -r "${source_root}/test/utils/shippable/sanity-requirements.txt" --upgrade
         pip list
     fi
 
