commit 851d24809676916508ba9c463b3e0bea9295e941
Author: Abhijeet Kasurde <akasurde@redhat.com>
Date:   Fri Feb 8 10:14:04 2019 +0530

    VMware: do create VMDK for new VMs (#51753)
    
    While creating new VM, don't assume the VMDKs are present,
    create them as we attache the disk to VM.
    
    Possible regression fix for introduced via #45953
    
    Signed-off-by: Abhijeet Kasurde <akasurde@redhat.com>

diff --git a/lib/ansible/modules/cloud/vmware/vmware_guest.py b/lib/ansible/modules/cloud/vmware/vmware_guest.py
index 66bac9a4a0..b5739c9fc5 100644
--- a/lib/ansible/modules/cloud/vmware/vmware_guest.py
+++ b/lib/ansible/modules/cloud/vmware/vmware_guest.py
@@ -1810,7 +1810,8 @@ class PyVmomiHelper(PyVmomi):
             if 'filename' in expected_disk_spec and expected_disk_spec['filename'] is not None:
                 self.add_existing_vmdk(vm_obj, expected_disk_spec, diskspec, scsi_ctl)
                 continue
-            else:
+            elif vm_obj is None:
+                # We are creating new VM
                 diskspec.fileOperation = vim.vm.device.VirtualDeviceSpec.FileOperation.create
 
             # which datastore?
