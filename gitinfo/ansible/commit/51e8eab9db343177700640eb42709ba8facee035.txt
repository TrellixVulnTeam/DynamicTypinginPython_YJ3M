commit 51e8eab9db343177700640eb42709ba8facee035
Author: Mike Wiebe <mwiebe@cisco.com>
Date:   Mon Mar 5 23:35:08 2018 -0500

    Fix n3k separate to combined image upgrade (#37017)
    
    * Fix n3k separate to combined image upgrade
    
    * Address review comments

diff --git a/lib/ansible/modules/network/nxos/nxos_install_os.py b/lib/ansible/modules/network/nxos/nxos_install_os.py
index 3b87b5403d..820b9f2f20 100644
--- a/lib/ansible/modules/network/nxos/nxos_install_os.py
+++ b/lib/ansible/modules/network/nxos/nxos_install_os.py
@@ -383,6 +383,7 @@ def build_install_cmd_set(issu, image, kick, type):
     else:
         commands.append(
             '%s system %s kickstart %s' % (rootcmd, image, kick))
+
     return commands
 
 
@@ -452,7 +453,7 @@ def check_mode_nextgen(module, issu, image, kick=None):
         # The system may be busy from the previous call to check_mode so loop
         # until it's done.
         data = check_install_in_progress(module, commands, opts)
-    if re.search(r'No install all data found', data['raw']):
+    if data['server_error']:
         data['error'] = True
     return data
 
