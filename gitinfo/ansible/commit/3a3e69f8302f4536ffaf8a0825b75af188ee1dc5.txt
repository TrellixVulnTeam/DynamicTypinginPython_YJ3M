commit 3a3e69f8302f4536ffaf8a0825b75af188ee1dc5
Author: Jorge Ner√≠n <jnerin@gmail.com>
Date:   Mon Apr 25 15:22:00 2016 +0100

    Fix substituting dots for underscores when using ips (#15578)
    
    ec2.py was substituting the dots on ip addresses when not using hostnames like:
      "ec2": [
        "10_10_1_1",
    
    now it's:
      "ec2": [
        "10.10.1.1",

diff --git a/contrib/inventory/ec2.py b/contrib/inventory/ec2.py
index f0214b61f0..c5028d5206 100755
--- a/contrib/inventory/ec2.py
+++ b/contrib/inventory/ec2.py
@@ -668,8 +668,8 @@ class Ec2Inventory(object):
         # If we can't get a nice hostname, use the destination address
         if not hostname:
             hostname = dest
-
-        hostname = self.to_safe(hostname).lower()
+        else:
+            hostname = self.to_safe(hostname).lower()
 
         # if we only want to include hosts that match a pattern, skip those that don't
         if self.pattern_include and not self.pattern_include.match(hostname):
