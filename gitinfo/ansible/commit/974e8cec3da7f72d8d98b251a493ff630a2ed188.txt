commit 974e8cec3da7f72d8d98b251a493ff630a2ed188
Author: Gon√©ri Le Bouder <goneri@lebouder.net>
Date:   Tue Dec 3 11:17:06 2019 -0500

    prepare_vmware_tests: run test w/ just 1 vcsa (#65433)
    
    Add the ability to run test with just a VCSA instance. This allow us to
    test a subset of tests that don't need any ESXi nodes.

diff --git a/test/integration/targets/prepare_vmware_tests/tasks/init_real_lab.yml b/test/integration/targets/prepare_vmware_tests/tasks/init_real_lab.yml
index c4f31072b0..445005e18c 100644
--- a/test/integration/targets/prepare_vmware_tests/tasks/init_real_lab.yml
+++ b/test/integration/targets/prepare_vmware_tests/tasks/init_real_lab.yml
@@ -1,8 +1,4 @@
 ---
-- name: load vars
-  include_vars:
-    file: real_lab.yml
-
 - include_tasks: teardown.yml
 
 - when: setup_esxi_instance is not defined
diff --git a/test/integration/targets/prepare_vmware_tests/tasks/main.yml b/test/integration/targets/prepare_vmware_tests/tasks/main.yml
index 795b47dba6..c99d46990d 100644
--- a/test/integration/targets/prepare_vmware_tests/tasks/main.yml
+++ b/test/integration/targets/prepare_vmware_tests/tasks/main.yml
@@ -5,7 +5,17 @@
     file: common.yml
 
 - when: vcsim is not defined
-  include_tasks: init_real_lab.yml
+  block:
+  - when: esxi1_hostname is not defined and esxi2_hostname is not defined
+    include_vars:
+      file: vcenter_only.yml
+
+  - when: esxi1_hostname is defined and esxi2_hostname is defined
+    include_vars:
+      file: vcenter_with_2_nodes.yml
+
+  - when: vcsim is not defined
+    include_tasks: init_real_lab.yml
 
 - when: vcsim is defined
   include_tasks: init_vcsim.yml
diff --git a/test/integration/targets/prepare_vmware_tests/vars/vcenter_only.yml b/test/integration/targets/prepare_vmware_tests/vars/vcenter_only.yml
new file mode 100644
index 0000000000..58560b5619
--- /dev/null
+++ b/test/integration/targets/prepare_vmware_tests/vars/vcenter_only.yml
@@ -0,0 +1,6 @@
+---
+esxi_hosts: []
+infra:
+virtual_machines: []
+virtual_machines_in_cluster: []
+#esxi_password: ''
\ No newline at end of file
diff --git a/test/integration/targets/prepare_vmware_tests/vars/real_lab.yml b/test/integration/targets/prepare_vmware_tests/vars/vcenter_with_2_nodes.yml
similarity index 100%
rename from test/integration/targets/prepare_vmware_tests/vars/real_lab.yml
rename to test/integration/targets/prepare_vmware_tests/vars/vcenter_with_2_nodes.yml
