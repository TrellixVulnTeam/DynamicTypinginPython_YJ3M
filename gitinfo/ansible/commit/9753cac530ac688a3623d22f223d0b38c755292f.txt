commit 9753cac530ac688a3623d22f223d0b38c755292f
Author: Sergei Smolianinov <smolse@tutanota.de>
Date:   Wed Jun 15 03:37:26 2016 +0400

    Fix synchronize module incorrect remote host processing. (#15993)
    
    Fixes  #15539

diff --git a/lib/ansible/plugins/action/synchronize.py b/lib/ansible/plugins/action/synchronize.py
index 9c4ac64c5f..20d40e7eb2 100644
--- a/lib/ansible/plugins/action/synchronize.py
+++ b/lib/ansible/plugins/action/synchronize.py
@@ -85,7 +85,8 @@ class ActionModule(ActionBase):
             alternative ssh port to a vagrant host.)
         """
         transport = self._connection.transport
-        if host not in C.LOCALHOST or transport != "local":
+        if host not in C.LOCALHOST or transport != "local" or \
+                (host in C.LOCALHOST and not port_matches_localhost_port):
             if port_matches_localhost_port and host in C.LOCALHOST:
                 self._task.args['_substitute_controller'] = True
             return self._format_rsync_rsh_target(host, path, user)
