commit 129e998276177a8334e07d5e952c464b97611ad2
Author: Jill R <4121322+jillr@users.noreply.github.com>
Date:   Mon Aug 19 09:22:38 2019 -0700

    EC2: Don't count instances in 'shutting-down' as running (#60709)
    
    state: shutting-down is a precursor to terminated and should be treated
    as such for exact_count.
    Fixes #55955

diff --git a/lib/ansible/modules/cloud/amazon/ec2.py b/lib/ansible/modules/cloud/amazon/ec2.py
index 918918b587..45a81e0cd7 100644
--- a/lib/ansible/modules/cloud/amazon/ec2.py
+++ b/lib/ansible/modules/cloud/amazon/ec2.py
@@ -600,7 +600,7 @@ def find_running_instances_by_count_tag(module, ec2, vpc, count_tag, zone=None):
     for res in reservations:
         if hasattr(res, 'instances'):
             for inst in res.instances:
-                if inst.state == 'terminated':
+                if inst.state == 'terminated' or inst.state == 'shutting-down':
                     continue
                 instances.append(inst)
 
