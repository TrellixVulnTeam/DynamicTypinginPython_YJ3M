commit 492d777ad7fdef4e634034bad73761b8817ffbef
Author: Pilou <pierre-louis@libregerbil.fr>
Date:   Wed Dec 13 14:54:38 2017 +0100

    imc_rest: fail when requirement is missing (#33750)

diff --git a/lib/ansible/modules/remote_management/imc/imc_rest.py b/lib/ansible/modules/remote_management/imc/imc_rest.py
index c687848365..128b6da100 100644
--- a/lib/ansible/modules/remote_management/imc/imc_rest.py
+++ b/lib/ansible/modules/remote_management/imc/imc_rest.py
@@ -333,6 +333,12 @@ def main():
         mutually_exclusive=[['content', 'path']],
     )
 
+    if not HAS_LXML_ETREE:
+        module.fail_json(msg='module requires the lxml Python library installed on the managed host')
+
+    if not HAS_XMLJSON_COBRA:
+        module.fail_json(msg='module requires the xmljson (>= 0.1.8) Python library installed on the managed host')
+
     hostname = module.params['hostname']
     username = module.params['username']
     password = module.params['password']
