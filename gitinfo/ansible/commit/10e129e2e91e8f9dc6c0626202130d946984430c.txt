commit 10e129e2e91e8f9dc6c0626202130d946984430c
Author: Matt Martz <matt@sivel.net>
Date:   Thu Oct 25 12:25:02 2018 -0500

    Detect the socket path after starting the service. Fixes #47582

diff --git a/test/integration/targets/setup_mysql_db/tasks/main.yml b/test/integration/targets/setup_mysql_db/tasks/main.yml
index 22c3f0ec7b..8a667d9e0f 100644
--- a/test/integration/targets/setup_mysql_db/tasks/main.yml
+++ b/test/integration/targets/setup_mysql_db/tasks/main.yml
@@ -37,15 +37,6 @@
         - 'default{{ python_suffix }}.yml'
       paths: '../vars'
 
-- name: Detect socket path
-  shell: >
-          echo "show variables like 'socket'\G" | mysql | grep 'Value: ' | sed 's/[ ]\+Value: //'
-  register: _socket_path
-
-- name: Set socket path
-  set_fact:
-    mysql_socket: '{{ _socket_path["stdout"] }}'
-
 - name: install mysqldb_test rpm dependencies
   yum: name={{ item }} state=latest
   with_items: "{{mysql_packages}}"
@@ -82,3 +73,12 @@
 
 - name: start mysql_db service if not running
   service: name={{ mysql_service }} state=started
+
+- name: Detect socket path
+  shell: >
+          echo "show variables like 'socket'\G" | mysql | grep 'Value: ' | sed 's/[ ]\+Value: //'
+  register: _socket_path
+
+- name: Set socket path
+  set_fact:
+    mysql_socket: '{{ _socket_path["stdout"] }}'
