commit e0a77bb8d5fbaad8a8fc0db5f7c89cc7caf91ecc
Author: Andrea Tartaglia <me@andreatartaglia.com>
Date:   Fri Sep 16 16:19:43 2016 +0100

    Pass the absolute path to dirname when assigning basedir (#17457)
    
    * Pass the absolute path to dirname when assigning basedir
    
    If no path is specified when calling the playbook, os.path.dirname(playbook_path) returns ''
    This will cause failure when creating the retry file.
    
    Fixes #17456
    
    * Updated to use os.pathdirname(os.path.abspath())

diff --git a/lib/ansible/executor/playbook_executor.py b/lib/ansible/executor/playbook_executor.py
index 633affe6bc..39e95c2261 100644
--- a/lib/ansible/executor/playbook_executor.py
+++ b/lib/ansible/executor/playbook_executor.py
@@ -195,7 +195,7 @@ class PlaybookExecutor:
                             if C.RETRY_FILES_SAVE_PATH:
                                 basedir = C.shell_expand(C.RETRY_FILES_SAVE_PATH)
                             elif playbook_path:
-                                basedir = os.path.dirname(playbook_path)
+                                basedir = os.path.dirname(os.path.abspath(playbook_path))
                             else:
                                 basedir = '~/'
 
