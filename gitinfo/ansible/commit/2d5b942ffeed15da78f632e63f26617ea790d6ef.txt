commit 2d5b942ffeed15da78f632e63f26617ea790d6ef
Author: Petr Svoboda <petr@jatys.cz>
Date:   Thu Aug 1 11:59:06 2013 +0200

    Fix traceback in git module when version checkout fails
    
    "UnboundLocalError: local variable 'branch' referenced before assignment" is
    raised in git, line 282, in switch_version.
    
    Exception is raised when version is not branch and version checkout fails.
    E.g. when version is nonexistant commit.

diff --git a/library/source_control/git b/library/source_control/git
index a7417bf693..20e204c6ad 100644
--- a/library/source_control/git
+++ b/library/source_control/git
@@ -271,6 +271,7 @@ def switch_version(git_path, module, dest, remote, version):
                 cmd = "%s reset --hard %s/%s" % (git_path, remote, version)
         else:
             cmd = "%s checkout --force %s" % (git_path, version)
+        branch = version
     else:
         branch = get_head_branch(git_path, module, dest, remote)
         (rc, out, err) = module.run_command("%s checkout --force %s" % (git_path, branch))
