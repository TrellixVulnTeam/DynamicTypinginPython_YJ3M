commit c3f182bc9bf4cdc93b939a4005b9b8d8a3186bcd
Author: Augustus Kling <augustus.kling@gmail.com>
Date:   Mon Jan 20 00:11:01 2014 +0100

    Fix error reporting in case locale-gen fails on non-Ubuntu systems.

diff --git a/library/system/locale b/library/system/locale
index 577f34bc3e..81f33dec9c 100644
--- a/library/system/locale
+++ b/library/system/locale
@@ -70,7 +70,7 @@ def apply_change(targetState, name, encoding):
     
     localeGenExitValue = call("locale-gen")
     if localeGenExitValue!=0:
-        module.fail_json(msg="locale.gen failed to execute, it returned "+str(localeGenExitValue))
+        raise EnvironmentError(localeGenExitValue, "locale.gen failed to execute, it returned "+str(localeGenExitValue))
 
 def apply_change_ubuntu(targetState, name, encoding):
     """Create or remove locale.
