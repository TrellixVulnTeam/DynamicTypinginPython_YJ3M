commit cc95bc4935882f87853d2e7995674a7154866c6d
Author: Kei Nohguchi <kei@nohguchi.com>
Date:   Wed Nov 9 12:10:15 2016 -0800

    openvswitch_bridge: Check VLAN ID only under fake bridge (#3374)

diff --git a/lib/ansible/modules/extras/network/openvswitch_bridge.py b/lib/ansible/modules/extras/network/openvswitch_bridge.py
index fe48ca99a2..b52df601c2 100644
--- a/lib/ansible/modules/extras/network/openvswitch_bridge.py
+++ b/lib/ansible/modules/extras/network/openvswitch_bridge.py
@@ -101,11 +101,11 @@ class OVSBridge(object):
         self.timeout = module.params['timeout']
         self.fail_mode = module.params['fail_mode']
 
-        if self.parent and self.vlan is None:
-            self.module.fail_json(msg='VLAN id must be set when parent is defined')
-
-        if self.vlan < 0 or self.vlan > 4095:
-            self.module.fail_json(msg='Invalid VLAN ID (must be between 0 and 4095)')
+        if self.parent:
+            if self.vlan is None:
+                self.module.fail_json(msg='VLAN id must be set when parent is defined')
+            elif self.vlan < 0 or self.vlan > 4095:
+                self.module.fail_json(msg='Invalid VLAN ID (must be between 0 and 4095)')
 
     def _vsctl(self, command):
         '''Run ovs-vsctl command'''
