commit 64fa95ca1112d7db6ede6fe77cba89cf813c1b9a
Author: Marcus McCurdy <mmccurdy@50onred.com>
Date:   Mon Sep 2 11:14:40 2013 -0400

    Improves lineinfile's error checking
    
    Line in file would raise a TypeError exception if
    the 'line' key was in params, but its value was None.

diff --git a/library/files/lineinfile b/library/files/lineinfile
index 29ff9603fd..7dd38a3cf0 100644
--- a/library/files/lineinfile
+++ b/library/files/lineinfile
@@ -305,7 +305,7 @@ def main():
         module.fail_json(rc=256, msg='Destination %s is a directory !' % dest)
 
     if params['state'] == 'present':
-        if 'line' not in params:
+        if params.get('line') is None:
             module.fail_json(msg='line= is required with state=present')
 
         # Deal with the insertafter default value manually, to avoid errors
