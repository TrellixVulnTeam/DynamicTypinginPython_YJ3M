commit 08c5fe875bcd8abe03331e58a9150475073e9797
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Wed Aug 1 19:46:33 2012 -0400

    yell if input data for host or group vars are not hashes

diff --git a/lib/ansible/playbook/play.py b/lib/ansible/playbook/play.py
index d063b2a19d..f1e9fed1f6 100644
--- a/lib/ansible/playbook/play.py
+++ b/lib/ansible/playbook/play.py
@@ -224,10 +224,14 @@ class Play(object):
                     path = os.path.join(basedir, "group_vars/%s" % x)
                     if os.path.exists(path):
                         data = utils.parse_yaml_from_file(path)
+                        if type(data) != dict:
+                            raise errors.AnsibleError("%s must be stored as a dictionary/hash" % path)
                         self.playbook.SETUP_CACHE[host].update(data)
                 path = os.path.join(basedir, "host_vars/%s" % hostrec.name)
                 if os.path.exists(path):
                     data = utils.parse_yaml_from_file(path)
+                    if type(data) != dict:
+                        raise errors.AnsibleError("%s must be stored as a dictionary/hash" % path)
                     self.playbook.SETUP_CACHE[host].update(data)
 
         for filename in self.vars_files:
