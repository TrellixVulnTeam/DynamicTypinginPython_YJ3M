commit c64eed16fe593cc3685b0fff3a79c9a239b884b3
Author: Rene Moser <mail@renemoser.net>
Date:   Sat Nov 18 17:24:50 2017 +0100

    letsencrypt: update agreement default to newest gathered

diff --git a/lib/ansible/modules/web_infrastructure/letsencrypt.py b/lib/ansible/modules/web_infrastructure/letsencrypt.py
index 8731b46a60..e3bf02da4a 100644
--- a/lib/ansible/modules/web_infrastructure/letsencrypt.py
+++ b/lib/ansible/modules/web_infrastructure/letsencrypt.py
@@ -61,7 +61,7 @@ options:
     description:
       - "URI to a terms of service document you agree to when using the
          ACME service at C(acme_directory)."
-    default: 'https://letsencrypt.org/documents/LE-SA-v1.1.1-August-1-2016.pdf'
+      - Default is latest gathered from C(acme_directory) URL.
   challenge:
     description: The challenge to be performed.
     choices: [ 'http-01', 'dns-01', 'tls-sni-02']
@@ -305,11 +305,12 @@ class ACMEAccount(object):
     '''
     def __init__(self, module):
         self.module = module
-        self.agreement = module.params['agreement']
         self.key = module.params['account_key']
         self.email = module.params['account_email']
         self.data = module.params['data']
         self.directory = ACMEDirectory(module)
+        self.agreement = module.params['agreement'] or self.directory['meta']['terms-of-service']
+
         self.uri = None
         self.changed = False
 
@@ -791,7 +792,7 @@ def main():
             account_key=dict(required=True, type='path'),
             account_email=dict(required=False, default=None, type='str'),
             acme_directory=dict(required=False, default='https://acme-staging.api.letsencrypt.org/directory', type='str'),
-            agreement=dict(required=False, default='https://letsencrypt.org/documents/LE-SA-v1.1.1-August-1-2016.pdf', type='str'),
+            agreement=dict(required=False, type='str'),
             challenge=dict(required=False, default='http-01', choices=['http-01', 'dns-01', 'tls-sni-02'], type='str'),
             csr=dict(required=True, aliases=['src'], type='path'),
             data=dict(required=False, no_log=True, default=None, type='dict'),
