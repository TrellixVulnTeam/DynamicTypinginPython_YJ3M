commit c9556887728a1686033abc2a09e728aef6751abf
Author: Matt Clay <matt@mystile.com>
Date:   Thu Nov 10 21:47:12 2016 -0800

    Move ansible ad-hoc tests to integration targets.

diff --git a/test/integration/Makefile b/test/integration/Makefile
index 8226b2e9c5..83e7c066bd 100644
--- a/test/integration/Makefile
+++ b/test/integration/Makefile
@@ -27,7 +27,10 @@ UNAME := $(shell uname | tr '[:upper:]' '[:lower:]')
 
 all: other non_destructive destructive
 
-other: test_test_infra parsing test_var_blending test_var_precedence unicode test_templating_settings environment test_as includes blocks pull_run pull_no_127 pull_limit_inventory check_mode test_hash test_handlers test_group_by test_vault test_tags test_lookup_paths no_log test_gathering_facts test_binary_modules_posix test_hosts_field test_lookup_properties args
+other: ansible test_test_infra parsing test_var_blending test_var_precedence unicode test_templating_settings environment test_as includes blocks pull_run pull_no_127 pull_limit_inventory check_mode test_hash test_handlers test_group_by test_vault test_tags test_lookup_paths no_log test_gathering_facts test_binary_modules_posix test_hosts_field test_lookup_properties args
+
+ansible:
+	(cd targets/ansible && ./runme.sh $(TEST_FLAGS))
 
 test_test_infra:
 	(cd targets/test_infra && ./runme.sh $(TEST_FLAGS))
diff --git a/test/integration/targets/ansible/runme.sh b/test/integration/targets/ansible/runme.sh
new file mode 100755
index 0000000000..f38193d6bc
--- /dev/null
+++ b/test/integration/targets/ansible/runme.sh
@@ -0,0 +1,13 @@
+#!/usr/bin/env bash
+
+set -eux
+
+env
+
+which python
+python --version
+
+which ansible
+ansible --version
+ansible testhost -i ../../inventory -vvv -e "ansible_python_interpreter=$(which python)" -m ping
+ansible testhost -i ../../inventory -vvv -e "ansible_python_interpreter=$(which python)" -m setup
diff --git a/test/utils/shippable/sanity.sh b/test/utils/shippable/sanity.sh
index dfa641c92f..6fac904e9d 100755
--- a/test/utils/shippable/sanity.sh
+++ b/test/utils/shippable/sanity.sh
@@ -29,9 +29,4 @@ else
     coverage_file="${coverage_dir}/nosetests-coverage.xml"
 
     TOX_TESTENV_PASSENV=NOSETESTS NOSETESTS="nosetests --with-xunit --xunit-file='${xunit_file}' --cover-xml --cover-xml-file='${coverage_file}'" tox
-
-    source hacking/env-setup
-    python --version
-    ansible --version
-    ansible -m ping localhost
 fi
