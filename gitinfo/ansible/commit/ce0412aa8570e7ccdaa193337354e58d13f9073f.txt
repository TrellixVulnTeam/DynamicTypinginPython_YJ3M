commit ce0412aa8570e7ccdaa193337354e58d13f9073f
Author: Matt Davis <mdavis@ansible.com>
Date:   Tue Nov 29 14:19:51 2016 -0800

    Fix test failures in win_command/win_shell on Powershell 3
    
    Switched to use Exit-Json to avoid JSON escaping bugs in ConvertTo-Json formatter without -Compress option.

diff --git a/lib/ansible/modules/windows/win_command.ps1 b/lib/ansible/modules/windows/win_command.ps1
index 2a03b6a03d..316654b81d 100644
--- a/lib/ansible/modules/windows/win_command.ps1
+++ b/lib/ansible/modules/windows/win_command.ps1
@@ -158,4 +158,4 @@ $result.start = $start_datetime.ToString("yyyy-MM-dd hh:mm:ss.ffffff")
 $result.end = $end_datetime.ToString("yyyy-MM-dd hh:mm:ss.ffffff")
 $result.delta = $($end_datetime - $start_datetime).ToString("h\:mm\:ss\.ffffff")
 
-ConvertTo-Json -Depth 99 $result
+Exit-Json $result
diff --git a/lib/ansible/modules/windows/win_shell.ps1 b/lib/ansible/modules/windows/win_shell.ps1
index 850f2b9561..664858e52c 100644
--- a/lib/ansible/modules/windows/win_shell.ps1
+++ b/lib/ansible/modules/windows/win_shell.ps1
@@ -139,4 +139,4 @@ $result.start = $start_datetime.ToString("yyyy-MM-dd hh:mm:ss.ffffff")
 $result.end = $end_datetime.ToString("yyyy-MM-dd hh:mm:ss.ffffff")
 $result.delta = $($end_datetime - $start_datetime).ToString("h\:mm\:ss\.ffffff")
 
-ConvertTo-Json -Depth 99 $result
+Exit-Json $result
