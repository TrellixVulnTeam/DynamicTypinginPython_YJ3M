commit ac2046637510eed8e31ca0c88aebce3279f38070
Author: Martin Krizek <martin.krizek@gmail.com>
Date:   Wed Jun 10 19:12:11 2020 +0200

    Do not keep empty blocks after tag filtering (#69987)
    
    This prevents PlayIterator having to go through empty blocks
    that were created in filter_tagged_tasks. This should
    be a performance improvement for playbooks that mostly skip
    tasks with tags.
    
    ci_complete

diff --git a/changelogs/fragments/purge-empty-block.yml b/changelogs/fragments/purge-empty-block.yml
new file mode 100644
index 0000000000..448f6b73d9
--- /dev/null
+++ b/changelogs/fragments/purge-empty-block.yml
@@ -0,0 +1,2 @@
+bugfixes:
+  - Do not keep empty blocks in PlayIterator after skipping tasks with tags.
diff --git a/lib/ansible/playbook/block.py b/lib/ansible/playbook/block.py
index 71fde71500..5f766e0083 100644
--- a/lib/ansible/playbook/block.py
+++ b/lib/ansible/playbook/block.py
@@ -371,7 +371,9 @@ class Block(Base, Conditional, CollectionSearch, Taggable):
             tmp_list = []
             for task in target:
                 if isinstance(task, Block):
-                    tmp_list.append(evaluate_block(task))
+                    filtered_block = evaluate_block(task)
+                    if filtered_block.has_tasks():
+                        tmp_list.append(filtered_block)
                 elif (task.action == 'meta' or
                         (task.action == 'include' and task.evaluate_tags([], self._play.skip_tags, all_vars=all_vars)) or
                         task.evaluate_tags(self._play.only_tags, self._play.skip_tags, all_vars=all_vars)):
