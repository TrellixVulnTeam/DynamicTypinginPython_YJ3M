commit 2903033c1dc054f8f3e281f7a36ac8d458023994
Author: Rémy Léone <remy.leone@gmail.com>
Date:   Sun Oct 7 12:09:02 2018 +0200

    Add region parameters to sg (#46211)

diff --git a/lib/ansible/modules/cloud/scaleway/scaleway_security_group_facts.py b/lib/ansible/modules/cloud/scaleway/scaleway_security_group_facts.py
index a539c13250..524343647b 100644
--- a/lib/ansible/modules/cloud/scaleway/scaleway_security_group_facts.py
+++ b/lib/ansible/modules/cloud/scaleway/scaleway_security_group_facts.py
@@ -21,12 +21,24 @@ version_added: "2.7"
 author:
   - "Yanis Guenane (@Spredzy)"
   - "Remy Leone (@sieben)"
+options:
+  region:
+    version_added: "2.8"
+    description:
+     - Scaleway region to use (for example par1).
+    required: true
+    choices:
+      - ams1
+      - EMEA-NL-EVS
+      - par1
+      - EMEA-FR-PAR1
 extends_documentation_fragment: scaleway
 '''
 
 EXAMPLES = r'''
 - name: Gather Scaleway security groups facts
   scaleway_security_group_facts:
+    region: par1
 '''
 
 RETURN = r'''
@@ -56,7 +68,10 @@ scaleway_security_group_facts:
 
 from ansible.module_utils.basic import AnsibleModule
 from ansible.module_utils.scaleway import (
-    Scaleway, ScalewayException, scaleway_argument_spec
+    Scaleway,
+    ScalewayException,
+    scaleway_argument_spec,
+    SCALEWAY_LOCATION,
 )
 
 
@@ -66,10 +81,17 @@ class ScalewaySecurityGroupFacts(Scaleway):
         super(ScalewaySecurityGroupFacts, self).__init__(module)
         self.name = 'security_groups'
 
+        region = module.params["region"]
+        self.module.params['api_url'] = SCALEWAY_LOCATION[region]["api_endpoint"]
+
 
 def main():
+    argument_spec = scaleway_argument_spec()
+    argument_spec.update(dict(
+        region=dict(required=True, choices=SCALEWAY_LOCATION.keys()),
+    ))
     module = AnsibleModule(
-        argument_spec=scaleway_argument_spec(),
+        argument_spec=argument_spec,
         supports_check_mode=True,
     )
 
diff --git a/test/legacy/roles/scaleway_security_group_facts/tasks/main.yml b/test/legacy/roles/scaleway_security_group_facts/tasks/main.yml
index 6c2663949f..227b62efa2 100644
--- a/test/legacy/roles/scaleway_security_group_facts/tasks/main.yml
+++ b/test/legacy/roles/scaleway_security_group_facts/tasks/main.yml
@@ -1,5 +1,8 @@
+# SCW_API_KEY='XXX' ansible-playbook ./test/legacy/scaleway.yml --tags test_scaleway_security_group_facts
+
 - name: Get security group informations and register it in a variable
   scaleway_security_group_facts:
+    region: par1
   register: security_groups
 
 - name: Display security_groups variable
@@ -10,3 +13,17 @@
   assert:
     that:
       - security_groups is success
+
+- name: Get security group informations and register it in a variable (AMS1)
+  scaleway_security_group_facts:
+    region: ams1
+  register: ams1_security_groups
+
+- name: Display security_groups variable (AMS1)
+  debug:
+    var: ams1_security_groups
+
+- name: Ensure retrieval of security groups facts is success (AMS1)
+  assert:
+    that:
+      - ams1_security_groups is success
