commit b3ffcd7c6c2204faac070ba1363e096d101e3a13
Author: Hans-Joachim Kliemeck <git@kliemeck.de>
Date:   Fri Nov 20 09:08:42 2015 +0100

    fix race condition and missing property

diff --git a/lib/ansible/modules/extras/windows/win_updates.ps1 b/lib/ansible/modules/extras/windows/win_updates.ps1
index 3d5bc4c57c..890e3670d8 100644
--- a/lib/ansible/modules/extras/windows/win_updates.ps1
+++ b/lib/ansible/modules/extras/windows/win_updates.ps1
@@ -337,7 +337,7 @@ Function RunAsScheduledJob {
   $sw = [System.Diagnostics.Stopwatch]::StartNew()
 
   # NB: output from scheduled jobs is delayed after completion (including the sub-objects after the primary Output object is available)
-  While (($job.Output -eq $null -or -not $job.Output.Keys.Contains('job_output')) -and $sw.ElapsedMilliseconds -lt 15000) {
+  While (($job.Output -eq $null -or -not ($job.Output | Get-Member -Name Keys) -or -not $job.Output.Keys.Contains('job_output')) -and $sw.ElapsedMilliseconds -lt 15000) {
     Write-DebugLog "Waiting for job output to populate..."
     Start-Sleep -Milliseconds 500
   }
