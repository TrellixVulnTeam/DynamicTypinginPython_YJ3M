commit 062db03f99a8244b6c3878b6f5b750d3485538b8
Author: Peter Sprygada <psprygada@ansible.com>
Date:   Mon Jul 4 22:09:26 2016 -0400

    add get_config function to vyos shared module
    
    This adds a new shard function get_config to retrieve the device
    configuration either from module arguments or remotely from the
    device.

diff --git a/lib/ansible/module_utils/vyos.py b/lib/ansible/module_utils/vyos.py
index 1ae74b0900..5b8e11c580 100644
--- a/lib/ansible/module_utils/vyos.py
+++ b/lib/ansible/module_utils/vyos.py
@@ -17,6 +17,7 @@
 # along with Ansible.  If not, see <http://www.gnu.org/licenses/>.
 #
 
+import itertools
 import re
 
 from ansible.module_utils.network import NetworkError, get_module, get_exception
@@ -34,7 +35,12 @@ def argument_spec():
     )
 vyos_argument_spec = argument_spec()
 
-get_config = lambda x: x.params['config'] or x.config.get_config()
+def get_config(module):
+    if module.params['config']:
+        return module.params['config']
+    config = module.config.get_config()
+    module.params['config'] = config
+    return config
 
 def diff_config(candidate, config):
     updates = set()
@@ -112,8 +118,7 @@ class Cli(NetCli):
 
     def run_commands(self, commands, **kwargs):
         commands = to_list(commands)
-        response = self.execute([str(c) for c in commands])
-        return response
+        return self.execute([str(c) for c in commands])
 
     ### Config methods ###
 
