commit 3d032b9db96b24779b5895f3b13a85584fa9db03
Author: James Martin <jmartin@ansible.com>
Date:   Wed Mar 12 21:26:16 2014 -0400

    Fixes various typos introduced in a9017af2bb648930e27bab52de12f9983411778c.
    Fixes odd encoding problem with wait_for_service.

diff --git a/library/database/riak b/library/database/riak
index e1aedf25fb..7ba4df3ea3 100644
--- a/library/database/riak
+++ b/library/database/riak
@@ -124,9 +124,8 @@ def main():
         wait_for_handoffs=dict(default=False, type='int'),
         wait_for_ring=dict(default=False, type='int'),
         wait_for_service=dict(
-            required=False, default=None, choices=['kv'])
-        ),
-        validate_certs = dict(default='yes', type='bool'),
+            required=False, default=None, choices=['kv']),
+        validate_certs = dict(default='yes', type='bool'))
     )
 
 
@@ -137,6 +136,7 @@ def main():
     wait_for_handoffs = module.params.get('wait_for_handoffs')
     wait_for_ring = module.params.get('wait_for_ring')
     wait_for_service = module.params.get('wait_for_service')
+    validate_certs =  module.params.get('validate_certs')
 
 
     #make sure riak commands are on the path
@@ -231,7 +231,7 @@ def main():
                 module.fail_json(msg='Timeout waiting for handoffs.')
 
     if wait_for_service:
-        cmd = '%s wait_for_service riak_%s %s' % ( riak_admin_bin, wait_for_service, node_name)
+        cmd = [riak_admin_bin, 'wait_for_service', 'riak_%s' % wait_for_service, node_name ]
         rc, out, err = module.run_command(cmd)
         result['service'] = out
 
@@ -250,5 +250,6 @@ def main():
 
 # import module snippets
 from ansible.module_utils.basic import *
+from ansible.module_utils.urls import *
 
 main()
