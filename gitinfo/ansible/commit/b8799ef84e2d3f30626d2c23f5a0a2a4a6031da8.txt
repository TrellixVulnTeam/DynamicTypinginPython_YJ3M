commit b8799ef84e2d3f30626d2c23f5a0a2a4a6031da8
Author: Brian Coca <bcoca@users.noreply.github.com>
Date:   Mon Mar 4 14:47:38 2019 -0500

    improved nmap fix, updated as per fb (#53280)
    
    (cherry picked from commit 5280ae917c4a49df1bb4ff354885bc046e7ee397)

diff --git a/lib/ansible/plugins/inventory/nmap.py b/lib/ansible/plugins/inventory/nmap.py
index 72f2a140b4..5b1b5375cb 100644
--- a/lib/ansible/plugins/inventory/nmap.py
+++ b/lib/ansible/plugins/inventory/nmap.py
@@ -126,8 +126,13 @@ class InventoryModule(BaseInventoryPlugin, Constructable, Cacheable):
             host = None
             ip = None
             ports = []
-            for line in stdout.splitlines():
-                line = to_text(line)
+
+            try:
+                t_stdout = to_text(stdout, errors='surrogate_or_strict')
+            except UnicodeError as e:
+                raise AnsibleParserError('Invalid (non unicode) input returned: %s' % to_native(e))
+
+            for line in t_stdout.splitlines():
                 hits = self.find_host.match(line)
                 if hits:
                     if host is not None:
