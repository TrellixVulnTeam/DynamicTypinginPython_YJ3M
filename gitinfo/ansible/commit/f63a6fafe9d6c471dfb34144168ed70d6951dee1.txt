commit f63a6fafe9d6c471dfb34144168ed70d6951dee1
Author: Paul Durivage <pauldurivage@gmail.com>
Date:   Sat Oct 19 14:57:23 2013 -0500

    Move regions until after authentication; otherwise pyrax.regions is an empty tuple and no inventory is returned.

diff --git a/plugins/inventory/rax.py b/plugins/inventory/rax.py
index 9e7c906e2f..6836db61f6 100755
--- a/plugins/inventory/rax.py
+++ b/plugins/inventory/rax.py
@@ -86,6 +86,7 @@ examples:
 import sys
 import re
 import os
+
 import argparse
 import collections
 
@@ -192,6 +193,14 @@ def setup():
                              % (e.message, default_creds_file))
             sys.exit(1)
 
+    pyrax.set_setting('identity_type', 'rackspace')
+
+    try:
+        pyrax.set_credential_file(os.path.expanduser(creds_file))
+    except Exception, e:
+        sys.stderr.write("%s: %s\n" % (e, e.message))
+        sys.exit(1)
+
     regions = []
     for region in os.getenv('RAX_REGION', 'all').split(','):
         region = region.strip().upper()
@@ -204,14 +213,6 @@ def setup():
         elif region not in regions:
             regions.append(region)
 
-    pyrax.set_setting('identity_type', 'rackspace')
-
-    try:
-        pyrax.set_credential_file(os.path.expanduser(creds_file))
-    except Exception, e:
-        sys.stderr.write("%s: %s\n" % (e, e.message))
-        sys.exit(1)
-
     return regions
 
 
