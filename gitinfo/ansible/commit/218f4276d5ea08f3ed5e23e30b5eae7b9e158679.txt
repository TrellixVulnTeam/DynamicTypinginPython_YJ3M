commit 218f4276d5ea08f3ed5e23e30b5eae7b9e158679
Author: Gon√©ri Le Bouder <goneri@lebouder.net>
Date:   Tue Aug 13 15:19:45 2019 +0200

    vmware_drs_group: creates test vm properly
    
    Creates the test VMs with `prepare_vmware_test`. Before this commit,
    only one VM was created and the next step was failing because this was
    not matching the expected list of VMs.

diff --git a/test/integration/targets/vmware_drs_group/tasks/main.yml b/test/integration/targets/vmware_drs_group/tasks/main.yml
index b924cad152..071f9c0719 100644
--- a/test/integration/targets/vmware_drs_group/tasks/main.yml
+++ b/test/integration/targets/vmware_drs_group/tasks/main.yml
@@ -7,31 +7,7 @@
   vars:
     setup_attach_host: true
     setup_datastore: true
-
-- name: Create VMs
-  vmware_guest:
-    hostname: "{{ vcenter_hostname }}"
-    username: "{{ vcenter_username }}"
-    password: "{{ vcenter_password }}"
-    datacenter: "{{ dc1 }}"
-    validate_certs: no
-    folder: '{{ f0 }}'
-    name: test_vm1
-    state: poweredoff
-    guest_id: debian8_64Guest
-    disk:
-    - size_gb: 1
-      type: thin
-      datastore: '{{ ds2 }}'
-    hardware:
-      memory_mb: 128
-      num_cpus: 1
-      scsi: paravirtual
-    cdrom:
-      type: iso
-      iso_path: "[{{ ds1 }}] fedora.iso"
-    networks:
-    - name: VM Network
+    setup_virtualmachines: true
 
 - name: Create DRS VM group
   vmware_drs_group:
