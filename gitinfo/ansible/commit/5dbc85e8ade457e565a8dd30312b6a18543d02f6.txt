commit 5dbc85e8ade457e565a8dd30312b6a18543d02f6
Author: Seth Vidal <skvidal@fedoraproject.org>
Date:   Fri Aug 24 13:51:07 2012 -0400

    fix up local_nvra

diff --git a/library/yum b/library/yum
index 671198a8e4..e2e4b149c9 100755
--- a/library/yum
+++ b/library/yum
@@ -188,7 +188,7 @@ def local_nvra(path):
     """return nvra of a local rpm passed in"""
     
     cmd = ['/bin/rpm', '-qp' ,'--qf', 
-            '%%{name}-%%{version}-%%{release}.%%{arch}\n', path ]
+            '%{name}-%{version}-%{release}.%{arch}\n', path ]
     rc, out, err = run(cmd)
     if rc != 0:
         return None
@@ -285,6 +285,10 @@ def install(module, items, repoq, yum_basecmd, conf_file):
         # localpkg
         if spec.endswith('.rpm'):
             # get the pkg name-v-r.arch
+            if not os.path.exists(spec):
+                res['msg'] += "No Package file matching '%s' found on system" % spec
+                module.fail_json(**res)
+
             nvra = local_nvra(spec)
             # look for them in the rpmdb
             if is_installed(repoq, nvra, conf_file):
