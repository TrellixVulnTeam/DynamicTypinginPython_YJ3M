commit 1906c05348a37646fe01b2d350753ab26b486dce
Author: Felix Fontein <felix@fontein.de>
Date:   Tue Aug 27 21:28:36 2019 +0200

    vertica_facts: rename to vertica_info (#60916)
    
    * Rename vertica_facts -> vertica_info
    
    * Add changelog.
    
    * Fix porting guide.

diff --git a/changelogs/fragments/60916-vertica_facts-info-rename.yml b/changelogs/fragments/60916-vertica_facts-info-rename.yml
new file mode 100644
index 0000000000..19a724ea12
--- /dev/null
+++ b/changelogs/fragments/60916-vertica_facts-info-rename.yml
@@ -0,0 +1,3 @@
+minor_changes:
+- The ``vertica_facts`` module has been renamed to ``vertica_info``.
+  When called with the new name, the module no longer returns ``ansible_facts``.
diff --git a/docs/docsite/rst/porting_guides/porting_guide_2.9.rst b/docs/docsite/rst/porting_guides/porting_guide_2.9.rst
index ea449577be..1a255e3ac5 100644
--- a/docs/docsite/rst/porting_guides/porting_guide_2.9.rst
+++ b/docs/docsite/rst/porting_guides/porting_guide_2.9.rst
@@ -435,6 +435,9 @@ be removed in Ansible 2.13. Please update update your playbooks accordingly.
   To access return values, :ref:`register a variable <registered_variables>`.
 * The ``redshift_facts`` module was renamed to :ref:`redshift_info <redshift_info_module>`.
 * The ``route53_facts`` module was renamed to :ref:`route53_info <route53_info_module>`.
+* The ``vertica_facts`` module was renamed to :ref:`vertica_info <vertica_info_module>`.
+  When called with the new name, the module no longer returns ``ansible_facts``.
+  To access return values, :ref:`register a variable <registered_variables>`.
 * The ``vmware_cluster_facts`` module was renamed to :ref:`vmware_cluster_info <vmware_cluster_info_module>`.
 * The ``vmware_datastore_facts`` module was renamed to :ref:`vmware_datastore_info <vmware_datastore_info_module>`.
 * The ``vmware_guest_facts`` module was renamed to :ref:`vmware_guest_info <vmware_guest_info_module>`.
diff --git a/lib/ansible/modules/database/vertica/_vertica_facts.py b/lib/ansible/modules/database/vertica/_vertica_facts.py
new file mode 120000
index 0000000000..bf964af0ae
--- /dev/null
+++ b/lib/ansible/modules/database/vertica/_vertica_facts.py
@@ -0,0 +1 @@
+vertica_info.py
\ No newline at end of file
diff --git a/lib/ansible/modules/database/vertica/vertica_facts.py b/lib/ansible/modules/database/vertica/vertica_info.py
similarity index 85%
rename from lib/ansible/modules/database/vertica/vertica_facts.py
rename to lib/ansible/modules/database/vertica/vertica_info.py
index 6f18e76421..18cc99c72d 100644
--- a/lib/ansible/modules/database/vertica/vertica_facts.py
+++ b/lib/ansible/modules/database/vertica/vertica_info.py
@@ -15,11 +15,13 @@ ANSIBLE_METADATA = {'metadata_version': '1.1',
 
 DOCUMENTATION = """
 ---
-module: vertica_facts
+module: vertica_info
 version_added: '2.0'
 short_description: Gathers Vertica database facts.
 description:
-  - Gathers Vertica database facts.
+  - Gathers Vertica database information.
+  - This module was called C(vertica_facts) before Ansible 2.9, returning C(ansible_facts).
+    Note that the M(vertica_info) module no longer returns C(ansible_facts)!
 options:
   cluster:
     description:
@@ -54,7 +56,12 @@ author: "Dariusz Owczarek (@dareko)"
 
 EXAMPLES = """
 - name: gathering vertica facts
-  vertica_facts: db=db_name
+  vertica_info: db=db_name
+  register: result
+
+- name: Print schemas
+  debug:
+    msg: "{{ result.vertica_schemas }}"
 """
 import traceback
 
@@ -227,6 +234,10 @@ def main():
             login_user=dict(default='dbadmin'),
             login_password=dict(default=None, no_log=True),
         ), supports_check_mode=True)
+    is_old_facts = module._name == 'vertica_facts'
+    if is_old_facts:
+        module.deprecate("The 'vertica_facts' module has been renamed to 'vertica_info', "
+                         "and the renamed one no longer returns ansible_facts", version='2.13')
 
     if not pyodbc_found:
         module.fail_json(msg=missing_required_lib('pyodbc'), exception=PYODBC_IMP_ERR)
@@ -257,12 +268,21 @@ def main():
         role_facts = get_role_facts(cursor)
         configuration_facts = get_configuration_facts(cursor)
         node_facts = get_node_facts(cursor)
-        module.exit_json(changed=False,
-                         ansible_facts={'vertica_schemas': schema_facts,
-                                        'vertica_users': user_facts,
-                                        'vertica_roles': role_facts,
-                                        'vertica_configuration': configuration_facts,
-                                        'vertica_nodes': node_facts})
+
+        if is_old_facts:
+            module.exit_json(changed=False,
+                             ansible_facts={'vertica_schemas': schema_facts,
+                                            'vertica_users': user_facts,
+                                            'vertica_roles': role_facts,
+                                            'vertica_configuration': configuration_facts,
+                                            'vertica_nodes': node_facts})
+        else:
+            module.exit_json(changed=False,
+                             vertica_schemas=schema_facts,
+                             vertica_users=user_facts,
+                             vertica_roles=role_facts,
+                             vertica_configuration=configuration_facts,
+                             vertica_nodes=node_facts)
     except NotSupportedError as e:
         module.fail_json(msg=to_native(e), exception=traceback.format_exc())
     except SystemExit:
diff --git a/test/sanity/ignore.txt b/test/sanity/ignore.txt
index f2073de69d..9f001bd6c2 100644
--- a/test/sanity/ignore.txt
+++ b/test/sanity/ignore.txt
@@ -2247,7 +2247,7 @@ lib/ansible/modules/database/proxysql/proxysql_scheduler.py validate-modules:E32
 lib/ansible/modules/database/proxysql/proxysql_scheduler.py validate-modules:E337
 lib/ansible/modules/database/proxysql/proxysql_scheduler.py validate-modules:E338
 lib/ansible/modules/database/vertica/vertica_configuration.py validate-modules:E338
-lib/ansible/modules/database/vertica/vertica_facts.py validate-modules:E338
+lib/ansible/modules/database/vertica/vertica_info.py validate-modules:E338
 lib/ansible/modules/database/vertica/vertica_role.py validate-modules:E322
 lib/ansible/modules/database/vertica/vertica_role.py validate-modules:E338
 lib/ansible/modules/database/vertica/vertica_schema.py validate-modules:E322
