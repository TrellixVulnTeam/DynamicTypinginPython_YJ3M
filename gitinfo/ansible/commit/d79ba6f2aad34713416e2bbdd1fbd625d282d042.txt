commit d79ba6f2aad34713416e2bbdd1fbd625d282d042
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Sat Jul 28 17:07:55 2012 -0400

    Port the ohai module over, while this is actually *longer* now, not transferring the args file makes this much
    faster.

diff --git a/library/ohai b/library/ohai
index e4cf027265..b0e8fb4bbf 100755
--- a/library/ohai
+++ b/library/ohai
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!/usr/bin/python
 
 # (c) 2012, Michael DeHaan <michael.dehaan@gmail.com>
 #
@@ -18,5 +18,30 @@
 # along with Ansible.  If not, see <http://www.gnu.org/licenses/>.
 #
 
-/usr/bin/logger -t ansible-ohai Invoked as-is
-/usr/bin/ohai
+import subprocess
+
+def get_facter_data():
+
+    p = subprocess.Popen(["/usr/bin/env", "ohai"], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
+    (out, err) = p.communicate()
+    rc = p.returncode
+    return rc, out, err
+
+def main():
+
+    module = AnsibleModule(
+        argument_spec = dict()
+    )
+
+    rc, out, err = get_facter_data()
+    if rc != 0:
+       module.fail_json(msg=err)
+    else:
+       module.exit_json(**json.loads(out))
+
+# this is magic, see lib/ansible/module_common.py
+#<<INCLUDE_ANSIBLE_MODULE_COMMON>>
+
+main()
+
+
