commit 3b42b1796c8e282d3159f04812f2666c1fc0ad2d
Author: Martin Krizek <martin.krizek@gmail.com>
Date:   Thu Jan 17 09:47:16 2019 +0100

    facts: set virtualization_role for KVM hosts (#50770)
    
    * facts: set virtualization_role for KVM hosts
    
    Fixes #49734
    
    * Add changelog

diff --git a/changelogs/fragments/49734-facts-set-virtualization_role-for-kvm-hosts.yaml b/changelogs/fragments/49734-facts-set-virtualization_role-for-kvm-hosts.yaml
new file mode 100644
index 0000000000..d3688fc039
--- /dev/null
+++ b/changelogs/fragments/49734-facts-set-virtualization_role-for-kvm-hosts.yaml
@@ -0,0 +1,2 @@
+bugfixes:
+  - facts - set virtualization_role for KVM hosts (https://github.com/ansible/ansible/issues/49734)
diff --git a/lib/ansible/module_utils/facts/virtual/linux.py b/lib/ansible/module_utils/facts/virtual/linux.py
index 420b2d3ac9..e8a5587705 100644
--- a/lib/ansible/module_utils/facts/virtual/linux.py
+++ b/lib/ansible/module_utils/facts/virtual/linux.py
@@ -189,9 +189,10 @@ class LinuxVirtual(Virtual):
                 modules.append(data[0])
 
             if 'kvm' in modules:
+                virtual_facts['virtualization_type'] = 'kvm'
+                virtual_facts['virtualization_role'] = 'host'
 
                 if os.path.isdir('/rhev/'):
-
                     # Check whether this is a RHEV hypervisor (is vdsm running ?)
                     for f in glob.glob('/proc/[0-9]*/comm'):
                         try:
@@ -202,12 +203,6 @@ class LinuxVirtual(Virtual):
                                 break
                         except Exception:
                             pass
-                    else:
-                        virtual_facts['virtualization_type'] = 'kvm'
-
-                else:
-                    virtual_facts['virtualization_type'] = 'kvm'
-                    virtual_facts['virtualization_role'] = 'host'
 
                 return virtual_facts
 
