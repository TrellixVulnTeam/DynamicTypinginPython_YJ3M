commit 5c9241fa7c60f3aa731368971d4e0a481bbf63d6
Author: Zim Kalinowski <zikalino@microsoft.com>
Date:   Mon Sep 3 16:52:09 2018 +0800

    merge mysql server and database tests (#45060)

diff --git a/test/integration/targets/azure_rm_mysqldatabase/aliases b/test/integration/targets/azure_rm_mysqldatabase/aliases
deleted file mode 100644
index 021f5cf05b..0000000000
--- a/test/integration/targets/azure_rm_mysqldatabase/aliases
+++ /dev/null
@@ -1,3 +0,0 @@
-cloud/azure
-destructive
-shippable/azure/group4
diff --git a/test/integration/targets/azure_rm_mysqldatabase/meta/main.yml b/test/integration/targets/azure_rm_mysqldatabase/meta/main.yml
deleted file mode 100644
index 95e1952f98..0000000000
--- a/test/integration/targets/azure_rm_mysqldatabase/meta/main.yml
+++ /dev/null
@@ -1,2 +0,0 @@
-dependencies:
-  - setup_azure
diff --git a/test/integration/targets/azure_rm_mysqldatabase/tasks/main.yml b/test/integration/targets/azure_rm_mysqldatabase/tasks/main.yml
deleted file mode 100644
index 0ce025e6b6..0000000000
--- a/test/integration/targets/azure_rm_mysqldatabase/tasks/main.yml
+++ /dev/null
@@ -1,136 +0,0 @@
-- name: Prepare random number
-  set_fact:
-    rpfx: "{{ resource_group | hash('md5') | truncate(7, True, '') }}{{ 1000 | random }}"
-  run_once: yes
-
-- name: Create MySQL Server
-  azure_rm_mysqlserver:
-    resource_group: "{{ resource_group }}"
-    name: mysqlsrv{{ rpfx }}
-    sku:
-        name: GP_Gen4_2
-        tier: GeneralPurpose
-    location: westus
-    storage_mb: 51200
-    enforce_ssl: True
-    admin_username: zimxyz
-    admin_password: Testpasswordxyz12!
-
-- name: Create instance of MySQL Database -- check mode
-  azure_rm_mysqldatabase:
-    resource_group: "{{ resource_group }}"
-    server_name: mysqlsrv{{ rpfx }}
-    name: testdatabase
-  check_mode: yes
-  register: output
-- name: Assert the resource instance is well created
-  assert:
-    that:
-      - output.changed
-
-- name: Create instance of MySQL Database
-  azure_rm_mysqldatabase:
-    resource_group: "{{ resource_group }}"
-    server_name: mysqlsrv{{ rpfx }}
-    name: testdatabase
-  register: output
-- name: Assert the resource instance is well created
-  assert:
-    that:
-      - output.changed
-      - output.name == 'testdatabase'
-
-- name: Create again instance of MySQL Database
-  azure_rm_mysqldatabase:
-    resource_group: "{{ resource_group }}"
-    server_name: mysqlsrv{{ rpfx }}
-    name: testdatabase
-  register: output
-- name: Assert the state has not changed
-  assert:
-    that:
-      - output.changed == false
-      - output.name == 'testdatabase'
-
-- name: Create second instance of MySQL Database
-  azure_rm_mysqldatabase:
-    resource_group: "{{ resource_group }}"
-    server_name: mysqlsrv{{ rpfx }}
-    name: testdatabase2
-
-- name: Gather facts MySQL Database
-  azure_rm_mysqldatabase_facts:
-    resource_group: "{{ resource_group }}"
-    server_name: mysqlsrv{{ rpfx }}
-    name: testdatabase
-  register: output 
-
-- name: Assert that facts are returned
-  assert:
-    that:
-      - output.changed == False
-      - output.databases[0]['server_name'] != None
-      - output.databases[0]['name'] != None
-      - output.databases[0]['charset'] != None
-      - output.databases[0]['collation'] != None
-
-- name: Gather facts MySQL Database
-  azure_rm_mysqldatabase_facts:
-    resource_group: "{{ resource_group }}"
-    server_name: mysqlsrv{{ rpfx }}
-  register: output
-- name: Assert that facts are returned
-  assert:
-    that:
-      - output.changed == False
-      - output.databases[0]['server_name'] != None
-      - output.databases[0]['name'] != None
-      - output.databases[0]['charset'] != None
-      - output.databases[0]['collation'] != None
-      - output.databases[1]['server_name'] != None
-      - output.databases[1]['name'] != None
-      - output.databases[1]['charset'] != None
-      - output.databases[1]['collation'] != None
-
-- name: Delete instance of MySQL Database -- check mode
-  azure_rm_mysqldatabase:
-    resource_group: "{{ resource_group }}"
-    server_name: mysqlsrv{{ rpfx }}
-    name: testdatabase
-    state: absent
-  check_mode: yes
-  register: output
-- name: Assert the state has changed
-  assert:
-    that:
-      - output.changed
-
-- name: Delete instance of MySQL Database
-  azure_rm_mysqldatabase:
-    resource_group: "{{ resource_group }}"
-    server_name: mysqlsrv{{ rpfx }}
-    name: testdatabase
-    state: absent
-  register: output
-- name: Assert the state has changed
-  assert:
-    that:
-      - output.changed
-
-- name: Delete unexisting instance of MySQL Database
-  azure_rm_mysqldatabase:
-    resource_group: "{{ resource_group }}"
-    server_name: mysqlsrv{{ rpfx }}
-    name: testdatabase
-    state: absent
-  register: output
-- name: Assert the state has changed
-  assert:
-    that:
-      - output.changed == false
-
-- name: Delete instance of MySQL Server
-  azure_rm_mysqlserver:
-    resource_group: "{{ resource_group }}"
-    name: mysqlsrv{{ rpfx }}
-    state: absent
diff --git a/test/integration/targets/azure_rm_mysqlserver/aliases b/test/integration/targets/azure_rm_mysqlserver/aliases
index 438cb54762..de1f16d2ac 100644
--- a/test/integration/targets/azure_rm_mysqlserver/aliases
+++ b/test/integration/targets/azure_rm_mysqlserver/aliases
@@ -1,3 +1,6 @@
 cloud/azure
 destructive
 shippable/azure/group8
+azure_rm_mysqlserver_facts
+azure_rm_mysqldatabase
+azure_rm_mysqldatabase_facts
diff --git a/test/integration/targets/azure_rm_mysqlserver/tasks/main.yml b/test/integration/targets/azure_rm_mysqlserver/tasks/main.yml
index 75187badc0..c67c850fad 100644
--- a/test/integration/targets/azure_rm_mysqlserver/tasks/main.yml
+++ b/test/integration/targets/azure_rm_mysqlserver/tasks/main.yml
@@ -124,6 +124,125 @@
       - output.servers[1]['user_visible_state'] != None
       - output.servers[1]['fully_qualified_domain_name'] != None
 
+#
+# azure_rm_mysqldatabase tests below
+#
+- name: Create instance of MySQL Database -- check mode
+  azure_rm_mysqldatabase:
+    resource_group: "{{ resource_group }}"
+    server_name: mysqlsrv{{ rpfx }}
+    name: testdatabase
+  check_mode: yes
+  register: output
+- name: Assert the resource instance is well created
+  assert:
+    that:
+      - output.changed
+
+- name: Create instance of MySQL Database
+  azure_rm_mysqldatabase:
+    resource_group: "{{ resource_group }}"
+    server_name: mysqlsrv{{ rpfx }}
+    name: testdatabase
+  register: output
+- name: Assert the resource instance is well created
+  assert:
+    that:
+      - output.changed
+      - output.name == 'testdatabase'
+
+- name: Create again instance of MySQL Database
+  azure_rm_mysqldatabase:
+    resource_group: "{{ resource_group }}"
+    server_name: mysqlsrv{{ rpfx }}
+    name: testdatabase
+  register: output
+- name: Assert the state has not changed
+  assert:
+    that:
+      - output.changed == false
+      - output.name == 'testdatabase'
+
+- name: Create second instance of MySQL Database
+  azure_rm_mysqldatabase:
+    resource_group: "{{ resource_group }}"
+    server_name: mysqlsrv{{ rpfx }}
+    name: testdatabase2
+
+- name: Gather facts MySQL Database
+  azure_rm_mysqldatabase_facts:
+    resource_group: "{{ resource_group }}"
+    server_name: mysqlsrv{{ rpfx }}
+    name: testdatabase
+  register: output 
+
+- name: Assert that facts are returned
+  assert:
+    that:
+      - output.changed == False
+      - output.databases[0]['server_name'] != None
+      - output.databases[0]['name'] != None
+      - output.databases[0]['charset'] != None
+      - output.databases[0]['collation'] != None
+
+- name: Gather facts MySQL Database
+  azure_rm_mysqldatabase_facts:
+    resource_group: "{{ resource_group }}"
+    server_name: mysqlsrv{{ rpfx }}
+  register: output
+- name: Assert that facts are returned
+  assert:
+    that:
+      - output.changed == False
+      - output.databases[0]['server_name'] != None
+      - output.databases[0]['name'] != None
+      - output.databases[0]['charset'] != None
+      - output.databases[0]['collation'] != None
+      - output.databases[1]['server_name'] != None
+      - output.databases[1]['name'] != None
+      - output.databases[1]['charset'] != None
+      - output.databases[1]['collation'] != None
+
+- name: Delete instance of MySQL Database -- check mode
+  azure_rm_mysqldatabase:
+    resource_group: "{{ resource_group }}"
+    server_name: mysqlsrv{{ rpfx }}
+    name: testdatabase
+    state: absent
+  check_mode: yes
+  register: output
+- name: Assert the state has changed
+  assert:
+    that:
+      - output.changed
+
+- name: Delete instance of MySQL Database
+  azure_rm_mysqldatabase:
+    resource_group: "{{ resource_group }}"
+    server_name: mysqlsrv{{ rpfx }}
+    name: testdatabase
+    state: absent
+  register: output
+- name: Assert the state has changed
+  assert:
+    that:
+      - output.changed
+
+- name: Delete unexisting instance of MySQL Database
+  azure_rm_mysqldatabase:
+    resource_group: "{{ resource_group }}"
+    server_name: mysqlsrv{{ rpfx }}
+    name: testdatabase
+    state: absent
+  register: output
+- name: Assert the state has changed
+  assert:
+    that:
+      - output.changed == false
+
+#
+# clean up azure_rm_mysqlserver test
+#
 - name: Delete instance of MySQL Server -- check mode
   azure_rm_mysqlserver:
     resource_group: "{{ resource_group }}"
