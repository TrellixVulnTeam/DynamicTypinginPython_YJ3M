commit 59faad3a6b617d6e6a7f2bca18e7be26738c8edb
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Wed Feb 7 15:48:35 2018 -0800

    Fix var lookup plugin to return a list

diff --git a/lib/ansible/plugins/lookup/var.py b/lib/ansible/plugins/lookup/var.py
index 3cf9460ae2..954fdd53cc 100644
--- a/lib/ansible/plugins/lookup/var.py
+++ b/lib/ansible/plugins/lookup/var.py
@@ -64,7 +64,7 @@ class LookupModule(LookupBase):
 
     def run(self, terms, variables=None, **kwargs):
 
-        ret = None
+        ret = []
         if variables is not None:
             self._templar.set_available_variables(variables)
         myvars = getattr(self._templar, '_available_variables', {})
@@ -91,10 +91,11 @@ class LookupModule(LookupBase):
                 value = myvars['hostvars'][term]
             else:
                 raise AnsibleUndefinedVariable('No variable found with this name: %s' % term)
-            ret = self._templar.template(value, fail_on_undefined=True)
+            ret = [self._templar.template(value, fail_on_undefined=True)]
         except AnsibleUndefinedVariable:
-            if default is None:
-                ret = default
+            if default is not None:
+                ret = [default]
             else:
                 raise
+
         return ret
