commit 63b94fca7e96a0fe9fcb92d3af3097e3a309f5ab
Author: Felix Fontein <felix@fontein.de>
Date:   Sun Nov 24 13:39:27 2019 +0100

    docker_container and docker_network: avoid None errors (#65018)
    
    * Avoid None errors.
    
    * Add changelog.

diff --git a/changelogs/fragments/65018-docker-none-errors.yml b/changelogs/fragments/65018-docker-none-errors.yml
new file mode 100644
index 0000000000..821aaacbcf
--- /dev/null
+++ b/changelogs/fragments/65018-docker-none-errors.yml
@@ -0,0 +1,3 @@
+bugfixes:
+- "docker_container - fix network idempotence comparison error."
+- "docker_network - fix idempotence comparison error."
diff --git a/lib/ansible/modules/cloud/docker/docker_container.py b/lib/ansible/modules/cloud/docker/docker_container.py
index f6304cdb7e..f459db27ab 100644
--- a/lib/ansible/modules/cloud/docker/docker_container.py
+++ b/lib/ansible/modules/cloud/docker/docker_container.py
@@ -2284,7 +2284,7 @@ class Container(DockerBaseClass):
                 ))
             else:
                 diff = False
-                network_info_ipam = network_info.get('IPAMConfig', {})
+                network_info_ipam = network_info.get('IPAMConfig') or {}
                 if network.get('ipv4_address') and network['ipv4_address'] != network_info_ipam.get('IPv4Address'):
                     diff = True
                 if network.get('ipv6_address') and network['ipv6_address'] != network_info_ipam.get('IPv6Address'):
diff --git a/lib/ansible/modules/cloud/docker/docker_network.py b/lib/ansible/modules/cloud/docker/docker_network.py
index 9dfb3aa6fe..ee12e19ffe 100644
--- a/lib/ansible/modules/cloud/docker/docker_network.py
+++ b/lib/ansible/modules/cloud/docker/docker_network.py
@@ -562,6 +562,8 @@ class DockerNetworkManager(object):
             self.results['changed'] = True
 
     def is_container_connected(self, container_name):
+        if not self.existing_network:
+            return False
         return container_name in container_names_in_network(self.existing_network)
 
     def connect_containers(self):
