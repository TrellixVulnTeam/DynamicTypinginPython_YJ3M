commit 0b3ed626b3157d4dd00b7368acb8fe0d69ac94ec
Author: vigiroux <vincegiroux@gmail.com>
Date:   Tue May 15 18:26:53 2018 -0400

    empty lines in csvfile means row has no items in list; check row len first. (#40089)

diff --git a/lib/ansible/plugins/lookup/csvfile.py b/lib/ansible/plugins/lookup/csvfile.py
index 82e1b842ea..8e7a03590a 100644
--- a/lib/ansible/plugins/lookup/csvfile.py
+++ b/lib/ansible/plugins/lookup/csvfile.py
@@ -106,7 +106,7 @@ class LookupModule(LookupBase):
             creader = CSVReader(f, delimiter=to_native(delimiter), encoding=encoding)
 
             for row in creader:
-                if row[0] == key:
+                if len(row) and row[0] == key:
                     return row[int(col)]
         except Exception as e:
             raise AnsibleError("csvfile: %s" % to_native(e))
