commit 841ec9ef1bdce867ae239545693a4dc111bd7f9b
Author: Matt Clay <matt@mystile.com>
Date:   Fri Sep 23 15:12:24 2016 -0700

    Fix handling of ansible-doc errors. (#3030)

diff --git a/lib/ansible/modules/extras/test/utils/shippable/docs.sh b/lib/ansible/modules/extras/test/utils/shippable/docs.sh
index 9b5a6164f6..2858f87c99 100755
--- a/lib/ansible/modules/extras/test/utils/shippable/docs.sh
+++ b/lib/ansible/modules/extras/test/utils/shippable/docs.sh
@@ -42,10 +42,12 @@ pip list
 
 source hacking/env-setup
 
+docs_status=0
+
 PAGER=/bin/cat \
     ANSIBLE_DEPRECATION_WARNINGS=false \
     bin/ansible-doc -l \
-    2>/tmp/ansible-doc.err
+    2>/tmp/ansible-doc.err || docs_status=$?
 
 if [ -s /tmp/ansible-doc.err ]; then
     # report warnings as errors
@@ -53,3 +55,8 @@ if [ -s /tmp/ansible-doc.err ]; then
     cat /tmp/ansible-doc.err
     exit 1
 fi
+
+if [ "${docs_status}" -ne 0 ]; then
+    echo "Running 'ansible-doc -l' failed with no output on stderr and exit code: ${docs_status}"
+    exit 1
+fi
