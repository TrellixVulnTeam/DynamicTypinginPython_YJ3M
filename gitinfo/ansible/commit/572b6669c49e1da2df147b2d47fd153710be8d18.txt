commit 572b6669c49e1da2df147b2d47fd153710be8d18
Author: Dreamcat4 <dreamcat4@gmail.com>
Date:   Wed Apr 20 14:12:11 2016 +0100

    fix: win-scheduled-task strict-mode fixes

diff --git a/lib/ansible/modules/extras/windows/win_scheduled_task.ps1 b/lib/ansible/modules/extras/windows/win_scheduled_task.ps1
index b63bd13013..7d409050ae 100644
--- a/lib/ansible/modules/extras/windows/win_scheduled_task.ps1
+++ b/lib/ansible/modules/extras/windows/win_scheduled_task.ps1
@@ -23,6 +23,13 @@ $ErrorActionPreference = "Stop"
 # POWERSHELL_COMMON
 
 $params = Parse-Args $args;
+
+$days_of_week = Get-Attr $params "days_of_week" $null;
+$enabled = Get-Attr $params "enabled" $true | ConvertTo-Bool;
+$description = Get-Attr $params "description" " ";
+$path = Get-Attr $params "path" $null;
+$argument = Get-Attr $params "argument" $null;
+
 $result = New-Object PSObject;
 Set-Attr $result "changed" $false;
 
@@ -40,33 +47,17 @@ if($state -eq "present") {
     $time = Get-Attr -obj $params -name time -failifempty $true -resultobj $result
     $user = Get-Attr -obj $params -name user -failifempty $true -resultobj $result
 }
-if ($params.days_of_week)
-{
-    $days_of_week = $params.days_of_week
-}
-elseif ($frequency -eq "weekly")
-{
-    Fail-Json $result "missing required argument: days_of_week"
-}
 
-# Vars with defaults
-if ($params.enabled)
-{
-  $enabled = $params.enabled | ConvertTo-Bool
-}
-else
-{
-  $enabled = $true #default
-}
-if ($params.description)
+# Mandatory Vars
+if ($frequency -eq "weekly")
 {
-  $description = $params.description
-}
-else
-{
-  $description = " "  #default
+    if (!($days_of_week))
+    {
+        Fail-Json $result "missing required argument: days_of_week"
+    }
 }
-if ($params.path)
+
+if ($path)
 {
   $path = "\{0}\" -f $params.path
 }
@@ -75,12 +66,6 @@ else
   $path = "\"  #default
 }
 
-# Optional vars
-if ($params.argument)
-{
-  $argument = $params.argument
-}
-
 try {
     $task = Get-ScheduledTask -TaskPath "$path" | Where-Object {$_.TaskName -eq "$name"}
 
