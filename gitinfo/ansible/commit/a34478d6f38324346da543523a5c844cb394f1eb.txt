commit a34478d6f38324346da543523a5c844cb394f1eb
Author: jjshoe <jjshoe@users.noreply.github.com>
Date:   Fri Apr 18 21:39:10 2014 -0500

    Ensure the validation string has %s in it

diff --git a/library/files/copy b/library/files/copy
index 08aa1d71a4..42ce49c5f1 100644
--- a/library/files/copy
+++ b/library/files/copy
@@ -204,6 +204,8 @@ def main():
                 os.unlink(dest)
                 open(dest, 'w').close()
             if validate:
+                if "%s" not in validate:
+                    module.fail_json(msg="validate must contain %%s: %s" % (validate))
                 (rc,out,err) = module.run_command(validate % src)
                 if rc != 0:
                     module.fail_json(msg="failed to validate: rc:%s error:%s" % (rc,err))
diff --git a/library/files/lineinfile b/library/files/lineinfile
index f781911ccd..2e8a29cda3 100644
--- a/library/files/lineinfile
+++ b/library/files/lineinfile
@@ -154,6 +154,8 @@ def write_changes(module,lines,dest):
     validate = module.params.get('validate', None)
     valid = not validate
     if validate:
+        if "%s" not in validate:
+            module.fail_json(msg="validate must contain %%s: %s" % (validate))
         (rc, out, err) = module.run_command(validate % tmpfile)
         valid = rc == 0
         if rc != 0:
diff --git a/library/files/replace b/library/files/replace
index f4193ae9f3..98a2a6a4d8 100644
--- a/library/files/replace
+++ b/library/files/replace
@@ -90,6 +90,8 @@ def write_changes(module,contents,dest):
     validate = module.params.get('validate', None)
     valid = not validate
     if validate:
+        if "%s" not in validate:
+            module.fail_json(msg="validate must contain %%s: %s" % (validate))
         (rc, out, err) = module.run_command(validate % tmpfile)
         valid = rc == 0
         if rc != 0:
