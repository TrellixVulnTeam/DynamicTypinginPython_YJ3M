commit 06b914c5b35bebd07ac2be216bf231fc774beba4
Author: Brian Coca <bcoca@ansible.com>
Date:   Wed Sep 12 14:47:06 2012 -0400

    small fix to prevent temp file from living past its succesful usage
    Signed-off-by: Brian Coca <briancoca+ansible@gmail.com>

diff --git a/library/copy b/library/copy
index beda6652ba..b9506aac12 100755
--- a/library/copy
+++ b/library/copy
@@ -67,9 +67,9 @@ def main():
                     backup_file = module.backup_local(dest)
             #TODO:pid + epoch should avoid most collisions, hostname/mac for those using nfs?
             # might be an issue with exceeding path length
-            dest_tmp = "%s.%s.%s.tmp" % (dest,os.getpid(),time.gmtime)
+            dest_tmp = "%s.%s.%s.tmp" % (dest,os.getpid(),time.gmtime())
             shutil.copyfile(src, dest_tmp)
-            shutil.copyfile(dest_tmp, dest)
+            shutil.move(dest_tmp, dest)
         except shutil.Error:
             module.fail_json(msg="failed to copy: %s and %s are the same" % (src, dest))
         except IOError:
