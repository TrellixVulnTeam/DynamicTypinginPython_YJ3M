commit 2553a37da52c3c54f4b654f348189f49e1043c74
Author: Ricardo Carrillo Cruz <ricardo.carrillo.cruz@gmail.com>
Date:   Mon Mar 13 20:21:46 2017 +0100

    Add no_log to all network module_utils provider argument (#22566)
    
    The provider argument on the network modules argspec can contain
    credentials.
    Make sure we don't log it.
    
    Fixes #21892

diff --git a/lib/ansible/module_utils/eos.py b/lib/ansible/module_utils/eos.py
index 69beea96a7..b65ed0701b 100644
--- a/lib/ansible/module_utils/eos.py
+++ b/lib/ansible/module_utils/eos.py
@@ -54,7 +54,7 @@ eos_argument_spec = {
     'validate_certs': dict(type='bool'),
     'timeout': dict(type='int'),
 
-    'provider': dict(type='dict'),
+    'provider': dict(type='dict', no_log=True),
     'transport': dict(choices=['cli', 'eapi'])
 }
 
diff --git a/lib/ansible/module_utils/ios.py b/lib/ansible/module_utils/ios.py
index d5f53e32ba..38412f6eaf 100644
--- a/lib/ansible/module_utils/ios.py
+++ b/lib/ansible/module_utils/ios.py
@@ -40,7 +40,7 @@ ios_argument_spec = {
     'authorize': dict(fallback=(env_fallback, ['ANSIBLE_NET_AUTHORIZE']), type='bool'),
     'auth_pass': dict(fallback=(env_fallback, ['ANSIBLE_NET_AUTH_PASS']), no_log=True),
     'timeout': dict(type='int'),
-    'provider': dict(type='dict'),
+    'provider': dict(type='dict', no_log=True),
 }
 
 def check_args(module, warnings):
diff --git a/lib/ansible/module_utils/junos.py b/lib/ansible/module_utils/junos.py
index 0646d70630..dfe3148157 100644
--- a/lib/ansible/module_utils/junos.py
+++ b/lib/ansible/module_utils/junos.py
@@ -38,7 +38,7 @@ junos_argument_spec = {
     'password': dict(fallback=(env_fallback, ['ANSIBLE_NET_PASSWORD']), no_log=True),
     'ssh_keyfile': dict(fallback=(env_fallback, ['ANSIBLE_NET_SSH_KEYFILE']), type='path'),
     'timeout': dict(type='int', default=10),
-    'provider': dict(type='dict'),
+    'provider': dict(type='dict', no_log=True),
     'transport': dict()
 }
 
diff --git a/lib/ansible/module_utils/network.py b/lib/ansible/module_utils/network.py
index c8c75e2713..2103540947 100644
--- a/lib/ansible/module_utils/network.py
+++ b/lib/ansible/module_utils/network.py
@@ -42,7 +42,7 @@ NET_TRANSPORT_ARGS = dict(
     authorize=dict(default=False, fallback=(env_fallback, ['ANSIBLE_NET_AUTHORIZE']), type='bool'),
     auth_pass=dict(no_log=True, fallback=(env_fallback, ['ANSIBLE_NET_AUTH_PASS'])),
 
-    provider=dict(type='dict'),
+    provider=dict(type='dict', no_log=True),
     transport=dict(choices=list()),
 
     timeout=dict(default=10, type='int')
diff --git a/lib/ansible/module_utils/nxos.py b/lib/ansible/module_utils/nxos.py
index 6ddbf8826a..cede81b1f2 100644
--- a/lib/ansible/module_utils/nxos.py
+++ b/lib/ansible/module_utils/nxos.py
@@ -50,7 +50,7 @@ nxos_argument_spec = {
     'validate_certs': dict(type='bool'),
     'timeout': dict(type='int'),
 
-    'provider': dict(type='dict'),
+    'provider': dict(type='dict', no_log=True),
     'transport': dict(choices=['cli', 'nxapi'])
 }
 
