commit e4991d1a61686794d8358113d9b9cd5cc61cb733
Author: Daniel NÃ©ri <dne@mayonnaise.net>
Date:   Sun May 13 20:57:01 2012 +0200

    In the template module, use utils.template_from_file instead of reimplementing it inline

diff --git a/lib/ansible/runner.py b/lib/ansible/runner.py
index 730d8d7e41..3ebe089f50 100644
--- a/lib/ansible/runner.py
+++ b/lib/ansible/runner.py
@@ -554,10 +554,9 @@ class Runner(object):
         copy_module = self._transfer_module(conn, tmp, 'copy')
 
         # template the source data locally
-        source_data = codecs.open(utils.path_dwim(self.basedir, source), encoding="utf8").read()
-        resultant = ''            
         try:
-            resultant = utils.template(source_data, inject, self.setup_cache, no_engine=False)
+            resultant = utils.template_from_file(utils.path_dwim(self.basedir, source),
+                                                 inject, self.setup_cache, no_engine=False)
         except Exception, e:
             return (host, False, dict(failed=True, msg=str(e)), '')
         xfered = self._transfer_str(conn, tmp, 'source', resultant)
