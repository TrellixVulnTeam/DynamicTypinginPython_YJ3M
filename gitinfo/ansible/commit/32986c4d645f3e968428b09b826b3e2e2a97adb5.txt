commit 32986c4d645f3e968428b09b826b3e2e2a97adb5
Author: James Tanner <tanner.jc@gmail.com>
Date:   Fri Nov 22 16:36:31 2013 -0500

    Fixes #5021 safely split hostkeys with quotes

diff --git a/library/system/authorized_key b/library/system/authorized_key
index 5c40e7d97c..db0425d2a1 100644
--- a/library/system/authorized_key
+++ b/library/system/authorized_key
@@ -209,7 +209,12 @@ def parsekey(raw_key):
     key_type   = None   # type of ssh key
     type_index = None   # index of keytype in key string|list
 
-    key_parts = shlex.split(raw_key)
+    # split key safely
+    lex = shlex.shlex(raw_key)
+    lex.quotes = ["'", '"']
+    lex.whitespace_split = True
+    key_parts = list(lex)
+
     for i in range(0, len(key_parts)):
         if key_parts[i] in VALID_SSH2_KEY_TYPES:
             type_index = i
