commit c67c23234a538997ffca58b1568d1f2917db2ddb
Author: Sam Doran <sdoran@redhat.com>
Date:   Mon Nov 4 09:44:10 2019 -0500

    clean_facts - use correct variable when evaluating the string (#64284)
    
    A regexp object has no .startswith() method, which caused an unnecessary
    try/except block to be added to handle this.

diff --git a/changelogs/fragments/clean_facts-use-correct-variable-for-startswith.yaml b/changelogs/fragments/clean_facts-use-correct-variable-for-startswith.yaml
new file mode 100644
index 0000000000..ed6f39bc38
--- /dev/null
+++ b/changelogs/fragments/clean_facts-use-correct-variable-for-startswith.yaml
@@ -0,0 +1,2 @@
+bugfixes:
+  - clean_facts - use correct variable to avoid unnecessary handling of ``AttributeError``
diff --git a/lib/ansible/vars/clean.py b/lib/ansible/vars/clean.py
index 06417823c2..ba494467b7 100644
--- a/lib/ansible/vars/clean.py
+++ b/lib/ansible/vars/clean.py
@@ -133,15 +133,12 @@ def clean_facts(facts):
 
     # next we remove any connection plugin specific vars
     for conn_path in connection_loader.all(path_only=True):
-        try:
-            conn_name = os.path.splitext(os.path.basename(conn_path))[0]
-            re_key = re.compile('^ansible_%s_' % conn_name)
-            for fact_key in fact_keys:
-                # most lightweight VM or container tech creates devices with this pattern, this avoids filtering them out
-                if (re_key.match(fact_key) and not fact_key.endswith(('_bridge', '_gwbridge'))) or re_key.startswith('ansible_become_'):
-                    remove_keys.add(fact_key)
-        except AttributeError:
-            pass
+        conn_name = os.path.splitext(os.path.basename(conn_path))[0]
+        re_key = re.compile('^ansible_%s_' % conn_name)
+        for fact_key in fact_keys:
+            # most lightweight VM or container tech creates devices with this pattern, this avoids filtering them out
+            if (re_key.match(fact_key) and not fact_key.endswith(('_bridge', '_gwbridge'))) or fact_key.startswith('ansible_become_'):
+                remove_keys.add(fact_key)
 
     # remove some KNOWN keys
     for hard in C.RESTRICTED_RESULT_KEYS + C.INTERNAL_RESULT_KEYS:
