commit baece499dfb6a8d8556db2b686d4f3c86d1d25b1
Author: nitzmahone <mdavis@ansible.com>
Date:   Wed Dec 16 11:47:12 2015 -0800

    fix plugin loading for Windows modules
    
    force plugin loader to only consider .py files, since that's the only place docs can live ATM...

diff --git a/lib/ansible/cli/doc.py b/lib/ansible/cli/doc.py
index a17164eb50..265b1c9a3f 100644
--- a/lib/ansible/cli/doc.py
+++ b/lib/ansible/cli/doc.py
@@ -90,7 +90,8 @@ class DocCLI(CLI):
         for module in self.args:
 
             try:
-                filename = module_loader.find_plugin(module)
+                # if the module lives in a non-python file (eg, win_X.ps1), require the corresponding python file for docs
+                filename = module_loader.find_plugin(module, mod_type='.py')
                 if filename is None:
                     display.warning("module %s not found in %s\n" % (module, DocCLI.print_paths(module_loader)))
                     continue
@@ -167,7 +168,8 @@ class DocCLI(CLI):
             if module in module_docs.BLACKLIST_MODULES:
                 continue
 
-            filename = module_loader.find_plugin(module)
+            # if the module lives in a non-python file (eg, win_X.ps1), require the corresponding python file for docs
+            filename = module_loader.find_plugin(module, mod_type='.py')
 
             if filename is None:
                 continue
