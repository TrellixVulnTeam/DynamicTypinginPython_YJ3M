commit 36ba105b91f5d11647b8bbc3b4efd898a2c3952a
Author: Nathaniel Case <Qalthos@gmail.com>
Date:   Thu Aug 4 11:24:28 2016 -0400

    Fix ios_config broken logic

diff --git a/lib/ansible/modules/network/ios/ios_config.py b/lib/ansible/modules/network/ios/ios_config.py
index ae48b72013..14090db8cb 100644
--- a/lib/ansible/modules/network/ios/ios_config.py
+++ b/lib/ansible/modules/network/ios/ios_config.py
@@ -193,7 +193,7 @@ responses:
   sample: ['...', '...']
 """
 from ansible.module_utils.netcfg import NetworkConfig, dumps
-from ansible.module_utils.ios import NetworkModule
+from ansible.module_utils.network import NetworkModule
 from ansible.module_utils.ios import load_config, get_config, ios_argument_spec
 
 def invoke(name, *args, **kwargs):
@@ -271,9 +271,10 @@ def main():
     commands = list()
     if configobjs:
         commands = dumps(configobjs, 'commands')
+        commands = commands.split('\n')
 
         if module.params['before']:
-            commands[:0] = before
+            commands[:0] = module.params['before']
 
         if module.params['after']:
             commands.extend(module.params['after'])
@@ -284,9 +285,6 @@ def main():
 
         result['changed'] = True
 
-    if commands:
-        commands = commands.split('\n')
-
     result['updates'] = commands
     result['connected'] = module.connected
 
