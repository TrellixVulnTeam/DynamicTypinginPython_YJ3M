commit 14dab9870b65c1b64282e14729c77638604f8e36
Author: Matt Martz <matt@sivel.net>
Date:   Tue Jun 17 15:44:06 2014 -0500

    Instantiate psobject directly

diff --git a/library/windows/assemble.ps1 b/library/windows/assemble.ps1
index 77385b5610..dc95d1b9f5 100644
--- a/library/windows/assemble.ps1
+++ b/library/windows/assemble.ps1
@@ -8,6 +8,6 @@ If ($args.Length -gt 0)
 
 $data = 'FIXME';
 
-$result = '{}' | ConvertFrom-Json;
+$result = New-Object psobject;
 $result | Add-Member -MemberType NoteProperty -Name fixme -Value $data;
 echo $result | ConvertTo-Json;
diff --git a/library/windows/async_wrapper.ps1 b/library/windows/async_wrapper.ps1
index 77385b5610..dc95d1b9f5 100644
--- a/library/windows/async_wrapper.ps1
+++ b/library/windows/async_wrapper.ps1
@@ -8,6 +8,6 @@ If ($args.Length -gt 0)
 
 $data = 'FIXME';
 
-$result = '{}' | ConvertFrom-Json;
+$result = New-Object psobject;
 $result | Add-Member -MemberType NoteProperty -Name fixme -Value $data;
 echo $result | ConvertTo-Json;
diff --git a/library/windows/command.ps1 b/library/windows/command.ps1
index 77385b5610..dc95d1b9f5 100644
--- a/library/windows/command.ps1
+++ b/library/windows/command.ps1
@@ -8,6 +8,6 @@ If ($args.Length -gt 0)
 
 $data = 'FIXME';
 
-$result = '{}' | ConvertFrom-Json;
+$result = New-Object psobject;
 $result | Add-Member -MemberType NoteProperty -Name fixme -Value $data;
 echo $result | ConvertTo-Json;
diff --git a/library/windows/copy.ps1 b/library/windows/copy.ps1
index 77385b5610..dc95d1b9f5 100644
--- a/library/windows/copy.ps1
+++ b/library/windows/copy.ps1
@@ -8,6 +8,6 @@ If ($args.Length -gt 0)
 
 $data = 'FIXME';
 
-$result = '{}' | ConvertFrom-Json;
+$result = New-Object psobject;
 $result | Add-Member -MemberType NoteProperty -Name fixme -Value $data;
 echo $result | ConvertTo-Json;
diff --git a/library/windows/file.ps1 b/library/windows/file.ps1
index 77385b5610..dc95d1b9f5 100644
--- a/library/windows/file.ps1
+++ b/library/windows/file.ps1
@@ -8,6 +8,6 @@ If ($args.Length -gt 0)
 
 $data = 'FIXME';
 
-$result = '{}' | ConvertFrom-Json;
+$result = New-Object psobject;
 $result | Add-Member -MemberType NoteProperty -Name fixme -Value $data;
 echo $result | ConvertTo-Json;
diff --git a/library/windows/ping.ps1 b/library/windows/ping.ps1
index 02560873f5..ee46cfd4b8 100644
--- a/library/windows/ping.ps1
+++ b/library/windows/ping.ps1
@@ -12,6 +12,6 @@ If (($params | Get-Member | Select-Object -ExpandProperty Name) -contains 'data'
    $data = $params.data;
 }
 
-$result = '{}' | ConvertFrom-Json;
+$result = New-Object psobject;
 $result | Add-Member -MemberType NoteProperty -Name ping -Value $data;
 echo $result | ConvertTo-Json;
diff --git a/library/windows/slurp.ps1 b/library/windows/slurp.ps1
index 93a698491f..21e912f46a 100644
--- a/library/windows/slurp.ps1
+++ b/library/windows/slurp.ps1
@@ -1,7 +1,7 @@
 #!powershell
 # WANT_JSON
 
-$params = '{}' | ConvertFrom-Json;
+$params = New-Object psobject;
 If ($args.Length -gt 0)
 {
    $params = Get-Content $args[0] | ConvertFrom-Json;
@@ -27,7 +27,7 @@ If (-not $src)
 $bytes = [System.IO.File]::ReadAllBytes($src);
 $content = [System.Convert]::ToBase64String($bytes);
 
-$result = '{}' | ConvertFrom-Json;
+$result = New-Object psobject;
 $result | Add-Member -MemberType NoteProperty -Name content -Value $content;
 $result | Add-Member -MemberType NoteProperty -Name encoding -Value 'base64';
 echo $result | ConvertTo-Json;
diff --git a/library/windows/stat.ps1 b/library/windows/stat.ps1
index f779b2531e..2e87b12275 100644
--- a/library/windows/stat.ps1
+++ b/library/windows/stat.ps1
@@ -1,7 +1,7 @@
 #!powershell
 # WANT_JSON
 
-$params = '{}' | ConvertFrom-Json;
+$params = New-Object psobject;
 If ($args.Length -gt 0)
 {
    $params = Get-Content $args[0] | ConvertFrom-Json;
@@ -19,7 +19,7 @@ If (($params | Get-Member | Select-Object -ExpandProperty Name) -contains 'get_m
    $get_md5 = $params.get_md5;
 }
 
-$stat = '{}' | ConvertFrom-Json;
+$stat = New-Object psobject;
 If (Test-Path $path)
 {
    $stat | Add-Member -MemberType NoteProperty -Name exists -Value $TRUE;
@@ -45,7 +45,7 @@ If ($get_md5 -and $stat.exists -and -not $stat.isdir)
    $stat | Add-Member -MemberType NoteProperty -Name md5 -Value $path_md5;
 }
 
-$result = '{}' | ConvertFrom-Json;
+$result = New-Object psobject;
 $result | Add-Member -MemberType NoteProperty -Name stat -Value $stat;
 $result | Add-Member -MemberType NoteProperty -Name changed -Value $FALSE;
 echo $result | ConvertTo-Json;
diff --git a/library/windows/win_ping b/library/windows/win_ping
index f64134454d..8eba171d0e 100644
--- a/library/windows/win_ping
+++ b/library/windows/win_ping
@@ -12,7 +12,7 @@ If (($params | Get-Member | Select-Object -ExpandProperty Name) -contains 'data'
    $data = $params.data;
 }
 
-$result = '{}' | ConvertFrom-Json;
+$result = New-Object psobject;
 $result | Add-Member -MemberType NoteProperty -Name ping -Value $data;
 echo $result | ConvertTo-Json;
 
