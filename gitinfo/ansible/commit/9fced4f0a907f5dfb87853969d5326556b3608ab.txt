commit 9fced4f0a907f5dfb87853969d5326556b3608ab
Author: Martin Krizek <martin.krizek@gmail.com>
Date:   Wed Feb 21 16:16:02 2018 +0100

    Add integration test for #36430 (#36432)

diff --git a/test/integration/targets/loops/tasks/main.yml b/test/integration/targets/loops/tasks/main.yml
index 72dc1af1e3..af7e53a502 100644
--- a/test/integration/targets/loops/tasks/main.yml
+++ b/test/integration/targets/loops/tasks/main.yml
@@ -176,3 +176,29 @@
   with_sequence: start=0 count=3
   loop_control:
     index_var: my_idx
+
+#
+# loop_control/label
+# https://github.com/ansible/ansible/pull/36430
+#
+
+- set_fact:
+    loopthis:
+        - name: foo
+          label: foo_label
+        - name: bar
+          label: bar_label
+
+- name: check that item label is updated each iteration
+  debug:
+    msg: "{{ looped_var.name }}"
+  with_items: "{{ loopthis }}"
+  loop_control:
+    loop_var: looped_var
+    label: "looped_var {{ looped_var.label }}"
+  register: output
+
+- assert:
+    that:
+      - "output.results[0]['_ansible_item_label'] == 'looped_var foo_label'"
+      - "output.results[1]['_ansible_item_label'] == 'looped_var bar_label'"
