commit 5c085b2436c98cb07c7de7b143284b4c13b4113c
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Wed Feb 7 22:38:45 2018 -0800

    Fix aysnc failure by forgetting the remote tempdir that async_wrapper will delete on the remote end

diff --git a/lib/ansible/plugins/action/__init__.py b/lib/ansible/plugins/action/__init__.py
index 7a5f10cb35..7ab5be7cd0 100644
--- a/lib/ansible/plugins/action/__init__.py
+++ b/lib/ansible/plugins/action/__init__.py
@@ -805,8 +805,12 @@ class ActionBase(with_metaclass(ABCMeta, object)):
         # remove internal keys
         remove_internal_keys(data)
 
-        # FIXME: for backwards compat, figure out if still makes sense
         if wrap_async:
+            # async_wrapper will clean up its tempdir on its own so we want the controller side to
+            # forget about it now
+            self._connection._shell.tempdir = None
+
+            # FIXME: for backwards compat, figure out if still makes sense
             data['changed'] = True
 
         # pre-split stdout/stderr into lines if needed
