commit d0d33262cbdbc78678df5b496289aa29873eb3c4
Author: Peter Oliver <github.com@mavit.org.uk>
Date:   Fri Jun 2 00:10:24 2017 +0100

    pkg5 with `latest` shouldn't ignore absent packages (#23006)
    
    When the state is set to `latest` we should install absent packages, not just upgrade already-instaled packages.
    
    This should fix #22823.

diff --git a/lib/ansible/modules/packaging/os/pkg5.py b/lib/ansible/modules/packaging/os/pkg5.py
index 0aa3b4d836..2cb2eba96f 100644
--- a/lib/ansible/modules/packaging/os/pkg5.py
+++ b/lib/ansible/modules/packaging/os/pkg5.py
@@ -128,7 +128,9 @@ def ensure(module, state, packages, params):
             'subcommand': 'install',
         },
         'latest': {
-            'filter': lambda p: not is_latest(module, p),
+            'filter': lambda p: (
+                not is_installed(module, p) or not is_latest(module, p)
+            ),
             'subcommand': 'install',
         },
         'absent': {
