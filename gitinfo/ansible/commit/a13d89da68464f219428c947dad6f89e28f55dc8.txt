commit a13d89da68464f219428c947dad6f89e28f55dc8
Author: Pierre-Louis Bonicoli <pierre-louis@libregerbil.fr>
Date:   Fri Apr 14 16:07:34 2017 +0200

    Debian: really generate locales
    
    /usr/sbin/locale-gen differs between Debian and Ubuntu. With Debian,
    locales must be added to /etc/locale.gen before calling locale-gen
    command. With Ubuntu, /etc/locale.gen is updated by
    /usr/sbin/locale-gen.
    
    Use the locale-gen module which handles both distributions.

diff --git a/test/integration/targets/setup_postgresql_db/tasks/main.yml b/test/integration/targets/setup_postgresql_db/tasks/main.yml
index 9f4321d0f5..e87687cd2d 100644
--- a/test/integration/targets/setup_postgresql_db/tasks/main.yml
+++ b/test/integration/targets/setup_postgresql_db/tasks/main.yml
@@ -80,12 +80,13 @@
     group: "{{ pg_group }}"
     mode: "0644"
 
-- name: Generate pt_BR locale (Debian)
-  command: locale-gen pt_BR
-  when: ansible_os_family == 'Debian'
-
-- name: Generate es_ES locale (Debian)
-  command: locale-gen es_ES
+- name: Generate locales (Debian)
+  locale_gen:
+    name: '{{ item }}'
+    state: present
+  with_items:
+    - pt_BR
+    - es_ES
   when: ansible_os_family == 'Debian'
 
 # Suse: locales are installed by default (glibc-locale package).
