commit 5942144868f503dbc3b4652fdf4281db1cb7197a
Author: Pierre-Louis Bonicoli <pierre-louis.bonicoli@gmx.fr>
Date:   Mon Mar 23 01:25:18 2015 +0100

    Port #10258 to v2

diff --git a/v2/ansible/module_utils/basic.py b/v2/ansible/module_utils/basic.py
index 6c7217bd88..79a0fab67b 100644
--- a/v2/ansible/module_utils/basic.py
+++ b/v2/ansible/module_utils/basic.py
@@ -1376,7 +1376,7 @@ class AnsibleModule(object):
             # based on the current value of umask
             umask = os.umask(0)
             os.umask(umask)
-            os.chmod(dest, 0666 ^ umask)
+            os.chmod(dest, 0666 & ~umask)
             if switched_user:
                 os.chown(dest, os.getuid(), os.getgid())
 
