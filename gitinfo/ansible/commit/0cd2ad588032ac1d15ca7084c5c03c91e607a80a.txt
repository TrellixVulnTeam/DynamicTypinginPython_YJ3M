commit 0cd2ad588032ac1d15ca7084c5c03c91e607a80a
Author: Nathaniel Case <ncase@redhat.com>
Date:   Wed Oct 30 16:10:36 2019 -0400

    Try to escalate before on_open_shell to work around ios (#63571)

diff --git a/lib/ansible/plugins/connection/network_cli.py b/lib/ansible/plugins/connection/network_cli.py
index a189b8da08..cd812a2e9b 100644
--- a/lib/ansible/plugins/connection/network_cli.py
+++ b/lib/ansible/plugins/connection/network_cli.py
@@ -451,14 +451,14 @@ class Connection(NetworkConnectionBase):
 
             self.receive(prompts=terminal_initial_prompt, answer=terminal_initial_answer, newline=newline, check_all=check_all)
 
-            self.queue_message('vvvv', 'firing event: on_open_shell()')
-            self._terminal.on_open_shell()
-
             if self._play_context.become and self._play_context.become_method == 'enable':
                 self.queue_message('vvvv', 'firing event: on_become')
                 auth_pass = self._play_context.become_pass
                 self._terminal.on_become(passwd=auth_pass)
 
+            self.queue_message('vvvv', 'firing event: on_open_shell()')
+            self._terminal.on_open_shell()
+
             self.queue_message('vvvv', 'ssh connection has completed successfully')
 
         return self
