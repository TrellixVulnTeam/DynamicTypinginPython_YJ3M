commit 4d36b3f7b6a5d958deb50f17417aa2d20f964c96
Author: James Tanner <tanner.jc@gmail.com>
Date:   Fri Apr 22 14:38:03 2016 -0400

    Extend the get_url integration tests to include file schemas. (#15532)
    
    Addresses https://github.com/ansible/ansible-modules-core/issues/3511

diff --git a/test/integration/roles/test_get_url/tasks/main.yml b/test/integration/roles/test_get_url/tasks/main.yml
index 1a99304245..45ad1ab938 100644
--- a/test/integration/roles/test_get_url/tasks/main.yml
+++ b/test/integration/roles/test_get_url/tasks/main.yml
@@ -31,6 +31,40 @@
     python_has_ssl_context: False
   when: python_test.rc != 0
 
+- name: Define test files for file schema
+  set_fact:
+    geturl_srcfile: "{{ output_dir | expanduser }}/aurlfile.txt"
+    geturl_dstfile: "{{ output_dir | expanduser }}/aurlfile_copy.txt"
+
+- name: Create source file
+  copy: 
+    dest: "{{ geturl_srcfile }}" 
+    content: "foobar" 
+
+- name: test file fetch
+  get_url:
+    url: "{{ 'file://' + geturl_srcfile }}"
+    dest: "{{ geturl_dstfile }}"  
+  register: result  
+
+- name: assert success and change
+  assert:
+    that:
+        - result.changed
+        - '"OK" in result.msg'
+
+- name: test nonexisting file fetch
+  get_url:
+    url: "{{ 'file://' + geturl_srcfile + 'NOFILE' }}"
+    dest: "{{ geturl_dstfile + 'NOFILE' }}"  
+  register: result  
+  ignore_errors: True
+
+- name: assert success and change
+  assert:
+    that:
+        - result.failed
+
 - name: test https fetch
   get_url: url="https://raw.githubusercontent.com/ansible/ansible/devel/README.md" dest={{output_dir}}/get_url.txt force=yes
   register: result
