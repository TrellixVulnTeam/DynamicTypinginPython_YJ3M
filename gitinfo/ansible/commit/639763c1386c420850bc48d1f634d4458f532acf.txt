commit 639763c1386c420850bc48d1f634d4458f532acf
Author: Matt Goodall <matt.goodall@gmail.com>
Date:   Wed May 23 00:58:05 2012 +0100

    Allow "=" in k-v values.

diff --git a/lib/ansible/utils.py b/lib/ansible/utils.py
index f10052b0f5..8373a82fc4 100644
--- a/lib/ansible/utils.py
+++ b/lib/ansible/utils.py
@@ -295,7 +295,7 @@ def parse_kv(args):
         vargs = shlex.split(args, posix=True)
         for x in vargs:
             if x.find("=") != -1:
-                k, v = x.split("=")
+                k, v = x.split("=", 1)
                 options[k]=v
     return options
 
diff --git a/test/TestUtils.py b/test/TestUtils.py
index 114ac71c0a..7d03e17c47 100644
--- a/test/TestUtils.py
+++ b/test/TestUtils.py
@@ -235,3 +235,10 @@ class TestUtils(unittest.TestCase):
         res = ansible.utils.template(template, vars, {}, no_engine=False)
 
         assert res == u'hello w√≥rld'
+
+    #####################################
+    ### key-value parsing
+
+    def test_parse_kv_basic(self):
+        assert (ansible.utils.parse_kv('a=simple b="with space" c="this=that"') ==
+                {'a': 'simple', 'b': 'with space', 'c': 'this=that'})
