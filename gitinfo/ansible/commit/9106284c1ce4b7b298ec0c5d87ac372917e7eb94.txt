commit 9106284c1ce4b7b298ec0c5d87ac372917e7eb94
Author: Jordan Borean <jborean93@gmail.com>
Date:   Fri Jan 19 11:42:20 2018 +1000

    copy tests: only create recursive symlink in tests (#35073)

diff --git a/test/integration/targets/copy/files/subdir/subdir1/circles b/test/integration/targets/copy/files/subdir/subdir1/circles
deleted file mode 120000
index b870225aa0..0000000000
--- a/test/integration/targets/copy/files/subdir/subdir1/circles
+++ /dev/null
@@ -1 +0,0 @@
-../
\ No newline at end of file
diff --git a/test/integration/targets/copy/tasks/main.yml b/test/integration/targets/copy/tasks/main.yml
index c76ba37d1c..29520447ce 100644
--- a/test/integration/targets/copy/tasks/main.yml
+++ b/test/integration/targets/copy/tasks/main.yml
@@ -13,6 +13,12 @@
     - file: path={{local_temp_dir}} state=directory
       name: ensure temp dir exists
 
+    # file cannot do this properly, use command instead
+    - name: Create ciruclar symbolic link
+      command: ln -s ../ circles
+      args:
+        chdir: '{{role_path}}/files/subdir/subdir1'
+
     - name: Create remote unprivileged remote user
       user:
         name: '{{ remote_unprivileged_user }}'
@@ -49,6 +55,12 @@
         state: absent
       connection: local
 
+    - name: Remove circular symbolic link
+      file:
+        path: subdir/subdir1/circles
+        state: absent
+      connection: local
+
     - name: Remote unprivileged remote user
       user:
         name: '{{ remote_unprivileged_user }}'
