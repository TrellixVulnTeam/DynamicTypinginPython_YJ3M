commit 5e9f16b2061b1f07d040526ac972ed5a8fb003c5
Author: Mikolaj Chwalisz <chwalisz@tkn.tu-berlin.de>
Date:   Wed Oct 8 17:57:01 2014 +0200

    opkg: fix package state detection

diff --git a/lib/ansible/modules/extras/packaging/opkg.py b/lib/ansible/modules/extras/packaging/opkg.py
index 0187abe56a..95afd6fd8b 100644
--- a/lib/ansible/modules/extras/packaging/opkg.py
+++ b/lib/ansible/modules/extras/packaging/opkg.py
@@ -67,7 +67,7 @@ def query_package(module, opkg_path, name, state="present"):
 
     if state == "present":
 
-        rc, out, err = module.run_command("%s list-installed | grep -q ^%s" % (pipes.quote(opkg_path), pipes.quote(name)), use_unsafe_shell=True)
+        rc, out, err = module.run_command("%s list-installed | grep -q \"^%s \"" % (pipes.quote(opkg_path), pipes.quote(name)), use_unsafe_shell=True)
         if rc == 0:
             return True
 
