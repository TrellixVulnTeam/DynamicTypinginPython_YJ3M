commit 25b696c2d2891e2708bb50e4216ff0e156540010
Author: Serge van Ginderachter <serge@vanginderachter.be>
Date:   Thu Jul 17 14:49:40 2014 +0200

    execute the mount after path validation
    
    This avoids a stale situation where name/path contains some impossible path,
    but gets configured (faultly) in fstab, and the module only fails after that,
    when creating that path.

diff --git a/library/system/mount b/library/system/mount
index a886a04dbd..9dc6fbe7b8 100755
--- a/library/system/mount
+++ b/library/system/mount
@@ -307,7 +307,6 @@ def main():
         module.exit_json(changed=changed, **args)
 
     if state in ['mounted', 'present']:
-        name, changed = set_mount(**args)
         if state == 'mounted':
             if not os.path.exists(name):
                 try:
@@ -315,6 +314,8 @@ def main():
                 except (OSError, IOError), e:
                     module.fail_json(msg="Error making dir %s: %s" % (name, str(e)))
 
+        name, changed = set_mount(**args)
+        if state == 'mounted':
             res = 0
             if os.path.ismount(name):
                 if changed:
