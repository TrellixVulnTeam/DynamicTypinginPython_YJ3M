commit 2a0dfba83895a7fc93db4887fe0a08d487c3b960
Author: Stephen Fromm <sfromm@gmail.com>
Date:   Fri Jul 20 17:19:26 2012 -0700

    Skip get_ipv6_facts if socket.has_ipv6 is false

diff --git a/library/setup b/library/setup
index 4a54f04a0d..e28d69791a 100755
--- a/library/setup
+++ b/library/setup
@@ -482,6 +482,8 @@ class LinuxNetwork(Network):
                     self.facts[iface]['ipv4']['network'] = socket.inet_ntoa(struct.pack("!L", ip & mask))
 
     def get_ipv6_facts(self):
+        if not socket.has_ipv6:
+            return
         data = get_file_content('/proc/net/if_inet6')
         if data is None:
             return
