commit 365af69c3ee8cbbc1585f97b85b921bc05ce7b91
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Sun Jan 18 08:16:55 2015 -0800

    More quotes and reimplement without pushd/popd

diff --git a/hacking/env-setup b/hacking/env-setup
index ae465ed45d..f8b973b1a4 100644
--- a/hacking/env-setup
+++ b/hacking/env-setup
@@ -36,31 +36,28 @@ expr "$MANPATH" : "${PREFIX_MANPATH}.*" > /dev/null || export MANPATH="$PREFIX_M
 gen_egg_info()
 {
     python setup.py egg_info
-    if [ -e $PREFIX_PYTHONPATH/ansible*.egg-info ] ; then
-        rm -r $PREFIX_PYTHONPATH/ansible*.egg-info
+    if [ -e "$PREFIX_PYTHONPATH/ansible*.egg-info" ] ; then
+        rm -r "$PREFIX_PYTHONPATH/ansible*.egg-info"
     fi
-    mv ansible*.egg-info $PREFIX_PYTHONPATH
+    mv "ansible*.egg-info" "$PREFIX_PYTHONPATH"
 }
 
-# In some shells if pushd is a no-op then popd sends you to a previous
-# directory in history
 if [ "$ANSIBLE_HOME" != "$PWD" ] ; then
-    pushd "$ANSIBLE_HOME"
-    if [ "$VERBOSITY" = "-q" ] ; then
-        gen_egg_info 2>1 1> /dev/null
-    else
-        gen_egg_info
-    fi
-    popd
+    current_dir="$PWD"
 else
-    if [ "$VERBOSITY" = "-q" ] ; then
-        gen_egg_info 2>1 1> /dev/null
-    else
-        gen_egg_info
-    fi
+    current_dir="$ANSIBLE_HOME"
+fi
+cd "$ANSIBLE_HOME"
+if [ "$VERBOSITY" = "-q" ] ; then
+    gen_egg_info 2>1 1> /dev/null
+else
+    gen_egg_info
 fi
+cd "$current_dir"
 
+#
 # Print out values unless -q is set
+#
 
 if [ "$VERBOSITY" != "-q" ] ; then
     echo ""
diff --git a/v2/hacking/env-setup b/v2/hacking/env-setup
index d762c34f0d..a5d0fbba69 100644
--- a/v2/hacking/env-setup
+++ b/v2/hacking/env-setup
@@ -36,31 +36,28 @@ expr "$MANPATH" : "${PREFIX_MANPATH}.*" > /dev/null || export MANPATH="$PREFIX_M
 gen_egg_info()
 {
     python setup.py egg_info
-    if [ -e $PREFIX_PYTHONPATH/ansible*.egg-info ] ; then
-        rm -r $PREFIX_PYTHONPATH/ansible*.egg-info
+    if [ -e "$PREFIX_PYTHONPATH/ansible*.egg-info" ] ; then
+        rm -r "$PREFIX_PYTHONPATH/ansible*.egg-info"
     fi
-    mv ansible*.egg-info $PREFIX_PYTHONPATH
+    mv "ansible*.egg-info" "$PREFIX_PYTHONPATH"
 }
 
-# In some shells if pushd is a no-op then popd sends you to a previous
-# directory in history
-#if [ "$ANSIBLE_HOME" != "$PWD" ] ; then
-#    pushd "$ANSIBLE_HOME"
-#    if [ "$VERBOSITY" = "-q" ] ; then
-#        gen_egg_info 2>1 1> /dev/null
-#    else
-#        gen_egg_info
-#    fi
-#    popd
+if [ "$ANSIBLE_HOME" != "$PWD" ] ; then
+    current_dir="$PWD"
+else
+    current_dir="$ANSIBLE_HOME"
+fi
+cd "$ANSIBLE_HOME"
+#if [ "$VERBOSITY" = "-q" ] ; then
+#    gen_egg_info 2>1 1> /dev/null
 #else
-#    if [ "$VERBOSITY" = "-q" ] ; then
-#        gen_egg_info 2>1 1> /dev/null
-#    else
-#        gen_egg_info
-#    fi
+#    gen_egg_info
 #fi
+cd "$current_dir"
 
+#
 # Print out values unless -q is set
+#
 
 if [ "$VERBOSITY" != "-q" ] ; then
     echo ""
