commit 77f5472a53546cfc38bf9520ee36229f67d49069
Author: Evan Kaufman <evan.kaufman@gmail.com>
Date:   Fri Sep 2 11:55:03 2016 -0700

    Declare empty diff dict ahead of time (#4646)
    
    Fixes #4634

diff --git a/lib/ansible/modules/files/replace.py b/lib/ansible/modules/files/replace.py
index 7d26163c58..97103e3b4f 100644
--- a/lib/ansible/modules/files/replace.py
+++ b/lib/ansible/modules/files/replace.py
@@ -130,6 +130,7 @@ def main():
 
     params = module.params
     dest = os.path.expanduser(params['dest'])
+    diff = dict()
 
     if os.path.isdir(dest):
         module.fail_json(rc=256, msg='Destination %s is a directory !' % dest)
