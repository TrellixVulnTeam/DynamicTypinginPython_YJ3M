commit b36aa61237ae449ad60da3f0b9f64dbcab6bb33f
Author: Jan-Piet Mens <jpmens@gmail.com>
Date:   Thu Sep 6 20:21:05 2012 +0200

    Add support for RSA/DSA SSH host key detection in setup module for OS/X
            s/<8spaces>/<4spaces>/g

diff --git a/library/setup b/library/setup
index 8cb4e49eaf..995f0b7b83 100755
--- a/library/setup
+++ b/library/setup
@@ -104,8 +104,14 @@ class Facts(object):
                     self.facts['distribution'] = name
 
     def get_public_ssh_host_keys(self):
-        dsa = get_file_content('/etc/ssh/ssh_host_dsa_key.pub')
-        rsa = get_file_content('/etc/ssh/ssh_host_rsa_key.pub')
+        dsa_filename = '/etc/ssh/ssh_host_dsa_key.pub'
+        rsa_filename = '/etc/ssh/ssh_host_rsa_key.pub'
+
+        if self.facts['system'] == 'Darwin':
+            dsa_filename = '/etc/ssh_host_dsa_key.pub'
+            rsa_filename = '/etc/ssh_host_rsa_key.pub'
+        dsa = get_file_content(dsa_filename)
+        rsa = get_file_content(rsa_filename)
         if dsa is None:
             dsa = 'NA'
         else:
