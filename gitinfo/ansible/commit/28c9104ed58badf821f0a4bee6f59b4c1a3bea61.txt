commit 28c9104ed58badf821f0a4bee6f59b4c1a3bea61
Author: Scott Brown <scott@justplainsimple.com>
Date:   Tue Jun 17 14:37:14 2014 -0700

    BUGFIX 1178: Adding better existence check in one place.  db_import now fails fast if target does not exist b/c no point going further without the target.

diff --git a/library/database/mysql_db b/library/database/mysql_db
index 1c67addd1a..3ac836a711 100644
--- a/library/database/mysql_db
+++ b/library/database/mysql_db
@@ -140,6 +140,9 @@ def db_dump(module, host, user, password, db_name, target, port, socket=None):
     return rc, stdout, stderr
 
 def db_import(module, host, user, password, db_name, target, port, socket=None):
+    if not os.path.exists(target):
+        return module.fail_json(msg="target %s does not exist on the host" % target)
+
     cmd = module.get_bin_path('mysql', True)
     cmd += " --user=%s --password=%s" % (pipes.quote(user), pipes.quote(password))
     if socket is not None:
@@ -148,9 +151,9 @@ def db_import(module, host, user, password, db_name, target, port, socket=None):
         cmd += " --host=%s --port=%s" % (pipes.quote(host), pipes.quote(port))
     cmd += " -D %s" % pipes.quote(db_name)
     if os.path.splitext(target)[-1] == '.gz':
-        cmd = 'test -e ' + pipes.quote(target) + ' && gunzip < ' + pipes.quote(target) + ' | ' + cmd
+        cmd = 'gunzip < ' + pipes.quote(target) + ' | ' + cmd
     elif os.path.splitext(target)[-1] == '.bz2':
-        cmd = 'test -e ' + pipes.quote(target) + ' && bunzip2 < ' + pipes.quote(target) + ' | ' + cmd
+        cmd = 'bunzip2 < ' + pipes.quote(target) + ' | ' + cmd
     else:
         cmd += " < %s" % pipes.quote(target)
     rc, stdout, stderr = module.run_command(cmd, use_unsafe_shell=True)
