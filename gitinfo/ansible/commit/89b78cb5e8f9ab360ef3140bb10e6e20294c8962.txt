commit 89b78cb5e8f9ab360ef3140bb10e6e20294c8962
Author: Jordan Borean <jborean93@gmail.com>
Date:   Fri Mar 24 08:08:53 2017 +1000

    win_share: tweaks after the caching mode changes (#22763)
    
    * win_share: tweaks after the caching mode changes
    
    * Re-added the Unknown option back in

diff --git a/lib/ansible/modules/windows/win_share.ps1 b/lib/ansible/modules/windows/win_share.ps1
index 32ba68c878..f771876eb8 100644
--- a/lib/ansible/modules/windows/win_share.ps1
+++ b/lib/ansible/modules/windows/win_share.ps1
@@ -138,7 +138,7 @@ Try {
         $permissionFull = Get-AnsibleParam -obj $params -name "full" -type "str" -default "" | NormalizeAccounts
         $permissionDeny = Get-AnsibleParam -obj $params -name "deny" -type "str" -default "" | NormalizeAccounts
 
-        $cachingMode = Get-AnsibleParam -obj $params -name "caching_mode" -type "str" -default "None" -validateSet "BranchCache","Documents","Manual","None","Programs", "Unkown"
+        $cachingMode = Get-AnsibleParam -obj $params -name "caching_mode" -type "str" -default "Manual" -validateSet "BranchCache","Documents","Manual","None","Programs","Unknown"
 
         If (-Not (Test-Path -Path $path)) {
             Fail-Json $result "$path directory does not exist on the host"
@@ -252,7 +252,7 @@ Try {
     }
 }
 Catch {
-    Fail-Json $result "an error occurred when attempting to create share $name"
+    Fail-Json $result "an error occurred when attempting to create share $($name): $($_.Exception.Message)"
 }
 
 Exit-Json $result
diff --git a/lib/ansible/modules/windows/win_share.py b/lib/ansible/modules/windows/win_share.py
index 32f0576e0b..e819ad163b 100644
--- a/lib/ansible/modules/windows/win_share.py
+++ b/lib/ansible/modules/windows/win_share.py
@@ -39,15 +39,14 @@ options:
   name:
     description:
       - Share name
-    required: yes
+    required: True
   path:
     description:
       - Share directory
-    required: yes
+    required: True
   state:
     description:
       - Specify whether to add C(present) or remove C(absent) the specified share
-    required: no
     choices:
       - present
       - absent
@@ -55,36 +54,24 @@ options:
   description:
     description:
       - Share description
-    required: no
-    default: none
   list:
     description:
       - Specify whether to allow or deny file listing, in case user got no permission on share
-    required: no
     choices:
       - yes
       - no
-    default: none
   read:
     description:
       - Specify user list that should get read access on share, separated by comma.
-    required: no
-    default: none
   change:
     description:
       - Specify user list that should get read and write access on share, separated by comma.
-    required: no
-    default: none
   full:
     description:
       - Specify user list that should get full access on share, separated by comma.
-    required: no
-    default: none
   deny:
     description:
       - Specify user list that should get no access, regardless of implied access on share, separated by comma.
-    required: no
-    default: none
   caching_mode:
     description:
       - Set the CachingMode for this share.
@@ -95,8 +82,8 @@ options:
       - None
       - Programs
       - Unknown
-    required: no
-    default: "None"
+    default: "Manual"
+    version_added: "2.3"
 author: Hans-Joachim Kliemeck (@h0nIg), David Baumann (@daBONDi)
 '''
 
