commit ad7807fce498aa93b901574b0e33fd3fb4c7e494
Author: Remy <rvanelst@digidentity.eu>
Date:   Thu Feb 7 08:00:02 2013 +0100

    Added DPKG options which lardcanoe suggested

diff --git a/library/apt b/library/apt
index 97358615fd..bf96cc4069 100644
--- a/library/apt
+++ b/library/apt
@@ -174,9 +174,9 @@ def remove(m, pkgspec, cache, purge=False):
         m.exit_json(changed=True)
 
 def upgrade(m, mode="yes"):
-    upgrade_command = "upgrade"
+    upgrade_command = '-o "Dpkg::Options::=--force-confdef" -o "Dpkg::Options::=--force-confold" upgrade'
     if mode == "dist":
-        upgrade_command = "dist-upgrade"
+        upgrade_command = '-o "Dpkg::Options::=--force-confdef" -o "Dpkg::Options::=--force-confold" dist-upgrade'
     cmd = "%s -q -y %s" % (APT, upgrade_command)
     rc, out, err = m.run_command(cmd)
     if rc:
