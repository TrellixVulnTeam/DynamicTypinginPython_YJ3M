commit 2b4ddfb0a2ede5c7500572dc6dac9224a029dee4
Author: Patrick Pelletier <pp.pelletier@gmail.com>
Date:   Sat Feb 23 12:28:42 2013 -0500

    Handle delegate_to case for local connections in hosts file

diff --git a/lib/ansible/runner/__init__.py b/lib/ansible/runner/__init__.py
index b0109fedce..886582c456 100644
--- a/lib/ansible/runner/__init__.py
+++ b/lib/ansible/runner/__init__.py
@@ -447,6 +447,7 @@ class Runner(object):
                 actual_port = delegate_info.get('ansible_ssh_port', port)
                 actual_user = delegate_info.get('ansible_ssh_user', actual_user)
                 actual_pass = delegate_info.get('ansible_ssh_pass', actual_pass)
+                actual_transport = delegate_info.get('ansible_connection', self.transport)
                 for i in delegate_info:
                     if i.startswith("ansible_") and i.endswith("_interpreter"):
                         inject[i] = delegate_info[i]
