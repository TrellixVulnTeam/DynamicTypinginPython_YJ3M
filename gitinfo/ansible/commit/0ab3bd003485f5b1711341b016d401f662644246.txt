commit 0ab3bd003485f5b1711341b016d401f662644246
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Wed Nov 14 20:02:39 2012 -0500

    Fix for #1577 (python 2.4 compliance for mysql_user), tested only for syntax, please exercise MySQL fans!

diff --git a/library/mysql_user b/library/mysql_user
index 7114d7bbd6..bcf90b7033 100755
--- a/library/mysql_user
+++ b/library/mysql_user
@@ -169,12 +169,19 @@ def privileges_get(cursor, user,host):
     output = {}
     cursor.execute("SHOW GRANTS FOR %s@%s", (user,host))
     grants = cursor.fetchall()
+
+    def pick(x):
+        if x == 'ALL PRIVILEGES':
+            return 'ALL'
+        else:
+            return x
+
     for grant in grants:
         res = re.match("GRANT (.+) ON (.+) TO '.+'@'.+'( IDENTIFIED BY PASSWORD '.+')? ?(.*)", grant[0])
         if res is None:
             module.fail_json(msg="unable to parse the MySQL grant string")
         privileges = res.group(1).split(", ")
-        privileges = ['ALL' if x=='ALL PRIVILEGES' else x for x in privileges]
+        privileges = [ pick(x) for x in privileges]
         if "WITH GRANT OPTION" in res.group(4):
             privileges.append('GRANT')
         db = res.group(2).replace('`', '')
