commit f7ac0123011a21ce8282fb5450a3799572f15a14
Author: Michael Scherer <misc@zarb.org>
Date:   Sun Dec 14 17:56:18 2014 +0100

    Do not assume that stdin is a tty
    
    This can be used from another non interactive software, see #9695
    for details.

diff --git a/bin/ansible-doc b/bin/ansible-doc
index 0ba84b9a30..59d14b6ef1 100755
--- a/bin/ansible-doc
+++ b/bin/ansible-doc
@@ -165,7 +165,10 @@ def get_snippet_text(doc):
     return "\n".join(text)
 
 def get_module_list_text(module_list):
-    columns = max(60, int(os.popen('stty size', 'r').read().split()[1]))
+    tty_size = 0
+    if os.isatty(0):
+        tty_size = int(os.popen('stty size', 'r').read().split()[1])
+    columns = max(60, tty_size)
     displace = max(len(x) for x in module_list)
     linelimit = columns - displace - 5
     text = []
