commit bced8715cd89640b592eb4af8a21175f0de640ba
Author: Brian Coca <bcoca@users.noreply.github.com>
Date:   Thu Aug 4 18:35:30 2016 -0400

    add transparent vault use to other plugins (#16957)
    
    assemble, script and unarchive (copy already had it).

diff --git a/lib/ansible/plugins/action/assemble.py b/lib/ansible/plugins/action/assemble.py
index 41c0613595..0898465a03 100644
--- a/lib/ansible/plugins/action/assemble.py
+++ b/lib/ansible/plugins/action/assemble.py
@@ -48,7 +48,8 @@ class ActionModule(ActionBase):
             fragment = "%s/%s" % (src_path, f)
             if not os.path.isfile(fragment) or (ignore_hidden and os.path.basename(fragment).startswith('.')):
                 continue
-            fragment_content = file(fragment).read()
+
+            fragment_content = file(self._loader.get_real_file(fragment)).read()
 
             # always put a newline between fragments if the previous fragment didn't end with a newline.
             if add_newline:
diff --git a/lib/ansible/plugins/action/script.py b/lib/ansible/plugins/action/script.py
index b468c8df0f..99a8f978cf 100644
--- a/lib/ansible/plugins/action/script.py
+++ b/lib/ansible/plugins/action/script.py
@@ -72,7 +72,7 @@ class ActionModule(ActionBase):
         args   = ' '.join(parts[1:])
 
         try:
-            source = self._find_needle('files', source)
+            source = self._loader.get_real_file(self._find_needle('files', source))
         except AnsibleError as e:
             return dict(failed=True, msg=to_str(e))
 
diff --git a/lib/ansible/plugins/action/unarchive.py b/lib/ansible/plugins/action/unarchive.py
index 307e732089..f558b35e94 100644
--- a/lib/ansible/plugins/action/unarchive.py
+++ b/lib/ansible/plugins/action/unarchive.py
@@ -68,7 +68,7 @@ class ActionModule(ActionBase):
 
         if copy:
             try:
-                source = self._find_needle('files', source)
+                source = self._loader.get_real_file(self._find_needle('files', source))
             except AnsibleError as e:
                 result['failed'] = True
                 result['msg'] = to_str(e)
