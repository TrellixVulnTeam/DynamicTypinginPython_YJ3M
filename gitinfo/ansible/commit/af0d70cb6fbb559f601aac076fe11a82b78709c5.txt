commit af0d70cb6fbb559f601aac076fe11a82b78709c5
Author: Abhijeet Kasurde <akasurde@redhat.com>
Date:   Fri Oct 25 00:52:41 2019 +0530

    user: Handle exception when /etc/shadow file is missing (#63888)
    
    Added exception handling when module tries to modify user details,
    and /etc/shadow file is missing or not found.
    
    Fixes: #63490
    
    Signed-off-by: Abhijeet Kasurde <akasurde@redhat.com>

diff --git a/changelogs/fragments/user_missing_etc_shadow.yml b/changelogs/fragments/user_missing_etc_shadow.yml
new file mode 100644
index 0000000000..5139e68050
--- /dev/null
+++ b/changelogs/fragments/user_missing_etc_shadow.yml
@@ -0,0 +1,2 @@
+bugfixes:
+- Handle exception when /etc/shadow file is missing or not found, while operating user operation in user module (https://github.com/ansible/ansible/issues/63490).
diff --git a/lib/ansible/modules/system/user.py b/lib/ansible/modules/system/user.py
index 00dec5f897..255d6e309a 100644
--- a/lib/ansible/modules/system/user.py
+++ b/lib/ansible/modules/system/user.py
@@ -911,7 +911,7 @@ class User(object):
                 # Python 3.6 raises PermissionError instead of KeyError
                 # Due to absence of PermissionError in python2.7 need to check
                 # errno
-                if e.errno in (errno.EACCES, errno.EPERM):
+                if e.errno in (errno.EACCES, errno.EPERM, errno.ENOENT):
                     return passwd, expires
                 raise
 
