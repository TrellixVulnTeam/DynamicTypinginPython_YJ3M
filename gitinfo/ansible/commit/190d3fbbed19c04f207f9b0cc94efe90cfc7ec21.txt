commit 190d3fbbed19c04f207f9b0cc94efe90cfc7ec21
Author: Rene Moser <mail@renemoser.net>
Date:   Wed Mar 7 21:49:19 2018 +0100

    cs_instance: fix error when state destroyed but querying user_data

diff --git a/lib/ansible/modules/cloud/cloudstack/cs_instance.py b/lib/ansible/modules/cloud/cloudstack/cs_instance.py
index e7e60f62c6..06a2529419 100644
--- a/lib/ansible/modules/cloud/cloudstack/cs_instance.py
+++ b/lib/ansible/modules/cloud/cloudstack/cs_instance.py
@@ -460,7 +460,7 @@ class AnsibleCloudStackInstance(AnsibleCloudStack):
             return instance['userdata']
 
         user_data = ""
-        if self.get_user_data() is not None:
+        if self.get_user_data() is not None and instance.get('id'):
             res = self.query_api('getVirtualMachineUserData', virtualmachineid=instance['id'])
             user_data = res['virtualmachineuserdata'].get('userdata', "")
         return user_data
