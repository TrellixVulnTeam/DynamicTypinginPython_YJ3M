commit a81089231e921b5067518065cf5de253ac4cbbc9
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Sun Apr 28 10:13:58 2013 -0400

    Register skipped tasks so we can at least check their changed/not-changed status.

diff --git a/lib/ansible/playbook/__init__.py b/lib/ansible/playbook/__init__.py
index 5af36a6271..c792e72981 100644
--- a/lib/ansible/playbook/__init__.py
+++ b/lib/ansible/playbook/__init__.py
@@ -341,9 +341,6 @@ class PlayBook(object):
 
         # add facts to the global setup cache
         for host, result in contacted.iteritems():
-            # Skip register variable if host is skipped
-            if result.get('skipped', False):
-                continue
             facts = result.get('ansible_facts', {})
             self.SETUP_CACHE[host].update(facts)
             # extra vars need to always trump - so update  again following the facts
diff --git a/lib/ansible/runner/__init__.py b/lib/ansible/runner/__init__.py
index c38356474a..7bb05b8340 100644
--- a/lib/ansible/runner/__init__.py
+++ b/lib/ansible/runner/__init__.py
@@ -462,7 +462,7 @@ class Runner(object):
             return ReturnData(host=host, comm_ok=all_comm_ok, result=rd_result)
         else:
             self.callbacks.on_skipped(host, None)
-            return ReturnData(host=host, comm_ok=True, result=dict(skipped=True))
+            return ReturnData(host=host, comm_ok=True, result=dict(changed=False, skipped=True))
 
     # *****************************************************
 
@@ -494,7 +494,7 @@ class Runner(object):
         conditional = template.template(self.basedir, self.conditional, inject, expand_lists=False)
 
         if not utils.check_conditional(conditional):
-            result = utils.jsonify(dict(skipped=True))
+            result = utils.jsonify(dict(changed=False, skipped=True))
             self.callbacks.on_skipped(host, inject.get('item',None))
             return ReturnData(host=host, result=result)
 
