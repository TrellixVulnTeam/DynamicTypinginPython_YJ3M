commit e73e9ecbc338f38105e37e1b14dc1cc389ab3657
Author: plumbeo <plumbeo@users.noreply.github.com>
Date:   Fri Feb 22 01:39:51 2019 +0100

    mysql_user: fix malformed regex used to check current privileges (#52278)
    
    * mysql_user: fix malformed regex used to check current privileges
    
    * Add changelog fragment for PR #52278

diff --git a/changelogs/fragments/52278-mysql_user-fix-regex b/changelogs/fragments/52278-mysql_user-fix-regex
new file mode 100644
index 0000000000..24a6f39451
--- /dev/null
+++ b/changelogs/fragments/52278-mysql_user-fix-regex
@@ -0,0 +1,2 @@
+bugfixes:
+  - "mysql_user: fix the working but incorrect regex used to check the user privileges."
diff --git a/lib/ansible/modules/database/mysql/mysql_user.py b/lib/ansible/modules/database/mysql/mysql_user.py
index 1254000767..6205909de0 100644
--- a/lib/ansible/modules/database/mysql/mysql_user.py
+++ b/lib/ansible/modules/database/mysql/mysql_user.py
@@ -444,7 +444,7 @@ def privileges_get(cursor, user, host):
             return x
 
     for grant in grants:
-        res = re.match("""GRANT (.+) ON (.+) TO (['`"]).*\\3@(['`"]).*\\4( IDENTIFIED BY PASSWORD (['`"]).+\5)? ?(.*)""", grant[0])
+        res = re.match("""GRANT (.+) ON (.+) TO (['`"]).*\\3@(['`"]).*\\4( IDENTIFIED BY PASSWORD (['`"]).+\\6)? ?(.*)""", grant[0])
         if res is None:
             raise InvalidPrivsError('unable to parse the MySQL grant string: %s' % grant[0])
         privileges = res.group(1).split(", ")
