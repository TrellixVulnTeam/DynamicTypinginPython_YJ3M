commit 8e4f0ec162ecdd4b8fdfbb581e2daac2014922dc
Author: Peter Sprygada <privateip@users.noreply.github.com>
Date:   Tue Feb 14 18:42:15 2017 -0500

    checks connection type is local and fails if not in eos (#21429)

diff --git a/lib/ansible/plugins/action/eos.py b/lib/ansible/plugins/action/eos.py
index 896e53a655..9b6d1484bb 100644
--- a/lib/ansible/plugins/action/eos.py
+++ b/lib/ansible/plugins/action/eos.py
@@ -34,6 +34,12 @@ from ansible.module_utils._text import to_bytes
 class ActionModule(_ActionModule):
 
     def run(self, tmp=None, task_vars=None):
+        if self._play_context.connection != 'local':
+            return dict(
+                fail=True,
+                msg='invalid connection specified, expected connection=local, '
+                    'got %s' % self._play_context.connection
+            )
 
         provider = self.load_provider()
         transport = provider['transport']
