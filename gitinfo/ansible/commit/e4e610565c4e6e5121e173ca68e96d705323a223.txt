commit e4e610565c4e6e5121e173ca68e96d705323a223
Author: Matt Martz <matt@sivel.net>
Date:   Thu Jun 19 11:32:32 2014 -0500

    Add convenience function (Get-Attr) for getting an attribute/member from a powershell psobject

diff --git a/lib/ansible/module_utils/powershell.ps1 b/lib/ansible/module_utils/powershell.ps1
index 86c3c82e5b..37366f0d61 100644
--- a/lib/ansible/module_utils/powershell.ps1
+++ b/lib/ansible/module_utils/powershell.ps1
@@ -47,6 +47,23 @@ Function Set-Attr($obj, $name, $value)
     $obj | Add-Member -Force -MemberType NoteProperty -Name $name -Value $value
 }
 
+# Helper function to get an "attribute" from a psobject instance in powershell.
+# This is a convenience to make getting Members from an object easier and
+# slightly more pythonic
+# Example: $attr = Get-Attr $response "code" -default "1"
+Function Get-Attr($obj, $name, $default = $null)
+{
+    If ($obj.$name.GetType)
+    {
+        $obj.$name
+    }
+    Else
+    {
+        $default
+    }
+    return
+}
+
 # Helper function to convert a powershell object to JSON to echo it, exiting
 # the script
 Function Exit-Json($obj)
