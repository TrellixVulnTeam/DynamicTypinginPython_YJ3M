commit ded02b4968c62d275f9c7315579ab132829ea988
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Mon Jan 18 13:48:37 2016 -0800

    Fix proposed by @Yannig to fix become success detection when the output is multiline
    
    See the Bug report for a specific error case with local connection,
    sudo, and the raw module
    
    Fixes #13728

diff --git a/lib/ansible/plugins/connection/__init__.py b/lib/ansible/plugins/connection/__init__.py
index ff00bc0238..bea8e5b426 100644
--- a/lib/ansible/plugins/connection/__init__.py
+++ b/lib/ansible/plugins/connection/__init__.py
@@ -206,7 +206,10 @@ class ConnectionBase(with_metaclass(ABCMeta, object)):
         pass
 
     def check_become_success(self, output):
-        return self._play_context.success_key == output.rstrip()
+        for line in output.splitlines(True):
+            if self._play_context.success_key == line.rstrip():
+                return True
+        return False
 
     def check_password_prompt(self, output):
         if self._play_context.prompt is None:
