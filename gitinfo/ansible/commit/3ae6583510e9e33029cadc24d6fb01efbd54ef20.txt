commit 3ae6583510e9e33029cadc24d6fb01efbd54ef20
Author: Ghe Rivero <ghe.rivero@hp.com>
Date:   Wed May 25 00:36:28 2016 +0200

    Make add ip_floating_ip idempotent
    
    Closes issue #1858

diff --git a/lib/ansible/modules/cloud/openstack/os_floating_ip.py b/lib/ansible/modules/cloud/openstack/os_floating_ip.py
index df2faa967e..d7936b8c90 100644
--- a/lib/ansible/modules/cloud/openstack/os_floating_ip.py
+++ b/lib/ansible/modules/cloud/openstack/os_floating_ip.py
@@ -162,6 +162,10 @@ def main():
                 msg="server {0} not found".format(server_name_or_id))
 
         if state == 'present':
+            fip_address = cloud.get_server_public_ip(server)
+            f_ip = _get_floating_ip(cloud, fip_address)
+            if f_ip:
+                module.exit_json(changed=False, floating_ip=f_ip)
             server = cloud.add_ips_to_server(
                 server=server, ips=floating_ip_address, ip_pool=network,
                 reuse=reuse, fixed_address=fixed_address, wait=wait,
