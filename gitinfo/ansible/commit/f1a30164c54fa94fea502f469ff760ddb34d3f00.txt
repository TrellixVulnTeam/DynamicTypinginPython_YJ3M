commit f1a30164c54fa94fea502f469ff760ddb34d3f00
Author: Felix Fontein <felix@fontein.de>
Date:   Fri Jan 31 10:45:59 2020 +0100

    Fix 'container_default_behavior: no_defaults'. (#66601)

diff --git a/lib/ansible/modules/cloud/docker/docker_container.py b/lib/ansible/modules/cloud/docker/docker_container.py
index 6e1254c6d0..24856e8aa5 100644
--- a/lib/ansible/modules/cloud/docker/docker_container.py
+++ b/lib/ansible/modules/cloud/docker/docker_container.py
@@ -2736,7 +2736,7 @@ class ContainerManager(DockerBaseClass):
                 self.container_stop(container.Id)
                 container = self._get_container(container.Id)
 
-            if state == 'started' and container.paused is not None and container.paused != self.parameters.paused:
+            if state == 'started' and self.parameters.paused is not None and container.paused != self.parameters.paused:
                 self.diff_tracker.add('paused', parameter=self.parameters.paused, active=was_paused)
                 if not self.check_mode:
                     try:
diff --git a/test/integration/targets/docker_container/tasks/tests/compatibility.yml b/test/integration/targets/docker_container/tasks/tests/compatibility.yml
new file mode 100644
index 0000000000..fb537f42b3
--- /dev/null
+++ b/test/integration/targets/docker_container/tasks/tests/compatibility.yml
@@ -0,0 +1,118 @@
+---
+- name: Registering container name
+  set_fact:
+    cname: "{{ cname_prefix ~ '-hi' }}"
+- name: Registering container name
+  set_fact:
+    cnames: "{{ cnames + [cname] }}"
+
+####################################################################
+## container_default_behavior: compatibility #######################
+####################################################################
+
+- name: Start container (check)
+  docker_container:
+    name: "{{ cname }}"
+    image: alpine:3.8
+    command: '/bin/sh -c "sleep 10m"'
+    state: started
+    container_default_behavior: compatibility
+  check_mode: yes
+  register: start_1
+
+- name: Start container
+  docker_container:
+    name: "{{ cname }}"
+    image: alpine:3.8
+    command: '/bin/sh -c "sleep 10m"'
+    state: started
+    container_default_behavior: compatibility
+  register: start_2
+
+- name: Start container (idempotent)
+  docker_container:
+    name: "{{ cname }}"
+    image: alpine:3.8
+    command: '/bin/sh -c "sleep 10m"'
+    state: started
+    container_default_behavior: compatibility
+  register: start_3
+
+- name: Start container (idempotent check)
+  docker_container:
+    name: "{{ cname }}"
+    image: alpine:3.8
+    state: started
+    container_default_behavior: compatibility
+  check_mode: yes
+  register: start_4
+
+- name: cleanup
+  docker_container:
+    name: "{{ cname }}"
+    state: absent
+    force_kill: yes
+  diff: no
+
+- assert:
+    that:
+    - start_1 is changed
+    - start_2 is changed
+    - start_3 is not changed
+    - start_4 is not changed
+
+####################################################################
+## container_default_behavior: no_defaults #########################
+####################################################################
+
+- name: Start container (check)
+  docker_container:
+    name: "{{ cname }}"
+    image: alpine:3.8
+    command: '/bin/sh -c "sleep 10m"'
+    state: started
+    container_default_behavior: no_defaults
+  check_mode: yes
+  register: start_1
+
+- name: Start container
+  docker_container:
+    name: "{{ cname }}"
+    image: alpine:3.8
+    command: '/bin/sh -c "sleep 10m"'
+    state: started
+    container_default_behavior: no_defaults
+  register: start_2
+
+- name: Start container (idempotent)
+  docker_container:
+    name: "{{ cname }}"
+    image: alpine:3.8
+    command: '/bin/sh -c "sleep 10m"'
+    state: started
+    container_default_behavior: no_defaults
+  register: start_3
+
+- name: Start container (idempotent check)
+  docker_container:
+    name: "{{ cname }}"
+    image: alpine:3.8
+    command: '/bin/sh -c "sleep 10m"'
+    state: started
+    container_default_behavior: no_defaults
+  check_mode: yes
+  register: start_4
+
+- name: cleanup
+  docker_container:
+    name: "{{ cname }}"
+    state: absent
+    force_kill: yes
+  diff: no
+
+- assert:
+    that:
+    - start_1 is changed
+    - start_2 is changed
+    - start_3 is not changed
+    - start_4 is not changed
