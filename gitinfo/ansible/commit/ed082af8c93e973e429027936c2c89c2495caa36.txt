commit ed082af8c93e973e429027936c2c89c2495caa36
Author: David Newswanger <gamma.dave@gmail.com>
Date:   Thu Jan 25 12:04:42 2018 -0500

    improved test coveraage for vyos_config (#35298)

diff --git a/test/integration/targets/vyos_config/tests/cli/check_config.yaml b/test/integration/targets/vyos_config/tests/cli/check_config.yaml
index c7df344545..7612b1fe72 100644
--- a/test/integration/targets/vyos_config/tests/cli/check_config.yaml
+++ b/test/integration/targets/vyos_config/tests/cli/check_config.yaml
@@ -1,9 +1,33 @@
 ---
 - debug: msg="START cli/config_check.yaml on connection={{ ansible_connection }}"
 
-- name: setup
+- name: setup- ensure interface is not present
   vyos_config:
-    lines: set interfaces loopback lo description test
+    lines: delete interfaces loopback lo
+
+- name: setup- create interface
+  vyos_config:
+    lines:
+      - interfaces
+      - interfaces loopback lo
+      - interfaces loopback lo description test
+  register: result
+
+# note collapsing the duplicate lines doesn't work if
+# lines:
+#   - interfaces loopback lo description test
+#   - interfaces loopback lo
+#   - interfaces
+
+- name: Check that multiple duplicate lines collapse into a single commands
+  assert:
+    that:
+      - "{{ result.commands|length }} == 1"
+
+- name: Check that set is correctly prepended
+  assert:
+    that:
+      - "result.commands[0] == 'set interfaces loopback lo description test'"
 
 - name: configure config_check config command
   vyos_config:
