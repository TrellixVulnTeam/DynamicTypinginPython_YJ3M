commit b34b606fcf73d2a1c46f9b4cc5972d105aeada63
Author: Brian Coca <bcoca@ansible.com>
Date:   Sun Jun 21 01:51:28 2015 -0400

    fixed and/or grouping

diff --git a/lib/ansible/plugins/shell/sh.py b/lib/ansible/plugins/shell/sh.py
index 3385d9fb04..cdf67f4fa2 100644
--- a/lib/ansible/plugins/shell/sh.py
+++ b/lib/ansible/plugins/shell/sh.py
@@ -62,7 +62,7 @@ class ShellModule(object):
         if not basefile:
             basefile = 'ansible-tmp-%s-%s' % (time.time(), random.randint(0, 2**48))
         basetmp = self.join_path(C.DEFAULT_REMOTE_TMP, basefile)
-        if system and basetmp.startswith('$HOME') or basetmp.startswith('~/'):
+        if system and (basetmp.startswith('$HOME') or basetmp.startswith('~/')):
             basetmp = self.join_path('/tmp', basefile)
         cmd = 'mkdir -p %s' % basetmp
         if mode:
