commit c97360d21f2ba003abc881b9b3d03ab0ef672508
Author: Abhijeet Kasurde <akasurde@redhat.com>
Date:   Sat Dec 7 01:53:12 2019 +0530

    vmware: vmware_vm_inventory use port value when with_tags:True (#65568)
    
    If user specifies a port number in vmware_vm_inventory plugin configuration,
    then use that port to connect to vCenter rather than connecting to 443 which
    is default port.
    
    Fixes: #64096

diff --git a/changelogs/fragments/vmware_vm_inventory_port.yml b/changelogs/fragments/vmware_vm_inventory_port.yml
new file mode 100644
index 0000000000..e18faac07c
--- /dev/null
+++ b/changelogs/fragments/vmware_vm_inventory_port.yml
@@ -0,0 +1,2 @@
+bugfixes:
+- vmware_vm_inventory inventory plugin, use the port value while connecting to vCenter (https://github.com/ansible/ansible/issues/64096).
diff --git a/lib/ansible/plugins/inventory/vmware_vm_inventory.py b/lib/ansible/plugins/inventory/vmware_vm_inventory.py
index bd8e4d2ad8..816b6471c5 100644
--- a/lib/ansible/plugins/inventory/vmware_vm_inventory.py
+++ b/lib/ansible/plugins/inventory/vmware_vm_inventory.py
@@ -163,12 +163,15 @@ class BaseVMwareInventory:
             # Disable warning shown at stdout
             requests.packages.urllib3.disable_warnings()
 
-        client = create_vsphere_client(server=self.hostname,
+        server = self.hostname
+        if self.port:
+            server += ":" + str(self.port)
+        client = create_vsphere_client(server=server,
                                        username=self.username,
                                        password=self.password,
                                        session=session)
         if client is None:
-            raise AnsibleError("Failed to login to %s using %s" % (self.hostname, self.username))
+            raise AnsibleError("Failed to login to %s using %s" % (server, self.username))
         return client
 
     def _login(self):
