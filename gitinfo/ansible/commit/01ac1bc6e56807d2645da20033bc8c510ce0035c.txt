commit 01ac1bc6e56807d2645da20033bc8c510ce0035c
Author: Peter Sprygada <privateip@users.noreply.github.com>
Date:   Sat Feb 25 08:17:04 2017 -0500

    roll up of fixes from nxos integration tests (#21948)
    
    * now fails nxos_nxapi if the transport=nxapi
    * fixes typos in nxos_nxapi integration tests cases

diff --git a/lib/ansible/modules/network/nxos/nxos_nxapi.py b/lib/ansible/modules/network/nxos/nxos_nxapi.py
index 1088667248..9d7c6dcd27 100644
--- a/lib/ansible/modules/network/nxos/nxos_nxapi.py
+++ b/lib/ansible/modules/network/nxos/nxos_nxapi.py
@@ -134,6 +134,11 @@ from ansible.module_utils.netcfg import NetworkConfig
 from ansible.module_utils.six import iteritems
 
 def check_args(module, warnings):
+    transport = module.params['transport']
+    provider_transport = (module.params['provider'] or {}).get('transport')
+    if 'nxapi' in (transport, provider_transport):
+        module.fail_json(msg='transport=nxapi is not supporting when configuring nxapi')
+
     nxos_check_args(module, warnings)
 
     state = module.params['state']
diff --git a/test/integration/targets/nxos_nxapi/tests/cli/config.yaml b/test/integration/targets/nxos_nxapi/tests/cli/config.yaml
index 6dd9f9d1ca..1ccc459f2b 100644
--- a/test/integration/targets/nxos_nxapi/tests/cli/config.yaml
+++ b/test/integration/targets/nxos_nxapi/tests/cli/config.yaml
@@ -82,6 +82,6 @@
     that:
       - "config.changed == false"
 # FIXME: https://github.com/ansible/ansible-modules-core/issues/4955
-  ignore_erros: yes
+  ignore_errors: yes
 
 - debug: msg="END cli/config.yaml"
diff --git a/test/integration/targets/nxos_nxapi/tests/cli/enable.yaml b/test/integration/targets/nxos_nxapi/tests/cli/enable.yaml
index 3dc1399ac4..323e9c2cc9 100644
--- a/test/integration/targets/nxos_nxapi/tests/cli/enable.yaml
+++ b/test/integration/targets/nxos_nxapi/tests/cli/enable.yaml
@@ -22,7 +22,7 @@
 
 - name: Assert NXAPI is enabled
   assert:
-      that: result.result[0] | search('enabled')
+      that: result.stdout[0] | search('enabled')
 
 - name: Enable NXAPI again
   nxos_nxapi:
