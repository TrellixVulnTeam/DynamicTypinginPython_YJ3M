commit ef8c1124d0c05048dc8b654ad779d17c3be36ee6
Author: Rob White <rob.white@truelocal.com.au>
Date:   Sat Mar 26 18:46:50 2016 +1100

    Add function to convert CamelCased key names to snake_names

diff --git a/lib/ansible/module_utils/ec2.py b/lib/ansible/module_utils/ec2.py
index 52b085eb78..18f7d1f590 100644
--- a/lib/ansible/module_utils/ec2.py
+++ b/lib/ansible/module_utils/ec2.py
@@ -262,3 +262,24 @@ def paging(pause=0):
         return page
     return wrapper
 
+
+def camel_dict_to_snake_dict(camel_dict):
+
+    def camel_to_snake(name):
+
+        import re
+
+        first_cap_re = re.compile('(.)([A-Z][a-z]+)')
+        all_cap_re = re.compile('([a-z0-9])([A-Z])')
+        s1 = first_cap_re.sub(r'\1_\2', name)
+
+        return all_cap_re.sub(r'\1_\2', s1).lower()
+
+
+    snake_dict = {}
+    for k, v in camel_dict.iteritems():
+        if isinstance(v, dict):
+            v = camel_dict_to_snake_dict(v)
+        snake_dict[camel_to_snake(k)] = v
+
+    return snake_dict
