commit 082b1b6ccadf75ce6bc27e52792a3c3e7969569a
Author: Sam Doran <sdoran@redhat.com>
Date:   Fri Nov 15 17:03:27 2019 -0500

    Fix filesystem integration test for CentOS 8 (#64866)

diff --git a/test/integration/targets/filesystem/tasks/main.yml b/test/integration/targets/filesystem/tasks/main.yml
index 68d625e897..b527e1f620 100644
--- a/test/integration/targets/filesystem/tasks/main.yml
+++ b/test/integration/targets/filesystem/tasks/main.yml
@@ -26,7 +26,7 @@
     # https://www.kernel.org/pub/linux/utils/util-linux/v2.21/v2.21-ChangeLog
     # https://anonscm.debian.org/cgit/collab-maint/pkg-util-linux.git/commit/?id=04f7020eadf31efc731558df92daa0a1c336c46c
     - 'not (item.0.key == "btrfs" and (ansible_distribution == "Ubuntu" and ansible_distribution_release == "trusty"))'
-    - 'not (item.0.key == "btrfs" and (ansible_distribution == "RedHat" and ansible_distribution_major_version|int >= 8))'
+    - 'not (item.0.key == "btrfs" and (ansible_facts.os_family == "RedHat" and ansible_facts.distribution_major_version is version("8", ">=")))'
     - 'not (item.0.key == "lvm" and ansible_system == "FreeBSD")' # LVM not available on FreeBSD
     - 'not (item.0.key == "lvm" and ansible_virtualization_type == "docker")' # Tests use losetup which can not be used inside unprivileged container
     - 'not (item.0.key == "ocfs2" and ansible_os_family != "Debian")' # ocfs2 only available on Debian based distributions
diff --git a/test/integration/targets/filesystem/tasks/setup.yml b/test/integration/targets/filesystem/tasks/setup.yml
index d8009a782d..6069cbedd8 100644
--- a/test/integration/targets/filesystem/tasks/setup.yml
+++ b/test/integration/targets/filesystem/tasks/setup.yml
@@ -17,7 +17,7 @@
       - ansible_os_family != 'Suse'
       - not (ansible_distribution == 'Ubuntu' and ansible_distribution_version is version('16.04', '<='))
       - ansible_system != "FreeBSD"
-      - not (ansible_distribution == "RedHat" and ansible_distribution_major_version|int >= 8)
+      - not (ansible_facts.os_family == "RedHat" and ansible_facts.distribution_major_version is version('8', '>='))
 
   - name: install btrfs progs (Ubuntu <= 16.04)
     package:
@@ -78,7 +78,7 @@
   when:
     - ansible_system == 'Linux'
     - ansible_os_family != 'Suse'
-    - ansible_os_family != 'RedHat' or (ansible_distribution == 'CentOS' and ansible_distribution_version is version('7.0', '>='))
+    - ansible_os_family != 'RedHat' or (ansible_distribution == 'CentOS' and ansible_distribution_version is version('7.0', '=='))
 
 - command: mke2fs -V
   register: mke2fs
