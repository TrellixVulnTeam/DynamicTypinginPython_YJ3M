commit 287f4ff37405e8aa45f565f260df721d99333fb6
Author: John R Barker <john@johnrbarker.com>
Date:   Wed May 2 15:03:41 2018 +0100

    Connect via ssh using ansible_port (#39603)
    
    Depending on how we spin up the VM we use different ssh port. Honor that
    in the vyos_user test

diff --git a/test/integration/targets/vyos_user/tests/cli/auth.yaml b/test/integration/targets/vyos_user/tests/cli/auth.yaml
index 6097d88b9b..17316619da 100644
--- a/test/integration/targets/vyos_user/tests/cli/auth.yaml
+++ b/test/integration/targets/vyos_user/tests/cli/auth.yaml
@@ -7,15 +7,15 @@
       state: present
       configured_password: pass123
 
-  - name: test login
+  - name: test login via ssh with new user
     expect:
-      command: "ssh auth_user@{{ ansible_ssh_host }} -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no '/opt/vyatta/sbin/vyatta-cfg-cmd-wrapper show version'"
+      command: "ssh auth_user@{{ ansible_ssh_host }} -p {{ ansible_port }} -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no '/opt/vyatta/sbin/vyatta-cfg-cmd-wrapper show version'"
       responses:
         (?i)password: "pass123"
 
-  - name: test login with invalid password (should fail)
+  - name: test login via ssh with invalid password (should fail)
     expect:
-      command: "ssh auth_user@{{ ansible_ssh_host }} -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no '/opt/vyatta/sbin/vyatta-cfg-cmd-wrapper show version'"
+      command: "ssh auth_user@{{ ansible_ssh_host }} -p {{ ansible_port }} -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no '/opt/vyatta/sbin/vyatta-cfg-cmd-wrapper show version'"
       responses:
         (?i)password: "badpass"
     ignore_errors: yes
