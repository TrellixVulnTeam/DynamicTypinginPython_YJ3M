commit 3db6b9b416f07ea2cda5e457f3592149b09881d3
Author: Jordan Borean <jborean93@gmail.com>
Date:   Tue Jan 15 17:26:03 2019 +1000

    ansible-test git: kill gpg-agent to remove locks (#50917)
    
    * ansible-test git: kill gpg-agent to remove locks
    
    * skip gpg-agent kill for OpenSUSE

diff --git a/test/integration/targets/git/tasks/gpg-verification.yml b/test/integration/targets/git/tasks/gpg-verification.yml
index 863aa32780..90d7022f4d 100644
--- a/test/integration/targets/git/tasks/gpg-verification.yml
+++ b/test/integration/targets/git/tasks/gpg-verification.yml
@@ -180,6 +180,10 @@
       - git_verify is failed
       - git_verify.msg is match("Failed to verify GPG signature of commit/tag.+")
 
+- name: GPG-VERIFICATION | Stop gpg-agent so we can remove any locks on the GnuPG dir
+  command: gpgconf --kill gpg-agent
+  when: ansible_os_family != 'Suse'  # OpenSUSE ships with an older version of gpg-agent that doesn't support this
+
 - name: GPG-VERIFICATION | Remove GnuPG verification workdir
   file:
     path: "{{ git_gpg_workdir.path }}"
