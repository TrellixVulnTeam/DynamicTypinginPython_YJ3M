commit 90c98ada7cccc3f8fddfeb83cfc97409b392184d
Author: Matt Martz <matt@sivel.net>
Date:   Thu Jun 19 10:36:53 2014 -0500

    Add ConvertTo-Bool filter function in powershell common code

diff --git a/lib/ansible/module_utils/powershell.ps1 b/lib/ansible/module_utils/powershell.ps1
index a911ea95dd..86c3c82e5b 100644
--- a/lib/ansible/module_utils/powershell.ps1
+++ b/lib/ansible/module_utils/powershell.ps1
@@ -64,3 +64,26 @@ Function Fail-Json($obj, $message)
     echo $obj | ConvertTo-Json
     Exit 1
 }
+
+# Helper filter/pipeline function to convert a value to boolean following current
+# Ansible practices
+Function ConvertTo-Bool
+{
+    param(
+        [parameter(valuefrompipeline=$true)]
+        $obj
+    )
+
+    $boolean_strings = "yes", "on", "1", "true", 1
+    $obj_string = [string]$obj
+
+    if (($obj.GetType().Name -eq "Boolean" -and $obj) -or $boolean_strings -contains $obj_string.ToLower())
+    {
+        $true
+    }
+    Else
+    {
+        $false
+    }
+    return
+}
