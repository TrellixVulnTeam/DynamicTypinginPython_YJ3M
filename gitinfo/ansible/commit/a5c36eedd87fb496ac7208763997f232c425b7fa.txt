commit a5c36eedd87fb496ac7208763997f232c425b7fa
Author: Matt Clay <matt@mystile.com>
Date:   Wed Jan 8 14:13:49 2020 -0800

    Simplify docker_setup on Fedora.
    
    This avoids installing dnf-plugins-core, which breaks the yum and dnf modules
    when uninstalling packages using a wildcard after they have already been removed.
    
    This should resolve issues with the yum integration tests failing after docker tests run.

diff --git a/test/integration/targets/setup_docker/tasks/Fedora.yml b/test/integration/targets/setup_docker/tasks/Fedora.yml
index a2fd45ef76..9f52e8f144 100644
--- a/test/integration/targets/setup_docker/tasks/Fedora.yml
+++ b/test/integration/targets/setup_docker/tasks/Fedora.yml
@@ -1,12 +1,12 @@
-- name: Install Docker pre-reqs
-  dnf:
-    name: "{{ docker_prereq_packages }}"
-    state: present
-
 - name: Add repository
-  command: dnf config-manager --add-repo https://download.docker.com/linux/fedora/docker-ce.repo
-  args:
-    warn: no
+  yum_repository:
+    file: docker-ce
+    name: docker-ce-stable
+    description: Docker CE Stable - $basearch
+    baseurl: https://download.docker.com/linux/fedora/$releasever/$basearch/stable
+    enabled: yes
+    gpgcheck: yes
+    gpgkey: https://download.docker.com/linux/fedora/gpg
 
 - name: Update cache
   command: dnf makecache
diff --git a/test/integration/targets/setup_docker/vars/Fedora.yml b/test/integration/targets/setup_docker/vars/Fedora.yml
index be83c6be1f..4312688103 100644
--- a/test/integration/targets/setup_docker/vars/Fedora.yml
+++ b/test/integration/targets/setup_docker/vars/Fedora.yml
@@ -1,5 +1,4 @@
-docker_prereq_packages:
-  - dnf-plugins-core
+docker_prereq_packages: []
 
 docker_packages:
   - docker-ce
