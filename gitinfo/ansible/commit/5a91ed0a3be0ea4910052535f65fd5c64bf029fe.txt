commit 5a91ed0a3be0ea4910052535f65fd5c64bf029fe
Author: Matt Clay <matt@mystile.com>
Date:   Tue Oct 3 14:37:05 2017 -0700

    Switch CI for OS X back to a single job. (#31265)
    
    * Update Shippable scripts for group/non-group use.
    * Switch CI for OS X back to a single job.

diff --git a/shippable.yml b/shippable.yml
index ac6b020e39..63dde0b882 100644
--- a/shippable.yml
+++ b/shippable.yml
@@ -15,6 +15,7 @@ matrix:
     - env: T=units/3.5
     - env: T=units/3.6
 
+    - env: T=osx/10.11
     - env: T=rhel/7.4
 
     - env: T=windows/1
@@ -23,7 +24,6 @@ matrix:
 
     - env: T=network
 
-    - env: T=osx/10.11/1
     - env: T=freebsd/10.3-STABLE/1
     - env: T=freebsd/11.0-STABLE/1
     - env: T=linux/centos6/1
@@ -36,7 +36,6 @@ matrix:
     - env: T=linux/ubuntu1604/1
     - env: T=linux/ubuntu1604py3/1
 
-    - env: T=osx/10.11/2
     - env: T=freebsd/10.3-STABLE/2
     - env: T=freebsd/11.0-STABLE/2
     - env: T=linux/centos6/2
@@ -49,7 +48,6 @@ matrix:
     - env: T=linux/ubuntu1604/2
     - env: T=linux/ubuntu1604py3/2
 
-    - env: T=osx/10.11/3
     - env: T=freebsd/10.3-STABLE/3
     - env: T=freebsd/11.0-STABLE/3
     - env: T=linux/centos6/3
diff --git a/test/utils/shippable/cloud.sh b/test/utils/shippable/cloud.sh
index 18e6269466..9782bd7ce0 100755
--- a/test/utils/shippable/cloud.sh
+++ b/test/utils/shippable/cloud.sh
@@ -5,9 +5,9 @@ set -o pipefail
 declare -a args
 IFS='/:' read -ra args <<< "$1"
 
-image="ansible/ansible:${args[1]}"
+image="${args[1]}"
 target="posix/ci/cloud/group${args[2]}/"
 
 # shellcheck disable=SC2086
-ansible-test integration --color -v --retry-on-error "${target}" --docker "${image}" ${COVERAGE:+"$COVERAGE"} ${CHANGED:+"$CHANGED"} \
-    --changed-all-target "${target}smoketest/"
+ansible-test integration --color -v --retry-on-error "${target}" ${COVERAGE:+"$COVERAGE"} ${CHANGED:+"$CHANGED"} \
+    --docker "${image}" --changed-all-target "${target}smoketest/"
diff --git a/test/utils/shippable/freebsd.sh b/test/utils/shippable/freebsd.sh
index abd1bb2a9f..603b1a08c4 100755
--- a/test/utils/shippable/freebsd.sh
+++ b/test/utils/shippable/freebsd.sh
@@ -7,8 +7,14 @@ IFS='/:' read -ra args <<< "$1"
 
 platform="${args[0]}"
 version="${args[1]}"
-target="posix/ci/group${args[2]}/"
+
+if [ "${#args[@]}" -gt 2 ]; then
+    target="posix/ci/group${args[2]}/"
+else
+    target="posix/ci/"
+fi
 
 # shellcheck disable=SC2086
 ansible-test integration --color -v --retry-on-error "${target}" ${COVERAGE:+"$COVERAGE"} ${CHANGED:+"$CHANGED"} \
-     --remote "${platform}/${version}" --remote-terminate always
+    --exclude "posix/ci/cloud/" \
+    --remote "${platform}/${version}" --remote-terminate always
diff --git a/test/utils/shippable/linux.sh b/test/utils/shippable/linux.sh
index 4acbc1d4b5..80e3b3bc4b 100755
--- a/test/utils/shippable/linux.sh
+++ b/test/utils/shippable/linux.sh
@@ -5,9 +5,15 @@ set -o pipefail
 declare -a args
 IFS='/:' read -ra args <<< "$1"
 
-image="ansible/ansible:${args[1]}"
-target="posix/ci/group${args[2]}/"
+image="${args[1]}"
+
+if [ "${#args[@]}" -gt 2 ]; then
+    target="posix/ci/group${args[2]}/"
+else
+    target="posix/ci/"
+fi
 
 # shellcheck disable=SC2086
 ansible-test integration --color -v --retry-on-error "${target}" ${COVERAGE:+"$COVERAGE"} ${CHANGED:+"$CHANGED"} \
-     --docker "${image}"
+    --exclude "posix/ci/cloud/" \
+    --docker "${image}"
diff --git a/test/utils/shippable/osx.sh b/test/utils/shippable/osx.sh
index abd1bb2a9f..603b1a08c4 100755
--- a/test/utils/shippable/osx.sh
+++ b/test/utils/shippable/osx.sh
@@ -7,8 +7,14 @@ IFS='/:' read -ra args <<< "$1"
 
 platform="${args[0]}"
 version="${args[1]}"
-target="posix/ci/group${args[2]}/"
+
+if [ "${#args[@]}" -gt 2 ]; then
+    target="posix/ci/group${args[2]}/"
+else
+    target="posix/ci/"
+fi
 
 # shellcheck disable=SC2086
 ansible-test integration --color -v --retry-on-error "${target}" ${COVERAGE:+"$COVERAGE"} ${CHANGED:+"$CHANGED"} \
-     --remote "${platform}/${version}" --remote-terminate always
+    --exclude "posix/ci/cloud/" \
+    --remote "${platform}/${version}" --remote-terminate always
diff --git a/test/utils/shippable/rhel.sh b/test/utils/shippable/rhel.sh
index a7459d72d1..603b1a08c4 100755
--- a/test/utils/shippable/rhel.sh
+++ b/test/utils/shippable/rhel.sh
@@ -7,8 +7,14 @@ IFS='/:' read -ra args <<< "$1"
 
 platform="${args[0]}"
 version="${args[1]}"
-target="posix/ci/"
+
+if [ "${#args[@]}" -gt 2 ]; then
+    target="posix/ci/group${args[2]}/"
+else
+    target="posix/ci/"
+fi
 
 # shellcheck disable=SC2086
-ansible-test integration --color -v --retry-on-error "${target}" --remote "${platform}/${version}" ${COVERAGE:+"$COVERAGE"} ${CHANGED:+"$CHANGED"} \
-    --exclude "posix/ci/cloud/"
+ansible-test integration --color -v --retry-on-error "${target}" ${COVERAGE:+"$COVERAGE"} ${CHANGED:+"$CHANGED"} \
+    --exclude "posix/ci/cloud/" \
+    --remote "${platform}/${version}" --remote-terminate always
