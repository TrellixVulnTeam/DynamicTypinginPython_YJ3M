commit 14a9c3ab9e7e101afcd7bfcaccf1b1cbd8964aeb
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Fri Sep 7 21:03:30 2012 -0400

    Line in file regexep should match a portion of the line, not the whole line!

diff --git a/library/lineinfile b/library/lineinfile
index 7675bb0481..c183bb918d 100755
--- a/library/lineinfile
+++ b/library/lineinfile
@@ -27,8 +27,8 @@ def present(module, name, regexp, line, insertafter, backup):
     f.close()
 
     mre = re.compile(regexp)
-    if not mre.match(line):
-        module.fail_json(msg="line= doesn't match regexp=")
+    if not mre.search(line):
+        module.fail_json(msg="usage error: line= doesn't match regexp (%s)" % regexp)
 
     if insertafter in ('BOF', 'EOF'):
         iare = None
