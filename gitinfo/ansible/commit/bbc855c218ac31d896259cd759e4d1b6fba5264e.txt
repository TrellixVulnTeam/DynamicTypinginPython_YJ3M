commit bbc855c218ac31d896259cd759e4d1b6fba5264e
Author: George Christou <gechrr@gmail.com>
Date:   Tue Feb 16 10:31:40 2016 +0000

    Make --diff lines of context configurable

diff --git a/lib/ansible/constants.py b/lib/ansible/constants.py
index 9b0bf4b153..116084cbd9 100644
--- a/lib/ansible/constants.py
+++ b/lib/ansible/constants.py
@@ -284,6 +284,9 @@ COLOR_DIFF_ADD    = get_config(p, 'colors', 'diff_add', 'ANSIBLE_COLOR_DIFF_ADD'
 COLOR_DIFF_REMOVE = get_config(p, 'colors', 'diff_remove', 'ANSIBLE_COLOR_DIFF_REMOVE', 'red')
 COLOR_DIFF_LINES  = get_config(p, 'colors', 'diff_lines', 'ANSIBLE_COLOR_DIFF_LINES', 'cyan')
 
+# diff
+DIFF_CONTEXT = get_config(p, 'diff', 'context', 'ANSIBLE_DIFF_CONTEXT', 3, integer=True)
+
 # non-configurable things
 MODULE_REQUIRE_ARGS       = ['command', 'shell', 'raw', 'script']
 MODULE_NO_JSON            = ['command', 'shell', 'raw']
diff --git a/lib/ansible/plugins/callback/__init__.py b/lib/ansible/plugins/callback/__init__.py
index ce0361700c..19a861c89b 100644
--- a/lib/ansible/plugins/callback/__init__.py
+++ b/lib/ansible/plugins/callback/__init__.py
@@ -144,7 +144,7 @@ class CallbackBase:
                                                       tofile=after_header,
                                                       fromfiledate='',
                                                       tofiledate='',
-                                                      n=10)
+                                                      n=C.DIFF_CONTEXT)
                         has_diff = False
                         for line in differ:
                             has_diff = True
