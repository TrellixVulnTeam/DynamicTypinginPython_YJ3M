commit 279e5e45227f8d0354d24ea954584b6839ce2814
Author: Seth Vidal <skvidal@fedoraproject.org>
Date:   Mon May 7 18:09:57 2012 -0400

    fix the get_hosts() error in get_groups returning a dict not a list of group objects

diff --git a/lib/ansible/inventory.py b/lib/ansible/inventory.py
index 21e11a1b47..6fb96d7931 100644
--- a/lib/ansible/inventory.py
+++ b/lib/ansible/inventory.py
@@ -73,14 +73,14 @@ class Inventory(object):
         hosts = {}
         patterns = pattern.replace(";",":").split(":")
 
-        for group in self.get_groups():
-             for host in group.get_hosts():
-                 for pat in patterns:
-                     if group.name == pat or pat == 'all' or self._match(host.name, pat):
-                         if not self._restriction:
-                             hosts[host.name] = host
-                         if self._restriction and host.name in self._restriction:
-                             hosts[host.name] = host
+        for (groupname, group) in self.get_groups().items():
+            for host in group.get_hosts():
+                for pat in patterns:
+                    if group.name == pat or pat == 'all' or self._match(host.name, pat):
+                        if not self._restriction:
+                            hosts[host.name] = host
+                        if self._restriction and host.name in self._restriction:
+                            hosts[host.name] = host
         return sorted(hosts.values(), key=lambda x: x.name)
 
     def get_groups(self):
