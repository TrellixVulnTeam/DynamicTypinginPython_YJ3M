commit 5b52bfad6dd1f8fd6447557948ca2b42465863cf
Author: Fabrice Flore-Th√©bault <themroc@centsix.org>
Date:   Wed Jan 17 20:49:50 2018 +0100

    azure_rm inventory should add "ansible_connection: winrm" in host_vars for windows hosts - fixes #34689 (#34691)
    
    * fix for https://github.com/ansible/ansible/issues/34689
    azure_rm inventory should add "ansible_connection: winrm" in host_vars for windows hosts
    
    * add ansible_connection: winrm - fix for https://github.com/ansible/ansible/issues/34689

diff --git a/contrib/inventory/azure_rm.py b/contrib/inventory/azure_rm.py
index d790a0a02f..a52fdec4ff 100755
--- a/contrib/inventory/azure_rm.py
+++ b/contrib/inventory/azure_rm.py
@@ -620,6 +620,7 @@ class AzureInventory(object):
 
             # Add windows details
             if machine.os_profile is not None and machine.os_profile.windows_configuration is not None:
+                host_vars['ansible_connection'] = 'winrm'
                 host_vars['windows_auto_updates_enabled'] = \
                     machine.os_profile.windows_configuration.enable_automatic_updates
                 host_vars['windows_timezone'] = machine.os_profile.windows_configuration.time_zone
