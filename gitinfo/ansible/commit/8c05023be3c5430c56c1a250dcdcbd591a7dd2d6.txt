commit 8c05023be3c5430c56c1a250dcdcbd591a7dd2d6
Author: Jonathan Mainguy <jon@soh.re>
Date:   Tue Dec 16 09:49:13 2014 -0500

    Fixed hostname for rhel5 python 2.4.3

diff --git a/lib/ansible/modules/system/hostname.py b/lib/ansible/modules/system/hostname.py
index 03577cfa8c..cd5738b43d 100644
--- a/lib/ansible/modules/system/hostname.py
+++ b/lib/ansible/modules/system/hostname.py
@@ -286,13 +286,14 @@ class OpenRCStrategy(GenericStrategy):
 
     def get_permanent_hostname(self):
         try:
-            f = open(self.HOSTNAME_FILE, 'r')
-            for line in f:
-                line = line.strip()
-                if line.startswith('hostname='):
-                    return line[10:].strip('"')
-        except Exception, err:
-            self.module.fail_json(msg="failed to read hostname: %s" % str(err))
+            try:
+                f = open(self.HOSTNAME_FILE, 'r')
+                for line in f:
+                    line = line.strip()
+                    if line.startswith('hostname='):
+                        return line[10:].strip('"')
+            except Exception, err:
+                self.module.fail_json(msg="failed to read hostname: %s" % str(err))
         finally:
             f.close()
 
@@ -300,19 +301,20 @@ class OpenRCStrategy(GenericStrategy):
 
     def set_permanent_hostname(self, name):
         try:
-            f = open(self.HOSTNAME_FILE, 'r')
-            lines = [x.strip() for x in f]
+            try:
+                f = open(self.HOSTNAME_FILE, 'r')
+                lines = [x.strip() for x in f]
 
-            for i, line in enumerate(lines):
-                if line.startswith('hostname='):
-                    lines[i] = 'hostname="%s"' % name
-                    break
-            f.close()
+                for i, line in enumerate(lines):
+                    if line.startswith('hostname='):
+                        lines[i] = 'hostname="%s"' % name
+                        break
+                f.close()
 
-            f = open(self.HOSTNAME_FILE, 'w')
-            f.write('\n'.join(lines) + '\n')
-        except Exception, err:
-            self.module.fail_json(msg="failed to update hostname: %s" % str(err))
+                f = open(self.HOSTNAME_FILE, 'w')
+                f.write('\n'.join(lines) + '\n')
+            except Exception, err:
+                self.module.fail_json(msg="failed to update hostname: %s" % str(err))
         finally:
             f.close()
 
