commit 760ea4b49e1909fa6f69c4f07c9171c1cb3715e1
Author: tdtrask <tdtrask@users.noreply.github.com>
Date:   Wed Nov 8 11:13:56 2017 -0500

    apk: Override system repositories (#32689)
    
    Override system repositories when repository option is specified. This fixes inconsistencies when using check mode.

diff --git a/lib/ansible/modules/packaging/os/apk.py b/lib/ansible/modules/packaging/os/apk.py
index 51e715c292..bc9259b639 100644
--- a/lib/ansible/modules/packaging/os/apk.py
+++ b/lib/ansible/modules/packaging/os/apk.py
@@ -40,7 +40,8 @@ options:
     default: null
   repository:
     description:
-      - A package repository or multiple repositories
+      - A package repository or multiple repositories.
+        Unlike with the underlying apk command, this list will override the system repositories rather than supplement them.
     required: false
     default: null
     version_added: "2.4"
@@ -299,7 +300,7 @@ def main():
     # add repositories to the APK_PATH
     if p['repository']:
         for r in p['repository']:
-            APK_PATH = "%s --repository %s" % (APK_PATH, r)
+            APK_PATH = "%s --repository %s --repositories-file /dev/null" % (APK_PATH, r)
 
     # normalize the state parameter
     if p['state'] in ['present', 'installed']:
