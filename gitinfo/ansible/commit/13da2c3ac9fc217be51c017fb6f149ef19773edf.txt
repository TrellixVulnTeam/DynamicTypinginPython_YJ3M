commit 13da2c3ac9fc217be51c017fb6f149ef19773edf
Author: gservat <gservat@gmail.com>
Date:   Wed Nov 27 23:44:34 2013 +1100

    Added support for parsing in the SLES patch level correctly
    
    On SLES, the setup module was returning the architecture as the distribution version (i.e. platform.dist() didn't quite return the right thing). This change checks for /etc/SuSE-release and grabs the second column in the third line as distribution_version.

diff --git a/library/system/setup b/library/system/setup
index 7b0fd70e80..90c87d486c 100755
--- a/library/system/setup
+++ b/library/system/setup
@@ -117,7 +117,8 @@ class Facts(object):
                     '/etc/system-release': 'OtherLinux',
                     '/etc/alpine-release': 'Alpine',
                     '/etc/release': 'Solaris',
-                    '/etc/arch-release': 'Archlinux' }
+                    '/etc/arch-release': 'Archlinux',
+                    '/etc/SuSE-release': 'SuSE' }
     SELINUX_MODE_DICT = { 1: 'enforcing', 0: 'permissive', -1: 'disabled' }
 
     # A list of dicts.  If there is a platform with more than one
@@ -324,6 +325,9 @@ class Facts(object):
                         self.facts['distribution'] = data.split()[0]
                         self.facts['distribution_version'] = data.split()[1]
                         self.facts['distribution_release'] = ora_prefix + data
+                    elif name == 'SuSE':
+                        data = get_file_content(path).splitlines()
+                        self.facts['distribution_version'] = data.split[2].split('=')[1].strip()
                     else:
                         self.facts['distribution'] = name
 
