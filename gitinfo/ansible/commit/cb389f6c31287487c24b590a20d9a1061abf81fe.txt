commit cb389f6c31287487c24b590a20d9a1061abf81fe
Author: Martin Krizek <martin.krizek@gmail.com>
Date:   Tue Apr 21 09:36:35 2020 +0200

    Prevent rewriting nested Block's data in filter_tagged_tasks (#68337)
    
    This patch fixes the issue where nested Block copies were created from
    incorrect Block object. This resulted in nested Blocks data like ``name``
    or ``_uuid`` to contain values from the Block the filter_tagged_tasks
    method was called on.

diff --git a/changelogs/fragments/prevent-rewriting-nested-block-data-in-filter_tagged_tasks.yml b/changelogs/fragments/prevent-rewriting-nested-block-data-in-filter_tagged_tasks.yml
new file mode 100644
index 0000000000..da8b349aa1
--- /dev/null
+++ b/changelogs/fragments/prevent-rewriting-nested-block-data-in-filter_tagged_tasks.yml
@@ -0,0 +1,2 @@
+bugfixes:
+  - Prevent rewriting nested Block's data in filter_tagged_tasks
diff --git a/lib/ansible/playbook/block.py b/lib/ansible/playbook/block.py
index 2bd7bd8a41..71fde71500 100644
--- a/lib/ansible/playbook/block.py
+++ b/lib/ansible/playbook/block.py
@@ -379,7 +379,8 @@ class Block(Base, Conditional, CollectionSearch, Taggable):
             return tmp_list
 
         def evaluate_block(block):
-            new_block = self.copy(exclude_tasks=True)
+            new_block = block.copy(exclude_parent=True, exclude_tasks=True)
+            new_block._parent = block._parent
             new_block.block = evaluate_and_append_task(block.block)
             new_block.rescue = evaluate_and_append_task(block.rescue)
             new_block.always = evaluate_and_append_task(block.always)
