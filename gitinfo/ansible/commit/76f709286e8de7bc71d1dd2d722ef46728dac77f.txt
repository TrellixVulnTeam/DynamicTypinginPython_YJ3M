commit 76f709286e8de7bc71d1dd2d722ef46728dac77f
Author: Brian Coca <bcoca@ansible.com>
Date:   Wed Mar 6 17:32:12 2013 -0500

    added check for starting $HOME for remote_tmp so as to non root sudo override
    Signed-off-by: Brian Coca <bcoca@tablethotels.com>

diff --git a/lib/ansible/runner/__init__.py b/lib/ansible/runner/__init__.py
index f06012137e..5e308c28a1 100644
--- a/lib/ansible/runner/__init__.py
+++ b/lib/ansible/runner/__init__.py
@@ -573,7 +573,7 @@ class Runner(object):
 
         basefile = 'ansible-%s-%s' % (time.time(), random.randint(0, 2**48))
         basetmp = os.path.join(C.DEFAULT_REMOTE_TMP, basefile)
-        if self.sudo and self.sudo_user != 'root':
+        if self.sudo and self.sudo_user != 'root' and basetmp.startswith('$HOME'):
             basetmp = os.path.join('/tmp', basefile)
 
         cmd = 'mkdir -p %s' % basetmp
