commit 394cb3477b28bb108e8013f8f3011297e9d8176c
Author: Chris Alfonso <christopher.alfonso@gmail.com>
Date:   Thu Apr 6 10:58:04 2017 -0600

    Fixes loginBanner plucking over eapi transport when loginBanner isn't set. (#23363)

diff --git a/lib/ansible/modules/network/eos/eos_banner.py b/lib/ansible/modules/network/eos/eos_banner.py
index 900f7c8265..66a11bfc9e 100644
--- a/lib/ansible/modules/network/eos/eos_banner.py
+++ b/lib/ansible/modules/network/eos/eos_banner.py
@@ -121,7 +121,8 @@ def map_config_to_obj(module):
         else:
             # On EAPI we need to extract the banner text from dict key
             # 'loginBanner'
-            obj['text'] = output[0]['loginBanner'].strip('\n')
+            if isinstance(output[0], dict) and 'loginBanner' in output[0].keys():
+                obj['text'] = output[0]['loginBanner'].strip('\n')
         obj['state'] = 'present'
     return obj
 
diff --git a/test/integration/group_vars/eos.yaml b/test/integration/group_vars/eos.yaml
index 67e6675ae7..614a7b22f6 100644
--- a/test/integration/group_vars/eos.yaml
+++ b/test/integration/group_vars/eos.yaml
@@ -12,4 +12,5 @@ eapi:
   password: "{{ eos_eapi_pass | default('admin') }}"
   transport: eapi
   use_ssl: no
+  port: 80
   authorize: yes
