commit 857456ea5f159bbd333528aa6111b1510e1be78b
Author: James Cammarata <jimi@sngx.net>
Date:   Wed Dec 16 18:21:47 2015 -0500

    Fixing template integration test for python 2.6 versions
    
    No longer immediately fallback to to_json if simplejson is not installed

diff --git a/lib/ansible/plugins/filter/core.py b/lib/ansible/plugins/filter/core.py
index 3ab9db5a51..dc9acb4d09 100644
--- a/lib/ansible/plugins/filter/core.py
+++ b/lib/ansible/plugins/filter/core.py
@@ -100,9 +100,11 @@ def to_nice_json(a, *args, **kw):
             else:
                 if major >= 2:
                     return simplejson.dumps(a, indent=4, sort_keys=True, *args, **kw)
+    try:
+        return json.dumps(a, indent=4, sort_keys=True, cls=AnsibleJSONEncoder, *args, **kw)
+    except:
         # Fallback to the to_json filter
         return to_json(a, *args, **kw)
-    return json.dumps(a, indent=4, sort_keys=True, cls=AnsibleJSONEncoder, *args, **kw)
 
 def bool(a):
     ''' return a bool for the arg '''
diff --git a/test/integration/roles/test_template/tasks/main.yml b/test/integration/roles/test_template/tasks/main.yml
index 28477d44e5..9fd1d860e0 100644
--- a/test/integration/roles/test_template/tasks/main.yml
+++ b/test/integration/roles/test_template/tasks/main.yml
@@ -49,13 +49,6 @@
 - name: copy known good into place
   copy: src=foo.txt dest={{output_dir}}/foo.txt
 
-# Seems that python-2.6 now outputs the same format as everywhere else?
-#  when: pyver.stdout != '2.6'
-
-#- name: copy known good into place
-#  copy: src=foo-py26.txt dest={{output_dir}}/foo.txt
-#  when: pyver.stdout == '2.6'
-
 - name: compare templated file to known good
   shell: diff {{output_dir}}/foo.templated {{output_dir}}/foo.txt
   register: diff_result
