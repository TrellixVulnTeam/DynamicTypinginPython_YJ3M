commit 6890cc81bedb9947609fd0ddaa1b9e268ca752c9
Author: Trond Hindenes <trond@hindenes.com>
Date:   Thu Oct 1 19:08:42 2015 +0200

    fixes #984

diff --git a/lib/ansible/modules/extras/windows/win_package.ps1 b/lib/ansible/modules/extras/windows/win_package.ps1
index 02bb908a94..6cdc6bf6e5 100644
--- a/lib/ansible/modules/extras/windows/win_package.ps1
+++ b/lib/ansible/modules/extras/windows/win_package.ps1
@@ -1237,10 +1237,15 @@ Set-Attr $result "changed" $false;
 
 $path = Get-Attr -obj $params -name path -failifempty $true -resultobj $result
 $name = Get-Attr -obj $params -name name -default $path
-$productid = Get-Attr -obj $params -name productid -failifempty $true -resultobj $result
+$productid = Get-Attr -obj $params -name productid
+if ($productid -eq $null)
+{
+    #Alias added for backwards compat.
+    $productid = Get-Attr -obj $params -name product_id -failifempty $true -resultobj $result
+}
 $arguments = Get-Attr -obj $params -name arguments
 $ensure = Get-Attr -obj $params -name state -default "present"
-if (!$ensure)
+if ($ensure -eq $null)
 {
     $ensure = Get-Attr -obj $params -name ensure -default "present"
 }
diff --git a/lib/ansible/modules/extras/windows/win_package.py b/lib/ansible/modules/extras/windows/win_package.py
index d20e5ee881..842aa0693d 100644
--- a/lib/ansible/modules/extras/windows/win_package.py
+++ b/lib/ansible/modules/extras/windows/win_package.py
@@ -44,9 +44,9 @@ options:
   product_id:
     description:
       - product id of the installed package (used for checking if already installed)
-    required: false
+    required: true
     default: null
-    aliases: []
+    aliases: [productid]
   arguments:
     description:
       - Any arguments the installer needs
@@ -79,7 +79,7 @@ EXAMPLES = '''
     win_package:
       name="Microsoft Visual C thingy"
       path="http://download.microsoft.com/download/1/6/B/16B06F60-3B20-4FF2-B699-5E9B7962F9AE/VSU_4/vcredist_x64.exe"
-      ProductId="{CF2BEA3C-26EA-32F8-AA9B-331F7E34BA97}"
+      Product_Id="{CF2BEA3C-26EA-32F8-AA9B-331F7E34BA97}"
       Arguments="/install /passive /norestart"
 
 
