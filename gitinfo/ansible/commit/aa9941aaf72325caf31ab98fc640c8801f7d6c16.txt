commit aa9941aaf72325caf31ab98fc640c8801f7d6c16
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Sun Jul 23 11:52:11 2017 -0700

    Fix legacy su handling (bad conditional would not fire at the right time)

diff --git a/lib/ansible/playbook/play_context.py b/lib/ansible/playbook/play_context.py
index 8618ff3795..55d27077ed 100644
--- a/lib/ansible/playbook/play_context.py
+++ b/lib/ansible/playbook/play_context.py
@@ -418,7 +418,7 @@ class PlayContext(Base):
                     if sudo_pass_name in variables:
                         setattr(new_info, 'become_pass', variables[sudo_pass_name])
                         break
-            if new_info.become_method == 'sudo':
+            elif new_info.become_method == 'su':
                 for su_pass_name in MAGIC_VARIABLE_MAPPING.get('su_pass'):
                     if su_pass_name in variables:
                         setattr(new_info, 'become_pass', variables[su_pass_name])
