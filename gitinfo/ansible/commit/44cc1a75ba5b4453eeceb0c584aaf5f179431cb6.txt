commit 44cc1a75ba5b4453eeceb0c584aaf5f179431cb6
Author: Jon Hawkesworth <jhawkesworth@users.noreply.github.com>
Date:   Thu Dec 11 21:47:52 2014 +0000

    Switched to SHA1 checksum instead of MD5

diff --git a/lib/ansible/modules/windows/win_copy.ps1 b/lib/ansible/modules/windows/win_copy.ps1
index 544187a8b5..9ffdab85f0 100644
--- a/lib/ansible/modules/windows/win_copy.ps1
+++ b/lib/ansible/modules/windows/win_copy.ps1
@@ -52,17 +52,17 @@ if (Test-Path $dest -PathType Container)
 
 If (Test-Path $dest)
 {
-    $dest_md5 = Get-FileMd5 ($dest);
-    $src_md5 = Get-FileMd5 ($src);
+    $dest_checksum = Get-FileChecksum ($dest);
+    $src_checksum = Get-FileChecksum ($src);
 
-    If (! $src_md5.CompareTo($dest_md5))
+    If (! $src_checksum.CompareTo($dest_checksum))
     {
         # New-Item -Force creates subdirs for recursive copies
         New-Item -Force $dest -Type file;
         Copy-Item -Path $src -Destination $dest -Force;
     }
-    $dest_md5 = Get-FileMd5 ($dest);
-    If ( $src_md5.CompareTo($dest_md5))
+    $dest_checksum = Get-FileChecksum ($dest);
+    If ( $src_checksum.CompareTo($dest_checksum))
     {
         $result.changed = $TRUE;
     }
@@ -78,7 +78,7 @@ Else
     $result.changed = $TRUE;
 }
 
-$dest_checksum = Get-FileMd5($dest);
+$dest_checksum = Get-FileChecksum($dest);
 $result.checksum = $dest_checksum;
 
 Exit-Json $result;
diff --git a/lib/ansible/modules/windows/win_stat.ps1 b/lib/ansible/modules/windows/win_stat.ps1
index 4e4c55b2aa..10101a62b3 100644
--- a/lib/ansible/modules/windows/win_stat.ps1
+++ b/lib/ansible/modules/windows/win_stat.ps1
@@ -53,11 +53,9 @@ Else
 
 If ($get_md5 -and $result.stat.exists -and -not $result.stat.isdir)
 {
-    $sp = new-object -TypeName System.Security.Cryptography.MD5CryptoServiceProvider;
-    $fp = [System.IO.File]::Open($path, [System.IO.Filemode]::Open, [System.IO.FileAccess]::Read);
-    $hash = [System.BitConverter]::ToString($sp.ComputeHash($fp)).Replace("-", "").ToLower();
-    $fp.Dispose();
+    $hash = Get-FileChecksum($path);
     Set-Attr $result.stat "md5" $hash;
+    Set-Attr $result.stat "checksum" $hash;
 }
 
 Exit-Json $result;
