commit 8e8a7c869ae219debf80456d3edac5804af22c2c
Author: Bobby Watson <bobbywatson3@users.noreply.github.com>
Date:   Fri Aug 18 11:06:46 2017 -0400

    Changed string check to verify that EOS device is not in config mode. (#28332)
    
    Changed string check to verify that EOS device is not in config mode. This was required in order to work with Arista 7500 series modular switches.
    Resolves #2830

diff --git a/lib/ansible/plugins/action/eos.py b/lib/ansible/plugins/action/eos.py
index 6e453980ad..15517058cc 100644
--- a/lib/ansible/plugins/action/eos.py
+++ b/lib/ansible/plugins/action/eos.py
@@ -76,7 +76,7 @@ class ActionModule(_ActionModule):
             # make sure we are in the right cli context which should be
             # enable mode and not config module
             rc, out, err = connection.exec_command('prompt()')
-            while str(out).strip().endswith(')#'):
+            while '(config' in str(out):
                 display.vvvv('wrong context, sending exit to device', self._play_context.remote_addr)
                 connection.exec_command('exit')
                 rc, out, err = connection.exec_command('prompt()')
