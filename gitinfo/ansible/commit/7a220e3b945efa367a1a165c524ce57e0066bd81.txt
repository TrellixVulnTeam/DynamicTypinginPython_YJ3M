commit 7a220e3b945efa367a1a165c524ce57e0066bd81
Author: Michael Scherer <misc@zarb.org>
Date:   Sat Nov 16 12:45:24 2013 +0100

    fix make tests to use the set of module from git checkout
    
    If someone try to run the test suit with ansible already installed,
    the mix between content in /usr/share and in the git checkout
    can result in strange failure ( as I found out the hard way ). For example,
    the test_copy module will call the action plugin for copy from git,
    who will call the 'file' module from system, passing unsupported arguments

diff --git a/Makefile b/Makefile
index fb8b55c6a7..c617b1eec9 100644
--- a/Makefile
+++ b/Makefile
@@ -62,7 +62,7 @@ NOSETESTS := nosetests
 all: clean python
 
 tests:
-	PYTHONPATH=./lib $(NOSETESTS) -d -v
+	PYTHONPATH=./lib ANSIBLE_LIBRARY=./library  $(NOSETESTS) -d -v
 
 # To force a rebuild of the docs run 'touch VERSION && make docs'
 docs: $(MANPAGES) modulepages
