commit ff024b65b2120d1f4c182f3dfa7fca8cc2fd122f
Author: Brian Coca <bcoca@ansible.com>
Date:   Sat Feb 1 17:54:41 2014 -0500

    now with_items also accepts sets
    
    Signed-off-by: Brian Coca <briancoca+dev@gmail.com>

diff --git a/lib/ansible/runner/lookup_plugins/items.py b/lib/ansible/runner/lookup_plugins/items.py
index c217521129..85e77d5380 100644
--- a/lib/ansible/runner/lookup_plugins/items.py
+++ b/lib/ansible/runner/lookup_plugins/items.py
@@ -36,8 +36,8 @@ class LookupModule(object):
     def run(self, terms, inject=None, **kwargs):
         terms = utils.listify_lookup_plugin_terms(terms, self.basedir, inject) 
 
-        if not isinstance(terms, list):
-            raise errors.AnsibleError("with_items expects a list")
+        if not isinstance(terms, list) and not isinstance(terms,set):
+            raise errors.AnsibleError("with_items expects a list or a set")
 
         return flatten(terms)
 
