commit 1102afed43f7fbf6e479d7324928a7ee127b4832
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Thu Aug 20 15:30:32 2015 -0700

    Fix for the case where plugins aren't loaded on old RHEL systems

diff --git a/lib/ansible/modules/packaging/os/yum.py b/lib/ansible/modules/packaging/os/yum.py
index 95c2faf242..cf375c73dd 100644
--- a/lib/ansible/modules/packaging/os/yum.py
+++ b/lib/ansible/modules/packaging/os/yum.py
@@ -972,10 +972,15 @@ def main():
         # loaded and plugins are discovered
         my.conf
         repoquery = None
-        if 'rhnplugin' in my.plugins._plugins:
-            repoquerybin = ensure_yum_utils(module)
-            if repoquerybin:
-                repoquery = [repoquerybin, '--show-duplicates', '--plugins', '--quiet']
+        try:
+            yum_plugins = my.plugins._plugins
+        except AttributeError:
+            pass
+        else:
+            if 'rhnplugin' in yum_plugins:
+                repoquerybin = ensure_yum_utils(module)
+                if repoquerybin:
+                    repoquery = [repoquerybin, '--show-duplicates', '--plugins', '--quiet']
 
         pkg = [ p.strip() for p in params['name']]
         exclude = params['exclude']
