commit da69f5aeae9930eb4c454bc0374cf6eff4c9a422
Author: Jordan Borean <jborean93@gmail.com>
Date:   Fri Jan 5 07:11:22 2018 +1000

    win_package: remove case sensitive check for msi extension (#34476)

diff --git a/lib/ansible/modules/windows/win_package.ps1 b/lib/ansible/modules/windows/win_package.ps1
index 9533b488c0..8a1f874045 100644
--- a/lib/ansible/modules/windows/win_package.ps1
+++ b/lib/ansible/modules/windows/win_package.ps1
@@ -173,7 +173,7 @@ Function Get-ProgramMetadata($state, $path, $product_id, $credential, $creates_p
 
     # set the location type and validate the path
     if ($path -ne $null) {
-        if ($path.EndsWith(".msi")) {
+        if ($path.EndsWith(".msi", [System.StringComparison]::CurrentCultureIgnoreCase)) {
             $metadata.msi = $true
         } else {
             $metadata.msi = $false
diff --git a/test/integration/targets/win_package/tasks/msi_tests.yml b/test/integration/targets/win_package/tasks/msi_tests.yml
index e77ff12bed..dfc05d8b56 100644
--- a/test/integration/targets/win_package/tasks/msi_tests.yml
+++ b/test/integration/targets/win_package/tasks/msi_tests.yml
@@ -267,7 +267,7 @@
 
 - name: install local msi with arguments (check mode)
   win_package:
-    path: '{{test_win_package_path}}\good.msi'
+    path: '{{test_win_package_path}}\good.MSI'
     state: present
     arguments: ADDLOCAL=Cow
   register: install_msi_argument_check
@@ -293,7 +293,7 @@
 
 - name: install local msi with arguments
   win_package:
-    path: '{{test_win_package_path}}\good.msi'
+    path: '{{test_win_package_path}}\good.MSI'
     state: present
     arguments: ADDLOCAL=Cow
   register: install_msi_argument
@@ -319,7 +319,7 @@
 
 - name: install local msi with arguments (idempotent)
   win_package:
-    path: '{{test_win_package_path}}\good.msi'
+    path: '{{test_win_package_path}}\good.MSI'
     state: present
     arguments: ADDLOCAL=Cow
   register: install_msi_argument_again
