commit bb9433f19841b4315efc32a0b2b9952bfc73c6cb
Author: James Cammarata <jimi@sngx.net>
Date:   Mon Nov 3 09:43:26 2014 -0600

    Fail in ec2 if exact_count is specified without using count_tag
    
    Fixes ansible/ansible#9431

diff --git a/lib/ansible/modules/cloud/ec2.py b/lib/ansible/modules/cloud/ec2.py
index a82b6a6b63..dccd066893 100644
--- a/lib/ansible/modules/cloud/ec2.py
+++ b/lib/ansible/modules/cloud/ec2.py
@@ -660,6 +660,11 @@ def enforce_count(module, ec2):
     count_tag = module.params.get('count_tag')
     zone = module.params.get('zone')
 
+    # fail here if the exact count was specified without filtering
+    # on a tag, as this may lead to a undesired removal of instances
+    if exact_count and count_tag is None:
+        module.fail_json(msg="you must use the 'count_tag' option with exact_count")
+
     reservations, instances = find_running_instances_by_count_tag(module, ec2, count_tag, zone)
 
     changed = None
