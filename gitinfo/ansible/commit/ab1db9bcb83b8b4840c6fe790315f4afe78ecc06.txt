commit ab1db9bcb83b8b4840c6fe790315f4afe78ecc06
Author: Martin Krizek <martin.krizek@gmail.com>
Date:   Thu Mar 22 18:19:29 2018 +0100

    yum: clean fake repos after tests run (#37770)

diff --git a/test/integration/targets/setup_rpm_repo/tasks/main.yml b/test/integration/targets/setup_rpm_repo/tasks/main.yml
index 05e310faac..fcee39c0a1 100644
--- a/test/integration/targets/setup_rpm_repo/tasks/main.yml
+++ b/test/integration/targets/setup_rpm_repo/tasks/main.yml
@@ -70,4 +70,11 @@
       description: "fake-ppc64"
       baseurl: "file://{{ repodir_ppc64 }}"
       gpgcheck: no
+
+  - set_fact:
+      repos:
+        - "fake-{{ ansible_architecture }}"
+        - "fake-i686"
+        - "fake-ppc64"
+
   when: ansible_distribution in ['RedHat', 'CentOS', 'ScientificLinux', 'Fedora']
diff --git a/test/integration/targets/yum/tasks/main.yml b/test/integration/targets/yum/tasks/main.yml
index 970c178211..4c0376ebc1 100644
--- a/test/integration/targets/yum/tasks/main.yml
+++ b/test/integration/targets/yum/tasks/main.yml
@@ -48,7 +48,14 @@
     - ansible_distribution in ['RedHat', 'CentOS', 'ScientificLinux', 'Fedora']
     - ansible_python.version.major == 2
 
-- include: 'repo.yml'
+- block:
+    - include: 'repo.yml'
+  always:
+    - yum_repository:
+        name: "{{ item }}"
+        state: absent
+      with_items: "{{ repos }}"
+    - command: yum clean metadata
   when:
     - ansible_distribution in ['RedHat', 'CentOS', 'ScientificLinux', 'Fedora']
     - ansible_python.version.major == 2
