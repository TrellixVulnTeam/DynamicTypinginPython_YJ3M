commit 74be5a40f9d7ae993b72fa2c1765c1ba5deed8bd
Author: Toopy <toopy@users.noreply.github.com>
Date:   Tue Sep 20 16:50:42 2016 +0200

    Fix git get_diff TypeError when fetch (#4881)

diff --git a/lib/ansible/modules/source_control/git.py b/lib/ansible/modules/source_control/git.py
index 5c5618403a..8b85df27f4 100644
--- a/lib/ansible/modules/source_control/git.py
+++ b/lib/ansible/modules/source_control/git.py
@@ -424,7 +424,8 @@ def get_diff(module, git_path, dest, repo, remote, depth, bare, before, after):
         return { 'prepared': '>> Newly checked out %s' % after }
     elif before != after:
         # Ensure we have the object we are referring to during git diff !
-        fetch(git_path, module, repo, dest, after, remote, depth, bare, '')
+        git_version_used = git_version(git_path, module)
+        fetch(git_path, module, repo, dest, after, remote, depth, bare, '', git_version_used)
         cmd = '%s diff %s %s' % (git_path, before, after)
         (rc, out, err) = module.run_command(cmd, cwd=dest)
         if rc == 0 and out:
