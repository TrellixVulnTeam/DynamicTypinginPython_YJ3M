commit 4d952d6e6e1747b28ea4ca20442529e01bf87a6d
Author: Matthew Martin <phy1729@gmail.com>
Date:   Thu Jul 21 10:54:40 2016 -0500

    Add CAPABILITY_NAMED_IAM to cloudformation capabilities
    
    While from the documentation[1] one would assume that replacing
    CAPABILITY_IAM with CAPABILITY_NAMED_IAM; this as empirically been shown
    to not be the case.
    
    1: "If you have IAM resources, you can specify either capability. If you
    have IAM resources with custom names, you must specify
    CAPABILITY_NAMED_IAM."
    http://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStack.html

diff --git a/lib/ansible/modules/cloud/amazon/cloudformation.py b/lib/ansible/modules/cloud/amazon/cloudformation.py
index cdc24bbc7d..580ec55b24 100644
--- a/lib/ansible/modules/cloud/amazon/cloudformation.py
+++ b/lib/ansible/modules/cloud/amazon/cloudformation.py
@@ -329,7 +329,7 @@ def main():
                              stack_policy_body=stack_policy_body,
                              template_url=template_url,
                              disable_rollback=disable_rollback,
-                             capabilities=['CAPABILITY_IAM'],
+                             capabilities=['CAPABILITY_IAM', 'CAPABILITY_NAMED_IAM'],
                              **kwargs)
             operation = 'CREATE'
         except Exception as err:
@@ -352,7 +352,7 @@ def main():
                              stack_policy_body=stack_policy_body,
                              disable_rollback=disable_rollback,
                              template_url=template_url,
-                             capabilities=['CAPABILITY_IAM'])
+                             capabilities=['CAPABILITY_IAM', 'CAPABILITY_NAMED_IAM'])
             operation = 'UPDATE'
         except Exception as err:
             error_msg = boto_exception(err)
