commit 21dcfd7192c2546f5394039edefd27c51e9eb018
Author: James Cammarata <jimi@sngx.net>
Date:   Thu Sep 25 15:42:45 2014 -0500

    Adding integration tests for async fire-and-forget checking
    
    Also updated the CHANGELOG for the feature

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 03564893b0..0b84708e22 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -16,6 +16,7 @@ Major changes:
 * command_warnings feature will warn about when usage of the shell/command module can be simplified to use core modules - this can be enabled in ansible.cfg
 * new omit value can be used to leave off a parameter when not set, like so module_name: a=1 b={{ c | default(omit) }}, would not pass value for b (not even an empty value) if c was not set.
 * developers: 'baby JSON' in module responses, originally intended for writing modules in bash, is removed as a feature to simplify logic, script module remains available for running bash scripts.
+* async jobs started in "fire & forget" mode can now be checked on at a later time.
 
 New Modules:
 
diff --git a/test/integration/roles/test_async/tasks/main.yml b/test/integration/roles/test_async/tasks/main.yml
index 556284770a..0b9991ec04 100644
--- a/test/integration/roles/test_async/tasks/main.yml
+++ b/test/integration/roles/test_async/tasks/main.yml
@@ -62,3 +62,28 @@
   async: 15
   poll: 0
   when: False
+
+# test async "fire and forget, but check later"
+
+- name: 'start a task with "fire-and-forget"'
+  command: sleep 15
+  async: 30
+  poll: 0
+  register: fnf_task
+
+- name: assert task was successfully started
+  assert:
+    that:
+    - fnf_task.started
+    - "'ansible_job_id' in fnf_task"
+
+- name: 'check on task started as a "fire-and-forget"'
+  async_status: jid={{ fnf_task.ansible_job_id }}
+  register: fnf_result
+  until: fnf_result.finished
+  retries: 30
+
+- name: assert task was successfully checked
+  assert:
+    that:
+    - fnf_result.finished
