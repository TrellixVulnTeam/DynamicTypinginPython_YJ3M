commit 0d3d0025055e03f778ef8f13abc4e8adb2f774b8
Author: Yuwei Zhou <yuwzho@microsoft.com>
Date:   Wed Apr 24 14:15:13 2019 +0800

    add resource group test (#55688)

diff --git a/lib/ansible/modules/cloud/azure/azure_rm_resourcegroup_facts.py b/lib/ansible/modules/cloud/azure/azure_rm_resourcegroup_facts.py
index 73bfa25f16..d051e73382 100644
--- a/lib/ansible/modules/cloud/azure/azure_rm_resourcegroup_facts.py
+++ b/lib/ansible/modules/cloud/azure/azure_rm_resourcegroup_facts.py
@@ -145,7 +145,8 @@ class AzureRMResourceGroupFacts(AzureRMModuleBase):
 
         self.results = dict(
             changed=False,
-            ansible_facts=dict(azure_resourcegroups=[])
+            ansible_facts=dict(azure_resourcegroups=[]),
+            resourcegroups=[]
         )
 
         self.name = None
@@ -170,6 +171,8 @@ class AzureRMResourceGroupFacts(AzureRMModuleBase):
             for item in self.results['ansible_facts']['azure_resourcegroups']:
                 item['resources'] = self.list_by_rg(item['name'])
 
+        self.results['resourcegroups'] = self.results['ansible_facts']['azure_resourcegroups']
+
         return self.results
 
     def get_item(self):
diff --git a/test/integration/targets/azure_rm_resourcegroup/aliases b/test/integration/targets/azure_rm_resourcegroup/aliases
new file mode 100644
index 0000000000..3b0b9bf381
--- /dev/null
+++ b/test/integration/targets/azure_rm_resourcegroup/aliases
@@ -0,0 +1,4 @@
+cloud/azure
+shippable/azure/group3
+destructive
+azure_rm_resourcegroup_facts
diff --git a/test/integration/targets/azure_rm_resourcegroup/meta/main.yml b/test/integration/targets/azure_rm_resourcegroup/meta/main.yml
new file mode 100644
index 0000000000..95e1952f98
--- /dev/null
+++ b/test/integration/targets/azure_rm_resourcegroup/meta/main.yml
@@ -0,0 +1,2 @@
+dependencies:
+  - setup_azure
diff --git a/test/integration/targets/azure_rm_resourcegroup/tasks/main.yml b/test/integration/targets/azure_rm_resourcegroup/tasks/main.yml
new file mode 100644
index 0000000000..db4512701d
--- /dev/null
+++ b/test/integration/targets/azure_rm_resourcegroup/tasks/main.yml
@@ -0,0 +1,39 @@
+- name: Get resource group facts
+  azure_rm_resourcegroup_facts:
+  register: rg
+
+- assert:
+    that:
+        - rg.resourcegroups | length >= 1
+
+- name: Get resource group facts
+  azure_rm_resourcegroup_facts:
+      name: "{{ resource_group }}"
+      list_resources: yes
+  register: rg
+
+- assert:
+    that:
+        - rg.resourcegroups | length == 1
+        - rg.resourcegroups[0].resources | length >= 0
+
+- name: Create resource group (idempontent)
+  azure_rm_resourcegroup:
+      name: "{{ resource_group }}"
+      location: "{{ rg.resourcegroups[0].location }}"
+  register: output
+
+- assert:
+    that:
+        - not output.changed
+
+- name: delete resource group
+  azure_rm_resourcegroup:
+      name: "{{ resource_group }}"
+      state: absent
+  check_mode: yes
+  register: output
+
+- assert:
+    that:
+        - output.changed
\ No newline at end of file
