commit 2ef438c9628833f38e46cac83b8db5ce76f75f66
Author: Matt Clay <matt@mystile.com>
Date:   Fri Nov 17 12:50:42 2017 -0800

    Improve zypper refresh/clean for opensuse images.

diff --git a/test/utils/docker/opensuse42.2/Dockerfile b/test/utils/docker/opensuse42.2/Dockerfile
index 215b44fa20..80e090b8c8 100644
--- a/test/utils/docker/opensuse42.2/Dockerfile
+++ b/test/utils/docker/opensuse42.2/Dockerfile
@@ -1,6 +1,6 @@
 FROM opensuse:42.2
 
-RUN zypper --non-interactive --gpg-auto-import-keys refresh && \
+RUN zypper --non-interactive --gpg-auto-import-keys refresh --services --force && \
     zypper --non-interactive install --force systemd-sysvinit && \
     zypper --non-interactive install --auto-agree-with-licenses --no-recommends \
     acl \
@@ -47,7 +47,7 @@ RUN zypper --non-interactive --gpg-auto-import-keys refresh && \
     which \
     zip \
     && \
-    zypper clean
+    zypper clean --all
 
 # systemd path differs from rhel
 ENV LIBSYSTEMD=/usr/lib/systemd/system
diff --git a/test/utils/docker/opensuse42.3/Dockerfile b/test/utils/docker/opensuse42.3/Dockerfile
index 7c12ce2120..0bc5b7bdea 100644
--- a/test/utils/docker/opensuse42.3/Dockerfile
+++ b/test/utils/docker/opensuse42.3/Dockerfile
@@ -1,6 +1,6 @@
 FROM opensuse:42.3
 
-RUN zypper --non-interactive --gpg-auto-import-keys refresh && \
+RUN zypper --non-interactive --gpg-auto-import-keys refresh --services --force && \
     zypper --non-interactive install --force systemd-sysvinit && \
     zypper --non-interactive install --auto-agree-with-licenses --no-recommends \
     acl \
@@ -47,7 +47,7 @@ RUN zypper --non-interactive --gpg-auto-import-keys refresh && \
     which \
     zip \
     && \
-    zypper clean
+    zypper clean --all
 
 # systemd path differs from rhel
 ENV LIBSYSTEMD=/usr/lib/systemd/system
