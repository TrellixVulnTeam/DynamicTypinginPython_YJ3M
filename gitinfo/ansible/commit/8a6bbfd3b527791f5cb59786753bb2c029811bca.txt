commit 8a6bbfd3b527791f5cb59786753bb2c029811bca
Author: Yasser Nabi <yassersaleemi@gmail.com>
Date:   Thu Jul 17 17:53:12 2014 +0100

    Enable puppet facts
    
    Currently facter facts omit facts that a distributed via Puppet. This
    commit adds the `--puppet` option.
    
    In cases where puppet is not installed, the command sends a warning to
    STDERR *but* completes successfully. So should not cause any issues.
    
    The benefit is, filtering can be done based on facts set by Puppet.

diff --git a/library/system/setup b/library/system/setup
index 3194500cb2..486304230b 100644
--- a/library/system/setup
+++ b/library/system/setup
@@ -91,7 +91,7 @@ def run_setup(module):
     # if facter is installed, and we can use --json because
     # ruby-json is ALSO installed, include facter data in the JSON
     if facter_path is not None:
-        rc, out, err = module.run_command(facter_path + " --json")
+        rc, out, err = module.run_command(facter_path + " --puppet --json")
         facter = True
         try:
             facter_ds = json.loads(out)
