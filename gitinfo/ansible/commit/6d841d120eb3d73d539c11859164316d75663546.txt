commit 6d841d120eb3d73d539c11859164316d75663546
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Wed Mar 12 11:57:28 2014 -0400

    Don't process shell commands as arrays.

diff --git a/lib/ansible/module_utils/basic.py b/lib/ansible/module_utils/basic.py
index 09bdde6cd3..2d45987314 100644
--- a/lib/ansible/module_utils/basic.py
+++ b/lib/ansible/module_utils/basic.py
@@ -1019,7 +1019,8 @@ class AnsibleModule(object):
             self.fail_json(rc=257, cmd=args, msg=msg)
 
         # expand things like $HOME and ~
-        args = [ os.path.expandvars(os.path.expanduser(x)) for x in args ]
+        if not shell:
+            args = [ os.path.expandvars(os.path.expanduser(x)) for x in args ]
 
         rc = 0
         msg = None
