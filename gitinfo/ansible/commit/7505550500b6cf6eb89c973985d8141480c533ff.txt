commit 7505550500b6cf6eb89c973985d8141480c533ff
Author: Abhijeet Kasurde <akasurde@redhat.com>
Date:   Tue Apr 30 19:43:07 2019 +0530

    VMware: Handle VMs with no configurations
    
    Sometime VMs does not return any configurations which leads
    to failing the inventory plugin.
    
    Signed-off-by: Abhijeet Kasurde <akasurde@redhat.com>

diff --git a/lib/ansible/plugins/inventory/vmware_vm_inventory.py b/lib/ansible/plugins/inventory/vmware_vm_inventory.py
index 1c004d5467..c791bde354 100644
--- a/lib/ansible/plugins/inventory/vmware_vm_inventory.py
+++ b/lib/ansible/plugins/inventory/vmware_vm_inventory.py
@@ -411,6 +411,10 @@ class InventoryModule(BaseInventoryPlugin, Cacheable):
                 # VMware does not provide a way to uniquely identify VM by its name
                 # i.e. there can be two virtual machines with same name
                 # Appending "_" and VMware UUID to make it unique
+                if not vm_obj.obj.config:
+                    # Sometime orphaned VMs return no configurations
+                    continue
+
                 current_host = vm_obj_property.val + "_" + vm_obj.obj.config.uuid
 
                 if current_host not in hostvars:
