commit 8b4bd2ec3e98005abed10f0133efa4f3688915fe
Author: Pepe Barbe <dev@antropoide.net>
Date:   Mon Jan 21 22:27:07 2013 -0600

    module needs to be passed to local_nvra

diff --git a/library/yum b/library/yum
index 5c310c8409..45d0ae795d 100644
--- a/library/yum
+++ b/library/yum
@@ -262,7 +262,7 @@ def what_provides(module, repoq, req_spec, conf_file,  qf=def_qf, en_repos=[], d
 
     return []
 
-def local_nvra(path):
+def local_nvra(module, path):
     """return nvra of a local rpm passed in"""
     
     cmd = ['/bin/rpm', '-qp' ,'--qf', 
@@ -343,7 +343,7 @@ def install(module, items, repoq, yum_basecmd, conf_file, en_repos, dis_repos):
                 res['msg'] += "No Package file matching '%s' found on system" % spec
                 module.fail_json(**res)
 
-            nvra = local_nvra(spec)
+            nvra = local_nvra(module, spec)
             # look for them in the rpmdb
             if is_installed(module, repoq, nvra, conf_file, en_repos=en_repos, dis_repos=dis_repos):
                 # if they are there, skip it
