commit bac2e02900100b28e5d45826f0826ebc44e80aa0
Author: njferrant <40184954+njferrant@users.noreply.github.com>
Date:   Mon Jan 6 16:41:02 2020 -0500

    vmware_guest: exclude dvswitch_name from guest os customization (#65997)
    
    - exclude dvswitch_name from guest os customization
    - add changelog fragment for ansible PR#65997

diff --git a/changelogs/fragments/65997-vmware_guest-exclude-dvswitch-name-from-os-customization.yml b/changelogs/fragments/65997-vmware_guest-exclude-dvswitch-name-from-os-customization.yml
new file mode 100644
index 0000000000..f1260d20ae
--- /dev/null
+++ b/changelogs/fragments/65997-vmware_guest-exclude-dvswitch-name-from-os-customization.yml
@@ -0,0 +1,2 @@
+bugfixes:
+  - vmware_guest - Exclude dvswitch_name from triggering guest os customization.
diff --git a/lib/ansible/modules/cloud/vmware/vmware_guest.py b/lib/ansible/modules/cloud/vmware/vmware_guest.py
index d4c2cb0abf..5f2d0d82ef 100644
--- a/lib/ansible/modules/cloud/vmware/vmware_guest.py
+++ b/lib/ansible/modules/cloud/vmware/vmware_guest.py
@@ -2432,7 +2432,7 @@ class PyVmomiHelper(PyVmomi):
                 if key == 'type' and nw['type'] == 'dhcp':
                     network_changes = True
                     break
-                if key not in ('device_type', 'mac', 'name', 'vlan', 'type', 'start_connected'):
+                if key not in ('device_type', 'mac', 'name', 'vlan', 'type', 'start_connected', 'dvswitch_name'):
                     network_changes = True
                     break
 
@@ -2701,7 +2701,7 @@ class PyVmomiHelper(PyVmomi):
         for nw in self.params['networks']:
             for key in nw:
                 # We don't need customizations for these keys
-                if key not in ('device_type', 'mac', 'name', 'vlan', 'type', 'start_connected'):
+                if key not in ('device_type', 'mac', 'name', 'vlan', 'type', 'start_connected', 'dvswitch_name'):
                     network_changes = True
                     break
         if len(self.params['customization']) > 1 or network_changes or self.params.get('customization_spec'):
