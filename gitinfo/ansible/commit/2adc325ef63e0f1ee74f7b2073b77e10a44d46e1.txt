commit 2adc325ef63e0f1ee74f7b2073b77e10a44d46e1
Author: Florian Dambrine <android.florian@gmail.com>
Date:   Thu Sep 8 04:25:17 2016 -0600

    Fix ec2 module source_dest_check when running on non VPC instances (EC2 Classic) (#3243)

diff --git a/lib/ansible/modules/cloud/amazon/ec2.py b/lib/ansible/modules/cloud/amazon/ec2.py
index d6e9ee2249..79484c809d 100755
--- a/lib/ansible/modules/cloud/amazon/ec2.py
+++ b/lib/ansible/modules/cloud/amazon/ec2.py
@@ -1306,7 +1306,7 @@ def startstop_instances(module, ec2, instance_ids, state, instance_tags):
         for inst in res.instances:
 
             # Check "source_dest_check" attribute
-            if inst.get_attribute('sourceDestCheck')['sourceDestCheck'] != source_dest_check:
+            if inst.vpc_id is not None and inst.get_attribute('sourceDestCheck')['sourceDestCheck'] != source_dest_check:
                 inst.modify_attribute('sourceDestCheck', source_dest_check)
                 changed = True
 
