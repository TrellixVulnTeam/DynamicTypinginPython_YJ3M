commit 73dbab702f8469c8ce99ffc0e1d8da1d4fa82d62
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Mon Oct 28 09:08:03 2013 -0400

    Don't run lookup plugins while trying to simplify the input datastructure.

diff --git a/lib/ansible/utils/template.py b/lib/ansible/utils/template.py
index 019c8d02ea..1b422bf577 100644
--- a/lib/ansible/utils/template.py
+++ b/lib/ansible/utils/template.py
@@ -324,7 +324,7 @@ def _fix_ds(basedir, vars, original, depth=0):
         return dict([ (k, fix_ds(basedir, v, original, depth=depth+1)) for (k,v) in vars.iteritems() ])
     if isinstance(vars, (dict, tuple)):
         return [ fix_ds(basedir, x,original, depth=depth+1) for x in vars ]
-    if isinstance(vars, basestring) and "{{" in vars and not "|" in vars:
+    if isinstance(vars, basestring) and "{{" in vars and not "|" in vars and not "lookup(" in vars:
         return lightweight_var_template(basedir, vars, original)
     return vars
 
