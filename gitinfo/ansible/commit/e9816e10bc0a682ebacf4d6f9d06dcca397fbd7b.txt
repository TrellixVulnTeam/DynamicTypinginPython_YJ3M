commit e9816e10bc0a682ebacf4d6f9d06dcca397fbd7b
Author: linnil1 <linnil1.886@gmail.com>
Date:   Fri Mar 15 01:34:47 2019 +0800

    junos_user add condition when user = root (#53111)
    
    * junos_user add condition when user = root
    
    * Modify the failure message. Thanks NilashishC.

diff --git a/lib/ansible/modules/network/junos/junos_user.py b/lib/ansible/modules/network/junos/junos_user.py
index ac32a1bede..aaef0faf6f 100644
--- a/lib/ansible/modules/network/junos/junos_user.py
+++ b/lib/ansible/modules/network/junos/junos_user.py
@@ -202,11 +202,16 @@ def map_obj_to_ele(module, want):
         else:
             operation = 'merge'
 
-        user = SubElement(login, 'user', {'operation': operation})
-
-        SubElement(user, 'name').text = item['name']
+        if item['name'] != 'root':
+            user = SubElement(login, 'user', {'operation': operation})
+            SubElement(user, 'name').text = item['name']
+        else:
+            user = auth = SubElement(element, 'root-authentication', {'operation': operation})
 
         if operation == 'merge':
+            if item['name'] == 'root' and (not item['active'] or item['role'] or item['full_name']):
+                module.fail_json(msg="'root' account cannot be deactivated or be assigned a role and a full name")
+
             if item['active']:
                 user.set('active', 'active')
             else:
@@ -219,7 +224,8 @@ def map_obj_to_ele(module, want):
                 SubElement(user, 'full-name').text = item['full_name']
 
             if item.get('sshkey'):
-                auth = SubElement(user, 'authentication')
+                if 'auth' not in locals():
+                    auth = SubElement(user, 'authentication')
                 if 'ssh-rsa' in item['sshkey']:
                     ssh_rsa = SubElement(auth, 'ssh-rsa')
                 elif 'ssh-dss' in item['sshkey']:
