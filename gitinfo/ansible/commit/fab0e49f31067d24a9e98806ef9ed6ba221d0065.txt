commit fab0e49f31067d24a9e98806ef9ed6ba221d0065
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Sun Sep 6 09:08:34 2015 -0700

    Potential fix for amazon linux's rpm doing something strange with the python_sitelib macro #12166

diff --git a/packaging/rpm/ansible.spec b/packaging/rpm/ansible.spec
index ddda6eeb79..cdfd413d49 100644
--- a/packaging/rpm/ansible.spec
+++ b/packaging/rpm/ansible.spec
@@ -93,6 +93,17 @@ are transferred to managed machines automatically.
 
 %install
 %{__python} setup.py install -O1 --prefix=%{_prefix} --root=%{buildroot}
+
+# Amazon Linux doesn't install to dist-packages but python_sitelib expands to
+# that location and the python interpreter expects things to be there.
+if expr x'%{python_sitelib}' : 'x.*dist-packages/\?' ; then
+    DEST_DIR='%{buildroot}%{python_sitelib}'
+    SOURCE_DIR=$(echo "$DEST_DIR" | sed 's/dist-packages/site-packages/g')
+    if test -d "$SOURCE_DIR" -a ! -d "$DEST_DIR" ; then
+        mv $SOURCE_DIR $DEST_DIR
+    fi
+fi
+
 mkdir -p %{buildroot}/etc/ansible/
 cp examples/hosts %{buildroot}/etc/ansible/
 cp examples/ansible.cfg %{buildroot}/etc/ansible/
