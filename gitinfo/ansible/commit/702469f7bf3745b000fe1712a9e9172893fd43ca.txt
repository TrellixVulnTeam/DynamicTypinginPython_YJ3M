commit 702469f7bf3745b000fe1712a9e9172893fd43ca
Author: Jonathan Palley <jpalley@gmail.com>
Date:   Thu Oct 18 20:08:57 2012 +0800

    symlink fix

diff --git a/library/file b/library/file
index 5fbbf0fbb1..e9def9b978 100755
--- a/library/file
+++ b/library/file
@@ -340,7 +340,7 @@ def main():
     if src:
         src = os.path.expanduser(src)
 
-    if src is not None and os.path.isdir(path):
+    if src is not None and os.path.isdir(path) and state != "link":
         params['path'] = path = os.path.join(path, os.path.basename(src))
 
     mode   = params.get('mode', None)
