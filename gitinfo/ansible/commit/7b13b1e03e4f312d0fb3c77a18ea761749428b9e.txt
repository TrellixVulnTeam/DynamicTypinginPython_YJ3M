commit 7b13b1e03e4f312d0fb3c77a18ea761749428b9e
Author: James Cammarata <jimi@sngx.net>
Date:   Wed Sep 4 11:21:49 2013 -0500

    Minor fix to dependency dupe patch

diff --git a/lib/ansible/playbook/play.py b/lib/ansible/playbook/play.py
index 80aba0aca2..ea069f3221 100644
--- a/lib/ansible/playbook/play.py
+++ b/lib/ansible/playbook/play.py
@@ -183,14 +183,13 @@ class Play(object):
                 if data:
                     dependencies = data.get('dependencies',[])
                     for dep in dependencies:
+                        allow_dupes = False
                         (dep_path,dep_vars) = self._get_role_path(dep)
                         meta = self._resolve_main(utils.path_dwim(self.basedir, os.path.join(dep_path, 'meta')))
                         if os.path.isfile(meta):
                             meta_data = utils.parse_yaml_from_file(meta)
                             if meta_data:
                                 allow_dupes = utils.boolean(meta_data.get('allow_duplicates',''))
-                        else:
-                            allow_dupes = False
 
                         if not allow_dupes:
                             if dep in self.included_roles:
