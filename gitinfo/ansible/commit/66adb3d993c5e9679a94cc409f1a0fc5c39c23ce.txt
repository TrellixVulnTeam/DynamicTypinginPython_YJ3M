commit 66adb3d993c5e9679a94cc409f1a0fc5c39c23ce
Author: John R Barker <john@johnrbarker.com>
Date:   Mon Jul 31 14:26:15 2017 +0100

    Correctly reference variables (#27486)

diff --git a/lib/ansible/module_utils/aci.py b/lib/ansible/module_utils/aci.py
index c749071bad..71d78c50a6 100644
--- a/lib/ansible/module_utils/aci.py
+++ b/lib/ansible/module_utils/aci.py
@@ -209,15 +209,15 @@ class ACIModule(object):
 
         # Handle APIC response
         if query['status'] != 200:
-            result['response'] = query['msg']
-            result['status'] = query['status']
+            self.result['response'] = query['msg']
+            self.result['status'] = query['status']
             try:
                 # APIC error
                 aci_response_json(self.result, query['body'])
-                module.fail_json(msg='Query failed: %(error_code)s %(error_text)s' % self.result, **self.result)
+                self.module.fail_json(msg='Query failed: %(error_code)s %(error_text)s' % self.result, **self.result)
             except KeyError:
                 # Connection error
-                module.fail_json(msg='Query failed for %(url)s. %(msg)s' % query)
+                self.module.fail_json(msg='Query failed for %(url)s. %(msg)s' % query)
 
         query = json.loads(resp.read())
 
