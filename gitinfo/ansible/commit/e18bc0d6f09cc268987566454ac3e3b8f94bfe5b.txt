commit e18bc0d6f09cc268987566454ac3e3b8f94bfe5b
Author: Robin Roth <robin@rroth.de>
Date:   Fri Dec 9 15:47:56 2016 +0100

    Add test for auto_import_keys in zypper_repository (#17898)
    
    * tests the bug found in ansible/ansible-modules-extras#3086

diff --git a/test/integration/targets/zypper_repository/tasks/zypper_repository.yml b/test/integration/targets/zypper_repository/tasks/zypper_repository.yml
index 027a11ce55..36cd09f810 100644
--- a/test/integration/targets/zypper_repository/tasks/zypper_repository.yml
+++ b/test/integration/targets/zypper_repository/tasks/zypper_repository.yml
@@ -3,13 +3,13 @@
 - name: ensure zypper ref works
   command: zypper -n ref
 
-- name: Delete
+- name: Delete test repo
   zypper_repository:
     name: test
     state: absent
   register: zypper_result
 
-- name: Add repo
+- name: Add test repo
   zypper_repository:
     name: test
     state: present
@@ -23,7 +23,7 @@
     that:
       - "zypper_result.changed"
 
-- name: Add repo again
+- name: Add same repo again
   zypper_repository:
     name: test
     state: present
@@ -141,3 +141,14 @@
 
 - name: ensure zypper ref still works
   command: zypper -n ref
+
+- name: "Test adding a repo with custom GPG key"
+  zypper_repository:
+    name: "Apache_Modules"
+    repo: "http://download.opensuse.org/repositories/Apache:/Modules/openSUSE_Tumbleweed/"
+    priority: 100
+    auto_import_keys: true
+    state: "present"
+
+- name: ensure zypper ref still works
+  command: zypper -n ref
