commit d0d036fd3f38c9dd4fe8a6f03c6be78c6518d3af
Author: Daniel Hokka Zakrisson <daniel@hozac.com>
Date:   Fri Jun 8 01:21:38 2012 +0200

    Expand $item for copy and fetch

diff --git a/lib/ansible/runner/__init__.py b/lib/ansible/runner/__init__.py
index c49abf1764..1cef0ee391 100644
--- a/lib/ansible/runner/__init__.py
+++ b/lib/ansible/runner/__init__.py
@@ -430,6 +430,9 @@ class Runner(object):
                 results=dict(failed=True, msg="could not find src in first_available_file list")
                 return ReturnData(host=conn.host, is_error=True, results=results)
         
+        if self.module_vars is not None:
+            inject.update(self.module_vars)
+
         source = utils.template(source, inject, self.setup_cache)
 
         # transfer the file to a remote tmp location
@@ -464,6 +467,8 @@ class Runner(object):
 
         # apply templating to source argument
         inject = self.setup_cache.get(conn.host,{})
+        if self.module_vars is not None:
+            inject.update(self.module_vars)
         source = utils.template(source, inject, self.setup_cache)
 
         # apply templating to dest argument
