commit 0bc9223826da6112aeb5dc37c290904efbb7526b
Author: Thomas Quinot <quinot@adacore.com>
Date:   Fri Sep 11 13:29:34 2015 +0200

    Test for Python must be against basename of interpreter
    
    Followup on issue #12076

diff --git a/lib/ansible/executor/module_common.py b/lib/ansible/executor/module_common.py
index 22f8c2213b..c66cd2e3be 100644
--- a/lib/ansible/executor/module_common.py
+++ b/lib/ansible/executor/module_common.py
@@ -192,7 +192,7 @@ def modify_module(module_path, module_args, task_vars=dict(), strip_comments=Fal
                 interpreter = to_bytes(task_vars[interpreter_config], errors='strict')
                 lines[0] = shebang = b"#!{0} {1}".format(interpreter, b" ".join(args[1:]))
 
-            if interpreter.startswith('python'):
+            if os.path.basename(interpreter).startswith('python'):
                 lines.insert(1, ENCODING_STRING)
         else:
             # No shebang, assume a binary module?
