commit 582557bc09beeccf0d3d044eb8e1f662090195e0
Author: Dag Wieers <dag@wieers.com>
Date:   Fri Feb 24 08:35:19 2017 +0100

    win_file_version: Clean up and check-mode support (#21379)
    
    * win_file_version: Clean up parameter handling and $result hash
    
    Changes include:
    - Replacing $result PSObject with hash
    - Use Gt-AnsibleParam using -type
    
    * Revert to original formatting

diff --git a/lib/ansible/modules/windows/win_file_version.ps1 b/lib/ansible/modules/windows/win_file_version.ps1
index 21145913bf..2ad66e239f 100644
--- a/lib/ansible/modules/windows/win_file_version.ps1
+++ b/lib/ansible/modules/windows/win_file_version.ps1
@@ -19,14 +19,14 @@
 # WANT_JSON
 # POWERSHELL_COMMON
 
-$params = Parse-Args $args;
+$params = Parse-Args $args -supports_check_mode $true
 
-$result = New-Object psobject @{
-    win_file_version = New-Object psobject
+$result = @{
+    win_file_version = @{}
     changed = $false
 }
 
-$path = Get-AnsibleParam $params "path" -type "path" -failifempty $true -resultobj $result
+$path = Get-AnsibleParam -obj $params -name "path" -type "path" -failifempty $true -resultobj $result
 
 If (-Not (Test-Path -Path $path -PathType Leaf)){
     Fail-Json $result "Specfied path $path does exist or is not a file."
@@ -67,12 +67,11 @@ Catch{
     Fail-Json $result "Error: $_.Exception.Message"
 }
 
-Set-Attr $result.win_file_version "path" $path.toString()
-Set-Attr $result.win_file_version "file_version" $file_version.toString()
-Set-Attr $result.win_file_version "product_version" $product_version.toString()
-Set-Attr $result.win_file_version "file_major_part" $file_major_part.toString()
-Set-Attr $result.win_file_version "file_minor_part" $file_minor_part.toString()
-Set-Attr $result.win_file_version "file_build_part" $file_build_part.toString()
-Set-Attr $result.win_file_version "file_private_part" $file_private_part.toString()
+$result.win_file_version.path = $path.toString()
+$result.win_file_version.file_version = $file_version.toString()
+$result.win_file_version.product_version = $product_version.toString()
+$result.win_file_version.file_major_part = $file_major_part.toString()
+$result.win_file_version.file_minor_part = $file_minor_part.toString()
+$result.win_file_version.file_build_part = $file_build_part.toString()
+$result.win_file_version.file_private_part = $file_private_part.toString()
 Exit-Json $result;
-
