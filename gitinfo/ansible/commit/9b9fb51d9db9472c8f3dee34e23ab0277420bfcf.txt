commit 9b9fb51d9db9472c8f3dee34e23ab0277420bfcf
Author: James Cammarata <jimi@sngx.net>
Date:   Tue Nov 17 15:37:18 2015 -0500

    Template the final_environment value in _compute_environment_string()
    
    Fixes #13123

diff --git a/lib/ansible/plugins/action/__init__.py b/lib/ansible/plugins/action/__init__.py
index cde1c8c9ce..124321e67b 100644
--- a/lib/ansible/plugins/action/__init__.py
+++ b/lib/ansible/plugins/action/__init__.py
@@ -160,6 +160,7 @@ class ActionBase(with_metaclass(ABCMeta, object)):
                 # these environment settings should not need to merge sub-dicts
                 final_environment.update(environment)
 
+        final_environment = self._templar.template(final_environment)
         return self._connection._shell.env_prefix(**final_environment)
 
     def _early_needs_tmp_path(self):
