commit 27b8d3567ee3e23f1de16de7e0edfea5a834b902
Author: milan <mkovacik@redhat.com>
Date:   Fri Mar 15 10:15:41 2013 +0100

    check hostname presence

diff --git a/plugins/inventory/ec2.py b/plugins/inventory/ec2.py
index 08c37c065e..8cd3212eca 100755
--- a/plugins/inventory/ec2.py
+++ b/plugins/inventory/ec2.py
@@ -329,7 +329,15 @@ class Ec2Inventory(object):
             # Need to load index from cache
             self.load_index_from_cache()
 
+        if not self.args.host in self.index:
+            # try updating the cache
+            self.do_api_calls_update_cache()
+            if not self.args.host in self.index:
+                # host migh not exist anymore
+                return self.json_format_dict({}, True)
+
         (region, instance_id) = self.index[self.args.host]
+
         instance = self.get_instance(region, instance_id)
         instance_vars = {}
         for key in vars(instance):
