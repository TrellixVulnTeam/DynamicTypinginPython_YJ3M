commit 28a903a1e2c45b1929ea9036bf2d696dcd51b7a5
Author: Jordan Borean <jborean93@gmail.com>
Date:   Fri Dec 7 10:24:46 2018 +1000

    pip tests: skip distribute test case for py3 compat (#49636)

diff --git a/test/integration/targets/pip/tasks/pip.yml b/test/integration/targets/pip/tasks/pip.yml
index 9098dab6c6..78b0b9cd50 100644
--- a/test/integration/targets/pip/tasks/pip.yml
+++ b/test/integration/targets/pip/tasks/pip.yml
@@ -501,25 +501,28 @@
     state: absent
 
 # https://github.com/ansible/ansible/issues/47198
-- name: make sure the virtualenv does not exist
-  file:
-    state: absent
-    name: "{{ output_dir }}/pipenv"
-
-- name: install distribute in the virtualenv
-  pip:
-    name: distribute
-    virtualenv: "{{ output_dir }}/pipenv"
-    state: present
-
-- name: try to remove distribute
-  pip:
-    state: "absent"
-    name: "distribute"
-    virtualenv: "{{ output_dir }}/pipenv"
-  ignore_errors: yes
-  register: remove_distribute
-
-- name: inspect the cmd
-  assert:
-    that: "'distribute' in remove_distribute.cmd"
+# distribute is a legacy package that will fail on newer Python 3 versions
+- block:
+  - name: make sure the virtualenv does not exist
+    file:
+      state: absent
+      name: "{{ output_dir }}/pipenv"
+
+  - name: install distribute in the virtualenv
+    pip:
+      name: distribute
+      virtualenv: "{{ output_dir }}/pipenv"
+      state: present
+
+  - name: try to remove distribute
+    pip:
+      state: "absent"
+      name: "distribute"
+      virtualenv: "{{ output_dir }}/pipenv"
+    ignore_errors: yes
+    register: remove_distribute
+
+  - name: inspect the cmd
+    assert:
+      that: "'distribute' in remove_distribute.cmd"
+  when: ansible_python.version.major == 2
