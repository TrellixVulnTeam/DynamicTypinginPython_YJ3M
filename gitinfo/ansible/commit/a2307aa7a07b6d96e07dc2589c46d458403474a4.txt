commit a2307aa7a07b6d96e07dc2589c46d458403474a4
Author: Marco Vito Moscaritolo <mavimo@gmail.com>
Date:   Wed Sep 5 16:26:01 2012 +0200

    Fix error with servers without group metadata. Add this servers to undefined group.

diff --git a/inventory/nova.py b/inventory/nova.py
index 111a8ef232..a06d39888c 100755
--- a/inventory/nova.py
+++ b/inventory/nova.py
@@ -94,14 +94,14 @@ if len(sys.argv) == 2 and (sys.argv[1] == '--list'):
     # Cycle on servers
     for f in client.servers.list():
         # Define group (or set to empty string)
-        group = f.metadata['group'] if f.metadata['group'] else ''
+        group = f.metadata['group'] if f.metadata.has_key('group') else 'undefined'
 
         # Create group if not exist
         if group not in groups:
-            groups[f.metadata['group']] = []
+            groups[group] = []
 
         # Append group to list
-        groups[f.metadata['group']].append(f.accessIPv4)
+        groups[group].append(f.accessIPv4)
 
     # Return server list
     print json.dumps(groups)
