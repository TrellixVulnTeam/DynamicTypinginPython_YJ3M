commit 8d00ccf60fe8c5c6d10313c8cf4fa9007b9b0686
Author: Rhys Campbell <rhys.james.campbell@googlemail.com>
Date:   Mon Mar 11 10:58:39 2019 +0100

    Change listDatabases exception handling (#53605)

diff --git a/lib/ansible/modules/database/mongodb/mongodb_replicaset.py b/lib/ansible/modules/database/mongodb/mongodb_replicaset.py
index a8ed2a0bb4..13cb02d276 100644
--- a/lib/ansible/modules/database/mongodb/mongodb_replicaset.py
+++ b/lib/ansible/modules/database/mongodb/mongodb_replicaset.py
@@ -376,11 +376,13 @@ def main():
     try:
         client['admin'].command('listDatabases', 1.0)  # if this throws an error we need to authenticate
     except Exception as excep:
-        if "not authorized on" not in str(excep) and "command listDatabases requires authentication" not in str(excep):
+        if "not authorized on" in str(excep) or "command listDatabases requires authentication" in str(excep):
+            if login_user is not None and login_password is not None:
+                client.admin.authenticate(login_user, login_password, source=login_database)
+            else:
+                raise excep
+        else:
             raise excep
-        if login_user is None or login_password is None:
-            raise excep
-        client.admin.authenticate(login_user, login_password, source=login_database)
 
     if len(replica_set) == 0:
         module.fail_json(msg="Parameter 'replica_set' must not be an empty string")
