commit 486370a744f8edad498eea943227365836455bae
Author: ShachafGoldstein <shachaf.gold@gmail.com>
Date:   Tue May 28 22:59:50 2019 +0300

    Fix win_iis_virtualdirectory to remove a virtual directory that contains children (#56569)
    
    * FIX #49755
    
    * Added changelog fragment
    
    * Changes according to review
    
    * Fixed changelog

diff --git a/changelogs/fragments/56569-Support-recursive-removal-win_iis_virtualdirectory.yml b/changelogs/fragments/56569-Support-recursive-removal-win_iis_virtualdirectory.yml
new file mode 100644
index 0000000000..fb20dfd926
--- /dev/null
+++ b/changelogs/fragments/56569-Support-recursive-removal-win_iis_virtualdirectory.yml
@@ -0,0 +1,2 @@
+bugfixes:
+- "win_iis_virtualdirectory - Support recursive removal (https://github.com/ansible/ansible/issues/49755)"
\ No newline at end of file
diff --git a/lib/ansible/modules/windows/win_iis_virtualdirectory.ps1 b/lib/ansible/modules/windows/win_iis_virtualdirectory.ps1
index 5d3542e3a8..7d63897994 100644
--- a/lib/ansible/modules/windows/win_iis_virtualdirectory.ps1
+++ b/lib/ansible/modules/windows/win_iis_virtualdirectory.ps1
@@ -65,7 +65,7 @@ try {
 
   # Remove directory
   If ($state -eq 'absent' -and $directory) {
-    Remove-Item $directory_path
+    Remove-Item $directory_path -Recurse -Force
     $result.changed = $true
   }
 
diff --git a/lib/ansible/modules/windows/win_iis_virtualdirectory.py b/lib/ansible/modules/windows/win_iis_virtualdirectory.py
index e5505e78aa..a8cc49e072 100644
--- a/lib/ansible/modules/windows/win_iis_virtualdirectory.py
+++ b/lib/ansible/modules/windows/win_iis_virtualdirectory.py
@@ -24,6 +24,7 @@ options:
   state:
     description:
       - Whether to add or remove the specified virtual directory.
+      - Removing will remove the virtual directory and all under it (Recursively).
     type: str
     choices: [ absent, present ]
     default: present
