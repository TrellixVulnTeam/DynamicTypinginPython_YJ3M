commit 767cd82e42b4c81c10ea41a346b5b3c421303aa6
Author: Adrian Likins <alikins@redhat.com>
Date:   Wed Aug 9 10:43:16 2017 -0400

    Fix module failure with pacemaker_cluster: state=cleanup (#27846)
    
    * Fix module failure with pacemaker_cluster: state=cleanup
    
    If state=cleanup was used, set_cluster() was being called
    with 'cleanup' state which it doesn't handle. Instead
    use existing clean_cluster() method.
    
    Fixes #27799
    
    * get and return cluster_state on state=clean as well

diff --git a/lib/ansible/modules/clustering/pacemaker_cluster.py b/lib/ansible/modules/clustering/pacemaker_cluster.py
index 4d0761f674..79c44defec 100644
--- a/lib/ansible/modules/clustering/pacemaker_cluster.py
+++ b/lib/ansible/modules/clustering/pacemaker_cluster.py
@@ -219,9 +219,10 @@ def main():
             module.fail_json(msg="Failed during the restart of the cluster, the cluster can't be stopped")
 
     if state in ['cleanup']:
-        set_cluster(module, state, timeout, force)
+        clean_cluster(module, timeout)
+        cluster_state = get_cluster_status(module)
         module.exit_json(changed=True,
-                 out=cluster_state)
+                         out=cluster_state)
 
 
 if __name__ == '__main__':
