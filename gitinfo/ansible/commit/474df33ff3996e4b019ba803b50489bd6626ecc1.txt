commit 474df33ff3996e4b019ba803b50489bd6626ecc1
Author: Dagobert Michelsen <dam@opencsw.org>
Date:   Sat Jan 31 22:12:40 2015 +0100

    Correctly report "changed: false" when trying to install a package not in the catalog. This fixes #230

diff --git a/lib/ansible/modules/extras/packaging/os/pkgutil.py b/lib/ansible/modules/extras/packaging/os/pkgutil.py
index 78a7db72bf..fe0e82a5ab 100644
--- a/lib/ansible/modules/extras/packaging/os/pkgutil.py
+++ b/lib/ansible/modules/extras/packaging/os/pkgutil.py
@@ -162,10 +162,15 @@ def main():
             (rc, out, err) = package_uninstall(module, name)
             out = out[:75]
 
-    if rc is None:
+    if rc == 0:
+        result['changed'] = True
+    else:
         result['changed'] = False
+
+    if rc is not None and rc != 0:
+        result['failed'] = True
     else:
-        result['changed'] = True
+        result['failed'] = False
 
     if out:
         result['stdout'] = out
