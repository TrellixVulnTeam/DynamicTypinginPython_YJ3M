commit a196c7d737db14ba7dc238be901a5bf108e135c0
Author: Brian Coca <bcoca@ansible.com>
Date:   Wed Jan 13 10:17:43 2016 -0500

    only send event if tqm exists
    
    fixes #13843

diff --git a/Makefile b/Makefile
index f62cffb2df..367987affc 100644
--- a/Makefile
+++ b/Makefile
@@ -167,6 +167,9 @@ install:
 sdist: clean docs
 	$(PYTHON) setup.py sdist
 
+sdist_upload: clean docs
+	$(PYTHON) setup.py sdist upload 2>&1 |tee upload.log
+
 rpmcommon: $(MANPAGES) sdist
 	@mkdir -p rpm-build
 	@cp dist/*.gz rpm-build/
diff --git a/lib/ansible/executor/playbook_executor.py b/lib/ansible/executor/playbook_executor.py
index eecaa66a62..adaf92207b 100644
--- a/lib/ansible/executor/playbook_executor.py
+++ b/lib/ansible/executor/playbook_executor.py
@@ -112,8 +112,8 @@ class PlaybookExecutor:
                             salt      = var.get("salt", None)
 
                             if vname not in self._variable_manager.extra_vars:
-                                self._tqm.send_callback('v2_playbook_on_vars_prompt', vname, private, prompt, encrypt, confirm, salt_size, salt, default)
                                 if self._tqm:
+                                    self._tqm.send_callback('v2_playbook_on_vars_prompt', vname, private, prompt, encrypt, confirm, salt_size, salt, default)
                                     play.vars[vname] = display.do_var_prompt(vname, private, prompt, encrypt, confirm, salt_size, salt, default)
                                 else: # we are either in --list-<option> or syntax check
                                     play.vars[vname] = default
