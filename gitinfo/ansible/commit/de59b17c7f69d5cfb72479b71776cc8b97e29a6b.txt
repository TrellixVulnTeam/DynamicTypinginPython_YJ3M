commit de59b17c7f69d5cfb72479b71776cc8b97e29a6b
Author: Rick Elrod <rick@elrod.me>
Date:   Fri May 8 18:59:43 2020 -0500

    Add Fedora 32 to CI (#69222)
    
    Change:
    Adds Fedora 32 to shippable and alters tests slightly for new Fedora.
    
    Test Plan:
    CI
    
    Tickets:
    Fixes #69230
    
    Co-authored-by: Matt Clay <matt@mystile.com>

diff --git a/changelogs/fragments/f32.yml b/changelogs/fragments/f32.yml
new file mode 100644
index 0000000000..b080b21965
--- /dev/null
+++ b/changelogs/fragments/f32.yml
@@ -0,0 +1,2 @@
+minor_changes:
+  - ansible-test - Added support for testing on Fedora 32.
diff --git a/shippable.yml b/shippable.yml
index 2a55c3083e..a10a9bfe80 100644
--- a/shippable.yml
+++ b/shippable.yml
@@ -36,8 +36,8 @@ matrix:
     - env: T=linux/centos6/1
     - env: T=linux/centos7/1
     - env: T=linux/centos8/1
-    - env: T=linux/fedora30/1
     - env: T=linux/fedora31/1
+    - env: T=linux/fedora32/1
     - env: T=linux/opensuse15py2/1
     - env: T=linux/opensuse15/1
     - env: T=linux/ubuntu1604/1
@@ -53,8 +53,8 @@ matrix:
     - env: T=linux/centos6/2
     - env: T=linux/centos7/2
     - env: T=linux/centos8/2
-    - env: T=linux/fedora30/2
     - env: T=linux/fedora31/2
+    - env: T=linux/fedora32/2
     - env: T=linux/opensuse15py2/2
     - env: T=linux/opensuse15/2
     - env: T=linux/ubuntu1604/2
@@ -70,8 +70,8 @@ matrix:
     - env: T=linux/centos6/3
     - env: T=linux/centos7/3
     - env: T=linux/centos8/3
-    - env: T=linux/fedora30/3
     - env: T=linux/fedora31/3
+    - env: T=linux/fedora32/3
     - env: T=linux/opensuse15py2/3
     - env: T=linux/opensuse15/3
     - env: T=linux/ubuntu1604/3
@@ -87,8 +87,8 @@ matrix:
     - env: T=linux/centos6/4
     - env: T=linux/centos7/4
     - env: T=linux/centos8/4
-    - env: T=linux/fedora30/4
     - env: T=linux/fedora31/4
+    - env: T=linux/fedora32/4
     - env: T=linux/opensuse15py2/4
     - env: T=linux/opensuse15/4
     - env: T=linux/ubuntu1604/4
@@ -104,8 +104,8 @@ matrix:
     - env: T=linux/centos6/5
     - env: T=linux/centos7/5
     - env: T=linux/centos8/5
-    - env: T=linux/fedora30/5
     - env: T=linux/fedora31/5
+    - env: T=linux/fedora32/5
     - env: T=linux/opensuse15py2/5
     - env: T=linux/opensuse15/5
     - env: T=linux/ubuntu1604/5
@@ -124,8 +124,8 @@ matrix:
     - env: T=i/linux/centos6
     - env: T=i/linux/centos7
     - env: T=i/linux/centos8
-    - env: T=i/linux/fedora30
     - env: T=i/linux/fedora31
+    - env: T=i/linux/fedora32
     - env: T=i/linux/opensuse15py2
     - env: T=i/linux/opensuse15
     - env: T=i/linux/ubuntu1604
diff --git a/test/integration/targets/dnf/vars/Fedora.yml b/test/integration/targets/dnf/vars/Fedora.yml
index af3de4c1cc..6e0a798c08 100644
--- a/test/integration/targets/dnf/vars/Fedora.yml
+++ b/test/integration/targets/dnf/vars/Fedora.yml
@@ -1,2 +1,6 @@
-astream_name: '@stratis:1/default'
-astream_name_no_stream: '@stratis/default'
+astream_name: '@hub:pre-release/default'
+
+# For this to work, it needs to be that only shows once in `dnf module list`.
+# Such packages, that exist on all the versions we test on, are hard to come by.
+# TODO: This would be solved by using our own repo with modularity/streams.
+astream_name_no_stream: '@hub/default'
diff --git a/test/integration/targets/incidental_timezone/tasks/main.yml b/test/integration/targets/incidental_timezone/tasks/main.yml
index 91858918a2..247ad6cff8 100644
--- a/test/integration/targets/incidental_timezone/tasks/main.yml
+++ b/test/integration/targets/incidental_timezone/tasks/main.yml
@@ -34,25 +34,14 @@
     hwclock_config_file: '/etc/sysconfig/clock'
   when: ansible_os_family == 'RedHat'
 
-####
-#### timezone tests
-####
-
-- name: make sure the dbus service is started under systemd
-  systemd:
-    name: dbus
-    state: started
-  when:
-    - ansible_service_mgr == 'systemd'
-    - ansible_distribution == 'Fedora'
-    - ansible_facts.distribution_major_version is version('31', '<')
-
-
 - name: Run tests
-  # Skip tests on Fedora 31 because dbus fails to start unless the container is run in priveleged mode.
+  # Skip tests on Fedora because dbus fails to start unless the container is run in priveleged mode.
   # Even then, it starts unreliably. This may be due to the move to cgroup v2 in Fedora 31.
   # https://www.redhat.com/sysadmin/fedora-31-control-group-v2
-  when: ansible_facts.distribution ~ ansible_facts.distribution_major_version != 'Fedora31'
+  # Just skip Fedora rather than version-limiting because F30 goes EOL within a month of this writing
+  # and that is the oldest version we currently test in CI. F31+ are affected by the issue
+  # and making the tests work on them is something to deal with in community.general, not here.
+  when: ansible_distribution != 'Fedora'
   block:
     - name: set timezone to Etc/UTC
       timezone:
diff --git a/test/lib/ansible_test/_data/completion/docker.txt b/test/lib/ansible_test/_data/completion/docker.txt
index f809b5d9a1..e3f95be7fd 100644
--- a/test/lib/ansible_test/_data/completion/docker.txt
+++ b/test/lib/ansible_test/_data/completion/docker.txt
@@ -4,6 +4,7 @@ centos7 name=quay.io/ansible/centos7-test-container:1.8.0 python=2.7 seccomp=unc
 centos8 name=quay.io/ansible/centos8-test-container:1.10.0 python=3.6 seccomp=unconfined
 fedora30 name=quay.io/ansible/fedora30-test-container:1.9.2 python=3.7
 fedora31 name=quay.io/ansible/fedora31-test-container:1.11.0 python=3.7
+fedora32 name=quay.io/ansible/fedora32-test-container:1.16.0 python=3.8
 opensuse15py2 name=quay.io/ansible/opensuse15py2-test-container:1.14.0 python=2.7
 opensuse15 name=quay.io/ansible/opensuse15-test-container:1.14.0 python=3.6
 ubuntu1604 name=quay.io/ansible/ubuntu1604-test-container:1.8.0 python=2.7 seccomp=unconfined
