commit 278ecb9b55f8918610038f649f8b6fe4b123d664
Author: Henry Finucane <henry.finucane@locationlabs.com>
Date:   Mon May 12 23:21:55 2014 -0700

    Allow wait_for to wait on non-traditional files
    
    Use os.path.exists to check for file existence, instead of "can we open
    this file for reading".
    
    Fixes #6710

diff --git a/library/utilities/wait_for b/library/utilities/wait_for
index 3a381f0694..2a43ecf16a 100644
--- a/library/utilities/wait_for
+++ b/library/utilities/wait_for
@@ -176,21 +176,24 @@ def main():
         end = start + datetime.timedelta(seconds=timeout)
         while datetime.datetime.now() < end:
             if path:
-                try:
-                    f = open(path)
-                    try:
-                        if search_regex:
-                            if re.search(search_regex, f.read(), re.MULTILINE):
-                                break
-                            else:
-                                time.sleep(1)
-                        else:
-                            break
-                    finally:
-                        f.close()
-                except IOError:
+                if os.path.exists(path):
+                    if search_regex:
+                        try:
+                            f = open(path)
+                            try:
+                                if re.search(search_regex, f.read(), re.MULTILINE):
+                                    break
+                                else:
+                                    time.sleep(1)
+                            finally:
+                                f.close()
+                        except IOError:
+                            time.sleep(1)
+                            pass
+                    else:
+                        break
+                else:
                     time.sleep(1)
-                    pass
             elif port:
                 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                 s.settimeout(connect_timeout)
