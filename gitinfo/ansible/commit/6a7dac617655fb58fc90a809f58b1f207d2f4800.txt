commit 6a7dac617655fb58fc90a809f58b1f207d2f4800
Author: martin f. krafft <madduck@madduck.net>
Date:   Wed Jun 19 08:37:14 2013 +0200

    Fix purging of packages
    
    A small error in the reuse of a variable caused packages to never get
    purged. This commit fixes that.
    
    Signed-off-by: martin f. krafft <madduck@madduck.net>

diff --git a/library/packaging/apt b/library/packaging/apt
index 8f0922ec53..13d1e45b22 100644
--- a/library/packaging/apt
+++ b/library/packaging/apt
@@ -209,9 +209,10 @@ def remove(m, pkgspec, cache, purge=False):
     if len(packages) == 0:
         m.exit_json(changed=False)
     else:
-        purge = ''
         if purge:
             purge = '--purge'
+        else:
+            purge = ''
         cmd = "%s -q -y %s remove %s" % (APT_GET_CMD, purge,packages)
 
         if m.check_mode:
