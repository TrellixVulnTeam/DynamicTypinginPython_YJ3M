commit dd46cb7b055ee4b5e8666ae3a1098d03b5010019
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Tue Dec 13 16:39:03 2016 -0800

    Add a code-smell test for iterkeys (#18589)
    
    * Add a code-smell test for iterkeys
    * Add a message on how to port iterkeys problems and make the grep more robust

diff --git a/test/sanity/code-smell/no-iterkeys.sh b/test/sanity/code-smell/no-iterkeys.sh
new file mode 100755
index 0000000000..bc21b966b0
--- /dev/null
+++ b/test/sanity/code-smell/no-iterkeys.sh
@@ -0,0 +1,18 @@
+#!/bin/sh
+
+ITERKEYS_USERS=$(grep -r -I iterkeys . \
+    --exclude-dir .git \
+    --exclude-dir .tox \
+    --exclude-dir docsite \
+    | grep -v \
+    -e lib/ansible/compat/six/_six.py \
+    -e lib/ansible/module_utils/six.py \
+    -e test/sanity/code-smell/no-iterkeys.sh \
+    -e '^[^:]*:#'
+    )
+
+if [ "${ITERKEYS_USERS}" ]; then
+    echo 'iterkeys has been removed in python3.  Use "for KEY in DICT:" instead'
+    echo "${ITERKEYS_USERS}"
+    exit 1
+fi
