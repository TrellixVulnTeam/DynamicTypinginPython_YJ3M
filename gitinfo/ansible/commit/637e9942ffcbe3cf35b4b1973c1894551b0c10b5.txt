commit 637e9942ffcbe3cf35b4b1973c1894551b0c10b5
Author: nerzhul <loic.blot@unix-experience.fr>
Date:   Thu Apr 6 17:53:06 2017 +0200

    Nsupdate idempotency fix

diff --git a/lib/ansible/modules/network/nsupdate.py b/lib/ansible/modules/network/nsupdate.py
index 5ba70d536f..fd756476b4 100644
--- a/lib/ansible/modules/network/nsupdate.py
+++ b/lib/ansible/modules/network/nsupdate.py
@@ -223,13 +223,14 @@ class RecordManager(object):
                 self.dns_rc = self.modify_record()
                 if self.dns_rc != 0:
                     result['msg'] = "Failed to update DNS record (rc: %d)" % self.dns_rc
-        else:
-            result['changed'] = False
 
-        if self.dns_rc != 0:
-            result['failed'] = True
+            if self.dns_rc != 0:
+                result['failed'] = True
+            else:
+                result['changed'] = True
+
         else:
-            result['changed'] = True
+            result['changed'] = False
 
         return result
 
