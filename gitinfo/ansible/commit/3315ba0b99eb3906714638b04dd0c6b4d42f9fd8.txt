commit 3315ba0b99eb3906714638b04dd0c6b4d42f9fd8
Author: Jesse Keating <jesse.keating@rackspace.com>
Date:   Wed Mar 26 16:40:50 2014 -0700

    Treat 255 errors from raw as dark host
    
    Any other module is able to detect a dark host, but raw was treating 255
    as a return code from the module execution, rather from the connection
    attempt. This change allows 255 to be treated as a connection failure
    when using the raw module.

diff --git a/lib/ansible/runner/connection_plugins/ssh.py b/lib/ansible/runner/connection_plugins/ssh.py
index 876f206384..410afc9784 100644
--- a/lib/ansible/runner/connection_plugins/ssh.py
+++ b/lib/ansible/runner/connection_plugins/ssh.py
@@ -343,7 +343,7 @@ class Connection(object):
 
         if p.returncode != 0 and controlpersisterror:
             raise errors.AnsibleError('using -c ssh on certain older ssh versions may not support ControlPersist, set ANSIBLE_SSH_ARGS="" (or ansible_ssh_args in the config file) before running again')
-        if p.returncode == 255 and in_data:
+        if p.returncode == 255 and (in_data or self.runner.module_name == 'raw'):
             raise errors.AnsibleError('SSH Error: data could not be sent to the remote host. Make sure this host can be reached over ssh')
 
         return (p.returncode, '', stdout, stderr)
