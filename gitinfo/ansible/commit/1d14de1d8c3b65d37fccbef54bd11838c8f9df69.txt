commit 1d14de1d8c3b65d37fccbef54bd11838c8f9df69
Author: Colin Heinzmann <cheinzmann3@gmail.com>
Date:   Fri Jul 14 10:11:02 2017 -0700

    fixed win_nssm escaping issue (#22512)
    
    * bugfix: applicaiton setting was not properly escaped leading to issues
    when picking application under C:\Program Files (x86)\...

diff --git a/lib/ansible/modules/windows/win_nssm.ps1 b/lib/ansible/modules/windows/win_nssm.ps1
index baa026eb6d..9b637b24d8 100644
--- a/lib/ansible/modules/windows/win_nssm.ps1
+++ b/lib/ansible/modules/windows/win_nssm.ps1
@@ -135,7 +135,7 @@ Function Nssm-Install
 
     if (!(Service-Exists -name $name))
     {
-        $results = Nssm-Invoke "install ""$name"" $application"
+        $results = Nssm-Invoke "install ""$name"" ""$application"""
 
         if ($LastExitCode -ne 0)
         {
@@ -159,7 +159,7 @@ Function Nssm-Install
 
         if ($results -cnotlike $application)
         {
-            $cmd = "set ""$name"" Application $application"
+            $cmd = "set ""$name"" Application ""$application"""
 
             $results = Nssm-Invoke $cmd
 
@@ -179,7 +179,7 @@ Function Nssm-Install
      if ($result.changed)
      {
         $applicationPath = (Get-Item $application).DirectoryName
-        $cmd = "nssm set ""$name"" AppDirectory $applicationPath"
+        $cmd = "nssm set ""$name"" AppDirectory ""$applicationPath"""
 
         $results = invoke-expression $cmd
 
@@ -695,4 +695,4 @@ Try
 Catch
 {
      Fail-Json $result $_.Exception.Message
-}
+}
\ No newline at end of file
