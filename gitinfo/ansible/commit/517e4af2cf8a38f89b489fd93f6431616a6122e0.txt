commit 517e4af2cf8a38f89b489fd93f6431616a6122e0
Author: Josh Kuhn <deontologician@gmail.com>
Date:   Mon Nov 25 12:27:58 2013 -0500

    Added -FF flag to rsync invocation in synchronize
    
    The `-FF` option causes rsync to look for files in the source directory named `.rsync-filter` and uses them to filter directories underneath them. If no `.rsync-filter` files are found, the behavior is identical to the command run without the -FF option. This flag does not sync the .rsync-filter files themselves.
    
    This change should be backwards compatible and not produce surprising behavior for users, since they are unlikely to create `.rsync-filter` files unintentionally.

diff --git a/library/files/synchronize b/library/files/synchronize
index 9acc4d4662..947d5e3acf 100644
--- a/library/files/synchronize
+++ b/library/files/synchronize
@@ -183,7 +183,7 @@ def main():
     owner = module.params['owner']
     group = module.params['group']
 
-    cmd = '%s --delay-updates --compress --timeout=%s' % (rsync, rsync_timeout)
+    cmd = '%s --delay-updates -FF --compress --timeout=%s' % (rsync, rsync_timeout)
     if module.check_mode:
         cmd = cmd + ' --dry-run'
     if delete:
