commit 193e857bc4535258d06a0a7cd39072f1f0a146c3
Author: Scott Cunningham <scott.cunningham@ensighten.com>
Date:   Thu Jul 30 21:04:26 2015 +0100

    credstash lookup plugin: raise AnsibleError when credstash library not installed

diff --git a/lib/ansible/plugins/lookup/credstash.py b/lib/ansible/plugins/lookup/credstash.py
index 1e9f3ef722..5ff585f0e3 100644
--- a/lib/ansible/plugins/lookup/credstash.py
+++ b/lib/ansible/plugins/lookup/credstash.py
@@ -20,7 +20,17 @@ __metaclass__ = type
 from ansible.errors import AnsibleError
 from ansible.plugins.lookup import LookupBase
 
-import credstash
+CREDSTASH_INSTALLED = False
+
+try:
+    import credstash
+    CREDSTASH_INSTALLED = True
+except ImportError:
+    CREDSTASH_INSTALLED = False
+
+
+if not CREDSTASH_INSTALLED:
+    raise AnsibleError('The credstash lookup plugin requires credstash to be installed.')
 
 
 class LookupModule(LookupBase):
