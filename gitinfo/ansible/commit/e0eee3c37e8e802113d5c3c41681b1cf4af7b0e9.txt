commit e0eee3c37e8e802113d5c3c41681b1cf4af7b0e9
Author: Ruheena Ansari <ruheena0105@tamu.edu>
Date:   Fri Feb 28 17:05:53 2020 -0500

    Run Powershell modules on windows container via docker connection (#67832)
    
    * Run modules on windows container
    
    This provides an ability to run Powershell modules on windows container via docker connection. Otherwise, Ansible tries to run python modules on windows containers and fails.
    
    * Removing whitespace in the blank lines
    
    * Adding a changelog fragment

diff --git a/changelogs/fragments/67832-run_powershell_modules_on_windows_containers.yml b/changelogs/fragments/67832-run_powershell_modules_on_windows_containers.yml
new file mode 100644
index 0000000000..faddb90a09
--- /dev/null
+++ b/changelogs/fragments/67832-run_powershell_modules_on_windows_containers.yml
@@ -0,0 +1,2 @@
+minor_changes:
+  - docker connection plugin - run Powershell modules on Windows containers.
diff --git a/lib/ansible/plugins/connection/docker.py b/lib/ansible/plugins/connection/docker.py
index 118434ad41..380a84d877 100644
--- a/lib/ansible/plugins/connection/docker.py
+++ b/lib/ansible/plugins/connection/docker.py
@@ -76,6 +76,10 @@ class Connection(ConnectionBase):
         # configured to be connected to by root and they are not running as
         # root.
 
+        # Windows uses Powershell modules
+        if getattr(self._shell, "_IS_WINDOWS", False):
+            self.module_implementation_preferences = ('.ps1', '.exe', '')
+
         if 'docker_command' in kwargs:
             self.docker_cmd = kwargs['docker_command']
         else:
