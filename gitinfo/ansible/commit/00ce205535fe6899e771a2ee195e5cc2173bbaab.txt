commit 00ce205535fe6899e771a2ee195e5cc2173bbaab
Author: saichint <saichint@cisco.com>
Date:   Mon Jun 11 22:16:47 2018 -0700

    fix get existing vpc issue (#41429)

diff --git a/lib/ansible/modules/network/nxos/nxos_vpc.py b/lib/ansible/modules/network/nxos/nxos_vpc.py
index 238937e4b6..018c8d9ad4 100644
--- a/lib/ansible/modules/network/nxos/nxos_vpc.py
+++ b/lib/ansible/modules/network/nxos/nxos_vpc.py
@@ -190,7 +190,15 @@ def get_auto_recovery_default(module):
 
 def get_vpc(module):
     body = run_commands(module, ['show vpc | json'])[0]
-    domain = str(body['vpc-domain-id'])
+    if body:
+        domain = str(body['vpc-domain-id'])
+    else:
+        body = run_commands(module, ['show run vpc | inc domain'])[0]
+        if body:
+            domain = body.split()[2]
+        else:
+            domain = 'not configured'
+
     vpc = {}
     if domain != 'not configured':
         run = get_config(module, flags=['vpc'])
