commit aee1a97102be790ad1a4feb8c59322262fb459af
Author: Kesten Broughton <kbroughton@21ct.com>
Date:   Fri May 2 11:09:54 2014 -0500

    if key name already exists on tenant, check if public_key is offered that it matches the existing key

diff --git a/library/cloud/nova_keypair b/library/cloud/nova_keypair
index 18674a1220..b557b6db5f 100644
--- a/library/cloud/nova_keypair
+++ b/library/cloud/nova_keypair
@@ -115,7 +115,10 @@ def main():
     if module.params['state'] == 'present':
         for key in nova.keypairs.list():
             if key.name == module.params['name']:
-                module.exit_json(changed = False, result = "Key present")
+                if module.params['public_key'] and (module.params['public_key'] != key.public_key ):
+                    module.fail_json(msg = "name {} present but key hash not the same as offered.  Delete key first.".format(key['name']))
+                else:
+                    module.exit_json(changed = False, result = "Key present")            
         try:
             key = nova.keypairs.create(module.params['name'], module.params['public_key'])
         except Exception, e:
