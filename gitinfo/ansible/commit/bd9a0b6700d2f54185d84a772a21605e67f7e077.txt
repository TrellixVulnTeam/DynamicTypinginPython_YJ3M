commit bd9a0b6700d2f54185d84a772a21605e67f7e077
Author: Artem Meshcheryakov <19729346+artazar@users.noreply.github.com>
Date:   Wed Nov 13 07:24:25 2019 +0700

    Improve handling of "restarted" state for win_iis_website module (#63829)
    
    * Improve handling of "restarted" state for win_iis_website module
    
    * Added changelog fragment

diff --git a/changelogs/fragments/win_iis_website-restarted.yaml b/changelogs/fragments/win_iis_website-restarted.yaml
new file mode 100644
index 0000000000..22f843995f
--- /dev/null
+++ b/changelogs/fragments/win_iis_website-restarted.yaml
@@ -0,0 +1,2 @@
+bugfixes:
+- win_iis_website - Actually restart the site when ``state=restarted`` - https://github.com/ansible/ansible/issues/63828
diff --git a/lib/ansible/modules/windows/win_iis_website.ps1 b/lib/ansible/modules/windows/win_iis_website.ps1
index 7986baa861..e7b6cab8bf 100644
--- a/lib/ansible/modules/windows/win_iis_website.ps1
+++ b/lib/ansible/modules/windows/win_iis_website.ps1
@@ -143,7 +143,7 @@ Try {
     }
 
     # Set run state
-    if (($state -eq 'stopped') -and ($site.State -eq 'Started'))
+    if ((($state -eq 'stopped') -or ($state -eq 'restarted')) -and ($site.State -eq 'Started'))
     {
       Stop-Website -Name $name -ErrorAction Stop
       $result.changed = $true
