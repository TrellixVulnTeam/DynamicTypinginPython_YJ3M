commit 3d21dab705bfaf11b7fbc8c1f391f57e16014253
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Mon Jun 10 14:23:48 2013 -0400

    Small fix so template plugins can see inject variables.

diff --git a/lib/ansible/utils/template.py b/lib/ansible/utils/template.py
index 89795c0c55..9c6e26e6a5 100644
--- a/lib/ansible/utils/template.py
+++ b/lib/ansible/utils/template.py
@@ -489,6 +489,7 @@ def template_from_string(basedir, data, vars):
                 return data
          
         def my_lookup(*args, **kwargs):
+            kwargs['vars'] = vars
             return lookup(*args, basedir=basedir, **kwargs)
  
         t.globals['lookup'] = my_lookup
