commit a40450d40a76f085c26c26cb4718a833d46ed3a3
Author: Nicolas Simond <nicolassimond@posteo.ch>
Date:   Wed Apr 19 13:21:25 2017 +0200

    ConfigureRemotingForAnsible: RSA 1024 to RSA 4096  (#23684)

diff --git a/examples/scripts/ConfigureRemotingForAnsible.ps1 b/examples/scripts/ConfigureRemotingForAnsible.ps1
index 2f599bada8..502fb2388c 100644
--- a/examples/scripts/ConfigureRemotingForAnsible.ps1
+++ b/examples/scripts/ConfigureRemotingForAnsible.ps1
@@ -31,6 +31,7 @@
 # Updated by Chris Church <cchurch@ansible.com>
 # Updated by Michael Crilly <mike@autologic.cm>
 # Updated by Anton Ouzounov <Anton.Ouzounov@careerbuilder.com>
+# Updated by Nicolas Simond <contact@nicolas-simond.com>
 # Updated by Dag WieÃ«rs <dag@wieers.com>
 # Updated by Jordan Borean <jborean93@gmail.com>
 #
@@ -40,13 +41,14 @@
 # Version 1.3 - 2016-04-04
 # Version 1.4 - 2017-01-05
 # Version 1.5 - 2017-02-09
+# Version 1.6 - 2017-04-18
 
 # Support -Verbose option
 [CmdletBinding()]
 
 Param (
     [string]$SubjectName = $env:COMPUTERNAME,
-    [int]$CertValidityDays = 365,
+    [int]$CertValidityDays = 1095,
     [switch]$SkipNetworkProfileCheck,
     $CreateSelfSignedCert = $true,
     [switch]$ForceNewSSLCert,
@@ -77,7 +79,7 @@ Function New-LegacySelfSignedCert
 {
     Param (
         [string]$SubjectName,
-        [int]$ValidDays = 365
+        [int]$ValidDays = 1095
     )
 
     $name = New-Object -COM "X509Enrollment.CX500DistinguishedName.1"
@@ -86,7 +88,7 @@ Function New-LegacySelfSignedCert
     $key = New-Object -COM "X509Enrollment.CX509PrivateKey.1"
     $key.ProviderName = "Microsoft RSA SChannel Cryptographic Provider"
     $key.KeySpec = 1
-    $key.Length = 1024
+    $key.Length = 4096
     $key.SecurityDescriptor = "D:PAI(A;;0xd01f01ff;;;SY)(A;;0xd01f01ff;;;BA)(A;;0x80120089;;;NS)"
     $key.MachineContext = 1
     $key.Create()
