commit a9eef029b61825f39d1a5301bb7923f9d1c0a8ce
Author: Veeti Paananen <veeti.paananen@rojekti.fi>
Date:   Mon Jul 28 17:34:54 2014 +0300

    Expand variables in configuration files
    
    e.g. $HOME. Fixes #6373.

diff --git a/lib/ansible/constants.py b/lib/ansible/constants.py
index fb3e2420e9..17a09adb18 100644
--- a/lib/ansible/constants.py
+++ b/lib/ansible/constants.py
@@ -79,7 +79,7 @@ def shell_expand_path(path):
     ''' shell_expand_path is needed as os.path.expanduser does not work
         when path is None, which is the default for ANSIBLE_PRIVATE_KEY_FILE '''
     if path:
-        path = os.path.expanduser(path)
+        path = os.path.expandvars(os.path.expanduser(path))
     return path
 
 p = load_config_file()
