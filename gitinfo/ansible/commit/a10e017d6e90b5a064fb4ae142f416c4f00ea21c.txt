commit a10e017d6e90b5a064fb4ae142f416c4f00ea21c
Author: Rene Moser <mail@renemoser.net>
Date:   Mon Oct 21 16:39:18 2013 +0200

    apt: autoinstall python-apt if not available

diff --git a/library/packaging/apt b/library/packaging/apt
index 6ab2017186..28c933b694 100644
--- a/library/packaging/apt
+++ b/library/packaging/apt
@@ -322,7 +322,13 @@ def main():
     )
 
     if not HAS_PYTHON_APT:
-        module.fail_json(msg="Could not import python modules: apt, apt_pkg. Please install python-apt package.")
+        try:
+            module.run_command('apt-get install python-apt -y -q')
+            global apt, apt_pkg
+            import apt
+            import apt_pkg
+        except:
+            module.fail_json(msg="Could not import python modules: apt, apt_pkg. Please install python-apt package.")
 
     global APTITUDE_CMD
     APTITUDE_CMD = module.get_bin_path("aptitude", False)
