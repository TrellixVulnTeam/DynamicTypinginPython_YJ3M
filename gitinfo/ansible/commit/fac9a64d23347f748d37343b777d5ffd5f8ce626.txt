commit fac9a64d23347f748d37343b777d5ffd5f8ce626
Author: evanccopengeo <ecarter@opengeo.org>
Date:   Tue Jun 3 14:25:48 2014 -0400

    fixing problem where ansible would error out because Amazon was saying the group didnt exist yet (needed to wait a few more seconds for amazon to propagate correctly)

diff --git a/library/cloud/ec2_group b/library/cloud/ec2_group
index 5e42e861f4..b553900593 100644
--- a/library/cloud/ec2_group
+++ b/library/cloud/ec2_group
@@ -230,6 +230,10 @@ def main():
                 # to 0.0.0.0/0 is added automatically but it's not
                 # reflected in the object returned by the AWS API
                 # call. We re-read the group for getting an updated object
+                # amazon sometimes takes a couple seconds to update the security group so wait till it exists
+                while len(ec2.get_all_security_groups(filters={ 'group_id': group.id, })) == 0:
+                    time.sleep(0.1)
+
                 group = ec2.get_all_security_groups(group_ids=(group.id,))[0]
             changed = True
     else:
