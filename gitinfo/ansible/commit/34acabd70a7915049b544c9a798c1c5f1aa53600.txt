commit 34acabd70a7915049b544c9a798c1c5f1aa53600
Author: Abhijeet Kasurde <akasurde@redhat.com>
Date:   Tue Dec 24 09:38:38 2019 +0530

    VMware: Handle NoneType in vmware_vmkernel_info (#65834)
    
    Check for virtualNicManager in Esxi host system before accessing properties in vmware_vmkernel_info.
    
    Fixes: #62772
    
    Signed-off-by: Abhijeet Kasurde <akasurde@redhat.com>

diff --git a/changelogs/fragments/62772-vmware_vmkernel_info-fix.yml b/changelogs/fragments/62772-vmware_vmkernel_info-fix.yml
new file mode 100644
index 0000000000..db412eb3cc
--- /dev/null
+++ b/changelogs/fragments/62772-vmware_vmkernel_info-fix.yml
@@ -0,0 +1,2 @@
+bugfixes:
+- Check for virtualNicManager in Esxi host system before accessing properties in vmware_vmkernel_info (https://github.com/ansible/ansible/issues/62772).
diff --git a/lib/ansible/modules/cloud/vmware/vmware_vmkernel_info.py b/lib/ansible/modules/cloud/vmware/vmware_vmkernel_info.py
index 1f3a2b8c5e..af4bdf591d 100644
--- a/lib/ansible/modules/cloud/vmware/vmware_vmkernel_info.py
+++ b/lib/ansible/modules/cloud/vmware/vmware_vmkernel_info.py
@@ -145,7 +145,7 @@ class VmkernelInfoManager(PyVmomi):
             self.module.fail_json(msg="Failed to get all VMKs for service type %s due to"
                                       "%s" % (service_type, to_native(e)))
 
-        if not query.selectedVnic:
+        if not query or not query.selectedVnic:
             return vmks_list
         selected_vnics = [vnic for vnic in query.selectedVnic]
         vnics_with_service_type = [vnic.device for vnic in query.candidateVnic if vnic.key in selected_vnics]
