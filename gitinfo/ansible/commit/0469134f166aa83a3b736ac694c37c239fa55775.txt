commit 0469134f166aa83a3b736ac694c37c239fa55775
Author: Till Maas <opensource@till.name>
Date:   Fri Feb 22 12:44:18 2019 +0100

    rhsm_repository: Properly handle no repos (#51938)
    
    When no repos are defined, the `repo` variable is undefined. Therefore
    append it only to the result if a repo was found. Otherwise Ansible will
    fail with an UnboundLocalError.

diff --git a/changelogs/fragments/rhsm_repository-handle-no-repos.yml b/changelogs/fragments/rhsm_repository-handle-no-repos.yml
new file mode 100644
index 0000000000..92cf235671
--- /dev/null
+++ b/changelogs/fragments/rhsm_repository-handle-no-repos.yml
@@ -0,0 +1,2 @@
+bugfixes:
+  - rhsm_repository - handle systems without any repos
diff --git a/lib/ansible/modules/packaging/os/rhsm_repository.py b/lib/ansible/modules/packaging/os/rhsm_repository.py
index 238cbb527f..ab1eaba6bb 100644
--- a/lib/ansible/modules/packaging/os/rhsm_repository.py
+++ b/lib/ansible/modules/packaging/os/rhsm_repository.py
@@ -160,7 +160,7 @@ def get_repository_list(module, list_parameter):
                 "enabled": True if repo_enabled == '1' else False
             }
 
-        repo_result.append(repo)
+            repo_result.append(repo)
 
     return repo_result
 
