commit 4d67608a102a2064ee091c911bac7085641f2573
Author: Ton Kersten <tonk@master.tonkersten.com>
Date:   Tue Feb 19 15:59:22 2013 +0100

    Squashed commit of the following:
    
    commit 1c9b2a6035913969b515862e37e7e1aca24529e0
    Author: Ton Kersten <tonk@master.tonkersten.com>
    Date:   Tue Feb 19 15:54:36 2013 +0100
    
        Added osfamily fact

diff --git a/library/setup b/library/setup
index 6daca214f5..c42263dc2b 100644
--- a/library/setup
+++ b/library/setup
@@ -130,6 +130,46 @@ class Facts(object):
     # in 2.6 and newer, you should use platform.linux_distribution()
     def get_distribution_facts(self):
 
+        # A list with OS Family members
+        OSFAMILY = {
+                      'RedHat'       : 'RedHat',
+                      'Fedora'       : 'RedHat',
+                      'CentOS'       : 'RedHat',
+                      'Scientific'   : 'RedHat',
+                      'SLC'          : 'RedHat',
+                      'Ascendos'     : 'RedHat',
+                      'CloudLinux'   : 'RedHat',
+                      'PSBM'         : 'RedHat',
+                      'OracleLinux'  : 'RedHat',
+                      'OVS'          : 'RedHat',
+                      'OEL'          : 'RedHat',
+                      'Amazon'       : 'RedHat',
+                      'XenServer'    : 'RedHat',
+                      #
+                      'Ubuntu'       : 'Debian',
+                      'Debian'       : 'Debian',
+                      #
+                      'SLES'         : 'Suse',
+                      'SLED'         : 'Suse',
+                      'OpenSuSE'     : 'Suse',
+                      'SuSE'         : 'Suse',
+                      #
+                      'Gentoo'       : 'Gentoo',
+                      #
+                      'Archlinux'    : 'Archlinux',
+                      #
+                      'Mandriva'     : 'Mandrake',
+                      'Mandrake'     : 'Mandrake',
+		      #
+                      'Solaris'      : 'Solaris',
+                      'Nexenta'      : 'Solaris',
+                      'OmniOS'       : 'Solaris',
+                      'OpenIndiana'  : 'Solaris',
+                      'SmartOS'      : 'Solaris',
+                      #
+                      'AIX'          : 'AIX'
+	           }
+
         if self.facts['system'] == 'AIX':
             self.facts['distribution'] = 'AIX'
             rc, out, err = module.run_command("/usr/bin/oslevel")
@@ -160,6 +200,11 @@ class Facts(object):
                     else:
                         self.facts['distribution'] = name
 
+        # Find the family
+	self.facts['osfamily'] = self.facts['distribution']
+	if self.facts['distribution'] in OSFAMILY:
+	   self.facts['osfamily'] = OSFAMILY[self.facts['distribution']]
+
     def get_cmdline(self):
         data = get_file_content('/proc/cmdline')
         if data:
