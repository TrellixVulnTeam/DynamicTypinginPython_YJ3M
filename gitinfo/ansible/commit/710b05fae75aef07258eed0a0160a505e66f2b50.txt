commit 710b05fae75aef07258eed0a0160a505e66f2b50
Author: Yunge Zhu <37337818+yungezz@users.noreply.github.com>
Date:   Thu Mar 21 07:01:50 2019 +0800

    fix azure_rm.py not showing nic info for vmss (#53496)
    
    * fix vmss nic
    
    * resolve comments

diff --git a/lib/ansible/plugins/inventory/azure_rm.py b/lib/ansible/plugins/inventory/azure_rm.py
index 40755e366c..a0fd51d580 100644
--- a/lib/ansible/plugins/inventory/azure_rm.py
+++ b/lib/ansible/plugins/inventory/azure_rm.py
@@ -593,9 +593,8 @@ class AzureHost(object):
                                  for s in vm_instanceview_model.get('statuses', []) if self._powerstate_regex.match(s.get('code', ''))), 'unknown')
 
     def _on_nic_response(self, nic_model, is_primary=False):
-        if nic_model.get('type') == 'Microsoft.Network/networkInterfaces':
-            nic = AzureNic(nic_model=nic_model, inventory_client=self._inventory_client, is_primary=is_primary)
-            self.nics.append(nic)
+        nic = AzureNic(nic_model=nic_model, inventory_client=self._inventory_client, is_primary=is_primary)
+        self.nics.append(nic)
 
 
 class AzureNic(object):
@@ -606,10 +605,11 @@ class AzureNic(object):
 
         self.public_ips = {}
 
-        for ipc in nic_model['properties']['ipConfigurations']:
-            pip = ipc['properties'].get('publicIPAddress')
-            if pip:
-                self._inventory_client._enqueue_get(url=pip['id'], api_version=self._inventory_client._network_api_version, handler=self._on_pip_response)
+        if nic_model.get('properties', {}).get('ipConfigurations'):
+            for ipc in nic_model['properties']['ipConfigurations']:
+                pip = ipc['properties'].get('publicIPAddress')
+                if pip:
+                    self._inventory_client._enqueue_get(url=pip['id'], api_version=self._inventory_client._network_api_version, handler=self._on_pip_response)
 
     def _on_pip_response(self, pip_model):
         self.public_ips[pip_model['id']] = AzurePip(pip_model)
