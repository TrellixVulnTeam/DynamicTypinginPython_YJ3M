commit 4769d731ac8f9fadad42f5f4619247d9293cca70
Author: ngp-star <55133371+ngp-star@users.noreply.github.com>
Date:   Fri Dec 20 08:54:15 2019 +0530

    VMware: filter VMs of Same name on the basis of folder (#65922)
    
    vmware_guest now filters VMs of same name on the basis of additional information of folder.

diff --git a/changelogs/fragments/65922-filter-VMs-of-Same-name-on-the-basis-of-folder.yml b/changelogs/fragments/65922-filter-VMs-of-Same-name-on-the-basis-of-folder.yml
new file mode 100644
index 0000000000..cca940b5fd
--- /dev/null
+++ b/changelogs/fragments/65922-filter-VMs-of-Same-name-on-the-basis-of-folder.yml
@@ -0,0 +1,2 @@
+bugfixes:
+  - Vmware Fix for Create overwrites a VM of same name even when the folder is different(https://github.com/ansible/ansible/issues/43161)
diff --git a/lib/ansible/module_utils/vmware.py b/lib/ansible/module_utils/vmware.py
index 35b2c3d77b..11283ad76a 100644
--- a/lib/ansible/module_utils/vmware.py
+++ b/lib/ansible/module_utils/vmware.py
@@ -1053,7 +1053,11 @@ class PyVmomi(object):
                         break
             elif vms:
                 # Unique virtual machine found.
-                vm_obj = vms[0]
+                actual_vm_folder_path = self.get_vm_path(content=self.content, vm_name=vms[0])
+                if self.params.get('folder') is None:
+                    vm_obj = vms[0]
+                elif self.params['folder'] in actual_vm_folder_path:
+                    vm_obj = vms[0]
         elif 'moid' in self.params and self.params['moid']:
             vm_obj = VmomiSupport.templateOf('VirtualMachine')(self.params['moid'], self.si._stub)
 
