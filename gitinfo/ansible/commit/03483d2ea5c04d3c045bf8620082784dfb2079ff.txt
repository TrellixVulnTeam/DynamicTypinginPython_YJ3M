commit 03483d2ea5c04d3c045bf8620082784dfb2079ff
Author: Igor Khomyakov <igor@virtusize.com>
Date:   Fri Jan 9 16:57:20 2015 +0300

    Check if a service exists

diff --git a/lib/ansible/modules/web_infrastructure/supervisorctl.py b/lib/ansible/modules/web_infrastructure/supervisorctl.py
index 47d341c9e7..6d9f726c33 100644
--- a/lib/ansible/modules/web_infrastructure/supervisorctl.py
+++ b/lib/ansible/modules/web_infrastructure/supervisorctl.py
@@ -30,7 +30,7 @@ version_added: "0.7"
 options:
   name:
     description:
-      - The name of the supervisord program or group to manage.  
+      - The name of the supervisord program or group to manage.
       - The name will be taken as group name when it ends with a colon I(:)
       - Group support is only available in Ansible version 1.6 or later.
     required: true
@@ -194,9 +194,14 @@ def main():
     if state == 'restarted':
         rc, out, err = run_supervisorctl('update', check_rc=True)
         processes = get_matched_processes()
+        if not processes:
+            module.fail_json(name=name, msg="ERROR (no such process)")
+
         take_action_on_processes(processes, lambda s: True, 'restart', 'started')
 
     processes = get_matched_processes()
+    if not processes:
+         module.fail_json(name=name, msg="ERROR (no such process)")
 
     if state == 'present':
         if len(processes) > 0:
