commit e91db5fcdc616a0a935a309b3ea63a509d99da6f
Author: Nandor Sivok <nandor@gawker.com>
Date:   Fri Dec 14 13:21:58 2012 +0100

    fixes #1767 parsing serial from extra_vars

diff --git a/lib/ansible/playbook/__init__.py b/lib/ansible/playbook/__init__.py
index 68de7ed23d..124ce78ce7 100644
--- a/lib/ansible/playbook/__init__.py
+++ b/lib/ansible/playbook/__init__.py
@@ -406,7 +406,7 @@ class PlayBook(object):
             # do N forks all the way through before moving to next
             while len(all_hosts) > 0:
                 play_hosts = []
-                for x in range(play.serial):
+                for x in range(int(play.serial)):
                     if len(all_hosts) > 0:
                         play_hosts.append(all_hosts.pop())
                 serialized_batch.append(play_hosts)
diff --git a/lib/ansible/playbook/play.py b/lib/ansible/playbook/play.py
index 16af6a0399..67da07fd18 100644
--- a/lib/ansible/playbook/play.py
+++ b/lib/ansible/playbook/play.py
@@ -75,7 +75,7 @@ class Play(object):
         self.transport    = ds.get('connection', self.playbook.transport)
         self.tags         = ds.get('tags', None)
         self.gather_facts = ds.get('gather_facts', None)
-        self.serial       = ds.get('serial', 0)
+        self.serial       = utils.template_ds(basedir, ds.get('serial', 0), self.vars)
 
         if isinstance(self.remote_port, basestring):
             self.remote_port = utils.template(basedir, self.remote_port, self.vars)
