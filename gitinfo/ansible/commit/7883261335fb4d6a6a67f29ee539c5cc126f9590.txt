commit 7883261335fb4d6a6a67f29ee539c5cc126f9590
Author: Jack Neely <jjneely@42lines.net>
Date:   Fri May 23 11:26:59 2014 -0400

    apache2_module: Handle dep resolution
    
    The apache2_module module did not properly handle when a2enmod would
    handle apache module dependancies.  It would always return a state of
    changed.  I've updated the regular expression to properly parse that
    output as well as the normal output.  A good example of this is the
    mod_proxy_http module.

diff --git a/library/web_infrastructure/apache2_module b/library/web_infrastructure/apache2_module
index 103a1537d8..d966fad58e 100644
--- a/library/web_infrastructure/apache2_module
+++ b/library/web_infrastructure/apache2_module
@@ -63,7 +63,7 @@ def _enable_module(module):
     a2enmod_binary = module.get_bin_path("a2enmod")
     result, stdout, stderr = module.run_command("%s %s" % (a2enmod_binary, name))
 
-    if re.match(r'.*already enabled.*', stdout):
+    if re.search(r'.*%s\s+already enabled.*' % name, stdout, re.M):
         module.exit_json(changed = False, result = "Success")
     elif result != 0:
         module.fail_json(msg="Failed to enable module %s: %s" % (name, stdout))
