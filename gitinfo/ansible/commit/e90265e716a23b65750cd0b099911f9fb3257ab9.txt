commit e90265e716a23b65750cd0b099911f9fb3257ab9
Author: Daniel Jaouen <dcj24@cornell.edu>
Date:   Fri Jun 1 11:43:04 2018 -0400

    homebrew_tap: fixes #40853 (#40863)

diff --git a/lib/ansible/modules/packaging/os/homebrew_tap.py b/lib/ansible/modules/packaging/os/homebrew_tap.py
index 51c5acabcd..f3affe934f 100644
--- a/lib/ansible/modules/packaging/os/homebrew_tap.py
+++ b/lib/ansible/modules/packaging/os/homebrew_tap.py
@@ -111,7 +111,7 @@ def add_tap(module, brew_path, tap, url=None):
             tap,
             url,
         ])
-        if already_tapped(module, brew_path, tap):
+        if rc == 0:
             changed = True
             msg = 'successfully tapped: %s' % tap
         else:
