commit 5ab97b30cdc10e5b9167609f4d7afd46eb11a32b
Author: Dag Wieers <dag@wieers.com>
Date:   Tue May 9 02:53:13 2017 +0200

    powershell: Add support for list parameters (#23131)
    
    This is a first implementation of list parameters.
    
    It will convert a single string, or comma-separated value into an Array.

diff --git a/lib/ansible/module_utils/powershell.ps1 b/lib/ansible/module_utils/powershell.ps1
index 642d23cb42..1198f7c962 100644
--- a/lib/ansible/module_utils/powershell.ps1
+++ b/lib/ansible/module_utils/powershell.ps1
@@ -216,6 +216,15 @@ Function Get-AnsibleParam($obj, $name, $default = $null, $resultobj = @{}, $fail
     } elseif ($value -ne $null -and $type -eq "float") {
         # Convert float types to real Powershell floats
         $value = $value -as [float]
+    } elseif ($value -ne $null -and $type -eq "list") {
+        if ($value -is [array]) {
+            # Nothing to do
+        } elseif ($value -is [string]) {
+            # Convert string type to real Powershell array
+            $value = $value -split ","
+        } else {
+            Fail-Json -obj $resultobj -message "Parameter $name is not a Yaml list."
+        }
     }
 
     return $value
