commit 81f2e43b76e108b57e6916d902d3a19799cfe1c6
Author: Daniel Jaouen <dcj24@cornell.edu>
Date:   Wed Mar 12 19:52:16 2014 -0400

    Fix Homebrew._current_package_is_installed

diff --git a/library/packaging/homebrew b/library/packaging/homebrew
index 33b2ab6249..a74091542e 100644
--- a/library/packaging/homebrew
+++ b/library/packaging/homebrew
@@ -360,14 +360,15 @@ class Homebrew(object):
             self.message = 'Invalid package: {0}.'.format(self.current_package)
             raise HomebrewException(self.message)
 
-        rc, out, err = self.module.run_command(
-            "{brew_path} list -m1 | grep -q '^{package}$'".format(
-                brew_path=self.brew_path,
-                package=self.current_package,
-            )
-        )
+        cmd = [
+            "{brew_path}".format(brew_path=self.brew_path),
+            "list",
+            "-m1",
+        ]
+        rc, out, err = self.module.run_command(cmd)
+        packages = [package for package in out.split('\n') if package]
 
-        if rc == 0:
+        if rc == 0 and self.current_package in packages:
             return True
         else:
             return False
