commit 0fcd53e887eb69abe177358a5558a80340197f73
Author: James Cammarata <jimi@sngx.net>
Date:   Fri Jul 24 11:36:51 2015 -0400

    Make sure the command is sudoable before checking for the become password
    
    Fixes #11714

diff --git a/lib/ansible/plugins/connections/local.py b/lib/ansible/plugins/connections/local.py
index fc0cb60229..e4eddbd4cb 100644
--- a/lib/ansible/plugins/connections/local.py
+++ b/lib/ansible/plugins/connections/local.py
@@ -70,7 +70,7 @@ class Connection(ConnectionBase):
         )
         self._display.debug("done running command with Popen()")
 
-        if self._play_context.prompt  and self._play_context.become_pass:
+        if self._play_context.prompt  and self._play_context.become_pass and sudoable:
             fcntl.fcntl(p.stdout, fcntl.F_SETFL, fcntl.fcntl(p.stdout, fcntl.F_GETFL) | os.O_NONBLOCK)
             fcntl.fcntl(p.stderr, fcntl.F_SETFL, fcntl.fcntl(p.stderr, fcntl.F_GETFL) | os.O_NONBLOCK)
             become_output = ''
