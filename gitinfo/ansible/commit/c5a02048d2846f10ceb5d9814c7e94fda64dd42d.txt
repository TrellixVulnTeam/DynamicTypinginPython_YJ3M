commit c5a02048d2846f10ceb5d9814c7e94fda64dd42d
Author: Matthew Williams <matthew@flowroute.com>
Date:   Sun Apr 1 16:44:08 2012 -0700

    file module: mode formatting & directory ownership

diff --git a/library/file b/library/file
index e00e036b45..ad2f62c9b8 100755
--- a/library/file
+++ b/library/file
@@ -152,7 +152,7 @@ def set_mode_if_different(path, mode, changed):
        return changed
    try:
        # FIXME: support English modes
-       mode = int("0%s" % mode)
+       mode = int(mode, 8)
    except Exception, e:
        fail_json(path=path, msg='mode needs to be something octalish', details=str(e))  
  
@@ -233,8 +233,8 @@ elif state == 'directory':
     # set modes owners and context as needed
     changed = set_context_if_different(path, secontext, changed)
     changed = set_owner_if_different(path, owner, changed)
-    changed = set_group_if_different(path, owner, changed)
-    changed = set_mode_if_different(path, owner, changed)
+    changed = set_group_if_different(path, group, changed)
+    changed = set_mode_if_different(path, mode, changed)
 
     exit_json(path=path, changed=changed)
 
