commit 247f70cf5c2a759ef370445dac64d2c57c62cb10
Author: Todd Owen <todd.owen@health.wa.gov.au>
Date:   Thu Jun 12 12:59:09 2014 +0800

    Fix in pkgutil: don't call pipes.quote() on None.
    
    In this function, 'site' may be None, which will cause an exception
    if it is passed to pipes.quote().

diff --git a/library/packaging/pkgutil b/library/packaging/pkgutil
index e7d1ce7a0d..78a7db72bf 100644
--- a/library/packaging/pkgutil
+++ b/library/packaging/pkgutil
@@ -74,12 +74,10 @@ def package_installed(module, name):
 
 def package_latest(module, name, site):
     # Only supports one package
-    name = pipes.quote(name)
-    site = pipes.quote(site)
     cmd = [ 'pkgutil', '--single', '-c' ]
     if site is not None:
-        cmd += [ '-t', site ]
-    cmd.append(name)
+        cmd += [ '-t', pipes.quote(site) ]
+    cmd.append(pipes.quote(name))
     cmd += [ '| tail -1 | grep -v SAME' ]
     rc, out, err = module.run_command(' '.join(cmd), use_unsafe_shell=True)
     if rc == 1:
