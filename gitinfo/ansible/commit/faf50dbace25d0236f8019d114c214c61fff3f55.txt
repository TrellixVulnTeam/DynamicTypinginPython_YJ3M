commit faf50dbace25d0236f8019d114c214c61fff3f55
Author: Klaas Demter <Klaas-@users.noreply.github.com>
Date:   Sat Jul 6 22:37:23 2019 +0200

    Fix nagios module to recognize if file exists and is fifo pipe (#58569)
    
    add felixfontein suggestion to changelogs/fragments/58569-nagios-fifo-fix.yaml
    
    Co-Authored-By: Felix Fontein <felix@fontein.de>

diff --git a/changelogs/fragments/58569-nagios-fifo-fix.yaml b/changelogs/fragments/58569-nagios-fifo-fix.yaml
new file mode 100644
index 0000000000..db021cf519
--- /dev/null
+++ b/changelogs/fragments/58569-nagios-fifo-fix.yaml
@@ -0,0 +1,2 @@
+bugfixes:
+  - nagios module - Fix nagios module to recognize if ``cmdfile`` exists and is fifo pipe.
diff --git a/lib/ansible/modules/monitoring/nagios.py b/lib/ansible/modules/monitoring/nagios.py
index 0bffdca9e7..24cade85c9 100644
--- a/lib/ansible/modules/monitoring/nagios.py
+++ b/lib/ansible/modules/monitoring/nagios.py
@@ -196,6 +196,7 @@ EXAMPLES = '''
 import types
 import time
 import os.path
+import stat
 
 from ansible.module_utils.basic import AnsibleModule
 
@@ -389,6 +390,12 @@ class Nagios(object):
         Write the given command to the Nagios command file
         """
 
+        if not os.path.exists(self.cmdfile):
+            self.module.fail_json(msg='nagios command file does not exist',
+                                  cmdfile=self.cmdfile)
+        if not stat.S_ISFIFO(os.stat(self.cmdfile).st_mode):
+            self.module.fail_json(msg='nagios command file is not a fifo file',
+                                  cmdfile=self.cmdfile)
         try:
             fp = open(self.cmdfile, 'w')
             fp.write(cmd)
