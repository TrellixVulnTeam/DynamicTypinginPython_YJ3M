commit d24fbf5c3ec1ef702e8eb5df915ac84f71f3b382
Author: Benno Joy <benno@ansible.com>
Date:   Thu May 14 08:29:11 2015 +0530

    fixe issue #600, where ec2 module returns instance state as runing even after instance is terminated

diff --git a/lib/ansible/modules/cloud/amazon/ec2.py b/lib/ansible/modules/cloud/amazon/ec2.py
index 516236ed3b..015a6c28f1 100755
--- a/lib/ansible/modules/cloud/amazon/ec2.py
+++ b/lib/ansible/modules/cloud/amazon/ec2.py
@@ -1089,6 +1089,13 @@ def terminate_instances(module, ec2, instance_ids):
         # waiting took too long
         if wait_timeout < time.time() and num_terminated < len(terminated_instance_ids):
             module.fail_json(msg = "wait for instance termination timeout on %s" % time.asctime())
+        #Lets get the current state of the instances after terminating - issue600
+        instance_dict_array = []
+        for res in ec2.get_all_instances(instance_ids=terminated_instance_ids,\
+                                            filters={'instance-state-name':'terminated'}):
+            for inst in res.instances:
+                instance_dict_array.append(get_instance_info(inst))
+        
 
     return (changed, instance_dict_array, terminated_instance_ids)
 
