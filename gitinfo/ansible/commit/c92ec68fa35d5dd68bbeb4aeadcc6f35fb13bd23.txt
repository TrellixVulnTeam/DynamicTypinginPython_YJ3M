commit c92ec68fa35d5dd68bbeb4aeadcc6f35fb13bd23
Author: Andrew Resch <andrewresch@gmail.com>
Date:   Tue Apr 1 11:22:29 2014 -0700

    redhat_subscription calls AnsibleModule() without argument_spec
    
    The Rhsm object requires an AnsibleModule but it isn't created with an argument_spec and fails.  Since the rhn.module is set directly after, setting None for the required argument of Rhsm fixes the module.

diff --git a/library/packaging/redhat_subscription b/library/packaging/redhat_subscription
index 0e5ce0856d..f9918ada4b 100644
--- a/library/packaging/redhat_subscription
+++ b/library/packaging/redhat_subscription
@@ -327,7 +327,7 @@ class RhsmPools(object):
 def main():
 
     # Load RHSM configuration from file
-    rhn = Rhsm(AnsibleModule())
+    rhn = Rhsm(None)
 
     module = AnsibleModule(
                 argument_spec = dict(
