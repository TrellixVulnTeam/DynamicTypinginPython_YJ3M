commit 3b80f63e22ad2a3e8e0c66412bdc79116e093eaa
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Thu Dec 4 11:39:35 2014 -0800

    Have known_hosts function use the url parameter instead of getting a specific attribute out of the module dict.
    
    This makes the function useful in more places

diff --git a/lib/ansible/module_utils/known_hosts.py b/lib/ansible/module_utils/known_hosts.py
index c997596fd4..99dbf2c03a 100644
--- a/lib/ansible/module_utils/known_hosts.py
+++ b/lib/ansible/module_utils/known_hosts.py
@@ -40,7 +40,7 @@ def add_git_host_key(module, url, accept_hostkey=True, create_dir=True):
 
     """ idempotently add a git url hostkey """
 
-    fqdn = get_fqdn(module.params['repo'])
+    fqdn = get_fqdn(url)
 
     if fqdn:
         known_host = check_hostkey(module, fqdn)
