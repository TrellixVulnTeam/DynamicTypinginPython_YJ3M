commit f64e438150b4fb9e14b0983c8bcff2a10504c568
Author: Dreamcat4 <dreamcat4@gmail.com>
Date:   Mon Oct 5 21:36:24 2015 +0100

    fix: win10 - Add exception handling for 'Profiles:' textual output key name mismatch.
    
    In win10 (and pribably win8x also):
    
    The output of 'show rule' key includes the line "Profiles:<TAB>Public,Private".
    Yet your script expects the key name printed out to be "Profile:<TAB>value".
    
    This commit added the necessary exception handling to avoid flagging 'different=true' under the false circumstance. The key name to SET a firewall rule is still "profile=" and not "profiles=".
    
    There is coming up another commit to fix the value handling for win10/win8. Which is another (different) error with the profile: key.

diff --git a/lib/ansible/modules/extras/windows/win_firewall_rule.ps1 b/lib/ansible/modules/extras/windows/win_firewall_rule.ps1
index 9c73507509..0b0a2cd54f 100644
--- a/lib/ansible/modules/extras/windows/win_firewall_rule.ps1
+++ b/lib/ansible/modules/extras/windows/win_firewall_rule.ps1
@@ -75,6 +75,8 @@ function getFirewallRule ($fwsettings) {
                             $donothing=$false
                         } elseif ((($fwsetting.Key -eq 'Name') -or ($fwsetting.Key -eq 'DisplayName')) -and ($output."Rule Name" -eq $fwsettings.$($fwsetting.Key))) {
                             $donothing=$false
+                        } elseif (($fwsetting.Key -eq 'Profile') -and ($output."Profiles" -eq $fwsettings.$($fwsetting.Key))) {
+                            $donothing=$false
                         } else {
                             $diff=$true;
                             $difference+=@($fwsettings.$($fwsetting.Key));
