commit be2ca80c2be8263b9f3a73feac1f9c6062c381b0
Author: Peter Mounce <peter.mounce@just-eat.com>
Date:   Fri May 1 21:17:34 2015 +0100

    win_scheduled_task module for windows
    
    Fledgling module to allow scheduled tasks to be managed.
    At present, I only need enabled/disabled support. There's lots of scope for more features.

diff --git a/lib/ansible/modules/extras/windows/win_scheduled_task.ps1 b/lib/ansible/modules/extras/windows/win_scheduled_task.ps1
new file mode 100644
index 0000000000..2716ed32ea
--- /dev/null
+++ b/lib/ansible/modules/extras/windows/win_scheduled_task.ps1
@@ -0,0 +1,77 @@
+#!powershell
+# This file is part of Ansible
+#
+# Copyright 2015, Peter Mounce <public@neverrunwithscissors.com>
+#
+# Ansible is free software: you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation, either version 3 of the License, or
+# (at your option) any later version.
+#
+# Ansible is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with Ansible.  If not, see <http://www.gnu.org/licenses/>.
+
+$ErrorActionPreference = "Stop"
+
+# WANT_JSON
+# POWERSHELL_COMMON
+
+$params = Parse-Args $args;
+$result = New-Object PSObject;
+Set-Attr $result "changed" $false;
+
+if ($params.name)
+{
+    $package = $params.name
+}
+else
+{
+    Fail-Json $result "missing required argument: name"
+}
+if ($params.state)
+{
+  $state = $params.state.ToString()
+  if (($state -ne 'Enabled') -and ($state -ne 'Disabled'))
+  {
+    Fail-Json $result "state is '$state'; must be 'Enabled' or 'Disabled'"
+  }
+}
+else
+{
+  $state = "Enabled"
+}
+
+
+try
+{
+  $tasks = Get-ScheduledTask -TaskPath $name
+  $tasks_needing_changing |? { $_.State -ne $state }
+  if ($tasks_needing_changing -eq $null)
+  {
+    if ($state -eq 'Disabled')
+    {
+      $tasks_needing_changing | Disable-ScheduledTask
+    }
+    elseif ($state -eq 'Enabled')
+    {
+      $tasks_needing_changing | Enable-ScheduledTask
+    }
+    Set-Attr $result "tasks_changed" ($tasks_needing_changing | foreach { $_.TaskPath + $_.TaskName })
+    $result.changed = $true
+  }
+  else
+  {
+    Set-Attr $result "tasks_changed" @()
+    $result.changed = $false
+  }
+  Exit-Json $result;
+}
+catch
+{
+  Fail-Json $result $_.Exception.Message
+}
diff --git a/lib/ansible/modules/extras/windows/win_scheduled_task.py b/lib/ansible/modules/extras/windows/win_scheduled_task.py
new file mode 100644
index 0000000000..ac353c14c0
--- /dev/null
+++ b/lib/ansible/modules/extras/windows/win_scheduled_task.py
@@ -0,0 +1,54 @@
+#!/usr/bin/python
+# -*- coding: utf-8 -*-
+
+# (c) 2015, Peter Mounce <public@neverrunwithscissors.com>
+#
+# This file is part of Ansible
+#
+# Ansible is free software: you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation, either version 3 of the License, or
+# (at your option) any later version.
+#
+# Ansible is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with Ansible.  If not, see <http://www.gnu.org/licenses/>.
+
+# this is a windows documentation stub.  actual code lives in the .ps1
+# file of the same name
+
+DOCUMENTATION = '''
+---
+module: win_scheduled_task
+version_added: "1.9"
+short_description: Manage scheduled tasks
+description:
+    - Manage scheduled tasks
+options:
+  name:
+    description:
+      - Name of the scheduled task
+      - Supports * as wildcard
+    required: true
+    default: null
+    aliases: []
+  state:
+    description:
+      - State that the task should become
+    required: false
+    choices:
+      - Disabled
+      - Enabled
+    default: Enabled
+    aliases: []
+author: Peter Mounce
+'''
+
+EXAMPLES = '''
+  # Disable the scheduled tasks with "WindowsUpdate" in their name
+  win_scheduled_task: name="*WindowsUpdate*" state=disabled
+'''
