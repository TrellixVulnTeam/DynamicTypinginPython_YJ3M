commit 3c66caa058c1679f2757ec9cb97f66640d36c671
Author: = <jhawkesworth@users.noreply.github.com>
Date:   Fri Jul 8 06:46:27 2016 +0100

    fix win_msi tests by setting wait: true on all win_msi tasks.
    I suspect this problem was masked previously as older versions of pywinrm
    where significantly slower, allowing more time for the windows installer service to complete.

diff --git a/test/integration/roles/test_win_msi/tasks/main.yml b/test/integration/roles/test_win_msi/tasks/main.yml
index 1ac467212a..32609ea22e 100644
--- a/test/integration/roles/test_win_msi/tasks/main.yml
+++ b/test/integration/roles/test_win_msi/tasks/main.yml
@@ -26,11 +26,13 @@
   win_msi:
     path: "{{msi_product_code|default(msi_download_path,true)}}"
     state: absent
+    wait: true
   ignore_errors: true
 
 - name: install msi
   win_msi:
     path: "{{msi_download_path}}"
+    wait: true
   register: win_msi_install_result
 
 - name: check win_msi install result
@@ -42,6 +44,7 @@
 - name: install msi again with creates argument
   win_msi:
     path: "{{msi_download_path}}"
+    wait: true
     creates: "{{msi_install_path}}"
   register: win_msi_install_again_result
 
@@ -54,6 +57,7 @@
 - name: uninstall msi
   win_msi:
     path: "{{msi_download_path}}"
+    wait: true
     state: absent
   register: win_msi_uninstall_result
 
