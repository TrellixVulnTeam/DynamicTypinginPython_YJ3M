commit 0f91add86f7d30e6d895e01bbfddb93a3b5e48df
Author: Thomas Mangin <thomas.mangin@exa-networks.co.uk>
Date:   Mon Jun 23 15:56:40 2014 -0500

    Explicitly set the user option for ssh connections
    
    Fixes #7170

diff --git a/lib/ansible/runner/connection_plugins/ssh.py b/lib/ansible/runner/connection_plugins/ssh.py
index ec5d6edd34..bddbd88af3 100644
--- a/lib/ansible/runner/connection_plugins/ssh.py
+++ b/lib/ansible/runner/connection_plugins/ssh.py
@@ -94,8 +94,7 @@ class Connection(object):
             self.common_args += ["-o", "KbdInteractiveAuthentication=no",
                                  "-o", "PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey",
                                  "-o", "PasswordAuthentication=no"]
-        if self.user != pwd.getpwuid(os.geteuid())[0]:
-            self.common_args += ["-o", "User="+self.user]
+        self.common_args += ["-o", "User=" + (self.user or self.user or pwd.getpwuid(os.geteuid())[0])]
         self.common_args += ["-o", "ConnectTimeout=%d" % self.runner.timeout]
 
         return self
