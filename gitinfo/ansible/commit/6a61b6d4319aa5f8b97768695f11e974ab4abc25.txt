commit 6a61b6d4319aa5f8b97768695f11e974ab4abc25
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Thu Oct 6 10:59:02 2016 -0700

    Add a whitelist for checking for six.  Use it for digital_ocean.py

diff --git a/test/code-smell/use-compat-six.sh b/test/code-smell/use-compat-six.sh
index 74feaf5ec0..d1d9961eef 100755
--- a/test/code-smell/use-compat-six.sh
+++ b/test/code-smell/use-compat-six.sh
@@ -2,8 +2,13 @@
 
 # Do we want to check dynamic inventory, bin, etc?
 BASEDIR=${1-"lib"}
+# REGEX of individual files where the import of six is not a problem
+# digital_ocean is checking for six because dopy doesn't specify the
+#   requirement on six so it needs to try importing six to give the correct error
+#   message
+WHITELIST='(lib/ansible/modules/core/cloud/digital_ocean/digital_ocean.py)'
 
-SIX_USERS=$(find "$BASEDIR" -name '*.py' -exec grep -wH six \{\} \;|grep import |grep -v ansible.compat| grep -v ansible.module_utils.six)
+SIX_USERS=$(find "$BASEDIR" -name '*.py' -exec grep -wH six \{\} \;|grep import |grep -v ansible.compat| grep -v ansible.module_utils.six| egrep -v "^$WHITELIST:")
 if test -n "$SIX_USERS" ; then
   printf "$SIX_USERS"
   exit 1
