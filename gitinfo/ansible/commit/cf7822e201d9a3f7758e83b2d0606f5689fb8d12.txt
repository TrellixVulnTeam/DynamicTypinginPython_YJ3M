commit cf7822e201d9a3f7758e83b2d0606f5689fb8d12
Author: Brian Coca <bcoca@users.noreply.github.com>
Date:   Tue Sep 27 12:32:04 2016 -0400

    remove bare vars and undefined from lookup lists (#17647)
    
    https://docs.ansible.com/ansible/porting_guide_2.0.html#deprecated

diff --git a/lib/ansible/utils/listify.py b/lib/ansible/utils/listify.py
index d834737ab5..ad45521b8f 100644
--- a/lib/ansible/utils/listify.py
+++ b/lib/ansible/utils/listify.py
@@ -28,10 +28,9 @@ from ansible.template.safe_eval import safe_eval
 
 __all__ = ['listify_lookup_plugin_terms']
 
-def listify_lookup_plugin_terms(terms, templar, loader, fail_on_undefined=False, convert_bare=True):
+def listify_lookup_plugin_terms(terms, templar, loader, fail_on_undefined=True, convert_bare=False):
 
     if isinstance(terms, string_types):
-        # TODO: warn/deprecation on bare vars in with_ so we can eventually remove fail on undefined override
         terms = templar.template(terms.strip(), convert_bare=convert_bare, fail_on_undefined=fail_on_undefined)
     else:
         terms = templar.template(terms, fail_on_undefined=fail_on_undefined)
diff --git a/lib/ansible/vars/__init__.py b/lib/ansible/vars/__init__.py
index e333e348b1..1765037218 100644
--- a/lib/ansible/vars/__init__.py
+++ b/lib/ansible/vars/__init__.py
@@ -439,8 +439,7 @@ class VariableManager:
         if task.loop is not None:
             if task.loop in lookup_loader:
                 try:
-                    #TODO: remove convert_bare true and deprecate this in with_
-                    loop_terms = listify_lookup_plugin_terms(terms=task.loop_args, templar=templar, loader=loader, fail_on_undefined=True, convert_bare=True)
+                    loop_terms = listify_lookup_plugin_terms(terms=task.loop_args, templar=templar, loader=loader, fail_on_undefined=True, convert_bare=False)
                     items = lookup_loader.get(task.loop, loader=loader, templar=templar).run(terms=loop_terms, variables=vars_copy)
                 except AnsibleUndefinedVariable as e:
                     # This task will be skipped later due to this, so we just setup
