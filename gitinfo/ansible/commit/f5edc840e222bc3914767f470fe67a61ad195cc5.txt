commit f5edc840e222bc3914767f470fe67a61ad195cc5
Author: Matt Clay <matt@mystile.com>
Date:   Fri Jul 7 14:25:27 2017 -0700

    Update docker_secret test for RHEL 7.3 on AWS.

diff --git a/test/integration/targets/docker_secret/tasks/RedHat.yml b/test/integration/targets/docker_secret/tasks/RedHat.yml
index 51f466d564..fe5675a7b6 100644
--- a/test/integration/targets/docker_secret/tasks/RedHat.yml
+++ b/test/integration/targets/docker_secret/tasks/RedHat.yml
@@ -1,3 +1,6 @@
+# The RHEL extras repository must be enabled to provide the container-selinux package.
+# See: https://docs.docker.com/engine/installation/linux/docker-ee/rhel/#install-using-the-repository
+
 - name: Install Docker pre-reqs
   yum:
     name: "{{ item }}"
@@ -6,9 +9,11 @@
     - yum-utils
     - device-mapper-persistent-data
     - lvm2
-    - python-crypto
     - libseccomp
 
+- name: Enable extras repository for RHEL on AWS
+  command: yum-config-manager --enable rhui-REGION-rhel-server-extras
+
 - name: Add repository
   command: yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
 
@@ -19,3 +24,9 @@
   yum:
     name: docker-ce
     state: present
+
+- name: Make sure the docker daemon is running (failure expected inside docker container)
+  service:
+    name: docker
+    state: started
+  ignore_errors: yes
