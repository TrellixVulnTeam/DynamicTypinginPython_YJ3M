commit 92c679142f62484b9cd1dd0427122026aa6f2a9f
Author: Michel Blanc <mb@mbnet.fr>
Date:   Fri Feb 22 17:41:18 2013 +0100

    Optimizes using fnmatch only if needed
    
    Skips fnmatch'ing if there is only a '*' in filter.

diff --git a/library/setup b/library/setup
index b6c67fb172..5863eac7c5 100644
--- a/library/setup
+++ b/library/setup
@@ -1140,7 +1140,7 @@ def run_setup(module):
     setup_result = { 'ansible_facts': {} }
 
     for (k,v) in setup_options.items():
-        if fnmatch.fnmatch(k, module.params['filter']):
+        if module.params['filter'] == '*' or fnmatch.fnmatch(k, module.params['filter']):
             setup_result['ansible_facts'][k] = v
 
     # hack to keep --verbose from showing all the setup module results
