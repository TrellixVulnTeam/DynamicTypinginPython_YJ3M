commit 007abb53732872fa05be5ee3484547f41238e65c
Author: Fabio Alessandro Locati <me@fale.io>
Date:   Mon Dec 5 16:23:08 2016 +0000

    Make `main()` calls conditional - packaging (#3650)

diff --git a/lib/ansible/modules/extras/packaging/dpkg_selections.py b/lib/ansible/modules/extras/packaging/dpkg_selections.py
index 81dd849e59..bf13dc13fd 100644
--- a/lib/ansible/modules/extras/packaging/dpkg_selections.py
+++ b/lib/ansible/modules/extras/packaging/dpkg_selections.py
@@ -75,4 +75,6 @@ def main():
 
 
 from ansible.module_utils.basic import *
-main()
+
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/language/cpanm.py b/lib/ansible/modules/extras/packaging/language/cpanm.py
index 26566c6dbf..addf0c198d 100644
--- a/lib/ansible/modules/extras/packaging/language/cpanm.py
+++ b/lib/ansible/modules/extras/packaging/language/cpanm.py
@@ -231,4 +231,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
 
-main()
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/language/npm.py b/lib/ansible/modules/extras/packaging/language/npm.py
index 58e29dc86e..4b147e3703 100644
--- a/lib/ansible/modules/extras/packaging/language/npm.py
+++ b/lib/ansible/modules/extras/packaging/language/npm.py
@@ -286,4 +286,6 @@ def main():
 
 # import module snippets
 from ansible.module_utils.basic import *
-main()
+
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/language/pear.py b/lib/ansible/modules/extras/packaging/language/pear.py
index ae513baf14..880c275f25 100644
--- a/lib/ansible/modules/extras/packaging/language/pear.py
+++ b/lib/ansible/modules/extras/packaging/language/pear.py
@@ -232,4 +232,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
 
-main()
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/macports.py b/lib/ansible/modules/extras/packaging/os/macports.py
index 19121f4a85..81cf4827f1 100644
--- a/lib/ansible/modules/extras/packaging/os/macports.py
+++ b/lib/ansible/modules/extras/packaging/os/macports.py
@@ -229,4 +229,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
 
-main()
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/openbsd_pkg.py b/lib/ansible/modules/extras/packaging/os/openbsd_pkg.py
index e68ef18989..f86a4d081a 100644
--- a/lib/ansible/modules/extras/packaging/os/openbsd_pkg.py
+++ b/lib/ansible/modules/extras/packaging/os/openbsd_pkg.py
@@ -543,4 +543,6 @@ def main():
 
 # Import module snippets.
 from ansible.module_utils.basic import *
-main()
+
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/opkg.py b/lib/ansible/modules/extras/packaging/os/opkg.py
index 1d74020240..50b37d3cdb 100644
--- a/lib/ansible/modules/extras/packaging/os/opkg.py
+++ b/lib/ansible/modules/extras/packaging/os/opkg.py
@@ -182,4 +182,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
 
-main()
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/pkg5.py b/lib/ansible/modules/extras/packaging/os/pkg5.py
index 7f476e4bc0..bd10ad87c8 100644
--- a/lib/ansible/modules/extras/packaging/os/pkg5.py
+++ b/lib/ansible/modules/extras/packaging/os/pkg5.py
@@ -167,4 +167,6 @@ def is_latest(module, package):
 
 
 from ansible.module_utils.basic import *
-main()
+
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/pkg5_publisher.py b/lib/ansible/modules/extras/packaging/os/pkg5_publisher.py
index a540e36afb..a1b1f4f1d5 100644
--- a/lib/ansible/modules/extras/packaging/os/pkg5_publisher.py
+++ b/lib/ansible/modules/extras/packaging/os/pkg5_publisher.py
@@ -202,4 +202,6 @@ def unstringify(val):
 
 
 from ansible.module_utils.basic import *
-main()
+
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/pkgutil.py b/lib/ansible/modules/extras/packaging/os/pkgutil.py
index 8495a19b24..5323581ba5 100644
--- a/lib/ansible/modules/extras/packaging/os/pkgutil.py
+++ b/lib/ansible/modules/extras/packaging/os/pkgutil.py
@@ -225,4 +225,6 @@ def main():
 
 # import module snippets
 from ansible.module_utils.basic import *
-main()
+
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/portage.py b/lib/ansible/modules/extras/packaging/os/portage.py
index 0f3731968b..dc4c22890f 100644
--- a/lib/ansible/modules/extras/packaging/os/portage.py
+++ b/lib/ansible/modules/extras/packaging/os/portage.py
@@ -513,4 +513,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
 
-main()
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/portinstall.py b/lib/ansible/modules/extras/packaging/os/portinstall.py
index 44f21efb7c..78555a0219 100644
--- a/lib/ansible/modules/extras/packaging/os/portinstall.py
+++ b/lib/ansible/modules/extras/packaging/os/portinstall.py
@@ -209,4 +209,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
 
-main()
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/slackpkg.py b/lib/ansible/modules/extras/packaging/os/slackpkg.py
index 0581fbd191..4945403bb9 100644
--- a/lib/ansible/modules/extras/packaging/os/slackpkg.py
+++ b/lib/ansible/modules/extras/packaging/os/slackpkg.py
@@ -201,4 +201,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
 
-main()
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/svr4pkg.py b/lib/ansible/modules/extras/packaging/os/svr4pkg.py
index c31a100464..8f1528c938 100644
--- a/lib/ansible/modules/extras/packaging/os/svr4pkg.py
+++ b/lib/ansible/modules/extras/packaging/os/svr4pkg.py
@@ -258,4 +258,6 @@ def main():
 
 # import module snippets
 from ansible.module_utils.basic import *
-main()
+
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/swdepot.py b/lib/ansible/modules/extras/packaging/os/swdepot.py
index 8c7652af96..017e91b0b5 100644
--- a/lib/ansible/modules/extras/packaging/os/swdepot.py
+++ b/lib/ansible/modules/extras/packaging/os/swdepot.py
@@ -202,5 +202,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
 
-main()
-
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/urpmi.py b/lib/ansible/modules/extras/packaging/os/urpmi.py
index 47d7c1f684..934ef11ee2 100644
--- a/lib/ansible/modules/extras/packaging/os/urpmi.py
+++ b/lib/ansible/modules/extras/packaging/os/urpmi.py
@@ -209,4 +209,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
     
-main()        
+if __name__ == '__main__':
+    main()
diff --git a/lib/ansible/modules/extras/packaging/os/zypper_repository.py b/lib/ansible/modules/extras/packaging/os/zypper_repository.py
index 40510db9a9..7fae6065bc 100644
--- a/lib/ansible/modules/extras/packaging/os/zypper_repository.py
+++ b/lib/ansible/modules/extras/packaging/os/zypper_repository.py
@@ -406,4 +406,5 @@ def main():
 # import module snippets
 from ansible.module_utils.basic import *
 
-main()
+if __name__ == '__main__':
+    main()
