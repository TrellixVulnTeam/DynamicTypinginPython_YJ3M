commit c385c6746a0f05400b500e19d3ef22fe29b6dbf3
Author: Krzysztof Magosa <krzysztof@magosa.pl>
Date:   Mon Dec 5 18:28:13 2016 +0100

    kubernetes: handle situation when target host does not have yaml library (fixes #3301) (#3449)

diff --git a/lib/ansible/modules/extras/clustering/kubernetes.py b/lib/ansible/modules/extras/clustering/kubernetes.py
index 18372cb62d..12c62b3092 100644
--- a/lib/ansible/modules/extras/clustering/kubernetes.py
+++ b/lib/ansible/modules/extras/clustering/kubernetes.py
@@ -150,9 +150,14 @@ api_response:
             phase: "Active"
 '''
 
-import yaml
 import base64
 
+try:
+    import yaml
+    has_lib_yaml = True
+except ImportError:
+    has_lib_yaml = False
+
 ############################################################################
 ############################################################################
 # For API coverage, this Anislbe module provides capability to operate on
@@ -325,6 +330,9 @@ def main():
         required_one_of = (('file_reference', 'inline_data'),),
     )
 
+    if not has_lib_yaml:
+        module.fail_json(msg="missing python library: yaml")
+
     decode_cert_data(module)
 
     api_endpoint = module.params.get('api_endpoint')
