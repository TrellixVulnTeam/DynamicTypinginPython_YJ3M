commit 089ffae107333b3199a66aca29db83a085b4180e
Author: Matt Clay <matt@mystile.com>
Date:   Wed Nov 23 16:49:08 2016 -0800

    Make ansible-pull integration tests more robust.

diff --git a/test/integration/targets/pull_limit_inventory/runme.sh b/test/integration/targets/pull_limit_inventory/runme.sh
index 74b2fe625f..245ea522da 100755
--- a/test/integration/targets/pull_limit_inventory/runme.sh
+++ b/test/integration/targets/pull_limit_inventory/runme.sh
@@ -1,10 +1,11 @@
 #!/usr/bin/env bash
 
 set -eux
+set -o pipefail
 
 # http://unix.stackexchange.com/questions/30091/fix-or-alternative-for-mktemp-in-os-x
 MYTMPDIR=$(shell mktemp -d 2>/dev/null || mktemp -d -t 'ansible-testing-XXXXXXXXXX')
 trap 'rm -rf "${MYTMPDIR}"' EXIT
 
 # test for https://github.com/ansible/ansible/issues/13688
-ansible-pull -d "${MYTMPDIR}" -U https://github.com/ansible-test-robinro/pull-integration-test "$@"
+ANSIBLE_CONFIG='' ansible-pull -d "${MYTMPDIR}" -U https://github.com/ansible-test-robinro/pull-integration-test "$@"
diff --git a/test/integration/targets/pull_no_127/runme.sh b/test/integration/targets/pull_no_127/runme.sh
index cdb8e057a4..1dc12e81dd 100755
--- a/test/integration/targets/pull_no_127/runme.sh
+++ b/test/integration/targets/pull_no_127/runme.sh
@@ -1,11 +1,12 @@
 #!/usr/bin/env bash
 
 set -eux
+set -o pipefail
 
 # http://unix.stackexchange.com/questions/30091/fix-or-alternative-for-mktemp-in-os-x
 MYTMPDIR=$(shell mktemp -d 2>/dev/null || mktemp -d -t 'ansible-testing-XXXXXXXXXX')
 trap 'rm -rf "${MYTMPDIR}"' EXIT
 
 # test for https://github.com/ansible/ansible/issues/13681
-ansible-pull -d "${MYTMPDIR}" -U https://github.com/ansible-test-robinro/pull-integration-test "$@" \
+ANSIBLE_CONFIG='' ansible-pull -d "${MYTMPDIR}" -U https://github.com/ansible-test-robinro/pull-integration-test "$@" \
     | grep -v '127\.0\.0\.1'
diff --git a/test/integration/targets/pull_run/runme.sh b/test/integration/targets/pull_run/runme.sh
index 854698b2fc..6100601e80 100755
--- a/test/integration/targets/pull_run/runme.sh
+++ b/test/integration/targets/pull_run/runme.sh
@@ -1,10 +1,11 @@
 #!/usr/bin/env bash
 
 set -eux
+set -o pipefail
 
 # http://unix.stackexchange.com/questions/30091/fix-or-alternative-for-mktemp-in-os-x
 MYTMPDIR=$(shell mktemp -d 2>/dev/null || mktemp -d -t 'ansible-testing-XXXXXXXXXX')
 trap 'rm -rf "${MYTMPDIR}"' EXIT
 
-ansible-pull -d "${MYTMPDIR}" -U https://github.com/ansible-test-robinro/pull-integration-test "$@" \
+ANSIBLE_CONFIG='' ansible-pull -d "${MYTMPDIR}" -U https://github.com/ansible-test-robinro/pull-integration-test "$@" \
     | grep MAGICKEYWORD
