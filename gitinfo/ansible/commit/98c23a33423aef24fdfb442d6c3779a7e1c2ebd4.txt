commit 98c23a33423aef24fdfb442d6c3779a7e1c2ebd4
Author: Nathaniel Case <this.is@nathanielca.se>
Date:   Thu Apr 6 12:26:17 2017 -0400

    Attempt to clear up nxos_mtu tests and documentation (#23361)
    
    nxos_system wasn't added until 2.3, so nxos_mtu should have been deprecated
    then.

diff --git a/lib/ansible/modules/network/nxos/_nxos_mtu.py b/lib/ansible/modules/network/nxos/_nxos_mtu.py
index 71e4972391..342d8c3eb6 100644
--- a/lib/ansible/modules/network/nxos/_nxos_mtu.py
+++ b/lib/ansible/modules/network/nxos/_nxos_mtu.py
@@ -25,7 +25,7 @@ DOCUMENTATION = '''
 module: nxos_mtu
 extends_documentation_fragment: nxos
 version_added: "2.2"
-deprecated: Deprecated in 2.2 use M(nxos_system)'s C(mtu) option.
+deprecated: Deprecated in 2.3 use M(nxos_system)'s C(mtu) option.
 short_description: Manages MTU settings on Nexus switch.
 description:
     - Manages MTU settings on Nexus switch.
@@ -42,12 +42,12 @@ options:
         default: null
     mtu:
         description:
-            - MTU for a specific interface.
+            - MTU for a specific interface. Must be an even number between 576 and 9216.
         required: false
         default: null
     sysmtu:
         description:
-            - System jumbo MTU.
+            - System jumbo MTU. Must be an even number between 576 and 9216.
         required: false
         default: null
     state:
diff --git a/test/integration/targets/nxos_mtu/tests/cli/set_mtu.yaml b/test/integration/targets/nxos_mtu/tests/cli/set_mtu.yaml
index 37f266a927..5070617a32 100644
--- a/test/integration/targets/nxos_mtu/tests/cli/set_mtu.yaml
+++ b/test/integration/targets/nxos_mtu/tests/cli/set_mtu.yaml
@@ -32,29 +32,19 @@
     that:
       - "result.changed == false"
 
-- name: configure interface mtu
-  nxos_mtu:
-    interface: Ethernet3/1
-    mtu: 2001
-    provider: "{{ cli }}"
-  register: result
-
-- assert:
-    that:
-      - "result.changed == true"
-
-- name: verify interface mtu
+- name: configure invalid (odd) interface mtu
   nxos_mtu:
     interface: Ethernet3/1
     mtu: 2001
     provider: "{{ cli }}"
   register: result
+  ignore_errors: yes
 
 - assert:
     that:
-      - "result.changed == false"
+      - "result.failed == true"
 
-- name: invalid mtu setting
+- name: configure invalid (large) mtu setting
   nxos_mtu:
     interface: Ethernet3/1
     mtu: 100000
diff --git a/test/integration/targets/nxos_mtu/tests/cli/set_sysmtu.yaml b/test/integration/targets/nxos_mtu/tests/cli/set_sysmtu.yaml
index aa14aa62ea..cadfdac0cc 100644
--- a/test/integration/targets/nxos_mtu/tests/cli/set_sysmtu.yaml
+++ b/test/integration/targets/nxos_mtu/tests/cli/set_sysmtu.yaml
@@ -11,7 +11,6 @@
   nxos_mtu:
     sysmtu: 2000
     provider: "{{ cli }}"
-    transport: nxapi
   register: result
 
 - assert:
@@ -28,29 +27,20 @@
     that:
       - "result.changed == false"
 
-- name: update system mtu
-  nxos_mtu:
-    sysmtu: 2001
-    provider: "{{ cli }}"
-  register: result
-
-- assert:
-    that:
-      - "result.changed == true"
-
-- name: verify system mtu
+- name: configure invalid (odd) system mtu
   nxos_mtu:
     sysmtu: 2001
     provider: "{{ cli }}"
   register: result
+  ignore_errors: yes
 
 - assert:
     that:
-      - "result.changed == false"
+      - "result.failed == true"
 
-- name: invalid setting
+- name: configure invalid (large) system mtu setting
   nxos_mtu:
-    sysmtu: 3000
+    sysmtu: 10000
     provider: "{{ cli }}"
   register: result
   ignore_errors: yes
diff --git a/test/integration/targets/nxos_mtu/tests/nxapi/set_mtu.yaml b/test/integration/targets/nxos_mtu/tests/nxapi/set_mtu.yaml
index 802b95961d..2f9eec3352 100644
--- a/test/integration/targets/nxos_mtu/tests/nxapi/set_mtu.yaml
+++ b/test/integration/targets/nxos_mtu/tests/nxapi/set_mtu.yaml
@@ -32,29 +32,19 @@
     that:
       - "result.changed == false"
 
-- name: configure interface mtu
-  nxos_mtu:
-    interface: Ethernet3/1
-    mtu: 2001
-    provider: "{{ nxapi }}"
-  register: result
-
-- assert:
-    that:
-      - "result.changed == true"
-
-- name: verify interface mtu
+- name: configure invalid (odd) interface mtu
   nxos_mtu:
     interface: Ethernet3/1
     mtu: 2001
     provider: "{{ nxapi }}"
   register: result
+  ignore_errors: yes
 
 - assert:
     that:
-      - "result.changed == false"
+      - "result.failed == true"
 
-- name: invalid mtu setting
+- name: configure invalid (large) mtu setting
   nxos_mtu:
     interface: Ethernet3/1
     mtu: 100000
diff --git a/test/integration/targets/nxos_mtu/tests/nxapi/set_sysmtu.yaml b/test/integration/targets/nxos_mtu/tests/nxapi/set_sysmtu.yaml
index 4b733aa99d..1b85899c91 100644
--- a/test/integration/targets/nxos_mtu/tests/nxapi/set_sysmtu.yaml
+++ b/test/integration/targets/nxos_mtu/tests/nxapi/set_sysmtu.yaml
@@ -27,29 +27,20 @@
     that:
       - "result.changed == false"
 
-- name: update system mtu
-  nxos_mtu:
-    sysmtu: 2001
-    provider: "{{ nxapi }}"
-  register: result
-
-- assert:
-    that:
-      - "result.changed == true"
-
-- name: verify system mtu
+- name: configure invalid (odd) system mtu
   nxos_mtu:
     sysmtu: 2001
     provider: "{{ nxapi }}"
   register: result
+  ignore_errors: yes
 
 - assert:
     that:
-      - "result.changed == false"
+      - "result.failed == true"
 
-- name: invalid setting
+- name: configure invalid (large) system mtu setting
   nxos_mtu:
-    sysmtu: 3000
+    sysmtu: 10000
     provider: "{{ nxapi }}"
   register: result
   ignore_errors: yes
