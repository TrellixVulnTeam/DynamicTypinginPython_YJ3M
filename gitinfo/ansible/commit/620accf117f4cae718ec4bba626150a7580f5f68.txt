commit 620accf117f4cae718ec4bba626150a7580f5f68
Author: Jonathan Palley <jpalley@gmail.com>
Date:   Wed Sep 26 02:57:00 2012 +0800

    make delegate_to localhost act like local_action

diff --git a/lib/ansible/playbook/task.py b/lib/ansible/playbook/task.py
index 69f62f4796..18a77afa7e 100644
--- a/lib/ansible/playbook/task.py
+++ b/lib/ansible/playbook/task.py
@@ -62,6 +62,11 @@ class Task(object):
             self.action      = ds.get('local_action', '')
             self.delegate_to = '127.0.0.1'
             self.transport   = 'local'
+        # delegate_to: localhost should use local transport
+        elif (ds.get('delegate_to', None) in ['127.0.0.1', 'localhost']):
+            self.action		 = ds.get('action', '')
+            self.delegate_to = '127.0.0.1'
+            self.transport   = 'local'
         else:
             self.action      = ds.get('action', '')
             self.delegate_to = ds.get('delegate_to', None)
