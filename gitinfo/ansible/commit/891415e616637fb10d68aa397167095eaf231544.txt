commit 891415e616637fb10d68aa397167095eaf231544
Author: Ingo Gottwald <i.gottwald@tomorrow-focus.de>
Date:   Fri Aug 3 12:35:18 2012 +0200

    Added login_unix_socket option to mysql_user module

diff --git a/library/mysql_user b/library/mysql_user
index b09b1fbd19..5a4062b68d 100755
--- a/library/mysql_user
+++ b/library/mysql_user
@@ -164,6 +164,7 @@ def main():
             login_user=dict(default=None),
             login_password=dict(default=None),
             login_host=dict(default="localhost"),
+            login_unix_socket=dict(default=None),
             user=dict(required=True, aliases=['name']),
             password=dict(default=None),
             host=dict(default="localhost"),
@@ -203,7 +204,10 @@ def main():
         module.fail_json(msg="when supplying login arguments, both login_user and login_password must be provided")
 
     try:
-        db_connection = MySQLdb.connect(host=module.params["login_host"], user=login_user, passwd=login_password, db="mysql")
+        if module.params["login_unix_socket"] != None:
+            db_connection = MySQLdb.connect(host=module.params["login_host"], unix_socket=module.params["login_unix_socket"], user=login_user, passwd=login_password, db="mysql")
+        else:
+            db_connection = MySQLdb.connect(host=module.params["login_host"], user=login_user, passwd=login_password, db="mysql")
         cursor = db_connection.cursor()
     except Exception as e:
         module.fail_json(msg="unable to connect to database, check login_user and login_password are correct or ~/.my.cnf has the credentials")
