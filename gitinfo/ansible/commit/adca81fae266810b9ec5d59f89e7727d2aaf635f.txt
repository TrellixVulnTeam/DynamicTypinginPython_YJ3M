commit adca81fae266810b9ec5d59f89e7727d2aaf635f
Author: Patrick Callahan <pmc@patrickcallahan.com>
Date:   Sun Oct 27 17:07:18 2013 +0000

    Fixup for SuSE and openSuSE.
    
    Account for differences in packages names across RHEL/CentOS
    and SuSE/openSuSE.

diff --git a/packaging/rpm/ansible.spec b/packaging/rpm/ansible.spec
index 2cab35e5bc..c6410fc2f2 100644
--- a/packaging/rpm/ansible.spec
+++ b/packaging/rpm/ansible.spec
@@ -1,23 +1,24 @@
+%define name ansible
+
 %if 0%{?rhel} == 5
 %define __python /usr/bin/python26
 %endif
 
-%if 0%{?rhel} && 0%{?rhel} <= 5
-%{!?python_sitelib: %global python_sitelib %(%{__python} -c "from distutils.sysconfig import get_python_lib; print(get_python_lib())")}
+Name:      %{name}
+Version:   1.4
+Release:   1%{?dist}
+Url:       http://www.ansibleworks.com
+Summary:   SSH-based configuration management, deployment, and orchestration engine
+License:   GPLv3
+Group:     Development/Libraries
+Source:    http://www.ansibleworks.com/releases/%{name}-%{version}.tar.gz
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-buildroot
-%endif
-
-Name: ansible
-Release: 1%{?dist}
-Summary: SSH-based configuration management, deployment, and orchestration engine
-Version: 1.4
 
-Group: Development/Libraries
-License: GPLv3
-Source0: http://www.ansibleworks.com/releases/%{name}-%{version}.tar.gz
-Url: http://www.ansibleworks.com
+%{!?python_sitelib: %global python_sitelib %(%{__python} -c "from distutils.sysconfig import get_python_lib; print(get_python_lib())")}
 
 BuildArch: noarch
+
+# RHEL <=5
 %if 0%{?rhel} && 0%{?rhel} <= 5
 BuildRequires: python26-devel
 
@@ -25,7 +26,10 @@ Requires: python26-PyYAML
 Requires: python26-paramiko
 Requires: python26-jinja2
 Requires: python26-keyczar
-%else
+%endif
+
+# RHEL > 5
+%if 0%{?rhel} && 0%{?rhel} > 5
 BuildRequires: python2-devel
 
 Requires: PyYAML
@@ -33,6 +37,18 @@ Requires: python-paramiko
 Requires: python-jinja2
 Requires: python-keyczar
 %endif
+
+# SuSE/openSuSE
+%if 0%{?suse_version} 
+BuildRequires: python-devel
+BuildRequires: python-setuptools
+
+Requires: python-paramiko
+Requires: python-jinja2
+Requires: python-keyczar
+Requires: python-yaml
+%endif
+
 Requires: sshpass
 
 %description
@@ -50,18 +66,18 @@ are transferred to managed machines automatically.
 %{__python} setup.py build
 
 %install
-%{__python} setup.py install -O1 --root=$RPM_BUILD_ROOT
-mkdir -p $RPM_BUILD_ROOT/etc/ansible/
-cp examples/hosts $RPM_BUILD_ROOT/etc/ansible/
-cp examples/ansible.cfg $RPM_BUILD_ROOT/etc/ansible/
-mkdir -p $RPM_BUILD_ROOT/%{_mandir}/{man1,man3}/
-cp -v docs/man/man1/*.1 $RPM_BUILD_ROOT/%{_mandir}/man1/
-cp -v docs/man/man3/*.3 $RPM_BUILD_ROOT/%{_mandir}/man3/
-mkdir -p $RPM_BUILD_ROOT/%{_datadir}/ansible
-cp -rv library/* $RPM_BUILD_ROOT/%{_datadir}/ansible/
+%{__python} setup.py install -O1 --prefix=%{_prefix} --root=%{buildroot}
+mkdir -p %{buildroot}/etc/ansible/
+cp examples/hosts %{buildroot}/etc/ansible/
+cp examples/ansible.cfg %{buildroot}/etc/ansible/
+mkdir -p %{buildroot}/%{_mandir}/{man1,man3}/
+cp -v docs/man/man1/*.1 %{buildroot}/%{_mandir}/man1/
+cp -v docs/man/man3/*.3 %{buildroot}/%{_mandir}/man3/
+mkdir -p %{buildroot}/%{_datadir}/ansible
+cp -rv library/* %{buildroot}/%{_datadir}/ansible/
 
 %clean
-rm -rf $RPM_BUILD_ROOT
+rm -rf %{buildroot}
 
 %files
 %defattr(-,root,root)
@@ -78,6 +94,11 @@ rm -rf $RPM_BUILD_ROOT
 
 %changelog
 
+* Tue Oct 22 2013 Patrick Callahan <pmc@patrickcallahan.com>
+- Add support for openSuSE and SuSE
+- Replaced rpm variables with rpm macros for consistency
+- Minor reformatting
+
 * Fri Sep 13 2013 Michael DeHaan <michael.dehaan@gmail.com> - 1.4-0
 * (PENDING)
 
