commit a451613dd18e76d585ed34f3417a712b4d792572
Author: Matt Martz <matt@sivel.net>
Date:   Thu Jan 18 15:30:40 2018 -0600

    Make sure we don't try to inspect DOCUMENTATION, if the plugin doesn't have any (#35017)

diff --git a/lib/ansible/plugins/loader.py b/lib/ansible/plugins/loader.py
index 16f66ed040..d3602ebdfb 100644
--- a/lib/ansible/plugins/loader.py
+++ b/lib/ansible/plugins/loader.py
@@ -214,7 +214,7 @@ class PluginLoader:
             if type_name in ('callback', 'connection', 'inventory', 'lookup', 'shell'):
                 dstring = get_docstring(path, fragment_loader, verbose=False, ignore_errors=True)[0]
 
-                if 'options' in dstring and isinstance(dstring['options'], dict):
+                if dstring and 'options' in dstring and isinstance(dstring['options'], dict):
                     C.config.initialize_plugin_configuration_definitions(type_name, name, dstring['options'])
                     display.debug('Loaded config def from plugin (%s/%s)' % (type_name, name))
 
