commit 7a5a5e7c87daee1d343a432894ff04a2251d6349
Author: Sumit Jaiswal <sjaiswal@redhat.com>
Date:   Tue Sep 17 18:24:50 2019 +0530

    Fix traceback error in IOS and IOSXR when ran without config (#62400)
    
    * fixes issue 61321
    
    * complete iosxr
    
    * fix ios_vlans
    
    Signed-off-by: Sumit Jaiswal <sjaiswal@redhat.com>

diff --git a/lib/ansible/modules/network/ios/ios_interfaces.py b/lib/ansible/modules/network/ios/ios_interfaces.py
index 9f8ac4dae1..abb605e292 100644
--- a/lib/ansible/modules/network/ios/ios_interfaces.py
+++ b/lib/ansible/modules/network/ios/ios_interfaces.py
@@ -389,7 +389,12 @@ def main():
 
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=InterfacesArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = Interfaces(module).execute_module()
diff --git a/lib/ansible/modules/network/ios/ios_l2_interfaces.py b/lib/ansible/modules/network/ios/ios_l2_interfaces.py
index be20195662..43991fdbca 100644
--- a/lib/ansible/modules/network/ios/ios_l2_interfaces.py
+++ b/lib/ansible/modules/network/ios/ios_l2_interfaces.py
@@ -348,7 +348,12 @@ def main():
 
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=L2_InterfacesArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = L2_Interfaces(module).execute_module()
diff --git a/lib/ansible/modules/network/ios/ios_l3_interfaces.py b/lib/ansible/modules/network/ios/ios_l3_interfaces.py
index 3afec28c63..c158fcf089 100644
--- a/lib/ansible/modules/network/ios/ios_l3_interfaces.py
+++ b/lib/ansible/modules/network/ios/ios_l3_interfaces.py
@@ -426,7 +426,12 @@ def main():
     Main entry point for module execution
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=L3_InterfacesArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = L3_Interfaces(module).execute_module()
diff --git a/lib/ansible/modules/network/ios/ios_lacp.py b/lib/ansible/modules/network/ios/ios_lacp.py
index 7ff26a0463..1ebe3b3cef 100644
--- a/lib/ansible/modules/network/ios/ios_lacp.py
+++ b/lib/ansible/modules/network/ios/ios_lacp.py
@@ -170,7 +170,11 @@ def main():
 
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',))]
+
     module = AnsibleModule(argument_spec=LacpArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = Lacp(module).execute_module()
diff --git a/lib/ansible/modules/network/ios/ios_lacp_interfaces.py b/lib/ansible/modules/network/ios/ios_lacp_interfaces.py
index 7ebb497b3f..d9e52e39cf 100644
--- a/lib/ansible/modules/network/ios/ios_lacp_interfaces.py
+++ b/lib/ansible/modules/network/ios/ios_lacp_interfaces.py
@@ -347,7 +347,12 @@ def main():
 
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=Lacp_InterfacesArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = Lacp_Interfaces(module).execute_module()
diff --git a/lib/ansible/modules/network/ios/ios_lag_interfaces.py b/lib/ansible/modules/network/ios/ios_lag_interfaces.py
index 765bfcce73..aa3c576884 100644
--- a/lib/ansible/modules/network/ios/ios_lag_interfaces.py
+++ b/lib/ansible/modules/network/ios/ios_lag_interfaces.py
@@ -374,8 +374,14 @@ def main():
     Main entry point for module execution
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=Lag_interfacesArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
+
     result = Lag_interfaces(module).execute_module()
     module.exit_json(**result)
 
diff --git a/lib/ansible/modules/network/ios/ios_lldp_global.py b/lib/ansible/modules/network/ios/ios_lldp_global.py
index a83d899a9c..f9b44a6daa 100644
--- a/lib/ansible/modules/network/ios/ios_lldp_global.py
+++ b/lib/ansible/modules/network/ios/ios_lldp_global.py
@@ -241,7 +241,11 @@ def main():
 
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',))]
+
     module = AnsibleModule(argument_spec=Lldp_globalArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = Lldp_global(module).execute_module()
diff --git a/lib/ansible/modules/network/ios/ios_lldp_interfaces.py b/lib/ansible/modules/network/ios/ios_lldp_interfaces.py
index 2079f5b5da..c1bbc274e4 100644
--- a/lib/ansible/modules/network/ios/ios_lldp_interfaces.py
+++ b/lib/ansible/modules/network/ios/ios_lldp_interfaces.py
@@ -485,7 +485,12 @@ def main():
 
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=Lldp_InterfacesArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = Lldp_Interfaces(module).execute_module()
diff --git a/lib/ansible/modules/network/ios/ios_vlans.py b/lib/ansible/modules/network/ios/ios_vlans.py
index 2d76dc18b3..7de87dbb52 100644
--- a/lib/ansible/modules/network/ios/ios_vlans.py
+++ b/lib/ansible/modules/network/ios/ios_vlans.py
@@ -448,7 +448,12 @@ def main():
 
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=VlansArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = Vlans(module).execute_module()
diff --git a/lib/ansible/modules/network/iosxr/iosxr_interfaces.py b/lib/ansible/modules/network/iosxr/iosxr_interfaces.py
index 7e7f34b7d4..33f556c96b 100644
--- a/lib/ansible/modules/network/iosxr/iosxr_interfaces.py
+++ b/lib/ansible/modules/network/iosxr/iosxr_interfaces.py
@@ -349,7 +349,12 @@ def main():
     Main entry point for module execution
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=InterfacesArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = Interfaces(module).execute_module()
diff --git a/lib/ansible/modules/network/iosxr/iosxr_l2_interfaces.py b/lib/ansible/modules/network/iosxr/iosxr_l2_interfaces.py
index ae82957e98..50d0555c01 100644
--- a/lib/ansible/modules/network/iosxr/iosxr_l2_interfaces.py
+++ b/lib/ansible/modules/network/iosxr/iosxr_l2_interfaces.py
@@ -413,7 +413,12 @@ def main():
     Main entry point for module execution
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=L2_InterfacesArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = L2_Interfaces(module).execute_module()
diff --git a/lib/ansible/modules/network/iosxr/iosxr_l3_interfaces.py b/lib/ansible/modules/network/iosxr/iosxr_l3_interfaces.py
index ad425ee6e0..049066dc2c 100644
--- a/lib/ansible/modules/network/iosxr/iosxr_l3_interfaces.py
+++ b/lib/ansible/modules/network/iosxr/iosxr_l3_interfaces.py
@@ -408,7 +408,12 @@ def main():
     Main entry point for module execution
     :returns: the result form module invocation
     """
+    required_if = [('state', 'merged', ('config',)),
+                   ('state', 'replaced', ('config',)),
+                   ('state', 'overridden', ('config',))]
+
     module = AnsibleModule(argument_spec=L3_InterfacesArgs.argument_spec,
+                           required_if=required_if,
                            supports_check_mode=True)
 
     result = L3_Interfaces(module).execute_module()
