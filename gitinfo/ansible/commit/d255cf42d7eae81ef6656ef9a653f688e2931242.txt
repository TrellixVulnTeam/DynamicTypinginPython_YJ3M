commit d255cf42d7eae81ef6656ef9a653f688e2931242
Author: Matt Martz <matt@sivel.net>
Date:   Mon Jun 25 15:04:32 2018 -0500

    Fix NameError, value was not available in this context leading to a generic unexpected error. Fixes #33275 (#41856)

diff --git a/lib/ansible/playbook/base.py b/lib/ansible/playbook/base.py
index 10f8fe90a4..daaa7c1065 100644
--- a/lib/ansible/playbook/base.py
+++ b/lib/ansible/playbook/base.py
@@ -427,6 +427,7 @@ class FieldAttributeBase(with_metaclass(BaseMeta, object)):
                 # and assign the massaged value back to the attribute field
                 setattr(self, name, value)
             except (TypeError, ValueError) as e:
+                value = getattr(self, name)
                 raise AnsibleParserError("the field '%s' has an invalid value (%s), and could not be converted to an %s."
                                          "The error was: %s" % (name, value, attribute.isa, e), obj=self.get_ds(), orig_exc=e)
             except (AnsibleUndefinedVariable, UndefinedError) as e:
