commit e785cc53dbecdde617199f6fb9923fb231a63063
Author: James Mighion <james.mighion@gmail.com>
Date:   Wed Jul 5 20:49:24 2017 -0700

    Adding stderr regex catch for iosxr commit failures. Adding error handling after executing commit command. (#26462)

diff --git a/lib/ansible/module_utils/iosxr.py b/lib/ansible/module_utils/iosxr.py
index 630ec82553..08e58827fd 100644
--- a/lib/ansible/module_utils/iosxr.py
+++ b/lib/ansible/module_utils/iosxr.py
@@ -137,6 +137,9 @@ def load_config(module, commands, warnings, commit=False, replace=False, comment
     else:
         cmd = 'abort'
         diff = None
-    exec_command(module, cmd)
+    rc, out, err = exec_command(module, cmd)
+    if rc != 0:
+        exec_command(module, 'abort')
+        module.fail_json(msg=err, commands=commands, rc=rc)
 
     return to_text(diff, errors='surrogate_or_strict')
diff --git a/lib/ansible/plugins/terminal/iosxr.py b/lib/ansible/plugins/terminal/iosxr.py
index 802c56e6c2..641d1e8c2e 100644
--- a/lib/ansible/plugins/terminal/iosxr.py
+++ b/lib/ansible/plugins/terminal/iosxr.py
@@ -42,6 +42,7 @@ class TerminalModule(TerminalBase):
         re.compile(br"connection timed out", re.I),
         re.compile(br"[^\r\n]+ not found", re.I),
         re.compile(br"'[^']' +returned error code: ?\d+"),
+        re.compile(br"Failed to commit", re.I)
     ]
 
     def on_open_shell(self):
