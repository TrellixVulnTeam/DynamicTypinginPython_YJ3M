commit ad4eb751a544f5d44d1171512a556c3626ef5a54
Author: Trond Hindenes <trond@hindenes.com>
Date:   Mon Jun 6 23:18:51 2016 +0200

    moved pending reboot to powershell.ps1

diff --git a/lib/ansible/module_utils/powershell.ps1 b/lib/ansible/module_utils/powershell.ps1
index 757279aba6..17b692f215 100644
--- a/lib/ansible/module_utils/powershell.ps1
+++ b/lib/ansible/module_utils/powershell.ps1
@@ -225,3 +225,20 @@ Function Get-FileChecksum($path)
     }
     return $hash
 }
+
+Function Get-PendingRebootStatus
+{
+    # Check if reboot is required, if so notify CA. The MSFT_ServerManagerTasks provider is missing on client SKUs
+    #Function returns true if computer has a pending reboot
+    $featureData = invoke-wmimethod -EA Ignore -Name GetServerFeature -namespace root\microsoft\windows\servermanager -Class MSFT_ServerManagerTasks
+    $regData = Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager" "PendingFileRenameOperations" -EA Ignore
+    if(($featureData -and $featureData.RequiresReboot) -or $regData)
+    {
+        return $True
+    }
+    else 
+    {
+        return $False
+    }
+
+}
\ No newline at end of file
