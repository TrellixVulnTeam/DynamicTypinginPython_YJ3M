commit e2f66abe7386810df4ca645aaf4edf9587d70bce
Author: Matt Davis <mdavis@ansible.com>
Date:   Mon Oct 3 07:27:47 2016 -0700

    fixed windows setup to run in check_mode

diff --git a/lib/ansible/modules/windows/setup.ps1 b/lib/ansible/modules/windows/setup.ps1
index fcbe9ca130..fef2ade25c 100644
--- a/lib/ansible/modules/windows/setup.ps1
+++ b/lib/ansible/modules/windows/setup.ps1
@@ -17,9 +17,7 @@
 # WANT_JSON
 # POWERSHELL_COMMON
 
-# enabled $params (David O'Brien, 06/08/2015)
-$params = Parse-Args $args;
-
+$params = Parse-Args $args -supports_check_mode $true
 
 Function Get-CustomFacts {
   [cmdletBinding()]
