commit e1d57d8876589525d6942837a461471f64bd53ff
Author: Brian Coca <bcoca@ansible.com>
Date:   Sat Jun 28 00:24:16 2014 -0400

    now compares permissions correctly

diff --git a/library/files/acl b/library/files/acl
index 625a051c33..8be08e2e53 100644
--- a/library/files/acl
+++ b/library/files/acl
@@ -102,6 +102,17 @@ EXAMPLES = '''
   register: acl_info
 '''
 
+def normalize_permissions(p):
+    perms = ['-','-','-']
+    for char in p:
+        if char == 'r':
+            perms[0] = 'r'
+        if char == 'w':
+            perms[1] = 'w'
+        if char == 'x':
+            perms[2] = 'x'
+    return ''.join(perms)
+
 def split_entry(entry):
     ''' splits entry and ensures normalized return'''
 
@@ -129,15 +140,7 @@ def split_entry(entry):
     else:
         t = None
 
-    perms = ['-','-','-']
-    for char in p:
-        if char == 'r':
-            perms[0] = 'r'
-        if char == 'w':
-            perms[1] = 'w'
-        if char == 'x':
-            perms[2] = 'x'
-    p = ''.join(perms)
+    p = normalize_permissions(p)
 
     return [d,t,e,p]
 
@@ -208,7 +211,7 @@ def main():
     entry = module.params.get('entry')
     entity = module.params.get('entity')
     etype = module.params.get('etype')
-    permissions = module.params.get('permissions')
+    permissions = normalize_permissions(module.params.get('permissions'))
     state = module.params.get('state')
     follow = module.params.get('follow')
     default = module.params.get('default')
