commit b09f1f8e0b4375e0885db0f309fec2a37a1ae51a
Author: James Cammarata <jimi@sngx.net>
Date:   Wed Jul 22 00:08:32 2015 -0400

    Account for filters in bare variable conversion
    
    Fixes #11530

diff --git a/lib/ansible/template/__init__.py b/lib/ansible/template/__init__.py
index f10ea22fb5..3b0bafdbd6 100644
--- a/lib/ansible/template/__init__.py
+++ b/lib/ansible/template/__init__.py
@@ -211,8 +211,9 @@ class Templar:
         '''
 
         if isinstance(variable, basestring):
-            first_part = variable.split(".")[0].split("[")[0]
-            if first_part in self._available_variables and self.environment.variable_start_string not in variable:
+            contains_filters = "|" in variable
+            first_part = variable.split("|")[0].split(".")[0].split("[")[0]
+            if (contains_filters or first_part in self._available_variables) and self.environment.variable_start_string not in variable:
                 return "%s%s%s" % (self.environment.variable_start_string, variable, self.environment.variable_end_string)
 
         # the variable didn't meet the conditions to be converted,
