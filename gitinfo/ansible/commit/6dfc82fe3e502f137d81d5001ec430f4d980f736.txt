commit 6dfc82fe3e502f137d81d5001ec430f4d980f736
Author: Tyler Gregory <tdgregory@protonmail.com>
Date:   Wed Mar 21 00:37:48 2018 -0500

    Set win_rm protocol to the name, not the full ProtocolTypes object (#37499)

diff --git a/contrib/inventory/azure_rm.py b/contrib/inventory/azure_rm.py
index a52fdec4ff..513e06f30b 100755
--- a/contrib/inventory/azure_rm.py
+++ b/contrib/inventory/azure_rm.py
@@ -630,7 +630,7 @@ class AzureInventory(object):
                     if machine.os_profile.windows_configuration.win_rm.listeners is not None:
                         host_vars['windows_rm']['listeners'] = []
                         for listener in machine.os_profile.windows_configuration.win_rm.listeners:
-                            host_vars['windows_rm']['listeners'].append(dict(protocol=listener.protocol,
+                            host_vars['windows_rm']['listeners'].append(dict(protocol=listener.protocol.name,
                                                                              certificate_url=listener.certificate_url))
 
             for interface in machine.network_profile.network_interfaces:
