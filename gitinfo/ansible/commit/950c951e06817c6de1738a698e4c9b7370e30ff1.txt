commit 950c951e06817c6de1738a698e4c9b7370e30ff1
Author: Matt Martz <matt@sivel.net>
Date:   Mon Oct 5 13:22:32 2015 -0500

    sys.exit removal for cloud/xenserver_facts.py

diff --git a/lib/ansible/modules/extras/cloud/xenserver_facts.py b/lib/ansible/modules/extras/cloud/xenserver_facts.py
index 149030925f..d679afce85 100644
--- a/lib/ansible/modules/extras/cloud/xenserver_facts.py
+++ b/lib/ansible/modules/extras/cloud/xenserver_facts.py
@@ -28,7 +28,6 @@ author:
 '''
 
 import platform
-import sys
 import XenAPI
 
 EXAMPLES = '''
@@ -75,12 +74,9 @@ class XenServerFacts:
 
 
 def get_xenapi_session():
-    try:
-        session = XenAPI.xapi_local()
-        session.xenapi.login_with_password('', '')
-        return session
-    except XenAPI.Failure:
-        sys.exit(1)
+    session = XenAPI.xapi_local()
+    session.xenapi.login_with_password('', '')
+    return session
 
 
 def get_networks(session):
@@ -163,8 +159,10 @@ def main():
     module = AnsibleModule({})
 
     obj = XenServerFacts()
-    session = get_xenapi_session()
-
+    try:
+        session = get_xenapi_session()
+    except XenAPI.Failure, e:
+        module.fail_json(msg='%s' % e)
 
     data = {
         'xenserver_version': obj.version,
