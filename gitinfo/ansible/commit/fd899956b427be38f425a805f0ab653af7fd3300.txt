commit fd899956b427be38f425a805f0ab653af7fd3300
Author: Martin Krizek <martin.krizek@gmail.com>
Date:   Tue Jul 30 09:46:29 2019 +0200

    Use correct delegate_to hostnames in loops (#59659)
    
    Fixes #59650

diff --git a/changelogs/fragments/59650-correctly-handler-delegate_to_hostname-loops.yaml b/changelogs/fragments/59650-correctly-handler-delegate_to_hostname-loops.yaml
new file mode 100644
index 0000000000..efdaf13300
--- /dev/null
+++ b/changelogs/fragments/59650-correctly-handler-delegate_to_hostname-loops.yaml
@@ -0,0 +1,2 @@
+bugfixes:
+  - Correctly handle delegate_to hostnames in loops (https://github.com/ansible/ansible/issues/59650)
diff --git a/lib/ansible/vars/manager.py b/lib/ansible/vars/manager.py
index 3740e02afc..d529047811 100644
--- a/lib/ansible/vars/manager.py
+++ b/lib/ansible/vars/manager.py
@@ -546,7 +546,7 @@ class VariableManager:
             if item is not None:
                 vars_copy[item_var] = item
 
-            templar.set_available_variables = vars_copy
+            templar.available_variables = vars_copy
             delegated_host_name = templar.template(task.delegate_to, fail_on_undefined=False)
             if delegated_host_name != task.delegate_to:
                 cache_items = True
