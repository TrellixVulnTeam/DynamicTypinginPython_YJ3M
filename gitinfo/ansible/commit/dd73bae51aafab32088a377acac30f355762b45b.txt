commit dd73bae51aafab32088a377acac30f355762b45b
Author: Abhijeet Kasurde <akasurde@redhat.com>
Date:   Fri Jul 27 10:25:21 2018 +0530

    VMware: handle indexError for snapshot details (#42575)
    
    Fixes: #42539
    
    Signed-off-by: Abhijeet Kasurde <akasurde@redhat.com>

diff --git a/lib/ansible/module_utils/vmware.py b/lib/ansible/module_utils/vmware.py
index 886994e535..091f725d5d 100644
--- a/lib/ansible/module_utils/vmware.py
+++ b/lib/ansible/module_utils/vmware.py
@@ -437,8 +437,10 @@ def list_snapshots(vm):
     result['snapshots'] = list_snapshots_recursively(vm.snapshot.rootSnapshotList)
     current_snapref = vm.snapshot.currentSnapshot
     current_snap_obj = get_current_snap_obj(vm.snapshot.rootSnapshotList, current_snapref)
-    result['current_snapshot'] = deserialize_snapshot_obj(current_snap_obj[0])
-
+    if current_snap_obj:
+        result['current_snapshot'] = deserialize_snapshot_obj(current_snap_obj[0])
+    else:
+        result['current_snapshot'] = dict()
     return result
 
 
