commit f1eb195ff54adb0a2abf26cf0ea8cb2884edc896
Author: Daniel Hokka Zakrisson <daniel@hozac.com>
Date:   Fri Mar 1 23:22:07 2013 +0100

    vars_loader should get the path to the inventory + vars_plugins

diff --git a/lib/ansible/inventory/__init__.py b/lib/ansible/inventory/__init__.py
index 49b7f1221e..9efb27b665 100644
--- a/lib/ansible/inventory/__init__.py
+++ b/lib/ansible/inventory/__init__.py
@@ -92,7 +92,7 @@ class Inventory(object):
                 else:
                     raise errors.AnsibleError("YAML inventory support is deprecated in 0.6 and removed in 0.7, see the migration script in examples/scripts in the git checkout")
 
-            utils.plugins.vars_loader.add_directory(self.basedir())
+            utils.plugins.vars_loader.add_directory(self.basedir(), with_subdir=True)
         else:
             raise errors.AnsibleError("Unable to find an inventory file, specify one with -i ?")
 
diff --git a/lib/ansible/utils/plugins.py b/lib/ansible/utils/plugins.py
index 2af819b181..5a2867fd83 100644
--- a/lib/ansible/utils/plugins.py
+++ b/lib/ansible/utils/plugins.py
@@ -68,9 +68,11 @@ class PluginLoader(object):
         ret += self._get_package_path()
         return ret
 
-    def add_directory(self, directory):
+    def add_directory(self, directory, with_subdir=False):
         """Adds an additional directory to the search path"""
         if directory is not None:
+            if with_subdir:
+                directory = os.path.join(directory, self.subdir)
             self._extra_dirs.append(directory)
 
     def print_paths(self):
