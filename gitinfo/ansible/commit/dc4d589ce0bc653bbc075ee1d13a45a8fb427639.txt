commit dc4d589ce0bc653bbc075ee1d13a45a8fb427639
Author: James Tanner <tanner.jc@gmail.com>
Date:   Fri Nov 1 09:41:22 2013 -0400

    Fixes #4767 detect hard links and set state in add_file_info

diff --git a/lib/ansible/module_utils/basic.py b/lib/ansible/module_utils/basic.py
index 7b41c03c16..a04d6c403e 100644
--- a/lib/ansible/module_utils/basic.py
+++ b/lib/ansible/module_utils/basic.py
@@ -511,6 +511,8 @@ class AnsibleModule(object):
                 kwargs['state'] = 'link'
             elif os.path.isdir(path):
                 kwargs['state'] = 'directory'
+            elif os.stat(path).st_nlink > 1:
+                kwargs['state'] = 'hard'
             else:
                 kwargs['state'] = 'file'
             if HAVE_SELINUX and self.selinux_enabled():
