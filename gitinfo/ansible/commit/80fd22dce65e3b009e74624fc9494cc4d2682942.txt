commit 80fd22dce65e3b009e74624fc9494cc4d2682942
Author: Serge van Ginderachter <serge@vanginderachter.be>
Date:   Sat Nov 9 13:29:39 2013 +0100

    Check real user's known_hosts when sudo ansible...
    
    closes #4834

diff --git a/lib/ansible/runner/connection_plugins/ssh.py b/lib/ansible/runner/connection_plugins/ssh.py
index 5ee45ba6a9..7e35374650 100644
--- a/lib/ansible/runner/connection_plugins/ssh.py
+++ b/lib/ansible/runner/connection_plugins/ssh.py
@@ -116,7 +116,7 @@ class Connection(object):
             os.close(self.wfd)
 
     def not_in_host_file(self, host):
-        host_file = os.path.expanduser("~/.ssh/known_hosts")
+        host_file = os.path.expanduser(os.path.expandvars("~${USER}/.ssh/known_hosts"))
         if not os.path.exists(host_file):
             print "previous known host file not found"
             return True
