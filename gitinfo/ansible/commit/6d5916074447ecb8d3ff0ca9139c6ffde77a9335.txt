commit 6d5916074447ecb8d3ff0ca9139c6ffde77a9335
Author: Eugen C <armab@users.noreply.github.com>
Date:   Mon Jun 26 23:01:06 2017 +0300

    Fix ansible ad-hoc to respect ANSIBLE_STDOUT_CALLBACK (#26098)
    
    * Fix ansible ad-hoc to respect ANSIBLE_STDOUT_CALLBACK
    
    * Ansible ad-hoc 'stdout_callback' should work only with 'bin_ansible_callbacks'

diff --git a/lib/ansible/cli/adhoc.py b/lib/ansible/cli/adhoc.py
index 9795b221e7..4891323946 100644
--- a/lib/ansible/cli/adhoc.py
+++ b/lib/ansible/cli/adhoc.py
@@ -152,6 +152,9 @@ class AdHocCLI(CLI):
             cb = self.callback
         elif self.options.one_line:
             cb = 'oneline'
+        # Respect custom 'stdout_callback' only with enabled 'bin_ansible_callbacks'
+        elif C.DEFAULT_LOAD_CALLBACK_PLUGINS and C.DEFAULT_STDOUT_CALLBACK != 'default':
+            cb = C.DEFAULT_STDOUT_CALLBACK
         else:
             cb = 'minimal'
 
