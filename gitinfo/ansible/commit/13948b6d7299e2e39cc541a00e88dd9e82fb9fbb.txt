commit 13948b6d7299e2e39cc541a00e88dd9e82fb9fbb
Author: Nathaniel Case <this.is@nathanielca.se>
Date:   Mon Jul 31 14:13:32 2017 -0400

    More nxos integration fixes (#27507)
    
    * nxos does not have `authorize`
    
    * Enable nxos_banner nxapi tests

diff --git a/test/integration/targets/nxos_banner/tasks/nxapi.yaml b/test/integration/targets/nxos_banner/tasks/nxapi.yaml
new file mode 100644
index 0000000000..ea525379f7
--- /dev/null
+++ b/test/integration/targets/nxos_banner/tasks/nxapi.yaml
@@ -0,0 +1,28 @@
+---
+- name: collect all nxapi test cases
+  find:
+    paths: "{{ role_path }}/tests/nxapi"
+    patterns: "{{ testcase }}.yaml"
+  register: test_cases
+
+- name: set test_items
+  set_fact: test_items="{{ test_cases.files | map(attribute='path') | list }}"
+
+- name: enable nxapi
+  nxos_config:
+    lines:
+      - feature nxapi
+      - nxapi http port 80
+    provider: "{{ cli }}"
+
+- name: run test case
+  include: "{{ test_case_to_run }}"
+  with_items: "{{ test_items }}"
+  loop_control:
+    loop_var: test_case_to_run
+
+- name: disable nxapi
+  nxos_config:
+    lines:
+      - no feature nxapi
+    provider: "{{ cli }}"
diff --git a/test/integration/targets/nxos_user/tests/cli/basic.yaml b/test/integration/targets/nxos_user/tests/cli/basic.yaml
index 86069baba5..2adce30615 100644
--- a/test/integration/targets/nxos_user/tests/cli/basic.yaml
+++ b/test/integration/targets/nxos_user/tests/cli/basic.yaml
@@ -4,7 +4,6 @@
     name: netend
     roles: network-operator
     state: present
-    authorize: yes
     provider: "{{ cli }}"
   register: result
 
@@ -18,7 +17,6 @@
     aggregate:
       - name: test1
       - name: test2
-    authorize: yes
     state: present
     roles: network-admin
     provider: "{{ cli }}"
@@ -32,7 +30,6 @@
 - name: tearDown
   nxos_user:
     purge: yes
-    authorize: yes
     provider: "{{ cli }}"
   register: result
 
diff --git a/test/integration/targets/nxos_user/tests/nxapi/basic.yaml b/test/integration/targets/nxos_user/tests/nxapi/basic.yaml
index f47fc5e40f..f3bc1ed1a4 100644
--- a/test/integration/targets/nxos_user/tests/nxapi/basic.yaml
+++ b/test/integration/targets/nxos_user/tests/nxapi/basic.yaml
@@ -4,7 +4,6 @@
     name: netend
     roles: network-operator
     state: present
-    authorize: yes
     provider: "{{ nxapi }}"
   register: result
 
@@ -18,7 +17,6 @@
     aggregate:
       - name: test1
       - name: test2
-    authorize: yes
     state: present
     roles: network-admin
     provider: "{{ nxapi }}"
@@ -32,7 +30,6 @@
 - name: tearDown
   nxos_user:
     purge: yes
-    authorize: yes
     provider: "{{ nxapi }}"
   register: result
 
