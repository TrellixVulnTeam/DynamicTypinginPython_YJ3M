commit f2640d339493bd827dad3cfbcb5b18467fac0155
Author: Abhijeet Kasurde <akasurde@redhat.com>
Date:   Thu Jul 19 16:46:44 2018 +0530

    VMware: handle pnic in proxyswitch (#42996)
    
    Fixes: #42943
    
    Signed-off-by: Abhijeet Kasurde <akasurde@redhat.com>

diff --git a/lib/ansible/modules/cloud/vmware/vmware_host_vmnic_facts.py b/lib/ansible/modules/cloud/vmware/vmware_host_vmnic_facts.py
index 6c2007c666..c64b8ab701 100644
--- a/lib/ansible/modules/cloud/vmware/vmware_host_vmnic_facts.py
+++ b/lib/ansible/modules/cloud/vmware/vmware_host_vmnic_facts.py
@@ -92,15 +92,15 @@ class HostVmnicMgr(PyVmomi):
                 host_vmnic_facts['all'] = [pnic.device for pnic in nw_config.pnic]
 
                 vswitch_vmnics = []
+                proxy_switch_vmnics = []
                 if nw_config.vswitch:
                     for vswitch in nw_config.vswitch:
                         for vnic in vswitch.spec.bridge.nicDevice:
                             vswitch_vmnics.append(vnic)
 
-                proxy_switch_vmnics = []
-                if nw_config.vswitch:
+                if nw_config.proxySwitch:
                     for proxy_config in nw_config.proxySwitch:
-                        for proxy_nic in proxy_config.spec.bridge.nicDevice:
+                        for proxy_nic in proxy_config.spec.backing.pnicSpec:
                             proxy_switch_vmnics.append(proxy_nic.pnicDevice)
 
                 used_vmics = proxy_switch_vmnics + vswitch_vmnics
