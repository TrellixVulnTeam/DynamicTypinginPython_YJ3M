commit 7ea34369f75b199412baba964894497b71348f4a
Author: Michael Perzel <michael.perzel@surescripts.com>
Date:   Tue Sep 8 13:37:39 2015 -0500

    Add support for command arguments

diff --git a/lib/ansible/modules/extras/windows/win_scheduled_task.ps1 b/lib/ansible/modules/extras/windows/win_scheduled_task.ps1
index 5777d198cc..4b64b7999e 100644
--- a/lib/ansible/modules/extras/windows/win_scheduled_task.ps1
+++ b/lib/ansible/modules/extras/windows/win_scheduled_task.ps1
@@ -74,6 +74,12 @@ else
   $path = "\"  #default
 }
 
+# Optional vars
+if ($params.argument)
+{
+  $argument = $params.argument
+}
+
 try {
     $task = Get-ScheduledTask -TaskPath "$path" | Where-Object {$_.TaskName -eq "$name"}
 
@@ -137,6 +143,13 @@ try {
     else {
         $settings = New-ScheduledTaskSettingsSet
     }
+    
+    if ($argument) {
+        $action = New-ScheduledTaskAction -Execute $execute -Argument $argument
+    }
+    else {
+        $action = New-ScheduledTaskAction -Execute $execute
+    }
 
     if ( ($state -eq "present") -and ($exists -eq $false) ){
         $action = New-ScheduledTaskAction -Execute $execute
@@ -152,9 +165,7 @@ try {
         }
         else {
             Unregister-ScheduledTask -TaskName $name -Confirm:$false
-            $action = New-ScheduledTaskAction -Execute $execute
-            Register-ScheduledTask -Action $action -Trigger $trigger -TaskName $name -Description $description -TaskPath $path -Settings $settings
-            $task = Get-ScheduledTask -TaskName $name
+            Register-ScheduledTask -Action $action -Trigger $trigger -TaskName $name -Description $description -TaskPath $path -Settings $settings  -Principal $principal
             Set-Attr $result "msg" "Updated task $name"
             $result.changed = $true
         }
