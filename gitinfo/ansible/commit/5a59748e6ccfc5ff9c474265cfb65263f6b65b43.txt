commit 5a59748e6ccfc5ff9c474265cfb65263f6b65b43
Author: Yuwei Zhou <yuwzho@microsoft.com>
Date:   Mon Dec 10 10:30:23 2018 +0800

    Fix if the route table changed to none (#49533)

diff --git a/lib/ansible/modules/cloud/azure/azure_rm_subnet.py b/lib/ansible/modules/cloud/azure/azure_rm_subnet.py
index 573c034e1d..bbc7e1ce6c 100644
--- a/lib/ansible/modules/cloud/azure/azure_rm_subnet.py
+++ b/lib/ansible/modules/cloud/azure/azure_rm_subnet.py
@@ -241,6 +241,7 @@ class AzureRMSubnet(AzureRMModuleBase):
         if self.security_group:
             nsg = self.parse_nsg()
 
+        route_table = dict()
         if self.route_table:
             route_table = self.parse_resource_to_dict(self.route_table)
             self.route_table = format_resource_id(val=route_table['name'],
@@ -276,7 +277,7 @@ class AzureRMSubnet(AzureRMModuleBase):
                 if self.route_table != results['route_table'].get('id'):
                     changed = True
                     results['route_table']['id'] = self.route_table
-                    self.log("CHANGED: subnet {0} route_table to {1}".format(self.name, route_table['name']))
+                    self.log("CHANGED: subnet {0} route_table to {1}".format(self.name, route_table.get('name')))
 
                 if self.service_endpoints:
                     oldd = {}
