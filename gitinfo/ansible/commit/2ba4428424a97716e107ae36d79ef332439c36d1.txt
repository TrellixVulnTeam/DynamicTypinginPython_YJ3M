commit 2ba4428424a97716e107ae36d79ef332439c36d1
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Fri Mar 18 05:52:53 2016 -0700

    Catch ValueError as well because of El Capitan provoking a bug in python2's subprocess
    
    Fixes #14895

diff --git a/lib/ansible/parsing/vault/__init__.py b/lib/ansible/parsing/vault/__init__.py
index 8ea80d1b07..8635da52bf 100644
--- a/lib/ansible/parsing/vault/__init__.py
+++ b/lib/ansible/parsing/vault/__init__.py
@@ -275,8 +275,12 @@ class VaultEditor:
 
         try:
             r = call(['shred', tmp_path])
-        except OSError:
+        except (OSError, ValueError):
             # shred is not available on this system, or some other error occured.
+            # ValueError caught because OS X El Capitan is raising an
+            # exception big enough to hit a limit in python2-2.7.11 and below.
+            # Symptom is ValueError: insecure pickle when shred is not
+            # installed there.
             r = 1
 
         if r != 0:
