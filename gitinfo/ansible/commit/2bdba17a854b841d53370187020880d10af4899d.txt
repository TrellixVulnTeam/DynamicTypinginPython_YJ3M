commit 2bdba17a854b841d53370187020880d10af4899d
Author: Michael Scherer <misc@zarb.org>
Date:   Tue Aug 20 21:51:14 2013 +0200

    make sure ssh do not ask password
    
    For some reason, ssh seems to ask for password even when
    PasswordAuthentication is set to no, adding PreferredAuthentications
    with the 2 options removed do the trick.

diff --git a/lib/ansible/runner/connection_plugins/ssh.py b/lib/ansible/runner/connection_plugins/ssh.py
index ece1021f85..7fa08f3292 100644
--- a/lib/ansible/runner/connection_plugins/ssh.py
+++ b/lib/ansible/runner/connection_plugins/ssh.py
@@ -73,6 +73,7 @@ class Connection(object):
                                  "-o", "PubkeyAuthentication=no"]
         else:
             self.common_args += ["-o", "KbdInteractiveAuthentication=no",
+                                 "-o", "PreferredAuthentications=hostbased,publickey",
                                  "-o", "PasswordAuthentication=no"]
         if self.user != pwd.getpwuid(os.geteuid())[0]:
             self.common_args += ["-o", "User="+self.user]
