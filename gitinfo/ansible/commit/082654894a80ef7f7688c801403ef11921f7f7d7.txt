commit 082654894a80ef7f7688c801403ef11921f7f7d7
Author: Abhijeet Kasurde <akasurde@redhat.com>
Date:   Wed Jan 17 17:27:22 2018 +0530

    VMware: Add ESXi hostname in fact details (#34981)
    
    Fixes: #33972
    
    Signed-off-by: Abhijeet Kasurde <akasurde@redhat.com>

diff --git a/lib/ansible/modules/cloud/vmware/vmware_vm_facts.py b/lib/ansible/modules/cloud/vmware/vmware_vm_facts.py
index 74d5364a60..0c474a9b0f 100644
--- a/lib/ansible/modules/cloud/vmware/vmware_vm_facts.py
+++ b/lib/ansible/modules/cloud/vmware/vmware_vm_facts.py
@@ -100,6 +100,10 @@ class VmwareVmFacts(PyVmomi):
                         else:
                             net_dict[device.macAddress]['ipv4'].append(ip_addr)
 
+            esxi_hostname = None
+            if summary.runtime.host:
+                esxi_hostname = summary.runtime.host.summary.config.name
+
             virtual_machine = {
                 summary.config.name: {
                     "guest_fullname": summary.config.guestFullName,
@@ -108,6 +112,7 @@ class VmwareVmFacts(PyVmomi):
                     "mac_address": _mac_address,  # Kept for backward compatibility
                     "uuid": summary.config.uuid,
                     "vm_network": net_dict,
+                    "esxi_hostname": esxi_hostname,
                 }
             }
 
