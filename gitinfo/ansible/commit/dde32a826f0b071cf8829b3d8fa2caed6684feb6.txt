commit dde32a826f0b071cf8829b3d8fa2caed6684feb6
Author: Toshio Kuratomi <a.badger@gmail.com>
Date:   Thu Jan 15 11:08:00 2015 -0800

    Set default values for shell variables that we use
    
    Fixes #9991

diff --git a/hacking/env-setup b/hacking/env-setup
index 6b19f46510..ae465ed45d 100644
--- a/hacking/env-setup
+++ b/hacking/env-setup
@@ -1,6 +1,12 @@
 # usage: source ./hacking/env-setup [-q]
 #    modifies environment for running Ansible from checkout
 
+# Default values for shell variables we use
+PYTHONPATH=${PYTHONPATH-""}
+PATH=${PATH-""}
+MANPATH=${MANPATH-""}
+VERBOSITY=${1-""}
+
 # When run using source as directed, $0 gets set to bash, so we must use $BASH_SOURCE
 if [ -n "$BASH_SOURCE" ] ; then
     HACKING_DIR=$(dirname "$BASH_SOURCE")
@@ -40,15 +46,23 @@ gen_egg_info()
 # directory in history
 if [ "$ANSIBLE_HOME" != "$PWD" ] ; then
     pushd "$ANSIBLE_HOME"
-    gen_egg_info
+    if [ "$VERBOSITY" = "-q" ] ; then
+        gen_egg_info 2>1 1> /dev/null
+    else
+        gen_egg_info
+    fi
     popd
 else
-    gen_egg_info
+    if [ "$VERBOSITY" = "-q" ] ; then
+        gen_egg_info 2>1 1> /dev/null
+    else
+        gen_egg_info
+    fi
 fi
 
 # Print out values unless -q is set
 
-if [ $# -eq 0 -o "$1" != "-q" ] ; then
+if [ "$VERBOSITY" != "-q" ] ; then
     echo ""
     echo "Setting up Ansible to run out of checkout..."
     echo ""
diff --git a/v2/hacking/env-setup b/v2/hacking/env-setup
index 87178551d2..d762c34f0d 100644
--- a/v2/hacking/env-setup
+++ b/v2/hacking/env-setup
@@ -1,6 +1,12 @@
 # usage: source ./hacking/env-setup [-q]
 #    modifies environment for running Ansible from checkout
 
+# Default values for shell variables we use
+PYTHONPATH=${PYTHONPATH-""}
+PATH=${PATH-""}
+MANPATH=${MANPATH-""}
+VERBOSITY=${1-""}
+
 # When run using source as directed, $0 gets set to bash, so we must use $BASH_SOURCE
 if [ -n "$BASH_SOURCE" ] ; then
     HACKING_DIR=$(dirname "$BASH_SOURCE")
@@ -40,15 +46,23 @@ gen_egg_info()
 # directory in history
 #if [ "$ANSIBLE_HOME" != "$PWD" ] ; then
 #    pushd "$ANSIBLE_HOME"
-#    gen_egg_info
+#    if [ "$VERBOSITY" = "-q" ] ; then
+#        gen_egg_info 2>1 1> /dev/null
+#    else
+#        gen_egg_info
+#    fi
 #    popd
 #else
-#    gen_egg_info
+#    if [ "$VERBOSITY" = "-q" ] ; then
+#        gen_egg_info 2>1 1> /dev/null
+#    else
+#        gen_egg_info
+#    fi
 #fi
 
 # Print out values unless -q is set
 
-if [ $# -eq 0 -o "$1" != "-q" ] ; then
+if [ "$VERBOSITY" != "-q" ] ; then
     echo ""
     echo "Setting up Ansible to run out of checkout..."
     echo ""
