commit b678cf783cce38424dc821ce49179e8ef4bfb37b
Author: Jeroen Hoekx <jeroen.hoekx@hamok.be>
Date:   Wed Apr 18 11:40:15 2012 +0200

    Template the source file of the copy module.

diff --git a/lib/ansible/runner.py b/lib/ansible/runner.py
index 7ce2275a7b..a029d73afa 100755
--- a/lib/ansible/runner.py
+++ b/lib/ansible/runner.py
@@ -368,7 +368,11 @@ class Runner(object):
         dest   = options.get('dest', None)
         if source is None or dest is None:
             return (host, True, dict(failed=True, msg="src and dest are required"), '')
-        
+
+        # apply templating to source argument
+        inject = self.setup_cache.get(conn.host,{})
+        source = utils.template(source, inject)
+
         # transfer the file to a remote tmp location
         tmp_src = tmp + source.split('/')[-1]
         conn.put_file(utils.path_dwim(self.basedir, source), tmp_src)
