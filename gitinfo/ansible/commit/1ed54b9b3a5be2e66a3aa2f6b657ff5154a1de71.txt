commit 1ed54b9b3a5be2e66a3aa2f6b657ff5154a1de71
Author: Stoned Elipot <stoned.elipot@gmail.com>
Date:   Sun Apr 7 00:43:39 2013 +0200

    when: condition support for tasks include

diff --git a/lib/ansible/playbook/play.py b/lib/ansible/playbook/play.py
index f46e6ad4b0..8646bcd8b1 100644
--- a/lib/ansible/playbook/play.py
+++ b/lib/ansible/playbook/play.py
@@ -206,6 +206,8 @@ class Play(object):
                         items = utils.plugins.lookup_loader.get(plugin_name, basedir=self.basedir, runner=None).run(terms, inject=task_vars)
                     elif k.startswith("when_"):
                         included_additional_conditions.append(utils.compile_when_to_only_if("%s %s" % (k[5:], x[k])))
+                    elif k == 'when':
+                        included_additional_conditions.append(utils.compile_when_to_only_if("jinja2_compare %s" % x[k]))
                     elif k in ("include", "vars", "only_if"):
                         pass
                     else:
