commit 7272877df6774c266cacd8c90c5573fa57bd9cd5
Author: Will Thames <will@thames.id.au>
Date:   Fri Mar 21 13:26:07 2014 +1000

    Allow npm to install to a directory that doesn't yet exist
    
    If path is specified but does not exist, create it.
    Fail if path is specified but is not a directory

diff --git a/library/packaging/npm b/library/packaging/npm
index 1157d8f663..7034c7f996 100644
--- a/library/packaging/npm
+++ b/library/packaging/npm
@@ -139,6 +139,10 @@ class Npm(object):
             #If path is specified, cd into that path and run the command.
             cwd = None
             if self.path:
+                if not os.path.exists(self.path):
+                    os.makedirs(self.path)
+                if not os.path.isdir(self.path):
+                    self.module.fail_json(msg="path %s is not a directory" % self.path)
                 cwd = self.path
 
             rc, out, err = self.module.run_command(cmd, check_rc=check_rc, cwd=cwd)
