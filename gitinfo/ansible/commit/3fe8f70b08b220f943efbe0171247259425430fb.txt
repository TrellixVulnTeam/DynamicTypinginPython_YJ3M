commit 3fe8f70b08b220f943efbe0171247259425430fb
Author: Andrew Grigorev <andrew@ei-grad.ru>
Date:   Mon Sep 19 19:32:51 2016 +0300

    Fix misleading SSL error message
    
    The `except` block with exception matching throught
    `if 'connection refused' in str(e).lower():` is funny,
    but is not user-friendly.
    
    Probably related issues:
    
    - #15679
    - #12161
    - #9966
    - #8221
    - #7218
    
    ... and more

diff --git a/lib/ansible/module_utils/urls.py b/lib/ansible/module_utils/urls.py
index 4320ba7b8b..b4e37a22a9 100644
--- a/lib/ansible/module_utils/urls.py
+++ b/lib/ansible/module_utils/urls.py
@@ -721,15 +721,11 @@ class SSLValidationHandler(urllib_request.BaseHandler):
             # close the ssl connection
             #ssl_s.unwrap()
             s.close()
-        except (ssl.SSLError, socket.error):
-            e = get_exception()
-            # fail if we tried all of the certs but none worked
-            if 'connection refused' in str(e).lower():
-                raise ConnectionError('Failed to connect to %s:%s.' % (self.hostname, self.port))
-            else:
-                build_ssl_validation_error(self.hostname, self.port, paths_checked)
-        except CertificateError:
+        except (ssl.SSLError, CertificateError):
             build_ssl_validation_error(self.hostname, self.port, paths_checked)
+        except socket.error:
+            e = get_exception()
+            raise ConnectionError('Failed to connect to %s at port %s: %s' % (self.hostname, self.port, str(e)))
 
         try:
             # cleanup the temp file created, don't worry
