commit 78de05e58dcd68518241b3a2087c64245734a530
Author: Dustin Spicuzza <dustin@virtualroadside.com>
Date:   Mon Mar 20 21:54:24 2017 +0000

    win_iis_webapppool: Use Get-AnsibleParam to retrieve parameter
    
    - Fixes #22805

diff --git a/lib/ansible/modules/windows/win_iis_webapppool.ps1 b/lib/ansible/modules/windows/win_iis_webapppool.ps1
index f68d69772d..b4f0cd4948 100644
--- a/lib/ansible/modules/windows/win_iis_webapppool.ps1
+++ b/lib/ansible/modules/windows/win_iis_webapppool.ps1
@@ -32,8 +32,9 @@ $state = Get-AnsibleParam -obj $params -name "state" -default "present" -validat
 # Attributes parameter - Pipe separated list of attributes where
 # keys and values are separated by comma (paramA:valyeA|paramB:valueB)
 $attributes = @{};
-If (Get-Member -InputObject $params -Name attributes) {
-  $params.attributes -split '\|' | foreach {
+$attrs = Get-AnsibleParam -obj $params -name "attributes" -type "string" -failifempty $false
+If ($attrs) {
+  $attrs -split '\|' | foreach {
     $key, $value = $_ -split "\:"
     $attributes.Add($key, $value)
   }
