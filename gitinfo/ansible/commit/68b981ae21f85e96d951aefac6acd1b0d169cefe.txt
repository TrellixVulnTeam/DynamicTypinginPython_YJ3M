commit 68b981ae21f85e96d951aefac6acd1b0d169cefe
Author: Dennis Israelsson <dennis.israelsson@gmail.com>
Date:   Wed Feb 5 23:29:59 2020 +0100

    update nmap inventory plugin to not depend on rdns (#56457)

diff --git a/lib/ansible/plugins/inventory/nmap.py b/lib/ansible/plugins/inventory/nmap.py
index d2c54fe84e..002c0aef43 100644
--- a/lib/ansible/plugins/inventory/nmap.py
+++ b/lib/ansible/plugins/inventory/nmap.py
@@ -65,7 +65,7 @@ from ansible.module_utils.common.process import get_bin_path
 class InventoryModule(BaseInventoryPlugin, Constructable, Cacheable):
 
     NAME = 'nmap'
-    find_host = re.compile(r'^Nmap scan report for ([\w,.,-]+) \(([\w,.,:,\[,\]]+)\)')
+    find_host = re.compile(r'^Nmap scan report for ([\w,.,-]+)(?: \(([\w,.,:,\[,\]]+)\))?')
     find_port = re.compile(r'^(\d+)/(\w+)\s+(\w+)\s+(\w+)')
 
     def __init__(self):
@@ -140,7 +140,11 @@ class InventoryModule(BaseInventoryPlugin, Constructable, Cacheable):
                     else:
                         host = hits.group(1)
 
-                    ip = hits.group(2)
+                    # if no reverse dns exists, just use ip instead as hostname
+                    if hits.group(2) is not None:
+                        ip = hits.group(2)
+                    else:
+                        ip = hits.group(1)
 
                     if host is not None:
                         # update inventory
