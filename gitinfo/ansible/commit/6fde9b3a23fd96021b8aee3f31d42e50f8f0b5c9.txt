commit 6fde9b3a23fd96021b8aee3f31d42e50f8f0b5c9
Author: Matt Clay <matt@mystile.com>
Date:   Thu Mar 19 09:37:37 2020 -0700

    Fix shebang sanity test module identification.

diff --git a/changelogs/fragments/ansible-test-shebang-sanity.yml b/changelogs/fragments/ansible-test-shebang-sanity.yml
new file mode 100644
index 0000000000..9159d72155
--- /dev/null
+++ b/changelogs/fragments/ansible-test-shebang-sanity.yml
@@ -0,0 +1,2 @@
+bugfixes:
+    - ansible-test - The shebang sanity test now correctly identifies modules in subdirectories in collections.
diff --git a/test/lib/ansible_test/_data/sanity/code-smell/shebang.py b/test/lib/ansible_test/_data/sanity/code-smell/shebang.py
index bbfeed532a..7cf3cf7200 100755
--- a/test/lib/ansible_test/_data/sanity/code-smell/shebang.py
+++ b/test/lib/ansible_test/_data/sanity/code-smell/shebang.py
@@ -88,7 +88,7 @@ def main():
                         'test/integration/targets/module_precedence/lib_with_extension',
                 ):
                     is_module = True
-            elif dirname == 'plugins/modules':
+            elif path.startswith('plugins/modules/'):
                 is_module = True
 
             if is_module:
