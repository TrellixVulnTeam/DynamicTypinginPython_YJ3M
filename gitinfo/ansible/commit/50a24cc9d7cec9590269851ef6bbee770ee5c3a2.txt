commit 50a24cc9d7cec9590269851ef6bbee770ee5c3a2
Author: Rene Moser <mail@renemoser.net>
Date:   Wed Jul 26 11:27:13 2017 +0200

    cloudstack: tests: add test facts in check mode

diff --git a/test/integration/targets/cs_instance_facts/tasks/main.yml b/test/integration/targets/cs_instance_facts/tasks/main.yml
index af35712aa5..c412ec70a7 100644
--- a/test/integration/targets/cs_instance_facts/tasks/main.yml
+++ b/test/integration/targets/cs_instance_facts/tasks/main.yml
@@ -38,6 +38,23 @@
     that:
     - instance|success
 
+- name: test instance facts in check mode
+  cs_instance_facts:
+    name: "{{ cs_resource_prefix }}-vm"
+  register: instance_facts
+  check_mode: true
+- name: verify test instance facts in check mode
+  assert:
+    that:
+    - instance_facts|success
+    - not instance_facts|changed
+    - cloudstack_instance.id == instance.id
+    - cloudstack_instance.domain == instance.domain
+    - cloudstack_instance.account == instance.account
+    - cloudstack_instance.zone == instance.zone
+    - cloudstack_instance.name == instance.name
+    - cloudstack_instance.service_offering == instance.service_offering
+
 - name: test instance facts
   cs_instance_facts:
     name: "{{ cs_resource_prefix }}-vm"
diff --git a/test/integration/targets/cs_zone_facts/tasks/main.yml b/test/integration/targets/cs_zone_facts/tasks/main.yml
index 09aea5f850..d11c231322 100644
--- a/test/integration/targets/cs_zone_facts/tasks/main.yml
+++ b/test/integration/targets/cs_zone_facts/tasks/main.yml
@@ -11,11 +11,32 @@
     that:
       - zone|success
 
+- name: get facts from zone in check mode
+  cs_zone_facts:
+    name: "{{ cs_resource_prefix }}-zone"
+  register: zone
+  check_mode: true
+- name: verify  get facts from zone in check mode
+  assert:
+    that:
+      - zone|success
+      - not zone|changed
+      - ansible_facts.cloudstack_zone.dns1 == "8.8.8.8"
+      - ansible_facts.cloudstack_zone.dns2 == "8.8.4.4"
+      - ansible_facts.cloudstack_zone.internal_dns1 == "8.8.8.8"
+      - ansible_facts.cloudstack_zone.internal_dns2 == "8.8.4.4"
+      - ansible_facts.cloudstack_zone.local_storage_enabled == false
+      - ansible_facts.cloudstack_zone.network_type == "Basic"
+      - ansible_facts.cloudstack_zone.zone_token != ""
+      - ansible_facts.cloudstack_zone.securitygroups_enabled == true
+      - ansible_facts.cloudstack_zone.dhcp_provider == "VirtualRouter"
+      - ansible_facts.cloudstack_zone.local_storage_enabled == false
+
 - name: get facts from zone
   cs_zone_facts:
     name: "{{ cs_resource_prefix }}-zone"
   register: zone
-- name: verify setup zone is present
+- name: verify get facts from zone
   assert:
     that:
       - zone|success
