commit 0a85e64b4a95dbbd11e0ee605adc509a0234800e
Author: Peter Sprygada <privateip@users.noreply.github.com>
Date:   Tue Sep 27 22:17:32 2016 -0400

    fixes exception raised due to KeyError (#5068)
    
    The vyos_config module would error when looking for a key called `updates`
    in module.params.  There is no such key.  This fixes the problem.

diff --git a/lib/ansible/modules/network/vyos/vyos_config.py b/lib/ansible/modules/network/vyos/vyos_config.py
index 706f64911f..7ee3a272bd 100644
--- a/lib/ansible/modules/network/vyos/vyos_config.py
+++ b/lib/ansible/modules/network/vyos/vyos_config.py
@@ -244,12 +244,11 @@ def run(module, result):
 
     result['updates'] = updates
 
-    if module.params['update'] != 'check':
-        load_config(module, updates, result)
+    load_config(module, updates, result)
 
-        if result.get('filtered'):
-            result['warnings'].append('Some configuration commands where '
-                                      'removed, please see the filtered key')
+    if result.get('filtered'):
+        result['warnings'].append('Some configuration commands where '
+                                  'removed, please see the filtered key')
 
 
 def main():
