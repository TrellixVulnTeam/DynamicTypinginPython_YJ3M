commit 29cd7e3fc132cc83e68ee47b19597c58a301ab0c
Author: Matt Martz <matt@sivel.net>
Date:   Mon Jan 19 13:06:35 2015 -0600

    Add tests for rax_identity

diff --git a/test/integration/rackspace.yml b/test/integration/rackspace.yml
index e00f14171d..cdf0da92e0 100644
--- a/test/integration/rackspace.yml
+++ b/test/integration/rackspace.yml
@@ -31,3 +31,6 @@
 
     - role: test_rax_cbs_attachments
       tags: test_rax_cbs_attachments
+
+    - role: test_rax_identity
+      tags: test_rax_identity
diff --git a/test/integration/roles/test_rax_identity/meta/main.yml b/test/integration/roles/test_rax_identity/meta/main.yml
new file mode 100644
index 0000000000..a3f85b642e
--- /dev/null
+++ b/test/integration/roles/test_rax_identity/meta/main.yml
@@ -0,0 +1,3 @@
+dependencies:
+  - prepare_tests
+  - prepare_rax_tests
diff --git a/test/integration/roles/test_rax_identity/tasks/main.yml b/test/integration/roles/test_rax_identity/tasks/main.yml
new file mode 100644
index 0000000000..d5b12eb350
--- /dev/null
+++ b/test/integration/roles/test_rax_identity/tasks/main.yml
@@ -0,0 +1,51 @@
+# ============================================================
+- name: Test rax_identity with no args
+  rax_identity:
+  ignore_errors: true
+  register: rax_identity
+
+- name: Validate results of rax_identity with no args
+  assert:
+    that:
+      - rax_identity|failed
+      - rax_identity.msg == 'No credentials supplied!'
+# ============================================================
+
+
+
+# ============================================================
+- name: Test rax_identity with name and credentials
+  rax_identity:
+    username: "{{ rackspace_username }}"
+    api_key: "{{ rackspace_api_key }}"
+  ignore_errors: true
+  register: rax_identity
+
+- name: Validate results of rax_identity with name and credentials
+  assert:
+    that:
+      - rax_identity|failed
+      - rax_identity.msg.startswith('None is not a valid region')
+# ============================================================
+
+
+
+# ============================================================
+- name: Test rax_identity with name and credentials and region
+  rax_identity:
+    username: "{{ rackspace_username }}"
+    api_key: "{{ rackspace_api_key }}"
+    region: "{{ rackspace_region }}"
+  register: rax_identity
+
+- name: Validate results of rax_identity with name and credentials
+  assert:
+    that:
+      - rax_identity|success
+      - not rax_identity|changed
+      - rax_identity.identity.region == "{{ rackspace_region }}"
+      - rax_identity.identity.username == "{{ rackspace_username }}"
+      - rax_identity.identity.authenticated
+      - rax_identity.identity.services
+      - rax_identity.identity.auth_token
+# ============================================================
