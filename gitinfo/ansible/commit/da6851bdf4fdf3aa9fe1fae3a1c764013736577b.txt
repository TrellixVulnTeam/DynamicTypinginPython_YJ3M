commit da6851bdf4fdf3aa9fe1fae3a1c764013736577b
Author: Michael Scherer <misc@zarb.org>
Date:   Sat Oct 15 16:13:10 2016 +0200

    Make expect module compile on python 3

diff --git a/lib/ansible/modules/extras/commands/expect.py b/lib/ansible/modules/extras/commands/expect.py
index 355f2cff48..c6f70e750e 100644
--- a/lib/ansible/modules/extras/commands/expect.py
+++ b/lib/ansible/modules/extras/commands/expect.py
@@ -195,7 +195,8 @@ def main():
             # Use pexpect.runu in pexpect>=3.3,<4
             out, rc = pexpect.runu(args, timeout=timeout, withexitstatus=True,
                                    events=events, cwd=chdir, echo=echo)
-    except (TypeError, AttributeError), e:
+    except (TypeError, AttributeError):
+        e = get_exception()
         # This should catch all insufficient versions of pexpect
         # We deem them insufficient for their lack of ability to specify
         # to not echo responses via the run/runu functions, which would
@@ -203,7 +204,8 @@ def main():
         module.fail_json(msg='Insufficient version of pexpect installed '
                              '(%s), this module requires pexpect>=3.3. '
                              'Error was %s' % (pexpect.__version__, e))
-    except pexpect.ExceptionPexpect, e:
+    except pexpect.ExceptionPexpect:
+        e = get_exception()
         module.fail_json(msg='%s' % e)
 
     endd = datetime.datetime.now()
@@ -230,5 +232,6 @@ def main():
 
 # import module snippets
 from ansible.module_utils.basic import *
+from ansible.module_utils.pycompat24 import get_exception
 
 main()
diff --git a/lib/ansible/modules/extras/test/utils/shippable/sanity-skip-python3.txt b/lib/ansible/modules/extras/test/utils/shippable/sanity-skip-python3.txt
index 5e73527740..c255551af9 100644
--- a/lib/ansible/modules/extras/test/utils/shippable/sanity-skip-python3.txt
+++ b/lib/ansible/modules/extras/test/utils/shippable/sanity-skip-python3.txt
@@ -46,7 +46,6 @@
 /clustering/consul_acl.py
 /clustering/consul_kv.py
 /clustering/consul_session.py
-/commands/expect.py
 /database/misc/mongodb_parameter.py
 /database/misc/mongodb_user.py
 /database/misc/redis.py
