commit 5780f3a8b4a868379fc0167d8e4d897644165d85
Author: Veeti Paananen <veeti.paananen@rojekti.fi>
Date:   Tue Jul 29 15:20:30 2014 +0300

    Expand variables in configuration files, take two
    
    e.g. $HOME.

diff --git a/lib/ansible/constants.py b/lib/ansible/constants.py
index 0bd88905a5..4d50f0dbe7 100644
--- a/lib/ansible/constants.py
+++ b/lib/ansible/constants.py
@@ -79,7 +79,7 @@ def shell_expand_path(path):
     ''' shell_expand_path is needed as os.path.expanduser does not work
         when path is None, which is the default for ANSIBLE_PRIVATE_KEY_FILE '''
     if path:
-        path = os.path.expanduser(path)
+        path = os.path.expanduser(os.path.expandvars(path))
     return path
 
 p = load_config_file()
