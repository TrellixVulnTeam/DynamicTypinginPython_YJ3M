commit 78040495921966180fd79145dd6182a6d891fdf2
Author: Brian Coca <bcoca@users.noreply.github.com>
Date:   Wed Sep 6 20:16:58 2017 -0400

    fix check mode for solaris enable/disable (#29049)

diff --git a/lib/ansible/modules/system/service.py b/lib/ansible/modules/system/service.py
index 5cd3bb9c67..e0ac781616 100644
--- a/lib/ansible/modules/system/service.py
+++ b/lib/ansible/modules/system/service.py
@@ -1388,20 +1388,21 @@ class SunOSService(Service):
         elif (not self.enable) and (not startup_enabled):
             return
 
-        # Mark service as started or stopped (this will have the side effect of
-        # actually stopping or starting the service)
-        if self.enable:
-            subcmd = "enable -rs"
-        else:
-            subcmd = "disable -s"
+        if not self.module.check_mode:
+            # Mark service as started or stopped (this will have the side effect of
+            # actually stopping or starting the service)
+            if self.enable:
+                subcmd = "enable -rs"
+            else:
+                subcmd = "disable -s"
 
-        rc, stdout, stderr = self.execute_command("%s %s %s" % (self.svcadm_cmd, subcmd, self.name))
+            rc, stdout, stderr = self.execute_command("%s %s %s" % (self.svcadm_cmd, subcmd, self.name))
 
-        if rc != 0:
-            if stderr:
-                self.module.fail_json(msg=stderr)
-            else:
-                self.module.fail_json(msg=stdout)
+            if rc != 0:
+                if stderr:
+                    self.module.fail_json(msg=stderr)
+                else:
+                    self.module.fail_json(msg=stdout)
 
         self.changed = True
 
