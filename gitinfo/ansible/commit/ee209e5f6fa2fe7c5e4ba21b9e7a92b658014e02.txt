commit ee209e5f6fa2fe7c5e4ba21b9e7a92b658014e02
Author: Sloane Hertel <shertel@redhat.com>
Date:   Thu Feb 1 14:08:59 2018 -0500

    Fix idempotence for deleting ElasticBeanstalk applications (#35614)

diff --git a/lib/ansible/modules/cloud/amazon/aws_elasticbeanstalk_app.py b/lib/ansible/modules/cloud/amazon/aws_elasticbeanstalk_app.py
index ad581369a0..1318199348 100644
--- a/lib/ansible/modules/cloud/amazon/aws_elasticbeanstalk_app.py
+++ b/lib/ansible/modules/cloud/amazon/aws_elasticbeanstalk_app.py
@@ -209,10 +209,16 @@ def main():
                     ebs.delete_application(ApplicationName=app_name, TerminateEnvByForce=terminate_by_force)
                 else:
                     ebs.delete_application(ApplicationName=app_name)
-            except (BotoCoreError, ClientError) as e:
+                changed = True
+            except BotoCoreError as e:
                 module.fail_json_aws(e, msg="Cannot terminate app")
+            except ClientError as e:
+                if 'It is currently pending deletion.' not in e.response['Error']['Message']:
+                    module.fail_json_aws(e, msg="Cannot terminate app")
+                else:
+                    changed = False
 
-            result = dict(changed=True, app=app)
+            result = dict(changed=changed, app=app)
 
     module.exit_json(**result)
 
