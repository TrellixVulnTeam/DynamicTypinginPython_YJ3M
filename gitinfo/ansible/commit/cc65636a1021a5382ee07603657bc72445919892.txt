commit cc65636a1021a5382ee07603657bc72445919892
Author: Matt Clay <matt@mystile.com>
Date:   Wed Jan 24 06:12:30 2018 -0800

    Add PSScriptAnalyzer to default container.

diff --git a/test/runner/Dockerfile b/test/runner/Dockerfile
index 94a7082c83..4450374756 100644
--- a/test/runner/Dockerfile
+++ b/test/runner/Dockerfile
@@ -49,5 +49,23 @@ RUN ln -s python2.7 /usr/bin/python2
 RUN ln -s python3.6 /usr/bin/python3
 RUN ln -s python3   /usr/bin/python
 
+RUN apt-get update -y && \
+    DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \
+    apt-transport-https \
+    && \
+    apt-get clean
+ADD https://packages.microsoft.com/config/ubuntu/16.04/prod.list /etc/apt/sources.list.d/microsoft.list
+RUN curl --silent https://packages.microsoft.com/keys/microsoft.asc | apt-key add -
+RUN apt-get update -y && \
+    DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \
+    dotnet-sdk-2.1.4 \
+    powershell \
+    && \
+    apt-get clean
+RUN dotnet --version
+RUN pwsh --version
+COPY requirements/sanity.ps1 /tmp/
+RUN /tmp/sanity.ps1
+
 ENV container=docker
 CMD ["/sbin/init"]
diff --git a/test/runner/requirements/sanity.ps1 b/test/runner/requirements/sanity.ps1
new file mode 100755
index 0000000000..ecaffc5253
--- /dev/null
+++ b/test/runner/requirements/sanity.ps1
@@ -0,0 +1,8 @@
+#!/usr/bin/env pwsh
+#Requires -Version 6
+
+Set-StrictMode -Version 2.0
+$ErrorActionPreference = "Stop"
+
+Set-PSRepository -Name PSGallery -InstallationPolicy Trusted
+Install-Module -Name PSScriptAnalyzer
diff --git a/test/sanity/code-smell/shebang.sh b/test/sanity/code-smell/shebang.sh
index 76d72c1ff9..6477a95861 100755
--- a/test/sanity/code-smell/shebang.sh
+++ b/test/sanity/code-smell/shebang.sh
@@ -15,6 +15,7 @@ grep '^#!' -rIn . \
     -e ':#!/usr/bin/env python$' \
     -e ':#!/usr/bin/env bash$' \
     -e ':#!/usr/bin/env fish$' \
+    -e ':#!/usr/bin/env pwsh$' \
 
 if [ $? -ne 1 ]; then
     echo "One or more file(s) listed above have an unexpected shebang."
