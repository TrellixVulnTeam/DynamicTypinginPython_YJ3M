commit 5aa56245d53ba9a2aef08bd0da8fe9e9f3193718
Author: Michael Scherer <misc@zarb.org>
Date:   Wed Apr 15 00:58:11 2015 -0400

    Fix variable name
    
    There is no 'role' variable, and given the test and code after, that's
    likely a test on 'ds'

diff --git a/v2/ansible/playbook/role/requirement.py b/v2/ansible/playbook/role/requirement.py
index 61db0cb1fd..03ffc3d710 100644
--- a/v2/ansible/playbook/role/requirement.py
+++ b/v2/ansible/playbook/role/requirement.py
@@ -92,7 +92,7 @@ class RoleRequirement(RoleDefinition):
                 ds["scm"] = scm
                 ds["src"] = src
 
-            if 'name' in role:
+            if 'name' in ds:
                 ds["role"] = ds["name"]
                 del ds["name"]
             else:
