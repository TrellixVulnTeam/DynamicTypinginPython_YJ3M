commit 76feba00c4724e930c8c6fc7eba7e4a29c86cc3c
Author: Brian Coca <bcoca@ansible.com>
Date:   Thu Oct 8 10:14:33 2015 -0400

    avoid callbacks during syntax check and listing
    fixes #12682

diff --git a/lib/ansible/executor/playbook_executor.py b/lib/ansible/executor/playbook_executor.py
index 81c36d88ae..7aadd9b5e2 100644
--- a/lib/ansible/executor/playbook_executor.py
+++ b/lib/ansible/executor/playbook_executor.py
@@ -101,7 +101,8 @@ class PlaybookExecutor:
                             salt      = var.get("salt", None)
 
                             if vname not in play.vars:
-                                self._tqm.send_callback('v2_playbook_on_vars_prompt', vname, private, prompt, encrypt, confirm, salt_size, salt, default)
+                                if self._tqm:
+                                    self._tqm.send_callback('v2_playbook_on_vars_prompt', vname, private, prompt, encrypt, confirm, salt_size, salt, default)
                                 play.vars[vname] = self._do_var_prompt(vname, private, prompt, encrypt, confirm, salt_size, salt, default)
 
                     # Create a temporary copy of the play here, so we can run post_validate
