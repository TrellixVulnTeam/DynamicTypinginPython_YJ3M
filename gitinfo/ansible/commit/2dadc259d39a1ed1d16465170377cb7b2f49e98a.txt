commit 2dadc259d39a1ed1d16465170377cb7b2f49e98a
Author: Matt Clay <mclay@redhat.com>
Date:   Sun Feb 23 21:17:03 2020 -0800

    Split hcloud tests into two CI groups. (#67683)
    
    * Split hcloud tests into two CI groups.
    
    This will hopefully resolve CI failures when running with code coverage.
    
    * Fix smoketest logic.

diff --git a/shippable.yml b/shippable.yml
index c2eba9ec60..fa9ad708f2 100644
--- a/shippable.yml
+++ b/shippable.yml
@@ -213,6 +213,9 @@ matrix:
 
     - env: T=hcloud/2.7/1
     - env: T=hcloud/3.6/1
+
+    - env: T=hcloud/2.7/2
+    - env: T=hcloud/3.6/2
 branches:
   except:
     - "*-patch-*"
diff --git a/test/integration/targets/hcloud_datacenter_info/aliases b/test/integration/targets/hcloud_datacenter_info/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_datacenter_info/aliases
+++ b/test/integration/targets/hcloud_datacenter_info/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_floating_ip/aliases b/test/integration/targets/hcloud_floating_ip/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_floating_ip/aliases
+++ b/test/integration/targets/hcloud_floating_ip/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_floating_ip_info/aliases b/test/integration/targets/hcloud_floating_ip_info/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_floating_ip_info/aliases
+++ b/test/integration/targets/hcloud_floating_ip_info/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_image_info/aliases b/test/integration/targets/hcloud_image_info/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_image_info/aliases
+++ b/test/integration/targets/hcloud_image_info/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_location_info/aliases b/test/integration/targets/hcloud_location_info/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_location_info/aliases
+++ b/test/integration/targets/hcloud_location_info/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_server_info/aliases b/test/integration/targets/hcloud_server_info/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_server_info/aliases
+++ b/test/integration/targets/hcloud_server_info/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_server_network/aliases b/test/integration/targets/hcloud_server_network/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_server_network/aliases
+++ b/test/integration/targets/hcloud_server_network/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_server_type_info/aliases b/test/integration/targets/hcloud_server_type_info/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_server_type_info/aliases
+++ b/test/integration/targets/hcloud_server_type_info/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_ssh_key/aliases b/test/integration/targets/hcloud_ssh_key/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_ssh_key/aliases
+++ b/test/integration/targets/hcloud_ssh_key/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_ssh_key_info/aliases b/test/integration/targets/hcloud_ssh_key_info/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_ssh_key_info/aliases
+++ b/test/integration/targets/hcloud_ssh_key_info/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_subnetwork/aliases b/test/integration/targets/hcloud_subnetwork/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_subnetwork/aliases
+++ b/test/integration/targets/hcloud_subnetwork/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_volume/aliases b/test/integration/targets/hcloud_volume/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_volume/aliases
+++ b/test/integration/targets/hcloud_volume/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/integration/targets/hcloud_volume_info/aliases b/test/integration/targets/hcloud_volume_info/aliases
index 18dc30b6c3..55ec821a47 100644
--- a/test/integration/targets/hcloud_volume_info/aliases
+++ b/test/integration/targets/hcloud_volume_info/aliases
@@ -1,2 +1,2 @@
 cloud/hcloud
-shippable/hcloud/group1
+shippable/hcloud/group2
diff --git a/test/utils/shippable/cloud.sh b/test/utils/shippable/cloud.sh
index 8c613a9b3a..da037e09e1 100755
--- a/test/utils/shippable/cloud.sh
+++ b/test/utils/shippable/cloud.sh
@@ -15,14 +15,14 @@ stage="${S:-prod}"
 
 changed_all_target="shippable/${cloud}/smoketest/"
 
+if ! ansible-test integration "${changed_all_target}" --list-targets > /dev/null 2>&1; then
+    # no smoketest tests are available for this cloud
+    changed_all_target="none"
+fi
+
 if [ "${group}" == "1" ]; then
     # only run smoketest tests for group1
     changed_all_mode="include"
-
-    if ! ansible-test integration "${changed_all_target}" --list-targets > /dev/null 2>&1; then
-        # no smoketest tests are available for this cloud
-        changed_all_target="none"
-    fi
 else
     # smoketest tests already covered by group1
     changed_all_mode="exclude"
