commit 71ef69d51f78f68670bc0d0f357afbcb7b0c0631
Author: Tad Merchant <system.root@gmail.com>
Date:   Mon Jan 28 22:28:39 2019 -0500

    check elb type in compare_subnets for elbv2 (#50203)
    
    * Add check for elb type to fix difference between NLB and ALB AZ return structure
    
    Fixes #49558
    
    * Fix spacing for pep8 (hopefully) compliancE
    
    * use empty array default instead of loadbalancer type detection
    
    hat tip briantist
    
    * spacing is probably important.

diff --git a/lib/ansible/module_utils/aws/elbv2.py b/lib/ansible/module_utils/aws/elbv2.py
index f7e7ecaf5e..47d0e87a51 100644
--- a/lib/ansible/module_utils/aws/elbv2.py
+++ b/lib/ansible/module_utils/aws/elbv2.py
@@ -169,7 +169,7 @@ class ElasticLoadBalancerV2(object):
         # on the load balancer
         for subnet in self.elb['AvailabilityZones']:
             this_mapping = {'SubnetId': subnet['SubnetId']}
-            for address in subnet['LoadBalancerAddresses']:
+            for address in subnet.get('LoadBalancerAddresses', []):
                 if 'AllocationId' in address:
                     this_mapping['AllocationId'] = address['AllocationId']
                     break
