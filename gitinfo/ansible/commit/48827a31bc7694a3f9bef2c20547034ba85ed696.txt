commit 48827a31bc7694a3f9bef2c20547034ba85ed696
Author: Brian Coca <bcoca@ansible.com>
Date:   Tue Jul 7 20:11:42 2015 -0400

    added minimal testing for special template vars

diff --git a/test/integration/non_destructive.yml b/test/integration/non_destructive.yml
index 0c4c5be496..1ce0724d7d 100644
--- a/test/integration/non_destructive.yml
+++ b/test/integration/non_destructive.yml
@@ -14,6 +14,7 @@
     - { role: test_copy, tags: test_copy }
     - { role: test_stat, tags: test_stat }
     - { role: test_template, tags: test_template }
+    - { role: test_special_vars, tags: test_special_vars }
     - { role: test_file, tags: test_file }
     - { role: test_fetch, tags: test_fetch }
     - { role: test_synchronize, tags: test_synchronize }
diff --git a/test/integration/roles/test_special_vars/meta/main.yml b/test/integration/roles/test_special_vars/meta/main.yml
new file mode 100644
index 0000000000..a8b63dfdf2
--- /dev/null
+++ b/test/integration/roles/test_special_vars/meta/main.yml
@@ -0,0 +1,3 @@
+dependencies:
+  - prepare_tests
+
diff --git a/test/integration/roles/test_special_vars/tasks/main.yml b/test/integration/roles/test_special_vars/tasks/main.yml
new file mode 100644
index 0000000000..653bf7b905
--- /dev/null
+++ b/test/integration/roles/test_special_vars/tasks/main.yml
@@ -0,0 +1,37 @@
+# test code for the template module
+# (c) 2015, Brian Coca <bcoca@ansible.com>
+
+# This file is part of Ansible
+#
+# Ansible is free software: you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation, either version 3 of the License, or
+# (at your option) any later version.
+#
+# Ansible is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with Ansible.  If not, see <http://www.gnu.org/licenses/>.
+
+- name: veryfiy ansible_managed
+  template: src=foo.j2 dest={{output_dir}}/special_vars.yaml
+
+- name: read the file into facts
+  include_vars: "{{output_dir}}/special_vars.yaml"
+
+
+- name: veriy all test vars are defined
+  assert:
+    that:
+        - 'item in hostvars[inventory_hostname].keys()'
+  with_items:
+    - test_template_host
+    - test_template_path
+    - test_template_mtime
+    - test_template_uid
+    - test_template_fullpath
+    - test_template_run_date
+    - test_ansible_managed
diff --git a/test/integration/roles/test_special_vars/templates/foo.j2 b/test/integration/roles/test_special_vars/templates/foo.j2
new file mode 100644
index 0000000000..0f6db2a166
--- /dev/null
+++ b/test/integration/roles/test_special_vars/templates/foo.j2
@@ -0,0 +1,7 @@
+test_template_host: "{{template_host}}"
+test_template_path: "{{template_path}}"
+test_template_mtime: "{{template_mtime}}"
+test_template_uid: "{{template_uid}}"
+test_template_fullpath: "{{template_fullpath}}"
+test_template_run_date: "{{template_run_date}}"
+test_ansible_managed: "{{ansible_managed}}"
diff --git a/test/integration/roles/test_special_vars/vars/main.yml b/test/integration/roles/test_special_vars/vars/main.yml
new file mode 100644
index 0000000000..e69de29bb2
