commit 000f8dcc8f98f9028aced098c34380c279b04868
Author: 10sr <8slashes+git@gmail.com>
Date:   Fri Aug 4 23:42:38 2017 +0900

    Fix bug that diff.always = yes in ansible.cfg won't be respected (#27746)

diff --git a/lib/ansible/cli/__init__.py b/lib/ansible/cli/__init__.py
index f656599027..2844b4d8ff 100644
--- a/lib/ansible/cli/__init__.py
+++ b/lib/ansible/cli/__init__.py
@@ -488,7 +488,7 @@ class CLI(with_metaclass(ABCMeta, object)):
                               help="don't make any changes; instead, try to predict some of the changes that may occur")
             parser.add_option('--syntax-check', dest='syntax', action='store_true',
                               help="perform a syntax check on the playbook, but do not execute it")
-            parser.add_option("-D", "--diff", default=False, dest='diff', action='store_true',
+            parser.add_option("-D", "--diff", default=C.DIFF_ALWAYS, dest='diff', action='store_true',
                               help="when changing (small) files and templates, show the differences in those files; works great with --check")
 
         if meta_opts:
