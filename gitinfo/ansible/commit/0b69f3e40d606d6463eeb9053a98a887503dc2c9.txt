commit 0b69f3e40d606d6463eeb9053a98a887503dc2c9
Author: Jordan Borean <jborean93@gmail.com>
Date:   Mon Aug 7 14:23:01 2017 +1000

    win_stat: removed file in use test as it is too tempormental (#27832)

diff --git a/test/integration/targets/win_stat/tasks/main.yml b/test/integration/targets/win_stat/tasks/main.yml
index 30cdbf9b15..bd1e3d53a9 100644
--- a/test/integration/targets/win_stat/tasks/main.yml
+++ b/test/integration/targets/win_stat/tasks/main.yml
@@ -537,29 +537,7 @@
       - win_stat_no_args.msg
       - not win_stat_no_args|changed
 
-- name: ensure file that will be in use is deleted before test
-  win_file:
-    path: '{{win_stat_dir}}\in_use'
-    state: absent
-
-- name: lock file in the background for next task
-  win_command: powershell.exe "$data = 'abcdefghijklmnopqrstuvwxyz' * 1024; $file = [System.IO.File]::Open('{{win_stat_dir}}\in_use', 'OpenOrCreate', 'ReadWrite', 'None'); $writer = New-Object IO.StreamWriter($file); $start = Get-Date; while (((Get-Date) - $start).TotalSeconds -lt 15) { $writer.WriteLine($data) }; $writer.Close(); $file.Close()"
-  async: 20
-  poll: 0
-  register: a
-
-- name: fail to get stat of file in use
-  win_stat:
-    path: '{{win_stat_dir}}\in_use'
-    get_md5: False
-  register: fail_file_in_use
-  failed_when: "'failed to get hash of file' not in fail_file_in_use.msg"
-
 - name: remove testing folder
   win_file:
     path: "{{win_output_dir}}\\win_stat"
     state: absent
-  register: cleanup
-  retries: 3 # in case async task is still running, try 3 times
-  delay: 5
-  until: not cleanup|failed
