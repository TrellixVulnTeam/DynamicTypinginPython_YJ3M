commit e7957b6d588745fe9b64feefb652795a601875c7
Author: Stoned Elipot <stoned.elipot@gmail.com>
Date:   Sat Sep 28 22:02:43 2013 +0200

    Fix group_by: do not group a host for which a condition is false

diff --git a/lib/ansible/runner/action_plugins/group_by.py b/lib/ansible/runner/action_plugins/group_by.py
index 477f46fe84..2385df3863 100644
--- a/lib/ansible/runner/action_plugins/group_by.py
+++ b/lib/ansible/runner/action_plugins/group_by.py
@@ -61,9 +61,13 @@ class ActionModule(object):
             conds = self.runner.conditional
             if type(conds) != list:
                 conds = [ conds ]
+            next_host = False
             for cond in conds:
                 if not check_conditional(cond, self.runner.basedir, data, fail_on_undefined=self.runner.error_on_undefined_vars):
-                    continue
+                    next_host = True
+                    break
+            if next_host:
+                continue
             group_name = template.template(self.runner.basedir, args['key'], data)
             group_name = group_name.replace(' ','-')
             if group_name not in groups:
