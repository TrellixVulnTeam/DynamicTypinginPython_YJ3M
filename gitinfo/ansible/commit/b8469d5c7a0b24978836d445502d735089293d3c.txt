commit b8469d5c7a0b24978836d445502d735089293d3c
Author: Sam Doran <sdoran@redhat.com>
Date:   Fri May 15 15:52:17 2020 -0400

    lineinfile - Use ANSIBLE_REMOTE_TMP for temporary file (#69543)

diff --git a/changelogs/fragments/lineinfile-use-module-tempdir.yaml b/changelogs/fragments/lineinfile-use-module-tempdir.yaml
new file mode 100644
index 0000000000..b209820bc1
--- /dev/null
+++ b/changelogs/fragments/lineinfile-use-module-tempdir.yaml
@@ -0,0 +1,2 @@
+bugfixes:
+  - lineinfile - use ``module.tmpdir`` to allow configuration of the remote temp directory (https://github.com/ansible/ansible/issues/68218)
diff --git a/lib/ansible/modules/lineinfile.py b/lib/ansible/modules/lineinfile.py
index d3094bede3..2ffa8d74f1 100644
--- a/lib/ansible/modules/lineinfile.py
+++ b/lib/ansible/modules/lineinfile.py
@@ -213,7 +213,7 @@ from ansible.module_utils._text import to_bytes, to_native
 
 def write_changes(module, b_lines, dest):
 
-    tmpfd, tmpfile = tempfile.mkstemp()
+    tmpfd, tmpfile = tempfile.mkstemp(dir=module.tmpdir)
     with os.fdopen(tmpfd, 'wb') as f:
         f.writelines(b_lines)
 
