commit 13a8dbfd5c36a48e0b74404edeee74e699d3ef53
Author: Mark Challoner <mark.a.r.challoner@gmail.com>
Date:   Mon Nov 18 04:51:58 2019 +0000

    Fix Grafana lookup auth header for py2/3 compatibility (#50816)

diff --git a/lib/ansible/plugins/lookup/grafana_dashboard.py b/lib/ansible/plugins/lookup/grafana_dashboard.py
index 4c44470d67..886bc8f0a0 100644
--- a/lib/ansible/plugins/lookup/grafana_dashboard.py
+++ b/lib/ansible/plugins/lookup/grafana_dashboard.py
@@ -64,7 +64,7 @@ import json
 import os
 from ansible.errors import AnsibleError, AnsibleParserError
 from ansible.plugins.lookup import LookupBase
-from ansible.module_utils.urls import open_url
+from ansible.module_utils.urls import basic_auth_header, open_url
 from ansible.module_utils._text import to_bytes, to_native
 from ansible.module_utils.six.moves.urllib.error import HTTPError
 from ansible.utils.display import Display
@@ -124,8 +124,7 @@ class GrafanaAPI:
         if self.grafana_api_key:
             headers['Authorization'] = "Bearer %s==" % self.grafana_api_key
         else:
-            auth = base64.b64encode(to_bytes('%s:%s' % (self.grafana_user, self.grafana_password)).replace('\n', ''))
-            headers['Authorization'] = 'Basic %s' % auth
+            headers['Authorization'] = basic_auth_header(self.grafana_user, self.grafana_password)
             self.grafana_switch_organisation(headers)
 
         return headers
