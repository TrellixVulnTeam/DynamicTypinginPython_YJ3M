commit eed031cd827b5508809865481db8560ac3f56fab
Author: Michael DeHaan <michael.dehaan@gmail.com>
Date:   Tue Sep 4 21:22:47 2012 -0400

    Check for ipv6

diff --git a/library/setup b/library/setup
index 89231a1b22..8cb4e49eaf 100755
--- a/library/setup
+++ b/library/setup
@@ -461,6 +461,8 @@ class LinuxNetwork(Network):
         )
         interface = dict(v4 = {}, v6 = {})
         for v in 'v4', 'v6':
+            if v == 'v6' and not socket.has_ipv6:
+                continue
             output = subprocess.Popen(command[v], stdout=subprocess.PIPE, stderr=subprocess.PIPE).communicate()[0]
             if not output:
                 # v6 routing may result in 
