commit a2aa30f4e5fd67a02aa794abb012d221b192efb0
Author: Ingo Gottwald <i.gottwald@tomorrow-focus.de>
Date:   Fri Aug 3 12:34:55 2012 +0200

    Added login_unix_socket option to mysql_db module

diff --git a/library/mysql_db b/library/mysql_db
index 1818b8e95a..6752d9f7ba 100755
--- a/library/mysql_db
+++ b/library/mysql_db
@@ -71,6 +71,7 @@ def main():
             login_user=dict(default=None),
             login_password=dict(default=None),
             login_host=dict(default="localhost"),
+            login_unix_socket=dict(default=None),
             db=dict(required=True, aliases=['name']),
             encoding=dict(default=""),
             collation=dict(default=""),
@@ -103,7 +104,10 @@ def main():
         module.fail_json(msg="when supplying login arguments, both login_user and login_password must be provided")
 
     try:
-        db_connection = MySQLdb.connect(host=module.params["login_host"], user=login_user, passwd=login_password, db="mysql")
+        if module.params["login_unix_socket"] != None:
+            db_connection = MySQLdb.connect(host=module.params["login_host"], unix_socket=module.params["login_unix_socket"], user=login_user, passwd=login_password, db="mysql")
+        else:
+            db_connection = MySQLdb.connect(host=module.params["login_host"], user=login_user, passwd=login_password, db="mysql")
         cursor = db_connection.cursor()
     except Exception as e:
         module.fail_json(msg="unable to connect, check login_user and login_password are correct, or alternatively check ~/.my.cnf contains credentials")
