commit 347b5d1e50d6e85837695d7637388ed8de889674
Author: Michael Scherer <misc@zarb.org>
Date:   Sun Jan 21 12:26:32 2018 +0100

    write need bytes object on python 3 (#35143)
    
    Otherwise, it fail with:
    
        Traceback (most recent call last):
          File \"/tmp/ansible_c1zmq3i9/ansible_module_openssl_certificate.py\", line 808, in <module>
            main()
          File \"/tmp/ansible_c1zmq3i9/ansible_module_openssl_certificate.py\", line 787, in main
            certificate.generate(module)
          File \"/tmp/ansible_c1zmq3i9/ansible_module_openssl_certificate.py\", line 692, in generate
            certfile.write(str(crt))
        TypeError: a bytes-like object is required, not 'str'

diff --git a/lib/ansible/modules/crypto/openssl_certificate.py b/lib/ansible/modules/crypto/openssl_certificate.py
index 676415fff6..1afc490d70 100644
--- a/lib/ansible/modules/crypto/openssl_certificate.py
+++ b/lib/ansible/modules/crypto/openssl_certificate.py
@@ -757,7 +757,7 @@ class AcmeCertificate(Certificate):
                                                             self.challenge_path),
                                          check_rc=True)[1]
                 with open(self.path, 'wb') as certfile:
-                    certfile.write(str(crt))
+                    certfile.write(to_bytes(crt))
             except OSError as exc:
                 raise CertificateError(exc)
 
