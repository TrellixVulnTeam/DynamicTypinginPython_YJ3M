commit 1c1c89927daa1c6331e0980a6228eedd812d6451
Author: James Tanner <tanner.jc@gmail.com>
Date:   Sat Sep 30 13:49:34 2017 -0400

    Get the moid in a more failsafe manner

diff --git a/lib/ansible/module_utils/vmware.py b/lib/ansible/module_utils/vmware.py
index 102f1e6b60..85f6de2f3b 100644
--- a/lib/ansible/module_utils/vmware.py
+++ b/lib/ansible/module_utils/vmware.py
@@ -235,7 +235,11 @@ def compile_folder_path_for_object(vobj):
     thisobj = vobj
     while hasattr(thisobj, 'parent'):
         thisobj = thisobj.parent
-        if thisobj._moId == 'group-d1':
+        try:
+            moid = thisobj._moId
+        except AttributeError:
+            moid = None
+        if moid == 'group-d1':
             break
         if isinstance(thisobj, vim.Folder):
             paths.append(thisobj.name)
