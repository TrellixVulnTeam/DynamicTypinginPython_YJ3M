commit 0aa76503dc706340d85f4d3f19f472880187eb14
Author: Brian Coca <bcoca@users.noreply.github.com>
Date:   Wed May 13 12:02:31 2020 -0400

    avoid fatal tb on bad fqcn callback name (#69440)

diff --git a/changelogs/fragments/no_fatal_bad_cb.yml b/changelogs/fragments/no_fatal_bad_cb.yml
new file mode 100644
index 0000000000..be67eeab2a
--- /dev/null
+++ b/changelogs/fragments/no_fatal_bad_cb.yml
@@ -0,0 +1,2 @@
+bugfixes:
+    - avoid fatal traceback when a bad FQCN for a callback is supplied in the whitelist (#69401).
diff --git a/lib/ansible/executor/task_queue_manager.py b/lib/ansible/executor/task_queue_manager.py
index 30c5f383a6..cd6c396860 100644
--- a/lib/ansible/executor/task_queue_manager.py
+++ b/lib/ansible/executor/task_queue_manager.py
@@ -162,8 +162,11 @@ class TaskQueueManager:
         for callback_plugin_name in (c for c in C.DEFAULT_CALLBACK_WHITELIST if AnsibleCollectionRef.is_valid_fqcr(c)):
             # TODO: need to extend/duplicate the stdout callback check here (and possible move this ahead of the old way
             callback_obj = callback_loader.get(callback_plugin_name)
-            callback_obj.set_options()
-            self._callback_plugins.append(callback_obj)
+            if callback_obj:
+                callback_obj.set_options()
+                self._callback_plugins.append(callback_obj)
+            else:
+                display.warning("Skipping '%s', unable to load or use as a callback" % callback_plugin_name)
 
         self._callbacks_loaded = True
 
diff --git a/test/integration/targets/collections/runme.sh b/test/integration/targets/collections/runme.sh
index 5a82acc4e6..5aea771bda 100755
--- a/test/integration/targets/collections/runme.sh
+++ b/test/integration/targets/collections/runme.sh
@@ -71,3 +71,6 @@ if [[ "$(grep -wc "dynamic_host_a" "$CACHEFILE")" -ne "0" ]]; then
 fi
 
 ./vars_plugin_tests.sh
+
+# ensure non existing callback does not crash ansible
+ANSIBLE_CALLBACK_WHITELIST=charlie.gomez.notme ansible -m ping localhost
