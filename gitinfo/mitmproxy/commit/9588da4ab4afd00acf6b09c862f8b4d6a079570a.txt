commit 9588da4ab4afd00acf6b09c862f8b4d6a079570a
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Wed Jun 27 16:15:22 2012 +1200

    Catch errors that may happen on interpreter shutdown.

diff --git a/libpathod/pathod.py b/libpathod/pathod.py
index a09d3594..2d3264f8 100644
--- a/libpathod/pathod.py
+++ b/libpathod/pathod.py
@@ -1,4 +1,4 @@
-import urllib, threading, re, logging
+import urllib, threading, re, logging, socket, sys
 from netlib import tcp, http, odict, wsgi
 import version, app, rparse
 
@@ -27,7 +27,10 @@ class PathodHandler(tcp.BaseHandler):
                 self.finish()
 
         while not self.finished:
-            line = self.rfile.readline()
+            try:
+                line = self.rfile.readline()
+            except socket.error:
+                return None
             if line == "\r\n" or line == "\n": # Possible leftover from previous message
                 line = self.rfile.readline()
             if line == "":
