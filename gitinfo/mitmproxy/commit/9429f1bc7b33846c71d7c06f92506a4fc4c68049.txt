commit 9429f1bc7b33846c71d7c06f92506a4fc4c68049
Author: smill <smill@cuckoo.sh>
Date:   Wed Sep 14 19:10:13 2016 +0000

    Prevent crash in case of a connection timeout.

diff --git a/netlib/tcp.py b/netlib/tcp.py
index c3b8a407..4e988ee3 100644
--- a/netlib/tcp.py
+++ b/netlib/tcp.py
@@ -484,12 +484,14 @@ class _Connection(object):
         if not isinstance(self.connection, SSL.Connection):
             if not getattr(self.wfile, "closed", False):
                 try:
-                    self.wfile.flush()
-                    self.wfile.close()
+                    if self.wfile:
+                        self.wfile.flush()
+                        self.wfile.close()
                 except exceptions.TcpDisconnect:
                     pass
 
-            self.rfile.close()
+            if self.rfile:
+                self.rfile.close()
         else:
             try:
                 self.connection.shutdown()
