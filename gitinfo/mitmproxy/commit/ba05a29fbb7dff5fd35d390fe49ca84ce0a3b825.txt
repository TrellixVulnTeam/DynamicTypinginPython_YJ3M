commit ba05a29fbb7dff5fd35d390fe49ca84ce0a3b825
Author: Thomas Kriechbaumer <thomas@kriechbaumer.name>
Date:   Wed May 24 10:34:56 2017 +0200

    TCP IPv6: fix leaking sockets

diff --git a/mitmproxy/net/tcp.py b/mitmproxy/net/tcp.py
index 81568d24..73b1088f 100644
--- a/mitmproxy/net/tcp.py
+++ b/mitmproxy/net/tcp.py
@@ -864,6 +864,8 @@ class TCPServer:
             self.socket.setsockopt(IPPROTO_IPV6, socket.IPV6_V6ONLY, 0)
             self.socket.bind(self.address)
         except socket.error:
+            if self.socket:
+                self.socket.close()
             self.socket = None
 
         if not self.socket:
