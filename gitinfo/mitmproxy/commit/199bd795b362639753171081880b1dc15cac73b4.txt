commit 199bd795b362639753171081880b1dc15cac73b4
Author: Nikita Stupin <18281368+nikitastupin@users.noreply.github.com>
Date:   Fri May 8 22:19:26 2020 +0300

    Add minimal TCP interception!

diff --git a/mitmproxy/addons/intercept.py b/mitmproxy/addons/intercept.py
index d39d1962..db229826 100644
--- a/mitmproxy/addons/intercept.py
+++ b/mitmproxy/addons/intercept.py
@@ -49,3 +49,6 @@ class Intercept:
 
     def response(self, f):
         self.process_flow(f)
+
+    def tcp_message(self, f):
+        f.intercept()
diff --git a/mitmproxy/tools/console/consoleaddons.py b/mitmproxy/tools/console/consoleaddons.py
index 12448945..7c1cbc09 100644
--- a/mitmproxy/tools/console/consoleaddons.py
+++ b/mitmproxy/tools/console/consoleaddons.py
@@ -398,6 +398,7 @@ class ConsoleAddon:
             "status_code",
             "set-cookies",
             "url",
+            "tcp-message"
         ]
 
     @command.command("console.edit.focus")
@@ -458,6 +459,10 @@ class ConsoleAddon:
                 "console.command",
                 ["flow.set", "@focus", flow_part]
             )
+        elif flow_part == "tcp-message":
+            message = flow.messages[-1]
+            c = self.master.spawn_editor(message.content or b"")
+            message.content = c.rstrip(b"\n")
 
     def _grideditor(self):
         gewidget = self.master.window.current("grideditor")
