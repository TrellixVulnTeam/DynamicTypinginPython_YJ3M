commit 500b61a811f9d1c73550a4cd96b91b697ebc1ea3
Author: Shadab Zafar <dufferzafar0@gmail.com>
Date:   Wed Jul 20 16:01:35 2016 +0530

    Use marked property in ConsoleState.clear

diff --git a/mitmproxy/console/master.py b/mitmproxy/console/master.py
index 989c2193..84eadcf0 100644
--- a/mitmproxy/console/master.py
+++ b/mitmproxy/console/master.py
@@ -140,16 +140,12 @@ class ConsoleState(flow.State):
         self.set_focus(0)
 
     def clear(self):
-        marked_flows = []
-        for f in self.flows:
-            if self.flow_marked(f):
-                marked_flows.append(f)
-
+        marked_flows = [f for f in self.state.view if f.marked]
         super(ConsoleState, self).clear()
 
         for f in marked_flows:
             self.add_flow(f)
-            self.set_flow_marked(f, True)
+            f.marked = True
 
         if len(self.flows.views) == 0:
             self.focus = None
