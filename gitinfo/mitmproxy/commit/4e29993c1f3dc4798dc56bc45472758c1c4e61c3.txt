commit 4e29993c1f3dc4798dc56bc45472758c1c4e61c3
Author: Shadab Zafar <dufferzafar0@gmail.com>
Date:   Tue Jul 12 16:13:42 2016 +0530

    Add test for addresses (~src, ~dst)

diff --git a/test/mitmproxy/test_filt.py b/test/mitmproxy/test_filt.py
index 5f3622e9..a910a946 100644
--- a/test/mitmproxy/test_filt.py
+++ b/test/mitmproxy/test_filt.py
@@ -268,6 +268,22 @@ class TestMatchingTCPFlow:
         assert self.q("~b hello", f)
         assert self.q("~b me", f)
 
+    def test_src(self):
+        f = self.flow()
+        assert self.q("~src address", f)
+        assert not self.q("~src foobar", f)
+        assert self.q("~src :22", f)
+        assert not self.q("~src :99", f)
+        assert self.q("~src address:22", f)
+
+    def test_dst(self):
+        f = self.flow()
+        f.server_conn = tutils.tserver_conn()
+        assert self.q("~dst address", f)
+        assert not self.q("~dst foobar", f)
+        assert self.q("~dst :22", f)
+        assert not self.q("~dst :99", f)
+        assert self.q("~dst address:22", f)
 
 @patch('traceback.extract_tb')
 def test_pyparsing_bug(extract_tb):
