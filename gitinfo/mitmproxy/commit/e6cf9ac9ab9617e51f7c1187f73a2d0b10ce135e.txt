commit e6cf9ac9ab9617e51f7c1187f73a2d0b10ce135e
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Tue Jun 13 16:16:39 2017 +1200

    console: use master.shutdown rather than raising urwid.ExitMainLoop

diff --git a/mitmproxy/tools/console/consoleaddons.py b/mitmproxy/tools/console/consoleaddons.py
index 5431f5be..fb6d5cb9 100644
--- a/mitmproxy/tools/console/consoleaddons.py
+++ b/mitmproxy/tools/console/consoleaddons.py
@@ -8,7 +8,6 @@ from mitmproxy.tools.console import overlay
 from mitmproxy import contentviews
 from mitmproxy.utils import strutils
 from mitmproxy.tools.console import signals
-import urwid
 
 
 class Logger:
@@ -253,7 +252,7 @@ class ConsoleAddon:
     @command.command("console.exit")
     def exit(self) -> None:
         """Exit mitmproxy."""
-        raise urwid.ExitMainLoop
+        self.master.shutdown()
 
     @command.command("console.view.pop")
     def view_pop(self) -> None:
