commit b9f06b473cd464e82bc53a973c5e190f93377bce
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Sat Aug 10 23:07:09 2013 +1200

    Better handling of cert errors.

diff --git a/netlib/tcp.py b/netlib/tcp.py
index 123c6515..df1f8fea 100644
--- a/netlib/tcp.py
+++ b/netlib/tcp.py
@@ -37,6 +37,7 @@ OP_TLS_ROLLBACK_BUG = SSL.OP_TLS_ROLLBACK_BUG
 class NetLibError(Exception): pass
 class NetLibDisconnect(NetLibError): pass
 class NetLibTimeout(NetLibError): pass
+class NetLibSSLError(NetLibError): pass
 
 
 class _FileLike:
@@ -129,6 +130,8 @@ class Reader(_FileLike):
                 data = self.o.read(rlen)
             except SSL.ZeroReturnError:
                 break
+            except SSL.Error, v:
+                raise NetLibSSLError(v.message)
             except SSL.WantReadError:
                 if (time.time() - start) < self.o.gettimeout():
                     time.sleep(0.1)
