commit b942f98f372abec974968d88119b5b573e4cb39c
Author: Mike C <miguelc@r2d2.geek.local>
Date:   Mon Apr 27 02:31:58 2015 +0100

    + Use sys.platform.startswith("freebsd") instead of matching just freebsd10.
    + This means support for any freebsd version (note that I only tested 11-CURRENT and 9)

diff --git a/libmproxy/platform/__init__.py b/libmproxy/platform/__init__.py
index 1b2cf909..e1ff7c47 100644
--- a/libmproxy/platform/__init__.py
+++ b/libmproxy/platform/__init__.py
@@ -8,9 +8,9 @@ if sys.platform == "linux2":
 elif sys.platform == "darwin":
     from . import osx
     resolver = osx.Resolver
-elif sys.platform == "freebsd10":
+elif sys.platform.startswith("freebsd"):
     from . import osx
     resolver = osx.Resolver
 elif sys.platform == "win32":
     from . import windows
-    resolver = windows.Resolver
\ No newline at end of file
+    resolver = windows.Resolver
diff --git a/libmproxy/platform/pf.py b/libmproxy/platform/pf.py
index 8c2f4678..97a4c192 100644
--- a/libmproxy/platform/pf.py
+++ b/libmproxy/platform/pf.py
@@ -13,7 +13,7 @@ def lookup(address, port, s):
         if "ESTABLISHED:ESTABLISHED" in i and spec in i:
             s = i.split()
             if len(s) > 4:
-                if sys.platform == "freebsd10":
+                if sys.platform.startswith("freebsd"):
                     # strip parentheses for FreeBSD pfctl
                     s = s[3][1:-1].split(":")
                 else:
@@ -21,4 +21,4 @@ def lookup(address, port, s):
 
                 if len(s) == 2:
                     return s[0], int(s[1])
-    raise RuntimeError("Could not resolve original destination.")
\ No newline at end of file
+    raise RuntimeError("Could not resolve original destination.")
