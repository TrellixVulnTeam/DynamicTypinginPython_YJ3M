commit 3f497640ab0a69838fb605ed9a4b1cee76e462aa
Author: Matthew Shao <me@matshao.com>
Date:   Tue Aug 15 22:23:21 2017 +0800

    [web] Update tests.

diff --git a/test/mitmproxy/tools/web/test_app.py b/test/mitmproxy/tools/web/test_app.py
index 091ef5e8..aaf949a8 100644
--- a/test/mitmproxy/tools/web/test_app.py
+++ b/test/mitmproxy/tools/web/test_app.py
@@ -186,7 +186,7 @@ class TestApp(tornado.testing.AsyncHTTPTestCase):
         f.response.headers["Content-Encoding"] = "ran\x00dom"
         f.response.headers["Content-Disposition"] = 'inline; filename="filename.jpg"'
 
-        r = self.fetch("/flows/42/response/content")
+        r = self.fetch("/flows/42/response/_content")
         assert r.body == b"message"
         assert r.headers["Content-Encoding"] == "random"
         assert r.headers["Content-Disposition"] == 'attachment; filename="filename.jpg"'
@@ -194,17 +194,17 @@ class TestApp(tornado.testing.AsyncHTTPTestCase):
         del f.response.headers["Content-Disposition"]
         f.request.path = "/foo/bar.jpg"
         assert self.fetch(
-            "/flows/42/response/content"
+            "/flows/42/response/_content"
         ).headers["Content-Disposition"] == 'attachment; filename=bar.jpg'
 
         f.response.content = b""
-        assert self.fetch("/flows/42/response/content").code == 400
+        assert self.fetch("/flows/42/response/_content").code == 400
 
         f.revert()
 
     def test_update_flow_content(self):
         assert self.fetch(
-            "/flows/42/request/content",
+            "/flows/42/request/_content",
             method="POST",
             body="new"
         ).code == 200
@@ -222,7 +222,7 @@ class TestApp(tornado.testing.AsyncHTTPTestCase):
             b'--somefancyboundary--\r\n'
         )
         assert self.fetch(
-            "/flows/42/request/content",
+            "/flows/42/request/_content",
             method="POST",
             headers={"Content-Type": 'multipart/form-data; boundary="somefancyboundary"'},
             body=body
diff --git a/web/src/js/__tests__/components/ContentView/__snapshots__/ContentViewOptionsSpec.js.snap b/web/src/js/__tests__/components/ContentView/__snapshots__/ContentViewOptionsSpec.js.snap
index e3561ec1..01fab0a7 100644
--- a/web/src/js/__tests__/components/ContentView/__snapshots__/ContentViewOptionsSpec.js.snap
+++ b/web/src/js/__tests__/components/ContentView/__snapshots__/ContentViewOptionsSpec.js.snap
@@ -13,7 +13,7 @@ exports[`ContentViewOptions Component should render correctly 1`] = `
    
   <a
     className="btn btn-default btn-xs"
-    href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/content"
+    href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/_content"
     title="Download the content of the flow."
   >
     <i
diff --git a/web/src/js/__tests__/components/ContentView/__snapshots__/ContentViewSpec.js.snap b/web/src/js/__tests__/components/ContentView/__snapshots__/ContentViewSpec.js.snap
index a4bc06c5..659eb6c3 100644
--- a/web/src/js/__tests__/components/ContentView/__snapshots__/ContentViewSpec.js.snap
+++ b/web/src/js/__tests__/components/ContentView/__snapshots__/ContentViewSpec.js.snap
@@ -17,7 +17,7 @@ exports[`ViewImage Component should render correctly 1`] = `
   <img
     alt="preview"
     className="img-thumbnail"
-    src="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/content"
+    src="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/_content"
   />
 </div>
 `;
diff --git a/web/src/js/__tests__/components/ContentView/__snapshots__/DownloadContentButtonSpec.js.snap b/web/src/js/__tests__/components/ContentView/__snapshots__/DownloadContentButtonSpec.js.snap
index 66900ca4..4c578a0c 100644
--- a/web/src/js/__tests__/components/ContentView/__snapshots__/DownloadContentButtonSpec.js.snap
+++ b/web/src/js/__tests__/components/ContentView/__snapshots__/DownloadContentButtonSpec.js.snap
@@ -3,7 +3,7 @@
 exports[`DownloadContentButton Component should render correctly 1`] = `
 <a
   className="btn btn-default btn-xs"
-  href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/content"
+  href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/_content"
   title="Download the content of the flow."
 >
   <i
diff --git a/web/src/js/__tests__/components/ContentView/__snapshots__/MetaViewsSpec.js.snap b/web/src/js/__tests__/components/ContentView/__snapshots__/MetaViewsSpec.js.snap
index 18ec5bba..1fdd5575 100644
--- a/web/src/js/__tests__/components/ContentView/__snapshots__/MetaViewsSpec.js.snap
+++ b/web/src/js/__tests__/components/ContentView/__snapshots__/MetaViewsSpec.js.snap
@@ -54,7 +54,7 @@ exports[`ContentTooLarge Components should render correctly 1`] = `
      
     <a
       className="btn btn-default btn-xs"
-      href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/content"
+      href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/_content"
       title="Download the content of the flow."
     >
       <i
diff --git a/web/src/js/__tests__/components/FlowView/__snapshots__/MessagesSpec.js.snap b/web/src/js/__tests__/components/FlowView/__snapshots__/MessagesSpec.js.snap
index c8290e45..c55d0750 100644
--- a/web/src/js/__tests__/components/FlowView/__snapshots__/MessagesSpec.js.snap
+++ b/web/src/js/__tests__/components/FlowView/__snapshots__/MessagesSpec.js.snap
@@ -265,7 +265,7 @@ exports[`Request Component should render correctly 1`] = `
        
       <a
         className="btn btn-default btn-xs"
-        href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/request/content"
+        href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/request/_content"
         title="Download the content of the flow."
       >
         <i
@@ -528,7 +528,7 @@ exports[`Response Component should render correctly 1`] = `
        
       <a
         className="btn btn-default btn-xs"
-        href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/content"
+        href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/_content"
         title="Download the content of the flow."
       >
         <i
diff --git a/web/src/js/__tests__/components/__snapshots__/ContentViewSpec.js.snap b/web/src/js/__tests__/components/__snapshots__/ContentViewSpec.js.snap
index 60b816e2..fcbab629 100644
--- a/web/src/js/__tests__/components/__snapshots__/ContentViewSpec.js.snap
+++ b/web/src/js/__tests__/components/__snapshots__/ContentViewSpec.js.snap
@@ -49,7 +49,7 @@ exports[`ContentView Component should render correctly with content too large 1`
      
     <a
       className="btn btn-default btn-xs"
-      href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/content"
+      href="/flows/d91165be-ca1f-4612-88a9-c0f8696f3e29/response/_content"
       title="Download the content of the flow."
     >
       <i
diff --git a/web/src/js/__tests__/flow/utilsSpec.js b/web/src/js/__tests__/flow/utilsSpec.js
index 2d8f0456..24e65651 100644
--- a/web/src/js/__tests__/flow/utilsSpec.js
+++ b/web/src/js/__tests__/flow/utilsSpec.js
@@ -25,15 +25,15 @@ describe('MessageUtils', () => {
         let msg = "foo", view = "bar",
             flow = { request: msg, id: 1}
         expect(utils.MessageUtils.getContentURL(flow, msg, view)).toEqual(
-            "/flows/1/request/content/bar"
+            "/flows/1/request/content/bar.json"
         )
         expect(utils.MessageUtils.getContentURL(flow, msg, '')).toEqual(
-            "/flows/1/request/content"
+            "/flows/1/request/_content"
         )
         // response
         flow = {response: msg, id: 2}
         expect(utils.MessageUtils.getContentURL(flow, msg, view)).toEqual(
-            "/flows/2/response/content/bar"
+            "/flows/2/response/content/bar.json"
         )
     })
 })
