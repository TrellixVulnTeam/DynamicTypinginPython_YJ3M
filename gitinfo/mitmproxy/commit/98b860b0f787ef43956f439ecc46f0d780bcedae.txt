commit 98b860b0f787ef43956f439ecc46f0d780bcedae
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Tue Apr 30 09:12:06 2013 +1200

    Adapt docs for website embedding.

diff --git a/doc-src/_layout.html b/doc-src/_layout.html
index 71b15fd2..b64a8558 100644
--- a/doc-src/_layout.html
+++ b/doc-src/_layout.html
@@ -6,7 +6,7 @@
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
       </a>
-      <a class="brand" href="@!urlTo("/index.html")!@">mitmproxy 0.9 docs</a>
+      <a class="brand" href="@!urlTo(idxpath)!@">mitmproxy 0.9 docs</a>
       </div><!--/.nav-collapse -->
     </div>
   </div>
@@ -17,7 +17,7 @@
     <div class="span3">
       <div class="well sidebar-nav">
         <ul class="nav nav-list">
-            $!nav("index.html", this, state)!$
+            $!nav(idxpath, this, state)!$
             $!nav("install.html", this, state)!$
             $!nav("howmitmproxy.html", this, state)!$
 
diff --git a/doc-src/_websitelayout.html b/doc-src/_websitelayout.html
index a18ce0e4..f65ee059 100644
--- a/doc-src/_websitelayout.html
+++ b/doc-src/_websitelayout.html
@@ -24,7 +24,7 @@
     <div class="span3">
       <div class="well sidebar-nav">
         <ul class="nav nav-list">
-            $!nav("/doc/index.html", this, state)!$
+            $!nav(idxpath, this, state)!$
             $!nav("install.html", this, state)!$
             $!nav("howmitmproxy.html", this, state)!$
 
diff --git a/doc-src/index.py b/doc-src/index.py
index 7b65adb9..7b84f982 100644
--- a/doc-src/index.py
+++ b/doc-src/index.py
@@ -8,10 +8,13 @@ from libmproxy import filt
 MITMPROXY_SRC = "~/git/public/mitmproxy"
 
 if ns.options.website:
+    ns.idxpath = "doc/index.html"
     this.layout = countershape.Layout("_websitelayout.html")
 else:
+    ns.idxpath = "index.html"
     this.layout = countershape.Layout("_layout.html")
 
+
 ns.title = countershape.template.Template(None, "<h1>@!this.title!@</h1>")
 this.titlePrefix = "mitmproxy 0.9 - "
 this.markup = markup.Markdown(extras=["footnotes"])
