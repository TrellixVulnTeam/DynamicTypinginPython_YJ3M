commit ee71bcfbe8a5be7f0b0bbe747ea65a3f7ca137be
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Sun Sep 11 09:06:46 2011 +1200

    Fix a rare crash when a new cert is generated during cerdir removal.

diff --git a/libmproxy/proxy.py b/libmproxy/proxy.py
index d1596b0a..7b6e695f 100644
--- a/libmproxy/proxy.py
+++ b/libmproxy/proxy.py
@@ -445,8 +445,11 @@ class ProxyServer(ServerBase):
         self.RequestHandlerClass(self.config, request, client_address, self, self.masterq)
 
     def shutdown(self):
-        shutil.rmtree(self.certdir)
         ServerBase.shutdown(self)
+        try:
+            shutil.rmtree(self.certdir)
+        except OSError:
+            pass
 
 
 # Command-line utils
