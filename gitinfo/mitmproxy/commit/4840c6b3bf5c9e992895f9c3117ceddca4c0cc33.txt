commit 4840c6b3bf5c9e992895f9c3117ceddca4c0cc33
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Sun Dec 8 15:26:30 2013 +1300

    Fix race condition in test suite.

diff --git a/netlib/tcp.py b/netlib/tcp.py
index b3be43d6..5a07c013 100644
--- a/netlib/tcp.py
+++ b/netlib/tcp.py
@@ -354,7 +354,6 @@ class BaseHandler:
         except (socket.error, SSL.Error):
             # Socket probably already closed
             pass
-
         self.connection.close()
 
 
diff --git a/test/test_tcp.py b/test/test_tcp.py
index f45acb00..220ece15 100644
--- a/test/test_tcp.py
+++ b/test/test_tcp.py
@@ -80,7 +80,6 @@ class FinishFailHandler(tcp.BaseHandler):
         v = self.rfile.readline()
         self.wfile.write(v)
         self.wfile.flush()
-        o = mock.MagicMock()
         self.wfile.close()
         self.rfile.close()
         self.close = mock.MagicMock(side_effect=socket.error)
@@ -99,8 +98,6 @@ class TestFinishFail(test.ServerTestBase):
         c.wfile.write("foo\n")
         c.wfile.flush()
         c.rfile.read(4)
-        h = self.last_handler
-        h.finish()
 
 
 class TestDisconnect(test.ServerTestBase):
