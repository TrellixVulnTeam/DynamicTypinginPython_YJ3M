commit 5c333ee3bad47e2e5bb7bf75d839e0227414301c
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Sat Apr 9 14:35:30 2016 -0700

    fix client playback logic

diff --git a/mitmproxy/flow.py b/mitmproxy/flow.py
index 047ec68b..f5e238a2 100644
--- a/mitmproxy/flow.py
+++ b/mitmproxy/flow.py
@@ -816,23 +816,24 @@ class FlowMaster(controller.Master):
                 self.client_playback.done() and
                 self.state.active_flow_count() == 0
             )
-            exit = stop and self.client_playback.exit
+            exit = self.client_playback.exit
             if stop:
                 self.stop_client_playback()
-            if exit:
-                self.shutdown()
-            self.client_playback.tick(self)
+                if exit:
+                    self.shutdown()
+            else:
+                self.client_playback.tick(self)
 
         if self.server_playback:
             stop = (
                 self.server_playback.count() == 0 and
                 self.state.active_flow_count() == 0
             )
-            exit = stop and self.server_playback.exit
+            exit = self.server_playback.exit
             if stop:
                 self.stop_server_playback()
-            if exit:
-                self.shutdown()
+                if exit:
+                    self.shutdown()
         return super(FlowMaster, self).tick(q, timeout)
 
     def duplicate_flow(self, f):
