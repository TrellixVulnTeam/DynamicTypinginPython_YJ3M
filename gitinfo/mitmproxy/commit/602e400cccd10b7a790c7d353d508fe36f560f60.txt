commit 602e400cccd10b7a790c7d353d508fe36f560f60
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Sun Mar 2 21:54:30 2014 +1300

    Use new get_current_cipher to show cipher in pathoc SSL output

diff --git a/libpathod/pathoc.py b/libpathod/pathoc.py
index 995a56d8..7354c380 100644
--- a/libpathod/pathoc.py
+++ b/libpathod/pathoc.py
@@ -8,8 +8,8 @@ class PathocError(Exception): pass
 
 
 class SSLInfo:
-    def __init__(self, certchain):
-        self.certchain = certchain
+    def __init__(self, certchain, cipher):
+        self.certchain, self.cipher = certchain, cipher
 
 
 class Response:
@@ -68,7 +68,8 @@ class Pathoc(tcp.TCPClient):
             except tcp.NetLibError, v:
                 raise PathocError(str(v))
             self.sslinfo = SSLInfo(
-                        self.connection.get_peer_cert_chain()
+                        self.connection.get_peer_cert_chain(),
+                        self.get_current_cipher()
                     )
 
     def request(self, spec):
@@ -160,6 +161,7 @@ class Pathoc(tcp.TCPClient):
                     self._show_summary(fp, *resp)
 
             if self.sslinfo:
+                print >> fp, "Cipher: %s, %s bit, %s"%self.sslinfo.cipher
                 print >> fp, "SSL certificate chain:\n"
                 for i in self.sslinfo.certchain:
                     print >> fp, "\tSubject: ",
