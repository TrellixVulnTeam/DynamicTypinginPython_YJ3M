commit 267837f441dca41af495bca61140fd9d657bd02e
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Fri Oct 16 18:12:36 2015 +0200

    add test certificate generator

diff --git a/test/data/verificationcerts/8117bdb9.0 b/test/data/verificationcerts/8117bdb9.0
deleted file mode 100644
index 8ebc0e5c..00000000
--- a/test/data/verificationcerts/8117bdb9.0
+++ /dev/null
@@ -1,15 +0,0 @@
-# Self signed
------BEGIN CERTIFICATE-----
-MIICJzCCAZACCQCo1BdopddN/TANBgkqhkiG9w0BAQUFADBXMQswCQYDVQQGEwJB
-VTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0
-cyBQdHkgTHRkMRAwDgYDVQQDEwdUUlVTVEVEMCAXDTE1MDYxOTE4MDEzMVoYDzIx
-MTUwNTI2MTgwMTMxWjBXMQswCQYDVQQGEwJBVTETMBEGA1UECBMKU29tZS1TdGF0
-ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMRAwDgYDVQQDEwdU
-UlVTVEVEMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC00Jf3KrBAmLQWl+Dz
-8Qrig8ActB94kv0/Lu03P/2DwOR8kH2h3w4OC3b3CFKX31h7hm/H1PPHq7cIX6IR
-fwrYCtBE77UbxklSlrwn06j6YSotz0/dwLEQEFDXWITJq7AyntaiafDHazbbXESN
-m/+I/YEl2wKemEHE//qWbeM9kwIDAQABMA0GCSqGSIb3DQEBBQUAA4GBAF0NREP3
-X+fTebzJGttzrFkDhGVFKRNyLXblXRVanlGOYF+q8grgZY2ufC/55gqf+ub6FRT5
-gKPhL4V2rqL8UAvCE7jq8ujpVfTB8kRAKC675W2DBZk2EJX9mjlr89t7qXGsI5nF
-onpfJ1UtiJshNoV7h/NFHeoag91kx628807n
------END CERTIFICATE-----
diff --git a/test/data/verificationcerts/9d45e6a9.0 b/test/data/verificationcerts/9d45e6a9.0
deleted file mode 100644
index 8ebc0e5c..00000000
--- a/test/data/verificationcerts/9d45e6a9.0
+++ /dev/null
@@ -1,15 +0,0 @@
-# Self signed
------BEGIN CERTIFICATE-----
-MIICJzCCAZACCQCo1BdopddN/TANBgkqhkiG9w0BAQUFADBXMQswCQYDVQQGEwJB
-VTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0
-cyBQdHkgTHRkMRAwDgYDVQQDEwdUUlVTVEVEMCAXDTE1MDYxOTE4MDEzMVoYDzIx
-MTUwNTI2MTgwMTMxWjBXMQswCQYDVQQGEwJBVTETMBEGA1UECBMKU29tZS1TdGF0
-ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMRAwDgYDVQQDEwdU
-UlVTVEVEMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC00Jf3KrBAmLQWl+Dz
-8Qrig8ActB94kv0/Lu03P/2DwOR8kH2h3w4OC3b3CFKX31h7hm/H1PPHq7cIX6IR
-fwrYCtBE77UbxklSlrwn06j6YSotz0/dwLEQEFDXWITJq7AyntaiafDHazbbXESN
-m/+I/YEl2wKemEHE//qWbeM9kwIDAQABMA0GCSqGSIb3DQEBBQUAA4GBAF0NREP3
-X+fTebzJGttzrFkDhGVFKRNyLXblXRVanlGOYF+q8grgZY2ufC/55gqf+ub6FRT5
-gKPhL4V2rqL8UAvCE7jq8ujpVfTB8kRAKC675W2DBZk2EJX9mjlr89t7qXGsI5nF
-onpfJ1UtiJshNoV7h/NFHeoag91kx628807n
------END CERTIFICATE-----
diff --git a/test/data/verificationcerts/9da13359.0 b/test/data/verificationcerts/9da13359.0
new file mode 100644
index 00000000..7d91e288
--- /dev/null
+++ b/test/data/verificationcerts/9da13359.0
@@ -0,0 +1,21 @@
+-----BEGIN CERTIFICATE-----
+MIIDXTCCAkWgAwIBAgIJAPJ/OeIFZUrJMA0GCSqGSIb3DQEBCwUAMEUxCzAJBgNV
+BAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBX
+aWRnaXRzIFB0eSBMdGQwHhcNMTUxMDE2MTUwMjU4WhcNMTgwODA1MTUwMjU4WjBF
+MQswCQYDVQQGEwJBVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50
+ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIB
+CgKCAQEAs8EFHXjYTdmPf9J37wUuLcx5hi9HFmXfFEbJ0tSm/U8lajfsnr869LiO
+2App2JHgntreemHe/OZaaa/fPykDnDDiQBVb74H55YGHYCGphIPeyT78KEvInPOs
+m/CaYFxlXB/ao81SXeGKkKagcFq/D4FjFYjmjxDxzUJVxX67knjr5WwPK60NfJSq
+JzRIvFFXUtkByRv2VZmEAj56KRQx1W0+Ant51j52ryuD7pvCZ6P5TU4CdGlu34bu
+1DJ/7uRBCIGYffZs7vE2wMhCvbwQAPl0q+Kq9yZdPXY+sgoGgmkydB/INuXSv/Ce
+IgpBW+EjjeYD32YbnOTQ0Fi5yvxEjwIDAQABo1AwTjAdBgNVHQ4EFgQU8X+ohuC4
+QOemuutP/xX6ZCddKqowHwYDVR0jBBgwFoAU8X+ohuC4QOemuutP/xX6ZCddKqow
+DAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAnD4fPo/ztU6g77BSf88o
+TtsQ1x2Cu3I7DNFEDBpBubooQpQZpwuLspMSgQfTnlPT4V7iBE/+3x7gJm8BcWEi
+QxjJhoiWVWDpDe0GdcgNvScPq+3kupzxEJrTGSY/SJjiftlTvI1oGRmto9VXhNlU
+6TeFEwieDWfm2waqJCYlGI86go47piqjh3E8ODPAT1SBRLvrfU6b3nvSPl3r1JvF
+iurGxMPUk3DHb/Y19MdkFiaUqu/P+c/rO6BDxhPfuJxhmw4OdMuPA7cY0H3bbXHE
+yoXqEvQ43ItEiYXVRoc9CCT1l9+ExC8cUsOTUqFi5Fwyr7K3ZDpAOqCpzaLZnss7
+mw==
+-----END CERTIFICATE-----
diff --git a/test/data/verificationcerts/generate.py b/test/data/verificationcerts/generate.py
new file mode 100644
index 00000000..922cb95d
--- /dev/null
+++ b/test/data/verificationcerts/generate.py
@@ -0,0 +1,72 @@
+"""
+Generate SSL test certificates.
+"""
+import subprocess
+import shlex
+import os
+import shutil
+
+
+ROOT_CA = "trusted-root"
+SUBJECT = "/CN=127.0.0.1/"
+
+
+def do(args):
+    print("> %s" % args)
+    args = shlex.split(args)
+    output = subprocess.check_output(args)
+    print(output)
+    return output
+
+
+def genrsa(cert):
+    do("openssl genrsa -out {cert}.key 2048".format(cert=cert))
+
+
+def sign(cert):
+    do("openssl x509 -req -in {cert}.csr "
+       "-CA {root_ca}.crt "
+       "-CAkey {root_ca}.key "
+       "-CAcreateserial "
+       "-days 1024 "
+       "-out {cert}.crt".format(root_ca=ROOT_CA, cert=cert)
+       )
+
+
+def mkcert(cert, args):
+    genrsa(cert)
+    do("openssl req -new -nodes -batch "
+       "-key {cert}.key "
+       "{args} "
+       "-out {cert}.csr".format(cert=cert, args=args)
+       )
+    sign(cert)
+    os.remove("{cert}.csr".format(cert=cert))
+
+
+# create trusted root CA
+genrsa("trusted-root")
+do("openssl req -x509 -new -nodes -batch "
+   "-key trusted-root.key "
+   "-days 1024 "
+   "-out trusted-root.crt"
+   )
+h = do("openssl x509 -hash -noout -in trusted-root.crt").strip()
+shutil.copyfile("trusted-root.crt", "{}.0".format(h))
+
+# create trusted leaf cert.
+mkcert("trusted-leaf", "-subj {}".format(SUBJECT))
+
+# create wrong host leaf cert.
+mkcert("trusted-leaf-bad-host", "-subj /CN=wrong.host/")
+
+# create self-signed cert
+genrsa("self-signed")
+do("openssl req -x509 -new -nodes -batch "
+   "-key self-signed.key "
+   "-subj {} "
+   "-days 1024 "
+   "-out self-signed.crt".format(SUBJECT)
+   )
+
+
diff --git a/test/data/verificationcerts/interm.key b/test/data/verificationcerts/interm.key
deleted file mode 100644
index 76c05cf4..00000000
--- a/test/data/verificationcerts/interm.key
+++ /dev/null
@@ -1,16 +0,0 @@
-# Key used to sign trusted-interm.crt and untrusted-interm.crt
------BEGIN RSA PRIVATE KEY-----
-MIICXAIBAAKBgQC1E80qCHhZ1gaZTYB7pN/Yxt3ehpEj+5hCbpop5iTWLuDjULS9
-WjA1wP+p02kZQ2dqL8pqT1qcc5jKmk2jvMeB/cQ7zNDg1NCmQMqx0KptRByMZ+GN
-Zcqc7D4jl6vhGP4zAzV/lxvBvxtgeJI+ZdrHN0vT9I1cYADKz9SzCDCRTwIDAQAB
-AoGAfKHocKnrzEmXuSSy7meI+vfF9kfA1ndxUSg3S+dwK0uQ1mTSQhI1ZIo2bnlo
-uU6/e0Lxm0KLJ2wZGjoifjSNTC8pcxIfAQY4kM9fqoUcXVSBVSS2kByTunhNSVZQ
-yQyc+UTq9g1zBnJsZAltn7/PaihU4heWgP/++lposuShqmECQQDaG+7l0qul1xak
-9kuZgc88BSTfn9iMK2zIQRcVKuidK4dT3QEp0wmWR5Ue8jq8lvTmVTGNGZbHcheh
-KhoZfLgLAkEA1IjwAw/8z02yV3lbc2QUjIl9m9lvjHBoE2sGuSfq/cZskLKrGat+
-CVj3spqVAg22tpQwVBuHiipBziWVnEtiTQJAB9FKfchQSLBt6lm9mfHyKJeSm8VR
-8Kw5yO+0URjpn4CI6DOasBIVXOKR8LsD6fCLNJpHHWSWZ+2p9SfaKaGzwwJBAM31
-Scld89qca4fzNZkT0goCrvOZeUy6HVE79Q72zPVSFSD/02kT1BaQ3bB5to5/5aD2
-6AKJjwZoPs7bgykrsD0CQBzU8U/8x2dNQnG0QeqaKQu5kKhZSZ9bsawvrCkxSl6b
-WAjl/Jehi5bbQ07zQo3cge6qeR38FCWVCHQ/5wNbc54=
------END RSA PRIVATE KEY-----
diff --git a/test/data/verificationcerts/self-signed.crt b/test/data/verificationcerts/self-signed.crt
new file mode 100644
index 00000000..d7f07214
--- /dev/null
+++ b/test/data/verificationcerts/self-signed.crt
@@ -0,0 +1,18 @@
+-----BEGIN CERTIFICATE-----
+MIIC+zCCAeOgAwIBAgIJAMLvc0tz5r3vMA0GCSqGSIb3DQEBCwUAMBQxEjAQBgNV
+BAMMCTEyNy4wLjAuMTAeFw0xNTEwMTYxNTAzMDJaFw0xODA4MDUxNTAzMDJaMBQx
+EjAQBgNVBAMMCTEyNy4wLjAuMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
+ggEBALCzDuJl7g55J+ZNKnir0cekd48JnjPFk7sbJOPudsQ6pj/HXFrAXTPVix2n
+eKtj2nADUds1C1fEgsJnYqYp9DtwesJEnnc0i2ykQmQZFygd7/0P7Z+YtUtup3F6
+jtUGEcCJ3dOOXJNyhESeyBcQwNvLgHYXAHFyN4svxueQ4fW7+d44fm0JaqZjHEtX
+Q8tcVadIDsp65s+WWVP6gC0sMO2DikoF2g/98p1U0CeUCmueYJsmKpm+53smWrOp
+cqwUXoxAdg03pbgC10aeWDvxm3aBC/Et9EDbaKuzHhBkOJ8E7CkyqLT/Vs7DQ9xl
+WFF/Ebs1vsVniBFl3QpObxqhbM0CAwEAAaNQME4wHQYDVR0OBBYEFOTCuMxDnuup
+hNAT1/gxdU9DIs82MB8GA1UdIwQYMBaAFOTCuMxDnuuphNAT1/gxdU9DIs82MAwG
+A1UdEwQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBADOlFmM1fryPDFIP6mM7O4df
+0GfMC9XWODf2NdJ9VWa8P7HrMbiPZy26ORkLpcWc+fuGbcd1ejf8TGbCz4f9aQ82
+P33s5jtGKRRAoB8rPmyALPSt9xrMUHYLYzN97sqY7ZHdHsc4NfzcbMVLOF+3aG4X
+LIQiPIp6sLncBwvu0mHSjlcDcTM4n/Sqov4eeCNTGlVzTzsJQ6/lAwq9LIggRZA1
+RKWd+u7IQUcEMTKP0gvaWtfbxJH76RFPJX3wg7YSm97ArU9ZGna0rPORoIORrucL
+aBncUwIXEPH4rtP1zy7Rg4ZeHyzoFcgR2W46ONTds+5aZDx98OyWv+gT9HSLgEo=
+-----END CERTIFICATE-----
diff --git a/test/data/verificationcerts/self-signed.key b/test/data/verificationcerts/self-signed.key
new file mode 100644
index 00000000..54111eca
--- /dev/null
+++ b/test/data/verificationcerts/self-signed.key
@@ -0,0 +1,27 @@
+-----BEGIN RSA PRIVATE KEY-----
+MIIEpQIBAAKCAQEAsLMO4mXuDnkn5k0qeKvRx6R3jwmeM8WTuxsk4+52xDqmP8dc
+WsBdM9WLHad4q2PacANR2zULV8SCwmdipin0O3B6wkSedzSLbKRCZBkXKB3v/Q/t
+n5i1S26ncXqO1QYRwInd045ck3KERJ7IFxDA28uAdhcAcXI3iy/G55Dh9bv53jh+
+bQlqpmMcS1dDy1xVp0gOynrmz5ZZU/qALSww7YOKSgXaD/3ynVTQJ5QKa55gmyYq
+mb7neyZas6lyrBRejEB2DTeluALXRp5YO/GbdoEL8S30QNtoq7MeEGQ4nwTsKTKo
+tP9WzsND3GVYUX8RuzW+xWeIEWXdCk5vGqFszQIDAQABAoIBAQCdc5DJ0IYmQ3N4
+Vj6INKLDwRwAS1O7Uk1nprJioLUX+iL2JhF3lH34mEpUbEysfFfDBFJGgKfQ13yk
++jb/VdcZuArLXRXPpvSuJFg8ldb6mmKlHzJgylSSGNH/3nO0AqqC5NbTksGPabXO
+56XoV7dio52enLR6Yop37mTRJ1sR+ahLFUDZ8K0pEXn0pdZVEp+LVksJ6txtklGo
+x6oDyQW/AOu2QWIhrneyvSO9XzFCqOnN9KPQDhWdqRmdPjiX+sbLevX7Tf5PhiEH
+nNuPxUv19+4xmu7s2tZLY6C19noRSCo4835i25smmItU9hHJ9VvHKID0oLJCMtdD
+4HSErPLJAoGBAOa8Hz927R1y124geYfl0+IG+yfF0Spe7HqYk7wyHlY5EGQAncoA
+n0UclagRVNQzC4Y3s+QOLIV5HGw2ENMz7flCLe3f8SPRvFu6nqWKQLAnF1U5eO8Q
+YVgaWadr8PT/iOPp4PHHfhXsNx3p6RPbDyntqG9xpGYpoy97iEMkWm+jAoGBAMQM
+PBIIJ+5dgPQLE42KDK3iyNQLahVFDRXozVdGm3NERsZFAB1NjfaS+HMZRr+/WID7
+tVIxrgumY8iI8SO5nD51EaPYfppjmE55hIB2eN7GqL32JwwL4fQiT3WZ0aU0mY3m
+3av+RKunXCNc7LBWPzQfAAf21D4Y8N36H6i57LjPAoGBAOX2vRYdy7m8Ceaiyz2c
+3I678nnzeMLIFN0jUKsTMJUzDpj83EbGU/cnxCjcDTXpIiVFQy+ayNjGmoNnZ2F4
+skfpo6kft1DB6v9pglDu+AYZD/JK87MhGkQbDxwEQwWL4b12DlIrSAlFgrF3vmuh
+uv1I9sUL+JQyD4h1kJuKkfANAoGANoJoWWMnJyGcbz59K0eNCvQZfsvFrTBL2SGn
+pnKdWklLnGknBP7BUCPBLM+EWmArjYFvAvGJQPf8mo9o7NP422zVgMb7PJYgjQFA
+lC9coCSAWoEMjk7nfmfjzAD+x35+i3P7gozqLwgTmEmIDeeNH0LXUV+R18o7fpzD
+HLjFVwUCgYEAjcv9BwK+qMhRxFcxYKsb5HkPp5LaFa3PKgitF8jsGKd+pLDyIkDD
+ih2Hohf9LjR/EqlPT/w5JLmgrF6zWAKtNzWMHKP4hae322/Xh5jTJQY3rbEf0k8D
+aB3XoleKD0+5erl6tDRNAPlc8qJcgBv+UzZVBmf0n3aJD3mwoS06dvQ=
+-----END RSA PRIVATE KEY-----
diff --git a/test/data/verificationcerts/trusted-chain.crt b/test/data/verificationcerts/trusted-chain.crt
deleted file mode 100644
index dd30bff3..00000000
--- a/test/data/verificationcerts/trusted-chain.crt
+++ /dev/null
@@ -1,35 +0,0 @@
-# untrusted.crt, signed by trusted-interm.crt
------BEGIN CERTIFICATE-----
-MIICYzCCAcwCAhAIMA0GCSqGSIb3DQEBBQUAMH4xCzAJBgNVBAYTAkFVMRMwEQYD
-VQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRlcm5ldCBXaWRnaXRzIFB0eSBM
-dGQxFDASBgNVBAsTC0lOVEVSTSBVTklUMSEwHwYDVQQDExhPUkcgV0lUSCBJTlRF
-Uk1FRElBVEUgQ0EwIBcNMTUwNjIwMDEyMDI1WhgPMjExNTA1MjcwMTIwMjVaMHMx
-CzAJBgNVBAYTAkFVMRMwEQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRl
-cm5ldCBXaWRnaXRzIFB0eSBMdGQxEjAQBgNVBAsTCUxFQUYgVU5JVDEYMBYGA1UE
-AxMPTk9UIFRSVVNURUQgT1JHMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDf
-NZx/tugICrWGcpP8sa+EBX9WhazCsYIm8YgQrQO9B19dK7cHsWB+vIdFuDKHxfS2
-JBIeVSaZ6H4onWGnZRAMpi5xnitVhBQKCZP1yOewtrg2umZIbcTz8A+BwAcvmmQN
-7RZMfpxN9PMccWDfgtAXsjZ2E47o9EfhpGvxfcFc0wIDAQABMA0GCSqGSIb3DQEB
-BQUAA4GBABtmc8zn5efVi3iVIgODadKkTv43elIwNZBqEJ6IaoVXvi5Mp1m4VxML
-LQGPTNG1lpuVDz2z/Ml78942316ailCTOx48oDnb/yy4jI6hsp+N8p6T28/Wvkbm
-cCgohk6/Cwat5gf+HwoIe5Z3B3HRJaIcB0OteluuLsHAvverBjc4
------END CERTIFICATE-----
-# trusted-interm.crt, signed by trusted.pem
------BEGIN CERTIFICATE-----
-MIIC8jCCAlugAwIBAgICEAcwDQYJKoZIhvcNAQEFBQAwVzELMAkGA1UEBhMCQVUx
-EzARBgNVBAgTClNvbWUtU3RhdGUxITAfBgNVBAoTGEludGVybmV0IFdpZGdpdHMg
-UHR5IEx0ZDEQMA4GA1UEAxMHVFJVU1RFRDAgFw0xNTA2MjAwMTE4MjdaGA8yMTE1
-MDUyNzAxMTgyN1owfjELMAkGA1UEBhMCQVUxEzARBgNVBAgTClNvbWUtU3RhdGUx
-ITAfBgNVBAoTGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDEUMBIGA1UECxMLSU5U
-RVJNIFVOSVQxITAfBgNVBAMTGE9SRyBXSVRIIElOVEVSTUVESUFURSBDQTCBnzAN
-BgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAtRPNKgh4WdYGmU2Ae6Tf2Mbd3oaRI/uY
-Qm6aKeYk1i7g41C0vVowNcD/qdNpGUNnai/Kak9anHOYyppNo7zHgf3EO8zQ4NTQ
-pkDKsdCqbUQcjGfhjWXKnOw+I5er4Rj+MwM1f5cbwb8bYHiSPmXaxzdL0/SNXGAA
-ys/UswgwkU8CAwEAAaOBozCBoDAMBgNVHRMEBTADAQH/MB0GA1UdDgQWBBTPkPQW
-DAPOIy8mipuEsZcP1694EDBxBgNVHSMEajBooVukWTBXMQswCQYDVQQGEwJBVTET
-MBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0cyBQ
-dHkgTHRkMRAwDgYDVQQDEwdUUlVTVEVEggkAqNQXaKXXTf0wDQYJKoZIhvcNAQEF
-BQADgYEApaPbwonY8l+zSxlY2Fw4WNKfl5nwcTW4fuv/0tZLzvsS6P4hTXxbYJNa
-k3hQ1qlrr8DiWJewF85hYvEI2F/7eqS5dhhPTEUFPpsjhbgiqnASvW+WKQIgoY2r
-aHgOXi7RNFtTcCgk0UZISWOY7ORLy8Xu6vKrLRjDhyfIbGlqnAs=
------END CERTIFICATE-----
diff --git a/test/data/verificationcerts/trusted-interm.crt b/test/data/verificationcerts/trusted-interm.crt
deleted file mode 100644
index d577db7d..00000000
--- a/test/data/verificationcerts/trusted-interm.crt
+++ /dev/null
@@ -1,19 +0,0 @@
-# trusted-interm.crt, signed by trusted.pem
------BEGIN CERTIFICATE-----
-MIIC8jCCAlugAwIBAgICEAcwDQYJKoZIhvcNAQEFBQAwVzELMAkGA1UEBhMCQVUx
-EzARBgNVBAgTClNvbWUtU3RhdGUxITAfBgNVBAoTGEludGVybmV0IFdpZGdpdHMg
-UHR5IEx0ZDEQMA4GA1UEAxMHVFJVU1RFRDAgFw0xNTA2MjAwMTE4MjdaGA8yMTE1
-MDUyNzAxMTgyN1owfjELMAkGA1UEBhMCQVUxEzARBgNVBAgTClNvbWUtU3RhdGUx
-ITAfBgNVBAoTGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDEUMBIGA1UECxMLSU5U
-RVJNIFVOSVQxITAfBgNVBAMTGE9SRyBXSVRIIElOVEVSTUVESUFURSBDQTCBnzAN
-BgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAtRPNKgh4WdYGmU2Ae6Tf2Mbd3oaRI/uY
-Qm6aKeYk1i7g41C0vVowNcD/qdNpGUNnai/Kak9anHOYyppNo7zHgf3EO8zQ4NTQ
-pkDKsdCqbUQcjGfhjWXKnOw+I5er4Rj+MwM1f5cbwb8bYHiSPmXaxzdL0/SNXGAA
-ys/UswgwkU8CAwEAAaOBozCBoDAMBgNVHRMEBTADAQH/MB0GA1UdDgQWBBTPkPQW
-DAPOIy8mipuEsZcP1694EDBxBgNVHSMEajBooVukWTBXMQswCQYDVQQGEwJBVTET
-MBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0cyBQ
-dHkgTHRkMRAwDgYDVQQDEwdUUlVTVEVEggkAqNQXaKXXTf0wDQYJKoZIhvcNAQEF
-BQADgYEApaPbwonY8l+zSxlY2Fw4WNKfl5nwcTW4fuv/0tZLzvsS6P4hTXxbYJNa
-k3hQ1qlrr8DiWJewF85hYvEI2F/7eqS5dhhPTEUFPpsjhbgiqnASvW+WKQIgoY2r
-aHgOXi7RNFtTcCgk0UZISWOY7ORLy8Xu6vKrLRjDhyfIbGlqnAs=
------END CERTIFICATE-----
diff --git a/test/data/verificationcerts/trusted-leaf-bad-host.crt b/test/data/verificationcerts/trusted-leaf-bad-host.crt
new file mode 100644
index 00000000..bbf2fb0a
--- /dev/null
+++ b/test/data/verificationcerts/trusted-leaf-bad-host.crt
@@ -0,0 +1,18 @@
+-----BEGIN CERTIFICATE-----
+MIIC1jCCAb4CCQCzDwzVB+KILzANBgkqhkiG9w0BAQsFADBFMQswCQYDVQQGEwJB
+VTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0
+cyBQdHkgTHRkMB4XDTE1MTAxNjE1MDMwMVoXDTE4MDgwNTE1MDMwMVowFTETMBEG
+A1UEAwwKd3JvbmcuaG9zdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB
+AMnJESjt6YT6x2z4SBvsrZyhlwCZ0GwYdSpfJLSaQXmzDG60i9qeqrLKDHGSUfak
+W6RTl/Hh+EoJtVaVQirJyApkLOGkrMpS3HabWI/nFtShrCK5kcTDmbP52bfvhago
+YZiXWoYV1WzSWKK+WiAMsGc6cUmfaoWego7dc+E9BzCP8PJniEBctWNt1wBZwxAv
+G657CaHvlkEAIc6jIFIE0jL/Gi2T8J8jCAsboXYyP5AXIn+aEu/VJDGys7DnftU0
+uyK7l/qFwjTvkgs52ZqyUyoWVoM/7miXVe2D2HSzhLwXeVv+w3CtnwZ2BZA8WUIc
+KhGr2sjjOIwY9xguBwi1k8kCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAktS8+9Jz
+c0WatiFpo1DbHVBpN9VjjWF6uQyCOFu6uKiJgXAgCc/YekPHy9auu+DtDBVlpncV
+NS/+aZlLYF7dGpbkh5Qx1q2zSf5kH1tzbH3+qJpmJcRgKXNasu5aPRFqJLRHu5Lu
+V7K9Q/vRTbRNdu0Axn6yZEK+3/2bO5x5nFfUmAV2HLxFFIa6DbQhaBQjLnVyYFxD
+I6+G00MAZ47rj4m+PrxsXTOq050mg519FK0t5X7ifaG56R96EKvUkfifQzZmpmgX
+gs/ZaFzRkRLdqvsxyYHICL8BEKfwZUQiyAAb6Shf09/xO05a3LHl3ZXm87UxJlwW
+9qWySdIdCc41RA==
+-----END CERTIFICATE-----
diff --git a/test/data/verificationcerts/trusted-leaf-bad-host.key b/test/data/verificationcerts/trusted-leaf-bad-host.key
new file mode 100644
index 00000000..30711ece
--- /dev/null
+++ b/test/data/verificationcerts/trusted-leaf-bad-host.key
@@ -0,0 +1,27 @@
+-----BEGIN RSA PRIVATE KEY-----
+MIIEpQIBAAKCAQEAyckRKO3phPrHbPhIG+ytnKGXAJnQbBh1Kl8ktJpBebMMbrSL
+2p6qssoMcZJR9qRbpFOX8eH4Sgm1VpVCKsnICmQs4aSsylLcdptYj+cW1KGsIrmR
+xMOZs/nZt++FqChhmJdahhXVbNJYor5aIAywZzpxSZ9qhZ6Cjt1z4T0HMI/w8meI
+QFy1Y23XAFnDEC8brnsJoe+WQQAhzqMgUgTSMv8aLZPwnyMICxuhdjI/kBcif5oS
+79UkMbKzsOd+1TS7IruX+oXCNO+SCznZmrJTKhZWgz/uaJdV7YPYdLOEvBd5W/7D
+cK2fBnYFkDxZQhwqEavayOM4jBj3GC4HCLWTyQIDAQABAoIBAQCJzs3vW/w9m1+T
+ZkUo/Qzciecsu9+B03pBQ9U3mpnY2ZVGDfvthKsji6XP8pQTk9AafBSrVx5Qwiyc
+Qzd7LW922U9lkyeGzexO/G0RaktHUFrVJFMPRF62cY5ldimb3Gg65DMom8S0mzt5
+efLnLINVHK6+DyeatdSIaWl4jEtat9tsxp8UNtm0rnpa+jEy13wUsTcPe9f/pLXS
+KqFXdyq263R2FkKC7FaT2HHYDJmiDPwta/hHPGzc3A8/CfPDAr0SrFEuWmYRj5mW
+0QrcDh+BTIavs5I5cD+95lLtWnJvak03o5eQvvWw5K4PqWidZk6OQlSoQe82uQXw
+AWLVH1thAoGBAPrLy39ACxFTA7dOQnwnJJBPN1MVV4ZnUAjE49iCnZfzyr5mZWRZ
+nNGJLSekwOqBbBa1dfh8n5cnv2aBNXv1m1NFMsPsnwmcm7ugrr3UPiIT81ZnJgR0
+5SzBfHTQRcegzaWq2Je79BYsa4SB6mAwPkjmOlnn03aMQICsbeFRYy59AoGBAM34
+7qCxZkz6vGxx7L6jtxP6q96Jd0S22eZqB3cccai9EfPgpywAzbYcoXfhz07RtGEU
+JBf1975tKHtwxzE1YTFKtvDjkRtikI/sw8TpDVfy9fDts7RF4nNmlhQJwAXTtWAk
+3Ui5u25WFi2don4XvcIexmaQviz/sguvtx3vOYA9AoGBANnQIR6VKoeTR4jt6QQW
+osTKZ8w6ntdV5saW6SNi3SfZTd3q5GgxA+dfcd4aUonYeV2Hn7t90MTgenS2BxNv
+jcTWNm6+lKkuYHql5N1s9cF2/kGuN/Bq7ZbfPA3fzJrB55jYNmAhlq2jSoW8pyd+
+/rklaswmcRtmV6bpGk0z+CWpAoGBAI7aAD6I6uem2rnnxYduqlH7/+mGs6Z/nt60
+WNseaiHah7H59FeLcyDD+KTZgtsqjAzsWCAaIqn6sSHz1OLnH7J9HCYz3nb8xEBd
+uGVAMVX3FuXzJjh4Y5cf5iSdooUoENpOlv6SelEK+bTHaGRFeQFCMN3/szYoXMbI
+JptnSB0NAoGAT9vfD/GhokSCvNO99XQOSR/r9wkrv/AzXjFUkAyEFv00+DXoNoEw
+eT62HaUjdnBoIiwCc7whrYzk94BOoHGkMF5qUCNWEN9G3kOT4VWhsEYqXepdFy5Y
+x/Jt5UIXABtFMKS4ZE8VbjFTodpmdqUcdCP6Zb+ASDJCzbGlqHZofJA=
+-----END RSA PRIVATE KEY-----
diff --git a/test/data/verificationcerts/trusted-leaf.crt b/test/data/verificationcerts/trusted-leaf.crt
new file mode 100644
index 00000000..10432db8
--- /dev/null
+++ b/test/data/verificationcerts/trusted-leaf.crt
@@ -0,0 +1,18 @@
+-----BEGIN CERTIFICATE-----
+MIIC1TCCAb0CCQCzDwzVB+KILjANBgkqhkiG9w0BAQsFADBFMQswCQYDVQQGEwJB
+VTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0
+cyBQdHkgTHRkMB4XDTE1MTAxNjE1MDMwMFoXDTE4MDgwNTE1MDMwMFowFDESMBAG
+A1UEAwwJMTI3LjAuMC4xMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA
+uDZ6dL1IxfAY8uxpzUScwTg1jHpktLk1Uwj7m+dsDGHCvEhmbLhllYdCiqpcEjxm
+2IGtzzKU5iAtN46WQsWApw5H6n+Ozw3k3Wf7KqwcSxn0pemGglj7lRg8PNTBWHLe
+aw3qQcZUKgmAwVly0ILYNmKbTBiRh1IpCjI1lqHM9gLY9GqrQ5N6D4iZPX3Snxq3
+IKVcpAvGShxjrRXyXwrVdk5vHdMRiNiMOLE+drpoK9ShmIz8OCCA2D+PvClaYGjz
+2GbvNzrHMcSiJzggeT8aRNv8HT5JEj8NOgt9NM2yzQSZsOCGc9r6scKV0A0n8PQH
+KiwBMulH9ums73MfM/NstQIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQA1pWmPnijh
+szj3hf7hBrk27jEO8VO87Y9rVlPlII2JAdSGU/5AbrgsiWIMKeLJM5eqftWjuELG
+ZGAJHNk/J74x16I/YlyZZZ1pzklGmVp3VYbHeabRCP77a+qLzBhhirdqPaZuFK3U
+3GTm/fsyAypHxDM5xsDJVqLolLgrasFgUxEoNuI3LRbMKhcGURAOKiJJpJIwBqGo
+xiZVdC5ZAOK70jU+8jNpNFrgo7gN1tinuQYFoZZ5fGIQObo5rgbqkF7U/fCknkLj
+N7ykvCkMqeax3gj7htkpfXYTvG0zRiX59D11hhRGoTs3XZS52+jFHAJau6netga2
+fT7jVsojtgw8
+-----END CERTIFICATE-----
diff --git a/test/data/verificationcerts/trusted-leaf.key b/test/data/verificationcerts/trusted-leaf.key
new file mode 100644
index 00000000..a6aba170
--- /dev/null
+++ b/test/data/verificationcerts/trusted-leaf.key
@@ -0,0 +1,27 @@
+-----BEGIN RSA PRIVATE KEY-----
+MIIEpQIBAAKCAQEAuDZ6dL1IxfAY8uxpzUScwTg1jHpktLk1Uwj7m+dsDGHCvEhm
+bLhllYdCiqpcEjxm2IGtzzKU5iAtN46WQsWApw5H6n+Ozw3k3Wf7KqwcSxn0pemG
+glj7lRg8PNTBWHLeaw3qQcZUKgmAwVly0ILYNmKbTBiRh1IpCjI1lqHM9gLY9Gqr
+Q5N6D4iZPX3Snxq3IKVcpAvGShxjrRXyXwrVdk5vHdMRiNiMOLE+drpoK9ShmIz8
+OCCA2D+PvClaYGjz2GbvNzrHMcSiJzggeT8aRNv8HT5JEj8NOgt9NM2yzQSZsOCG
+c9r6scKV0A0n8PQHKiwBMulH9ums73MfM/NstQIDAQABAoIBAE6hQmfuG9ARijS2
+4PpzXQ3Etma+H5pcq/xDi1Ki16X5XKwNo1qo4wOOdsLFsQM/sQ6dW9ljV9dayLI8
+NLtPnniwSdY4mHadEaHILpeqW3FbJOhk47tjzA96BsxYbCca8QF1MRbeVzKSV9kw
+GygRkcS1FmDG4+eFFGt7vxALBHfFSdI2qkqrRRv+PHtBcV5/06CR/7CFF2GC5ZSs
+X1DaceoEW9Qjl+0+EP/XoecOA6W/3zgjqv9hbPwJZuMDYYQ574BtWAi0LC5Q5G5s
+L+Zbl1pMeUIcZ2nHThMSo6xM/2SU+5KNcGwYa2jfx5Q4TzP0BB7b8M2IB+bYIim/
+D7fGsUkCgYEA4r3XF5FI5eSXswrkqQWMjkjI0IJIuhAld8tRILT2c2yADTaQ4dB9
+v/SfdoZBmXxatOKrC4KJwSkdoy3YOIz1knVd27amYcTQnwpux1XQWl9Cxxc/C85h
+hy5LWxsBaxy4JzFn98N9PUdX9jeXgm6yBzGcBdNU1sSXOYul3T5hzvcCgYEAz/u/
+QslIlffYiLGZ+vu9CBiVVERrix0Uj9K+I3wM7T6WtP471bMjcsQ4IKVzKeiHu/0S
+bpqktdxIIbQEnziwIS15Vz165HXR9lfqurk1Vi5x4O94MB9A2pB5qTPo6IS3aClB
+gyA5gUw5dUxI4iSu5nxOBaVg9jsgFzyfbr0CerMCgYEAoNnD6PgsGsqbw2wK4s0I
+9Tc1HpYOOdCSg/U8TFOUMjXacYUwKsHZM3+6UD7V8qiBQKk8ZiHoz5r3Z3dyWEvH
+OmsAdomQZvNUfD7Ob6K0+Cd0HAClvR5fmaKB2tPBodbx3PvzoZSRGBOwlv7BAMq+
+iNPst0VAfktgbHZg6B8FC+kCgYEAzjgKQxk7HF+b1qVqTL5QhveBEQWqMExMN/K4
+TozQcGfPnHQ8Nb6iVkgScuQ5lQMXmqDqJrq0uBFLgAdzUcAueycQmhy+fkoIPh6c
+AjpjlSkGBwbJ/8TtVAlOaCOtOudkxyWo7HAGNJq0mgZieb/vn17/KX/57Qtg3Ulh
+t7Y3ABsCgYEA0ehcAnI14nW5pPfmXiVg4MSaSRNHtVKsDrQ+g5SUGLuXFqyYiNxC
+/yzRhtknLe1rwHjp4+bNpFj+OzAad8MXh5FClIsa7w3cc2S/9ixO6vA8BMshHNBL
+GOMxdqBTzSKNf0kE/M7YYznCi4kodxy8wWwsAbQYswKCU0jCn/GBCOw=
+-----END RSA PRIVATE KEY-----
diff --git a/test/data/verificationcerts/trusted-root.crt b/test/data/verificationcerts/trusted-root.crt
new file mode 100644
index 00000000..7d91e288
--- /dev/null
+++ b/test/data/verificationcerts/trusted-root.crt
@@ -0,0 +1,21 @@
+-----BEGIN CERTIFICATE-----
+MIIDXTCCAkWgAwIBAgIJAPJ/OeIFZUrJMA0GCSqGSIb3DQEBCwUAMEUxCzAJBgNV
+BAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBX
+aWRnaXRzIFB0eSBMdGQwHhcNMTUxMDE2MTUwMjU4WhcNMTgwODA1MTUwMjU4WjBF
+MQswCQYDVQQGEwJBVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50
+ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIB
+CgKCAQEAs8EFHXjYTdmPf9J37wUuLcx5hi9HFmXfFEbJ0tSm/U8lajfsnr869LiO
+2App2JHgntreemHe/OZaaa/fPykDnDDiQBVb74H55YGHYCGphIPeyT78KEvInPOs
+m/CaYFxlXB/ao81SXeGKkKagcFq/D4FjFYjmjxDxzUJVxX67knjr5WwPK60NfJSq
+JzRIvFFXUtkByRv2VZmEAj56KRQx1W0+Ant51j52ryuD7pvCZ6P5TU4CdGlu34bu
+1DJ/7uRBCIGYffZs7vE2wMhCvbwQAPl0q+Kq9yZdPXY+sgoGgmkydB/INuXSv/Ce
+IgpBW+EjjeYD32YbnOTQ0Fi5yvxEjwIDAQABo1AwTjAdBgNVHQ4EFgQU8X+ohuC4
+QOemuutP/xX6ZCddKqowHwYDVR0jBBgwFoAU8X+ohuC4QOemuutP/xX6ZCddKqow
+DAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAnD4fPo/ztU6g77BSf88o
+TtsQ1x2Cu3I7DNFEDBpBubooQpQZpwuLspMSgQfTnlPT4V7iBE/+3x7gJm8BcWEi
+QxjJhoiWVWDpDe0GdcgNvScPq+3kupzxEJrTGSY/SJjiftlTvI1oGRmto9VXhNlU
+6TeFEwieDWfm2waqJCYlGI86go47piqjh3E8ODPAT1SBRLvrfU6b3nvSPl3r1JvF
+iurGxMPUk3DHb/Y19MdkFiaUqu/P+c/rO6BDxhPfuJxhmw4OdMuPA7cY0H3bbXHE
+yoXqEvQ43ItEiYXVRoc9CCT1l9+ExC8cUsOTUqFi5Fwyr7K3ZDpAOqCpzaLZnss7
+mw==
+-----END CERTIFICATE-----
diff --git a/test/data/verificationcerts/trusted-root.key b/test/data/verificationcerts/trusted-root.key
new file mode 100644
index 00000000..298e8bd9
--- /dev/null
+++ b/test/data/verificationcerts/trusted-root.key
@@ -0,0 +1,27 @@
+-----BEGIN RSA PRIVATE KEY-----
+MIIEpQIBAAKCAQEAs8EFHXjYTdmPf9J37wUuLcx5hi9HFmXfFEbJ0tSm/U8lajfs
+nr869LiO2App2JHgntreemHe/OZaaa/fPykDnDDiQBVb74H55YGHYCGphIPeyT78
+KEvInPOsm/CaYFxlXB/ao81SXeGKkKagcFq/D4FjFYjmjxDxzUJVxX67knjr5WwP
+K60NfJSqJzRIvFFXUtkByRv2VZmEAj56KRQx1W0+Ant51j52ryuD7pvCZ6P5TU4C
+dGlu34bu1DJ/7uRBCIGYffZs7vE2wMhCvbwQAPl0q+Kq9yZdPXY+sgoGgmkydB/I
+NuXSv/CeIgpBW+EjjeYD32YbnOTQ0Fi5yvxEjwIDAQABAoIBAGwOu6l07OsXv0kC
+1/BK9/C2O9OrdhuDz+/bghYImf4q5v4McmUX5jQZAl3jHLABObulLRr63NbBD1b7
+T8QjPrVVOZ12eZboVrZeAGiMs+AiefoWr/T1YbrgTUJNCDCnOpN/3qqbkkk3fVnp
+oQcJtlN2336hlqAoeoN+vhsETXQF1L598oOkb54O9fuZWKR/WrVgd1492oktHA0L
+19RmoZ6J7a3ojZh4IN838jlc3istqywbuB77dHSXYA9ZUjg+ejkZlUG1mGiv1OQg
+HUbRIqW+OOieMVvXUTGjAQDqXw/oz2d684rwXr3x7G9MKtBciVjUrNk1+JdM9M+9
+531xmNkCgYEA4+nHbNyEju33X2DB9W7xQYyrVvRu/+3+eCjCuOP+tppXs3WvE7kP
+TH2kjRpptPUm0FlpmYS0Uj1ty3WApNLEP9rdPyAtRBSzwPZOZ7Wg+GiNozarJwro
+FtUfJVYkO/vEOntMBOJQbih2eZudxSmKi1tC5eKKZXQJ6y56+nznrUsCgYEAyefp
+Kv1qCZ3cgqxoOdt1rSpPjkmB6JOtVii/BcoKx3NiqFTI11qPKdV1dllqgNnDEber
+fH9FA0POtNJrvulbw2YBq6DqySYVKZvxsDQ+Z9Ho0K3dicv4UwU5wbIQiOoNDQYC
+Xb+hqBp6ZMTaK4BnBfPQld6IkKN8yU9Fw9uZT00CgYEAvd/64+fHi+gW6eALVvUJ
+i2mtKTFU9GULVoHmz/AqOWjWXc1SgaTwaPJXz7JMlJSUtIl5H4veSpGg0htfhHGP
+S/+DyV5+N7TjmIPbCC3aIHnCXlJiPpGoj7UYUJu2bj6u2WX1DDCbf1q4cVHDHAoi
+wTzTu/+C+0i0Jrm/fMXooYcCgYEAj1igWY47d4JlaT0AbntaK8xLWUjk+3vFZ9Nb
+879DMeHA3KP9R7AazmenkpPfIoX4kZ6mGKi/FZdRrV1rc8p4BN1qODDyIEdyZO07
+hY9B8zG7qlSWYdu3fTHLlLJYPOx2wZVPnsGMAy5xURPVlWb/PeGhaJXqvU3lLYOj
+k29YhE0CgYEAnsoVVhuZZ2SIyPOGE3E2O/y0475lGjp83cUoEaRTRBS1DJS7LVdN
+QD1PCq0owNFKUZzDcbOD1x+an4X6gxTKd0GVDjNkmVCVwkKPQZRPFBNzVRN8do5e
+WFJLqY/3shJvSRmvut+SLnN5U5iYzHP1MOIatJSGfK/DXshOLlrQPqs=
+-----END RSA PRIVATE KEY-----
diff --git a/test/data/verificationcerts/trusted-root.srl b/test/data/verificationcerts/trusted-root.srl
new file mode 100644
index 00000000..22f0855d
--- /dev/null
+++ b/test/data/verificationcerts/trusted-root.srl
@@ -0,0 +1 @@
+B30F0CD507E2882F
diff --git a/test/data/verificationcerts/trusted.key b/test/data/verificationcerts/trusted.key
deleted file mode 100644
index 3c26edf6..00000000
--- a/test/data/verificationcerts/trusted.key
+++ /dev/null
@@ -1,15 +0,0 @@
------BEGIN RSA PRIVATE KEY-----
-MIICXAIBAAKBgQC00Jf3KrBAmLQWl+Dz8Qrig8ActB94kv0/Lu03P/2DwOR8kH2h
-3w4OC3b3CFKX31h7hm/H1PPHq7cIX6IRfwrYCtBE77UbxklSlrwn06j6YSotz0/d
-wLEQEFDXWITJq7AyntaiafDHazbbXESNm/+I/YEl2wKemEHE//qWbeM9kwIDAQAB
-AoGAVs2FBs1hi8FDQ01qWvGuzgt94MnACfxWw0xd6RY5OFUT25DqHxmb/7YVSIag
-T/SS38osQ3zCA2s2FTkD7u5UX5AzJyqYJwmJhe6ZmaVly6IpebMxkX5w/hy15/N4
-uy+kzdtEBUUTNLL3DM7THkDYUxmeDzCBrHsMvYUqFgsBLOECQQDeNc1pDC++ovg5
-d9sKqMnEykBfvuvR6ra/343tYxy9zNFBvYjU3BA83MITIbEa/KtlSkIppz/K/jk5
-IRwSrwsJAkEA0E9aZfjDZbC9Z4oL7T8gtj2ftSh2g37KE5AWW2OxMJwrzoJ/6wjB
-nG26ATlHEFP9bRzL2O1iovFLalqEjQo+uwJAMjtZXvjZRjATCvK0Onmjeu/5k2tW
-ZdK4UzGXJOW11pYZa9ILv4qrxQZmfOqt3Zrmp/QcdswPGLVVfDum2/Zj+QJABJO5
-yMPOh0162+uMl4nrjhWMjM52zCzdA9EGrLtkCU1lKQR1CxUGLAm9LIm1pgYya1NW
-p02P/USQA6Y5g1/WQQJBAIwl42Bebgaxl7dUbQX/vF+TryoCkM3B3eSM+P4XKB4f
-kKSkNxvp59uq+b40gkoqEowhdq97y+pmrCxJHK43NJM=
------END RSA PRIVATE KEY-----
diff --git a/test/data/verificationcerts/trusted.pem b/test/data/verificationcerts/trusted.pem
deleted file mode 100644
index 8ebc0e5c..00000000
--- a/test/data/verificationcerts/trusted.pem
+++ /dev/null
@@ -1,15 +0,0 @@
-# Self signed
------BEGIN CERTIFICATE-----
-MIICJzCCAZACCQCo1BdopddN/TANBgkqhkiG9w0BAQUFADBXMQswCQYDVQQGEwJB
-VTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0
-cyBQdHkgTHRkMRAwDgYDVQQDEwdUUlVTVEVEMCAXDTE1MDYxOTE4MDEzMVoYDzIx
-MTUwNTI2MTgwMTMxWjBXMQswCQYDVQQGEwJBVTETMBEGA1UECBMKU29tZS1TdGF0
-ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMRAwDgYDVQQDEwdU
-UlVTVEVEMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC00Jf3KrBAmLQWl+Dz
-8Qrig8ActB94kv0/Lu03P/2DwOR8kH2h3w4OC3b3CFKX31h7hm/H1PPHq7cIX6IR
-fwrYCtBE77UbxklSlrwn06j6YSotz0/dwLEQEFDXWITJq7AyntaiafDHazbbXESN
-m/+I/YEl2wKemEHE//qWbeM9kwIDAQABMA0GCSqGSIb3DQEBBQUAA4GBAF0NREP3
-X+fTebzJGttzrFkDhGVFKRNyLXblXRVanlGOYF+q8grgZY2ufC/55gqf+ub6FRT5
-gKPhL4V2rqL8UAvCE7jq8ujpVfTB8kRAKC675W2DBZk2EJX9mjlr89t7qXGsI5nF
-onpfJ1UtiJshNoV7h/NFHeoag91kx628807n
------END CERTIFICATE-----
diff --git a/test/data/verificationcerts/untrusted-chain.crt b/test/data/verificationcerts/untrusted-chain.crt
deleted file mode 100644
index 272779d8..00000000
--- a/test/data/verificationcerts/untrusted-chain.crt
+++ /dev/null
@@ -1,33 +0,0 @@
-# untrusted.crt, signed by trusted-interm.crt
------BEGIN CERTIFICATE-----
-MIICYzCCAcwCAhAIMA0GCSqGSIb3DQEBBQUAMH4xCzAJBgNVBAYTAkFVMRMwEQYD
-VQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRlcm5ldCBXaWRnaXRzIFB0eSBM
-dGQxFDASBgNVBAsTC0lOVEVSTSBVTklUMSEwHwYDVQQDExhPUkcgV0lUSCBJTlRF
-Uk1FRElBVEUgQ0EwIBcNMTUwNjIwMDEyMDI1WhgPMjExNTA1MjcwMTIwMjVaMHMx
-CzAJBgNVBAYTAkFVMRMwEQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRl
-cm5ldCBXaWRnaXRzIFB0eSBMdGQxEjAQBgNVBAsTCUxFQUYgVU5JVDEYMBYGA1UE
-AxMPTk9UIFRSVVNURUQgT1JHMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDf
-NZx/tugICrWGcpP8sa+EBX9WhazCsYIm8YgQrQO9B19dK7cHsWB+vIdFuDKHxfS2
-JBIeVSaZ6H4onWGnZRAMpi5xnitVhBQKCZP1yOewtrg2umZIbcTz8A+BwAcvmmQN
-7RZMfpxN9PMccWDfgtAXsjZ2E47o9EfhpGvxfcFc0wIDAQABMA0GCSqGSIb3DQEB
-BQUAA4GBABtmc8zn5efVi3iVIgODadKkTv43elIwNZBqEJ6IaoVXvi5Mp1m4VxML
-LQGPTNG1lpuVDz2z/Ml78942316ailCTOx48oDnb/yy4jI6hsp+N8p6T28/Wvkbm
-cCgohk6/Cwat5gf+HwoIe5Z3B3HRJaIcB0OteluuLsHAvverBjc4
------END CERTIFICATE-----
-# untrusted-interm.crt, self-signed
------BEGIN CERTIFICATE-----
-MIICdTCCAd4CCQDRSKOnIMbTgDANBgkqhkiG9w0BAQUFADB+MQswCQYDVQQGEwJB
-VTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0
-cyBQdHkgTHRkMRQwEgYDVQQLEwtJTlRFUk0gVU5JVDEhMB8GA1UEAxMYT1JHIFdJ
-VEggSU5URVJNRURJQVRFIENBMCAXDTE1MDYyMDAxMzY0M1oYDzIxMTUwNTI3MDEz
-NjQzWjB+MQswCQYDVQQGEwJBVTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UE
-ChMYSW50ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMRQwEgYDVQQLEwtJTlRFUk0gVU5J
-VDEhMB8GA1UEAxMYT1JHIFdJVEggSU5URVJNRURJQVRFIENBMIGfMA0GCSqGSIb3
-DQEBAQUAA4GNADCBiQKBgQC1E80qCHhZ1gaZTYB7pN/Yxt3ehpEj+5hCbpop5iTW
-LuDjULS9WjA1wP+p02kZQ2dqL8pqT1qcc5jKmk2jvMeB/cQ7zNDg1NCmQMqx0Kpt
-RByMZ+GNZcqc7D4jl6vhGP4zAzV/lxvBvxtgeJI+ZdrHN0vT9I1cYADKz9SzCDCR
-TwIDAQABMA0GCSqGSIb3DQEBBQUAA4GBAGbObAMEajCz4kj7OP2/DB5SRy2+H/G3
-8Qvc43xlMMNQyYxsDuLOFL0UMRzoKgntrrm2nni8jND+tuMt+hv3ZlBcJlYJ6ynR
-sC1ITTC/1SwwwO0AFIyduUEIJYr/B3sgcVYPLcEfeDZgmEQc9Tnc01aEu3lx2+l9
-0JTSPL2L9LdA
------END CERTIFICATE-----
diff --git a/test/data/verificationcerts/untrusted-interm.crt b/test/data/verificationcerts/untrusted-interm.crt
deleted file mode 100644
index 875cdcd6..00000000
--- a/test/data/verificationcerts/untrusted-interm.crt
+++ /dev/null
@@ -1,17 +0,0 @@
-# untrusted-interm.crt, self-signed
------BEGIN CERTIFICATE-----
-MIICdTCCAd4CCQDRSKOnIMbTgDANBgkqhkiG9w0BAQUFADB+MQswCQYDVQQGEwJB
-VTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0
-cyBQdHkgTHRkMRQwEgYDVQQLEwtJTlRFUk0gVU5JVDEhMB8GA1UEAxMYT1JHIFdJ
-VEggSU5URVJNRURJQVRFIENBMCAXDTE1MDYyMDAxMzY0M1oYDzIxMTUwNTI3MDEz
-NjQzWjB+MQswCQYDVQQGEwJBVTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UE
-ChMYSW50ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMRQwEgYDVQQLEwtJTlRFUk0gVU5J
-VDEhMB8GA1UEAxMYT1JHIFdJVEggSU5URVJNRURJQVRFIENBMIGfMA0GCSqGSIb3
-DQEBAQUAA4GNADCBiQKBgQC1E80qCHhZ1gaZTYB7pN/Yxt3ehpEj+5hCbpop5iTW
-LuDjULS9WjA1wP+p02kZQ2dqL8pqT1qcc5jKmk2jvMeB/cQ7zNDg1NCmQMqx0Kpt
-RByMZ+GNZcqc7D4jl6vhGP4zAzV/lxvBvxtgeJI+ZdrHN0vT9I1cYADKz9SzCDCR
-TwIDAQABMA0GCSqGSIb3DQEBBQUAA4GBAGbObAMEajCz4kj7OP2/DB5SRy2+H/G3
-8Qvc43xlMMNQyYxsDuLOFL0UMRzoKgntrrm2nni8jND+tuMt+hv3ZlBcJlYJ6ynR
-sC1ITTC/1SwwwO0AFIyduUEIJYr/B3sgcVYPLcEfeDZgmEQc9Tnc01aEu3lx2+l9
-0JTSPL2L9LdA
------END CERTIFICATE-----
diff --git a/test/data/verificationcerts/untrusted.crt b/test/data/verificationcerts/untrusted.crt
deleted file mode 100644
index 2dab470b..00000000
--- a/test/data/verificationcerts/untrusted.crt
+++ /dev/null
@@ -1,16 +0,0 @@
-# untrusted.crt, signed by trusted-interm.crt
------BEGIN CERTIFICATE-----
-MIICYzCCAcwCAhAIMA0GCSqGSIb3DQEBBQUAMH4xCzAJBgNVBAYTAkFVMRMwEQYD
-VQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRlcm5ldCBXaWRnaXRzIFB0eSBM
-dGQxFDASBgNVBAsTC0lOVEVSTSBVTklUMSEwHwYDVQQDExhPUkcgV0lUSCBJTlRF
-Uk1FRElBVEUgQ0EwIBcNMTUwNjIwMDEyMDI1WhgPMjExNTA1MjcwMTIwMjVaMHMx
-CzAJBgNVBAYTAkFVMRMwEQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRl
-cm5ldCBXaWRnaXRzIFB0eSBMdGQxEjAQBgNVBAsTCUxFQUYgVU5JVDEYMBYGA1UE
-AxMPTk9UIFRSVVNURUQgT1JHMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDf
-NZx/tugICrWGcpP8sa+EBX9WhazCsYIm8YgQrQO9B19dK7cHsWB+vIdFuDKHxfS2
-JBIeVSaZ6H4onWGnZRAMpi5xnitVhBQKCZP1yOewtrg2umZIbcTz8A+BwAcvmmQN
-7RZMfpxN9PMccWDfgtAXsjZ2E47o9EfhpGvxfcFc0wIDAQABMA0GCSqGSIb3DQEB
-BQUAA4GBABtmc8zn5efVi3iVIgODadKkTv43elIwNZBqEJ6IaoVXvi5Mp1m4VxML
-LQGPTNG1lpuVDz2z/Ml78942316ailCTOx48oDnb/yy4jI6hsp+N8p6T28/Wvkbm
-cCgohk6/Cwat5gf+HwoIe5Z3B3HRJaIcB0OteluuLsHAvverBjc4
------END CERTIFICATE-----
diff --git a/test/data/verificationcerts/verification-server.key b/test/data/verificationcerts/verification-server.key
deleted file mode 100644
index c527b09f..00000000
--- a/test/data/verificationcerts/verification-server.key
+++ /dev/null
@@ -1,16 +0,0 @@
-# Key used for untrusted.crt, untrusted-chain.crt and trusted-chain.crt
------BEGIN RSA PRIVATE KEY-----
-MIICXQIBAAKBgQDfNZx/tugICrWGcpP8sa+EBX9WhazCsYIm8YgQrQO9B19dK7cH
-sWB+vIdFuDKHxfS2JBIeVSaZ6H4onWGnZRAMpi5xnitVhBQKCZP1yOewtrg2umZI
-bcTz8A+BwAcvmmQN7RZMfpxN9PMccWDfgtAXsjZ2E47o9EfhpGvxfcFc0wIDAQAB
-AoGAE4B9ofL7Jui4n3yXTXbA3QoV7BtV0tTriDeGKd7T+soQHPXa0gM/aRNTxlWn
-pJE5JkjUhG3wJ3ZWv3mwtI1x718y0yL9uEgQJYsrNN+VJQwbGxXPio5SaG39gs+y
-/8xklytMIgvuCXxmcfljemW9+PGT8otYlHeIU3wvHQennDECQQD2vWAEU9k02R9w
-EkCM7mZEaW+WwrzyAD1NqatsVWErbNeXFPcHwU6y+DiDg2s5iEk89+xN2rX5mW2S
-PF/2RpaNAkEA55YpZN5nN4P8yCYNz5mWN0kuSPytSgJ3fQY3BY2GkdIft/KcAuDV
-1pf6jxubwP4vlamnZpqLfylbGdlRBoMY3wJBALQVE3cVG3qO3XsWVzaE6O8VZPRL
-vUuDETsVkp/G0Ny428DQ9FscoyvMLrMNv7yF065D5JwN/LLnYClTF1bPviECQQCo
-1BavO1eh6C3DN8K/wmb5PPdqLBKkrrGvSnWYLbmZ2sZW0p4blw8tVzRJWcYtZuEH
-yVuJeEcT1/FbIcto5O+fAkASbZXZka3nm41wWNYg479Sl8I+qvtScfJgpyByYhCx
-QaUAtZ791U+WNNHLqfZhSzP9lFZNRI0WNBSAy3SBR2Ur
------END RSA PRIVATE KEY-----
