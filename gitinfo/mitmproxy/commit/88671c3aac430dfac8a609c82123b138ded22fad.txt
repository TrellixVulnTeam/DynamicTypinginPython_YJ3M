commit 88671c3aac430dfac8a609c82123b138ded22fad
Author: Shadab Zafar <dufferzafar0@gmail.com>
Date:   Tue Jul 12 11:56:57 2016 +0530

    Add test for error (~e)

diff --git a/test/mitmproxy/test_filt.py b/test/mitmproxy/test_filt.py
index 9fe36b2a..f6c08c67 100644
--- a/test/mitmproxy/test_filt.py
+++ b/test/mitmproxy/test_filt.py
@@ -73,7 +73,7 @@ class TestParsing:
         self._dump(a)
 
 
-class TestMatching:
+class TestMatchingHTTPFlow:
 
     def req(self):
         return tutils.tflow()
@@ -247,6 +247,21 @@ class TestMatching:
         assert not self.q("!~c 201 !~c 200", s)
 
 
+class TestMatchingTCPFlow:
+
+    def flow(self):
+        return tutils.ttcpflow()
+
+    def err(self):
+        return tutils.ttcpflow(err=True)
+
+    def q(self, q, o):
+        return filt.parse(q)(o)
+
+    def test_ferr(self):
+        e = self.err()
+        assert self.q("~e", e)
+
 @patch('traceback.extract_tb')
 def test_pyparsing_bug(extract_tb):
     """https://github.com/mitmproxy/mitmproxy/issues/1087"""
