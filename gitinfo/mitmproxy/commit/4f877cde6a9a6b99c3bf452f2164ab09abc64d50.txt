commit 4f877cde6a9a6b99c3bf452f2164ab09abc64d50
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Sun Mar 20 09:31:39 2011 +1300

    Reverse order of flows in mitmproxy.
    
    It matches user expectations much better to have new flows appended to the bottom.

diff --git a/libmproxy/console.py b/libmproxy/console.py
index 3503e2c0..46bd0078 100644
--- a/libmproxy/console.py
+++ b/libmproxy/console.py
@@ -715,8 +715,6 @@ class ConsoleState(flow.State):
         f = flow.State.add_request(self, req)
         if self.focus is None:
             self.set_focus(0)
-        else:
-            self.set_focus(self.focus + 1)
         return f
 
     def add_response(self, resp):
diff --git a/libmproxy/flow.py b/libmproxy/flow.py
index 718a3dcd..eed006b4 100644
--- a/libmproxy/flow.py
+++ b/libmproxy/flow.py
@@ -343,7 +343,7 @@ class State:
             Add a request to the state. Returns the matching flow.
         """
         f = Flow(req)
-        self.flow_list.insert(0, f)
+        self.flow_list.append(f)
         self.flow_map[req] = f
         return f
 
diff --git a/test/test_console.py b/test/test_console.py
index dfa809ed..8b1e6d7c 100644
--- a/test/test_console.py
+++ b/test/test_console.py
@@ -30,15 +30,15 @@ class uState(libpry.AutoTree):
         assert c.get_next(0) == (None, None)
 
         f2 = self._add_request(c)
-        assert c.get_focus() == (f, 1)
-        assert c.get_next(0) == (f, 1)
-        assert c.get_prev(1) == (f2, 0)
+        assert c.get_focus() == (f, 0)
+        assert c.get_next(0) == (f2, 1)
+        assert c.get_prev(1) == (f, 0)
         assert c.get_next(1) == (None, None)
 
         c.set_focus(0)
-        assert c.get_focus() == (f2, 0)
+        assert c.get_focus() == (f, 0)
         c.set_focus(-1)
-        assert c.get_focus() == (f2, 0)
+        assert c.get_focus() == (f, 0)
 
         c.delete_flow(f2)
         assert c.get_focus() == (f, 0)
@@ -71,7 +71,7 @@ class uState(libpry.AutoTree):
         self._add_response(c)
         assert not c.set_limit("~q")
         assert len(c.view) == 3
-        assert c.focus == 2
+        assert c.focus == 0
 
 
 class uformat_keyvals(libpry.AutoTree):
