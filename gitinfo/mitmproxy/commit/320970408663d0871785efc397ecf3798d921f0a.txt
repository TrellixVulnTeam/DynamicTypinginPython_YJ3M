commit 320970408663d0871785efc397ecf3798d921f0a
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Fri Jul 21 11:24:42 2017 +0200

    fix addon tracebacks
    
    `.tb_next` discards the first interesting frame,
    this shouldn't happen.

diff --git a/mitmproxy/addonmanager.py b/mitmproxy/addonmanager.py
index 0bbe6287..ec82d650 100644
--- a/mitmproxy/addonmanager.py
+++ b/mitmproxy/addonmanager.py
@@ -61,7 +61,7 @@ def safecall():
         raise
     except Exception as e:
         etype, value, tb = sys.exc_info()
-        tb = cut_traceback(tb, "invoke_addon").tb_next
+        tb = cut_traceback(tb, "invoke_addon")
         ctx.log.error(
             "Addon error: %s" % "".join(
                 traceback.format_exception(etype, value, tb)
