commit df1b0df39f074f1f9e8bebfee37ed73c272aa3ec
Author: Thomas Kriechbaumer <thomas@kriechbaumer.name>
Date:   Wed Jul 8 21:03:04 2015 +0200

    use netlib.http_semantics for generic data

diff --git a/libmproxy/protocol/http.py b/libmproxy/protocol/http.py
index da15066b..97751b62 100644
--- a/libmproxy/protocol/http.py
+++ b/libmproxy/protocol/http.py
@@ -760,7 +760,7 @@ class HTTPResponse(HTTPMessage):
         if hasattr(rfile, "reset_timestamps"):
             rfile.reset_timestamps()
 
-        httpversion, code, msg, headers, content = http.read_response(
+        resp = http.read_response(
             rfile,
             request_method,
             body_size_limit,
@@ -776,11 +776,11 @@ class HTTPResponse(HTTPMessage):
             timestamp_end = None
 
         return HTTPResponse(
-            httpversion,
-            code,
-            msg,
-            headers,
-            content,
+            resp.httpversion,
+            resp.status_code,
+            resp.msg,
+            resp.headers,
+            resp.content,
             timestamp_start,
             timestamp_end
         )
diff --git a/test/test_server.py b/test/test_server.py
index 2805e936..91fd3971 100644
--- a/test/test_server.py
+++ b/test/test_server.py
@@ -765,22 +765,16 @@ class TestStreamRequest(tservers.HTTPProxTest):
             (self.server.urlbase, spec))
         connection.send("\r\n")
 
-        httpversion, code, msg, headers, content = http.read_response(
-            fconn, "GET", None, include_body=False)
+        resp = http.read_response(fconn, "GET", None, include_body=False)
 
-        assert headers["Transfer-Encoding"][0] == 'chunked'
-        assert code == 200
+        assert resp.headers["Transfer-Encoding"][0] == 'chunked'
+        assert resp.status_code == 200
 
         chunks = list(
             content for _,
                         content,
                         _ in http.read_http_body_chunked(
-                fconn,
-                headers,
-                None,
-                "GET",
-                200,
-                False))
+                fconn, resp.headers, None, "GET", 200, False))
         assert chunks == ["this", "isatest", ""]
 
         connection.close()
