commit 34e469eb558cae999b13510b029714a31d9dd1f3
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Tue Mar 11 20:23:27 2014 +0100

    create dhparam file if it doesn't exist, fix mitmproxy/mitmproxy#235

diff --git a/netlib/certutils.py b/netlib/certutils.py
index 92b219ee..ebe643e4 100644
--- a/netlib/certutils.py
+++ b/netlib/certutils.py
@@ -123,6 +123,13 @@ class CertStore:
 
     @classmethod
     def load_dhparam(klass, path):
+
+        # netlib<=0.10 doesn't generate a dhparam file.
+        # Create it now if neccessary.
+        if not os.path.exists(path):
+            with open(path, "wb") as f:
+                f.write(DEFAULT_DHPARAM)
+
         bio = OpenSSL.SSL._lib.BIO_new_file(path, b"r")
         if bio != OpenSSL.SSL._ffi.NULL:
             bio = OpenSSL.SSL._ffi.gc(bio, OpenSSL.SSL._lib.BIO_free)
