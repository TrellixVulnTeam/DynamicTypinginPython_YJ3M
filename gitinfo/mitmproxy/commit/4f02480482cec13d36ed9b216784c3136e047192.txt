commit 4f02480482cec13d36ed9b216784c3136e047192
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Sun Mar 6 14:48:16 2011 +1300

    Allow client replays to be replayed against server replays.
    
    Useful for testing.

diff --git a/libmproxy/flow.py b/libmproxy/flow.py
index 55976610..5f1e7871 100644
--- a/libmproxy/flow.py
+++ b/libmproxy/flow.py
@@ -54,10 +54,12 @@ class ClientPlaybackState:
         if self.flows and not self.current:
             n = self.flows.pop(0)
             self.current = master.handle_request(n.request)
-            if not testing:
+            if not testing and not self.current.response:
                 #begin nocover
                 master.state.replay_request(self.current, master.masterq)
                 #end nocover
+            elif self.current.response:
+                master.handle_response(self.current.response)
 
 
 class ServerPlaybackState:
