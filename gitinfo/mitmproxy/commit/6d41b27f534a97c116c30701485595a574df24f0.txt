commit 6d41b27f534a97c116c30701485595a574df24f0
Author: Thomas Roth <code@leveldown.de>
Date:   Wed Feb 24 23:59:54 2010 +0100

    Fixes crash on illegal regular expression for interception.

diff --git a/libmproxy/filt.py b/libmproxy/filt.py
index 49fff6c7..1dba3153 100644
--- a/libmproxy/filt.py
+++ b/libmproxy/filt.py
@@ -73,8 +73,10 @@ class FResp(_Action):
 class _Rex(_Action):
     def __init__(self, expr):
         self.expr = expr
-        self.re = re.compile(self.expr)
-
+        try:
+            self.re = re.compile(self.expr)
+        except:
+            self.re = False
 
 def _check_content_type(expr, o):
     val = o.headers.get("content-type")
@@ -186,7 +188,11 @@ class FUrl(_Rex):
     def make(klass, s, loc, toks):
         if len(toks) > 1:
             toks = toks[1:]
-        return klass(*toks)
+        ret_klass = klass(*toks)
+        if ret_klass.re:
+            return ret_klass
+        else:
+            return False
 
     def __call__(self, o):
         if o.is_response():
diff --git a/todo b/todo
index b949157f..363c07c5 100644
--- a/todo
+++ b/todo
@@ -14,7 +14,5 @@ Future:
 
 Bugs:
     
-    - Exception handling for regular expression compiler in filt.py.
-    - Fix crash on illegal regular expression on libmproxy/filt.py:76
     - In some circumstances, long URLs in list view are line-broken oddly.
     - Termination sometimes hangs.
