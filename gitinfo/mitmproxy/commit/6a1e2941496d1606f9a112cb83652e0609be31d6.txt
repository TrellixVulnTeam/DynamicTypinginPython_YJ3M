commit 6a1e2941496d1606f9a112cb83652e0609be31d6
Author: elitest <dcypherd@gmail.com>
Date:   Sat Feb 28 11:07:18 2015 -0600

    Update Server.py to improve cipher selection
    
    Differentiated client ciphers and added server ciphers.

diff --git a/libmproxy/proxy/server.py b/libmproxy/proxy/server.py
index 8544ff72..7306331c 100644
--- a/libmproxy/proxy/server.py
+++ b/libmproxy/proxy/server.py
@@ -189,6 +189,7 @@ class ConnectionHandler:
                     sni,
                     method=self.config.openssl_server_method,
                     options=self.config.openssl_server_options
+                    cipher_list=self.config.server_ciphers,
                 )
             except tcp.NetLibError as v:
                 e = ProxyError(502, repr(v))
@@ -210,7 +211,7 @@ class ConnectionHandler:
                     method=self.config.openssl_client_method,
                     options=self.config.openssl_client_options,
                     handle_sni=self.handle_sni,
-                    cipher_list=self.config.ciphers,
+                    cipher_list=self.config.client_ciphers,
                     dhparams=self.config.certstore.dhparams,
                     chain_file=chain_file
                 )
