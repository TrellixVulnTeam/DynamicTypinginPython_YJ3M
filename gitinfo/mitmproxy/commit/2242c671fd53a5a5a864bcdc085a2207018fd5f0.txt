commit 2242c671fd53a5a5a864bcdc085a2207018fd5f0
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Wed Apr 8 00:20:32 2015 +0200

    allow passing custom argv to libmproxy.main

diff --git a/libmproxy/main.py b/libmproxy/main.py
index e5b7f56b..a29fdb9d 100644
--- a/libmproxy/main.py
+++ b/libmproxy/main.py
@@ -75,14 +75,14 @@ def get_server(dummy_server, options):
             sys.exit(1)
 
 
-def mitmproxy():  # pragma: nocover
+def mitmproxy(args=None):  # pragma: nocover
     from . import console
 
     check_versions()
     assert_utf8_env()
 
     parser = cmdline.mitmproxy()
-    options = parser.parse_args()
+    options = parser.parse_args(args)
     if options.quiet:
         options.verbose = 0
 
@@ -101,13 +101,13 @@ def mitmproxy():  # pragma: nocover
         pass
 
 
-def mitmdump():  # pragma: nocover
+def mitmdump(args=None):  # pragma: nocover
     from . import dump
 
     check_versions()
 
     parser = cmdline.mitmdump()
-    options = parser.parse_args()
+    options = parser.parse_args(args)
     if options.quiet:
         options.verbose = 0
         options.flow_detail = 0
@@ -135,13 +135,13 @@ def mitmdump():  # pragma: nocover
         pass
 
 
-def mitmweb():  # pragma: nocover
+def mitmweb(args=None):  # pragma: nocover
     from . import web
 
     check_versions()
     parser = cmdline.mitmweb()
 
-    options = parser.parse_args()
+    options = parser.parse_args(args)
     if options.quiet:
         options.verbose = 0
 
