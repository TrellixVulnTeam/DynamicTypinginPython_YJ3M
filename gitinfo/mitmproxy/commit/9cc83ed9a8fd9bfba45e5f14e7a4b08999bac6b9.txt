commit 9cc83ed9a8fd9bfba45e5f14e7a4b08999bac6b9
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Fri Mar 7 15:21:34 2014 +1300

    Also dump SANs for pathoc -S

diff --git a/libpathod/pathoc.py b/libpathod/pathoc.py
index 7354c380..5ccb546b 100644
--- a/libpathod/pathoc.py
+++ b/libpathod/pathoc.py
@@ -1,5 +1,5 @@
 import sys, os
-from netlib import tcp, http
+from netlib import tcp, http, certutils
 import netlib.utils
 import language, utils
 import OpenSSL.crypto
@@ -183,7 +183,11 @@ class Pathoc(tcp.TCPClient):
                     }
                     t = types.get(pk.type(), "Uknown")
                     print >> fp, "\tPubkey: %s bit %s"%(pk.bits(), t)
+                    s = certutils.SSLCert(i)
+                    if s.altnames:
+                        print >> fp, "\tSANs:", " ".join(s.altnames)
                     print >> fp
             return True
 
 
+
