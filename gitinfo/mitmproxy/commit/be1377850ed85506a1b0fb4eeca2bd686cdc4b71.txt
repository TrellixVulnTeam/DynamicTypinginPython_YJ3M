commit be1377850ed85506a1b0fb4eeca2bd686cdc4b71
Author: Matthias Urlichs <matthias@urlichs.de>
Date:   Wed Jun 26 15:00:33 2013 +0200

    Close connection when flush fails

diff --git a/libmproxy/proxy.py b/libmproxy/proxy.py
index 283072ab..69873a38 100644
--- a/libmproxy/proxy.py
+++ b/libmproxy/proxy.py
@@ -88,6 +88,9 @@ class ServerConnection(tcp.TCPClient):
     def terminate(self):
         try:
             self.wfile.flush()
+        except IOError:
+            pass
+        try:
             self.connection.close()
         except IOError:
             pass
