commit b4469d25794ce05448bbfbe82088eb22b0de84e3
Author: Shadab Zafar <dufferzafar0@gmail.com>
Date:   Tue Jun 28 20:54:02 2016 +0530

    py3++: test_dump

diff --git a/mitmproxy/dump.py b/mitmproxy/dump.py
index 6670be9b..3625d86e 100644
--- a/mitmproxy/dump.py
+++ b/mitmproxy/dump.py
@@ -248,7 +248,7 @@ class DumpMaster(flow.FlowMaster):
         else:
             client = click.style("[replay]", fg="yellow", bold=True)
 
-        method = flow.request.method
+        method = flow.request.data.method
         method_color = dict(
             GET="green",
             DELETE="red"
@@ -258,7 +258,7 @@ class DumpMaster(flow.FlowMaster):
             url = flow.request.pretty_url
         else:
             url = flow.request.url
-        url = click.style(strutils.bytes_to_escaped_str(url), bold=True)
+        url = click.style(url, bold=True)
 
         httpversion = ""
         if flow.request.http_version not in ("HTTP/1.1", "HTTP/1.0"):
@@ -288,7 +288,7 @@ class DumpMaster(flow.FlowMaster):
         elif 400 <= code < 600:
             code_color = "red"
         code = click.style(str(code), fg=code_color, bold=True, blink=(code == 418))
-        reason = click.style(strutils.bytes_to_escaped_str(flow.response.reason), fg=code_color, bold=True)
+        reason = click.style(strutils.bytes_to_escaped_str(flow.response.data.reason), fg=code_color, bold=True)
 
         if flow.response.content is None:
             size = "(content missing)"
diff --git a/mitmproxy/models/http.py b/mitmproxy/models/http.py
index 8aeb84d6..df546b9b 100644
--- a/mitmproxy/models/http.py
+++ b/mitmproxy/models/http.py
@@ -1,6 +1,7 @@
 from __future__ import absolute_import, print_function, division
 
 import cgi
+import six
 
 from mitmproxy.models.flow import Flow
 from netlib import encoding
@@ -220,7 +221,7 @@ class HTTPFlow(Flow):
             If f is a string, it will be compiled as a filter expression. If
             the expression is invalid, ValueError is raised.
         """
-        if isinstance(f, str):
+        if isinstance(f, six.string_types):
             from .. import filt
 
             f = filt.parse(f)
diff --git a/tox.ini b/tox.ini
index e33fa4e0..411718c8 100644
--- a/tox.ini
+++ b/tox.ini
@@ -16,7 +16,7 @@ commands =
 
 [testenv:py35]
 setenv =
-  TESTS = --ignore=test/mitmproxy/test_dump.py test/
+  TESTS = test/
   HOME = {envtmpdir}
 
 [testenv:docs]
