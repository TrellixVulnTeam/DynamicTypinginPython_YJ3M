commit 23f7214fc3e10d8a0cc9a61256b01fac117f77f2
Author: Michael Frister <michael+git@frister.net>
Date:   Thu Mar 8 23:10:21 2012 +0100

    Fix SSL requests with Transfer-Encoding: chunked
    
    Add size parameter to FileLike.readline, used by read_chunked.

diff --git a/libmproxy/proxy.py b/libmproxy/proxy.py
index c5833d0c..72a7a5a3 100644
--- a/libmproxy/proxy.py
+++ b/libmproxy/proxy.py
@@ -184,10 +184,14 @@ class FileLike:
             result += data
         return result
 
-    def readline(self):
+    def readline(self, size = None):
         result = ''
+        bytes_read = 0
         while True:
+            if size is not None and bytes_read >= size:
+                break
             ch = self.read(1)
+            bytes_read += 1
             if not ch:
                 break
             else:
