commit 00561d280ccd4aac06b13b434e0aef4492148cb5
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Fri Sep 4 02:11:09 2015 +0200

    speed up filters

diff --git a/libmproxy/filt.py b/libmproxy/filt.py
index cfd3a1bc..6abc4a11 100644
--- a/libmproxy/filt.py
+++ b/libmproxy/filt.py
@@ -35,7 +35,6 @@ from __future__ import absolute_import
 import re
 import sys
 import pyparsing as pp
-from .models import decoded
 
 
 class _Token:
@@ -179,13 +178,11 @@ class FBod(_Rex):
 
     def __call__(self, f):
         if f.request and f.request.content:
-            with decoded(f.request):
-                if re.search(self.expr, f.request.content):
-                    return True
+            if re.search(self.expr, f.request.get_decoded_content()):
+                return True
         if f.response and f.response.content:
-            with decoded(f.response):
-                if re.search(self.expr, f.response.content):
-                    return True
+            if re.search(self.expr, f.response.get_decoded_content()):
+                return True
         return False
 
 
@@ -195,9 +192,8 @@ class FBodRequest(_Rex):
 
     def __call__(self, f):
         if f.request and f.request.content:
-            with decoded(f.request):
-                if re.search(self.expr, f.request.content):
-                    return True
+            if re.search(self.expr, f.request.get_decoded_content()):
+                return True
 
 
 class FBodResponse(_Rex):
@@ -206,9 +202,8 @@ class FBodResponse(_Rex):
 
     def __call__(self, f):
         if f.response and f.response.content:
-            with decoded(f.response):
-                if re.search(self.expr, f.response.content):
-                    return True
+            if re.search(self.expr, f.response.get_decoded_content()):
+                return True
 
 
 class FMethod(_Rex):
diff --git a/libmproxy/protocol/http.py b/libmproxy/protocol/http.py
index 74c93e16..f51fea95 100644
--- a/libmproxy/protocol/http.py
+++ b/libmproxy/protocol/http.py
@@ -7,7 +7,7 @@ from netlib import odict
 from netlib.tcp import NetLibError, Address
 from netlib.http.http1 import HTTP1Protocol
 from netlib.http.http2 import HTTP2Protocol
-from netlib.http.http2.frame import Frame, PingFrame, GoAwayFrame, PriorityFrame, WindowUpdateFrame
+from netlib.http.http2.frame import GoAwayFrame, PriorityFrame, WindowUpdateFrame
 
 from .. import utils
 from ..exceptions import InvalidCredentials, HttpException, ProtocolException
