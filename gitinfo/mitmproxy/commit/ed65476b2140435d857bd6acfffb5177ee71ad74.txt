commit ed65476b2140435d857bd6acfffb5177ee71ad74
Author: vin01 <vinc.i@protonmail.ch>
Date:   Thu Oct 3 10:23:45 2019 +0200

    Add EKU extension for dummy certificates

diff --git a/mitmproxy/certs.py b/mitmproxy/certs.py
index 0ec63b50..65dc50e4 100644
--- a/mitmproxy/certs.py
+++ b/mitmproxy/certs.py
@@ -115,6 +115,13 @@ def dummy_cert(privkey, cacert, commonname, sans, organization):
         cert.set_version(2)
         cert.add_extensions(
             [OpenSSL.crypto.X509Extension(b"subjectAltName", False, ss)])
+    cert.add_extensions([
+        OpenSSL.crypto.X509Extension(
+            b"extendedKeyUsage",
+            False,
+            b"serverAuth,clientAuth"
+        )
+    ])
     cert.set_pubkey(cacert.get_pubkey())
     cert.sign(privkey, "sha256")
     return Cert(cert)
