commit ce48cb4debab8caa518ea54e36dee722aaabb8a5
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Fri Aug 5 09:41:29 2011 +1200

    Make scripted rewriting of saved traffic work in mitmdump.

diff --git a/libmproxy/dump.py b/libmproxy/dump.py
index 6f544d6a..67f39a06 100644
--- a/libmproxy/dump.py
+++ b/libmproxy/dump.py
@@ -85,15 +85,6 @@ class DumpMaster(flow.FlowMaster):
                 not options.keepserving
             )
 
-        if options.rfile:
-            path = os.path.expanduser(options.rfile)
-            try:
-                f = file(path, "r")
-                freader = flow.FlowReader(f)
-            except IOError, v:
-                raise DumpError(v.strerror)
-            self.load_flows(freader)
-
         if options.client_replay:
             self.start_client_playback(
                 self._readflow(options.client_replay),
@@ -105,6 +96,16 @@ class DumpMaster(flow.FlowMaster):
             if err:
                 raise DumpError(err)
 
+        if options.rfile:
+            path = os.path.expanduser(options.rfile)
+            try:
+                f = file(path, "r")
+                freader = flow.FlowReader(f)
+            except IOError, v:
+                raise DumpError(v.strerror)
+            self.load_flows(freader)
+
+
     def _readflow(self, path):
         path = os.path.expanduser(path)
         try:
