commit 49dedd361c887ee1aae5b40c881d54d00b30e870
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Wed Jun 27 16:22:25 2012 +1200

    Fix replay.

diff --git a/libmproxy/proxy.py b/libmproxy/proxy.py
index 2f38f3af..bbccb713 100644
--- a/libmproxy/proxy.py
+++ b/libmproxy/proxy.py
@@ -57,7 +57,7 @@ class RequestReplayThread(threading.Thread):
                 server.rfile, r.method, self.config.body_size_limit
             )
             response = flow.Response(
-                request, httpversion, code, msg, headers, content, server.cert
+                self.flow.request, httpversion, code, msg, headers, content, server.cert
             )
             response._send(self.masterq)
         except (ProxyError, http.HttpError), v:
