commit f78dada550dac02ea1dc69a7a00fcdfc7a8c996f
Author: Jason A. Novak <janovak@uchicago.edu>
Date:   Sun Apr 21 12:46:37 2013 -0500

    Add error checking to ViewProtobuf
    
    There are protobufs that protoc can't parse.  When protoc --decode_raw
    fails, it returns nothing to stdin, and writes "Failed to parse input."
    to stderr. Before this commit, if protoc --decode_raw couldn't parse
    the protobuf, the blank stdout output would get returned to the view;
    with this commit stderr gets caught and returned to the view.

diff --git a/libmproxy/console/contentview.py b/libmproxy/console/contentview.py
index 53841c73..8dd8ad1d 100644
--- a/libmproxy/console/contentview.py
+++ b/libmproxy/console/contentview.py
@@ -389,8 +389,11 @@ class ViewProtobuf:
                              stdin=subprocess.PIPE,
                              stdout=subprocess.PIPE,
                              stderr=subprocess.PIPE)
-        out, _ = p.communicate(input=content)
-        return out
+        out, err = p.communicate(input=content)
+        if out:
+            return out
+        else:
+            return err
 
     def __call__(self, hdrs, content, limit):
         decoded = self.decode_protobuf(content)
