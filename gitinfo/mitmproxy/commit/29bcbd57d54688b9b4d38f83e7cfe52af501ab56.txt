commit 29bcbd57d54688b9b4d38f83e7cfe52af501ab56
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Sun Jul 28 21:05:17 2013 +0200

    fix #144
    
    netlib wraps IOError in NetLibDisconnect, so we need to cover this as well.

diff --git a/libmproxy/proxy.py b/libmproxy/proxy.py
index df810da5..ae5cd7d3 100644
--- a/libmproxy/proxy.py
+++ b/libmproxy/proxy.py
@@ -85,7 +85,7 @@ class ServerConnection(tcp.TCPClient):
         if self.connection:
             try:
                 self.wfile.flush()
-            except IOError: # pragma: no cover
+            except IOError, tcp.NetLibDisconnect: # pragma: no cover
                 pass
             try:
                 self.connection.close()
