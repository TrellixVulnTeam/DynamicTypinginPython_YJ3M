commit 48f1c9afc2e5d02c8de717e2fc9030a7884d493b
Author: Shadab Zafar <dufferzafar0@gmail.com>
Date:   Fri Mar 4 01:06:09 2016 +0530

    Add a test for json request

diff --git a/test/mitmproxy/test_flow_export.py b/test/mitmproxy/test_flow_export.py
index 2dce3fd6..3dc07427 100644
--- a/test/mitmproxy/test_flow_export.py
+++ b/test/mitmproxy/test_flow_export.py
@@ -1,6 +1,8 @@
+import json
 from textwrap import dedent
 
 import netlib.tutils
+from netlib.http import Headers
 from mitmproxy import flow_export
 from . import tutils
 
@@ -81,6 +83,35 @@ class TestExportPythonCode():
         """).strip()
         assert flow_export.python_code(flow) == result
 
+    def test_post_json(self):
+        req_post.content = '{"name": "example", "email": "example@example.com"}'
+        req_post.headers = Headers(content_type="application/json")
+        flow = tutils.tflow(req=req_post)
+        result = dedent("""
+            import requests
+
+            url = 'http://address/path'
+
+            headers = {
+                'content-type': 'application/json',
+            }
+
+            json = {
+                "name": "example",
+                "email": "example@example.com"
+            }
+
+            response = requests.request(
+                method='POST',
+                url=url,
+                headers=headers,
+                json=json,
+            )
+
+            print(response.text)
+        """).strip()
+        assert flow_export.python_code(flow) == result
+
     def test_patch(self):
         flow = tutils.tflow(req=req_patch)
         result = dedent("""
