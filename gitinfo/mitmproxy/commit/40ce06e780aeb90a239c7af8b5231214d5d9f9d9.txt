commit 40ce06e780aeb90a239c7af8b5231214d5d9f9d9
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Fri Sep 11 01:47:13 2015 +0200

    tls layer: fix early peek

diff --git a/libmproxy/protocol/tls.py b/libmproxy/protocol/tls.py
index 6f6c2c78..1164681c 100644
--- a/libmproxy/protocol/tls.py
+++ b/libmproxy/protocol/tls.py
@@ -412,7 +412,7 @@ class TlsLayer(Layer):
             # but will immediately throw an "unexpected eof" error on the first read.
             # The reason for this might be difficult to find, so we try to peek here to see if it
             # raises ann error.
-            self.client_conn.rfile.peek(0)
+            self.client_conn.rfile.peek(1)
         except NetLibError as e:
             six.reraise(
                 ClientHandshakeException,
