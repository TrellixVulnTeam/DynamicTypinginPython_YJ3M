commit 33be5a72bf1dccd52f087f7759d6bb3650274354
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Tue Jun 26 14:49:40 2012 +1200

    Fixed the WSGI server hang in netlib, remove fudge.

diff --git a/libpathod/pathod.py b/libpathod/pathod.py
index 23558c2f..d4869750 100644
--- a/libpathod/pathod.py
+++ b/libpathod/pathod.py
@@ -7,6 +7,7 @@ class PathodError(Exception): pass
 
 
 class PathodHandler(tcp.BaseHandler):
+    wbufsize = 0
     sni = None
     def handle_sni(self, connection):
         self.sni = connection.get_servername()
@@ -77,11 +78,7 @@ class PathodHandler(tcp.BaseHandler):
                     version.NAMEVERSION
                 )
                 app.serve(req, self.wfile)
-                # FIXME: Tear down the connection. We have some problem with
-                # connection termination that causes some clients (e.g. Chrome)
-                # to hang. It appears to be related to responses that have no
-                # Content-Length header.
-                self.finish()
+                logging.debug("%s: wsgi %s %s"%(self.client_address, method, path))
 
 
 class Pathod(tcp.TCPServer):
diff --git a/test/test_test.py b/test/test_test.py
index dcf980bc..3f0dfd50 100644
--- a/test/test_test.py
+++ b/test/test_test.py
@@ -81,4 +81,3 @@ class TestDaemon:
     def test_anchor(self):
         rsp = self.getpath("anchor/foo")
         assert rsp.status_code == 202
-
