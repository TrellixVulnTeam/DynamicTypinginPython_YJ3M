commit 44dc3a052e724bdf10e9c04e1756db89615f5685
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Sun Feb 6 10:52:54 2011 +1300

    Add option to tell mitmproxy which interfaces to bind to.

diff --git a/libmproxy/console.py b/libmproxy/console.py
index 04e46064..84ef6a5f 100644
--- a/libmproxy/console.py
+++ b/libmproxy/console.py
@@ -632,7 +632,14 @@ class StatusBar(WWrap):
         if self.expire and time.time() > self.expire:
             self.message("")
         status = urwid.Columns([
-            urwid.Text([('title', "mproxy:%s"%self.master.server.port)]),
+            urwid.Text(
+                [
+                    (
+                        'title',
+                        "mitmproxy %s:%s"%(self.master.server.address, self.master.server.port)
+                    )
+                ]
+            ),
             urwid.Text(
                 [
                     self.text,
diff --git a/libmproxy/proxy.py b/libmproxy/proxy.py
index 4c29d747..63f4ceb4 100644
--- a/libmproxy/proxy.py
+++ b/libmproxy/proxy.py
@@ -471,9 +471,9 @@ ServerBase = SocketServer.ThreadingTCPServer
 class ProxyServer(ServerBase):
     request_queue_size = 20
     allow_reuse_address = True
-    def __init__(self, port):
-        self.port = port
-        ServerBase.__init__(self, ('', port), ProxyHandler)
+    def __init__(self, port, address=''):
+        self.port, self.address = port, address
+        ServerBase.__init__(self, (address, port), ProxyHandler)
         self.masterq = None
 
     def set_mqueue(self, q):
diff --git a/mitmproxy b/mitmproxy
index 2fc61a80..7b55b848 100755
--- a/mitmproxy
+++ b/mitmproxy
@@ -23,10 +23,16 @@ from optparse import OptionParser, OptionGroup
 
 if __name__ == '__main__':
     parser = OptionParser(
-                usage = "%prog [options]",
+                usage = "%prog [options] [flowdump path]",
                 version="%%prog %s"%VERSION,
             )
 
+    parser.add_option(
+        "-a", "--addr", action="store",
+        type = "str", dest="addr", default='',
+        help = "Address to bind proxy to (defaults to all interfaces)"
+    )
+
     parser.add_option(
         "-c", "--cert", action="store",
         type = "str", dest="cert", default="~/.mitmproxy/cert.pem",
@@ -76,7 +82,7 @@ if __name__ == '__main__':
     proxy.config = proxy.Config(
         certpath
     )
-    server = proxy.ProxyServer(options.port)
+    server = proxy.ProxyServer(options.port, options.addr)
     m = console.ConsoleMaster(server, options)
 
     for i in args:
