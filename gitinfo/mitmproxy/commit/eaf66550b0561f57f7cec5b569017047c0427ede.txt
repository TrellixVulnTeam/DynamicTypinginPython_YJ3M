commit eaf66550b0561f57f7cec5b569017047c0427ede
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Mon Sep 21 01:08:19 2015 +0200

    always use py.test

diff --git a/.coveragerc b/.coveragerc
index 8076aebe..ccbebf8c 100644
--- a/.coveragerc
+++ b/.coveragerc
@@ -1,3 +1,11 @@
+[run]
+branch = True
+
 [report]
-omit = *contrib*
+show_missing = True
 include = *netlib/netlib*
+exclude_lines =
+    pragma: nocover
+    pragma: no cover
+    raise NotImplementedError()
+omit = *contrib*
diff --git a/.travis.yml b/.travis.yml
index 7835bb64..0f2b1431 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -36,6 +36,7 @@ matrix:
     # We allow pypy to fail until Travis fixes their infrastructure to a pypy
     # with a recent enought CFFI library to run cryptography 1.0+.
     - python: pypy
+    - python: pypy3
 
 install:
   - "pip install --src . -r requirements.txt"
@@ -44,7 +45,7 @@ before_script:
   - "openssl version -a"
 
 script:
-  - "nosetests --with-cov --cov-report term-missing"
+  - "py.test -n 4 --cov netlib"
 
 after_success:
   - coveralls
diff --git a/setup.py b/setup.py
index ac0d36cf..a661e6f7 100644
--- a/setup.py
+++ b/setup.py
@@ -59,6 +59,7 @@ setup(
             "mock>=1.0.1",
             "pytest>=2.8.0",
             "pytest-xdist>=1.13.1",
+            "pytest-cov>=2.1.0",
             "nose>=1.3.0",
             "nose-cov>=1.6",
             "coveralls>=0.4.1",
