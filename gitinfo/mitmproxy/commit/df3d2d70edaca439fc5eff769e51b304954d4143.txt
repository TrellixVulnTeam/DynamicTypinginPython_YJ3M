commit df3d2d70edaca439fc5eff769e51b304954d4143
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Sun Jul 28 18:05:04 2013 +1200

    Terminate can be called on an unconnected server connection.

diff --git a/libmproxy/proxy.py b/libmproxy/proxy.py
index 79025a34..df810da5 100644
--- a/libmproxy/proxy.py
+++ b/libmproxy/proxy.py
@@ -82,14 +82,15 @@ class ServerConnection(tcp.TCPClient):
         self.wfile.flush()
 
     def terminate(self):
-        try:
-            self.wfile.flush()
-        except IOError: # pragma: no cover
-            pass
-        try:
-            self.connection.close()
-        except IOError:
-            pass
+        if self.connection:
+            try:
+                self.wfile.flush()
+            except IOError: # pragma: no cover
+                pass
+            try:
+                self.connection.close()
+            except IOError:
+                pass
 
 
 
