commit c7a85d1b9e69d566f91c93d61b84664cec8d938d
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Thu Apr 28 17:51:53 2016 -0700

    fix #1089

diff --git a/mitmproxy/dump.py b/mitmproxy/dump.py
index 93487b67..636e5a7d 100644
--- a/mitmproxy/dump.py
+++ b/mitmproxy/dump.py
@@ -91,7 +91,8 @@ class DumpMaster(flow.FlowMaster):
         if options.outfile:
             err = self.start_stream_to_path(
                 options.outfile[0],
-                options.outfile[1]
+                options.outfile[1],
+                self.filt
             )
             if err:
                 raise DumpError(err)
diff --git a/mitmproxy/flow.py b/mitmproxy/flow.py
index bb8bf2ea..82e3fa06 100644
--- a/mitmproxy/flow.py
+++ b/mitmproxy/flow.py
@@ -1098,11 +1098,11 @@ class FlowMaster(controller.ServerMaster):
         self.stream.fo.close()
         self.stream = None
 
-    def start_stream_to_path(self, path, mode="wb"):
+    def start_stream_to_path(self, path, mode="wb", filt=None):
         path = os.path.expanduser(path)
         try:
-            f = file(path, mode)
-            self.start_stream(f, None)
+            f = open(path, mode)
+            self.start_stream(f, filt)
         except IOError as v:
             return str(v)
         self.stream_path = path
