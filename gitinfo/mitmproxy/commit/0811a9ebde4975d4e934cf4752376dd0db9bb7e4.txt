commit 0811a9ebde4975d4e934cf4752376dd0db9bb7e4
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Fri Nov 7 16:01:41 2014 +1300

    .flush can raise NetlibDisconnect. This fixes a traceback found in fuzzing.

diff --git a/netlib/tcp.py b/netlib/tcp.py
index 46c28cd9..6b7540aa 100644
--- a/netlib/tcp.py
+++ b/netlib/tcp.py
@@ -253,7 +253,10 @@ class _Connection(object):
         # Closing the socket is not our task, therefore we don't call close then.
         if type(self.connection) != SSL.Connection:
             if not getattr(self.wfile, "closed", False):
-                self.wfile.flush()
+                try:
+                    self.wfile.flush()
+                except NetLibDisconnect:
+                    pass
 
             self.wfile.close()
             self.rfile.close()
