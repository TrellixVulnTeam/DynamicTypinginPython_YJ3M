commit b007ff3f9b00165bd87c18292d8b23d4acc83ab9
Author: Thomas Kriechbaumer <thomas@kriechbaumer.name>
Date:   Mon Feb 1 23:27:37 2016 +0100

    fix locking issues

diff --git a/libmproxy/protocol/http2.py b/libmproxy/protocol/http2.py
index 4b582f51..4b3ef0ed 100644
--- a/libmproxy/protocol/http2.py
+++ b/libmproxy/protocol/http2.py
@@ -72,6 +72,7 @@ class SafeH2Connection(H2Connection):
             while position < len(chunk):
                 self.lock.acquire()
                 if is_zombie(self, stream_id):
+                    self.lock.release()
                     return
                 max_outbound_frame_size = self.max_outbound_frame_size
                 frame_chunk = chunk[position:position + max_outbound_frame_size]
