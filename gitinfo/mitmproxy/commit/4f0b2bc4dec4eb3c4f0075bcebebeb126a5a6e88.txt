commit 4f0b2bc4dec4eb3c4f0075bcebebeb126a5a6e88
Author: Thomas Kriechbaumer <thomas@kriechbaumer.name>
Date:   Thu Feb 2 14:20:56 2017 +0100

    adapt coverage checks

diff --git a/test/conftest.py b/test/conftest.py
index ef262944..c44aa461 100644
--- a/test/conftest.py
+++ b/test/conftest.py
@@ -116,7 +116,7 @@ def pytest_runtestloop(session):
     prefix = os.getcwd()
     excluded_files = [os.path.normpath(f) for f in pytest.config.option.no_full_cov]
     measured_files = [os.path.normpath(os.path.relpath(f, prefix)) for f in cov.get_data().measured_files()]
-    measured_files = [f for f in measured_files if f not in excluded_files]
+    measured_files = [f for f in measured_files if not any(f.startswith(excluded_f) for excluded_f in excluded_files)]
 
     for name in pytest.config.option.full_cov:
         files = [f for f in measured_files if f.startswith(os.path.normpath(name))]
diff --git a/tox.ini b/tox.ini
index 26136084..16f4d664 100644
--- a/tox.ini
+++ b/tox.ini
@@ -14,14 +14,10 @@ commands =
   pytest --timeout 60 --cov-report='' --cov=mitmproxy --cov=pathod \
     --full-cov=mitmproxy/addons/ \
     --full-cov=mitmproxy/contentviews/ --no-full-cov=mitmproxy/contentviews/__init__.py --no-full-cov=mitmproxy/contentviews/protobuf.py --no-full-cov=mitmproxy/contentviews/wbxml.py --no-full-cov=mitmproxy/contentviews/xml_html.py \
-    --full-cov=mitmproxy/net/http/ --no-full-cov=mitmproxy/net/http/cookies.py --no-full-cov=mitmproxy/net/http/encoding.py --no-full-cov=mitmproxy/net/http/message.py --no-full-cov=mitmproxy/net/http/request.py --no-full-cov=mitmproxy/net/http/response.py --no-full-cov=mitmproxy/net/http/url.py \
-    --full-cov=mitmproxy/net/websockets/ \
-    --full-cov=mitmproxy/net/wsgi.py \
-    --full-cov=mitmproxy/proxy/__init__.py \
-    --full-cov=mitmproxy/proxy/modes/ --no-full-cov=mitmproxy/proxy/modes/socks_proxy.py \
-    --full-cov=mitmproxy/proxy/protocol/__init__.py \
+    --full-cov=mitmproxy/net/ --no-full-cov=mitmproxy/net/check.py --no-full-cov=mitmproxy/net/socks.py --no-full-cov=mitmproxy/net/tcp.py --no-full-cov=mitmproxy/net/http/cookies.py --no-full-cov=mitmproxy/net/http/encoding.py --no-full-cov=mitmproxy/net/http/message.py --no-full-cov=mitmproxy/net/http/request.py --no-full-cov=mitmproxy/net/http/response.py --no-full-cov=mitmproxy/net/http/url.py \
+    --full-cov=mitmproxy/proxy/ --no-full-cov=mitmproxy/proxy/protocol/ --no-full-cov=mitmproxy/proxy/modes/socks_proxy.py --no-full-cov=mitmproxy/proxy/config.py --no-full-cov=mitmproxy/proxy/root_context.py --no-full-cov=mitmproxy/proxy/server.py \
     --full-cov=mitmproxy/script/ \
-    --full-cov=mitmproxy/test/ --no-full-cov=mitmproxy/test/tutils.py \
+    --full-cov=mitmproxy/test/ \
     --full-cov=mitmproxy/types/ --no-full-cov=mitmproxy/types/basethread.py \
     --full-cov=mitmproxy/utils/ \
     --full-cov=mitmproxy/__init__.py \
