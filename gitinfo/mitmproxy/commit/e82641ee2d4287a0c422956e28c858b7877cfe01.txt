commit e82641ee2d4287a0c422956e28c858b7877cfe01
Author: kira0204 <rshtmudgal@gmail.com>
Date:   Thu Feb 15 08:40:54 2018 +0530

    fix 2794

diff --git a/mitmproxy/net/http/request.py b/mitmproxy/net/http/request.py
index 6b4041f6..9eb98946 100644
--- a/mitmproxy/net/http/request.py
+++ b/mitmproxy/net/http/request.py
@@ -441,7 +441,7 @@ class Request(message.Message):
         This will overwrite the existing content if there is one.
         """
         self.headers["content-type"] = "application/x-www-form-urlencoded"
-        self.content = mitmproxy.net.http.url.encode(form_data, self.content.decode()).encode()
+        self.content = mitmproxy.net.http.url.encode(form_data, self.get_text(strict=False)).encode()
 
     @property
     def urlencoded_form(self):
