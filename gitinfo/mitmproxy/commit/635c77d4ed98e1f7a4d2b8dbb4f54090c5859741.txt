commit 635c77d4ed98e1f7a4d2b8dbb4f54090c5859741
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Fri Oct 21 09:25:34 2016 +1300

    console: correct log event handling i
    
    Fixes #1640

diff --git a/mitmproxy/tools/console/master.py b/mitmproxy/tools/console/master.py
index af43c53b..909c83da 100644
--- a/mitmproxy/tools/console/master.py
+++ b/mitmproxy/tools/console/master.py
@@ -283,9 +283,6 @@ class ConsoleMaster(master.Master):
             self.logbuffer.pop(0)
         self.logbuffer.set_focus(len(self.logbuffer) - 1)
 
-    def add_log(self, e, level):
-        signals.add_log(e, level)
-
     def sig_call_in(self, sender, seconds, callback, args=()):
         def cb(*_):
             return callback(*args)
@@ -702,3 +699,7 @@ class ConsoleMaster(master.Master):
             direction=direction,
         ), "info")
         self.add_log(strutils.bytes_to_escaped_str(message.content), "debug")
+
+    @controller.handler
+    def log(self, evt):
+        signals.add_log(evt.msg, evt.level)
