commit 9cba4f8d397d212f60ffc52f02dabf97b126e540
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Thu May 15 14:16:05 2014 +0200

    fix #267

diff --git a/libmproxy/script.py b/libmproxy/script.py
index b17766e8..90d37264 100644
--- a/libmproxy/script.py
+++ b/libmproxy/script.py
@@ -106,9 +106,11 @@ class Script:
 def _handle_concurrent_reply(fn, o, args=[], kwargs={}):
     reply = o.reply
     o.reply = controller.DummyReply()
+    if hasattr(reply, "q"):
+        o.reply.q = reply.q
     def run():
         fn(*args, **kwargs)
-        reply(o)
+        reply()
     threading.Thread(target=run, name="ScriptThread").start()
 
 
