commit a325ae638b07a8a08018403e57c05ab8d4119161
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Tue Nov 11 13:09:05 2014 +0100

    fix tests

diff --git a/libmproxy/flow.py b/libmproxy/flow.py
index 1826af3d..3d5a6a36 100644
--- a/libmproxy/flow.py
+++ b/libmproxy/flow.py
@@ -191,7 +191,7 @@ class ClientPlaybackState:
             testing: Disables actual replay for testing.
         """
         if self.flows and not self.current:
-            n = self.flows.pop(0)
+            n = self.flows.pop(0).copy()
             n.response = None
             n.reply = controller.DummyReply()
             self.current = master.handle_request(n)
diff --git a/test/test_flow.py b/test/test_flow.py
index 6ed279c2..8c197153 100644
--- a/test/test_flow.py
+++ b/test/test_flow.py
@@ -692,7 +692,8 @@ class TestFlowMaster:
 
         f = tutils.tflow(resp=True)
         pb = [tutils.tflow(resp=True), f]
-        fm = flow.FlowMaster(None, s)
+
+        fm = flow.FlowMaster(DummyServer(ProxyConfig()), s)
         assert not fm.start_server_playback(pb, False, [], False, False, None, False)
         assert not fm.start_client_playback(pb, False)
 
