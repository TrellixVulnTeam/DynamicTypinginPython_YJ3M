commit f8c5fb3d15e555f2c2b9b2bd934cb25f9dfb85a4
Author: Matt Weidner <matt.weidner@gmail.com>
Date:   Fri Jul 21 13:34:58 2017 -0500

    Extended intercept tests to include toggle feature

diff --git a/test/mitmproxy/addons/test_intercept.py b/test/mitmproxy/addons/test_intercept.py
index f436a817..d4999eb5 100644
--- a/test/mitmproxy/addons/test_intercept.py
+++ b/test/mitmproxy/addons/test_intercept.py
@@ -13,10 +13,12 @@ def test_simple():
         assert not r.filt
         tctx.configure(r, intercept="~q")
         assert r.filt
+        assert tctx.options.intercept_active
         with pytest.raises(exceptions.OptionsError):
             tctx.configure(r, intercept="~~")
         tctx.configure(r, intercept=None)
         assert not r.filt
+        assert not tctx.options.intercept_active
 
         tctx.configure(r, intercept="~s")
 
@@ -31,3 +33,13 @@ def test_simple():
         f = tflow.tflow(resp=True)
         r.response(f)
         assert f.intercepted
+
+        tctx.configure(r, intercept_active=False)
+        f = tflow.tflow(resp=True)
+        tctx.cycle(r, f)
+        assert not f.intercepted
+
+        tctx.configure(r, intercept_active=True)
+        f = tflow.tflow(resp=True)
+        tctx.cycle(r, f)
+        assert f.intercepted
