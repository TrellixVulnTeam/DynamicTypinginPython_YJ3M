commit fdf0d9974e3216142c27d888d0eb7fdf1e832d73
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Thu May 24 22:58:33 2018 +1200

    cibuild: more accurate PR test, better dump output

diff --git a/release/cibuild.py b/release/cibuild.py
index 9d99d8d9..37381527 100755
--- a/release/cibuild.py
+++ b/release/cibuild.py
@@ -210,16 +210,25 @@ class BuildEnviron:
         return False
 
     def dump_info(self, fp=sys.stdout):
-        print("BUILD PLATFORM_TAG=%s" % self.platform_tag, file=fp)
-        print("BUILD ROOT_DIR=%s" % self.root_dir, file=fp)
-        print("BUILD RELEASE_DIR=%s" % self.release_dir, file=fp)
-        print("BUILD BUILD_DIR=%s" % self.build_dir, file=fp)
-        print("BUILD DIST_DIR=%s" % self.dist_dir, file=fp)
-        print("BUILD BDISTS=%s" % self.bdists, file=fp)
-        print("BUILD TAG=%s" % self.tag, file=fp)
-        print("BUILD BRANCH=%s" % self.branch, file=fp)
-        print("BUILD VERSION=%s" % self.version, file=fp)
-        print("BUILD UPLOAD_DIR=%s" % self.upload_dir, file=fp)
+        lst = [
+            "version",
+            "tag",
+            "branch",
+            "platform_tag",
+            "root_dir",
+            "release_dir",
+            "build_dir",
+            "dist_dir",
+            "bdists",
+            "upload_dir",
+            "should_build_wheel",
+            "should_build_pyinstaller",
+            "should_build_docker",
+            "should_upload_docker",
+            "should_upload_pypi",
+        ]
+        for attr in lst:
+            print("cibuild.%s=%s" % (attr, getattr(self, attr)), file=fp)
 
 
 def build_wheel(be: BuildEnviron):  # pragma: no cover
diff --git a/test/release/test_cibuild.py b/test/release/test_cibuild.py
index 2b469d1b..71395c6d 100644
--- a/test/release/test_cibuild.py
+++ b/test/release/test_cibuild.py
@@ -43,8 +43,8 @@ def test_buildenviron_pr():
     # Simulates a PR. We build everything, but don't have access to secret
     # credential env variables.
     be = cibuild.BuildEnviron(
-        travis_tag = "v0.0.1",
-        travis_branch = "v0.x",
+        travis_tag = "",
+        travis_branch = "master",
         travis_pull_request = "true",
 
         should_build_wheel = True,
