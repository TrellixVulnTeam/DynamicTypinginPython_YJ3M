commit b92980efeca831c879c969e673cd60f93d0e3ace
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Sun Dec 11 15:26:49 2016 +0100

    [web] show proxy address, add websocket toggle

diff --git a/.gitattributes b/.gitattributes
index 3ecf8f08..dd08ee53 100644
--- a/.gitattributes
+++ b/.gitattributes
@@ -1,2 +1,2 @@
-mitmproxy/web/static/**/* -diff
+mitmproxy/tools/web/static/**/* -diff
 web/src/js/filt/filt.js -diff
diff --git a/mitmproxy/tools/web/app.py b/mitmproxy/tools/web/app.py
index f617bd08..ed95f536 100644
--- a/mitmproxy/tools/web/app.py
+++ b/mitmproxy/tools/web/app.py
@@ -376,19 +376,22 @@ class Settings(RequestHandler):
             no_upstream_cert=self.master.options.no_upstream_cert,
             rawtcp=self.master.options.rawtcp,
             http2=self.master.options.http2,
+            websocket=self.master.options.websocket,
             anticache=self.master.options.anticache,
             anticomp=self.master.options.anticomp,
             stickyauth=self.master.options.stickyauth,
             stickycookie=self.master.options.stickycookie,
             stream=self.master.options.stream_large_bodies,
-            contentViews=[v.name.replace(' ', '_') for v in contentviews.views]
+            contentViews=[v.name.replace(' ', '_') for v in contentviews.views],
+            listen_host=self.master.options.listen_host,
+            listen_port=self.master.options.listen_port,
         ))
 
     def put(self):
         update = self.json
         option_whitelist = {
             "intercept", "showhost", "no_upstream_cert",
-            "rawtcp", "http2", "anticache", "anticomp",
+            "rawtcp", "http2", "websocket", "anticache", "anticomp",
             "stickycookie", "stickyauth", "stream_large_bodies"
         }
         for k in update:
diff --git a/mitmproxy/tools/web/master.py b/mitmproxy/tools/web/master.py
index edb12467..22cc156f 100644
--- a/mitmproxy/tools/web/master.py
+++ b/mitmproxy/tools/web/master.py
@@ -10,6 +10,7 @@ from mitmproxy.addons import eventstore
 from mitmproxy.addons import intercept
 from mitmproxy.addons import termlog
 from mitmproxy.addons import view
+from mitmproxy.options import Options  # noqa
 from mitmproxy.tools.web import app
 
 
diff --git a/mitmproxy/tools/web/static/app.css b/mitmproxy/tools/web/static/app.css
index cc3f1182..6799d23e 100644
Binary files a/mitmproxy/tools/web/static/app.css and b/mitmproxy/tools/web/static/app.css differ
diff --git a/mitmproxy/tools/web/static/app.js b/mitmproxy/tools/web/static/app.js
index 3c7efa08..7e3a7ea8 100644
Binary files a/mitmproxy/tools/web/static/app.js and b/mitmproxy/tools/web/static/app.js differ
diff --git a/mitmproxy/tools/web/static/vendor.js b/mitmproxy/tools/web/static/vendor.js
index 4d3c1ce2..39361c78 100644
Binary files a/mitmproxy/tools/web/static/vendor.js and b/mitmproxy/tools/web/static/vendor.js differ
diff --git a/web/src/js/components/Footer.jsx b/web/src/js/components/Footer.jsx
index 1ae4ee73..ee26dad2 100644
--- a/web/src/js/components/Footer.jsx
+++ b/web/src/js/components/Footer.jsx
@@ -7,7 +7,8 @@ Footer.propTypes = {
 }
 
 function Footer({ settings }) {
-    let {mode, intercept, showhost, no_upstream_cert, rawtcp, http2, anticache, anticomp, stickyauth, stickycookie, stream_large_bodies} = settings;
+    let {mode, intercept, showhost, no_upstream_cert, rawtcp, http2, websocket, anticache, anticomp,
+            stickyauth, stickycookie, stream_large_bodies, listen_host, listen_port} = settings;
     return (
         <footer>
             {mode && mode != "regular" && (
@@ -25,8 +26,11 @@ function Footer({ settings }) {
             {rawtcp && (
                 <span className="label label-success">raw-tcp</span>
             )}
-            {!http2 && (
-                <span className="label label-success">no-http2</span>
+            {http2 && (
+                <span className="label label-success">http2</span>
+            )}
+            {!websocket && (
+                <span className="label label-success">no-websocket</span>
             )}
             {anticache && (
                 <span className="label label-success">anticache</span>
@@ -43,6 +47,11 @@ function Footer({ settings }) {
             {stream_large_bodies && (
                 <span className="label label-success">stream: {formatSize(stream_large_bodies)}</span>
             )}
+            <div className="pull-right">
+            <span className="label label-primary" title="HTTP Proxy Server Address">
+            [{listen_host || "*"}:{listen_port}]
+            </span>
+            </div>
         </footer>
     )
 }
diff --git a/web/src/js/components/Header/OptionMenu.jsx b/web/src/js/components/Header/OptionMenu.jsx
index 186a9c6a..f1d19f48 100644
--- a/web/src/js/components/Header/OptionMenu.jsx
+++ b/web/src/js/components/Header/OptionMenu.jsx
@@ -31,6 +31,10 @@ function OptionMenu({ settings, updateSettings }) {
                     checked={settings.http2}
                     onToggle={() => updateSettings({ http2: !settings.http2 })}
                 />
+                <ToggleButton text="websocket"
+                    checked={settings.websocket}
+                    onToggle={() => updateSettings({ websocket: !settings.websocket })}
+                />
                 <ToggleButton text="anticache"
                     checked={settings.anticache}
                     onToggle={() => updateSettings({ anticache: !settings.anticache })}
