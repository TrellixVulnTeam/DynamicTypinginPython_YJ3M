commit b1ec7e78cdb3bb0432667d7a029cfe00f07a3b11
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Fri Jan 6 00:58:29 2017 +0100

    Revert "add strutils.replace_surrogates"
    
    This reverts commit 15ae88db08dbf2725c8c9f945f2006c4b2a10d46.

diff --git a/mitmproxy/utils/strutils.py b/mitmproxy/utils/strutils.py
index 9c5e6bc8..29465615 100644
--- a/mitmproxy/utils/strutils.py
+++ b/mitmproxy/utils/strutils.py
@@ -25,17 +25,6 @@ def always_str(str_or_bytes: Optional[AnyStr], *decode_args) -> Optional[str]:
         raise TypeError("Expected str or bytes, but got {}.".format(type(str_or_bytes).__name__))
 
 
-def replace_surrogates(text: str, errors='replace') -> str:
-    """Convert surrogates to replacement characters (e.g., "\udc80" becomes "�")
-    by applying a different error handler.
-
-    Uses the "replace" error handler by default, but any input
-    error handler may be specified.
-
-    For an introduction to surrogateescape, see https://www.python.org/dev/peps/pep-0383/.
-    """
-    return text.encode('utf-8', 'surrogateescape').decode('utf-8', errors)
-
 # Translate control characters to "safe" characters. This implementation initially
 # replaced them with the matching control pictures (http://unicode.org/charts/PDF/U2400.pdf),
 # but that turned out to render badly with monospace fonts. We are back to "." therefore.
diff --git a/test/mitmproxy/utils/test_strutils.py b/test/mitmproxy/utils/test_strutils.py
index 1fb4949f..1372d31f 100644
--- a/test/mitmproxy/utils/test_strutils.py
+++ b/test/mitmproxy/utils/test_strutils.py
@@ -19,11 +19,6 @@ def test_always_str():
     assert strutils.always_str(None) is None
 
 
-def test_replace_surrogates():
-    assert strutils.replace_surrogates("foo") == "foo"
-    assert strutils.replace_surrogates("bar \udc80 baz") == "bar � baz"
-
-
 def test_escape_control_characters():
     assert strutils.escape_control_characters(u"one") == u"one"
     assert strutils.escape_control_characters(u"\00ne") == u".ne"
