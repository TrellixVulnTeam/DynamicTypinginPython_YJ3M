commit da3e7c0187e7baaf94359ae428461787df52c19f
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Tue Aug 12 02:55:32 2014 +0200

    do not connect if inline script already connected to upstream server

diff --git a/libmproxy/proxy/server.py b/libmproxy/proxy/server.py
index d4a97e6a..02b86d71 100644
--- a/libmproxy/proxy/server.py
+++ b/libmproxy/proxy/server.py
@@ -85,7 +85,7 @@ class ConnectionHandler:
             self.determine_conntype()
             self.channel.ask("clientconnect", self)
 
-            if self.server_conn:
+            if self.server_conn and not self.server_conn.connection:
                 self.establish_server_connection()
                 if client_ssl or server_ssl:
                     self.establish_ssl(client=client_ssl, server=server_ssl)
