commit 7769e5a898150451a52b5683c519ee04802310b8
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Thu Feb 17 15:56:54 2011 +1300

    Whitespace in mitmdump output.

diff --git a/libmproxy/dump.py b/libmproxy/dump.py
index 3ef12a04..6b8c886d 100644
--- a/libmproxy/dump.py
+++ b/libmproxy/dump.py
@@ -58,19 +58,20 @@ class DumpMaster(flow.FlowMaster):
             msg.ack()
             if self.filt and not f.match(self.filt):
                     return
+            sz = utils.pretty_size(len(f.response.content))
             if self.o.verbosity == 1:
                 print >> self.outfile, f.client_conn.address[0],
                 print >> self.outfile, f.request.short()
                 print >> self.outfile, "  <<",
-                print >> self.outfile, f.response.short(), utils.pretty_size(len(f.response.content))
+                print >> self.outfile, f.response.short(), sz
             elif self.o.verbosity == 2:
                 print >> self.outfile, f.client_conn.address[0],
                 print >> self.outfile, f.request.short()
                 print >> self.outfile, self.indent(4, f.request.headers)
                 print >> self.outfile
-                print >> self.outfile, " <<", f.response.short()
+                print >> self.outfile, " <<", f.response.short(), sz
                 print >> self.outfile, self.indent(4, f.response.headers)
-                print >> self.outfile, "\n\n"
+                print >> self.outfile, "\n"
             elif self.o.verbosity == 3:
                 print >> self.outfile, f.client_conn.address[0],
                 print >> self.outfile, f.request.short()
@@ -80,13 +81,13 @@ class DumpMaster(flow.FlowMaster):
                 elif f.request.content:
                     print >> self.outfile, self.indent(4, f.request.content)
                 print >> self.outfile
-                print >> self.outfile, " <<", f.response.short()
+                print >> self.outfile, " <<", f.response.short(), sz
                 print >> self.outfile, self.indent(4, f.response.headers)
                 if utils.isBin(f.response.content):
                     print >> self.outfile, self.indent(4, utils.hexdump(f.response.content))
                 elif f.response.content:
                     print >> self.outfile, self.indent(4, f.response.content)
-                print >> self.outfile, "\n\n"
+                print >> self.outfile, "\n"
             self.state.delete_flow(f)
             if self.o.wfile:
                 self.fwriter.add(f)
diff --git a/libmproxy/script.py b/libmproxy/script.py
index 5693f5e5..897ebb72 100644
--- a/libmproxy/script.py
+++ b/libmproxy/script.py
@@ -6,7 +6,6 @@
     simple.
 """
 import sys, base64
-from contrib import bson
 import flow
 
 
