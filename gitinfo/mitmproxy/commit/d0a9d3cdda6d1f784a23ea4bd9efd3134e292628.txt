commit d0a9d3cdda6d1f784a23ea4bd9efd3134e292628
Author: Thomas Kriechbaumer <thomas@kriechbaumer.name>
Date:   Mon Jun 15 14:21:34 2015 +0200

    http2: only first headers frame as END_STREAM flag

diff --git a/netlib/http2/protocol.py b/netlib/http2/protocol.py
index 24fcb712..682b7863 100644
--- a/netlib/http2/protocol.py
+++ b/netlib/http2/protocol.py
@@ -196,9 +196,9 @@ class HTTP2Protocol(object):
             if isinstance(frm, frame.HeadersFrame)\
                     or isinstance(frm, frame.ContinuationFrame):
                 header_block_fragment += frm.header_block_fragment
+                if frm.flags & frame.Frame.FLAG_END_STREAM:
+                    body_expected = False
                 if frm.flags & frame.Frame.FLAG_END_HEADERS:
-                    if frm.flags & frame.Frame.FLAG_END_STREAM:
-                        body_expected = False
                     break
 
         while body_expected:
