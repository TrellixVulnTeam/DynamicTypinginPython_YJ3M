commit d7f43e72ca643ac16e48f58d511cd2a4e6043b88
Author: Yoann Lamouroux <ylamouroux@vente-privee.com>
Date:   Fri Jan 10 18:10:24 2020 +0100

    fix: ValueError: math domain error" in table mode when displaying a server replay flow #3778

diff --git a/mitmproxy/tools/console/common.py b/mitmproxy/tools/console/common.py
index 325c5740..3dce8363 100644
--- a/mitmproxy/tools/console/common.py
+++ b/mitmproxy/tools/console/common.py
@@ -543,7 +543,7 @@ def format_flow(f, focus, extended=False, hostheader=False, cols=False, layout='
 
         duration = None
         if f.response.timestamp_end and f.request.timestamp_start:
-            duration = f.response.timestamp_end - f.request.timestamp_start
+            duration = max([f.response.timestamp_end - f.request.timestamp_start, 0])
 
         d.update(dict(
             resp_code=f.response.status_code,
