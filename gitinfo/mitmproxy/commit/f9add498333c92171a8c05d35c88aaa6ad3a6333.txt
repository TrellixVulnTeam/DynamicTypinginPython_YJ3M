commit f9add498333c92171a8c05d35c88aaa6ad3a6333
Author: Vincent Haupert <vincent.haupert@cs.fau.de>
Date:   Mon Oct 31 23:44:37 2016 +0100

    Only raise exception if an error occurred.

diff --git a/mitmproxy/addons/wsgiapp.py b/mitmproxy/addons/wsgiapp.py
index 85d09a0a..c37fcb7b 100644
--- a/mitmproxy/addons/wsgiapp.py
+++ b/mitmproxy/addons/wsgiapp.py
@@ -30,8 +30,8 @@ class WSGIApp:
         )
         if err:
             ctx.log.error("Error in wsgi app. %s" % err)
+            raise exceptions.AddonHalt()
         flow.reply.kill()
-        raise exceptions.AddonHalt()
 
     def request(self, f):
         if (f.request.pretty_host, f.request.port) == (self.host, self.port):
