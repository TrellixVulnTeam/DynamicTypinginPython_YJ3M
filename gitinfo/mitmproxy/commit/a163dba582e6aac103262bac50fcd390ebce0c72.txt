commit a163dba582e6aac103262bac50fcd390ebce0c72
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Sat Sep 26 00:40:01 2015 +0200

    adjust to netlib request model changes

diff --git a/libpathod/pathoc.py b/libpathod/pathoc.py
index 2dcb6082..4bfe7c7d 100644
--- a/libpathod/pathoc.py
+++ b/libpathod/pathoc.py
@@ -410,7 +410,7 @@ class Pathoc(tcp.TCPClient):
                 req = language.serve(r, self.wfile, self.settings)
                 self.wfile.flush()
 
-                resp = self.protocol.read_response(self.rfile, treq(method=req["method"]))
+                resp = self.protocol.read_response(self.rfile, treq(method=req["method"].encode()))
                 resp.sslinfo = self.sslinfo
             except HttpException as v:
                 lg("Invalid server response: %s" % v)
diff --git a/test/test_pathod.py b/test/test_pathod.py
index 1da2633f..f8c45ad8 100644
--- a/test/test_pathod.py
+++ b/test/test_pathod.py
@@ -228,6 +228,7 @@ class CommonTests(tutils.DaemonTests):
             ws_read_limit=1,
             timeout=1
         )
+        # FIXME: Race Condition?
         assert "Parse error" in self.d.text_log()
 
     def test_websocket_frame_disconnect_error(self):
