commit 8352c0278f468be30a9765a61f369ceb317aafe9
Author: Aldo Cortesi <aldo@nullcube.com>
Date:   Mon Jun 25 11:34:29 2012 +1200

    Handle client close more gracefully.

diff --git a/libpathod/pathod.py b/libpathod/pathod.py
index 3d0f73e3..db7f37f1 100644
--- a/libpathod/pathod.py
+++ b/libpathod/pathod.py
@@ -14,7 +14,7 @@ class PathodHandler(tcp.BaseHandler):
                 self.server.ssloptions["keyfile"],
             )
 
-        while 1:
+        while not self.finished:
             line = self.rfile.readline()
             if line == "\r\n" or line == "\n": # Possible leftover from previous message
                 line = self.rfile.readline()
