commit 8ebcf8ec9647842bfd48e9c890109d2399621a4d
Author: Maximilian Hils <git@maximilianhils.com>
Date:   Tue May 29 13:25:38 2018 +0200

    fix IPv6 addresses with scope

diff --git a/mitmproxy/platform/windows.py b/mitmproxy/platform/windows.py
index f83bfc45..7e4b48fe 100644
--- a/mitmproxy/platform/windows.py
+++ b/mitmproxy/platform/windows.py
@@ -59,6 +59,7 @@ class Resolver:
     def original_addr(self, csock: socket.socket):
         ip, port = csock.getpeername()[:2]
         ip = re.sub("^::ffff:(?=\d+.\d+.\d+.\d+$)", "", ip)
+        ip = ip.split("%", 1)[0]
         with self.lock:
             try:
                 write((ip, port), self.wfile)
