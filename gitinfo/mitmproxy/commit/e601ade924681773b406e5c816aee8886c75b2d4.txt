commit e601ade924681773b406e5c816aee8886c75b2d4
Author: Zack B <zbrdge@gmail.com>
Date:   Tue Jul 1 15:08:42 2014 -0700

    only support FreeBSD 10+

diff --git a/libmproxy/platform/__init__.py b/libmproxy/platform/__init__.py
index 79f2f5df..7f570133 100644
--- a/libmproxy/platform/__init__.py
+++ b/libmproxy/platform/__init__.py
@@ -7,6 +7,6 @@ if sys.platform == "linux2":
 elif sys.platform == "darwin":
     import osx
     resolver = osx.Resolver
-elif "freebsd" in sys.platform:
+elif sys.platform == "freebsd10":
     import osx
     resolver = osx.Resolver
diff --git a/libmproxy/platform/pf.py b/libmproxy/platform/pf.py
index 32529e59..dc0f6104 100644
--- a/libmproxy/platform/pf.py
+++ b/libmproxy/platform/pf.py
@@ -12,7 +12,7 @@ def lookup(address, port, s):
         if "ESTABLISHED:ESTABLISHED" in i and spec in i:
             s = i.split()
             if len(s) > 4:
-                if "freebsd" in sys.platform:
+                if sys.platform == "freebsd10":
                     # strip parentheses for FreeBSD pfctl
                     s = s[3][1:-1].split(":")
                 else:
