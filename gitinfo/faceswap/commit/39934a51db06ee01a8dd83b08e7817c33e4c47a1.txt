commit 39934a51db06ee01a8dd83b08e7817c33e4c47a1
Author: torzdf <36920800+torzdf@users.noreply.github.com>
Date:   Thu Mar 14 11:47:20 2019 +0000

    effmpeg - gen-vid filename bugfix

diff --git a/lib/gui/wrapper.py b/lib/gui/wrapper.py
index 7c966a0..321c1be 100644
--- a/lib/gui/wrapper.py
+++ b/lib/gui/wrapper.py
@@ -140,7 +140,7 @@ class FaceswapControl():
             "loss": re.compile(r"([a-zA-Z_]+):.*?(\d+\.\d+)"),
             "tqdm": re.compile(r".*?(?P<pct>\d+%).*?(?P<itm>\d+/\d+)\W\["
                                r"(?P<tme>\d+:\d+<.*),\W(?P<rte>.*)[a-zA-Z/]*\]"),
-            "ffmpeg": re.compile(r"([a-zA-Z]+)=\s*([\d|N/A]\S+)")}
+            "ffmpeg": re.compile(r"([a-zA-Z]+)=\s*(-?[\d|N/A]\S+)")}
         logger.debug("Initialized %s", self.__class__.__name__)
 
     def execute_script(self, command, args):
diff --git a/tools/effmpeg.py b/tools/effmpeg.py
index 1a36db4..d7f81e6 100644
--- a/tools/effmpeg.py
+++ b/tools/effmpeg.py
@@ -547,11 +547,10 @@ class Effmpeg():
                 filename = file
                 break
         logger.debug("sample filename: '%s'", filename)
-        filename = filename.split('.')
-        img_ext = filename[-1]
-        zero_pad = Effmpeg.__get_zero_pad(filename[-2])
-        name = filename[-2][:-zero_pad]
-        retval = "{}%{}d.{}".format(name, zero_pad, img_ext)
+        filename, img_ext = os.path.splitext(filename)
+        zero_pad = Effmpeg.__get_zero_pad(filename)
+        name = filename[:-zero_pad]
+        retval = "{}%{}d{}".format(name, zero_pad, img_ext)
         logger.debug("filename: %s, img_ext: '%s', zero_pad: %s, name: '%s'",
                      filename, img_ext, zero_pad, name)
         logger.debug(retval)
@@ -561,6 +560,7 @@ class Effmpeg():
     def __get_zero_pad(filename):
         """ Return the starting position of zero padding from a filename """
         chkstring = filename[::-1]
+        logger.trace("filename: %s, chkstring: %s", filename, chkstring)
         pos = 0
         for pos in range(len(chkstring)):
             if not chkstring[pos].isdigit():
