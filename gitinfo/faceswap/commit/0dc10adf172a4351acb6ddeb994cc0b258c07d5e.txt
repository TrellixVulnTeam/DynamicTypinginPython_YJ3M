commit 0dc10adf172a4351acb6ddeb994cc0b258c07d5e
Author: Gareth Dunstone <freedom.2.the.leetle.people@gmail.com>
Date:   Mon Feb 12 12:49:49 2018 +1100

    Skip images that arent in the alignments.json

diff --git a/lib/cli.py b/lib/cli.py
index e13b933..c00f5af 100644
--- a/lib/cli.py
+++ b/lib/cli.py
@@ -98,6 +98,10 @@ class DirectoryProcessor(object):
     def have_face(self, filename):
         return filename in self.faces_detected
 
+    def have_alignments(self):
+        fn = os.path.join(str(self.arguments.input_dir), "alignments.{}".format(self.serializer.ext))
+        return os.path.exists(fn)
+
     def get_faces_alignments(self, filename, image):
         faces_count = 0
         faces = self.faces_detected[os.path.basename(filename)]
diff --git a/scripts/convert.py b/scripts/convert.py
index 0f19018..aaa6bbd 100644
--- a/scripts/convert.py
+++ b/scripts/convert.py
@@ -183,11 +183,16 @@ class ConvertImage(DirectoryProcessor):
 
     def prepare_images(self):
         self.read_alignments()
+        is_have_alignments = self.have_alignments()
         for filename in tqdm(self.read_directory()):
             image = cv2.imread(filename)
 
-            if self.have_face(filename):
-                faces = self.get_faces_alignments(filename, image)
+            if is_have_alignments:
+                if self.have_face(filename):
+                    faces = self.get_faces_alignments(filename, image)
+                else:
+                    print ('no alignment found for {}, skipping'.format(os.path.basename(filename)))
+                    continue
             else:
                 faces = self.get_faces(image)
             yield filename, image, faces
