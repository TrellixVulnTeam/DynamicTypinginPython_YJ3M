commit fa20acb5d2c800334db2fb48a6c43d37abff5a34
Author: torzdf <36920800+torzdf@users.noreply.github.com>
Date:   Mon May 13 12:51:38 2019 +0100

    Update docs

diff --git a/README.md b/README.md
index 2f76f60..949bbcf 100755
--- a/README.md
+++ b/README.md
@@ -1,67 +1,69 @@
 **Notice:** This repository is not operated or maintained by /u/deepfakes. Please read the explanation below for details.
 # deepfakes_faceswap
 
-Faceswap is a tool that utilizes deep learning to recognize and swap faces in pictures and videos.
+FaceSwap is a tool that utilizes deep learning to recognize and swap faces in pictures and videos.
 ![Screenshots](https://i.imgur.com/nWHFLDf.jpg)
 
 <p align="center">
   <a href="https://www.youtube.com/watch?v=r1jng79a5xc"><img src="https://img.youtube.com/vi/r1jng79a5xc/0.jpg"></img></a>
-<br />Jennifer Lawrence/Steve Buscemi Faceswap using the Villain model
+<br />Jennifer Lawrence/Steve Buscemi FaceSwap using the Villain model
 </p>
 
 Make sure you check out [INSTALL.md](INSTALL.md) before getting started.
 
-- [Manifesto](#manifesto)
-- [How To setup and run the project](#how-to-setup-and-run-the-project)
+- [deepfakes_faceswap](#deepfakesfaceswap)
+  - [Manifesto](#manifesto)
+    - [FaceSwap is not porn.](#faceswap-is-not-porn)
+  - [How To setup and run the project](#how-to-setup-and-run-the-project)
   - [Overview](#overview)
-  - [Extract](#extract)
-  - [Train](#train)
-  - [Convert](#convert)
-  - [GUI](#gui)
+    - [Extract](#extract)
+    - [Train](#train)
+    - [Convert](#convert)
+    - [GUI](#gui)
   - [General notes:](#general-notes)
-- [Help I need support!](#help-i-need-support)
-  - [Discord Server](#discord-server)
-  - [Faceswap-Playground](#faceswap-playground)
-- [Donate](#donate)
-  - [@torzdf](#@torzdf)
-  - [@andenixa](#andenixa)
-  - [@kvrooman](#@kvrooman)
-- [How to contribute](#how-to-contribute)
-  - [For people interested in the generative models](#for-people-interested-in-the-generative-models)
-  - [For devs](#for-devs)
-  - [For non-dev advanced users](#for-non-dev-advanced-users)
-  - [For end-users](#for-end-users)
-  - [For haters](#for-haters)
+  - [Help I need support!](#help-i-need-support)
+    - [Discord Server](#discord-server)
+    - [FaceSwap-Playground](#faceswap-playground)
+  - [Donate](#donate)
+    - [@torzdf](#torzdf)
+    - [@andenixa](#andenixa)
+    - [@kvrooman](#kvrooman)
+  - [How to contribute](#how-to-contribute)
+    - [For people interested in the generative models](#for-people-interested-in-the-generative-models)
+    - [For devs](#for-devs)
+    - [For non-dev advanced users](#for-non-dev-advanced-users)
+    - [For end-users](#for-end-users)
+    - [For haters](#for-haters)
 - [About github.com/deepfakes](#about-githubcomdeepfakes)
   - [What is this repo?](#what-is-this-repo)
   - [Why this repo?](#why-this-repo)
   - [Why is it named 'deepfakes' if it is not /u/deepfakes?](#why-is-it-named-deepfakes-if-it-is-not-udeepfakes)
   - [What if /u/deepfakes feels bad about that?](#what-if-udeepfakes-feels-bad-about-that)
 - [About machine learning](#about-machine-learning)
-  - [How does a computer know how to recognize/shape faces? How does machine learning work? What is a neural network?](#how-does-a-computer-know-how-to-recogniseshape-a-faces-how-does-machine-learning-work-what-is-a-neural-network)
+  - [How does a computer know how to recognize/shape faces? How does machine learning work? What is a neural network?](#how-does-a-computer-know-how-to-recognizeshape-faces-how-does-machine-learning-work-what-is-a-neural-network)
 
 ---
 ## Manifesto
 
-### Faceswap is not porn.
+### FaceSwap is not porn.
 
 When faceswapping was first developed and published, the technology was groundbreaking, it was a huge step in AI development. It was also completely ignored outside of academia because the code was confusing and fragmentary. It required a thorough understanding of complicated AI techniques and took a lot of effort to figure it out. Until one individual brought it together into a single, cohesive collection. It ran, it worked, and as is so often the way with new technology emerging on the internet, it was immediately used to create porn. The problem was that this was the first AI code that anyone could download, run and learn by experimentation without having a Ph.D. in math, computer theory, psychology, and more. Before "deepfakes" these techniques were like black magic, only practiced by those who could understand all of the inner workings as described in esoteric and endlessly complicated books and papers.
 
 "Deepfakes" changed all that and anyone could participate in AI development. To us, developers, the release of this code opened up a fantastic learning opportunity. It allowed us to build on ideas developed by others, collaborate with a variety of skilled coders, experiment with AI whilst learning new skills and ultimately contribute towards an emerging technology which will only see more mainstream use as it progresses.
 
-Are there some out there doing horrible things with similar software? Yes. And because of this, the developers have been following strict ethical standards. Many of us don't even use it to create videos, we just tinker with the code to see what it does. Sadly, the media concentrates only on the unethical uses of this software. That is, unfortunately, the nature of how it was first exposed to the public, but it is not representative of why it was created, how we use it now, or what we see in its future. Like any technology, it can be used for good or it can be abused. It is our intention to develop faceswap in a way that its potential for abuse is minimized whilst maximizing its potential as a tool for learning, experimenting and, yes, for legitimate faceswapping.
+Are there some out there doing horrible things with similar software? Yes. And because of this, the developers have been following strict ethical standards. Many of us don't even use it to create videos, we just tinker with the code to see what it does. Sadly, the media concentrates only on the unethical uses of this software. That is, unfortunately, the nature of how it was first exposed to the public, but it is not representative of why it was created, how we use it now, or what we see in its future. Like any technology, it can be used for good or it can be abused. It is our intention to develop FaceSwap in a way that its potential for abuse is minimized whilst maximizing its potential as a tool for learning, experimenting and, yes, for legitimate faceswapping.
 
 We are not trying to denigrate celebrities or to demean anyone. We are programmers, we are engineers, we are Hollywood VFX artists, we are activists, we are hobbyists, we are human beings. To this end, we feel that it's time to come out with a standard statement of what this software is and isn't as far as us developers are concerned.
 
-- Faceswap is not for creating porn
-- Faceswap is not for changing faces without consent or with the intent of hiding its use.
-- Faceswap is not for any illicit, unethical, or questionable purposes.
-- Faceswap exists to experiment and discover AI techniques, for social or political commentary, for movies, and for any number of ethical and reasonable uses.
+- FaceSwap is not for creating porn
+- FaceSwap is not for changing faces without consent or with the intent of hiding its use.
+- FaceSwap is not for any illicit, unethical, or questionable purposes.
+- FaceSwap exists to experiment and discover AI techniques, for social or political commentary, for movies, and for any number of ethical and reasonable uses.
 
-We are very troubled by the fact that faceswap can be used for unethical and disreputable things. However, we support the development of tools and techniques that can be used ethically as well as provide education and experience in AI for anyone who wants to learn it hands-on. We will take a zero tolerance approach to anyone using this software for any unethical purposes and will actively discourage any such uses.
+We are very troubled by the fact that FaceSwap can be used for unethical and disreputable things. However, we support the development of tools and techniques that can be used ethically as well as provide education and experience in AI for anyone who wants to learn it hands-on. We will take a zero tolerance approach to anyone using this software for any unethical purposes and will actively discourage any such uses.
 
 ## How To setup and run the project
-Faceswap is a Python program that will run on multiple Operating Systems including Windows, Linux, and MacOS.
+FaceSwap is a Python program that will run on multiple Operating Systems including Windows, Linux, and MacOS.
 
 See [INSTALL.md](INSTALL.md) for full installation instructions. You will need a modern GPU with CUDA support for best performance.
 
@@ -99,16 +101,16 @@ If there is not enough training data, start with someone who looks similar, then
 
 ## Help I need support!
 ### Discord Server
-Your best bet is to join the [Faceswap Discord server](https://discord.gg/FdEwxXd) where there are plenty of users willing to help. Please note that, like this repo, this is a SFW Server!
+Your best bet is to join the [FaceSwap Discord server](https://discord.gg/FdEwxXd) where there are plenty of users willing to help. Please note that, like this repo, this is a SFW Server!
 
-### Faceswap-Playground
-Alternatively, you can post questions in the [Faceswap Playground](https://github.com/deepfakes/faceswap-playground). Please do not post general support questions in this repo.
+### FaceSwap-Playground
+Alternatively, you can post questions in the [FaceSwap Playground](https://github.com/deepfakes/faceswap-playground). Please do not post general support questions in this repo.
 
 ## Donate
-The developers work tirelessly to improve and develop faceswap. Many hours have been put in to provide the software as it is today, but this is an extremely time-consuming process with no financial reward. If you enjoy using the software, please consider donating to the devs, so they can spend more time implementing improvements.
+The developers work tirelessly to improve and develop FaceSwap. Many hours have been put in to provide the software as it is today, but this is an extremely time-consuming process with no financial reward. If you enjoy using the software, please consider donating to the devs, so they can spend more time implementing improvements.
 
 ### @torzdf ###
- There is very little faceswap code that hasn't been touched by torzdf. He is responsible for implementing the GUI, FAN aligner, MTCNN detector and porting the Villain, DFL-H128 and DFaker models to faceswap, as well as significantly improving many areas of the code.
+ There is very little FaceSwap code that hasn't been touched by torzdf. He is responsible for implementing the GUI, FAN aligner, MTCNN detector and porting the Villain, DFL-H128 and DFaker models to FaceSwap, as well as significantly improving many areas of the code.
 
 **Bitcoin:** 385a1r9tyZpt5LyZcNk1FALTxC8ZHta7yq
 
diff --git a/USAGE.md b/USAGE.md
index 1a86cd1..899a5f4 100755
--- a/USAGE.md
+++ b/USAGE.md
@@ -1,110 +1,194 @@
-**Before attempting any of this, please make sure you have read, understood and completed the [installation instructions](../master/INSTALL.md). If you are experiencing issues, please raise them in the [faceswap-playground](https://github.com/deepfakes/faceswap-playground) repository instead of the main repo.**
-
 # Workflow
-So, you want to swap faces in pictures and videos? Well hold up, because first you gotta understand what this collection of scripts will do, how it does it and what it can't currently do.
+
+**Before attempting any of this, please make sure you have read, understood and completed the [installation instructions](../master/INSTALL.md). If you are experiencing issues, please raise them in the [faceswap-playground](https://github.com/deepfakes/faceswap-playground) repository or the [FaceSwap Discord server](https://discord.gg/FdEwxXd) instead of the main repo.**
+
+- [Workflow](#workflow)
+- [Introduction](#introduction)
+  - [Disclaimer](#disclaimer)
+  - [Getting Started](#getting-started)
+- [Extract](#extract)
+  - [Gathering raw data](#gathering-raw-data)
+  - [Extracting Faces](#extracting-faces)
+  - [General Tips](#general-tips)
+- [Training a model](#training-a-model)
+  - [General Tips](#general-tips-1)
+- [Converting a video](#converting-a-video)
+  - [General Tips](#general-tips-2)
+- [GUI](#gui)
+- [Video's](#videos)
+- [EFFMPEG](#effmpeg)
+- [Extracting video frames with FFMPEG](#extracting-video-frames-with-ffmpeg)
+- [Generating a video](#generating-a-video)
+- [Notes](#notes)
+  
+# Introduction
+
+## Disclaimer
+This guide provides a high level overview of the faceswapping process. It does not aim to go into every available option, but will provide a useful entry point to using the software. There are many more options available that are not covered by this guide. These can be found, and explained, by passing the `-h` flag to the command line (eg: `python faceswap.py extract -h`) or by hovering over the options within the GUI.
+
+## Getting Started
+So, you want to swap faces in pictures and videos? Well hold up, because first you gotta understand what this application will do, how it does it and what it can't currently do.
 
 The basic operation of this script is simple. It trains a machine learning model to recognize and transform two faces based on pictures. The machine learning model is our little "bot" that we're teaching to do the actual swapping and the pictures are the "training data" that we use to train it. Note that the bot is primarily processing faces. Other objects might not work.
 
 So here's our plan. We want to create a reality where Donald Trump lost the presidency to Nic Cage; we have his inauguration video; let's replace Trump with Cage.
 
+# Extract
 ## Gathering raw data
-In order to accomplish this, the bot needs to learn to recognize both face A (Trump) and face B (Nic Cage). By default, the bot doesn't know what a Trump or a Nic Cage looks like. So we need to show it some pictures and let it guess which is which. So we need pictures of both of these faces first.
+In order to accomplish this, the bot needs to learn to recognize both face A (Trump) and face B (Nic Cage). By default, the bot doesn't know what a Trump or a Nic Cage looks like. So we need to show it lots of pictures and let it guess which is which. So we need pictures of both of these faces first.
 
-A possible source is Google, DuckDuckGo or Bing image search. There are scripts to download large amounts of images. Alternatively, if you have a video of the person you're looking for (from interviews, public speeches, or movies), you can convert this video to still images and use those. see [Extracting video frames](#Extracting_video_frames) for more information.
+A possible source is Google, DuckDuckGo or Bing image search. There are scripts to download large amounts of images. A better source of images are videos (from interviews, public speeches, or movies) as these will capture many more natural poses and expressions. Fortunately FaceSwap has you covered and can extract faces from both still images and video files. See [Extracting video frames](#Extracting_video_frames) for more information.
 
 Feel free to list your image sets in the [faceswap-playground](https://github.com/deepfakes/faceswap-playground), or add more methods to this file.
 
-So now we have a folder full of pictures of Trump and a separate folder of Nic Cage. Let's save them in our directory where we put the faceswap project. Example: `~/faceswap/photo/trump` and `~/faceswap/photo/cage`
+So now we have a folder full of pictures/videos of Trump and a separate folder of Nic Cage. Let's save them in our directory where we put the FaceSwap project. Example: `~/faceswap/src/trump` and `~/faceswap/src/cage`
 
-## EXTRACT
-So here's a problem. We have a ton of pictures of both our subjects, but they're just pictures of them doing stuff or in an environment with other people. Their bodies are on there, they're on there with other people... It's a mess. We can only train our bot if the data we have is consistent and focusses on the subject we want to swap. This is where faceswap first comes in.
+## Extracting Faces
+So here's a problem. We have a ton of pictures and videos of both our subjects, but these are just of them doing stuff or in an environment with other people. Their bodies are on there, they're on there with other people... It's a mess. We can only train our bot if the data we have is consistent and focuses on the subject we want to swap. This is where FaceSwap first comes in.
 
+**Command Line:**
 ```bash
-# To convert trump:
-python faceswap.py extract -i ~/faceswap/photo/trump -o ~/faceswap/data/trump
-# To convert cage:
-python faceswap.py extract -i ~/faceswap/photo/cage -o ~/faceswap/data/cage
+# To extract trump from photos in a folder:
+python faceswap.py extract -i ~/faceswap/src/trump -o ~/faceswap/faces/trump
+# To extract trump from a video file:
+python faceswap.py extract -i ~/faceswap/src/trump.mp4 -o ~/faceswap/faces/trump
+# To extract cage from photos in a folder:
+python faceswap.py extract -i ~/faceswap/src/cage -o ~/faceswap/faces/cage
+# To extract cage from a video file:
+python faceswap.py extract -i ~/faceswap/src/cage.mp4 -o ~/faceswap/faces/cage
 ```
 
-We specify our photo input directory and the output folder where our training data will be saved. The script will then try its best to recognize face landmarks, crop the image to that size, and save it to the output folder. Note: this script will make grabbing test data much easier, but it is not perfect. It will (incorrectly) detect multiple faces in some photos and does not recognize if the face is the person whom we want to swap. Therefore: **Always check your training data before you start training.** The training data will influence how good your model will be at swapping.
+**GUI:**
+
+To extract trump from photos in a folder (Right hand folder icon):
+![ExtractFolder](https://i.imgur.com/H3h0k36.jpg)
+
+To extract cage from a video file (Left hand folder icon):
+![ExtractVideo](https://i.imgur.com/TK02F0u.jpg)]
+
+For input we either specify our photo directory or video file and for output we specify the folder where our extracted faces will be saved. The script will then try its best to recognize face landmarks, crop the images to a consistent size, and save the faces to the output folder. An `alignments.json` file will also be created and saved into your input folder. This file contains information about each of the faces that will be used by FaceSwap.
+
+Note: this script will make grabbing test data much easier, but it is not perfect. It will (incorrectly) detect multiple faces in some photos and does not recognize if the face is the person whom we want to swap. Therefore: **Always check your training data before you start training.** The training data will influence how good your model will be at swapping.
 
-You can see the full list of arguments for extracting via help flag. i.e.
+## General Tips
+When extracting faces for training, you are looking to gather around 500 to 5000 faces for each subject you wish to train. These should be of a high quality and contain a wide variety of angles, expressions and lighting conditions. 
 
+You do not want to extract every single frame from a video for training as from frame to frame the faces will be very similar.
+
+If you plan to train with a mask or use the Warp to Landmarks option, then you will need to copy the output `alignments.json` file from your source frames folder into your output faces folder for training. If you have extracted from multiple sources, you can use the alignments tool to merge several `alignments.json` files together.
+
+You can see the full list of arguments for extracting by hovering over the options in the GUI or passing the help flag. i.e:
 ```bash
 python faceswap.py extract -h
 ```
 
-Some of the plugins have configurable options. You can find the config options in: `<faceswap_folder>\config\extract.ini`. Extract needs to have been run at least once to generate the config file
+Some of the plugins have configurable options. You can find the config options in: `<faceswap_folder>\config\extract.ini`. You will need to have run Extract or the GUI at least once for this file to be generated.
+
+# Training a model
+Ok, now you have a folder full of Trump faces and a folder full of Cage faces. What now? It's time to train our bot! This creates a 'model' that contains information about what a Cage is and what a Trump is and how to swap between the two.
 
-## TRAIN
-The training process will take the longest, especially on CPU. We specify the folders where the two faces are, and where we will save our training model. It will start hammering the training data once you run the command. I personally really like to go by the preview and quit the processing once I'm happy with the results.
+The training process will take the longest, how long depends on many factors; the model used, the number of images, your GPU etc. However, a ballpark figure is 12-48 hours on GPU and weeks if training on CPU.
 
+We specify the folders where the two faces are, and where we will save our training model.
+
+**Command Line:**
 ```bash
-python faceswap.py train -A ~/faceswap/data/trump -B ~/faceswap/data/cage -m ~/faceswap/models/
+python faceswap.py train -A ~/faceswap/faces/trump -B ~/faceswap/faces/cage -m ~/faceswap/trump_cage_model/
 # or -p to show a preview
-python faceswap.py train -A ~/faceswap/data/trump -B ~/faceswap/data/cage -m ~/faceswap/models/ -p 
+python faceswap.py train -A ~/faceswap/faces/trump -B ~/faceswap/faces/cage -m ~/faceswap/trump_cage_model/ -p 
 ```
+**GUI:**
+
+![Training](https://i.imgur.com/j8bjk4I.jpg)
+
+Once you run the command, it will start hammering the training data. If you have a preview up, then you will see a load of blotches appear. These are the faces it is learning. They don't look like much, but then your model hasn't learned anything yet. Over time these will more and more start to resemble trump and cage.
 
-If you use the preview feature, select the preview window and press ENTER to save your processed data and quit gracefully. Without the preview enabled, you might have to forcefully quit by hitting Ctrl+C to cancel the command. Note that it will save the model once it's gone through about 100 iterations, which can take quite a while. So make sure you save before stopping the process.
+You want to leave your model learning until you are happy with the images in the preview. To stop training you can:
+- Command Line: press "Enter" in the preview window or in the console
+- GUI: Press the Terminate button
 
-You can see the full list of arguments for training via help flag. i.e.
+When stopping training, the model will save and the process will exit. This can take a little while, so be patient. The model will also save every 100 iterations or so.
+
+You can stop and resume training at any time. Just point FaceSwap at the same folders and carry on.
+
+## General Tips
+If you are training with a mask or using Warp to Landmarks, you will need to pass in an `alignments.json` file for each of the face sets. See [Extract - General Tips](#general-tips) for more information.
+
+The model is automatically backed up at every save iteration where the overall loss has dropped (i.e. the model has improved). If your model corrupts for some reason, you can go into the model folder and remove the `.bk` extension from the backups to restore the model from backup.
+
+You can see the full list of arguments for training by hovering over the options in the GUI or passing the help flag. i.e:
 
 ```bash
 python faceswap.py train -h
 ```
 
-Some of the plugins have configurable options. You can find the config options in: `<faceswap_folder>\config\train.ini`. Train needs to have been run at least once to generate the config file
+Some of the plugins have configurable options. You can find the config options in: `<faceswap_folder>\config\train.ini`. You will need to have run Train or the GUI at least once for this file to be generated.
+
+
+# Converting a video
+Now that we're happy with our trained model, we can convert our video. How does it work? 
 
+Well firstly we need to generate an `alignments.json` file for our swap. To do this, follow the steps in [Extracting Faces](#extracting-faces), only this time you want to run extract for every face in your source video. This file tells the convert process where the face is on the source frame.
 
-## CONVERT
-Now that we're happy with our trained model, we can convert our video. How does it work? Similarly to the extraction script, actually! The conversion script basically detects a face in a picture using the same algorithm, quickly crops the image to the right size, runs our bot on this cropped image of the face it has found, and then (crudely) pastes the processed face back into the picture.
+You are likely going to want to cleanup your alignments file, by deleting false positives, badly aligned faces etc. These will not look good on your final convert. There are tools to help with this.
+
+Just like extract you can convert from a series of images or from a video file.
 
 Remember those initial pictures we had of Trump? Let's try swapping a face there. We will use that directory as our input directory, create a new folder where the output will be saved, and tell them which model to use.
 
+**Command Line:**
 ```bash
-python faceswap.py convert -i ~/faceswap/photo/trump/ -o ~/faceswap/output/ -m ~/faceswap/models/
+python faceswap.py convert -i ~/faceswap/src/trump/ -o ~/faceswap/converted/ -m ~/faceswap/trump_cage_model/
 ```
 
+**GUI:**
+
+![convert](https://i.imgur.com/GzX1ME2.jpg)
+
 It should now start swapping faces of all these pictures.
 
-You can see the full list of arguments available for converting via help flag. i.e.
+
+## General Tips
+You can see the full list of arguments for training by hovering over the options in the GUI or passing the help flag. i.e:
 
 ```bash
 python faceswap.py convert -h
 ```
 
-## GUI
+Some of the plugins have configurable options. You can find the config options in: `<faceswap_folder>\config\convert.ini`. You will need to have run Convert or the GUI at least once for this file to be generated.
+
+# GUI
 All of the above commands and options can be run from the GUI. This is launched with:
 ```bash
 python faceswap.py gui
 ```
 
+The GUI allows a more user friendly interface into the scripts and also has some extended functionality. Hovering over options in the GUI will tell you more about what the option does.
 
-
-## Video's
+# Video's
 A video is just a series of pictures in the form of frames. Therefore you can gather the raw images from them for your dataset or combine your results into a video.
 
-## EFFMPEG
+# EFFMPEG
 You can perform various video processes with the built-in effmpeg tool. You can see the full list of arguments available by running:
 ```bash
 python tools.py effmpeg -h
 ```
 
-## Extracting video frames with FFMPEG
+# Extracting video frames with FFMPEG
 Alternatively, you can split a video into separate frames using [ffmpeg](https://www.ffmpeg.org) for instance. Below is an example command to process a video to separate frames.
 
 ```bash
 ffmpeg -i /path/to/my/video.mp4 /path/to/output/video-frame-%d.png
 ```
 
-## Generating a video
+# Generating a video
 If you split a video, using [ffmpeg](https://www.ffmpeg.org) for example, and used them as a target for swapping faces onto you can combine these frames again. The command below stitches the png frames back into a single video again.
 
 ```bash
 ffmpeg -i video-frame-%0d.png -c:v libx264 -vf "fps=25,format=yuv420p" out.mp4
 ```
 
-## Notes
+# Notes
 This guide is far from complete. Functionality may change over time, and new dependencies are added and removed as time goes on. 
 
-If you are experiencing issues, please raise them in the [faceswap-playground](https://github.com/deepfakes/faceswap-playground) repository instead of the main repo.
+If you are experiencing issues, please raise them in the [faceswap-playground](https://github.com/deepfakes/faceswap-playground) repository or the [FaceSwap Discord server](https://discord.gg/FdEwxXd) instead of the main repo.
