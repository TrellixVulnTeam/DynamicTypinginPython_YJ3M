commit 864d58f0be6b88f922e337d6eef10487901b60dd
Author: torzdf <36920800+torzdf@users.noreply.github.com>
Date:   Sun Jun 30 11:41:42 2019 +0000

    Useful logging message for OOM

diff --git a/lib/cli.py b/lib/cli.py
index a057699..5ac5b50 100644
--- a/lib/cli.py
+++ b/lib/cli.py
@@ -121,7 +121,8 @@ class ScriptExecutor():
             process = script(arguments)
             process.process()
         except FaceswapError as err:
-            logger.error(str(err))
+            for line in str(err).splitlines():
+                logger.error(line)
             crash_file = crash_log()
             logger.info("To get more information on this error see the crash report written to "
                         "%s", crash_file)
diff --git a/plugins/train/trainer/_base.py b/plugins/train/trainer/_base.py
index 446c69c..753aaa8 100644
--- a/plugins/train/trainer/_base.py
+++ b/plugins/train/trainer/_base.py
@@ -28,11 +28,12 @@ import cv2
 import numpy as np
 
 import tensorflow as tf
+from tensorflow.python import errors_impl as tf_errors  # pylint:disable=no-name-in-module
 
 from lib.alignments import Alignments
 from lib.faces_detect import DetectedFace
 from lib.training_data import TrainingDataGenerator, stack_images
-from lib.utils import get_folder, get_image_paths
+from lib.utils import FaceswapError, get_folder, get_image_paths
 from plugins.train._config import Config
 
 logger = logging.getLogger(__name__)  # pylint: disable=invalid-name
@@ -259,7 +260,19 @@ class Batcher():
         """ Train a batch """
         logger.trace("Training one step: (side: %s)", self.side)
         batch = self.get_next(do_preview)
-        loss = self.model.predictors[self.side].train_on_batch(*batch)
+        try:
+            loss = self.model.predictors[self.side].train_on_batch(*batch)
+        except tf_errors.ResourceExhaustedError as err:
+            msg = ("You do not have enough GPU memory available to train the selected model at "
+                   "the selected settings. You can try a number of things:"
+                   "\n1) Close any other application that is using your GPU (web browsers are "
+                   "particularly bad for this)."
+                   "\n2) Lower the batchsize (the amount of images fed into the model each "
+                   "iteration)."
+                   "\n3) Try Memory Saving Gradients and/or Ping Pong Training."
+                   "\n4) Use a more lightweight model, or select the model's 'LowMem' option "
+                   "(in config) if it has one.")
+            raise FaceswapError(msg) from err
         loss = loss if isinstance(loss, list) else [loss]
         return loss
 
