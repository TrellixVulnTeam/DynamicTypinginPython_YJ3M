commit 3db460cbb22fc40e1ad1b4cbef4295a21ce9f482
Author: James Cobon-Kerr <jamescobonkerr@gmail.com>
Date:   Thu Apr 23 22:30:55 2020 +0100

    TST: Groupby first/last/nth nan column test (#33627)

diff --git a/pandas/tests/groupby/test_nth.py b/pandas/tests/groupby/test_nth.py
index 947907caf..0cbfbad85 100644
--- a/pandas/tests/groupby/test_nth.py
+++ b/pandas/tests/groupby/test_nth.py
@@ -140,6 +140,18 @@ def test_first_last_nth_dtypes(df_mixed_floats):
     assert f.dtype == "int64"
 
 
+def test_first_last_nth_nan_dtype():
+    # GH 33591
+    df = pd.DataFrame({"data": ["A"], "nans": pd.Series([np.nan], dtype=object)})
+
+    grouped = df.groupby("data")
+    expected = df.set_index("data").nans
+    tm.assert_series_equal(grouped.nans.first(), expected)
+    tm.assert_series_equal(grouped.nans.last(), expected)
+    tm.assert_series_equal(grouped.nans.nth(-1), expected)
+    tm.assert_series_equal(grouped.nans.nth(0), expected)
+
+
 def test_first_strings_timestamps():
     # GH 11244
     test = pd.DataFrame(
