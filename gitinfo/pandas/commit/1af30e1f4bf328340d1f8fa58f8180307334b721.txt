commit 1af30e1f4bf328340d1f8fa58f8180307334b721
Author: Chang She <changshe@gmail.com>
Date:   Wed Dec 12 10:21:29 2012 -0500

    BUG: fix type spec bug in roll_window
    
    Conflicts:
    
            ci/install.sh

diff --git a/pandas/algos.pyx b/pandas/algos.pyx
index 0edc0c167..664067c55 100644
--- a/pandas/algos.pyx
+++ b/pandas/algos.pyx
@@ -1712,15 +1712,14 @@ def roll_window(ndarray[float64_t, ndim=1, cast=True] input,
     Assume len(weights) << len(input)
     """
     cdef:
-        ndarray[double_t] output, tot_wgt
-        ndarray[int64_t] counts
+        ndarray[double_t] output, tot_wgt, counts
         Py_ssize_t in_i, win_i, win_n, win_k, in_n, in_k
         float64_t val_in, val_win, c, w
 
     in_n = len(input)
     win_n = len(weights)
     output = np.zeros(in_n, dtype=float)
-    counts = np.zeros(in_n, dtype=int)
+    counts = np.zeros(in_n, dtype=float)
     if avg:
         tot_wgt = np.zeros(in_n, dtype=float)
 
diff --git a/pandas/stats/moments.py b/pandas/stats/moments.py
index 4fea4c4b2..7f47a9843 100644
--- a/pandas/stats/moments.py
+++ b/pandas/stats/moments.py
@@ -299,8 +299,8 @@ def _center_window(rs, window, axis):
         na_indexer = [slice(None)] * rs.ndim
         na_indexer[axis] = slice(-offset, None)
 
-        rs[rs_indexer] = rs[lead_indexer]
-        rs[na_indexer] = np.nan
+        rs[tuple(rs_indexer)] = rs[tuple(lead_indexer)]
+        rs[tuple(na_indexer)] = np.nan
     return rs
 
 def _process_data_structure(arg, kill_inf=True):
