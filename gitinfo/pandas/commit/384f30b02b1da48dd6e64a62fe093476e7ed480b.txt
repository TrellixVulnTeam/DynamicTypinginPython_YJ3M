commit 384f30b02b1da48dd6e64a62fe093476e7ed480b
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Nov 26 21:14:09 2012 -0500

    BUG: 32-bit index array issue

diff --git a/pandas/tseries/util.py b/pandas/tseries/util.py
index 8fe345b69..eb80746cf 100644
--- a/pandas/tseries/util.py
+++ b/pandas/tseries/util.py
@@ -71,6 +71,7 @@ def pivot_annual(series, freq=None):
         raise NotImplementedError(freq)
 
     flat_index = (year - years.min()) * width + offset
+    flat_index = com._ensure_platform_int(flat_index)
 
     values = np.empty((len(years), width))
     values.fill(np.nan)
