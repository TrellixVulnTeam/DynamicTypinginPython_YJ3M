commit f2b05d7ab9db8dbb688a43746323e2b3fc869fad
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Tue Dec 13 15:24:53 2011 -0500

    TST: add check_dtype flag to assert_series_equal

diff --git a/pandas/sparse/tests/test_sparse.py b/pandas/sparse/tests/test_sparse.py
index 1cc7d9eeb..09f30c87f 100644
--- a/pandas/sparse/tests/test_sparse.py
+++ b/pandas/sparse/tests/test_sparse.py
@@ -1164,7 +1164,9 @@ class TestSparseDataFrame(TestCase, test_frame.SafeForSparse):
 
         result = self.frame.count(1)
         dense_result = self.frame.to_dense().count(1)
-        assert_series_equal(result, dense_result)
+
+        # win32 don't check dtype
+        assert_series_equal(result, dense_result, check_dtype=False)
 
     def test_cumsum(self):
         result = self.frame.cumsum()
diff --git a/pandas/util/testing.py b/pandas/util/testing.py
index a9b5d44c8..94a4ff5db 100644
--- a/pandas/util/testing.py
+++ b/pandas/util/testing.py
@@ -117,9 +117,10 @@ def assert_dict_equal(a, b, compare_keys=True):
     for k in a_keys:
         assert_almost_equal(a[k], b[k])
 
-def assert_series_equal(left, right):
+def assert_series_equal(left, right, check_dtype=True):
     assert_almost_equal(left.values, right.values)
-    assert(left.dtype == right.dtype)
+    if check_dtype:
+        assert(left.dtype == right.dtype)
     assert(left.index.equals(right.index))
 
 def assert_frame_equal(left, right):
