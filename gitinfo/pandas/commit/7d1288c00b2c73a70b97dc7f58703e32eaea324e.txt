commit 7d1288c00b2c73a70b97dc7f58703e32eaea324e
Author: Phillip Cloud <cpcloud@gmail.com>
Date:   Mon Jun 2 10:51:48 2014 -0400

    BUG/TST: should skip openpyxl before testing version compat

diff --git a/pandas/io/tests/test_excel.py b/pandas/io/tests/test_excel.py
index 5928e99ed..b45897dff 100644
--- a/pandas/io/tests/test_excel.py
+++ b/pandas/io/tests/test_excel.py
@@ -1217,9 +1217,9 @@ class ExcelWriterEngineTests(tm.TestCase):
             import xlsxwriter
             writer_klass = _XlsxWriter
         except ImportError:
+            _skip_if_no_openpyxl()
             if not openpyxl_compat.is_compat():
                 raise nose.SkipTest('incompatible openpyxl version')
-            _skip_if_no_openpyxl()
             writer_klass = _OpenpyxlWriter
 
         with ensure_clean('.xlsx') as path:
