commit acb5f03d4bd89ede5d54849d88453299a2c3819a
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Thu Jun 28 20:12:47 2012 -0400

    ENH: parsers don't use tempfile

diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index 137bca5a5..a2277fc18 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -1149,20 +1149,16 @@ class ExcelFile(object):
                 except ImportError:  # pragma: no cover
                     raise ImportError(_openpyxl_msg)
         else:
-            import tempfile
-            fd  = tempfile.NamedTemporaryFile()
-            fd.write(path_or_buf.read())
-            fd.seek(0)
+            data = path_or_buf.read()
 
             try:
                 import xlrd
-                self.book = xlrd.open_workbook(fd.name)
+                self.book = xlrd.open_workbook(file_contents=data)
                 self.use_xlsx = False
             except Exception:
                 from openpyxl.reader.excel import load_workbook
-                self.book = load_workbook(fd.name, use_iterators=True)
-
-            self.tmpfile = fd
+                buf = py3compat.BytesIO(data)
+                self.book = load_workbook(buf, use_iterators=True)
 
     def __repr__(self):
         return object.__repr__(self)
