commit 99e2b1605b608238276a0481e325abc268f69250
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Sep 27 11:36:13 2010 -0400

    Updated NumPy sphinxext, Cython 0.13 upgrades, and misc

diff --git a/.gitignore b/.gitignore
index eab743f19..9a3d7e47f 100644
--- a/.gitignore
+++ b/.gitignore
@@ -5,4 +5,4 @@ MANIFEST
 *.so
 *.pyd
 doc/source/generated
-
+scikits
\ No newline at end of file
diff --git a/.svnignore b/.svnignore
deleted file mode 100644
index 6add511ef..000000000
--- a/.svnignore
+++ /dev/null
@@ -1,2 +0,0 @@
-*.pyc
-*~
\ No newline at end of file
diff --git a/doc/source/conf.py b/doc/source/conf.py
index 30ea6b65c..52b51832d 100644
--- a/doc/source/conf.py
+++ b/doc/source/conf.py
@@ -65,29 +65,30 @@ copyright = u'2008-2010, AQR Capital Management, LLC'
 # The short X.Y version.
 import pandas
 
-def svn_version():
-    import os, subprocess, re, warnings
-    env = os.environ.copy()
-    env['LC_ALL'] = 'C'
-    try:
-        out = subprocess.Popen(['svn', 'info'], stdout=subprocess.PIPE,
-                env=env).communicate()[0]
-    except OSError:
-        warnings.warn(" --- Could not run svn info --- ")
-        return ""
-
-    r = re.compile('Revision: ([0-9]+)')
-    svnver = None
-    for line in out.split('\n'):
-        m = r.match(line)
-        if m:
-            svnver = m.group(1)
-
-    if not svnver:
-        raise ValueError("Error while parsing svn version ?")
-    return svnver
-
-version = '%s r%s' % (pandas.__version__, svn_version())
+# def svn_version():
+#     import os, subprocess, re, warnings
+#     env = os.environ.copy()
+#     env['LC_ALL'] = 'C'
+#     try:
+#         out = subprocess.Popen(['svn', 'info'], stdout=subprocess.PIPE,
+#                 env=env).communicate()[0]
+#     except OSError:
+#         warnings.warn(" --- Could not run svn info --- ")
+#         return ""
+
+#     r = re.compile('Revision: ([0-9]+)')
+#     svnver = None
+#     for line in out.split('\n'):
+#         m = r.match(line)
+#         if m:
+#             svnver = m.group(1)
+
+#     if not svnver:
+#         raise ValueError("Error while parsing svn version ?")
+#     return svnver
+
+# version = '%s r%s' % (pandas.__version__, svn_version())
+version = '%s' % (pandas.__version__)
 
 # The full version, including alpha/beta/rc tags.
 release = version
diff --git a/doc/sphinxext/README.txt b/doc/sphinxext/README.txt
index d160a4a59..f3d782c95 100755
--- a/doc/sphinxext/README.txt
+++ b/doc/sphinxext/README.txt
@@ -1,26 +1,52 @@
-=====================================
-numpydoc -- Numpy's Sphinx extensions
-=====================================
-
-Numpy's documentation uses several custom extensions to Sphinx.  These
-are shipped in this ``numpydoc`` package, in case you want to make use
-of them in third-party projects.
-
-The following extensions are available:
-
-  - ``numpydoc``: support for the Numpy docstring format in Sphinx, and add
-    the code description directives ``np-function``, ``np-cfunction``, etc.
-    that support the Numpy docstring syntax.
-
-  - ``numpydoc.traitsdoc``: For gathering documentation about Traits attributes.
-
-  - ``numpydoc.plot_directives``: Adaptation of Matplotlib's ``plot::``
-    directive. Note that this implementation may still undergo severe
-    changes or eventually be deprecated.
-
-  - ``numpydoc.only_directives``: (DEPRECATED)
-
-  - ``numpydoc.autosummary``: (DEPRECATED) An ``autosummary::`` directive.
-    Available in Sphinx 0.6.2 and (to-be) 1.0 as ``sphinx.ext.autosummary``,
-    and it the Sphinx 1.0 version is recommended over that included in
-    Numpydoc.
+=====================================
+numpydoc -- Numpy's Sphinx extensions
+=====================================
+
+Numpy's documentation uses several custom extensions to Sphinx.  These
+are shipped in this ``numpydoc`` package, in case you want to make use
+of them in third-party projects.
+
+The following extensions are available:
+
+  - ``numpydoc``: support for the Numpy docstring format in Sphinx, and add
+    the code description directives ``np:function``, ``np-c:function``, etc.
+    that support the Numpy docstring syntax.
+
+  - ``numpydoc.traitsdoc``: For gathering documentation about Traits attributes.
+
+  - ``numpydoc.plot_directives``: Adaptation of Matplotlib's ``plot::``
+    directive. Note that this implementation may still undergo severe
+    changes or eventually be deprecated.
+
+  - ``numpydoc.only_directives``: (DEPRECATED)
+
+  - ``numpydoc.autosummary``: (DEPRECATED) An ``autosummary::`` directive.
+    Available in Sphinx 0.6.2 and (to-be) 1.0 as ``sphinx.ext.autosummary``,
+    and it the Sphinx 1.0 version is recommended over that included in
+    Numpydoc.
+
+
+numpydoc
+========
+
+Numpydoc inserts a hook into Sphinx's autodoc that converts docstrings
+following the Numpy/Scipy format to a form palatable to Sphinx.
+
+Options
+-------
+
+The following options can be set in conf.py:
+
+- numpydoc_use_plots: bool
+
+  Whether to produce ``plot::`` directives for Examples sections that
+  contain ``import matplotlib``.
+
+- numpydoc_show_class_members: bool
+
+  Whether to show all members of a class in the Methods and Attributes
+  sections automatically.
+
+- numpydoc_edit_link: bool  (DEPRECATED -- edit your HTML template instead)
+
+  Whether to insert an edit link after docstrings.
diff --git a/doc/sphinxext/docscrape.py b/doc/sphinxext/docscrape.py
index 0e073da93..63fec42ad 100755
--- a/doc/sphinxext/docscrape.py
+++ b/doc/sphinxext/docscrape.py
@@ -84,7 +84,7 @@ class Reader(object):
 
 
 class NumpyDocString(object):
-    def __init__(self,docstring):
+    def __init__(self, docstring, config={}):
         docstring = textwrap.dedent(docstring).split('\n')
 
         self._doc = Reader(docstring)
@@ -183,7 +183,7 @@ class NumpyDocString(object):
 
         return params
 
-    
+
     _name_rgx = re.compile(r"^\s*(:(?P<role>\w+):`(?P<name>[a-zA-Z0-9_.-]+)`|"
                            r" (?P<name2>[a-zA-Z0-9_.-]+))\s*", re.X)
     def _parse_see_also(self, content):
@@ -216,7 +216,7 @@ class NumpyDocString(object):
 
         current_func = None
         rest = []
-        
+
         for line in content:
             if not line.strip(): continue
 
@@ -232,7 +232,8 @@ class NumpyDocString(object):
                 current_func = None
                 if ',' in line:
                     for func in line.split(','):
-                        push_item(func, [])
+                        if func.strip():
+                            push_item(func, [])
                 elif line.strip():
                     current_func = line
             elif current_func is not None:
@@ -258,7 +259,7 @@ class NumpyDocString(object):
             if len(line) > 2:
                 out[line[1]] = strip_each_in(line[2].split(','))
         return out
-    
+
     def _parse_summary(self):
         """Grab signature (if given) and summary"""
         if self._is_at_section():
@@ -275,7 +276,7 @@ class NumpyDocString(object):
 
         if not self._is_at_section():
             self['Extended Summary'] = self._read_to_next_section()
-    
+
     def _parse(self):
         self._doc.reset()
         self._parse_summary()
@@ -408,22 +409,17 @@ def header(text, style='-'):
 
 
 class FunctionDoc(NumpyDocString):
-    def __init__(self, func, role='func', doc=None):
+    def __init__(self, func, role='func', doc=None, config={}):
         self._f = func
         self._role = role # e.g. "func" or "meth"
+
         if doc is None:
+            if func is None:
+                raise ValueError("No function or docstring given")
             doc = inspect.getdoc(func) or ''
-        try:
-            NumpyDocString.__init__(self, doc)
-        except ValueError, e:
-            print '*'*78
-            print "ERROR: '%s' while parsing `%s`" % (e, self._f)
-            print '*'*78
-            #print "Docstring follows:"
-            #print doclines
-            #print '='*78
-
-        if not self['Signature']:
+        NumpyDocString.__init__(self, doc)
+
+        if not self['Signature'] and func is not None:
             func, func_name = self.get_func()
             try:
                 # try to read signature
@@ -442,7 +438,7 @@ class FunctionDoc(NumpyDocString):
         else:
             func = self._f
         return func, func_name
-            
+
     def __str__(self):
         out = ''
 
@@ -463,35 +459,41 @@ class FunctionDoc(NumpyDocString):
 
 
 class ClassDoc(NumpyDocString):
-    def __init__(self,cls,modulename='',func_doc=FunctionDoc,doc=None):
-        if not inspect.isclass(cls):
-            raise ValueError("Initialise using a class. Got %r" % cls)
+    def __init__(self, cls, doc=None, modulename='', func_doc=FunctionDoc,
+                 config={}):
+        if not inspect.isclass(cls) and cls is not None:
+            raise ValueError("Expected a class or None, but got %r" % cls)
         self._cls = cls
 
         if modulename and not modulename.endswith('.'):
             modulename += '.'
         self._mod = modulename
-        self._name = cls.__name__
-        self._func_doc = func_doc
 
         if doc is None:
+            if cls is None:
+                raise ValueError("No class or documentation string given")
             doc = pydoc.getdoc(cls)
 
         NumpyDocString.__init__(self, doc)
 
-        if not self['Methods']:
-            self['Methods'] = [(name, '', '') for name in sorted(self.methods)]
-
-        if not self['Attributes']:
-            self['Attributes'] = [(name, '', '')
-                                  for name in sorted(self.properties)]
+        if config.get('show_class_members', True):
+            if not self['Methods']:
+                self['Methods'] = [(name, '', '')
+                                   for name in sorted(self.methods)]
+            if not self['Attributes']:
+                self['Attributes'] = [(name, '', '')
+                                      for name in sorted(self.properties)]
 
     @property
     def methods(self):
+        if self._cls is None:
+            return []
         return [name for name,func in inspect.getmembers(self._cls)
                 if not name.startswith('_') and callable(func)]
 
     @property
     def properties(self):
+        if self._cls is None:
+            return []
         return [name for name,func in inspect.getmembers(self._cls)
                 if not name.startswith('_') and func is None]
diff --git a/doc/sphinxext/docscrape_sphinx.py b/doc/sphinxext/docscrape_sphinx.py
index 12907731e..9f4350d46 100755
--- a/doc/sphinxext/docscrape_sphinx.py
+++ b/doc/sphinxext/docscrape_sphinx.py
@@ -3,7 +3,9 @@ import sphinx
 from docscrape import NumpyDocString, FunctionDoc, ClassDoc
 
 class SphinxDocString(NumpyDocString):
-    use_plots = False
+    def __init__(self, docstring, config={}):
+        self.use_plots = config.get('use_plots', False)
+        NumpyDocString.__init__(self, docstring, config=config)
 
     # string conversion routines
     def _str_header(self, name, symbol='`'):
@@ -189,17 +191,21 @@ class SphinxDocString(NumpyDocString):
         return '\n'.join(out)
 
 class SphinxFunctionDoc(SphinxDocString, FunctionDoc):
-    pass
+    def __init__(self, obj, doc=None, config={}):
+        self.use_plots = config.get('use_plots', False)
+        FunctionDoc.__init__(self, obj, doc=doc, config=config)
 
 class SphinxClassDoc(SphinxDocString, ClassDoc):
-    pass
+    def __init__(self, obj, doc=None, func_doc=None, config={}):
+        self.use_plots = config.get('use_plots', False)
+        ClassDoc.__init__(self, obj, doc=doc, func_doc=None, config=config)
 
 class SphinxObjDoc(SphinxDocString):
-    def __init__(self, obj, doc):
+    def __init__(self, obj, doc=None, config={}):
         self._f = obj
-        SphinxDocString.__init__(self, doc)
+        SphinxDocString.__init__(self, doc, config=config)
 
-def get_doc_object(obj, what=None, doc=None):
+def get_doc_object(obj, what=None, doc=None, config={}):
     if what is None:
         if inspect.isclass(obj):
             what = 'class'
@@ -210,10 +216,11 @@ def get_doc_object(obj, what=None, doc=None):
         else:
             what = 'object'
     if what == 'class':
-        return SphinxClassDoc(obj, '', func_doc=SphinxFunctionDoc, doc=doc)
+        return SphinxClassDoc(obj, func_doc=SphinxFunctionDoc, doc=doc,
+                              config=config)
     elif what in ('function', 'method'):
-        return SphinxFunctionDoc(obj, '', doc=doc)
+        return SphinxFunctionDoc(obj, doc=doc, config=config)
     else:
         if doc is None:
             doc = pydoc.getdoc(obj)
-        return SphinxObjDoc(obj, doc)
+        return SphinxObjDoc(obj, doc, config=config)
diff --git a/doc/sphinxext/numpydoc.py b/doc/sphinxext/numpydoc.py
index 707107daf..43c67336b 100755
--- a/doc/sphinxext/numpydoc.py
+++ b/doc/sphinxext/numpydoc.py
@@ -16,6 +16,11 @@ It will:
 
 """
 
+import sphinx
+
+if sphinx.__version__ < '1.0.1':
+    raise RuntimeError("Sphinx 1.0.1 or newer is required")
+
 import os, re, pydoc
 from docscrape_sphinx import get_doc_object, SphinxDocString
 from sphinx.util.compat import Directive
@@ -24,14 +29,16 @@ import inspect
 def mangle_docstrings(app, what, name, obj, options, lines,
                       reference_offset=[0]):
 
+    cfg = dict(use_plots=app.config.numpydoc_use_plots,
+               show_class_members=app.config.numpydoc_show_class_members)
+
     if what == 'module':
         # Strip top title
         title_re = re.compile(ur'^\s*[#*=]{4,}\n[a-z0-9 -]+\n[#*=]{4,}\s*',
                               re.I|re.S)
         lines[:] = title_re.sub(u'', u"\n".join(lines)).split(u"\n")
     else:
-        doc = get_doc_object(obj, what, u"\n".join(lines))
-        doc.use_plots = app.config.numpydoc_use_plots
+        doc = get_doc_object(obj, what, u"\n".join(lines), config=cfg)
         lines[:] = unicode(doc).split(u"\n")
 
     if app.config.numpydoc_edit_link and hasattr(obj, '__name__') and \
@@ -71,7 +78,8 @@ def mangle_docstrings(app, what, name, obj, options, lines,
 def mangle_signature(app, what, name, obj, options, sig, retann):
     # Do not try to inspect classes that don't define `__init__`
     if (inspect.isclass(obj) and
-        'initializes x; see ' in pydoc.getdoc(obj.__init__)):
+        (not hasattr(obj, '__init__') or
+        'initializes x; see ' in pydoc.getdoc(obj.__init__))):
         return '', ''
 
     if not (callable(obj) or hasattr(obj, '__argspec_is_invalid_')): return
@@ -82,73 +90,63 @@ def mangle_signature(app, what, name, obj, options, sig, retann):
         sig = re.sub(u"^[^(]*", u"", doc['Signature'])
         return sig, u''
 
-def initialize(app):
-    try:
-        app.connect('autodoc-process-signature', mangle_signature)
-    except:
-        monkeypatch_sphinx_ext_autodoc()
-
 def setup(app, get_doc_object_=get_doc_object):
     global get_doc_object
     get_doc_object = get_doc_object_
-    
+
     app.connect('autodoc-process-docstring', mangle_docstrings)
-    app.connect('builder-inited', initialize)
-    app.add_config_value('numpydoc_edit_link', None, True)
+    app.connect('autodoc-process-signature', mangle_signature)
+    app.add_config_value('numpydoc_edit_link', None, False)
     app.add_config_value('numpydoc_use_plots', None, False)
+    app.add_config_value('numpydoc_show_class_members', True, True)
 
-    # Extra mangling directives
-    name_type = {
-        'cfunction': 'function',
-        'cmember': 'attribute',
-        'cmacro': 'function',
-        'ctype': 'class',
-        'cvar': 'object',
-        'class': 'class',
-        'function': 'function',
-        'attribute': 'attribute',
-        'method': 'function',
-        'staticmethod': 'function',
-        'classmethod': 'function',
-    }
+    # Extra mangling domains
+    app.add_domain(NumpyPythonDomain)
+    app.add_domain(NumpyCDomain)
 
-    for name, objtype in name_type.items():
-        app.add_directive('np-' + name, wrap_mangling_directive(name, objtype))
-    
 #------------------------------------------------------------------------------
-# Input-mangling directives
+# Docstring-mangling domains
 #------------------------------------------------------------------------------
+
 from docutils.statemachine import ViewList
+from sphinx.domains.c import CDomain
+from sphinx.domains.python import PythonDomain
 
-def get_directive(name):
-    from docutils.parsers.rst import directives
-    try:
-        return directives.directive(name, None, None)[0]
-    except AttributeError:
-        pass
-    try:
-        # docutils 0.4
-        return directives._directives[name]
-    except (AttributeError, KeyError):
-        raise RuntimeError("No directive named '%s' found" % name)
-
-def wrap_mangling_directive(base_directive_name, objtype):
-    base_directive = get_directive(base_directive_name)
-
-    if inspect.isfunction(base_directive):
-        base_func = base_directive
-        class base_directive(Directive):
-            required_arguments = base_func.arguments[0]
-            optional_arguments = base_func.arguments[1]
-            final_argument_whitespace = base_func.arguments[2]
-            option_spec = base_func.options
-            has_content = base_func.content
-            def run(self):
-                return base_func(self.name, self.arguments, self.options,
-                                 self.content, self.lineno,
-                                 self.content_offset, self.block_text,
-                                 self.state, self.state_machine)
+class ManglingDomainBase(object):
+    directive_mangling_map = {}
 
+    def __init__(self, *a, **kw):
+        super(ManglingDomainBase, self).__init__(*a, **kw)
+        self.wrap_mangling_directives()
+
+    def wrap_mangling_directives(self):
+        for name, objtype in self.directive_mangling_map.items():
+            self.directives[name] = wrap_mangling_directive(
+                self.directives[name], objtype)
+
+class NumpyPythonDomain(ManglingDomainBase, PythonDomain):
+    name = 'np'
+    directive_mangling_map = {
+        'function': 'function',
+        'class': 'class',
+        'exception': 'class',
+        'method': 'function',
+        'classmethod': 'function',
+        'staticmethod': 'function',
+        'attribute': 'attribute',
+    }
+
+class NumpyCDomain(ManglingDomainBase, CDomain):
+    name = 'np-c'
+    directive_mangling_map = {
+        'function': 'function',
+        'member': 'attribute',
+        'macro': 'function',
+        'type': 'class',
+        'var': 'object',
+    }
+
+def wrap_mangling_directive(base_directive, objtype):
     class directive(base_directive):
         def run(self):
             env = self.state.document.settings.env
@@ -169,24 +167,3 @@ def wrap_mangling_directive(base_directive_name, objtype):
 
     return directive
 
-#------------------------------------------------------------------------------
-# Monkeypatch sphinx.ext.autodoc to accept argspecless autodocs (Sphinx < 0.5)
-#------------------------------------------------------------------------------
-
-def monkeypatch_sphinx_ext_autodoc():
-    global _original_format_signature
-    import sphinx.ext.autodoc
-
-    if sphinx.ext.autodoc.format_signature is our_format_signature:
-        return
-
-    print "[numpydoc] Monkeypatching sphinx.ext.autodoc ..."
-    _original_format_signature = sphinx.ext.autodoc.format_signature
-    sphinx.ext.autodoc.format_signature = our_format_signature
-
-def our_format_signature(what, obj):
-    r = mangle_signature(None, what, None, obj, None, None, None)
-    if r is not None:
-        return r[0]
-    else:
-        return _original_format_signature(what, obj)
diff --git a/doc/sphinxext/plot_directive.py b/doc/sphinxext/plot_directive.py
index 8de8c7399..efbd0d303 100755
--- a/doc/sphinxext/plot_directive.py
+++ b/doc/sphinxext/plot_directive.py
@@ -64,6 +64,9 @@ The plot directive has the following configuration options:
         that determine the file format and the DPI. For entries whose
         DPI was omitted, sensible defaults are chosen.
 
+    plot_html_show_formats
+        Whether to show links to the files in HTML.
+
 TODO
 ----
 
@@ -96,6 +99,7 @@ def setup(app):
     app.add_config_value('plot_include_source', False, True)
     app.add_config_value('plot_formats', ['png', 'hires.png', 'pdf'], True)
     app.add_config_value('plot_basedir', None, True)
+    app.add_config_value('plot_html_show_formats', True, True)
 
     app.add_directive('plot', plot_directive, True, (0, 1, False),
                       **plot_directive_options)
@@ -160,34 +164,37 @@ TEMPLATE = """
 
 {{ only_html }}
 
-   {% if source_code %}
-   (`Source code <{{ source_link }}>`__)
-
-   .. admonition:: Output
-      :class: plot-output
-
+   {% if source_link or (html_show_formats and not multi_image) %}
+   (
+   {%- if source_link -%}
+   `Source code <{{ source_link }}>`__
+   {%- endif -%}
+   {%- if html_show_formats and not multi_image -%}
+     {%- for img in images -%}
+       {%- for fmt in img.formats -%}
+         {%- if source_link or not loop.first -%}, {% endif -%}
+         `{{ fmt }} <{{ dest_dir }}/{{ img.basename }}.{{ fmt }}>`__
+       {%- endfor -%}
+     {%- endfor -%}
+   {%- endif -%}
+   )
    {% endif %}
 
-       {% for img in images %}
-       .. figure:: {{ build_dir }}/{{ img.basename }}.png
-          {%- for option in options %}
-          {{ option }}
-          {% endfor %}
-    
-          (
-          {%- if not source_code -%}
-            `Source code <{{source_link}}>`__
-            {%- for fmt in img.formats -%} 
-            , `{{ fmt }} <{{ dest_dir }}/{{ img.basename }}.{{ fmt }}>`__
-            {%- endfor -%}
-          {%- else -%}
-            {%- for fmt in img.formats -%} 
-            {%- if not loop.first -%}, {% endif -%}
-            `{{ fmt }} <{{ dest_dir }}/{{ img.basename }}.{{ fmt }}>`__
-            {%- endfor -%}
-          {%- endif -%}
-          )
-       {% endfor %}
+   {% for img in images %}
+   .. figure:: {{ build_dir }}/{{ img.basename }}.png
+      {%- for option in options %}
+      {{ option }}
+      {% endfor %}
+
+      {% if html_show_formats and multi_image -%}
+        (
+        {%- for fmt in img.formats -%}
+        {%- if not loop.first -%}, {% endif -%}
+        `{{ fmt }} <{{ dest_dir }}/{{ img.basename }}.{{ fmt }}>`__
+        {%- endfor -%}
+        )
+      {%- endif -%}
+   {% endfor %}
 
 {{ only_latex }}
 
@@ -281,60 +288,75 @@ def run(arguments, content, options, state_machine, state, lineno):
 
     # make figures
     try:
-        images = makefig(code, source_file_name, build_dir, output_base,
-                         config)
+        results = makefig(code, source_file_name, build_dir, output_base,
+                          config)
+        errors = []
     except PlotError, err:
         reporter = state.memo.reporter
         sm = reporter.system_message(
-            3, "Exception occurred in plotting %s: %s" % (output_base, err),
+            2, "Exception occurred in plotting %s: %s" % (output_base, err),
             line=lineno)
-        return [sm]
+        results = [(code, [])]
+        errors = [sm]
 
     # generate output restructuredtext
-    if options['include-source']:
-        if is_doctest:
-            lines = ['']
-            lines += [row.rstrip() for row in code.split('\n')]
+    total_lines = []
+    for j, (code_piece, images) in enumerate(results):
+        if options['include-source']:
+            if is_doctest:
+                lines = ['']
+                lines += [row.rstrip() for row in code_piece.split('\n')]
+            else:
+                lines = ['.. code-block:: python', '']
+                lines += ['    %s' % row.rstrip()
+                          for row in code_piece.split('\n')]
+            source_code = "\n".join(lines)
         else:
-            lines = ['.. code-block:: python', '']
-            lines += ['    %s' % row.rstrip() for row in code.split('\n')]
-        source_code = "\n".join(lines)
-    else:
-        source_code = ""
+            source_code = ""
 
-    opts = [':%s: %s' % (key, val) for key, val in options.items()
-            if key in ('alt', 'height', 'width', 'scale', 'align', 'class')]
+        opts = [':%s: %s' % (key, val) for key, val in options.items()
+                if key in ('alt', 'height', 'width', 'scale', 'align', 'class')]
 
-    if sphinx.__version__ >= "0.6":
-        only_html = ".. only:: html"
-        only_latex = ".. only:: latex"
-    else:
-        only_html = ".. htmlonly::"
-        only_latex = ".. latexonly::"
-
-    result = format_template(
-        TEMPLATE,
-        dest_dir=dest_dir_link,
-        build_dir=build_dir_link,
-        source_link=source_link,
-        only_html=only_html,
-        only_latex=only_latex,
-        options=opts,
-        images=images,
-        source_code=source_code)
-
-    lines = result.split("\n")
-    if len(lines):
-        state_machine.insert_input(
-            lines, state_machine.input_lines.source(0))
+        if sphinx.__version__ >= "0.6":
+            only_html = ".. only:: html"
+            only_latex = ".. only:: latex"
+        else:
+            only_html = ".. htmlonly::"
+            only_latex = ".. latexonly::"
+
+        if j == 0:
+            src_link = source_link
+        else:
+            src_link = None
+
+        result = format_template(
+            TEMPLATE,
+            dest_dir=dest_dir_link,
+            build_dir=build_dir_link,
+            source_link=src_link,
+            multi_image=len(images) > 1,
+            only_html=only_html,
+            only_latex=only_latex,
+            options=opts,
+            images=images,
+            source_code=source_code,
+            html_show_formats=config.plot_html_show_formats)
+
+        total_lines.extend(result.split("\n"))
+        total_lines.extend("\n")
+
+    if total_lines:
+        state_machine.insert_input(total_lines, source=source_file_name)
 
     # copy image files to builder's output directory
     if not os.path.exists(dest_dir):
         os.makedirs(dest_dir)
 
-    for img in images:
-        for fn in img.filenames():
-            shutil.copyfile(fn, os.path.join(dest_dir, os.path.basename(fn)))
+    for code_piece, images in results:
+        for img in images:
+            for fn in img.filenames():
+                shutil.copyfile(fn, os.path.join(dest_dir,
+                                                 os.path.basename(fn)))
 
     # copy script (if necessary)
     if source_file_name == rst_file:
@@ -343,7 +365,7 @@ def run(arguments, content, options, state_machine, state, lineno):
         f.write(unescape_doctest(code))
         f.close()
 
-    return []
+    return errors
 
 
 #------------------------------------------------------------------------------
@@ -389,10 +411,32 @@ def unescape_doctest(text):
             code += "\n"
     return code
 
+def split_code_at_show(text):
+    """
+    Split code at plt.show()
+
+    """
+
+    parts = []
+    is_doctest = contains_doctest(text)
+
+    part = []
+    for line in text.split("\n"):
+        if (not is_doctest and line.strip() == 'plt.show()') or \
+               (is_doctest and line.strip() == '>>> plt.show()'):
+            part.append(line)
+            parts.append("\n".join(part))
+            part = []
+        else:
+            part.append(line)
+    if "\n".join(part).strip():
+        parts.append("\n".join(part))
+    return parts
+
 class PlotError(RuntimeError):
     pass
 
-def run_code(code, code_path):
+def run_code(code, code_path, ns=None):
     # Change the working directory to the directory of the example, so
     # it can get at its data files, if any.
     pwd = os.getcwd()
@@ -413,8 +457,10 @@ def run_code(code, code_path):
     try:
         try:
             code = unescape_doctest(code)
-            ns = {}
-            exec setup.config.plot_pre_code in ns
+            if ns is None:
+                ns = {}
+            if not ns:
+                exec setup.config.plot_pre_code in ns
             exec code in ns
         except (Exception, SystemExit), err:
             raise PlotError(traceback.format_exc())
@@ -459,6 +505,8 @@ def makefig(code, code_path, output_dir, output_base, config):
 
     # -- Try to determine if all images already exist
 
+    code_pieces = split_code_at_show(code)
+
     # Look for single-figure output files first
     all_exists = True
     img = ImageFile(output_base, output_dir)
@@ -469,54 +517,66 @@ def makefig(code, code_path, output_dir, output_base, config):
         img.formats.append(format)
 
     if all_exists:
-        return [img]
+        return [(code, [img])]
 
     # Then look for multi-figure output files
-    images = []
+    results = []
     all_exists = True
-    for i in xrange(1000):
-        img = ImageFile('%s_%02d' % (output_base, i), output_dir)
-        for format, dpi in formats:
-            if out_of_date(code_path, img.filename(format)):
-                all_exists = False
+    for i, code_piece in enumerate(code_pieces):
+        images = []
+        for j in xrange(1000):
+            img = ImageFile('%s_%02d_%02d' % (output_base, i, j), output_dir)
+            for format, dpi in formats:
+                if out_of_date(code_path, img.filename(format)):
+                    all_exists = False
+                    break
+                img.formats.append(format)
+
+            # assume that if we have one, we have them all
+            if not all_exists:
+                all_exists = (j > 0)
                 break
-            img.formats.append(format)
-        
-        # assume that if we have one, we have them all
+            images.append(img)
         if not all_exists:
-            all_exists = (i > 0)
             break
-        images.append(img)
+        results.append((code_piece, images))
 
     if all_exists:
-        return images
+        return results
 
     # -- We didn't find the files, so build them
 
-    # Clear between runs
-    plt.close('all')
+    results = []
+    ns = {}
 
-    # Run code
-    run_code(code, code_path)
+    for i, code_piece in enumerate(code_pieces):
+        # Clear between runs
+        plt.close('all')
 
-    # Collect images
-    images = []
+        # Run code
+        run_code(code_piece, code_path, ns)
 
-    fig_managers = _pylab_helpers.Gcf.get_all_fig_managers()
-    for i, figman in enumerate(fig_managers):
-        if len(fig_managers) == 1:
-            img = ImageFile(output_base, output_dir)
-        else:
-            img = ImageFile("%s_%02d" % (output_base, i), output_dir)
-        images.append(img)
-        for format, dpi in formats:
-            try:
-                figman.canvas.figure.savefig(img.filename(format), dpi=dpi)
-            except exceptions.BaseException, err:
-                raise PlotError(traceback.format_exc())
-            img.formats.append(format)
+        # Collect images
+        images = []
+        fig_managers = _pylab_helpers.Gcf.get_all_fig_managers()
+        for j, figman in enumerate(fig_managers):
+            if len(fig_managers) == 1 and len(code_pieces) == 1:
+                img = ImageFile(output_base, output_dir)
+            else:
+                img = ImageFile("%s_%02d_%02d" % (output_base, i, j),
+                                output_dir)
+            images.append(img)
+            for format, dpi in formats:
+                try:
+                    figman.canvas.figure.savefig(img.filename(format), dpi=dpi)
+                except exceptions.BaseException, err:
+                    raise PlotError(traceback.format_exc())
+                img.formats.append(format)
 
-    return images
+        # Results
+        results.append((code_piece, images))
+
+    return results
 
 
 #------------------------------------------------------------------------------
@@ -526,38 +586,55 @@ def makefig(code, code_path, output_dir, output_base, config):
 try:
     from os.path import relpath
 except ImportError:
-    def relpath(target, base=os.curdir):
-        """
-        Return a relative path to the target from either the current
-        dir or an optional base dir.  Base can be a directory
-        specified either as absolute or relative to current dir.
-        """
-
-        if not os.path.exists(target):
-            raise OSError, 'Target does not exist: '+target
-
-        if not os.path.isdir(base):
-            raise OSError, 'Base is not a directory or does not exist: '+base
-
-        base_list = (os.path.abspath(base)).split(os.sep)
-        target_list = (os.path.abspath(target)).split(os.sep)
-
-        # On the windows platform the target may be on a completely
-        # different drive from the base.
-        if os.name in ['nt','dos','os2'] and base_list[0] <> target_list[0]:
-            raise OSError, 'Target is on a different drive to base. Target: '+target_list[0].upper()+', base: '+base_list[0].upper()
-
-        # Starting from the filepath root, work out how much of the
-        # filepath is shared by base and target.
-        for i in range(min(len(base_list), len(target_list))):
-            if base_list[i] <> target_list[i]: break
-        else:
-            # If we broke out of the loop, i is pointing to the first
-            # differing path elements.  If we didn't break out of the
-            # loop, i is pointing to identical path elements.
-            # Increment i so that in all cases it points to the first
-            # differing path elements.
-            i+=1
-
-        rel_list = [os.pardir] * (len(base_list)-i) + target_list[i:]
-        return os.path.join(*rel_list)
+    # Copied from Python 2.7
+    if 'posix' in sys.builtin_module_names:
+        def relpath(path, start=os.path.curdir):
+            """Return a relative version of a path"""
+            from os.path import sep, curdir, join, abspath, commonprefix, \
+                 pardir
+
+            if not path:
+                raise ValueError("no path specified")
+
+            start_list = abspath(start).split(sep)
+            path_list = abspath(path).split(sep)
+
+            # Work out how much of the filepath is shared by start and path.
+            i = len(commonprefix([start_list, path_list]))
+
+            rel_list = [pardir] * (len(start_list)-i) + path_list[i:]
+            if not rel_list:
+                return curdir
+            return join(*rel_list)
+    elif 'nt' in sys.builtin_module_names:
+        def relpath(path, start=os.path.curdir):
+            """Return a relative version of a path"""
+            from os.path import sep, curdir, join, abspath, commonprefix, \
+                 pardir, splitunc
+
+            if not path:
+                raise ValueError("no path specified")
+            start_list = abspath(start).split(sep)
+            path_list = abspath(path).split(sep)
+            if start_list[0].lower() != path_list[0].lower():
+                unc_path, rest = splitunc(path)
+                unc_start, rest = splitunc(start)
+                if bool(unc_path) ^ bool(unc_start):
+                    raise ValueError("Cannot mix UNC and non-UNC paths (%s and %s)"
+                                                                        % (path, start))
+                else:
+                    raise ValueError("path is on drive %s, start on drive %s"
+                                                        % (path_list[0], start_list[0]))
+            # Work out how much of the filepath is shared by start and path.
+            for i in range(min(len(start_list), len(path_list))):
+                if start_list[i].lower() != path_list[i].lower():
+                    break
+            else:
+                i += 1
+
+            rel_list = [pardir] * (len(start_list)-i) + path_list[i:]
+            if not rel_list:
+                return curdir
+            return join(*rel_list)
+    else:
+        raise RuntimeError("Unsupported platform (no relpath available!)")
diff --git a/doc/sphinxext/setup.py b/doc/sphinxext/setup.py
index db4609a04..016d8f8ae 100755
--- a/doc/sphinxext/setup.py
+++ b/doc/sphinxext/setup.py
@@ -2,7 +2,7 @@ from distutils.core import setup
 import setuptools
 import sys, os
 
-version = "0.2.dev"
+version = "0.3.dev"
 
 setup(
     name="numpydoc",
@@ -22,7 +22,7 @@ setup(
     license="BSD",
     zip_safe=False,
     install_requires=["Sphinx >= 0.5"],
-    package_data={'numpydoc': 'tests'},
+    package_data={'numpydoc': 'tests', '': ''},
     entry_points={
         "console_scripts": [
             "autosummary_generate = numpydoc.autosummary_generate:main",
diff --git a/doc/sphinxext/tests/test_docscrape.py b/doc/sphinxext/tests/test_docscrape.py
index 4a1f64cf5..1d775e99e 100755
--- a/doc/sphinxext/tests/test_docscrape.py
+++ b/doc/sphinxext/tests/test_docscrape.py
@@ -3,8 +3,8 @@
 import sys, os
 sys.path.append(os.path.join(os.path.dirname(__file__), '..'))
 
-from docscrape import NumpyDocString, FunctionDoc
-from docscrape_sphinx import SphinxDocString
+from docscrape import NumpyDocString, FunctionDoc, ClassDoc
+from docscrape_sphinx import SphinxDocString, SphinxClassDoc
 from nose.tools import *
 
 doc_txt = '''\
@@ -329,6 +329,10 @@ definite.
 .. [2] R.O. Duda, P.E. Hart, and D.G. Stork, "Pattern Classification,"
        2nd ed., Wiley, 2001.
 
+.. only:: latex
+
+   [1]_, [2]_
+
 .. rubric:: Examples
 
 >>> mean = (1,2)
@@ -490,13 +494,15 @@ def test_unicode():
     assert doc['Summary'][0] == u'öäöäöäöäöåååå'.encode('utf-8')
 
 def test_plot_examples():
+    cfg = dict(use_plots=True)
+
     doc = SphinxDocString("""
     Examples
     --------
     >>> import matplotlib.pyplot as plt
     >>> plt.plot([1,2,3],[4,5,6])
     >>> plt.show()
-    """)
+    """, config=cfg)
     assert 'plot::' in str(doc), str(doc)
 
     doc = SphinxDocString("""
@@ -507,5 +513,33 @@ def test_plot_examples():
        import matplotlib.pyplot as plt
        plt.plot([1,2,3],[4,5,6])
        plt.show()
-    """)
+    """, config=cfg)
     assert str(doc).count('plot::') == 1, str(doc)
+
+def test_class_members():
+
+    class Dummy(object):
+        """
+        Dummy class.
+
+        """
+        def spam(self, a, b):
+            """Spam\n\nSpam spam."""
+            pass
+        def ham(self, c, d):
+            """Cheese\n\nNo cheese."""
+            pass
+
+    for cls in (ClassDoc, SphinxClassDoc):
+        doc = cls(Dummy, config=dict(show_class_members=False))
+        assert 'Methods' not in str(doc), (cls, str(doc))
+        assert 'spam' not in str(doc), (cls, str(doc))
+        assert 'ham' not in str(doc), (cls, str(doc))
+
+        doc = cls(Dummy, config=dict(show_class_members=True))
+        assert 'Methods' in str(doc), (cls, str(doc))
+        assert 'spam' in str(doc), (cls, str(doc))
+        assert 'ham' in str(doc), (cls, str(doc))
+
+        if cls is SphinxClassDoc:
+            assert '.. autosummary::' in str(doc), str(doc)
diff --git a/doc/sphinxext/traitsdoc.py b/doc/sphinxext/traitsdoc.py
index 6bfd14906..0fcf2c1cd 100755
--- a/doc/sphinxext/traitsdoc.py
+++ b/doc/sphinxext/traitsdoc.py
@@ -111,7 +111,7 @@ def looks_like_issubclass(obj, classname):
             return True
     return False
 
-def get_doc_object(obj, what=None):
+def get_doc_object(obj, what=None, config=None):
     if what is None:
         if inspect.isclass(obj):
             what = 'class'
@@ -122,7 +122,7 @@ def get_doc_object(obj, what=None):
         else:
             what = 'object'
     if what == 'class':
-        doc = SphinxTraitsDoc(obj, '', func_doc=SphinxFunctionDoc)
+        doc = SphinxTraitsDoc(obj, '', func_doc=SphinxFunctionDoc, config=config)
         if looks_like_issubclass(obj, 'HasTraits'):
             for name, trait, comment in comment_eater.get_class_traits(obj):
                 # Exclude private traits.
@@ -130,9 +130,9 @@ def get_doc_object(obj, what=None):
                     doc['Traits'].append((name, trait, comment.splitlines()))
         return doc
     elif what in ('function', 'method'):
-        return SphinxFunctionDoc(obj, '')
+        return SphinxFunctionDoc(obj, '', config=config)
     else:
-        return SphinxDocString(pydoc.getdoc(obj))
+        return SphinxDocString(pydoc.getdoc(obj), config=config)
 
 def setup(app):
     # init numpydoc
diff --git a/pandas/core/common.py b/pandas/core/common.py
index 1e1dd28a4..8c568ac51 100644
--- a/pandas/core/common.py
+++ b/pandas/core/common.py
@@ -60,17 +60,13 @@ def _unpickle_array(bytes):
     arr = read_array(StringIO(bytes))
     return arr
 
-def _to_str(x):
-    # str(x) fails when x contains unicode
-    return '%s' % x
-
 def _pfixed(s, space, nanRep=None, float_format=None):
     if isinstance(s, float):
         if nanRep is not None and isnull(s):
             if np.isnan(s):
                 return nanRep.ljust(space)
             else:
-                return str(s).ljust(space)
+                return ('%s' % s).ljust(space)
 
         if float_format:
             formatted = float_format(s)
@@ -79,7 +75,7 @@ def _pfixed(s, space, nanRep=None, float_format=None):
 
         return formatted.ljust(space)
     else:
-        return _to_str(s)[:space].ljust(space)
+        return ('%s' % s)[:space].ljust(space)
 
 
 
diff --git a/pandas/core/panel.py b/pandas/core/panel.py
index 3635dd800..b425826e9 100644
--- a/pandas/core/panel.py
+++ b/pandas/core/panel.py
@@ -82,7 +82,7 @@ class PanelAxis(object):
         self.cache_field = cache_field
 
     def __get__(self, obj, type=None):
-        return getattr(obj, self.cache_field)
+        return getattr(obj, self.cache_field, None)
 
     def __set__(self, obj, value):
         if not isinstance(value, Index):
diff --git a/pandas/lib/src/common.pyx b/pandas/lib/src/common.pyx
index 7171fb095..a432795d9 100644
--- a/pandas/lib/src/common.pyx
+++ b/pandas/lib/src/common.pyx
@@ -1,10 +1,11 @@
 cimport numpy as np
 cimport cython
+
 from numpy cimport *
 
-from python_dict cimport (PyDict_New, PyDict_GetItem, PyDict_SetItem,
+from cpython cimport (PyDict_New, PyDict_GetItem, PyDict_SetItem,
                           PyDict_Contains, PyDict_Keys)
-from python_float cimport PyFloat_Check
+from cpython cimport PyFloat_Check
 
 import numpy as np
 isnan = np.isnan
diff --git a/pandas/lib/src/moments.pyx b/pandas/lib/src/moments.pyx
index 28adc005d..36779cca9 100644
--- a/pandas/lib/src/moments.pyx
+++ b/pandas/lib/src/moments.pyx
@@ -395,7 +395,7 @@ def roll_kurt(ndarray[double_t, ndim=1] input,
 #-------------------------------------------------------------------------------
 # Rolling median, min, max
 
-ctypedef double_t (* skiplist_f)(IndexableSkiplist sl, int n, int p)
+ctypedef double_t (* skiplist_f)(object sl, int n, int p)
 
 cdef _roll_skiplist_op(ndarray arg, int win, int minp, skiplist_f op):
     cdef ndarray[double_t, ndim=1] input = arg
@@ -457,9 +457,12 @@ def roll_min(ndarray input, int win, int minp):
     '''
     return _roll_skiplist_op(input, win, minp, _get_min)
 
-cdef double_t _get_median(IndexableSkiplist skiplist, int nobs,
-                          int minp):
+# Unfortunately had to resort to some hackery here, would like for
+# Cython to be able to get this right.
+
+cdef double_t _get_median(object sl, int nobs, int minp):
     cdef int midpoint
+    cdef IndexableSkiplist skiplist = <IndexableSkiplist> sl
     if nobs >= minp:
         midpoint = nobs / 2
         if nobs % 2:
@@ -470,16 +473,14 @@ cdef double_t _get_median(IndexableSkiplist skiplist, int nobs,
     else:
         return NaN
 
-cdef double_t _get_max(IndexableSkiplist skiplist, int nobs,
-                       int minp):
+cdef double_t _get_max(object skiplist, int nobs, int minp):
     if nobs >= minp:
-        return skiplist.get(nobs - 1)
+        return <IndexableSkiplist> skiplist.get(nobs - 1)
     else:
         return NaN
 
-cdef double_t _get_min(IndexableSkiplist skiplist, int nobs,
-                       int minp):
+cdef double_t _get_min(object skiplist, int nobs, int minp):
     if nobs >= minp:
-        return skiplist.get(0)
+        return <IndexableSkiplist> skiplist.get(0)
     else:
         return NaN
diff --git a/pandas/lib/src/skiplist.pyx b/pandas/lib/src/skiplist.pyx
index f1bbbf463..40964e25a 100644
--- a/pandas/lib/src/skiplist.pyx
+++ b/pandas/lib/src/skiplist.pyx
@@ -66,7 +66,7 @@ cdef class IndexableSkiplist:
     def __getitem__(self, i):
         return self.get(i)
 
-    def get(self, int i):
+    cpdef get(self, int i):
         cdef int level
         cdef Node node
 
@@ -80,7 +80,7 @@ cdef class IndexableSkiplist:
 
         return node.value
 
-    def insert(self, double value):
+    cpdef insert(self, double value):
         cdef int level, steps, d
         cdef Node node, prevnode, newnode, next_at_level
         cdef list chain, steps_at_level
@@ -122,7 +122,7 @@ cdef class IndexableSkiplist:
 
         self.size += 1
 
-    def remove(self, double value):
+    cpdef remove(self, double value):
         cdef int level, d
         cdef Node node, prevnode, tmpnode, next_at_level
         cdef list chain
diff --git a/pandas/lib/src/tseries.c b/pandas/lib/src/tseries.c
index 1647b954d..bf9d3e15d 100644
--- a/pandas/lib/src/tseries.c
+++ b/pandas/lib/src/tseries.c
@@ -1,18 +1,39 @@
-/* Generated by Cython 0.12.1 on Thu Jul 15 13:54:29 2010 */
+/* Generated by Cython 0.13 on Sun Sep 19 23:25:09 2010 */
 
 #define PY_SSIZE_T_CLEAN
 #include "Python.h"
-#include "structmember.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #else
 
-#ifndef PY_LONG_LONG
-  #define PY_LONG_LONG LONG_LONG
+#include <stddef.h> /* For offsetof */
+#ifndef offsetof
+#define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
+#endif
+
+#if !defined(WIN32) && !defined(MS_WINDOWS)
+  #ifndef __stdcall
+    #define __stdcall
+  #endif
+  #ifndef __cdecl
+    #define __cdecl
+  #endif
+  #ifndef __fastcall
+    #define __fastcall
+  #endif
+#endif
+
+#ifndef DL_IMPORT
+  #define DL_IMPORT(t) t
 #endif
 #ifndef DL_EXPORT
   #define DL_EXPORT(t) t
 #endif
+
+#ifndef PY_LONG_LONG
+  #define PY_LONG_LONG LONG_LONG
+#endif
+
 #if PY_VERSION_HEX < 0x02040000
   #define METH_COEXIST 0
   #define PyDict_CheckExact(op) (Py_TYPE(op) == &PyDict_Type)
@@ -82,11 +103,35 @@
 
 #if PY_MAJOR_VERSION >= 3
   #define PyBaseString_Type            PyUnicode_Type
+  #define PyStringObject               PyUnicodeObject
   #define PyString_Type                PyUnicode_Type
+  #define PyString_Check               PyUnicode_Check
   #define PyString_CheckExact          PyUnicode_CheckExact
-#else
+#endif
+
+#if PY_VERSION_HEX < 0x02060000
+  #define PyBytesObject                PyStringObject
   #define PyBytes_Type                 PyString_Type
+  #define PyBytes_Check                PyString_Check
   #define PyBytes_CheckExact           PyString_CheckExact
+  #define PyBytes_FromString           PyString_FromString
+  #define PyBytes_FromStringAndSize    PyString_FromStringAndSize
+  #define PyBytes_FromFormat           PyString_FromFormat
+  #define PyBytes_DecodeEscape         PyString_DecodeEscape
+  #define PyBytes_AsString             PyString_AsString
+  #define PyBytes_AsStringAndSize      PyString_AsStringAndSize
+  #define PyBytes_Size                 PyString_Size
+  #define PyBytes_AS_STRING            PyString_AS_STRING
+  #define PyBytes_GET_SIZE             PyString_GET_SIZE
+  #define PyBytes_Repr                 PyString_Repr
+  #define PyBytes_Concat               PyString_Concat
+  #define PyBytes_ConcatAndDel         PyString_ConcatAndDel
+  #define PySet_Check(obj)             PyObject_TypeCheck(obj, &PySet_Type)
+  #define PyFrozenSet_Check(obj)       PyObject_TypeCheck(obj, &PyFrozenSet_Type)
+#endif
+
+#ifndef PySet_CheckExact
+#  define PySet_CheckExact(obj)          (Py_TYPE(obj) == &PySet_Type)
 #endif
 
 #if PY_MAJOR_VERSION >= 3
@@ -103,30 +148,23 @@
   #define PyInt_AsSsize_t              PyLong_AsSsize_t
   #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
   #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
+#endif
+
+#if PY_MAJOR_VERSION >= 3
+  #define PyBoolObject PyLongObject
+#endif
+
+
+#if PY_MAJOR_VERSION >= 3
   #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
   #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
 #else
   #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
   #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceDivide(x,y)
-
 #endif
 
 #if PY_MAJOR_VERSION >= 3
-  #define PyMethod_New(func, self, klass) PyInstanceMethod_New(func)
-#endif
-
-#if !defined(WIN32) && !defined(MS_WINDOWS)
-  #ifndef __stdcall
-    #define __stdcall
-  #endif
-  #ifndef __cdecl
-    #define __cdecl
-  #endif
-  #ifndef __fastcall
-    #define __fastcall
-  #endif
-#else
-  #define _USE_MATH_DEFINES
+  #define PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : PyInstanceMethod_New(func))
 #endif
 
 #if PY_VERSION_HEX < 0x02050000
@@ -146,115 +184,67 @@
   #define __Pyx_NAMESTR(n) (n)
   #define __Pyx_DOCSTR(n)  (n)
 #endif
+
 #ifdef __cplusplus
 #define __PYX_EXTERN_C extern "C"
 #else
 #define __PYX_EXTERN_C extern
 #endif
+
+#if defined(WIN32) || defined(MS_WINDOWS)
+#define _USE_MATH_DEFINES
+#endif
 #include <math.h>
 #define __PYX_HAVE_API__tseries
-#include "stdlib.h"
 #include "stdio.h"
+#include "stdlib.h"
 #include "numpy/arrayobject.h"
 #include "numpy/ufuncobject.h"
+#include "pythread.h"
 #include "math.h"
 #include "cobject.h"
 #include "datetime.h"
 
+/* inline attribute */
 #ifndef CYTHON_INLINE
   #if defined(__GNUC__)
     #define CYTHON_INLINE __inline__
   #elif defined(_MSC_VER)
     #define CYTHON_INLINE __inline
+  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
+    #define CYTHON_INLINE inline
   #else
     #define CYTHON_INLINE 
   #endif
 #endif
 
+/* unused attribute */
+#ifndef CYTHON_UNUSED
+# if defined(__GNUC__)
+#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
+#     define CYTHON_UNUSED __attribute__ ((__unused__)) 
+#   else
+#     define CYTHON_UNUSED
+#   endif
+# elif defined(__ICC) || defined(__INTEL_COMPILER)
+#   define CYTHON_UNUSED __attribute__ ((__unused__)) 
+# else
+#   define CYTHON_UNUSED 
+# endif
+#endif
+
 typedef struct {PyObject **p; char *s; const long n; const char* encoding; const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry; /*proto*/
 
 
 /* Type Conversion Predeclarations */
 
-#if PY_MAJOR_VERSION < 3
-#define __Pyx_PyBytes_FromString          PyString_FromString
-#define __Pyx_PyBytes_FromStringAndSize   PyString_FromStringAndSize
-#define __Pyx_PyBytes_AsString            PyString_AsString
-#else
-#define __Pyx_PyBytes_FromString          PyBytes_FromString
-#define __Pyx_PyBytes_FromStringAndSize   PyBytes_FromStringAndSize
-#define __Pyx_PyBytes_AsString            PyBytes_AsString
-#endif
-
-#define __Pyx_PyBytes_FromUString(s)      __Pyx_PyBytes_FromString((char*)s)
-#define __Pyx_PyBytes_AsUString(s)        ((unsigned char*) __Pyx_PyBytes_AsString(s))
+#define __Pyx_PyBytes_FromUString(s) PyBytes_FromString((char*)s)
+#define __Pyx_PyBytes_AsUString(s)   ((unsigned char*) PyBytes_AsString(s))
 
 #define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x);
 
-#if !defined(T_PYSSIZET)
-#if PY_VERSION_HEX < 0x02050000
-#define T_PYSSIZET T_INT
-#elif !defined(T_LONGLONG)
-#define T_PYSSIZET \
-        ((sizeof(Py_ssize_t) == sizeof(int))  ? T_INT  : \
-        ((sizeof(Py_ssize_t) == sizeof(long)) ? T_LONG : -1))
-#else
-#define T_PYSSIZET \
-        ((sizeof(Py_ssize_t) == sizeof(int))          ? T_INT      : \
-        ((sizeof(Py_ssize_t) == sizeof(long))         ? T_LONG     : \
-        ((sizeof(Py_ssize_t) == sizeof(PY_LONG_LONG)) ? T_LONGLONG : -1)))
-#endif
-#endif
-
-
-#if !defined(T_ULONGLONG)
-#define __Pyx_T_UNSIGNED_INT(x) \
-        ((sizeof(x) == sizeof(unsigned char))  ? T_UBYTE : \
-        ((sizeof(x) == sizeof(unsigned short)) ? T_USHORT : \
-        ((sizeof(x) == sizeof(unsigned int))   ? T_UINT : \
-        ((sizeof(x) == sizeof(unsigned long))  ? T_ULONG : -1))))
-#else
-#define __Pyx_T_UNSIGNED_INT(x) \
-        ((sizeof(x) == sizeof(unsigned char))  ? T_UBYTE : \
-        ((sizeof(x) == sizeof(unsigned short)) ? T_USHORT : \
-        ((sizeof(x) == sizeof(unsigned int))   ? T_UINT : \
-        ((sizeof(x) == sizeof(unsigned long))  ? T_ULONG : \
-        ((sizeof(x) == sizeof(unsigned PY_LONG_LONG)) ? T_ULONGLONG : -1)))))
-#endif
-#if !defined(T_LONGLONG)
-#define __Pyx_T_SIGNED_INT(x) \
-        ((sizeof(x) == sizeof(char))  ? T_BYTE : \
-        ((sizeof(x) == sizeof(short)) ? T_SHORT : \
-        ((sizeof(x) == sizeof(int))   ? T_INT : \
-        ((sizeof(x) == sizeof(long))  ? T_LONG : -1))))
-#else
-#define __Pyx_T_SIGNED_INT(x) \
-        ((sizeof(x) == sizeof(char))  ? T_BYTE : \
-        ((sizeof(x) == sizeof(short)) ? T_SHORT : \
-        ((sizeof(x) == sizeof(int))   ? T_INT : \
-        ((sizeof(x) == sizeof(long))  ? T_LONG : \
-        ((sizeof(x) == sizeof(PY_LONG_LONG))   ? T_LONGLONG : -1)))))
-#endif
-
-#define __Pyx_T_FLOATING(x) \
-        ((sizeof(x) == sizeof(float)) ? T_FLOAT : \
-        ((sizeof(x) == sizeof(double)) ? T_DOUBLE : -1))
-
-#if !defined(T_SIZET)
-#if !defined(T_ULONGLONG)
-#define T_SIZET \
-        ((sizeof(size_t) == sizeof(unsigned int))  ? T_UINT  : \
-        ((sizeof(size_t) == sizeof(unsigned long)) ? T_ULONG : -1))
-#else
-#define T_SIZET \
-        ((sizeof(size_t) == sizeof(unsigned int))          ? T_UINT      : \
-        ((sizeof(size_t) == sizeof(unsigned long))         ? T_ULONG     : \
-        ((sizeof(size_t) == sizeof(unsigned PY_LONG_LONG)) ? T_ULONGLONG : -1)))
-#endif
-#endif
-
 static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
 static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
 static CYTHON_INLINE size_t __Pyx_PyInt_AsSize_t(PyObject*);
@@ -264,7 +254,7 @@ static CYTHON_INLINE size_t __Pyx_PyInt_AsSize_t(PyObject*);
 
 #ifdef __GNUC__
 /* Test for GCC > 2.95 */
-#if __GNUC__ > 2 ||               (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)) 
+#if __GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)) 
 #define likely(x)   __builtin_expect(!!(x), 1)
 #define unlikely(x) __builtin_expect(!!(x), 0)
 #else /* __GNUC__ > 2 ... */
@@ -284,7 +274,6 @@ static int __pyx_lineno;
 static int __pyx_clineno = 0;
 static const char * __pyx_cfilenm= __FILE__;
 static const char *__pyx_filename;
-static const char **__pyx_f;
 
 
 #if !defined(CYTHON_CCOMPLEX)
@@ -310,6 +299,20 @@ static const char **__pyx_f;
   #define _Complex_I 1.0fj
 #endif
 
+static const char *__pyx_f[] = {
+  "common.pyx",
+  "skiplist.pyx",
+  "io.pyx",
+  "isnull.pyx",
+  "groupby.pyx",
+  "moments.pyx",
+  "reindex.pyx",
+  "operators.pyx",
+  "numpy.pxd",
+  "tseries.pyx",
+  "bool.pxd",
+};
+
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
 typedef npy_int16 __pyx_t_5numpy_int16_t;
@@ -380,11 +383,11 @@ typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
 
-typedef __pyx_t_5numpy_double_t (*__pyx_t_7tseries_skiplist_f)(struct __pyx_obj_7tseries_IndexableSkiplist *, int, int);
+typedef __pyx_t_5numpy_double_t (*__pyx_t_7tseries_skiplist_f)(PyObject *, int, int);
 
 typedef double (*__pyx_t_7tseries_double_func)(double, double);
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":48
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":48
  * NIL = Node(np.inf, [], np.array([])) # Singleton terminator node
  * 
  * cdef class IndexableSkiplist:             # <<<<<<<<<<<<<<
@@ -394,12 +397,13 @@ typedef double (*__pyx_t_7tseries_double_func)(double, double);
 
 struct __pyx_obj_7tseries_IndexableSkiplist {
   PyObject_HEAD
+  struct __pyx_vtabstruct_7tseries_IndexableSkiplist *__pyx_vtab;
   int size;
   int maxlevels;
   struct __pyx_obj_7tseries_Node *head;
 };
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":30
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":30
  * import_array()
  * 
  * cdef class Node:             # <<<<<<<<<<<<<<
@@ -415,6 +419,22 @@ struct __pyx_obj_7tseries_Node {
   int *width;
 };
 
+
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":48
+ * NIL = Node(np.inf, [], np.array([])) # Singleton terminator node
+ * 
+ * cdef class IndexableSkiplist:             # <<<<<<<<<<<<<<
+ *     '''
+ *     Sorted collection supporting O(lg n) insertion, removal, and lookup by rank.
+ */
+
+struct __pyx_vtabstruct_7tseries_IndexableSkiplist {
+  PyObject *(*get)(struct __pyx_obj_7tseries_IndexableSkiplist *, int, int __pyx_skip_dispatch);
+  PyObject *(*insert)(struct __pyx_obj_7tseries_IndexableSkiplist *, double, int __pyx_skip_dispatch);
+  PyObject *(*remove)(struct __pyx_obj_7tseries_IndexableSkiplist *, double, int __pyx_skip_dispatch);
+};
+static struct __pyx_vtabstruct_7tseries_IndexableSkiplist *__pyx_vtabptr_7tseries_IndexableSkiplist;
+
 #ifndef CYTHON_REFNANNY
   #define CYTHON_REFNANNY 0
 #endif
@@ -461,8 +481,13 @@ struct __pyx_obj_7tseries_Node {
 #define __Pyx_XGIVEREF(r) do { if((r) != NULL) {__Pyx_GIVEREF(r);} } while(0)
 #define __Pyx_XGOTREF(r) do { if((r) != NULL) {__Pyx_GOTREF(r);} } while(0)
 
+static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/
+
 static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb); /*proto*/
 
+static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
+    const char *name, int exact); /*proto*/
+
 /* Run-time type information about structs used with buffers */
 struct __Pyx_StructField_;
 
@@ -485,8 +510,8 @@ typedef struct {
 } __Pyx_BufFmt_StackElem;
 
 
+static CYTHON_INLINE int  __Pyx_GetBufferAndValidate(Py_buffer* buf, PyObject* obj, __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack);
 static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info);
-static int __Pyx_GetBufferAndValidate(Py_buffer* buf, PyObject* obj, __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack);
 static void __Pyx_RaiseBufferIndexError(int axis); /*proto*/
 #define __Pyx_BufPtrStrided1d(type, buf, i0, s0) (type)((char*)buf + i0 * s0)
 
@@ -513,11 +538,11 @@ static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j
 }
 
 
-#define __Pyx_GetItemInt_List(o, i, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
-                                                    __Pyx_GetItemInt_List_Fast(o, i, size <= sizeof(long)) : \
+#define __Pyx_GetItemInt_List(o, i, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
+                                                    __Pyx_GetItemInt_List_Fast(o, i) : \
                                                     __Pyx_GetItemInt_Generic(o, to_py_func(i)))
 
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i, int fits_long) {
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i) {
     if (likely(o != Py_None)) {
         if (likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
             PyObject *r = PyList_GET_ITEM(o, i);
@@ -530,14 +555,14 @@ static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_
             return r;
         }
     }
-    return __Pyx_GetItemInt_Generic(o, fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i));
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
 }
 
-#define __Pyx_GetItemInt_Tuple(o, i, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
-                                                    __Pyx_GetItemInt_Tuple_Fast(o, i, size <= sizeof(long)) : \
+#define __Pyx_GetItemInt_Tuple(o, i, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
+                                                    __Pyx_GetItemInt_Tuple_Fast(o, i) : \
                                                     __Pyx_GetItemInt_Generic(o, to_py_func(i)))
 
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i, int fits_long) {
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i) {
     if (likely(o != Py_None)) {
         if (likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
             PyObject *r = PyTuple_GET_ITEM(o, i);
@@ -550,15 +575,15 @@ static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize
             return r;
         }
     }
-    return __Pyx_GetItemInt_Generic(o, fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i));
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
 }
 
 
-#define __Pyx_GetItemInt(o, i, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
-                                                    __Pyx_GetItemInt_Fast(o, i, size <= sizeof(long)) : \
+#define __Pyx_GetItemInt(o, i, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
+                                                    __Pyx_GetItemInt_Fast(o, i) : \
                                                     __Pyx_GetItemInt_Generic(o, to_py_func(i)))
 
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int fits_long) {
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i) {
     PyObject *r;
     if (PyList_CheckExact(o) && ((0 <= i) & (i < PyList_GET_SIZE(o)))) {
         r = PyList_GET_ITEM(o, i);
@@ -572,13 +597,13 @@ static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
         r = PySequence_GetItem(o, i);
     }
     else {
-        r = __Pyx_GetItemInt_Generic(o, fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i));
+        r = __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
     }
     return r;
 }
 
-#define __Pyx_SetItemInt(o, i, v, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
-                                                    __Pyx_SetItemInt_Fast(o, i, v, size <= sizeof(long)) : \
+#define __Pyx_SetItemInt(o, i, v, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
+                                                    __Pyx_SetItemInt_Fast(o, i, v) : \
                                                     __Pyx_SetItemInt_Generic(o, to_py_func(i), v))
 
 static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v) {
@@ -589,7 +614,7 @@ static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyOb
     return r;
 }
 
-static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v, int fits_long) {
+static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v) {
     if (PyList_CheckExact(o) && ((0 <= i) & (i < PyList_GET_SIZE(o)))) {
         Py_INCREF(v);
         Py_DECREF(PyList_GET_ITEM(o, i));
@@ -599,7 +624,7 @@ static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObje
     else if (Py_TYPE(o)->tp_as_sequence && Py_TYPE(o)->tp_as_sequence->sq_ass_item && (likely(i >= 0)))
         return PySequence_SetItem(o, i, v);
     else {
-        PyObject *j = fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i);
+        PyObject *j = PyInt_FromSsize_t(i);
         return __Pyx_SetItemInt_Generic(o, j, v);
     }
 }
@@ -613,22 +638,42 @@ static CYTHON_INLINE PyObject* __Pyx_PyBoolOrNull_FromLong(long b) {
 
 static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void);
 
+static CYTHON_INLINE void __Pyx_RaiseNoneIndexingError(void);
+
+
+#if PY_MAJOR_VERSION >= 3
+static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
+    PyObject *value;
+    if (unlikely(d == Py_None)) {
+        __Pyx_RaiseNoneIndexingError();
+        return NULL;
+    }
+    value = PyDict_GetItemWithError(d, key);
+    if (unlikely(!value)) {
+        if (!PyErr_Occurred())
+            PyErr_SetObject(PyExc_KeyError, key);
+        return NULL;
+    }
+    Py_INCREF(value);
+    return value;
+}
+#else
+    #define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
+#endif
+
 static CYTHON_INLINE long __Pyx_mod_long(long, long); /* proto */
 
 static CYTHON_INLINE long __Pyx_div_long(long, long); /* proto */
 
 static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);
 
-static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(void);
+static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);
 
 static PyObject *__Pyx_UnpackItem(PyObject *, Py_ssize_t index); /*proto*/
-static int __Pyx_EndUnpack(PyObject *); /*proto*/
+static int __Pyx_EndUnpack(PyObject *, Py_ssize_t expected); /*proto*/
 
 static void __Pyx_UnpackTupleError(PyObject *, Py_ssize_t index); /*proto*/
 
-static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
-    const char *name, int exact); /*proto*/
-
 static CYTHON_INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb); /*proto*/
 static void __Pyx_ExceptionReset(PyObject *type, PyObject *value, PyObject *tb); /*proto*/
 #if PY_MAJOR_VERSION < 3
@@ -644,8 +689,6 @@ Py_ssize_t __Pyx_minusones[] = {-1};
 
 static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/
 
-static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/
-
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/
 
 static CYTHON_INLINE npy_int32 __Pyx_PyInt_from_py_npy_int32(PyObject *);
@@ -751,6 +794,8 @@ static CYTHON_INLINE signed short __Pyx_PyInt_AsSignedShort(PyObject *);
 
 static CYTHON_INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject *);
 
+static CYTHON_INLINE int __Pyx_PyInt_AsLongDouble(PyObject *);
+
 static CYTHON_INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject *);
 
 static CYTHON_INLINE unsigned PY_LONG_LONG __Pyx_PyInt_AsUnsignedLongLong(PyObject *);
@@ -771,16 +816,20 @@ static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class
 
 static PyObject *__Pyx_ImportModule(const char *name); /*proto*/
 
+static int __Pyx_SetVtable(PyObject *dict, void *vtable); /*proto*/
+
 static void __Pyx_AddTraceback(const char *funcname); /*proto*/
 
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/
-/* Module declarations from python_buffer */
+/* Module declarations from cpython.buffer */
 
-/* Module declarations from python_ref */
+/* Module declarations from cpython.ref */
 
-/* Module declarations from stdlib */
+/* Module declarations from libc.stdio */
 
-/* Module declarations from stdio */
+/* Module declarations from cpython.object */
+
+/* Module declarations from libc.stdlib */
 
 /* Module declarations from numpy */
 
@@ -801,9 +850,70 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *, PyObjec
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *); /*proto*/
 /* Module declarations from cython */
 
-/* Module declarations from python_dict */
+/* Module declarations from cpython.version */
+
+/* Module declarations from cpython.exc */
+
+/* Module declarations from cpython.module */
+
+/* Module declarations from cpython.mem */
+
+/* Module declarations from cpython.tuple */
+
+/* Module declarations from cpython.list */
+
+/* Module declarations from cpython.sequence */
+
+/* Module declarations from cpython.mapping */
+
+/* Module declarations from cpython.iterator */
+
+/* Module declarations from cpython.type */
+
+/* Module declarations from cpython.number */
+
+/* Module declarations from cpython.int */
 
-/* Module declarations from python_float */
+/* Module declarations from __builtin__ */
+
+/* Module declarations from cpython.bool */
+
+static PyTypeObject *__pyx_ptype_7cpython_4bool_bool = 0;
+/* Module declarations from cpython.long */
+
+/* Module declarations from cpython.float */
+
+/* Module declarations from cpython.complex */
+
+/* Module declarations from cpython.string */
+
+/* Module declarations from cpython.unicode */
+
+/* Module declarations from cpython.dict */
+
+/* Module declarations from cpython.instance */
+
+/* Module declarations from cpython.function */
+
+/* Module declarations from cpython.method */
+
+/* Module declarations from cpython.weakref */
+
+/* Module declarations from cpython.getargs */
+
+/* Module declarations from cpython.pythread */
+
+/* Module declarations from cpython.cobject */
+
+/* Module declarations from cpython.oldbuffer */
+
+/* Module declarations from cpython.set */
+
+/* Module declarations from cpython.bytes */
+
+/* Module declarations from cpython.pycapsule */
+
+/* Module declarations from cpython */
 
 /* Module declarations from datetime */
 
@@ -831,9 +941,9 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *); /*proto*
 static PyObject *__pyx_f_7tseries_checknull(PyObject *, int __pyx_skip_dispatch); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_7tseries__isnan(PyObject *); /*proto*/
 static PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *, int, int, __pyx_t_7tseries_skiplist_f); /*proto*/
-static __pyx_t_5numpy_double_t __pyx_f_7tseries__get_median(struct __pyx_obj_7tseries_IndexableSkiplist *, int, int); /*proto*/
-static __pyx_t_5numpy_double_t __pyx_f_7tseries__get_max(struct __pyx_obj_7tseries_IndexableSkiplist *, int, int); /*proto*/
-static __pyx_t_5numpy_double_t __pyx_f_7tseries__get_min(struct __pyx_obj_7tseries_IndexableSkiplist *, int, int); /*proto*/
+static __pyx_t_5numpy_double_t __pyx_f_7tseries__get_median(PyObject *, int, int); /*proto*/
+static __pyx_t_5numpy_double_t __pyx_f_7tseries__get_max(PyObject *, int, int); /*proto*/
+static __pyx_t_5numpy_double_t __pyx_f_7tseries__get_min(PyObject *, int, int); /*proto*/
 static double __pyx_f_7tseries___add(double, double); /*proto*/
 static double __pyx_f_7tseries___sub(double, double); /*proto*/
 static double __pyx_f_7tseries___div(double, double); /*proto*/
@@ -848,11 +958,11 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *);
 static PyObject *__pyx_f_7tseries_to_datetime(__pyx_t_5numpy_int64_t, int __pyx_skip_dispatch); /*proto*/
 static PyObject *__pyx_f_7tseries_to_timestamp(PyObject *, int __pyx_skip_dispatch); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_object = { "Python object", NULL, sizeof(PyObject *), 'O' };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn_npy_int8 = { "numpy.npy_int8", NULL, sizeof(npy_int8), 'I' };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t = { "numpy.int8_t", NULL, sizeof(__pyx_t_5numpy_int8_t), 'I' };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_double_t = { "numpy.double_t", NULL, sizeof(__pyx_t_5numpy_double_t), 'R' };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t = { "numpy.int32_t", NULL, sizeof(__pyx_t_5numpy_int32_t), 'I' };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t = { "numpy.int64_t", NULL, sizeof(__pyx_t_5numpy_int64_t), 'I' };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn_npy_int8 = { "npy_int8", NULL, sizeof(npy_int8), 'I' };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t = { "int8_t", NULL, sizeof(__pyx_t_5numpy_int8_t), 'I' };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_double_t = { "double_t", NULL, sizeof(__pyx_t_5numpy_double_t), 'R' };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t = { "int32_t", NULL, sizeof(__pyx_t_5numpy_int32_t), 'I' };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t = { "int64_t", NULL, sizeof(__pyx_t_5numpy_int64_t), 'I' };
 #define __Pyx_MODULE_NAME "tseries"
 int __pyx_module_is_main_tseries = 0;
 
@@ -860,7 +970,6 @@ int __pyx_module_is_main_tseries = 0;
 static PyObject *__pyx_builtin_Exception;
 static PyObject *__pyx_builtin_ValueError;
 static PyObject *__pyx_builtin_range;
-static PyObject *__pyx_builtin_min;
 static PyObject *__pyx_builtin_KeyError;
 static PyObject *__pyx_builtin_object;
 static PyObject *__pyx_builtin_RuntimeError;
@@ -875,6 +984,16 @@ static char __pyx_k_8[] = "Non-native byte order not supported";
 static char __pyx_k_9[] = "unknown dtype code in numpy.pxd (%d)";
 static char __pyx_k_10[] = "Format string allocated too short, see comment in numpy.pxd";
 static char __pyx_k_11[] = "Format string allocated too short.";
+static char __pyx_k_12[] = "map_indices (line 88)";
+static char __pyx_k_13[] = "isAllDates2 (line 135)";
+static char __pyx_k_14[] = "median (line 58)";
+static char __pyx_k_15[] = "ewma (line 166)";
+static char __pyx_k_16[] = "roll_median (line 442)";
+static char __pyx_k_17[] = "roll_max (line 448)";
+static char __pyx_k_18[] = "roll_min (line 454)";
+static char __pyx_k_19[] = "_backfill (line 16)";
+static char __pyx_k_20[] = "_pad (line 107)";
+static char __pyx_k_21[] = "combineFunc (line 61)";
 static char __pyx_k__B[] = "B";
 static char __pyx_k__H[] = "H";
 static char __pyx_k__I[] = "I";
@@ -905,7 +1024,6 @@ static char __pyx_k__buf[] = "buf";
 static char __pyx_k__com[] = "com";
 static char __pyx_k__get[] = "get";
 static char __pyx_k__inf[] = "inf";
-static char __pyx_k__min[] = "min";
 static char __pyx_k__obj[] = "obj";
 static char __pyx_k__win[] = "win";
 static char __pyx_k___pad[] = "_pad";
@@ -916,6 +1034,7 @@ static char __pyx_k__bool[] = "bool";
 static char __pyx_k__copy[] = "copy";
 static char __pyx_k__data[] = "data";
 static char __pyx_k__date[] = "date";
+static char __pyx_k__ewma[] = "ewma";
 static char __pyx_k__fill[] = "fill";
 static char __pyx_k__func[] = "func";
 static char __pyx_k__head[] = "head";
@@ -953,6 +1072,7 @@ static char __pyx_k__fields[] = "fields";
 static char __pyx_k__format[] = "format";
 static char __pyx_k__insert[] = "insert";
 static char __pyx_k__mapper[] = "mapper";
+static char __pyx_k__median[] = "median";
 static char __pyx_k__newMap[] = "newMap";
 static char __pyx_k__object[] = "object";
 static char __pyx_k__oldMap[] = "oldMap";
@@ -972,11 +1092,14 @@ static char __pyx_k__strides[] = "strides";
 static char __pyx_k__BACKFILL[] = "BACKFILL";
 static char __pyx_k__KeyError[] = "KeyError";
 static char __pyx_k____main__[] = "__main__";
+static char __pyx_k____test__[] = "__test__";
 static char __pyx_k__datetime[] = "datetime";
 static char __pyx_k__itemsize[] = "itemsize";
 static char __pyx_k__newIndex[] = "newIndex";
 static char __pyx_k__oldIndex[] = "oldIndex";
 static char __pyx_k__readonly[] = "readonly";
+static char __pyx_k__roll_max[] = "roll_max";
+static char __pyx_k__roll_min[] = "roll_min";
 static char __pyx_k__type_num[] = "type_num";
 static char __pyx_k__Exception[] = "Exception";
 static char __pyx_k___backfill[] = "_backfill";
@@ -988,7 +1111,11 @@ static char __pyx_k__width_arr[] = "width_arr";
 static char __pyx_k__ValueError[] = "ValueError";
 static char __pyx_k__pydatetime[] = "pydatetime";
 static char __pyx_k__suboffsets[] = "suboffsets";
+static char __pyx_k__combineFunc[] = "combineFunc";
 static char __pyx_k__getMergeVec[] = "getMergeVec";
+static char __pyx_k__isAllDates2[] = "isAllDates2";
+static char __pyx_k__map_indices[] = "map_indices";
+static char __pyx_k__roll_median[] = "roll_median";
 static char __pyx_k__RuntimeError[] = "RuntimeError";
 static char __pyx_k__kth_smallest[] = "kth_smallest";
 static char __pyx_k__expected_size[] = "expected_size";
@@ -996,7 +1123,17 @@ static char __pyx_k__utcfromtimestamp[] = "utcfromtimestamp";
 static PyObject *__pyx_kp_s_1;
 static PyObject *__pyx_kp_u_10;
 static PyObject *__pyx_kp_u_11;
+static PyObject *__pyx_kp_u_12;
+static PyObject *__pyx_kp_u_13;
+static PyObject *__pyx_kp_u_14;
+static PyObject *__pyx_kp_u_15;
+static PyObject *__pyx_kp_u_16;
+static PyObject *__pyx_kp_u_17;
+static PyObject *__pyx_kp_u_18;
+static PyObject *__pyx_kp_u_19;
 static PyObject *__pyx_kp_s_2;
+static PyObject *__pyx_kp_u_20;
+static PyObject *__pyx_kp_u_21;
 static PyObject *__pyx_kp_s_3;
 static PyObject *__pyx_kp_s_4;
 static PyObject *__pyx_kp_s_5;
@@ -1022,6 +1159,7 @@ static PyObject *__pyx_n_s____mul__;
 static PyObject *__pyx_n_s____ne__;
 static PyObject *__pyx_n_s____pow__;
 static PyObject *__pyx_n_s____sub__;
+static PyObject *__pyx_n_s____test__;
 static PyObject *__pyx_n_s___backfill;
 static PyObject *__pyx_n_s___pad;
 static PyObject *__pyx_n_s__a;
@@ -1039,6 +1177,7 @@ static PyObject *__pyx_n_s__bool;
 static PyObject *__pyx_n_s__buf;
 static PyObject *__pyx_n_s__byteorder;
 static PyObject *__pyx_n_s__com;
+static PyObject *__pyx_n_s__combineFunc;
 static PyObject *__pyx_n_s__copy;
 static PyObject *__pyx_n_s__data;
 static PyObject *__pyx_n_s__date;
@@ -1046,6 +1185,7 @@ static PyObject *__pyx_n_s__datetime;
 static PyObject *__pyx_n_s__descr;
 static PyObject *__pyx_n_s__dtype;
 static PyObject *__pyx_n_s__empty;
+static PyObject *__pyx_n_s__ewma;
 static PyObject *__pyx_n_s__expected_size;
 static PyObject *__pyx_n_s__fields;
 static PyObject *__pyx_n_s__fill;
@@ -1061,15 +1201,17 @@ static PyObject *__pyx_n_s__insert;
 static PyObject *__pyx_n_s__int32;
 static PyObject *__pyx_n_s__int64;
 static PyObject *__pyx_n_s__int8;
+static PyObject *__pyx_n_s__isAllDates2;
 static PyObject *__pyx_n_s__isnan;
 static PyObject *__pyx_n_s__isnullobj;
 static PyObject *__pyx_n_s__itemsize;
 static PyObject *__pyx_n_s__k;
 static PyObject *__pyx_n_s__kind;
 static PyObject *__pyx_n_s__kth_smallest;
+static PyObject *__pyx_n_s__map_indices;
 static PyObject *__pyx_n_s__mapper;
 static PyObject *__pyx_n_s__maxlevels;
-static PyObject *__pyx_n_s__min;
+static PyObject *__pyx_n_s__median;
 static PyObject *__pyx_n_s__minp;
 static PyObject *__pyx_n_s__name;
 static PyObject *__pyx_n_s__names;
@@ -1092,6 +1234,9 @@ static PyObject *__pyx_n_s__random;
 static PyObject *__pyx_n_s__range;
 static PyObject *__pyx_n_s__readonly;
 static PyObject *__pyx_n_s__remove;
+static PyObject *__pyx_n_s__roll_max;
+static PyObject *__pyx_n_s__roll_median;
+static PyObject *__pyx_n_s__roll_min;
 static PyObject *__pyx_n_s__shape;
 static PyObject *__pyx_n_s__size;
 static PyObject *__pyx_n_s__strides;
@@ -1112,7 +1257,7 @@ static PyObject *__pyx_int_neg_1;
 static PyObject *__pyx_int_15;
 static PyObject *__pyx_int_100;
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":15
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":16
  * from datetime import datetime as pydatetime
  * 
  * cdef inline object trycall(object func, object arg):             # <<<<<<<<<<<<<<
@@ -1128,10 +1273,8 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   __Pyx_RefNannySetupContext("trycall");
-  __Pyx_INCREF(__pyx_v_func);
-  __Pyx_INCREF(__pyx_v_arg);
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":16
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":17
  * 
  * cdef inline object trycall(object func, object arg):
  *     try:             # <<<<<<<<<<<<<<
@@ -1146,7 +1289,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
     __Pyx_XGOTREF(__pyx_save_exc_tb);
     /*try:*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":17
+      /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":18
  * cdef inline object trycall(object func, object arg):
  *     try:
  *         return func(arg)             # <<<<<<<<<<<<<<
@@ -1154,12 +1297,12 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
  *         raise Exception('Error calling func on index %s' % arg)
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_v_arg);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_arg);
       __Pyx_GIVEREF(__pyx_v_arg);
-      __pyx_t_2 = PyObject_Call(__pyx_v_func, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      __pyx_t_2 = PyObject_Call(__pyx_v_func, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_r = __pyx_t_2;
@@ -1180,7 +1323,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":18
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":19
  *     try:
  *         return func(arg)
  *     except:             # <<<<<<<<<<<<<<
@@ -1189,31 +1332,31 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
  */
     /*except:*/ {
       __Pyx_AddTraceback("tseries.trycall");
-      if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_1, &__pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
+      if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_1, &__pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GOTREF(__pyx_t_3);
 
-      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":19
+      /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":20
  *         return func(arg)
  *     except:
  *         raise Exception('Error calling func on index %s' % arg)             # <<<<<<<<<<<<<<
  * 
  * cdef inline int int_max(int a, int b): return a if a >= b else b
  */
-      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_1), __pyx_v_arg); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
+      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_1), __pyx_v_arg); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
+      __Pyx_GOTREF(((PyObject *)__pyx_t_4));
+      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
-      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_t_4));
+      __Pyx_GIVEREF(((PyObject *)__pyx_t_4));
       __pyx_t_4 = 0;
-      __pyx_t_4 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
+      __pyx_t_4 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_Raise(__pyx_t_4, 0, 0);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
+      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -1244,14 +1387,12 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
   __Pyx_AddTraceback("tseries.trycall");
   __pyx_r = 0;
   __pyx_L0:;
-  __Pyx_DECREF(__pyx_v_func);
-  __Pyx_DECREF(__pyx_v_arg);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":21
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":22
  *         raise Exception('Error calling func on index %s' % arg)
  * 
  * cdef inline int int_max(int a, int b): return a if a >= b else b             # <<<<<<<<<<<<<<
@@ -1277,7 +1418,7 @@ static CYTHON_INLINE int __pyx_f_7tseries_int_max(int __pyx_v_a, int __pyx_v_b)
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":22
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":23
  * 
  * cdef inline int int_max(int a, int b): return a if a >= b else b
  * cdef inline int int_min(int a, int b): return a if a >= b else b             # <<<<<<<<<<<<<<
@@ -1303,7 +1444,7 @@ static CYTHON_INLINE int __pyx_f_7tseries_int_min(int __pyx_v_a, int __pyx_v_b)
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":26
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":27
  * ctypedef unsigned char UChar
  * 
  * cdef int is_contiguous(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1315,7 +1456,7 @@ static  int __pyx_f_7tseries_is_contiguous(PyArrayObject *__pyx_v_arr) {
   int __pyx_r;
   __Pyx_RefNannySetupContext("is_contiguous");
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":27
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":28
  * 
  * cdef int is_contiguous(ndarray arr):
  *     return np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS)             # <<<<<<<<<<<<<<
@@ -1331,7 +1472,7 @@ static  int __pyx_f_7tseries_is_contiguous(PyArrayObject *__pyx_v_arr) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":29
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":30
  *     return np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS)
  * 
  * cdef int _contiguous_check(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1345,9 +1486,8 @@ static  int __pyx_f_7tseries__contiguous_check(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   __Pyx_RefNannySetupContext("_contiguous_check");
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":30
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":31
  * 
  * cdef int _contiguous_check(ndarray arr):
  *     if not is_contiguous(arr):             # <<<<<<<<<<<<<<
@@ -1357,24 +1497,24 @@ static  int __pyx_f_7tseries__contiguous_check(PyArrayObject *__pyx_v_arr) {
   __pyx_t_1 = (!__pyx_f_7tseries_is_contiguous(__pyx_v_arr));
   if (__pyx_t_1) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":31
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":32
  * cdef int _contiguous_check(ndarray arr):
  *     if not is_contiguous(arr):
  *         raise ValueError('Tried to use data field on non-contiguous array!')             # <<<<<<<<<<<<<<
  * 
  * cdef int16_t *get_int16_ptr(ndarray arr):
  */
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_kp_s_2));
     PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_kp_s_2));
     __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_2));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L3;
   }
   __pyx_L3:;
@@ -1387,12 +1527,11 @@ static  int __pyx_f_7tseries__contiguous_check(PyArrayObject *__pyx_v_arr) {
   __Pyx_WriteUnraisable("tseries._contiguous_check");
   __pyx_r = 0;
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":33
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":34
  *         raise ValueError('Tried to use data field on non-contiguous array!')
  * 
  * cdef int16_t *get_int16_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1404,7 +1543,7 @@ static  __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *__
   __pyx_t_5numpy_int16_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_int16_ptr");
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":34
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":35
  * 
  * cdef int16_t *get_int16_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1413,7 +1552,7 @@ static  __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *__
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":36
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":37
  *     _contiguous_check(arr)
  * 
  *     return <int16_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1429,7 +1568,7 @@ static  __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *__
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":38
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":39
  *     return <int16_t *> arr.data
  * 
  * cdef int32_t *get_int32_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1441,7 +1580,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
   __pyx_t_5numpy_int32_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_int32_ptr");
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":39
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":40
  * 
  * cdef int32_t *get_int32_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1450,7 +1589,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":41
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":42
  *     _contiguous_check(arr)
  * 
  *     return <int32_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1466,7 +1605,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":43
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":44
  *     return <int32_t *> arr.data
  * 
  * cdef int64_t *get_int64_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1478,7 +1617,7 @@ static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__
   __pyx_t_5numpy_int64_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_int64_ptr");
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":44
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":45
  * 
  * cdef int64_t *get_int64_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1487,7 +1626,7 @@ static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":46
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":47
  *     _contiguous_check(arr)
  * 
  *     return <int64_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1503,7 +1642,7 @@ static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":48
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":49
  *     return <int64_t *> arr.data
  * 
  * cdef double_t *get_double_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1515,7 +1654,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
   __pyx_t_5numpy_double_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_double_ptr");
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":49
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":50
  * 
  * cdef double_t *get_double_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1524,7 +1663,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":51
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":52
  *     _contiguous_check(arr)
  * 
  *     return <double_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1540,7 +1679,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":87
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":88
  * import_array()
  * 
  * cpdef map_indices(ndarray index):             # <<<<<<<<<<<<<<
@@ -1559,39 +1698,38 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   __Pyx_RefNannySetupContext("map_indices");
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
   __pyx_v_iter = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_result = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":102
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":103
  *     cdef object idx
  * 
  *     result = {}             # <<<<<<<<<<<<<<
  * 
  *     iter = <flatiter> PyArray_IterNew(index)
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
   __Pyx_DECREF(((PyObject *)__pyx_v_result));
   __pyx_v_result = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":104
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":105
  *     result = {}
  * 
  *     iter = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
  *     length = PyArray_SIZE(index)
  * 
  */
-  __pyx_t_1 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_1)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iter));
   __pyx_v_iter = ((PyArrayIterObject *)__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":105
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":106
  * 
  *     iter = <flatiter> PyArray_IterNew(index)
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -1600,7 +1738,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_index);
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":107
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":108
  *     length = PyArray_SIZE(index)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -1610,32 +1748,32 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_t_2 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":108
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":109
  * 
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))             # <<<<<<<<<<<<<<
  *         result[idx] = i
  *         PyArray_ITER_NEXT(iter)
  */
-    __pyx_t_1 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_v_idx);
     __pyx_v_idx = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":109
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":110
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  *         result[idx] = i             # <<<<<<<<<<<<<<
  *         PyArray_ITER_NEXT(iter)
  * 
  */
-    __pyx_t_1 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_v_idx, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_v_idx, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":110
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":111
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  *         result[idx] = i
  *         PyArray_ITER_NEXT(iter)             # <<<<<<<<<<<<<<
@@ -1645,7 +1783,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
     PyArray_ITER_NEXT(__pyx_v_iter);
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":112
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":113
  *         PyArray_ITER_NEXT(iter)
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -1667,13 +1805,12 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __Pyx_DECREF((PyObject *)__pyx_v_iter);
   __Pyx_DECREF(__pyx_v_result);
   __Pyx_DECREF(__pyx_v_idx);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":87
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":88
  * import_array()
  * 
  * cpdef map_indices(ndarray index):             # <<<<<<<<<<<<<<
@@ -1688,9 +1825,9 @@ static PyObject *__pyx_pf_7tseries_map_indices(PyObject *__pyx_self, PyObject *_
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("map_indices");
   __pyx_self = __pyx_self;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7tseries_map_indices(((PyArrayObject *)__pyx_v_index), 0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __pyx_f_7tseries_map_indices(((PyArrayObject *)__pyx_v_index), 0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -1708,7 +1845,7 @@ static PyObject *__pyx_pf_7tseries_map_indices(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":114
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":115
  *     return result
  * 
  * def isAllDates(ndarray index):             # <<<<<<<<<<<<<<
@@ -1728,26 +1865,25 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   int __pyx_t_3;
   __Pyx_RefNannySetupContext("isAllDates");
   __pyx_self = __pyx_self;
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
   __pyx_v_iter = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_date = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":119
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":120
  *     cdef object date
  * 
  *     iter = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
  *     length = PyArray_SIZE(index)
  * 
  */
-  __pyx_t_1 = PyArray_IterNew(__pyx_v_index); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_IterNew(__pyx_v_index); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_1)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iter));
   __pyx_v_iter = ((PyArrayIterObject *)__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":120
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":121
  * 
  *     iter = <flatiter> PyArray_IterNew(index)
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -1756,7 +1892,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
  */
   __pyx_v_length = PyArray_SIZE(((PyArrayObject *)__pyx_v_index));
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":122
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":123
  *     length = PyArray_SIZE(index)
  * 
  *     if length == 0:             # <<<<<<<<<<<<<<
@@ -1766,7 +1902,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   __pyx_t_2 = (__pyx_v_length == 0);
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":123
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":124
  * 
  *     if length == 0:
  *         return False             # <<<<<<<<<<<<<<
@@ -1774,7 +1910,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
  *     for i from 0 <= i < length:
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -1783,7 +1919,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   }
   __pyx_L5:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":125
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":126
  *         return False
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -1793,20 +1929,20 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   __pyx_t_3 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":126
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":127
  * 
  *     for i from 0 <= i < length:
  *         date = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))             # <<<<<<<<<<<<<<
  * 
  *         if not PyDateTime_Check(date):
  */
-    __pyx_t_1 = PyArray_GETITEM(((PyArrayObject *)__pyx_v_index), PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyArray_GETITEM(((PyArrayObject *)__pyx_v_index), PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_v_date);
     __pyx_v_date = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":128
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":129
  *         date = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  * 
  *         if not PyDateTime_Check(date):             # <<<<<<<<<<<<<<
@@ -1816,7 +1952,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
     __pyx_t_2 = (!PyDateTime_Check(__pyx_v_date));
     if (__pyx_t_2) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":129
+      /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":130
  * 
  *         if not PyDateTime_Check(date):
  *             return False             # <<<<<<<<<<<<<<
@@ -1824,7 +1960,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
  * 
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_r = __pyx_t_1;
       __pyx_t_1 = 0;
@@ -1833,7 +1969,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
     }
     __pyx_L8:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":130
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":131
  *         if not PyDateTime_Check(date):
  *             return False
  *         PyArray_ITER_NEXT(iter)             # <<<<<<<<<<<<<<
@@ -1843,7 +1979,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
     PyArray_ITER_NEXT(__pyx_v_iter);
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":132
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":133
  *         PyArray_ITER_NEXT(iter)
  * 
  *     return True             # <<<<<<<<<<<<<<
@@ -1851,7 +1987,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
  * def isAllDates2(ndarray[object, ndim=1] arr):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -1866,13 +2002,12 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   __pyx_L0:;
   __Pyx_DECREF((PyObject *)__pyx_v_iter);
   __Pyx_DECREF(__pyx_v_date);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\common.pyx":134
+/* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":135
  *     return True
  * 
  * def isAllDates2(ndarray[object, ndim=1] arr):             # <<<<<<<<<<<<<<
@@ -1898,28 +2033,27 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   int __pyx_t_6;
   __Pyx_RefNannySetupContext("isAllDates2");
   __pyx_self = __pyx_self;
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
   __pyx_v_date = Py_None; __Pyx_INCREF(Py_None);
   __pyx_bstruct_arr.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
   __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":139
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":140
  *     '''
  * 
  *     cdef int i, size = len(arr)             # <<<<<<<<<<<<<<
  *     cdef object date
  * 
  */
-  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_size = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":142
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":143
  *     cdef object date
  * 
  *     if size == 0:             # <<<<<<<<<<<<<<
@@ -1929,7 +2063,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   __pyx_t_2 = (__pyx_v_size == 0);
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":143
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":144
  * 
  *     if size == 0:
  *         return False             # <<<<<<<<<<<<<<
@@ -1937,7 +2071,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
  *     for i from 0 <= i < size:
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
@@ -1946,7 +2080,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L5:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":145
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":146
  *         return False
  * 
  *     for i from 0 <= i < size:             # <<<<<<<<<<<<<<
@@ -1956,7 +2090,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   __pyx_t_4 = __pyx_v_size;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_4; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":146
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":147
  * 
  *     for i from 0 <= i < size:
  *         date = arr[i]             # <<<<<<<<<<<<<<
@@ -1971,7 +2105,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
     } else if (unlikely(__pyx_t_5 >= __pyx_bshape_0_arr)) __pyx_t_6 = 0;
     if (unlikely(__pyx_t_6 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_6);
-      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_arr.buf, __pyx_t_5, __pyx_bstride_0_arr);
     __Pyx_INCREF((PyObject*)__pyx_t_3);
@@ -1979,7 +2113,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
     __pyx_v_date = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":148
+    /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":149
  *         date = arr[i]
  * 
  *         if not PyDateTime_Check(date):             # <<<<<<<<<<<<<<
@@ -1989,7 +2123,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
     __pyx_t_2 = (!PyDateTime_Check(__pyx_v_date));
     if (__pyx_t_2) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":149
+      /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":150
  * 
  *         if not PyDateTime_Check(date):
  *             return False             # <<<<<<<<<<<<<<
@@ -1997,7 +2131,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
  *     return True
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_3 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_r = __pyx_t_3;
       __pyx_t_3 = 0;
@@ -2007,13 +2141,13 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
     __pyx_L8:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":151
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":152
  *             return False
  * 
  *     return True             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
@@ -2034,13 +2168,12 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
   __pyx_L2:;
   __Pyx_DECREF(__pyx_v_date);
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":18
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":18
  * # MSVC does not have log2!
  * 
  * cdef double Log2(double x):             # <<<<<<<<<<<<<<
@@ -2054,7 +2187,7 @@ static  double __pyx_f_7tseries_Log2(double __pyx_v_x) {
   double __pyx_t_2;
   __Pyx_RefNannySetupContext("Log2");
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":19
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":19
  * 
  * cdef double Log2(double x):
  *     return log(x) / log(2.)             # <<<<<<<<<<<<<<
@@ -2062,7 +2195,7 @@ static  double __pyx_f_7tseries_Log2(double __pyx_v_x) {
  * cimport numpy as np
  */
   __pyx_t_1 = log(__pyx_v_x);
-  __pyx_t_2 = log(2.0);
+  __pyx_t_2 = log(2.);
   if (unlikely(__pyx_t_2 == 0)) {
     PyErr_Format(PyExc_ZeroDivisionError, "float division");
     {__pyx_filename = __pyx_f[1]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
@@ -2080,7 +2213,57 @@ static  double __pyx_f_7tseries_Log2(double __pyx_v_x) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":34
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":33
+ * 
+ *     cdef public:
+ *         double value             # <<<<<<<<<<<<<<
+ *         list next
+ *         ndarray width_arr
+ */
+
+static PyObject *__pyx_pf_7tseries_4Node_5value___get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pf_7tseries_4Node_5value___get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  __Pyx_RefNannySetupContext("__get__");
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->value); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("tseries.Node.value.__get__");
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_7tseries_4Node_5value___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pf_7tseries_4Node_5value___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  double __pyx_t_1;
+  __Pyx_RefNannySetupContext("__set__");
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->value = __pyx_t_1;
+
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("tseries.Node.value.__set__");
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":34
  *     cdef public:
  *         double value
  *         list next             # <<<<<<<<<<<<<<
@@ -2125,7 +2308,22 @@ static int __pyx_pf_7tseries_4Node_4next___set__(PyObject *__pyx_v_self, PyObjec
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":35
+static int __pyx_pf_7tseries_4Node_4next___del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pf_7tseries_4Node_4next___del__(PyObject *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannySetupContext("__del__");
+  __Pyx_INCREF(Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __Pyx_GOTREF(((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next);
+  __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next));
+  ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next = ((PyObject *)Py_None);
+
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":35
  *         double value
  *         list next
  *         ndarray width_arr             # <<<<<<<<<<<<<<
@@ -2170,7 +2368,22 @@ static int __pyx_pf_7tseries_4Node_9width_arr___set__(PyObject *__pyx_v_self, Py
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":40
+static int __pyx_pf_7tseries_4Node_9width_arr___del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pf_7tseries_4Node_9width_arr___del__(PyObject *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannySetupContext("__del__");
+  __Pyx_INCREF(Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __Pyx_GOTREF(((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr);
+  __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr));
+  ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr = ((PyArrayObject *)Py_None);
+
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":40
  *         int *width
  * 
  *     def __init__(self, double value, list next, ndarray width):             # <<<<<<<<<<<<<<
@@ -2232,12 +2445,13 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
   __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.Node.__init__");
+  __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_next), &PyList_Type, 1, "next", 1))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_width), __pyx_ptype_5numpy_ndarray, 1, "width", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":41
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":41
  * 
  *     def __init__(self, double value, list next, ndarray width):
  *         self.value = value             # <<<<<<<<<<<<<<
@@ -2246,7 +2460,7 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
  */
   ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->value = __pyx_v_value;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":42
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":42
  *     def __init__(self, double value, list next, ndarray width):
  *         self.value = value
  *         self.next = next             # <<<<<<<<<<<<<<
@@ -2259,7 +2473,7 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
   __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next));
   ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next = __pyx_v_next;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":43
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":43
  *         self.value = value
  *         self.next = next
  *         self.width_arr = width             # <<<<<<<<<<<<<<
@@ -2272,7 +2486,7 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
   __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr));
   ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr = __pyx_v_width;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":44
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":44
  *         self.next = next
  *         self.width_arr = width
  *         self.width = <int *> width.data             # <<<<<<<<<<<<<<
@@ -2291,7 +2505,7 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":56
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":56
  *         Node head
  * 
  *     def __init__(self, expected_size=100):             # <<<<<<<<<<<<<<
@@ -2323,9 +2537,9 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
     }
     switch (PyTuple_GET_SIZE(__pyx_args)) {
       case  0:
-      if (kw_args > 1) {
+      if (kw_args > 0) {
         PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__expected_size);
-        if (unlikely(value)) { values[0] = value; kw_args--; }
+        if (value) { values[0] = value; kw_args--; }
       }
     }
     if (unlikely(kw_args > 0)) {
@@ -2345,10 +2559,11 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
   __Pyx_RaiseArgtupleInvalid("__init__", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.IndexableSkiplist.__init__");
+  __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":57
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":57
  * 
  *     def __init__(self, expected_size=100):
  *         self.size = 0             # <<<<<<<<<<<<<<
@@ -2357,7 +2572,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
  */
   ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->size = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":58
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":58
  *     def __init__(self, expected_size=100):
  *         self.size = 0
  *         self.maxlevels = int(1 + Log2(expected_size))             # <<<<<<<<<<<<<<
@@ -2365,9 +2580,9 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
  *         self.head = Node(np.NaN, [NIL] * self.maxlevels,
  */
   __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_expected_size); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels = ((int)(1 + __pyx_f_7tseries_Log2(__pyx_t_1)));
+  ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels = ((int)(1.0 + __pyx_f_7tseries_Log2(__pyx_t_1)));
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":60
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":60
  *         self.maxlevels = int(1 + Log2(expected_size))
  * 
  *         self.head = Node(np.NaN, [NIL] * self.maxlevels,             # <<<<<<<<<<<<<<
@@ -2393,7 +2608,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
   __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":61
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":61
  * 
  *         self.head = Node(np.NaN, [NIL] * self.maxlevels,
  *                          np.ones(self.maxlevels, dtype=int))             # <<<<<<<<<<<<<<
@@ -2435,7 +2650,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":60
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":60
  *         self.maxlevels = int(1 + Log2(expected_size))
  * 
  *         self.head = Node(np.NaN, [NIL] * self.maxlevels,             # <<<<<<<<<<<<<<
@@ -2464,7 +2679,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":63
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":63
  *                          np.ones(self.maxlevels, dtype=int))
  * 
  *     def __len__(self):             # <<<<<<<<<<<<<<
@@ -2477,7 +2692,7 @@ static Py_ssize_t __pyx_pf_7tseries_17IndexableSkiplist___len__(PyObject *__pyx_
   Py_ssize_t __pyx_r;
   __Pyx_RefNannySetupContext("__len__");
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":64
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":64
  * 
  *     def __len__(self):
  *         return self.size             # <<<<<<<<<<<<<<
@@ -2493,7 +2708,7 @@ static Py_ssize_t __pyx_pf_7tseries_17IndexableSkiplist___len__(PyObject *__pyx_
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":66
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":66
  *         return self.size
  * 
  *     def __getitem__(self, i):             # <<<<<<<<<<<<<<
@@ -2504,40 +2719,29 @@ static Py_ssize_t __pyx_pf_7tseries_17IndexableSkiplist___len__(PyObject *__pyx_
 static PyObject *__pyx_pf_7tseries_17IndexableSkiplist___getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_i); /*proto*/
 static PyObject *__pyx_pf_7tseries_17IndexableSkiplist___getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_i) {
   PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
+  int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
   __Pyx_RefNannySetupContext("__getitem__");
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":67
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":67
  * 
  *     def __getitem__(self, i):
  *         return self.get(i)             # <<<<<<<<<<<<<<
  * 
- *     def get(self, int i):
+ *     cpdef get(self, int i):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__get); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_PyInt_AsInt(__pyx_v_i); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->__pyx_vtab)->get(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self), __pyx_t_1, 0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(__pyx_v_i);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_i);
-  __Pyx_GIVEREF(__pyx_v_i);
-  __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("tseries.IndexableSkiplist.__getitem__");
   __pyx_r = NULL;
   __pyx_L0:;
@@ -2546,49 +2750,64 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist___getitem__(PyObject *__p
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":69
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":69
  *         return self.get(i)
  * 
- *     def get(self, int i):             # <<<<<<<<<<<<<<
+ *     cpdef get(self, int i):             # <<<<<<<<<<<<<<
  *         cdef int level
  *         cdef Node node
  */
 
 static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_self, PyObject *__pyx_arg_i); /*proto*/
-static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_self, PyObject *__pyx_arg_i) {
-  int __pyx_v_i;
+static  PyObject *__pyx_f_7tseries_17IndexableSkiplist_get(struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_self, int __pyx_v_i, int __pyx_skip_dispatch) {
   int __pyx_v_level;
   struct __pyx_obj_7tseries_Node *__pyx_v_node;
   PyObject *__pyx_r = NULL;
-  Py_ssize_t __pyx_t_1;
+  PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_t_5;
   __Pyx_RefNannySetupContext("get");
-  assert(__pyx_arg_i); {
-    __pyx_v_i = __Pyx_PyInt_AsInt(__pyx_arg_i); if (unlikely((__pyx_v_i == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.IndexableSkiplist.get");
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_self);
   __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overriden in Python */
+  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
+    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__get); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_1);
+    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (void *)&__pyx_pf_7tseries_17IndexableSkiplist_get)) {
+      __Pyx_XDECREF(__pyx_r);
+      __pyx_t_2 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+      __Pyx_GIVEREF(__pyx_t_2);
+      __pyx_t_2 = 0;
+      __pyx_t_2 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_r = __pyx_t_2;
+      __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      goto __pyx_L0;
+    }
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  }
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":73
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":73
  *         cdef Node node
  * 
  *         node = self.head             # <<<<<<<<<<<<<<
  *         i += 1
  * 
  */
-  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head));
+  __Pyx_INCREF(((PyObject *)__pyx_v_self->head));
   __Pyx_DECREF(((PyObject *)__pyx_v_node));
-  __pyx_v_node = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head;
+  __pyx_v_node = __pyx_v_self->head;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":74
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":74
  * 
  *         node = self.head
  *         i += 1             # <<<<<<<<<<<<<<
@@ -2597,56 +2816,17 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
  */
   __pyx_v_i += 1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":76
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":76
  *         i += 1
  * 
  *         for level in range(self.maxlevels - 1, -1, -1):             # <<<<<<<<<<<<<<
  *             while node.width[level] <= i:
  *                 i -= node.width[level]
  */
-  __pyx_t_2 = PyInt_FromLong((((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels - 1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __Pyx_INCREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_int_neg_1);
-  __Pyx_INCREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_int_neg_1);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyList_CheckExact(__pyx_t_2) || PyTuple_CheckExact(__pyx_t_2)) {
-    __pyx_t_1 = 0; __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3);
-  } else {
-    __pyx_t_1 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-  }
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  for (;;) {
-    if (likely(PyList_CheckExact(__pyx_t_3))) {
-      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_3)) break;
-      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
-    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
-      if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
-      __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
-    } else {
-      __pyx_t_2 = PyIter_Next(__pyx_t_3);
-      if (!__pyx_t_2) {
-        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        break;
-      }
-      __Pyx_GOTREF(__pyx_t_2);
-    }
-    __pyx_t_4 = __Pyx_PyInt_AsInt(__pyx_t_2); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  for (__pyx_t_4 = (__pyx_v_self->maxlevels - 1); __pyx_t_4 > -1; __pyx_t_4-=1) {
     __pyx_v_level = __pyx_t_4;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":77
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":77
  * 
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             while node.width[level] <= i:             # <<<<<<<<<<<<<<
@@ -2657,7 +2837,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
       __pyx_t_5 = ((__pyx_v_node->width[__pyx_v_level]) <= __pyx_v_i);
       if (!__pyx_t_5) break;
 
-      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":78
+      /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":78
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             while node.width[level] <= i:
  *                 i -= node.width[level]             # <<<<<<<<<<<<<<
@@ -2666,63 +2846,103 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
  */
       __pyx_v_i -= (__pyx_v_node->width[__pyx_v_level]);
 
-      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":79
+      /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":79
  *             while node.width[level] <= i:
  *                 i -= node.width[level]
  *                 node = node.next[level]             # <<<<<<<<<<<<<<
  * 
  *         return node.value
  */
-      __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_node->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_node->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(((PyObject *)__pyx_v_node));
-      __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)__pyx_t_2);
-      __pyx_t_2 = 0;
+      __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)__pyx_t_1);
+      __pyx_t_1 = 0;
     }
   }
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":81
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":81
  *                 node = node.next[level]
  * 
  *         return node.value             # <<<<<<<<<<<<<<
  * 
- *     def insert(self, double value):
+ *     cpdef insert(self, double value):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_node->value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_node->value); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("tseries.IndexableSkiplist.get");
-  __pyx_r = NULL;
+  __pyx_r = 0;
   __pyx_L0:;
   __Pyx_DECREF((PyObject *)__pyx_v_node);
-  __Pyx_DECREF((PyObject *)__pyx_v_self);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":83
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":69
+ *         return self.get(i)
+ * 
+ *     cpdef get(self, int i):             # <<<<<<<<<<<<<<
+ *         cdef int level
+ *         cdef Node node
+ */
+
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_self, PyObject *__pyx_arg_i); /*proto*/
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_self, PyObject *__pyx_arg_i) {
+  int __pyx_v_i;
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  __Pyx_RefNannySetupContext("get");
+  assert(__pyx_arg_i); {
+    __pyx_v_i = __Pyx_PyInt_AsInt(__pyx_arg_i); if (unlikely((__pyx_v_i == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.get");
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->__pyx_vtab)->get(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self), __pyx_v_i, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.get");
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":83
  *         return node.value
  * 
- *     def insert(self, double value):             # <<<<<<<<<<<<<<
+ *     cpdef insert(self, double value):             # <<<<<<<<<<<<<<
  *         cdef int level, steps, d
  *         cdef Node node, prevnode, newnode, next_at_level
  */
 
 static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
-static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
-  double __pyx_v_value;
+static  PyObject *__pyx_f_7tseries_17IndexableSkiplist_insert(struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_self, double __pyx_v_value, int __pyx_skip_dispatch) {
   int __pyx_v_level;
   int __pyx_v_steps;
   int __pyx_v_d;
@@ -2736,33 +2956,48 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  Py_ssize_t __pyx_t_4;
+  int __pyx_t_4;
   int __pyx_t_5;
-  int __pyx_t_6;
+  double __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
-  double __pyx_t_8;
+  PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_10;
   int __pyx_t_11;
-  int __pyx_t_12;
   __Pyx_RefNannySetupContext("insert");
-  assert(__pyx_arg_value); {
-    __pyx_v_value = __pyx_PyFloat_AsDouble(__pyx_arg_value); if (unlikely((__pyx_v_value == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.IndexableSkiplist.insert");
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_self);
   __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_newnode = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_chain = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_steps_at_level = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overriden in Python */
+  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
+    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__insert); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_1);
+    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (void *)&__pyx_pf_7tseries_17IndexableSkiplist_insert)) {
+      __Pyx_XDECREF(__pyx_r);
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+      __Pyx_GIVEREF(__pyx_t_2);
+      __pyx_t_2 = 0;
+      __pyx_t_2 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_r = __pyx_t_2;
+      __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      goto __pyx_L0;
+    }
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  }
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":89
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":89
  * 
  *         # find first node on each level where node.next[levels].value > value
  *         chain = [None] * self.maxlevels             # <<<<<<<<<<<<<<
@@ -2774,7 +3009,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __Pyx_INCREF(Py_None);
   PyList_SET_ITEM(__pyx_t_1, 0, Py_None);
   __Pyx_GIVEREF(Py_None);
-  __pyx_t_2 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_self->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = PyNumber_Multiply(((PyObject *)__pyx_t_1), __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
@@ -2785,7 +3020,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __pyx_v_chain = ((PyObject *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":90
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":90
  *         # find first node on each level where node.next[levels].value > value
  *         chain = [None] * self.maxlevels
  *         steps_at_level = [0] * self.maxlevels             # <<<<<<<<<<<<<<
@@ -2797,7 +3032,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __Pyx_INCREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
-  __pyx_t_2 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_self->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_1 = PyNumber_Multiply(((PyObject *)__pyx_t_3), __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
@@ -2808,67 +3043,28 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __pyx_v_steps_at_level = ((PyObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":92
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":92
  *         steps_at_level = [0] * self.maxlevels
  * 
  *         node = self.head             # <<<<<<<<<<<<<<
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             next_at_level = node.next[level]
  */
-  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head));
+  __Pyx_INCREF(((PyObject *)__pyx_v_self->head));
   __Pyx_DECREF(((PyObject *)__pyx_v_node));
-  __pyx_v_node = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head;
+  __pyx_v_node = __pyx_v_self->head;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":93
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":93
  * 
  *         node = self.head
  *         for level in range(self.maxlevels - 1, -1, -1):             # <<<<<<<<<<<<<<
  *             next_at_level = node.next[level]
  * 
  */
-  __pyx_t_1 = PyInt_FromLong((((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels - 1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_int_neg_1);
-  __Pyx_INCREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_int_neg_1);
-  __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
-    __pyx_t_4 = 0; __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2);
-  } else {
-    __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-  }
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  for (;;) {
-    if (likely(PyList_CheckExact(__pyx_t_2))) {
-      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
-      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++;
-    } else if (likely(PyTuple_CheckExact(__pyx_t_2))) {
-      if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
-      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++;
-    } else {
-      __pyx_t_1 = PyIter_Next(__pyx_t_2);
-      if (!__pyx_t_1) {
-        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        break;
-      }
-      __Pyx_GOTREF(__pyx_t_1);
-    }
-    __pyx_t_5 = __Pyx_PyInt_AsInt(__pyx_t_1); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_v_level = __pyx_t_5;
+  for (__pyx_t_4 = (__pyx_v_self->maxlevels - 1); __pyx_t_4 > -1; __pyx_t_4-=1) {
+    __pyx_v_level = __pyx_t_4;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":94
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":94
  *         node = self.head
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             next_at_level = node.next[level]             # <<<<<<<<<<<<<<
@@ -2882,7 +3078,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
     __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":96
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":96
  *             next_at_level = node.next[level]
  * 
  *             while next_at_level.value <= value:             # <<<<<<<<<<<<<<
@@ -2890,10 +3086,10 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  *                                          node.width[level])
  */
     while (1) {
-      __pyx_t_6 = (__pyx_v_next_at_level->value <= __pyx_v_value);
-      if (!__pyx_t_6) break;
+      __pyx_t_5 = (__pyx_v_next_at_level->value <= __pyx_v_value);
+      if (!__pyx_t_5) break;
 
-      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":97
+      /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":97
  * 
  *             while next_at_level.value <= value:
  *                 steps_at_level[level] = (steps_at_level[level] +             # <<<<<<<<<<<<<<
@@ -2903,31 +3099,31 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
       __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_1);
 
-      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":98
+      /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":98
  *             while next_at_level.value <= value:
  *                 steps_at_level[level] = (steps_at_level[level] +
  *                                          node.width[level])             # <<<<<<<<<<<<<<
  *                 node = next_at_level
  *                 next_at_level = node.next[level]
  */
-      __pyx_t_3 = PyInt_FromLong((__pyx_v_node->width[__pyx_v_level])); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = PyInt_FromLong((__pyx_v_node->width[__pyx_v_level])); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":97
+      /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":97
  * 
  *             while next_at_level.value <= value:
  *                 steps_at_level[level] = (steps_at_level[level] +             # <<<<<<<<<<<<<<
  *                                          node.width[level])
  *                 node = next_at_level
  */
-      if (__Pyx_SetItemInt(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, __pyx_t_7, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      if (__Pyx_SetItemInt(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, __pyx_t_3, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":99
+      /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":99
  *                 steps_at_level[level] = (steps_at_level[level] +
  *                                          node.width[level])
  *                 node = next_at_level             # <<<<<<<<<<<<<<
@@ -2938,22 +3134,22 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
       __Pyx_DECREF(((PyObject *)__pyx_v_node));
       __pyx_v_node = __pyx_v_next_at_level;
 
-      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":100
+      /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":100
  *                                          node.width[level])
  *                 node = next_at_level
  *                 next_at_level = node.next[level]             # <<<<<<<<<<<<<<
  * 
  *             chain[level] = node
  */
-      __pyx_t_7 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_node->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_7) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_7);
-      if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_node->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(((PyObject *)__pyx_v_next_at_level));
-      __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_7);
-      __pyx_t_7 = 0;
+      __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
+      __pyx_t_3 = 0;
     }
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":102
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":102
  *                 next_at_level = node.next[level]
  * 
  *             chain[level] = node             # <<<<<<<<<<<<<<
@@ -2962,111 +3158,115 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  */
     if (__Pyx_SetItemInt(((PyObject *)__pyx_v_chain), __pyx_v_level, ((PyObject *)__pyx_v_node), sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":105
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":105
  * 
  *         # insert a link to the newnode at each level
  *         d = min(self.maxlevels, 1 - int(Log2(random())))             # <<<<<<<<<<<<<<
  *         newnode = Node(value, [None] * d, np.empty(d, dtype=int))
  *         steps = 0
  */
-  __pyx_t_2 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s__random); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = PyObject_Call(__pyx_t_7, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_8 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_f_7tseries_Log2(__pyx_t_8)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_7);
-  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)&PyInt_Type)), __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__random); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyNumber_Subtract(__pyx_int_1, __pyx_t_3); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_f_7tseries_Log2(__pyx_t_6)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_7);
-  __Pyx_GIVEREF(__pyx_t_7);
   __pyx_t_2 = 0;
-  __pyx_t_7 = 0;
-  __pyx_t_7 = PyObject_Call(__pyx_builtin_min, __pyx_t_3, NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)&PyInt_Type)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyInt_AsInt(__pyx_t_7); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyNumber_Subtract(__pyx_int_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_4 = __pyx_v_self->maxlevels;
+  __pyx_t_1 = PyInt_FromLong(__pyx_t_4); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_7 = PyObject_RichCompare(__pyx_t_3, __pyx_t_1, Py_LT); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_v_d = __pyx_t_5;
+  if (__pyx_t_5) {
+    __Pyx_INCREF(__pyx_t_3);
+    __pyx_t_2 = __pyx_t_3;
+  } else {
+    __pyx_t_7 = PyInt_FromLong(__pyx_t_4); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_2 = __pyx_t_7;
+    __pyx_t_7 = 0;
+  }
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __Pyx_PyInt_AsInt(__pyx_t_2); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_d = __pyx_t_4;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":106
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":106
  *         # insert a link to the newnode at each level
  *         d = min(self.maxlevels, 1 - int(Log2(random())))
  *         newnode = Node(value, [None] * d, np.empty(d, dtype=int))             # <<<<<<<<<<<<<<
  *         steps = 0
  * 
  */
-  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_3));
   __Pyx_INCREF(Py_None);
   PyList_SET_ITEM(__pyx_t_3, 0, Py_None);
   __Pyx_GIVEREF(Py_None);
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_d); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(((PyObject *)__pyx_t_3), __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyInt_FromLong(__pyx_v_d); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_1 = PyNumber_Multiply(((PyObject *)__pyx_t_3), __pyx_t_7); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_7, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_d); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = PyInt_FromLong(__pyx_v_d); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_8);
+  PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7);
+  __Pyx_GIVEREF(__pyx_t_7);
+  __pyx_t_7 = 0;
+  __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_7));
+  if (PyDict_SetItem(__pyx_t_7, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyInt_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_9 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_8, ((PyObject *)__pyx_t_7)); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_9);
-  PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyInt_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_10 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_9, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_10);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_7);
-  __Pyx_GIVEREF(__pyx_t_7);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
+  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
+  __pyx_t_7 = PyTuple_New(3); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_7);
+  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_10);
-  __Pyx_GIVEREF(__pyx_t_10);
-  __pyx_t_7 = 0;
+  PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_9);
+  __Pyx_GIVEREF(__pyx_t_9);
+  __pyx_t_2 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_10 = 0;
-  __pyx_t_10 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_Node)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_9 = 0;
+  __pyx_t_9 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_Node)), __pyx_t_7, NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_9);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_v_newnode));
-  __pyx_v_newnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_10);
-  __pyx_t_10 = 0;
+  __pyx_v_newnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_9);
+  __pyx_t_9 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":107
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":107
  *         d = min(self.maxlevels, 1 - int(Log2(random())))
  *         newnode = Node(value, [None] * d, np.empty(d, dtype=int))
  *         steps = 0             # <<<<<<<<<<<<<<
@@ -3075,44 +3275,44 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  */
   __pyx_v_steps = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":109
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":109
  *         steps = 0
  * 
  *         for level in range(d):             # <<<<<<<<<<<<<<
  *             prevnode = chain[level]
  * 
  */
-  __pyx_t_5 = __pyx_v_d;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_5; __pyx_t_11+=1) {
-    __pyx_v_level = __pyx_t_11;
+  __pyx_t_4 = __pyx_v_d;
+  for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_4; __pyx_t_10+=1) {
+    __pyx_v_level = __pyx_t_10;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":110
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":110
  * 
  *         for level in range(d):
  *             prevnode = chain[level]             # <<<<<<<<<<<<<<
  * 
  *             newnode.next[level] = prevnode.next[level]
  */
-    __pyx_t_10 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_10) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_10);
-    if (!(likely(((__pyx_t_10) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_10, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_9) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_9);
+    if (!(likely(((__pyx_t_9) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_9, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_prevnode));
-    __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_10);
-    __pyx_t_10 = 0;
+    __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_9);
+    __pyx_t_9 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":112
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":112
  *             prevnode = chain[level]
  * 
  *             newnode.next[level] = prevnode.next[level]             # <<<<<<<<<<<<<<
  *             prevnode.next[level] = newnode
  * 
  */
-    __pyx_t_10 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_10) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_10);
-    if (__Pyx_SetItemInt(((PyObject *)__pyx_v_newnode->next), __pyx_v_level, __pyx_t_10, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+    __pyx_t_9 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_9) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_9);
+    if (__Pyx_SetItemInt(((PyObject *)__pyx_v_newnode->next), __pyx_v_level, __pyx_t_9, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":113
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":113
  * 
  *             newnode.next[level] = prevnode.next[level]
  *             prevnode.next[level] = newnode             # <<<<<<<<<<<<<<
@@ -3121,7 +3321,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  */
     if (__Pyx_SetItemInt(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, ((PyObject *)__pyx_v_newnode), sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":115
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":115
  *             prevnode.next[level] = newnode
  * 
  *             newnode.width[level] = prevnode.width[level] - steps             # <<<<<<<<<<<<<<
@@ -3130,7 +3330,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  */
     (__pyx_v_newnode->width[__pyx_v_level]) = ((__pyx_v_prevnode->width[__pyx_v_level]) - __pyx_v_steps);
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":116
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":116
  * 
  *             newnode.width[level] = prevnode.width[level] - steps
  *             prevnode.width[level] = steps + 1             # <<<<<<<<<<<<<<
@@ -3139,38 +3339,38 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  */
     (__pyx_v_prevnode->width[__pyx_v_level]) = (__pyx_v_steps + 1);
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":118
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":118
  *             prevnode.width[level] = steps + 1
  * 
  *             steps = steps + steps_at_level[level]             # <<<<<<<<<<<<<<
  * 
  *         for level in range(d, self.maxlevels):
  */
-    __pyx_t_10 = PyInt_FromLong(__pyx_v_steps); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyNumber_Add(__pyx_t_10, __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = PyInt_FromLong(__pyx_v_steps); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_7 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_7) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_1 = PyNumber_Add(__pyx_t_9, __pyx_t_7); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_12 = __Pyx_PyInt_AsInt(__pyx_t_1); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_11 = __Pyx_PyInt_AsInt(__pyx_t_1); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_v_steps = __pyx_t_12;
+    __pyx_v_steps = __pyx_t_11;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":120
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":120
  *             steps = steps + steps_at_level[level]
  * 
  *         for level in range(d, self.maxlevels):             # <<<<<<<<<<<<<<
  *             (<Node> chain[level]).width[level] += 1
  * 
  */
-  __pyx_t_5 = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels;
-  for (__pyx_t_11 = __pyx_v_d; __pyx_t_11 < __pyx_t_5; __pyx_t_11+=1) {
-    __pyx_v_level = __pyx_t_11;
+  __pyx_t_4 = __pyx_v_self->maxlevels;
+  for (__pyx_t_10 = __pyx_v_d; __pyx_t_10 < __pyx_t_4; __pyx_t_10+=1) {
+    __pyx_v_level = __pyx_t_10;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":121
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":121
  * 
  *         for level in range(d, self.maxlevels):
  *             (<Node> chain[level]).width[level] += 1             # <<<<<<<<<<<<<<
@@ -3182,50 +3382,90 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
     (((struct __pyx_obj_7tseries_Node *)__pyx_t_1)->width[__pyx_v_level]) += 1;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":123
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":123
  *             (<Node> chain[level]).width[level] += 1
  * 
  *         self.size += 1             # <<<<<<<<<<<<<<
  * 
- *     def remove(self, double value):
+ *     cpdef remove(self, double value):
  */
-  ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->size += 1;
+  __pyx_v_self->size += 1;
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.insert");
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_DECREF((PyObject *)__pyx_v_node);
+  __Pyx_DECREF((PyObject *)__pyx_v_prevnode);
+  __Pyx_DECREF((PyObject *)__pyx_v_newnode);
+  __Pyx_DECREF((PyObject *)__pyx_v_next_at_level);
+  __Pyx_DECREF(__pyx_v_chain);
+  __Pyx_DECREF(__pyx_v_steps_at_level);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":83
+ *         return node.value
+ * 
+ *     cpdef insert(self, double value):             # <<<<<<<<<<<<<<
+ *         cdef int level, steps, d
+ *         cdef Node node, prevnode, newnode, next_at_level
+ */
+
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
+  double __pyx_v_value;
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  __Pyx_RefNannySetupContext("insert");
+  assert(__pyx_arg_value); {
+    __pyx_v_value = __pyx_PyFloat_AsDouble(__pyx_arg_value); if (unlikely((__pyx_v_value == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.insert");
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->__pyx_vtab)->insert(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self), __pyx_v_value, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_7);
-  __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
   __Pyx_AddTraceback("tseries.IndexableSkiplist.insert");
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_node);
-  __Pyx_DECREF((PyObject *)__pyx_v_prevnode);
-  __Pyx_DECREF((PyObject *)__pyx_v_newnode);
-  __Pyx_DECREF((PyObject *)__pyx_v_next_at_level);
-  __Pyx_DECREF(__pyx_v_chain);
-  __Pyx_DECREF(__pyx_v_steps_at_level);
-  __Pyx_DECREF((PyObject *)__pyx_v_self);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":125
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":125
  *         self.size += 1
  * 
- *     def remove(self, double value):             # <<<<<<<<<<<<<<
+ *     cpdef remove(self, double value):             # <<<<<<<<<<<<<<
  *         cdef int level, d
  *         cdef Node node, prevnode, tmpnode, next_at_level
  */
 
 static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
-static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
-  double __pyx_v_value;
+static  PyObject *__pyx_f_7tseries_17IndexableSkiplist_remove(struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_self, double __pyx_v_value, int __pyx_skip_dispatch) {
   int __pyx_v_level;
   int __pyx_v_d;
   struct __pyx_obj_7tseries_Node *__pyx_v_node;
@@ -3237,27 +3477,43 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  Py_ssize_t __pyx_t_4;
+  int __pyx_t_4;
   int __pyx_t_5;
-  int __pyx_t_6;
+  Py_ssize_t __pyx_t_6;
   int __pyx_t_7;
   __Pyx_RefNannySetupContext("remove");
-  assert(__pyx_arg_value); {
-    __pyx_v_value = __pyx_PyFloat_AsDouble(__pyx_arg_value); if (unlikely((__pyx_v_value == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.IndexableSkiplist.remove");
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_self);
   __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_chain = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overriden in Python */
+  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
+    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__remove); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_1);
+    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (void *)&__pyx_pf_7tseries_17IndexableSkiplist_remove)) {
+      __Pyx_XDECREF(__pyx_r);
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+      __Pyx_GIVEREF(__pyx_t_2);
+      __pyx_t_2 = 0;
+      __pyx_t_2 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_r = __pyx_t_2;
+      __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      goto __pyx_L0;
+    }
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  }
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":131
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":131
  * 
  *         # find first node on each level where node.next[levels].value >= value
  *         chain = [None] * self.maxlevels             # <<<<<<<<<<<<<<
@@ -3269,7 +3525,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   __Pyx_INCREF(Py_None);
   PyList_SET_ITEM(__pyx_t_1, 0, Py_None);
   __Pyx_GIVEREF(Py_None);
-  __pyx_t_2 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_self->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = PyNumber_Multiply(((PyObject *)__pyx_t_1), __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
@@ -3280,67 +3536,28 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   __pyx_v_chain = ((PyObject *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":132
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":132
  *         # find first node on each level where node.next[levels].value >= value
  *         chain = [None] * self.maxlevels
  *         node = self.head             # <<<<<<<<<<<<<<
  * 
  *         for level in range(self.maxlevels - 1, -1, -1):
  */
-  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head));
+  __Pyx_INCREF(((PyObject *)__pyx_v_self->head));
   __Pyx_DECREF(((PyObject *)__pyx_v_node));
-  __pyx_v_node = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head;
+  __pyx_v_node = __pyx_v_self->head;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":134
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":134
  *         node = self.head
  * 
  *         for level in range(self.maxlevels - 1, -1, -1):             # <<<<<<<<<<<<<<
  *             next_at_level = node.next[level]
  *             while next_at_level.value < value:
  */
-  __pyx_t_3 = PyInt_FromLong((((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels - 1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __Pyx_INCREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_int_neg_1);
-  __Pyx_INCREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_int_neg_1);
-  __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
-    __pyx_t_4 = 0; __pyx_t_2 = __pyx_t_3; __Pyx_INCREF(__pyx_t_2);
-  } else {
-    __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-  }
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  for (;;) {
-    if (likely(PyList_CheckExact(__pyx_t_2))) {
-      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
-      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++;
-    } else if (likely(PyTuple_CheckExact(__pyx_t_2))) {
-      if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
-      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++;
-    } else {
-      __pyx_t_3 = PyIter_Next(__pyx_t_2);
-      if (!__pyx_t_3) {
-        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        break;
-      }
-      __Pyx_GOTREF(__pyx_t_3);
-    }
-    __pyx_t_5 = __Pyx_PyInt_AsInt(__pyx_t_3); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_v_level = __pyx_t_5;
+  for (__pyx_t_4 = (__pyx_v_self->maxlevels - 1); __pyx_t_4 > -1; __pyx_t_4-=1) {
+    __pyx_v_level = __pyx_t_4;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":135
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":135
  * 
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             next_at_level = node.next[level]             # <<<<<<<<<<<<<<
@@ -3354,7 +3571,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
     __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":136
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":136
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             next_at_level = node.next[level]
  *             while next_at_level.value < value:             # <<<<<<<<<<<<<<
@@ -3362,10 +3579,10 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
  *                 next_at_level = node.next[level]
  */
     while (1) {
-      __pyx_t_6 = (__pyx_v_next_at_level->value < __pyx_v_value);
-      if (!__pyx_t_6) break;
+      __pyx_t_5 = (__pyx_v_next_at_level->value < __pyx_v_value);
+      if (!__pyx_t_5) break;
 
-      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":137
+      /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":137
  *             next_at_level = node.next[level]
  *             while next_at_level.value < value:
  *                 node = next_at_level             # <<<<<<<<<<<<<<
@@ -3376,7 +3593,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
       __Pyx_DECREF(((PyObject *)__pyx_v_node));
       __pyx_v_node = __pyx_v_next_at_level;
 
-      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":138
+      /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":138
  *             while next_at_level.value < value:
  *                 node = next_at_level
  *                 next_at_level = node.next[level]             # <<<<<<<<<<<<<<
@@ -3391,7 +3608,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
       __pyx_t_3 = 0;
     }
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":140
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":140
  *                 next_at_level = node.next[level]
  * 
  *             chain[level] = node             # <<<<<<<<<<<<<<
@@ -3400,59 +3617,58 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
  */
     if (__Pyx_SetItemInt(((PyObject *)__pyx_v_chain), __pyx_v_level, ((PyObject *)__pyx_v_node), sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":142
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":142
  *             chain[level] = node
  * 
  *         if value != chain[0].next[0].value:             # <<<<<<<<<<<<<<
  *             raise KeyError('Not Found')
  * 
  */
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__next); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__next); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__value); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__value); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_NE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_t_1, Py_NE); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__pyx_t_6) {
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (__pyx_t_5) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":143
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":143
  * 
  *         if value != chain[0].next[0].value:
  *             raise KeyError('Not Found')             # <<<<<<<<<<<<<<
  * 
  *         # remove one link at each level
  */
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_kp_s_3));
-    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_s_3));
+    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_kp_s_3));
     __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_3));
-    __pyx_t_1 = PyObject_Call(__pyx_builtin_KeyError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyObject_Call(__pyx_builtin_KeyError, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     {__pyx_filename = __pyx_f[1]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    goto __pyx_L9;
+    goto __pyx_L7;
   }
-  __pyx_L9:;
+  __pyx_L7:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":146
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":146
  * 
  *         # remove one link at each level
  *         d = len(chain[0].next[0].next)             # <<<<<<<<<<<<<<
@@ -3461,59 +3677,59 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
  */
   __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__next); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__next); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__next); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__next); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_d = __pyx_t_4;
+  __pyx_t_6 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_d = __pyx_t_6;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":148
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":148
  *         d = len(chain[0].next[0].next)
  * 
  *         for level in range(d):             # <<<<<<<<<<<<<<
  *             prevnode = chain[level]
  *             tmpnode = prevnode.next[level]
  */
-  __pyx_t_5 = __pyx_v_d;
-  for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_5; __pyx_t_7+=1) {
+  __pyx_t_4 = __pyx_v_d;
+  for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_4; __pyx_t_7+=1) {
     __pyx_v_level = __pyx_t_7;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":149
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":149
  * 
  *         for level in range(d):
  *             prevnode = chain[level]             # <<<<<<<<<<<<<<
  *             tmpnode = prevnode.next[level]
  *             prevnode.width[level] += tmpnode.width[level] - 1
  */
-    __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_prevnode));
-    __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
-    __pyx_t_3 = 0;
+    __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_2);
+    __pyx_t_2 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":150
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":150
  *         for level in range(d):
  *             prevnode = chain[level]
  *             tmpnode = prevnode.next[level]             # <<<<<<<<<<<<<<
  *             prevnode.width[level] += tmpnode.width[level] - 1
  *             prevnode.next[level] = tmpnode.next[level]
  */
-    __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_tmpnode));
-    __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
-    __pyx_t_3 = 0;
+    __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_2);
+    __pyx_t_2 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":151
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":151
  *             prevnode = chain[level]
  *             tmpnode = prevnode.next[level]
  *             prevnode.width[level] += tmpnode.width[level] - 1             # <<<<<<<<<<<<<<
@@ -3522,45 +3738,45 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
  */
     (__pyx_v_prevnode->width[__pyx_v_level]) += ((__pyx_v_tmpnode->width[__pyx_v_level]) - 1);
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":152
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":152
  *             tmpnode = prevnode.next[level]
  *             prevnode.width[level] += tmpnode.width[level] - 1
  *             prevnode.next[level] = tmpnode.next[level]             # <<<<<<<<<<<<<<
  * 
  *         for level in range(d, self.maxlevels):
  */
-    __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_tmpnode->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    if (__Pyx_SetItemInt(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, __pyx_t_3, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_tmpnode->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    if (__Pyx_SetItemInt(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, __pyx_t_2, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":154
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":154
  *             prevnode.next[level] = tmpnode.next[level]
  * 
  *         for level in range(d, self.maxlevels):             # <<<<<<<<<<<<<<
  *             tmpnode = chain[level]
  *             tmpnode.width[level] -= 1
  */
-  __pyx_t_5 = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels;
-  for (__pyx_t_7 = __pyx_v_d; __pyx_t_7 < __pyx_t_5; __pyx_t_7+=1) {
+  __pyx_t_4 = __pyx_v_self->maxlevels;
+  for (__pyx_t_7 = __pyx_v_d; __pyx_t_7 < __pyx_t_4; __pyx_t_7+=1) {
     __pyx_v_level = __pyx_t_7;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":155
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":155
  * 
  *         for level in range(d, self.maxlevels):
  *             tmpnode = chain[level]             # <<<<<<<<<<<<<<
  *             tmpnode.width[level] -= 1
  * 
  */
-    __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_tmpnode));
-    __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
-    __pyx_t_3 = 0;
+    __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_2);
+    __pyx_t_2 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":156
+    /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":156
  *         for level in range(d, self.maxlevels):
  *             tmpnode = chain[level]
  *             tmpnode.width[level] -= 1             # <<<<<<<<<<<<<<
@@ -3570,12 +3786,12 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
     (__pyx_v_tmpnode->width[__pyx_v_level]) -= 1;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":158
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":158
  *             tmpnode.width[level] -= 1
  * 
  *         self.size -= 1             # <<<<<<<<<<<<<<
  */
-  ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->size -= 1;
+  __pyx_v_self->size -= 1;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
@@ -3584,20 +3800,61 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("tseries.IndexableSkiplist.remove");
-  __pyx_r = NULL;
+  __pyx_r = 0;
   __pyx_L0:;
   __Pyx_DECREF((PyObject *)__pyx_v_node);
   __Pyx_DECREF((PyObject *)__pyx_v_prevnode);
   __Pyx_DECREF((PyObject *)__pyx_v_tmpnode);
   __Pyx_DECREF((PyObject *)__pyx_v_next_at_level);
   __Pyx_DECREF(__pyx_v_chain);
-  __Pyx_DECREF((PyObject *)__pyx_v_self);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":5
+/* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":125
+ *         self.size += 1
+ * 
+ *     cpdef remove(self, double value):             # <<<<<<<<<<<<<<
+ *         cdef int level, d
+ *         cdef Node node, prevnode, tmpnode, next_at_level
+ */
+
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
+  double __pyx_v_value;
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  __Pyx_RefNannySetupContext("remove");
+  assert(__pyx_arg_value); {
+    __pyx_v_value = __pyx_PyFloat_AsDouble(__pyx_arg_value); if (unlikely((__pyx_v_value == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.remove");
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->__pyx_vtab)->remove(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self), __pyx_v_value, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.remove");
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":5
  * cdef double NEGINF = -INF
  * 
  * cdef inline _checknull(object val):             # <<<<<<<<<<<<<<
@@ -3613,19 +3870,18 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   __Pyx_RefNannySetupContext("_checknull");
-  __Pyx_INCREF(__pyx_v_val);
 
-  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":6
+  /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":6
  * 
  * cdef inline _checknull(object val):
  *     if isinstance(val, float):             # <<<<<<<<<<<<<<
  *         return val != val or val == INF or val == NEGINF
  *     else:
  */
-  __pyx_t_1 = PyObject_TypeCheck(__pyx_v_val, ((PyTypeObject *)((PyObject*)&PyFloat_Type))); 
+  __pyx_t_1 = PyFloat_Check(__pyx_v_val); 
   if (__pyx_t_1) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":7
+    /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":7
  * cdef inline _checknull(object val):
  *     if isinstance(val, float):
  *         return val != val or val == INF or val == NEGINF             # <<<<<<<<<<<<<<
@@ -3670,7 +3926,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val
   }
   /*else*/ {
 
-    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":9
+    /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":9
  *         return val != val or val == INF or val == NEGINF
  *     else:
  *         return val is None             # <<<<<<<<<<<<<<
@@ -3697,13 +3953,12 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val
   __Pyx_AddTraceback("tseries._checknull");
   __pyx_r = 0;
   __pyx_L0:;
-  __Pyx_DECREF(__pyx_v_val);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":11
+/* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":11
  *         return val is None
  * 
  * cpdef checknull(object val):             # <<<<<<<<<<<<<<
@@ -3717,7 +3972,7 @@ static  PyObject *__pyx_f_7tseries_checknull(PyObject *__pyx_v_val, int __pyx_sk
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("checknull");
 
-  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":12
+  /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":12
  * 
  * cpdef checknull(object val):
  *     return _checknull(val)             # <<<<<<<<<<<<<<
@@ -3743,7 +3998,7 @@ static  PyObject *__pyx_f_7tseries_checknull(PyObject *__pyx_v_val, int __pyx_sk
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":11
+/* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":11
  *         return val is None
  * 
  * cpdef checknull(object val):             # <<<<<<<<<<<<<<
@@ -3776,7 +4031,7 @@ static PyObject *__pyx_pf_7tseries_checknull(PyObject *__pyx_self, PyObject *__p
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":14
+/* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":14
  *     return _checknull(val)
  * 
  * def isnullobj(ndarray input):             # <<<<<<<<<<<<<<
@@ -3810,14 +4065,13 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
   int __pyx_t_13;
   __Pyx_RefNannySetupContext("isnullobj");
   __pyx_self = __pyx_self;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_v_val = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_iter = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_result.buf = NULL;
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":20
+  /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":20
  *     cdef flatiter iter
  * 
  *     length = PyArray_SIZE(input)             # <<<<<<<<<<<<<<
@@ -3826,7 +4080,7 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
  */
   __pyx_v_length = PyArray_SIZE(((PyArrayObject *)__pyx_v_input));
 
-  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":22
+  /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":22
  *     length = PyArray_SIZE(input)
  * 
  *     result = <ndarray> np.zeros(length, dtype=np.int8)             # <<<<<<<<<<<<<<
@@ -3883,7 +4137,7 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":24
+  /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":24
  *     result = <ndarray> np.zeros(length, dtype=np.int8)
  * 
  *     iter= PyArray_IterNew(input)             # <<<<<<<<<<<<<<
@@ -3897,7 +4151,7 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
   __pyx_v_iter = ((PyArrayIterObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":26
+  /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":26
  *     iter= PyArray_IterNew(input)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -3907,7 +4161,7 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
   __pyx_t_7 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":27
+    /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":27
  * 
  *     for i from 0 <= i < length:
  *         val = PyArray_GETITEM(input, PyArray_ITER_DATA(iter))             # <<<<<<<<<<<<<<
@@ -3920,7 +4174,7 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
     __pyx_v_val = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":29
+    /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":29
  *         val = PyArray_GETITEM(input, PyArray_ITER_DATA(iter))
  * 
  *         if _checknull(val):             # <<<<<<<<<<<<<<
@@ -3933,7 +4187,7 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_11) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":30
+      /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":30
  * 
  *         if _checknull(val):
  *             result[i] = 1             # <<<<<<<<<<<<<<
@@ -3955,7 +4209,7 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L7:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":32
+    /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":32
  *             result[i] = 1
  * 
  *         PyArray_ITER_NEXT(iter)             # <<<<<<<<<<<<<<
@@ -3965,7 +4219,7 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
     PyArray_ITER_NEXT(__pyx_v_iter);
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":34
+  /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":34
  *         PyArray_ITER_NEXT(iter)
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -3996,13 +4250,12 @@ static PyObject *__pyx_pf_7tseries_isnullobj(PyObject *__pyx_self, PyObject *__p
   __Pyx_DECREF(__pyx_v_val);
   __Pyx_DECREF((PyObject *)__pyx_v_result);
   __Pyx_DECREF((PyObject *)__pyx_v_iter);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":5
+/* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":5
  * # Groupby-related functions
  * 
  * cdef inline _isnan(object o):             # <<<<<<<<<<<<<<
@@ -4015,7 +4268,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__isnan(PyObject *__pyx_v_o) {
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("_isnan");
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":6
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":6
  * 
  * cdef inline _isnan(object o):
  *     return o != o             # <<<<<<<<<<<<<<
@@ -4041,7 +4294,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__isnan(PyObject *__pyx_v_o) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":9
+/* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":9
  * 
  * @cython.boundscheck(False)
  * def arrmap(ndarray[object, ndim=1] index, object func):             # <<<<<<<<<<<<<<
@@ -4113,10 +4366,9 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __Pyx_RaiseArgtupleInvalid("arrmap", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.arrmap");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF(__pyx_v_func);
   __pyx_bstruct_result.buf = NULL;
   __pyx_bstruct_index.buf = NULL;
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
@@ -4127,7 +4379,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
   __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":10
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":10
  * @cython.boundscheck(False)
  * def arrmap(ndarray[object, ndim=1] index, object func):
  *     cdef int length = index.shape[0]             # <<<<<<<<<<<<<<
@@ -4136,7 +4388,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
  */
   __pyx_v_length = (__pyx_v_index->dimensions[0]);
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":11
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":11
  * def arrmap(ndarray[object, ndim=1] index, object func):
  *     cdef int length = index.shape[0]
  *     cdef int i = 0             # <<<<<<<<<<<<<<
@@ -4145,7 +4397,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
  */
   __pyx_v_i = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":13
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":13
  *     cdef int i = 0
  * 
  *     cdef ndarray[object, ndim=1] result = np.empty(length, dtype=np.object_)             # <<<<<<<<<<<<<<
@@ -4193,7 +4445,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":15
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":15
  *     cdef ndarray[object, ndim=1] result = np.empty(length, dtype=np.object_)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -4203,7 +4455,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_t_7 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":16
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":16
  * 
  *     for i from 0 <= i < length:
  *         result[i] = trycall(func, index[i])             # <<<<<<<<<<<<<<
@@ -4227,7 +4479,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":18
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":18
  *         result[i] = trycall(func, index[i])
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -4260,14 +4512,12 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_result);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF(__pyx_v_func);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":21
+/* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":21
  * 
  * @cython.boundscheck(False)
  * def groupby(object index, object mapper, output=None):             # <<<<<<<<<<<<<<
@@ -4345,7 +4595,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
       case  2:
       if (kw_args > 0) {
         PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
-        if (unlikely(value)) { values[2] = value; kw_args--; }
+        if (value) { values[2] = value; kw_args--; }
       }
     }
     if (unlikely(kw_args > 0)) {
@@ -4371,11 +4621,9 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __Pyx_RaiseArgtupleInvalid("groupby", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.groupby");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF(__pyx_v_index);
-  __Pyx_INCREF(__pyx_v_mapper);
-  __Pyx_INCREF(__pyx_v_output);
   __pyx_v_result = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_mapped_index = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_index_buf = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
@@ -4388,7 +4636,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_bstruct_index_buf.buf = NULL;
   __pyx_bstruct_mask.buf = NULL;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":30
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":30
  *     cdef object idx, key
  * 
  *     length = len(index)             # <<<<<<<<<<<<<<
@@ -4398,7 +4646,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_t_1 = PyObject_Length(__pyx_v_index); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_length = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":32
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":32
  *     length = len(index)
  * 
  *     if output is None:             # <<<<<<<<<<<<<<
@@ -4408,7 +4656,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_t_2 = (__pyx_v_output == Py_None);
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":33
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":33
  * 
  *     if output is None:
  *         result = {}             # <<<<<<<<<<<<<<
@@ -4424,7 +4672,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   }
   /*else*/ {
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":35
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":35
  *         result = {}
  *     else:
  *         result = <dict> output             # <<<<<<<<<<<<<<
@@ -4437,7 +4685,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":37
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":37
  *         result = <dict> output
  * 
  *     index_buf = np.asarray(index)             # <<<<<<<<<<<<<<
@@ -4482,7 +4730,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_v_index_buf = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":38
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":38
  * 
  *     index_buf = np.asarray(index)
  *     mapped_index = arrmap(index_buf, mapper)             # <<<<<<<<<<<<<<
@@ -4527,7 +4775,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_v_mapped_index = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":39
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":39
  *     index_buf = np.asarray(index)
  *     mapped_index = arrmap(index_buf, mapper)
  *     mask = isnullobj(mapped_index)             # <<<<<<<<<<<<<<
@@ -4569,7 +4817,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_v_mask = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":40
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":40
  *     mapped_index = arrmap(index_buf, mapper)
  *     mask = isnullobj(mapped_index)
  *     nullkeys = index_buf[mask.astype(bool)]             # <<<<<<<<<<<<<<
@@ -4580,9 +4828,9 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
-  __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
+  __Pyx_INCREF(((PyObject*)&PyBool_Type));
+  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject*)&PyBool_Type));
+  __Pyx_GIVEREF(((PyObject*)&PyBool_Type));
   __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
@@ -4594,7 +4842,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_v_nullkeys = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":41
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":41
  *     mask = isnullobj(mapped_index)
  *     nullkeys = index_buf[mask.astype(bool)]
  *     if len(nullkeys) > 0:             # <<<<<<<<<<<<<<
@@ -4605,7 +4853,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_t_2 = (__pyx_t_1 > 0);
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":42
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":42
  *     nullkeys = index_buf[mask.astype(bool)]
  *     if len(nullkeys) > 0:
  *         result[np.NaN] = nullkeys             # <<<<<<<<<<<<<<
@@ -4623,7 +4871,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   }
   __pyx_L7:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":44
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":44
  *         result[np.NaN] = nullkeys
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -4633,7 +4881,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_t_7 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":45
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":45
  * 
  *     for i from 0 <= i < length:
  *         if mask[i]:             # <<<<<<<<<<<<<<
@@ -4645,7 +4893,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     __pyx_t_14 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_13, __pyx_bstride_0_mask));
     if (__pyx_t_14) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":46
+      /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":46
  *     for i from 0 <= i < length:
  *         if mask[i]:
  *             continue             # <<<<<<<<<<<<<<
@@ -4657,7 +4905,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     }
     __pyx_L10:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":48
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":48
  *             continue
  * 
  *         key = mapped_index[i]             # <<<<<<<<<<<<<<
@@ -4672,7 +4920,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     __pyx_v_key = __pyx_t_4;
     __pyx_t_4 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":49
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":49
  * 
  *         key = mapped_index[i]
  *         idx = index_buf[i]             # <<<<<<<<<<<<<<
@@ -4687,7 +4935,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     __pyx_v_idx = __pyx_t_4;
     __pyx_t_4 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":50
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":50
  *         key = mapped_index[i]
  *         idx = index_buf[i]
  *         if key in result:             # <<<<<<<<<<<<<<
@@ -4701,21 +4949,21 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     }
     if (__pyx_t_2) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":51
+      /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":51
  *         idx = index_buf[i]
  *         if key in result:
  *             members = result[key]             # <<<<<<<<<<<<<<
  *             members.append(idx)
  *         else:
  */
-      __pyx_t_4 = PyObject_GetItem(((PyObject *)__pyx_v_result), __pyx_v_key); if (!__pyx_t_4) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = __Pyx_PyDict_GetItem(((PyObject *)__pyx_v_result), __pyx_v_key); if (!__pyx_t_4) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
       if (!(likely(PyList_CheckExact(__pyx_t_4))||((__pyx_t_4) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected list, got %.200s", Py_TYPE(__pyx_t_4)->tp_name), 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(((PyObject *)__pyx_v_members));
       __pyx_v_members = ((PyObject *)__pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":52
+      /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":52
  *         if key in result:
  *             members = result[key]
  *             members.append(idx)             # <<<<<<<<<<<<<<
@@ -4730,7 +4978,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":54
+      /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":54
  *             members.append(idx)
  *         else:
  *             result[key] = [idx]             # <<<<<<<<<<<<<<
@@ -4749,7 +4997,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     __pyx_L8_continue:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":56
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":56
  *             result[key] = [idx]
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -4789,15 +5037,12 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __Pyx_DECREF(__pyx_v_idx);
   __Pyx_DECREF(__pyx_v_key);
   __Pyx_DECREF(__pyx_v_nullkeys);
-  __Pyx_DECREF(__pyx_v_index);
-  __Pyx_DECREF(__pyx_v_mapper);
-  __Pyx_DECREF(__pyx_v_output);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":59
+/* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":59
  * 
  * @cython.boundscheck(False)
  * def groupby_indices(object index, object mapper):             # <<<<<<<<<<<<<<
@@ -4878,10 +5123,10 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __Pyx_RaiseArgtupleInvalid("groupby_indices", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.groupby_indices");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF(__pyx_v_index);
-  __Pyx_INCREF(__pyx_v_mapper);
   __pyx_v_result = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_mapped_index = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
@@ -4890,7 +5135,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __pyx_bstruct_mapped_index.buf = NULL;
   __pyx_bstruct_mask.buf = NULL;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":67
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":67
  *     cdef object key
  * 
  *     length = len(index)             # <<<<<<<<<<<<<<
@@ -4900,7 +5145,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __pyx_t_1 = PyObject_Length(__pyx_v_index); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_length = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":69
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":69
  *     length = len(index)
  * 
  *     result = {}             # <<<<<<<<<<<<<<
@@ -4913,7 +5158,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __pyx_v_result = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":70
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":70
  * 
  *     result = {}
  *     index = np.asarray(index)             # <<<<<<<<<<<<<<
@@ -4938,7 +5183,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __pyx_v_index = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":71
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":71
  *     result = {}
  *     index = np.asarray(index)
  *     mapped_index = arrmap(index, mapper)             # <<<<<<<<<<<<<<
@@ -4983,7 +5228,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __pyx_v_mapped_index = ((PyArrayObject *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":73
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":73
  *     mapped_index = arrmap(index, mapper)
  * 
  *     mask = isnullobj(mapped_index)             # <<<<<<<<<<<<<<
@@ -5025,7 +5270,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __pyx_v_mask = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":75
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":75
  *     mask = isnullobj(mapped_index)
  * 
  *     if mask.astype(bool).any():             # <<<<<<<<<<<<<<
@@ -5036,9 +5281,9 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
-  __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
+  __Pyx_INCREF(((PyObject*)&PyBool_Type));
+  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject*)&PyBool_Type));
+  __Pyx_GIVEREF(((PyObject*)&PyBool_Type));
   __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -5053,7 +5298,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_11) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":76
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":76
  * 
  *     if mask.astype(bool).any():
  *         null_list = []             # <<<<<<<<<<<<<<
@@ -5066,7 +5311,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
     __pyx_v_null_list = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":77
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":77
  *     if mask.astype(bool).any():
  *         null_list = []
  *         result[np.NaN] = null_list             # <<<<<<<<<<<<<<
@@ -5084,7 +5329,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":79
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":79
  *         result[np.NaN] = null_list
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -5094,7 +5339,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __pyx_t_6 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":80
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":80
  * 
  *     for i from 0 <= i < length:
  *         if mask[i]:             # <<<<<<<<<<<<<<
@@ -5106,7 +5351,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
     __pyx_t_13 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_12, __pyx_bstride_0_mask));
     if (__pyx_t_13) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":81
+      /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":81
  *     for i from 0 <= i < length:
  *         if mask[i]:
  *             null_list.append(i)             # <<<<<<<<<<<<<<
@@ -5124,7 +5369,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
     }
     __pyx_L9:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":82
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":82
  *         if mask[i]:
  *             null_list.append(i)
  *         key = mapped_index[i]             # <<<<<<<<<<<<<<
@@ -5139,7 +5384,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
     __pyx_v_key = __pyx_t_2;
     __pyx_t_2 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":83
+    /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":83
  *             null_list.append(i)
  *         key = mapped_index[i]
  *         if key in result:             # <<<<<<<<<<<<<<
@@ -5153,14 +5398,14 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
     }
     if (__pyx_t_11) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":84
+      /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":84
  *         key = mapped_index[i]
  *         if key in result:
  *             (<list> result[key]).append(i)             # <<<<<<<<<<<<<<
  *         else:
  *             result[key] = [i]
  */
-      __pyx_t_2 = PyObject_GetItem(((PyObject *)__pyx_v_result), __pyx_v_key); if (!__pyx_t_2) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = __Pyx_PyDict_GetItem(((PyObject *)__pyx_v_result), __pyx_v_key); if (!__pyx_t_2) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
       if (unlikely(((PyObject *)__pyx_t_2) == Py_None)) {
         PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
@@ -5174,7 +5419,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":86
+      /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":86
  *             (<list> result[key]).append(i)
  *         else:
  *             result[key] = [i]             # <<<<<<<<<<<<<<
@@ -5194,7 +5439,7 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
     __pyx_L10:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":88
+  /* "/home/wesm/code/pandas/pandas/lib/src/groupby.pyx":88
  *             result[key] = [i]
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -5228,13 +5473,12 @@ static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObjec
   __Pyx_DECREF(__pyx_v_null_list);
   __Pyx_DECREF(__pyx_v_key);
   __Pyx_DECREF(__pyx_v_index);
-  __Pyx_DECREF(__pyx_v_mapper);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":20
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":28
  * 
  * 
  * def kth_smallest(ndarray[double_t, ndim=1] a, int k):             # <<<<<<<<<<<<<<
@@ -5290,48 +5534,48 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__k);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("kth_smallest", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("kth_smallest", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "kth_smallest") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "kth_smallest") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_a = ((PyArrayObject *)values[0]);
-    __pyx_v_k = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_k == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_k = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_k == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_a = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_k = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_k == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_k = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_k == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("kth_smallest", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("kth_smallest", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.kth_smallest");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_a);
   __pyx_bstruct_a.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_a, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_a, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_a = __pyx_bstruct_a.strides[0];
   __pyx_bshape_0_a = __pyx_bstruct_a.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":25
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":33
  *         double_t x, t
  * 
  *     n = len(a)             # <<<<<<<<<<<<<<
  * 
  *     l = 0
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_a)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_a)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_n = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":27
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":35
  *     n = len(a)
  * 
  *     l = 0             # <<<<<<<<<<<<<<
@@ -5340,7 +5584,7 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
  */
   __pyx_v_l = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":28
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":36
  * 
  *     l = 0
  *     m = n-1             # <<<<<<<<<<<<<<
@@ -5349,7 +5593,7 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
  */
   __pyx_v_m = (__pyx_v_n - 1);
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":29
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":37
  *     l = 0
  *     m = n-1
  *     while (l<m):             # <<<<<<<<<<<<<<
@@ -5360,7 +5604,7 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
     __pyx_t_2 = (__pyx_v_l < __pyx_v_m);
     if (!__pyx_t_2) break;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":30
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":38
  *     m = n-1
  *     while (l<m):
  *         x = a[k]             # <<<<<<<<<<<<<<
@@ -5375,11 +5619,11 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
     } else if (unlikely(__pyx_t_3 >= __pyx_bshape_0_a)) __pyx_t_4 = 0;
     if (unlikely(__pyx_t_4 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_4);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_x = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_a.buf, __pyx_t_3, __pyx_bstride_0_a));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":31
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":39
  *     while (l<m):
  *         x = a[k]
  *         i = l             # <<<<<<<<<<<<<<
@@ -5388,7 +5632,7 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
  */
     __pyx_v_i = __pyx_v_l;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":32
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":40
  *         x = a[k]
  *         i = l
  *         j = m             # <<<<<<<<<<<<<<
@@ -5397,23 +5641,22 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
  */
     __pyx_v_j = __pyx_v_m;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":34
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":42
  *         j = m
  * 
  *         while 1:             # <<<<<<<<<<<<<<
- *             while a[i] < x:
- *                 i += 1
+ *             while a[i] < x: i += 1
+ *             while x < a[j]: j -= 1
  */
     while (1) {
-      __pyx_t_2 = 1;
-      if (!__pyx_t_2) break;
+      if (!1) break;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":35
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":43
  * 
  *         while 1:
- *             while a[i] < x:             # <<<<<<<<<<<<<<
- *                 i += 1
- *             while x < a[j]:
+ *             while a[i] < x: i += 1             # <<<<<<<<<<<<<<
+ *             while x < a[j]: j -= 1
+ *             if i <= j:
  */
       while (1) {
         __pyx_t_4 = __pyx_v_i;
@@ -5424,27 +5667,19 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
         } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_a)) __pyx_t_5 = 0;
         if (unlikely(__pyx_t_5 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_5);
-          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         __pyx_t_2 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_a.buf, __pyx_t_4, __pyx_bstride_0_a)) < __pyx_v_x);
         if (!__pyx_t_2) break;
-
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":36
- *         while 1:
- *             while a[i] < x:
- *                 i += 1             # <<<<<<<<<<<<<<
- *             while x < a[j]:
- *                 j -= 1
- */
         __pyx_v_i += 1;
       }
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":37
- *             while a[i] < x:
- *                 i += 1
- *             while x < a[j]:             # <<<<<<<<<<<<<<
- *                 j -= 1
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":44
+ *         while 1:
+ *             while a[i] < x: i += 1
+ *             while x < a[j]: j -= 1             # <<<<<<<<<<<<<<
  *             if i <= j:
+ *                 t = a[i]
  */
       while (1) {
         __pyx_t_5 = __pyx_v_j;
@@ -5455,24 +5690,16 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
         } else if (unlikely(__pyx_t_5 >= __pyx_bshape_0_a)) __pyx_t_6 = 0;
         if (unlikely(__pyx_t_6 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_6);
-          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         __pyx_t_2 = (__pyx_v_x < (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_a.buf, __pyx_t_5, __pyx_bstride_0_a)));
         if (!__pyx_t_2) break;
-
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":38
- *                 i += 1
- *             while x < a[j]:
- *                 j -= 1             # <<<<<<<<<<<<<<
- *             if i <= j:
- *                 t = a[i]
- */
         __pyx_v_j -= 1;
       }
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":39
- *             while x < a[j]:
- *                 j -= 1
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":45
+ *             while a[i] < x: i += 1
+ *             while x < a[j]: j -= 1
  *             if i <= j:             # <<<<<<<<<<<<<<
  *                 t = a[i]
  *                 a[i] = a[j]
@@ -5480,8 +5707,8 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
       __pyx_t_2 = (__pyx_v_i <= __pyx_v_j);
       if (__pyx_t_2) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":40
- *                 j -= 1
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":46
+ *             while x < a[j]: j -= 1
  *             if i <= j:
  *                 t = a[i]             # <<<<<<<<<<<<<<
  *                 a[i] = a[j]
@@ -5495,16 +5722,16 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
         } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_a)) __pyx_t_7 = 0;
         if (unlikely(__pyx_t_7 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_7);
-          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         __pyx_v_t = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_a.buf, __pyx_t_6, __pyx_bstride_0_a));
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":41
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":47
  *             if i <= j:
  *                 t = a[i]
  *                 a[i] = a[j]             # <<<<<<<<<<<<<<
  *                 a[j] = t
- *                 i += 1
+ *                 i += 1; j -= 1
  */
         __pyx_t_7 = __pyx_v_j;
         __pyx_t_8 = -1;
@@ -5514,7 +5741,7 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
         } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_a)) __pyx_t_8 = 0;
         if (unlikely(__pyx_t_8 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_8);
-          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         __pyx_t_8 = __pyx_v_i;
         __pyx_t_9 = -1;
@@ -5524,16 +5751,16 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
         } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_a)) __pyx_t_9 = 0;
         if (unlikely(__pyx_t_9 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_9);
-          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_a.buf, __pyx_t_8, __pyx_bstride_0_a) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_a.buf, __pyx_t_7, __pyx_bstride_0_a));
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":42
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":48
  *                 t = a[i]
  *                 a[i] = a[j]
  *                 a[j] = t             # <<<<<<<<<<<<<<
- *                 i += 1
- *                 j -= 1
+ *                 i += 1; j -= 1
+ * 
  */
         __pyx_t_9 = __pyx_v_j;
         __pyx_t_10 = -1;
@@ -5543,48 +5770,32 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
         } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_a)) __pyx_t_10 = 0;
         if (unlikely(__pyx_t_10 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_10);
-          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_a.buf, __pyx_t_9, __pyx_bstride_0_a) = __pyx_v_t;
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":43
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":49
  *                 a[i] = a[j]
  *                 a[j] = t
- *                 i += 1             # <<<<<<<<<<<<<<
- *                 j -= 1
- *             if i > j:
+ *                 i += 1; j -= 1             # <<<<<<<<<<<<<<
+ * 
+ *             if i > j: break
  */
         __pyx_v_i += 1;
-
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":44
- *                 a[j] = t
- *                 i += 1
- *                 j -= 1             # <<<<<<<<<<<<<<
- *             if i > j:
- *                 break
- */
         __pyx_v_j -= 1;
         goto __pyx_L14;
       }
       __pyx_L14:;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":45
- *                 i += 1
- *                 j -= 1
- *             if i > j:             # <<<<<<<<<<<<<<
- *                 break
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":51
+ *                 i += 1; j -= 1
  * 
- */
-      __pyx_t_2 = (__pyx_v_i > __pyx_v_j);
-      if (__pyx_t_2) {
-
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":46
- *                 j -= 1
- *             if i > j:
- *                 break             # <<<<<<<<<<<<<<
+ *             if i > j: break             # <<<<<<<<<<<<<<
  * 
  *         if j < k: l = i
  */
+      __pyx_t_2 = (__pyx_v_i > __pyx_v_j);
+      if (__pyx_t_2) {
         goto __pyx_L9_break;
         goto __pyx_L15;
       }
@@ -5592,8 +5803,8 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
     }
     __pyx_L9_break:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":48
- *                 break
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":53
+ *             if i > j: break
  * 
  *         if j < k: l = i             # <<<<<<<<<<<<<<
  *         if k < i: m = j
@@ -5606,7 +5817,7 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
     }
     __pyx_L16:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":49
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":54
  * 
  *         if j < k: l = i
  *         if k < i: m = j             # <<<<<<<<<<<<<<
@@ -5621,7 +5832,7 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
     __pyx_L17:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":50
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":55
  *         if j < k: l = i
  *         if k < i: m = j
  *     return a[k]             # <<<<<<<<<<<<<<
@@ -5637,9 +5848,9 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
   } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_a)) __pyx_t_11 = 0;
   if (unlikely(__pyx_t_11 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_11);
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __pyx_t_12 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_a.buf, __pyx_t_10, __pyx_bstride_0_a))); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_12 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_a.buf, __pyx_t_10, __pyx_bstride_0_a))); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_12);
   __pyx_r = __pyx_t_12;
   __pyx_t_12 = 0;
@@ -5659,13 +5870,12 @@ static PyObject *__pyx_pf_7tseries_kth_smallest(PyObject *__pyx_self, PyObject *
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_a);
   __pyx_L2:;
-  __Pyx_DECREF((PyObject *)__pyx_v_a);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":53
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":58
  * 
  * 
  * def median(ndarray arr):             # <<<<<<<<<<<<<<
@@ -5688,30 +5898,30 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
   __Pyx_RefNannySetupContext("median");
   __pyx_self = __pyx_self;
   __Pyx_INCREF((PyObject *)__pyx_v_arr);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":57
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":62
  *     A faster median
  *     '''
  *     cdef int n = len(arr)             # <<<<<<<<<<<<<<
  * 
  *     if len(arr) == 0:
  */
-  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_n = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":59
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":64
  *     cdef int n = len(arr)
  * 
  *     if len(arr) == 0:             # <<<<<<<<<<<<<<
  *         return np.NaN
  * 
  */
-  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_2 = (__pyx_t_1 == 0);
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":60
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":65
  * 
  *     if len(arr) == 0:
  *         return np.NaN             # <<<<<<<<<<<<<<
@@ -5719,9 +5929,9 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
  *     arr = arr.copy()
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__NaN); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__NaN); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_r = __pyx_t_4;
@@ -5731,24 +5941,24 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
   }
   __pyx_L5:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":62
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":67
  *         return np.NaN
  * 
  *     arr = arr.copy()             # <<<<<<<<<<<<<<
  * 
  *     if n % 2:
  */
-  __pyx_t_4 = PyObject_GetAttr(__pyx_v_arr, __pyx_n_s__copy); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_v_arr, __pyx_n_s__copy); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_v_arr);
   __pyx_v_arr = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":64
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":69
  *     arr = arr.copy()
  * 
  *     if n % 2:             # <<<<<<<<<<<<<<
@@ -5758,7 +5968,7 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_t_5 = __Pyx_mod_long(__pyx_v_n, 2);
   if (__pyx_t_5) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":65
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":70
  * 
  *     if n % 2:
  *         return kth_smallest(arr, n / 2)             # <<<<<<<<<<<<<<
@@ -5766,11 +5976,11 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
  *         return (kth_smallest(arr, n / 2) +
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__kth_smallest); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__kth_smallest); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyInt_FromLong(__Pyx_div_long(__pyx_v_n, 2)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyInt_FromLong(__Pyx_div_long(__pyx_v_n, 2)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_arr);
@@ -5778,7 +5988,7 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
@@ -5789,7 +5999,7 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
   }
   /*else*/ {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":67
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":72
  *         return kth_smallest(arr, n / 2)
  *     else:
  *         return (kth_smallest(arr, n / 2) +             # <<<<<<<<<<<<<<
@@ -5798,26 +6008,26 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
  */
     __Pyx_XDECREF(__pyx_r);
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":68
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":73
  *     else:
  *         return (kth_smallest(arr, n / 2) +
  *                 kth_smallest(arr, n / 2 - 1)) / 2             # <<<<<<<<<<<<<<
  * 
  * #-------------------------------------------------------------------------------
  */
-    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__kth_smallest); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__kth_smallest); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":67
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":72
  *         return kth_smallest(arr, n / 2)
  *     else:
  *         return (kth_smallest(arr, n / 2) +             # <<<<<<<<<<<<<<
  *                 kth_smallest(arr, n / 2 - 1)) / 2
  * 
  */
-    __pyx_t_6 = PyInt_FromLong(__Pyx_div_long(__pyx_v_n, 2)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyInt_FromLong(__Pyx_div_long(__pyx_v_n, 2)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_arr);
@@ -5825,23 +6035,23 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     __pyx_t_6 = 0;
-    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":68
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":73
  *     else:
  *         return (kth_smallest(arr, n / 2) +
  *                 kth_smallest(arr, n / 2 - 1)) / 2             # <<<<<<<<<<<<<<
  * 
  * #-------------------------------------------------------------------------------
  */
-    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__kth_smallest); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__kth_smallest); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyInt_FromLong((__Pyx_div_long(__pyx_v_n, 2) - 1)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyInt_FromLong((__Pyx_div_long(__pyx_v_n, 2) - 1)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_INCREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_arr);
@@ -5849,15 +6059,15 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_7, __pyx_int_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_7, __pyx_int_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_r = __pyx_t_4;
@@ -5882,7 +6092,7 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":73
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":78
  * # Rolling sum
  * 
  * def roll_sum(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
@@ -5947,56 +6157,56 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_sum", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_sum", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_sum", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_sum", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_sum") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_sum") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("roll_sum", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("roll_sum", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.roll_sum");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":75
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":80
  * def roll_sum(ndarray[double_t, ndim=1] input,
  *               int win, int minp):
  *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)
  */
-  __pyx_v_sum_x = 0;
+  __pyx_v_sum_x = 0.0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":76
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":81
  *               int win, int minp):
  *     cdef double val, prev, sum_x = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -6005,50 +6215,50 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":77
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":82
  *     cdef double val, prev, sum_x = 0
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":79
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":84
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if minp > N:
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -6057,7 +6267,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":81
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":86
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -6067,7 +6277,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":82
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":87
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -6079,7 +6289,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":84
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":89
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -6089,7 +6299,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":85
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":90
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -6104,11 +6314,11 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":88
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":93
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -6118,7 +6328,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":89
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":94
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -6127,7 +6337,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":90
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":95
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -6139,7 +6349,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     }
     __pyx_L9:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":92
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":97
  *             sum_x += val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -6154,12 +6364,12 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":94
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":99
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -6169,7 +6379,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":95
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":100
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -6184,11 +6394,11 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":97
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":102
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -6198,7 +6408,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":98
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":103
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -6213,11 +6423,11 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":99
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":104
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -6227,7 +6437,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":100
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":105
  *             prev = input[i - win]
  *             if prev == prev:
  *                 sum_x -= prev             # <<<<<<<<<<<<<<
@@ -6236,7 +6446,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
  */
         __pyx_v_sum_x -= __pyx_v_prev;
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":101
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":106
  *             if prev == prev:
  *                 sum_x -= prev
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -6251,7 +6461,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     }
     __pyx_L12:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":103
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":108
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -6261,7 +6471,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":104
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":109
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -6270,7 +6480,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":105
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":110
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -6282,7 +6492,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     }
     __pyx_L14:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":107
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":112
  *             sum_x += val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -6292,7 +6502,7 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
     __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":108
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":113
  * 
  *         if nobs >= minp:
  *             output[i] = sum_x             # <<<<<<<<<<<<<<
@@ -6307,14 +6517,14 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
       } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
       if (unlikely(__pyx_t_15 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_15);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_v_sum_x;
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":110
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":115
  *             output[i] = sum_x
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -6329,14 +6539,14 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
       } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_15, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
     __pyx_L15:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":112
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":117
  *             output[i] = NaN
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -6368,13 +6578,12 @@ static PyObject *__pyx_pf_7tseries_roll_sum(PyObject *__pyx_self, PyObject *__py
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":117
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":122
  * # Rolling mean
  * 
  * def roll_mean(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
@@ -6439,56 +6648,56 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_mean", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_mean", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_mean", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_mean", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_mean") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_mean") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("roll_mean", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("roll_mean", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.roll_mean");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":119
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":124
  * def roll_mean(ndarray[double_t, ndim=1] input,
  *                int win, int minp):
  *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)
  */
-  __pyx_v_sum_x = 0;
+  __pyx_v_sum_x = 0.0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":120
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":125
  *                int win, int minp):
  *     cdef double val, prev, sum_x = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -6497,50 +6706,50 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":121
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":126
  *     cdef double val, prev, sum_x = 0
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":123
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":128
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if minp > N:
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -6549,7 +6758,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":125
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":130
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -6559,7 +6768,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":126
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":131
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -6571,7 +6780,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":128
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":133
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -6581,7 +6790,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":129
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":134
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -6596,11 +6805,11 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":132
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":137
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -6610,7 +6819,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":133
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":138
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -6619,7 +6828,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":134
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":139
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -6631,7 +6840,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L9:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":136
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":141
  *             sum_x += val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -6646,12 +6855,12 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":138
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":143
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -6661,7 +6870,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":139
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":144
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -6676,11 +6885,11 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":141
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":146
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -6690,7 +6899,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":142
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":147
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -6705,11 +6914,11 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":143
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":148
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -6719,7 +6928,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":144
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":149
  *             prev = input[i - win]
  *             if prev == prev:
  *                 sum_x -= prev             # <<<<<<<<<<<<<<
@@ -6728,7 +6937,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_sum_x -= __pyx_v_prev;
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":145
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":150
  *             if prev == prev:
  *                 sum_x -= prev
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -6743,7 +6952,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L12:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":147
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":152
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -6753,7 +6962,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":148
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":153
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -6762,7 +6971,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":149
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":154
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -6774,7 +6983,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L14:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":151
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":156
  *             sum_x += val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -6784,7 +6993,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":152
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":157
  * 
  *         if nobs >= minp:
  *             output[i] = sum_x / nobs             # <<<<<<<<<<<<<<
@@ -6793,7 +7002,7 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_t_14 = __pyx_v_i;
       __pyx_t_15 = -1;
@@ -6803,14 +7012,14 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
       if (unlikely(__pyx_t_15 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_15);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = (__pyx_v_sum_x / __pyx_v_nobs);
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":154
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":159
  *             output[i] = sum_x / nobs
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -6825,14 +7034,14 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_15, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
     __pyx_L15:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":156
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":161
  *             output[i] = NaN
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -6864,24 +7073,24 @@ static PyObject *__pyx_pf_7tseries_roll_mean(PyObject *__pyx_self, PyObject *__p
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":161
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":166
  * # Exponentially weighted moving average
  * 
- * def ewma(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *          int com):
- *     cdef double cur, prev, neww, oldw, adj
+ * def ewma(ndarray[double_t, ndim=1] input, double_t com):             # <<<<<<<<<<<<<<
+ *     '''
+ *     Compute exponentially-weighted moving average using center-of-mass.
  */
 
 static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7tseries_ewma[] = "\n    Compute exponentially-weighted moving average using center-of-mass.\n\n    Parameters\n    ----------\n    input : ndarray (float64 type)\n    com : float64\n\n    Returns\n    -------\n    y : ndarray\n    ";
 static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
-  int __pyx_v_com;
+  __pyx_t_5numpy_double_t __pyx_v_com;
   double __pyx_v_cur;
   double __pyx_v_prev;
   double __pyx_v_neww;
@@ -6903,7 +7112,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyArrayObject *__pyx_t_6 = NULL;
-  double __pyx_t_7;
+  __pyx_t_5numpy_double_t __pyx_t_7;
   long __pyx_t_8;
   int __pyx_t_9;
   long __pyx_t_10;
@@ -6916,7 +7125,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   int __pyx_t_17;
   int __pyx_t_18;
   int __pyx_t_19;
-  __pyx_t_5numpy_double_t __pyx_t_20;
+  double __pyx_t_20;
   int __pyx_t_21;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__com,0};
   __Pyx_RefNannySetupContext("ewma");
@@ -6939,82 +7148,82 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__com);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "ewma") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "ewma") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_com = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_com = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_com == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_com = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_com = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_com == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.ewma");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":165
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":182
  *     cdef double cur, prev, neww, oldw, adj
  *     cdef int i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":167
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":184
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -7023,30 +7232,30 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":170
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":187
  * 
  * 
  *     neww = 1. / (1. + com)             # <<<<<<<<<<<<<<
  *     oldw = 1. - neww
  *     adj = oldw
  */
-  __pyx_t_7 = (1.0 + __pyx_v_com);
+  __pyx_t_7 = (1. + __pyx_v_com);
   if (unlikely(__pyx_t_7 == 0)) {
     PyErr_Format(PyExc_ZeroDivisionError, "float division");
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __pyx_v_neww = (1.0 / __pyx_t_7);
+  __pyx_v_neww = (1. / __pyx_t_7);
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":171
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":188
  * 
  *     neww = 1. / (1. + com)
  *     oldw = 1. - neww             # <<<<<<<<<<<<<<
  *     adj = oldw
  * 
  */
-  __pyx_v_oldw = (1.0 - __pyx_v_neww);
+  __pyx_v_oldw = (1. - __pyx_v_neww);
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":172
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":189
  *     neww = 1. / (1. + com)
  *     oldw = 1. - neww
  *     adj = oldw             # <<<<<<<<<<<<<<
@@ -7055,7 +7264,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
  */
   __pyx_v_adj = __pyx_v_oldw;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":174
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":191
  *     adj = oldw
  * 
  *     output[0] = neww * input[0]             # <<<<<<<<<<<<<<
@@ -7070,7 +7279,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_input)) __pyx_t_9 = 0;
   if (unlikely(__pyx_t_9 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_9);
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_t_10 = 0;
   __pyx_t_9 = -1;
@@ -7080,11 +7289,11 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
   if (unlikely(__pyx_t_9 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_9);
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = (__pyx_v_neww * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_8, __pyx_bstride_0_input)));
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":176
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":193
  *     output[0] = neww * input[0]
  * 
  *     for i from 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -7094,7 +7303,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   __pyx_t_9 = __pyx_v_N;
   for (__pyx_v_i = 1; __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":177
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":194
  * 
  *     for i from 1 <= i < N:
  *         cur = input[i]             # <<<<<<<<<<<<<<
@@ -7109,11 +7318,11 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_input)) __pyx_t_12 = 0;
     if (unlikely(__pyx_t_12 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_12);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_cur = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_11, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":178
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":195
  *     for i from 1 <= i < N:
  *         cur = input[i]
  *         prev = output[i - 1]             # <<<<<<<<<<<<<<
@@ -7128,11 +7337,11 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_output)) __pyx_t_12 = 0;
     if (unlikely(__pyx_t_12 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_12);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_13, __pyx_bstride_0_output));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":180
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":197
  *         prev = output[i - 1]
  * 
  *         if cur == cur:             # <<<<<<<<<<<<<<
@@ -7142,7 +7351,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     __pyx_t_14 = (__pyx_v_cur == __pyx_v_cur);
     if (__pyx_t_14) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":181
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":198
  * 
  *         if cur == cur:
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -7152,7 +7361,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
       __pyx_t_14 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_14) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":182
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":199
  *         if cur == cur:
  *             if prev == prev:
  *                 output[i] = oldw * prev + neww * cur             # <<<<<<<<<<<<<<
@@ -7167,14 +7376,14 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
         } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
         if (unlikely(__pyx_t_15 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_15);
-          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_12, __pyx_bstride_0_output) = ((__pyx_v_oldw * __pyx_v_prev) + (__pyx_v_neww * __pyx_v_cur));
         goto __pyx_L9;
       }
       /*else*/ {
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":184
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":201
  *                 output[i] = oldw * prev + neww * cur
  *             else:
  *                 output[i] = neww * cur             # <<<<<<<<<<<<<<
@@ -7189,7 +7398,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
         } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[5]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_15, __pyx_bstride_0_output) = (__pyx_v_neww * __pyx_v_cur);
       }
@@ -7198,7 +7407,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":186
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":203
  *                 output[i] = neww * cur
  *         else:
  *             output[i] = prev             # <<<<<<<<<<<<<<
@@ -7213,14 +7422,14 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
       } else if (unlikely(__pyx_t_16 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
       if (unlikely(__pyx_t_17 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_17);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_16, __pyx_bstride_0_output) = __pyx_v_prev;
     }
     __pyx_L8:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":188
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":205
  *             output[i] = prev
  * 
  *     for i from 0 <= i < N:             # <<<<<<<<<<<<<<
@@ -7230,7 +7439,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   __pyx_t_9 = __pyx_v_N;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":189
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":206
  * 
  *     for i from 0 <= i < N:
  *         cur = input[i]             # <<<<<<<<<<<<<<
@@ -7245,11 +7454,11 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_input)) __pyx_t_18 = 0;
     if (unlikely(__pyx_t_18 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_18);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_cur = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_17, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":190
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":207
  *     for i from 0 <= i < N:
  *         cur = input[i]
  *         output[i] = output[i] / (1. - adj)             # <<<<<<<<<<<<<<
@@ -7264,13 +7473,13 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     } else if (unlikely(__pyx_t_18 >= __pyx_bshape_0_output)) __pyx_t_19 = 0;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    __pyx_t_20 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_18, __pyx_bstride_0_output));
-    __pyx_t_7 = (1.0 - __pyx_v_adj);
-    if (unlikely(__pyx_t_7 == 0)) {
+    __pyx_t_7 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_18, __pyx_bstride_0_output));
+    __pyx_t_20 = (1. - __pyx_v_adj);
+    if (unlikely(__pyx_t_20 == 0)) {
       PyErr_Format(PyExc_ZeroDivisionError, "float division");
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_t_19 = __pyx_v_i;
     __pyx_t_21 = -1;
@@ -7280,11 +7489,11 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     } else if (unlikely(__pyx_t_19 >= __pyx_bshape_0_output)) __pyx_t_21 = 0;
     if (unlikely(__pyx_t_21 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_21);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_19, __pyx_bstride_0_output) = (__pyx_t_20 / __pyx_t_7);
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_19, __pyx_bstride_0_output) = (__pyx_t_7 / __pyx_t_20);
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":192
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":209
  *         output[i] = output[i] / (1. - adj)
  * 
  *         if cur == cur:             # <<<<<<<<<<<<<<
@@ -7294,7 +7503,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     __pyx_t_14 = (__pyx_v_cur == __pyx_v_cur);
     if (__pyx_t_14) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":193
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":210
  * 
  *         if cur == cur:
  *             adj *= oldw             # <<<<<<<<<<<<<<
@@ -7307,7 +7516,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     __pyx_L12:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":195
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":212
  *             adj *= oldw
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -7339,13 +7548,12 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":200
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":217
  * # Rolling variance
  * 
  * def roll_var(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
@@ -7413,101 +7621,101 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_var", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_var", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_var", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_var", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_var") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_var") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("roll_var", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("roll_var", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.roll_var");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":202
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":219
  * def roll_var(ndarray[double_t, ndim=1] input,
  *               int win, int minp):
  *     cdef double val, prev, sum_x = 0, sum_xx = 0, nobs = 0             # <<<<<<<<<<<<<<
  *     cdef int i
  *     cdef int N = len(input)
  */
-  __pyx_v_sum_x = 0;
-  __pyx_v_sum_xx = 0;
-  __pyx_v_nobs = 0;
+  __pyx_v_sum_x = 0.0;
+  __pyx_v_sum_xx = 0.0;
+  __pyx_v_nobs = 0.0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":204
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":221
  *     cdef double val, prev, sum_x = 0, sum_xx = 0, nobs = 0
  *     cdef int i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":206
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":223
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if minp > N:
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -7516,7 +7724,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":208
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":225
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -7526,7 +7734,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":209
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":226
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -7538,7 +7746,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":211
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":228
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -7548,7 +7756,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":212
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":229
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -7563,11 +7771,11 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":215
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":232
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -7577,16 +7785,16 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":216
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":233
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
  *             sum_x += val
  *             sum_xx += val * val
  */
-      __pyx_v_nobs += 1;
+      __pyx_v_nobs += 1.0;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":217
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":234
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -7595,7 +7803,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
  */
       __pyx_v_sum_x += __pyx_v_val;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":218
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":235
  *             nobs += 1
  *             sum_x += val
  *             sum_xx += val * val             # <<<<<<<<<<<<<<
@@ -7607,7 +7815,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     }
     __pyx_L9:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":220
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":237
  *             sum_xx += val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -7622,12 +7830,12 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":222
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":239
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -7637,7 +7845,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":223
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":240
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -7652,11 +7860,11 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":225
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":242
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -7666,7 +7874,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":226
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":243
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -7681,11 +7889,11 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":227
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":244
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -7695,7 +7903,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":228
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":245
  *             prev = input[i - win]
  *             if prev == prev:
  *                 sum_x -= prev             # <<<<<<<<<<<<<<
@@ -7704,7 +7912,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
  */
         __pyx_v_sum_x -= __pyx_v_prev;
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":229
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":246
  *             if prev == prev:
  *                 sum_x -= prev
  *                 sum_xx -= prev * prev             # <<<<<<<<<<<<<<
@@ -7713,14 +7921,14 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
  */
         __pyx_v_sum_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":230
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":247
  *                 sum_x -= prev
  *                 sum_xx -= prev * prev
  *                 nobs -= 1             # <<<<<<<<<<<<<<
  * 
  *         if val == val:
  */
-        __pyx_v_nobs -= 1;
+        __pyx_v_nobs -= 1.0;
         goto __pyx_L13;
       }
       __pyx_L13:;
@@ -7728,7 +7936,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     }
     __pyx_L12:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":232
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":249
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -7738,16 +7946,16 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":233
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":250
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
  *             sum_x += val
  *             sum_xx += val * val
  */
-      __pyx_v_nobs += 1;
+      __pyx_v_nobs += 1.0;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":234
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":251
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -7756,7 +7964,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
  */
       __pyx_v_sum_x += __pyx_v_val;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":235
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":252
  *             nobs += 1
  *             sum_x += val
  *             sum_xx += val * val             # <<<<<<<<<<<<<<
@@ -7768,7 +7976,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     }
     __pyx_L14:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":237
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":254
  *             sum_xx += val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -7778,7 +7986,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
     __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":238
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":255
  * 
  *         if nobs >= minp:
  *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)             # <<<<<<<<<<<<<<
@@ -7789,7 +7997,7 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
       __pyx_t_16 = ((__pyx_v_nobs * __pyx_v_nobs) - __pyx_v_nobs);
       if (unlikely(__pyx_t_16 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_t_14 = __pyx_v_i;
       __pyx_t_17 = -1;
@@ -7799,14 +8007,14 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
       } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
       if (unlikely(__pyx_t_17 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_17);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = (__pyx_t_15 / __pyx_t_16);
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":240
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":257
  *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -7821,14 +8029,14 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
       } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_output)) __pyx_t_18 = 0;
       if (unlikely(__pyx_t_18 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_18);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_17, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
     __pyx_L15:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":242
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":259
  *             output[i] = NaN
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -7860,13 +8068,12 @@ static PyObject *__pyx_pf_7tseries_roll_var(PyObject *__pyx_self, PyObject *__py
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":247
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":264
  * # Rolling skewness
  * 
  * def roll_skew(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
@@ -7939,58 +8146,58 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_skew", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_skew", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_skew", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_skew", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_skew") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_skew") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("roll_skew", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("roll_skew", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.roll_skew");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":250
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":267
  *                int win, int minp):
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0             # <<<<<<<<<<<<<<
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)
  */
-  __pyx_v_x = 0;
-  __pyx_v_xx = 0;
-  __pyx_v_xxx = 0;
+  __pyx_v_x = 0.0;
+  __pyx_v_xx = 0.0;
+  __pyx_v_xxx = 0.0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":251
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":268
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -7999,50 +8206,50 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":252
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":269
  *     cdef double x = 0, xx = 0, xxx = 0
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":254
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":271
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     # 3 components of the skewness equation
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -8051,7 +8258,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":259
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":276
  *     cdef double A, B, C, R
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -8061,7 +8268,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":260
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":277
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -8073,7 +8280,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":262
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":279
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -8083,7 +8290,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":263
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":280
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -8098,11 +8305,11 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":266
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":283
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -8112,7 +8319,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":267
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":284
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -8121,7 +8328,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":268
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":285
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -8130,7 +8337,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":269
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":286
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -8139,7 +8346,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":270
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":287
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -8151,7 +8358,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L9:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":272
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":289
  *             xxx += val * val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -8166,12 +8373,12 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":274
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":291
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -8181,7 +8388,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":275
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":292
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -8196,11 +8403,11 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":277
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":294
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -8210,7 +8417,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":278
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":295
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -8225,11 +8432,11 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":279
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":296
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -8239,7 +8446,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":280
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":297
  *             prev = input[i - win]
  *             if prev == prev:
  *                 x -= prev             # <<<<<<<<<<<<<<
@@ -8248,7 +8455,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_x -= __pyx_v_prev;
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":281
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":298
  *             if prev == prev:
  *                 x -= prev
  *                 xx -= prev * prev             # <<<<<<<<<<<<<<
@@ -8257,7 +8464,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":282
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":299
  *                 x -= prev
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev             # <<<<<<<<<<<<<<
@@ -8266,7 +8473,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_xxx -= ((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":284
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":301
  *                 xxx -= prev * prev * prev
  * 
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -8281,7 +8488,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L12:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":286
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":303
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -8291,7 +8498,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":287
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":304
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -8300,7 +8507,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":288
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":305
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -8309,7 +8516,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":289
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":306
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -8318,7 +8525,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":290
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":307
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -8330,7 +8537,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L14:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":292
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":309
  *             xxx += val * val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -8340,7 +8547,7 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":293
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":310
  * 
  *         if nobs >= minp:
  *             A = x / nobs             # <<<<<<<<<<<<<<
@@ -8349,11 +8556,11 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_A = (__pyx_v_x / __pyx_v_nobs);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":294
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":311
  *         if nobs >= minp:
  *             A = x / nobs
  *             B = xx / nobs - A * A             # <<<<<<<<<<<<<<
@@ -8362,11 +8569,11 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - (__pyx_v_A * __pyx_v_A));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":295
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":312
  *             A = x / nobs
  *             B = xx / nobs - A * A
  *             C = xxx / nobs - A * A * A - 3 * A * B             # <<<<<<<<<<<<<<
@@ -8375,11 +8582,11 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - ((__pyx_v_A * __pyx_v_A) * __pyx_v_A)) - ((3 * __pyx_v_A) * __pyx_v_B));
+      __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - ((__pyx_v_A * __pyx_v_A) * __pyx_v_A)) - ((3.0 * __pyx_v_A) * __pyx_v_B));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":297
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":314
  *             C = xxx / nobs - A * A * A - 3 * A * B
  * 
  *             R = sqrt(B)             # <<<<<<<<<<<<<<
@@ -8388,16 +8595,16 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_R = sqrt(__pyx_v_B);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":299
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":316
  *             R = sqrt(B)
  * 
  *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
  *                          ((nobs-2) * R * R * R))
  *         else:
  */
-      __pyx_t_15 = (sqrt((__pyx_v_nobs * (__pyx_v_nobs - 1.0))) * __pyx_v_C);
+      __pyx_t_15 = (sqrt((__pyx_v_nobs * (__pyx_v_nobs - 1.))) * __pyx_v_C);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":300
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":317
  * 
  *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /
  *                          ((nobs-2) * R * R * R))             # <<<<<<<<<<<<<<
@@ -8407,10 +8614,10 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
       __pyx_t_16 = ((((__pyx_v_nobs - 2) * __pyx_v_R) * __pyx_v_R) * __pyx_v_R);
       if (unlikely(__pyx_t_16 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":299
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":316
  *             R = sqrt(B)
  * 
  *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
@@ -8425,14 +8632,14 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
       if (unlikely(__pyx_t_17 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_17);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = (__pyx_t_15 / __pyx_t_16);
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":302
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":319
  *                          ((nobs-2) * R * R * R))
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -8447,14 +8654,14 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_output)) __pyx_t_18 = 0;
       if (unlikely(__pyx_t_18 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_18);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_17, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
     __pyx_L15:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":304
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":321
  *             output[i] = NaN
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -8486,13 +8693,12 @@ static PyObject *__pyx_pf_7tseries_roll_skew(PyObject *__pyx_self, PyObject *__p
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":310
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":327
  * 
  * 
  * def roll_kurt(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
@@ -8568,59 +8774,59 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_kurt", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_kurt", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_kurt", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_kurt", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_kurt") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_kurt") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("roll_kurt", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("roll_kurt", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.roll_kurt");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":313
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":330
  *                int win, int minp):
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0             # <<<<<<<<<<<<<<
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)
  */
-  __pyx_v_x = 0;
-  __pyx_v_xx = 0;
-  __pyx_v_xxx = 0;
-  __pyx_v_xxxx = 0;
+  __pyx_v_x = 0.0;
+  __pyx_v_xx = 0.0;
+  __pyx_v_xxx = 0.0;
+  __pyx_v_xxxx = 0.0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":314
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":331
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -8629,50 +8835,50 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":315
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":332
  *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":317
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":334
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     # 5 components of the kurtosis equation
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -8681,7 +8887,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":322
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":339
  *     cdef double A, B, C, D, R, K
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -8691,7 +8897,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":323
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":340
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -8703,7 +8909,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":325
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":342
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -8713,7 +8919,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":326
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":343
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -8728,11 +8934,11 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":329
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":346
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -8742,7 +8948,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":330
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":347
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -8751,7 +8957,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":333
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":350
  * 
  *             # seriously don't ask me why this is faster
  *             x += val             # <<<<<<<<<<<<<<
@@ -8760,7 +8966,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":334
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":351
  *             # seriously don't ask me why this is faster
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -8769,7 +8975,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":335
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":352
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -8778,7 +8984,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":336
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":353
  *             xx += val * val
  *             xxx += val * val * val
  *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
@@ -8790,7 +8996,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L9:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":338
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":355
  *             xxxx += val * val * val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -8805,12 +9011,12 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":340
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":357
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -8820,7 +9026,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":341
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":358
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -8835,11 +9041,11 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":343
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":360
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -8849,7 +9055,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":344
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":361
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -8864,11 +9070,11 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":345
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":362
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -8878,7 +9084,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":346
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":363
  *             prev = input[i - win]
  *             if prev == prev:
  *                 x -= prev             # <<<<<<<<<<<<<<
@@ -8887,7 +9093,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_x -= __pyx_v_prev;
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":347
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":364
  *             if prev == prev:
  *                 x -= prev
  *                 xx -= prev * prev             # <<<<<<<<<<<<<<
@@ -8896,7 +9102,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":348
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":365
  *                 x -= prev
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev             # <<<<<<<<<<<<<<
@@ -8905,7 +9111,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_xxx -= ((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":349
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":366
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev
  *                 xxxx -= prev * prev * prev * prev             # <<<<<<<<<<<<<<
@@ -8914,7 +9120,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_xxxx -= (((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":351
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":368
  *                 xxxx -= prev * prev * prev * prev
  * 
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -8929,7 +9135,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L12:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":353
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":370
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -8939,7 +9145,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":354
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":371
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -8948,7 +9154,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":355
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":372
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -8957,7 +9163,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":356
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":373
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -8966,7 +9172,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":357
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":374
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -8975,7 +9181,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":358
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":375
  *             xx += val * val
  *             xxx += val * val * val
  *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
@@ -8987,7 +9193,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L14:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":360
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":377
  *             xxxx += val * val * val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -8997,7 +9203,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":361
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":378
  * 
  *         if nobs >= minp:
  *             A = x / nobs             # <<<<<<<<<<<<<<
@@ -9006,11 +9212,11 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_A = (__pyx_v_x / __pyx_v_nobs);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":362
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":379
  *         if nobs >= minp:
  *             A = x / nobs
  *             R = A * A             # <<<<<<<<<<<<<<
@@ -9019,7 +9225,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_R = (__pyx_v_A * __pyx_v_A);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":363
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":380
  *             A = x / nobs
  *             R = A * A
  *             B = xx / nobs - R             # <<<<<<<<<<<<<<
@@ -9028,11 +9234,11 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - __pyx_v_R);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":364
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":381
  *             R = A * A
  *             B = xx / nobs - R
  *             R = R * A             # <<<<<<<<<<<<<<
@@ -9041,7 +9247,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_R = (__pyx_v_R * __pyx_v_A);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":365
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":382
  *             B = xx / nobs - R
  *             R = R * A
  *             C = xxx / nobs - R - 3 * A * B             # <<<<<<<<<<<<<<
@@ -9050,11 +9256,11 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - __pyx_v_R) - ((3 * __pyx_v_A) * __pyx_v_B));
+      __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - __pyx_v_R) - ((3.0 * __pyx_v_A) * __pyx_v_B));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":366
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":383
  *             R = R * A
  *             C = xxx / nobs - R - 3 * A * B
  *             R = R * A             # <<<<<<<<<<<<<<
@@ -9063,7 +9269,7 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_R = (__pyx_v_R * __pyx_v_A);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":367
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":384
  *             C = xxx / nobs - R - 3 * A * B
  *             R = R * A
  *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A             # <<<<<<<<<<<<<<
@@ -9072,40 +9278,40 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      __pyx_v_D = ((((__pyx_v_xxxx / __pyx_v_nobs) - __pyx_v_R) - (((6 * __pyx_v_B) * __pyx_v_A) * __pyx_v_A)) - ((4 * __pyx_v_C) * __pyx_v_A));
+      __pyx_v_D = ((((__pyx_v_xxxx / __pyx_v_nobs) - __pyx_v_R) - (((6.0 * __pyx_v_B) * __pyx_v_A) * __pyx_v_A)) - ((4.0 * __pyx_v_C) * __pyx_v_A));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":369
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":386
  *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A
  * 
  *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)             # <<<<<<<<<<<<<<
  *             K = K / ((nobs - 2.)*(nobs-3.))
  * 
  */
-      __pyx_t_15 = (((__pyx_v_nobs * __pyx_v_nobs) - 1.0) * __pyx_v_D);
+      __pyx_t_15 = (((__pyx_v_nobs * __pyx_v_nobs) - 1.) * __pyx_v_D);
       __pyx_t_16 = (__pyx_v_B * __pyx_v_B);
       if (unlikely(__pyx_t_16 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      __pyx_v_K = ((__pyx_t_15 / __pyx_t_16) - (3 * pow((__pyx_v_nobs - 1.0), 2)));
+      __pyx_v_K = ((__pyx_t_15 / __pyx_t_16) - (3.0 * pow((__pyx_v_nobs - 1.), 2.0)));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":370
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":387
  * 
  *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)
  *             K = K / ((nobs - 2.)*(nobs-3.))             # <<<<<<<<<<<<<<
  * 
  *             output[i] = K
  */
-      __pyx_t_16 = ((__pyx_v_nobs - 2.0) * (__pyx_v_nobs - 3.0));
+      __pyx_t_16 = ((__pyx_v_nobs - 2.) * (__pyx_v_nobs - 3.));
       if (unlikely(__pyx_t_16 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_K = (__pyx_v_K / __pyx_t_16);
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":372
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":389
  *             K = K / ((nobs - 2.)*(nobs-3.))
  * 
  *             output[i] = K             # <<<<<<<<<<<<<<
@@ -9120,14 +9326,14 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
       if (unlikely(__pyx_t_17 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_17);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_v_K;
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":374
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":391
  *             output[i] = K
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -9142,14 +9348,14 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_output)) __pyx_t_18 = 0;
       if (unlikely(__pyx_t_18 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_18);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_17, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
     __pyx_L15:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":376
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":393
  *             output[i] = NaN
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -9181,14 +9387,13 @@ static PyObject *__pyx_pf_7tseries_roll_kurt(PyObject *__pyx_self, PyObject *__p
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":383
- * ctypedef double_t (* skiplist_f)(IndexableSkiplist sl, int n, int p)
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":400
+ * ctypedef double_t (* skiplist_f)(object sl, int n, int p)
  * 
  * cdef _roll_skiplist_op(ndarray arg, int win, int minp, skiplist_f op):             # <<<<<<<<<<<<<<
  *     cdef ndarray[double_t, ndim=1] input = arg
@@ -9227,12 +9432,11 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
   int __pyx_t_14;
   int __pyx_t_15;
   __Pyx_RefNannySetupContext("_roll_skiplist_op");
-  __Pyx_INCREF((PyObject *)__pyx_v_arg);
   __pyx_v_skiplist = ((struct __pyx_obj_7tseries_IndexableSkiplist *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_input.buf = NULL;
   __pyx_bstruct_output.buf = NULL;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":384
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":401
  * 
  * cdef _roll_skiplist_op(ndarray arg, int win, int minp, skiplist_f op):
  *     cdef ndarray[double_t, ndim=1] input = arg             # <<<<<<<<<<<<<<
@@ -9243,7 +9447,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)((PyArrayObject *)__pyx_v_arg), &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_input = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_input.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
       __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
     }
@@ -9251,7 +9455,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
   __Pyx_INCREF(((PyObject *)__pyx_v_arg));
   __pyx_v_input = ((PyArrayObject *)__pyx_v_arg);
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":387
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":404
  *     cdef double val, prev, midpoint
  *     cdef IndexableSkiplist skiplist
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -9260,50 +9464,50 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":389
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":406
  *     cdef int nobs = 0, i
  * 
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  * 
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 406; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":390
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":407
  * 
  *     cdef int N = len(input)
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     skiplist = IndexableSkiplist(win)
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -9312,28 +9516,28 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":392
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":409
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  * 
  *     skiplist = IndexableSkiplist(win)             # <<<<<<<<<<<<<<
  * 
  *     if minp > N:
  */
-  __pyx_t_5 = PyInt_FromLong(__pyx_v_win); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyInt_FromLong(__pyx_v_win); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_IndexableSkiplist)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_IndexableSkiplist)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_v_skiplist));
   __pyx_v_skiplist = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":394
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":411
  *     skiplist = IndexableSkiplist(win)
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -9343,7 +9547,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":395
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":412
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -9355,7 +9559,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
   }
   __pyx_L3:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":397
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":414
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -9365,7 +9569,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":398
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":415
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9380,11 +9584,11 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":401
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":418
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -9394,7 +9598,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":402
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":419
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -9403,32 +9607,21 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":403
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":420
  *         if val == val:
  *             nobs += 1
  *             skiplist.insert(val)             # <<<<<<<<<<<<<<
  * 
  *         output[i] = NaN
  */
-      __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__insert); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)__pyx_v_skiplist->__pyx_vtab)->insert(__pyx_v_skiplist, __pyx_v_val, 0); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_2 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-      __Pyx_GIVEREF(__pyx_t_2);
-      __pyx_t_2 = 0;
-      __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       goto __pyx_L6;
     }
     __pyx_L6:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":405
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":422
  *             skiplist.insert(val)
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -9443,12 +9636,12 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":407
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":424
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -9458,7 +9651,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":408
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":425
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9473,11 +9666,11 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":410
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":427
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -9487,7 +9680,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":411
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":428
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -9502,11 +9695,11 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":413
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":430
  *             prev = input[i - win]
  * 
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -9516,29 +9709,18 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":414
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":431
  * 
  *             if prev == prev:
  *                 skiplist.remove(prev)             # <<<<<<<<<<<<<<
  *                 nobs -= 1
  * 
  */
-        __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__remove); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_4 = PyFloat_FromDouble(__pyx_v_prev); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)__pyx_v_skiplist->__pyx_vtab)->remove(__pyx_v_skiplist, __pyx_v_prev, 0); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
-        __Pyx_GIVEREF(__pyx_t_4);
-        __pyx_t_4 = 0;
-        __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_4);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":415
+        /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":432
  *             if prev == prev:
  *                 skiplist.remove(prev)
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -9553,7 +9735,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
     }
     __pyx_L9:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":417
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":434
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -9563,7 +9745,7 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":418
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":435
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -9572,32 +9754,21 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":419
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":436
  *         if val == val:
  *             nobs += 1
  *             skiplist.insert(val)             # <<<<<<<<<<<<<<
  * 
  *         output[i] = op(skiplist, nobs, minp)
  */
-      __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__insert); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)__pyx_v_skiplist->__pyx_vtab)->insert(__pyx_v_skiplist, __pyx_v_val, 0); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
-      __Pyx_GIVEREF(__pyx_t_5);
-      __pyx_t_5 = 0;
-      __pyx_t_5 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       goto __pyx_L11;
     }
     __pyx_L11:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":421
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":438
  *             skiplist.insert(val)
  * 
  *         output[i] = op(skiplist, nobs, minp)             # <<<<<<<<<<<<<<
@@ -9612,12 +9783,12 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
     } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
     if (unlikely(__pyx_t_15 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_15);
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_v_op(__pyx_v_skiplist, __pyx_v_nobs, __pyx_v_minp);
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_v_op(((PyObject *)__pyx_v_skiplist), __pyx_v_nobs, __pyx_v_minp);
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":423
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":440
  *         output[i] = op(skiplist, nobs, minp)
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -9651,21 +9822,21 @@ static  PyObject *__pyx_f_7tseries__roll_skiplist_op(PyArrayObject *__pyx_v_arg,
   __Pyx_XDECREF((PyObject *)__pyx_v_input);
   __Pyx_DECREF((PyObject *)__pyx_v_skiplist);
   __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_arg);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":425
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":442
  *     return output
  * 
  * def roll_median(ndarray input, int win, int minp):             # <<<<<<<<<<<<<<
- *     return _roll_skiplist_op(input, win, minp, _get_median)
- * 
+ *     '''
+ *     O(N log(window)) implementation using skip list
  */
 
 static PyObject *__pyx_pf_7tseries_roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7tseries_roll_median[] = "\n    O(N log(window)) implementation using skip list\n    ";
 static PyObject *__pyx_pf_7tseries_roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   int __pyx_v_win;
@@ -9694,46 +9865,47 @@ static PyObject *__pyx_pf_7tseries_roll_median(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_median") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_median") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.roll_median");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":426
- * 
- * def roll_median(ndarray input, int win, int minp):
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":446
+ *     O(N log(window)) implementation using skip list
+ *     '''
  *     return _roll_skiplist_op(input, win, minp, _get_median)             # <<<<<<<<<<<<<<
  * 
  * def roll_max(ndarray input, int win, int minp):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7tseries__roll_skiplist_op(__pyx_v_input, __pyx_v_win, __pyx_v_minp, __pyx_f_7tseries__get_median); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __pyx_f_7tseries__roll_skiplist_op(__pyx_v_input, __pyx_v_win, __pyx_v_minp, __pyx_f_7tseries__get_median); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -9751,15 +9923,16 @@ static PyObject *__pyx_pf_7tseries_roll_median(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":428
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":448
  *     return _roll_skiplist_op(input, win, minp, _get_median)
  * 
  * def roll_max(ndarray input, int win, int minp):             # <<<<<<<<<<<<<<
- *     return _roll_skiplist_op(input, win, minp, _get_max)
- * 
+ *     '''
+ *     O(N log(window)) implementation using skip list
  */
 
 static PyObject *__pyx_pf_7tseries_roll_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7tseries_roll_max[] = "\n    O(N log(window)) implementation using skip list\n    ";
 static PyObject *__pyx_pf_7tseries_roll_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   int __pyx_v_win;
@@ -9788,46 +9961,47 @@ static PyObject *__pyx_pf_7tseries_roll_max(PyObject *__pyx_self, PyObject *__py
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_max", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_max", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_max", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_max", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_max") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_max") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("roll_max", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("roll_max", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.roll_max");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":429
- * 
- * def roll_max(ndarray input, int win, int minp):
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":452
+ *     O(N log(window)) implementation using skip list
+ *     '''
  *     return _roll_skiplist_op(input, win, minp, _get_max)             # <<<<<<<<<<<<<<
  * 
  * def roll_min(ndarray input, int win, int minp):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7tseries__roll_skiplist_op(__pyx_v_input, __pyx_v_win, __pyx_v_minp, __pyx_f_7tseries__get_max); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __pyx_f_7tseries__roll_skiplist_op(__pyx_v_input, __pyx_v_win, __pyx_v_minp, __pyx_f_7tseries__get_max); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -9845,15 +10019,16 @@ static PyObject *__pyx_pf_7tseries_roll_max(PyObject *__pyx_self, PyObject *__py
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":431
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":454
  *     return _roll_skiplist_op(input, win, minp, _get_max)
  * 
  * def roll_min(ndarray input, int win, int minp):             # <<<<<<<<<<<<<<
- *     return _roll_skiplist_op(input, win, minp, _get_min)
- * 
+ *     '''
+ *     O(N log(window)) implementation using skip list
  */
 
 static PyObject *__pyx_pf_7tseries_roll_min(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7tseries_roll_min[] = "\n    O(N log(window)) implementation using skip list\n    ";
 static PyObject *__pyx_pf_7tseries_roll_min(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   int __pyx_v_win;
@@ -9882,46 +10057,47 @@ static PyObject *__pyx_pf_7tseries_roll_min(PyObject *__pyx_self, PyObject *__py
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_min", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_min", 1, 3, 3, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_min", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("roll_min", 1, 3, 3, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_min") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_min") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("roll_min", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("roll_min", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.roll_min");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":432
- * 
- * def roll_min(ndarray input, int win, int minp):
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":458
+ *     O(N log(window)) implementation using skip list
+ *     '''
  *     return _roll_skiplist_op(input, win, minp, _get_min)             # <<<<<<<<<<<<<<
  * 
- * cdef double_t _get_median(IndexableSkiplist skiplist, int nobs,
+ * # Unfortunately had to resort to some hackery here, would like for
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7tseries__roll_skiplist_op(__pyx_v_input, __pyx_v_win, __pyx_v_minp, __pyx_f_7tseries__get_min); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __pyx_f_7tseries__roll_skiplist_op(__pyx_v_input, __pyx_v_win, __pyx_v_minp, __pyx_f_7tseries__get_min); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -9939,30 +10115,39 @@ static PyObject *__pyx_pf_7tseries_roll_min(PyObject *__pyx_self, PyObject *__py
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":434
- *     return _roll_skiplist_op(input, win, minp, _get_min)
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":463
+ * # Cython to be able to get this right.
  * 
- * cdef double_t _get_median(IndexableSkiplist skiplist, int nobs,             # <<<<<<<<<<<<<<
- *                           int minp):
+ * cdef double_t _get_median(object sl, int nobs, int minp):             # <<<<<<<<<<<<<<
  *     cdef int midpoint
+ *     cdef IndexableSkiplist skiplist = <IndexableSkiplist> sl
  */
 
-static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_median(struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_skiplist, int __pyx_v_nobs, int __pyx_v_minp) {
+static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_median(PyObject *__pyx_v_sl, int __pyx_v_nobs, int __pyx_v_minp) {
   int __pyx_v_midpoint;
+  struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_skiplist = 0;
   __pyx_t_5numpy_double_t __pyx_r;
   int __pyx_t_1;
   long __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
+  __pyx_t_5numpy_double_t __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
-  __pyx_t_5numpy_double_t __pyx_t_6;
-  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_6 = NULL;
   __Pyx_RefNannySetupContext("_get_median");
-  __Pyx_INCREF((PyObject *)__pyx_v_skiplist);
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":437
- *                           int minp):
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":465
+ * cdef double_t _get_median(object sl, int nobs, int minp):
+ *     cdef int midpoint
+ *     cdef IndexableSkiplist skiplist = <IndexableSkiplist> sl             # <<<<<<<<<<<<<<
+ *     if nobs >= minp:
+ *         midpoint = nobs / 2
+ */
+  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_sl)));
+  __pyx_v_skiplist = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_sl);
+
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":466
  *     cdef int midpoint
+ *     cdef IndexableSkiplist skiplist = <IndexableSkiplist> sl
  *     if nobs >= minp:             # <<<<<<<<<<<<<<
  *         midpoint = nobs / 2
  *         if nobs % 2:
@@ -9970,8 +10155,8 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_median(struct __pyx_obj_7t
   __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
   if (__pyx_t_1) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":438
- *     cdef int midpoint
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":467
+ *     cdef IndexableSkiplist skiplist = <IndexableSkiplist> sl
  *     if nobs >= minp:
  *         midpoint = nobs / 2             # <<<<<<<<<<<<<<
  *         if nobs % 2:
@@ -9979,7 +10164,7 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_median(struct __pyx_obj_7t
  */
     __pyx_v_midpoint = __Pyx_div_long(__pyx_v_nobs, 2);
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":439
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":468
  *     if nobs >= minp:
  *         midpoint = nobs / 2
  *         if nobs % 2:             # <<<<<<<<<<<<<<
@@ -9989,85 +10174,52 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_median(struct __pyx_obj_7t
     __pyx_t_2 = __Pyx_mod_long(__pyx_v_nobs, 2);
     if (__pyx_t_2) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":440
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":469
  *         midpoint = nobs / 2
  *         if nobs % 2:
  *             return skiplist.get(midpoint)             # <<<<<<<<<<<<<<
  *         else:
  *             return (skiplist.get(midpoint) +
  */
-      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)__pyx_v_skiplist->__pyx_vtab)->get(__pyx_v_skiplist, __pyx_v_midpoint, 0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = PyInt_FromLong(__pyx_v_midpoint); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
-      __Pyx_GIVEREF(__pyx_t_4);
-      __pyx_t_4 = 0;
-      __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_6 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_r = __pyx_t_6;
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_r = __pyx_t_4;
       goto __pyx_L0;
       goto __pyx_L4;
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":442
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":471
  *             return skiplist.get(midpoint)
  *         else:
  *             return (skiplist.get(midpoint) +             # <<<<<<<<<<<<<<
  *                     skiplist.get(midpoint - 1)) / 2
  *     else:
  */
-      __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = PyInt_FromLong(__pyx_v_midpoint); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)__pyx_v_skiplist->__pyx_vtab)->get(__pyx_v_skiplist, __pyx_v_midpoint, 0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
-      __Pyx_GIVEREF(__pyx_t_5);
-      __pyx_t_5 = 0;
-      __pyx_t_5 = PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":443
+      /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":472
  *         else:
  *             return (skiplist.get(midpoint) +
  *                     skiplist.get(midpoint - 1)) / 2             # <<<<<<<<<<<<<<
  *     else:
  *         return NaN
  */
-      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = PyInt_FromLong((__pyx_v_midpoint - 1)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_7);
-      PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
-      __Pyx_GIVEREF(__pyx_t_4);
-      __pyx_t_4 = 0;
-      __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_5 = ((struct __pyx_vtabstruct_7tseries_IndexableSkiplist *)__pyx_v_skiplist->__pyx_vtab)->get(__pyx_v_skiplist, (__pyx_v_midpoint - 1), 0); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_6 = PyNumber_Add(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyNumber_Add(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_7, __pyx_int_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_6 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_r = __pyx_t_6;
+      __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_6, __pyx_int_2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_4 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_r = __pyx_t_4;
       goto __pyx_L0;
     }
     __pyx_L4:;
@@ -10075,12 +10227,12 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_median(struct __pyx_obj_7t
   }
   /*else*/ {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":445
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":474
  *                     skiplist.get(midpoint - 1)) / 2
  *     else:
  *         return NaN             # <<<<<<<<<<<<<<
  * 
- * cdef double_t _get_max(IndexableSkiplist skiplist, int nobs,
+ * cdef double_t _get_max(object skiplist, int nobs,
  */
     __pyx_r = __pyx_v_7tseries_NaN;
     goto __pyx_L0;
@@ -10091,26 +10243,25 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_median(struct __pyx_obj_7t
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_WriteUnraisable("tseries._get_median");
   __pyx_r = 0;
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_skiplist);
+  __Pyx_XDECREF((PyObject *)__pyx_v_skiplist);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":447
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":476
  *         return NaN
  * 
- * cdef double_t _get_max(IndexableSkiplist skiplist, int nobs,             # <<<<<<<<<<<<<<
+ * cdef double_t _get_max(object skiplist, int nobs,             # <<<<<<<<<<<<<<
  *                        int minp):
  *     if nobs >= minp:
  */
 
-static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_max(struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_skiplist, int __pyx_v_nobs, int __pyx_v_minp) {
+static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_max(PyObject *__pyx_v_skiplist, int __pyx_v_nobs, int __pyx_v_minp) {
   __pyx_t_5numpy_double_t __pyx_r;
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -10118,39 +10269,38 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_max(struct __pyx_obj_7tser
   PyObject *__pyx_t_4 = NULL;
   __pyx_t_5numpy_double_t __pyx_t_5;
   __Pyx_RefNannySetupContext("_get_max");
-  __Pyx_INCREF((PyObject *)__pyx_v_skiplist);
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":449
- * cdef double_t _get_max(IndexableSkiplist skiplist, int nobs,
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":478
+ * cdef double_t _get_max(object skiplist, int nobs,
  *                        int minp):
  *     if nobs >= minp:             # <<<<<<<<<<<<<<
- *         return skiplist.get(nobs - 1)
+ *         return <IndexableSkiplist> skiplist.get(nobs - 1)
  *     else:
  */
   __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
   if (__pyx_t_1) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":450
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":479
  *                        int minp):
  *     if nobs >= minp:
- *         return skiplist.get(nobs - 1)             # <<<<<<<<<<<<<<
+ *         return <IndexableSkiplist> skiplist.get(nobs - 1)             # <<<<<<<<<<<<<<
  *     else:
  *         return NaN
  */
-    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(__pyx_v_skiplist, __pyx_n_s__get); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyInt_FromLong((__pyx_v_nobs - 1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyInt_FromLong((__pyx_v_nobs - 1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_3 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_r = __pyx_t_5;
     goto __pyx_L0;
@@ -10158,12 +10308,12 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_max(struct __pyx_obj_7tser
   }
   /*else*/ {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":452
- *         return skiplist.get(nobs - 1)
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":481
+ *         return <IndexableSkiplist> skiplist.get(nobs - 1)
  *     else:
  *         return NaN             # <<<<<<<<<<<<<<
  * 
- * cdef double_t _get_min(IndexableSkiplist skiplist, int nobs,
+ * cdef double_t _get_min(object skiplist, int nobs,
  */
     __pyx_r = __pyx_v_7tseries_NaN;
     goto __pyx_L0;
@@ -10179,20 +10329,19 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_max(struct __pyx_obj_7tser
   __Pyx_WriteUnraisable("tseries._get_max");
   __pyx_r = 0;
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_skiplist);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":454
+/* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":483
  *         return NaN
  * 
- * cdef double_t _get_min(IndexableSkiplist skiplist, int nobs,             # <<<<<<<<<<<<<<
+ * cdef double_t _get_min(object skiplist, int nobs,             # <<<<<<<<<<<<<<
  *                        int minp):
  *     if nobs >= minp:
  */
 
-static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_min(struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_skiplist, int __pyx_v_nobs, int __pyx_v_minp) {
+static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_min(PyObject *__pyx_v_skiplist, int __pyx_v_nobs, int __pyx_v_minp) {
   __pyx_t_5numpy_double_t __pyx_r;
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -10200,37 +10349,36 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_min(struct __pyx_obj_7tser
   PyObject *__pyx_t_4 = NULL;
   __pyx_t_5numpy_double_t __pyx_t_5;
   __Pyx_RefNannySetupContext("_get_min");
-  __Pyx_INCREF((PyObject *)__pyx_v_skiplist);
 
-  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":456
- * cdef double_t _get_min(IndexableSkiplist skiplist, int nobs,
+  /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":485
+ * cdef double_t _get_min(object skiplist, int nobs,
  *                        int minp):
  *     if nobs >= minp:             # <<<<<<<<<<<<<<
- *         return skiplist.get(0)
+ *         return <IndexableSkiplist> skiplist.get(0)
  *     else:
  */
   __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
   if (__pyx_t_1) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":457
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":486
  *                        int minp):
  *     if nobs >= minp:
- *         return skiplist.get(0)             # <<<<<<<<<<<<<<
+ *         return <IndexableSkiplist> skiplist.get(0)             # <<<<<<<<<<<<<<
  *     else:
  *         return NaN
  */
-    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(__pyx_v_skiplist, __pyx_n_s__get); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
-    __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_5 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_5 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_r = __pyx_t_5;
     goto __pyx_L0;
@@ -10238,8 +10386,8 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_min(struct __pyx_obj_7tser
   }
   /*else*/ {
 
-    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":459
- *         return skiplist.get(0)
+    /* "/home/wesm/code/pandas/pandas/lib/src/moments.pyx":488
+ *         return <IndexableSkiplist> skiplist.get(0)
  *     else:
  *         return NaN             # <<<<<<<<<<<<<<
  */
@@ -10257,12 +10405,11 @@ static  __pyx_t_5numpy_double_t __pyx_f_7tseries__get_min(struct __pyx_obj_7tser
   __Pyx_WriteUnraisable("tseries._get_min");
   __pyx_r = 0;
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_skiplist);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":1
+/* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":1
  * def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,             # <<<<<<<<<<<<<<
  *                object kind):
  * 
@@ -10350,13 +10497,9 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.getFillVec");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_oldIndex);
-  __Pyx_INCREF((PyObject *)__pyx_v_newIndex);
-  __Pyx_INCREF(__pyx_v_oldMap);
-  __Pyx_INCREF(__pyx_v_newMap);
-  __Pyx_INCREF(__pyx_v_kind);
   __pyx_v_fillVec = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_maskVec = Py_None; __Pyx_INCREF(Py_None);
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldIndex), __pyx_ptype_5numpy_ndarray, 1, "oldIndex", 0))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
@@ -10364,7 +10507,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newMap), &PyDict_Type, 1, "newMap", 1))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":4
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":4
  *                object kind):
  * 
  *     if kind is None:             # <<<<<<<<<<<<<<
@@ -10374,7 +10517,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   __pyx_t_1 = (__pyx_v_kind == Py_None);
   if (__pyx_t_1) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":5
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":5
  * 
  *     if kind is None:
  *         fillVec, maskVec = getMergeVec(newIndex, oldMap)             # <<<<<<<<<<<<<<
@@ -10414,7 +10557,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_2 = __Pyx_UnpackItem(__pyx_t_5, 1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
-      if (__Pyx_EndUnpack(__pyx_t_5) < 0) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      if (__Pyx_EndUnpack(__pyx_t_5, 2) < 0) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
       __pyx_v_fillVec = __pyx_t_3;
@@ -10426,7 +10569,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":6
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":6
  *     if kind is None:
  *         fillVec, maskVec = getMergeVec(newIndex, oldMap)
  *     elif kind == 'PAD':             # <<<<<<<<<<<<<<
@@ -10439,7 +10582,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (__pyx_t_1) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":7
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":7
  *         fillVec, maskVec = getMergeVec(newIndex, oldMap)
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
@@ -10485,7 +10628,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_4 = __Pyx_UnpackItem(__pyx_t_5, 1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
-      if (__Pyx_EndUnpack(__pyx_t_5) < 0) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      if (__Pyx_EndUnpack(__pyx_t_5, 2) < 0) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
       __pyx_v_fillVec = __pyx_t_2;
@@ -10497,7 +10640,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":8
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":8
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':             # <<<<<<<<<<<<<<
@@ -10510,7 +10653,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_1) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":9
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":9
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
@@ -10556,7 +10699,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_3 = __Pyx_UnpackItem(__pyx_t_5, 1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      if (__Pyx_EndUnpack(__pyx_t_5) < 0) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      if (__Pyx_EndUnpack(__pyx_t_5, 2) < 0) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
       __pyx_v_fillVec = __pyx_t_4;
@@ -10569,7 +10712,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   }
   /*else*/ {
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":11
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":11
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  *     else:
  *         raise Exception("Don't recognize fillMethod: %s" % kind)             # <<<<<<<<<<<<<<
@@ -10577,11 +10720,11 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
  *     return fillVec, maskVec.astype(np.bool)
  */
     __pyx_t_2 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_4), __pyx_v_kind); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
     __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-    __Pyx_GIVEREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_t_2));
+    __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
     __pyx_t_2 = 0;
     __pyx_t_2 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
@@ -10592,7 +10735,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":13
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":13
  *         raise Exception("Don't recognize fillMethod: %s" % kind)
  * 
  *     return fillVec, maskVec.astype(np.bool)             # <<<<<<<<<<<<<<
@@ -10640,17 +10783,12 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   __pyx_L0:;
   __Pyx_DECREF(__pyx_v_fillVec);
   __Pyx_DECREF(__pyx_v_maskVec);
-  __Pyx_DECREF((PyObject *)__pyx_v_oldIndex);
-  __Pyx_DECREF((PyObject *)__pyx_v_newIndex);
-  __Pyx_DECREF(__pyx_v_oldMap);
-  __Pyx_DECREF(__pyx_v_newMap);
-  __Pyx_DECREF(__pyx_v_kind);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":16
+/* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":16
  * 
  * @cython.wraparound(False)
  * def _backfill(ndarray[object, ndim=1] oldIndex,             # <<<<<<<<<<<<<<
@@ -10767,12 +10905,9 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   __Pyx_RaiseArgtupleInvalid("_backfill", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries._backfill");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_oldIndex);
-  __Pyx_INCREF((PyObject *)__pyx_v_newIndex);
-  __Pyx_INCREF(__pyx_v_oldMap);
-  __Pyx_INCREF(__pyx_v_newMap);
   __pyx_v_fillVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_prevOld = Py_None; __Pyx_INCREF(Py_None);
@@ -10798,7 +10933,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   __pyx_bstride_0_newIndex = __pyx_bstruct_newIndex.strides[0];
   __pyx_bshape_0_newIndex = __pyx_bstruct_newIndex.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":51
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":51
  * 
  *     # Get the size
  *     oldLength = len(oldIndex)             # <<<<<<<<<<<<<<
@@ -10808,7 +10943,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_oldIndex)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_oldLength = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":52
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":52
  *     # Get the size
  *     oldLength = len(oldIndex)
  *     newLength = len(newIndex)             # <<<<<<<<<<<<<<
@@ -10818,7 +10953,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_newLength = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":54
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":54
  *     newLength = len(newIndex)
  * 
  *     fillVec = np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
@@ -10876,7 +11011,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":55
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":55
  * 
  *     fillVec = np.empty(len(newIndex), dtype = np.int32)
  *     fillVec.fill(-1)             # <<<<<<<<<<<<<<
@@ -10896,7 +11031,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":57
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":57
  *     fillVec.fill(-1)
  * 
  *     mask = np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
@@ -10954,7 +11089,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   __pyx_v_mask = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":60
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":60
  * 
  *     # Current positions
  *     oldPos = oldLength - 1             # <<<<<<<<<<<<<<
@@ -10963,7 +11098,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
  */
   __pyx_v_oldPos = (__pyx_v_oldLength - 1);
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":61
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":61
  *     # Current positions
  *     oldPos = oldLength - 1
  *     newPos = newLength - 1             # <<<<<<<<<<<<<<
@@ -10972,7 +11107,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
  */
   __pyx_v_newPos = (__pyx_v_newLength - 1);
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":64
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":64
  * 
  *     # corner case, no filling possible
  *     if newIndex[0] > oldIndex[oldLength - 1]:             # <<<<<<<<<<<<<<
@@ -11009,7 +11144,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (__pyx_t_15) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":65
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":65
  *     # corner case, no filling possible
  *     if newIndex[0] > oldIndex[oldLength - 1]:
  *         return fillVec, mask             # <<<<<<<<<<<<<<
@@ -11032,7 +11167,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":67
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":67
  *         return fillVec, mask
  * 
  *     while newPos >= 0:             # <<<<<<<<<<<<<<
@@ -11043,7 +11178,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
     __pyx_t_15 = (__pyx_v_newPos >= 0);
     if (!__pyx_t_15) break;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":68
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":68
  * 
  *     while newPos >= 0:
  *         curOld = oldIndex[oldPos]             # <<<<<<<<<<<<<<
@@ -11065,7 +11200,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
     __pyx_v_curOld = __pyx_t_6;
     __pyx_t_6 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":71
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":71
  * 
  *         # Until we reach a point where we are before the curOld point
  *         while newIndex[newPos] > curOld:             # <<<<<<<<<<<<<<
@@ -11091,7 +11226,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       if (!__pyx_t_15) break;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":72
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":72
  *         # Until we reach a point where we are before the curOld point
  *         while newIndex[newPos] > curOld:
  *             newPos -= 1             # <<<<<<<<<<<<<<
@@ -11100,7 +11235,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_newPos -= 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":73
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":73
  *         while newIndex[newPos] > curOld:
  *             newPos -= 1
  *             if newPos < 0:             # <<<<<<<<<<<<<<
@@ -11110,7 +11245,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
       __pyx_t_15 = (__pyx_v_newPos < 0);
       if (__pyx_t_15) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":74
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":74
  *             newPos -= 1
  *             if newPos < 0:
  *                 break             # <<<<<<<<<<<<<<
@@ -11124,20 +11259,20 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L10_break:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":77
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":77
  * 
  *         # Get the location in the old index
  *         curLoc = oldMap[curOld]             # <<<<<<<<<<<<<<
  * 
  *         # At the beginning of the old index
  */
-    __pyx_t_4 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_4) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_PyDict_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_4) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_17 = __Pyx_PyInt_AsInt(__pyx_t_4); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_curLoc = __pyx_t_17;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":80
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":80
  * 
  *         # At the beginning of the old index
  *         if oldPos == 0:             # <<<<<<<<<<<<<<
@@ -11147,7 +11282,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
     __pyx_t_15 = (__pyx_v_oldPos == 0);
     if (__pyx_t_15) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":82
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":82
  *         if oldPos == 0:
  *             # Make sure we are before the curOld index
  *             if newIndex[newPos] <= curOld:             # <<<<<<<<<<<<<<
@@ -11172,7 +11307,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (__pyx_t_15) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":83
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":83
  *             # Make sure we are before the curOld index
  *             if newIndex[newPos] <= curOld:
  *                 fillVec[:newPos + 1] = curLoc             # <<<<<<<<<<<<<<
@@ -11184,7 +11319,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
         if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), 0, (__pyx_v_newPos + 1), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":84
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":84
  *             if newIndex[newPos] <= curOld:
  *                 fillVec[:newPos + 1] = curLoc
  *                 mask[:newPos + 1] = 1             # <<<<<<<<<<<<<<
@@ -11196,7 +11331,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
       }
       __pyx_L13:;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":86
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":86
  *                 mask[:newPos + 1] = 1
  *             # Exit the main loop
  *             break             # <<<<<<<<<<<<<<
@@ -11208,7 +11343,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":89
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":89
  *         else:
  *             # Get the index there
  *             prevOld = oldIndex[oldPos - 1]             # <<<<<<<<<<<<<<
@@ -11230,7 +11365,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
       __pyx_v_prevOld = __pyx_t_6;
       __pyx_t_6 = 0;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":92
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":92
  * 
  *             # Until we reach the previous index
  *             while newIndex[newPos] > prevOld:             # <<<<<<<<<<<<<<
@@ -11256,7 +11391,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         if (!__pyx_t_15) break;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":94
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":94
  *             while newIndex[newPos] > prevOld:
  *                 # Set the current fill location
  *                 fillVec[newPos] = curLoc             # <<<<<<<<<<<<<<
@@ -11274,7 +11409,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_bstruct_fillVec.buf, __pyx_t_20, __pyx_bstride_0_fillVec) = __pyx_v_curLoc;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":95
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":95
  *                 # Set the current fill location
  *                 fillVec[newPos] = curLoc
  *                 mask[newPos] = 1             # <<<<<<<<<<<<<<
@@ -11292,7 +11427,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_21, __pyx_bstride_0_mask) = 1;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":97
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":97
  *                 mask[newPos] = 1
  * 
  *                 newPos -= 1             # <<<<<<<<<<<<<<
@@ -11301,7 +11436,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_newPos -= 1;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":98
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":98
  * 
  *                 newPos -= 1
  *                 if newPos < 0:             # <<<<<<<<<<<<<<
@@ -11311,7 +11446,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
         __pyx_t_15 = (__pyx_v_newPos < 0);
         if (__pyx_t_15) {
 
-          /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":99
+          /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":99
  *                 newPos -= 1
  *                 if newPos < 0:
  *                     break             # <<<<<<<<<<<<<<
@@ -11327,7 +11462,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L12:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":102
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":102
  * 
  *         # Move one period back
  *         oldPos -= 1             # <<<<<<<<<<<<<<
@@ -11338,7 +11473,7 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   }
   __pyx_L8_break:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":104
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":104
  *         oldPos -= 1
  * 
  *     return (fillVec, mask)             # <<<<<<<<<<<<<<
@@ -11386,16 +11521,12 @@ static PyObject *__pyx_pf_7tseries__backfill(PyObject *__pyx_self, PyObject *__p
   __Pyx_DECREF((PyObject *)__pyx_v_mask);
   __Pyx_DECREF(__pyx_v_prevOld);
   __Pyx_DECREF(__pyx_v_curOld);
-  __Pyx_DECREF((PyObject *)__pyx_v_oldIndex);
-  __Pyx_DECREF((PyObject *)__pyx_v_newIndex);
-  __Pyx_DECREF(__pyx_v_oldMap);
-  __Pyx_DECREF(__pyx_v_newMap);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":107
+/* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":107
  * 
  * @cython.wraparound(False)
  * def _pad(ndarray[object, ndim=1] oldIndex,             # <<<<<<<<<<<<<<
@@ -11419,7 +11550,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   int __pyx_v_oldPos;
   PyObject *__pyx_v_curOld;
   PyObject *__pyx_v_nextOld;
-  PyObject *__pyx_v_done;
+  long __pyx_v_done;
   Py_buffer __pyx_bstruct_oldIndex;
   Py_ssize_t __pyx_bstride_0_oldIndex = 0;
   Py_ssize_t __pyx_bshape_0_oldIndex = 0;
@@ -11513,17 +11644,13 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   __Pyx_RaiseArgtupleInvalid("_pad", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries._pad");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_oldIndex);
-  __Pyx_INCREF((PyObject *)__pyx_v_newIndex);
-  __Pyx_INCREF(__pyx_v_oldMap);
-  __Pyx_INCREF(__pyx_v_newMap);
   __pyx_v_fillVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_curOld = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_nextOld = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_done = Py_None; __Pyx_INCREF(Py_None);
   __pyx_bstruct_fillVec.buf = NULL;
   __pyx_bstruct_mask.buf = NULL;
   __pyx_bstruct_oldIndex.buf = NULL;
@@ -11545,7 +11672,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   __pyx_bstride_0_newIndex = __pyx_bstruct_newIndex.strides[0];
   __pyx_bshape_0_newIndex = __pyx_bstruct_newIndex.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":139
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":139
  * 
  *     # Get the size
  *     oldLength = len(oldIndex)             # <<<<<<<<<<<<<<
@@ -11555,7 +11682,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_oldIndex)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_oldLength = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":140
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":140
  *     # Get the size
  *     oldLength = len(oldIndex)
  *     newLength = len(newIndex)             # <<<<<<<<<<<<<<
@@ -11565,7 +11692,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_newLength = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":142
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":142
  *     newLength = len(newIndex)
  * 
  *     fillVec = np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
@@ -11623,7 +11750,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":143
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":143
  * 
  *     fillVec = np.empty(len(newIndex), dtype = np.int32)
  *     fillVec.fill(-1)             # <<<<<<<<<<<<<<
@@ -11643,7 +11770,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":145
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":145
  *     fillVec.fill(-1)
  * 
  *     mask = np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
@@ -11701,7 +11828,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   __pyx_v_mask = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":147
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":147
  *     mask = np.zeros(len(newIndex), dtype = np.int8)
  * 
  *     oldPos = 0             # <<<<<<<<<<<<<<
@@ -11710,7 +11837,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
  */
   __pyx_v_oldPos = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":148
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":148
  * 
  *     oldPos = 0
  *     newPos = 0             # <<<<<<<<<<<<<<
@@ -11719,7 +11846,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
  */
   __pyx_v_newPos = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":151
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":151
  * 
  *     # corner case, no filling possible
  *     if newIndex[newLength - 1] < oldIndex[0]:             # <<<<<<<<<<<<<<
@@ -11756,7 +11883,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (__pyx_t_15) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":152
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":152
  *     # corner case, no filling possible
  *     if newIndex[newLength - 1] < oldIndex[0]:
  *         return fillVec, mask             # <<<<<<<<<<<<<<
@@ -11779,7 +11906,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   }
   __pyx_L6:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":154
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":154
  *         return fillVec, mask
  * 
  *     while newPos < newLength:             # <<<<<<<<<<<<<<
@@ -11790,7 +11917,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
     __pyx_t_15 = (__pyx_v_newPos < __pyx_v_newLength);
     if (!__pyx_t_15) break;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":155
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":155
  * 
  *     while newPos < newLength:
  *         curOld = oldIndex[oldPos]             # <<<<<<<<<<<<<<
@@ -11812,7 +11939,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
     __pyx_v_curOld = __pyx_t_6;
     __pyx_t_6 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":159
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":159
  *         # At beginning, keep going until we go exceed the
  *         # first OLD index in the NEW index
  *         while newIndex[newPos] < curOld:             # <<<<<<<<<<<<<<
@@ -11838,7 +11965,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       if (!__pyx_t_15) break;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":160
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":160
  *         # first OLD index in the NEW index
  *         while newIndex[newPos] < curOld:
  *             newPos += 1             # <<<<<<<<<<<<<<
@@ -11847,7 +11974,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
  */
       __pyx_v_newPos += 1;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":161
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":161
  *         while newIndex[newPos] < curOld:
  *             newPos += 1
  *             if newPos > newLength - 1:             # <<<<<<<<<<<<<<
@@ -11857,7 +11984,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
       __pyx_t_15 = (__pyx_v_newPos > (__pyx_v_newLength - 1));
       if (__pyx_t_15) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":162
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":162
  *             newPos += 1
  *             if newPos > newLength - 1:
  *                 break             # <<<<<<<<<<<<<<
@@ -11871,20 +11998,20 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
     }
     __pyx_L10_break:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":165
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":165
  * 
  *         # We got there, get the current location in the old index
  *         curLoc = oldMap[curOld]             # <<<<<<<<<<<<<<
  * 
  *         # We're at the end of the road, need to propagate this value to the end
  */
-    __pyx_t_4 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_4) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_PyDict_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_4) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_17 = __Pyx_PyInt_AsInt(__pyx_t_4); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_curLoc = __pyx_t_17;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":168
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":168
  * 
  *         # We're at the end of the road, need to propagate this value to the end
  *         if oldPos == oldLength - 1:             # <<<<<<<<<<<<<<
@@ -11894,7 +12021,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
     __pyx_t_15 = (__pyx_v_oldPos == (__pyx_v_oldLength - 1));
     if (__pyx_t_15) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":169
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":169
  *         # We're at the end of the road, need to propagate this value to the end
  *         if oldPos == oldLength - 1:
  *             if newIndex[newPos] >= curOld:             # <<<<<<<<<<<<<<
@@ -11919,7 +12046,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (__pyx_t_15) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":170
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":170
  *         if oldPos == oldLength - 1:
  *             if newIndex[newPos] >= curOld:
  *                 fillVec[newPos:] = curLoc             # <<<<<<<<<<<<<<
@@ -11931,7 +12058,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
         if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_t_6) < 0) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":171
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":171
  *             if newIndex[newPos] >= curOld:
  *                 fillVec[newPos:] = curLoc
  *                 mask[newPos:] = 1             # <<<<<<<<<<<<<<
@@ -11943,7 +12070,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
       }
       __pyx_L13:;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":172
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":172
  *                 fillVec[newPos:] = curLoc
  *                 mask[newPos:] = 1
  *             break             # <<<<<<<<<<<<<<
@@ -11955,7 +12082,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
     }
     /*else*/ {
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":177
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":177
  * 
  *             # Get the next index so we know when to stop propagating this value
  *             nextOld = oldIndex[oldPos + 1]             # <<<<<<<<<<<<<<
@@ -11977,18 +12104,16 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
       __pyx_v_nextOld = __pyx_t_6;
       __pyx_t_6 = 0;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":179
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":179
  *             nextOld = oldIndex[oldPos + 1]
  * 
  *             done = 0             # <<<<<<<<<<<<<<
  * 
  *             # Until we reach the next OLD value in the NEW index
  */
-      __Pyx_INCREF(__pyx_int_0);
-      __Pyx_DECREF(__pyx_v_done);
-      __pyx_v_done = __pyx_int_0;
+      __pyx_v_done = 0;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":182
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":182
  * 
  *             # Until we reach the next OLD value in the NEW index
  *             while newIndex[newPos] < nextOld:             # <<<<<<<<<<<<<<
@@ -12014,7 +12139,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         if (!__pyx_t_15) break;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":184
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":184
  *             while newIndex[newPos] < nextOld:
  *                 # Use this location to fill
  *                 fillVec[newPos] = curLoc             # <<<<<<<<<<<<<<
@@ -12032,7 +12157,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_bstruct_fillVec.buf, __pyx_t_20, __pyx_bstride_0_fillVec) = __pyx_v_curLoc;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":187
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":187
  * 
  *                 # Set mask to be 1 so will not be NaN'd
  *                 mask[newPos] = 1             # <<<<<<<<<<<<<<
@@ -12050,7 +12175,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_21, __pyx_bstride_0_mask) = 1;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":188
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":188
  *                 # Set mask to be 1 so will not be NaN'd
  *                 mask[newPos] = 1
  *                 newPos += 1             # <<<<<<<<<<<<<<
@@ -12059,7 +12184,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
  */
         __pyx_v_newPos += 1;
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":191
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":191
  * 
  *                 # We got to the end of the new index
  *                 if newPos > newLength - 1:             # <<<<<<<<<<<<<<
@@ -12069,18 +12194,16 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
         __pyx_t_15 = (__pyx_v_newPos > (__pyx_v_newLength - 1));
         if (__pyx_t_15) {
 
-          /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":192
+          /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":192
  *                 # We got to the end of the new index
  *                 if newPos > newLength - 1:
  *                     done = 1             # <<<<<<<<<<<<<<
  *                     break
  * 
  */
-          __Pyx_INCREF(__pyx_int_1);
-          __Pyx_DECREF(__pyx_v_done);
-          __pyx_v_done = __pyx_int_1;
+          __pyx_v_done = 1;
 
-          /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":193
+          /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":193
  *                 if newPos > newLength - 1:
  *                     done = 1
  *                     break             # <<<<<<<<<<<<<<
@@ -12094,17 +12217,16 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
       }
       __pyx_L15_break:;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":196
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":196
  * 
  *             # We got to the end of the new index
  *             if done:             # <<<<<<<<<<<<<<
  *                 break
  * 
  */
-      __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_v_done); if (unlikely(__pyx_t_15 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      if (__pyx_t_15) {
+      if (__pyx_v_done) {
 
-        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":197
+        /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":197
  *             # We got to the end of the new index
  *             if done:
  *                 break             # <<<<<<<<<<<<<<
@@ -12118,7 +12240,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
     }
     __pyx_L12:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":201
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":201
  *         # We already advanced the iterold pointer to the next value,
  *         # inc the count
  *         oldPos += 1             # <<<<<<<<<<<<<<
@@ -12129,7 +12251,7 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   }
   __pyx_L8_break:;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":203
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":203
  *         oldPos += 1
  * 
  *     return fillVec, mask             # <<<<<<<<<<<<<<
@@ -12177,17 +12299,12 @@ static PyObject *__pyx_pf_7tseries__pad(PyObject *__pyx_self, PyObject *__pyx_ar
   __Pyx_DECREF((PyObject *)__pyx_v_mask);
   __Pyx_DECREF(__pyx_v_curOld);
   __Pyx_DECREF(__pyx_v_nextOld);
-  __Pyx_DECREF(__pyx_v_done);
-  __Pyx_DECREF((PyObject *)__pyx_v_oldIndex);
-  __Pyx_DECREF((PyObject *)__pyx_v_newIndex);
-  __Pyx_DECREF(__pyx_v_oldMap);
-  __Pyx_DECREF(__pyx_v_newMap);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":206
+/* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":206
  * 
  * @cython.boundscheck(False)
  * def getMergeVec(ndarray values, dict oldMap):             # <<<<<<<<<<<<<<
@@ -12270,10 +12387,9 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.getMergeVec");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_values);
-  __Pyx_INCREF(__pyx_v_oldMap);
   __pyx_v_iternew = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_fillVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
@@ -12283,7 +12399,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":214
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":214
  *     cdef ndarray[int8_t, ndim=1] mask
  * 
  *     newLength = len(values)             # <<<<<<<<<<<<<<
@@ -12293,7 +12409,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_values)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_newLength = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":215
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":215
  * 
  *     newLength = len(values)
  *     fillVec = np.empty(newLength, dtype=np.int32)             # <<<<<<<<<<<<<<
@@ -12350,7 +12466,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":216
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":216
  *     newLength = len(values)
  *     fillVec = np.empty(newLength, dtype=np.int32)
  *     mask = np.zeros(newLength, dtype=np.int8)             # <<<<<<<<<<<<<<
@@ -12407,7 +12523,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_v_mask = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":218
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":218
  *     mask = np.zeros(newLength, dtype=np.int8)
  * 
  *     iternew = <flatiter> PyArray_IterNew(values)             # <<<<<<<<<<<<<<
@@ -12421,7 +12537,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_v_iternew = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":220
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":220
  *     iternew = <flatiter> PyArray_IterNew(values)
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -12431,7 +12547,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":221
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":221
  * 
  *     for i from 0 <= i < newLength:
  *         idx = PyArray_GETITEM(values, PyArray_ITER_DATA(iternew))             # <<<<<<<<<<<<<<
@@ -12444,7 +12560,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     __pyx_v_idx = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":223
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":223
  *         idx = PyArray_GETITEM(values, PyArray_ITER_DATA(iternew))
  * 
  *         if idx in oldMap:             # <<<<<<<<<<<<<<
@@ -12458,14 +12574,14 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     }
     if (__pyx_t_13) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":224
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":224
  * 
  *         if idx in oldMap:
  *             fillVec[i] = oldMap[idx]             # <<<<<<<<<<<<<<
  *             mask[i] = 1
  * 
  */
-      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = __Pyx_PyDict_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_14 = __Pyx_PyInt_from_py_npy_int32(__pyx_t_5); if (unlikely((__pyx_t_14 == (npy_int32)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
@@ -12473,7 +12589,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
       if (__pyx_t_15 < 0) __pyx_t_15 += __pyx_bshape_0_fillVec;
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_bstruct_fillVec.buf, __pyx_t_15, __pyx_bstride_0_fillVec) = __pyx_t_14;
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":225
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":225
  *         if idx in oldMap:
  *             fillVec[i] = oldMap[idx]
  *             mask[i] = 1             # <<<<<<<<<<<<<<
@@ -12487,7 +12603,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     }
     __pyx_L8:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":227
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":227
  *             mask[i] = 1
  * 
  *         PyArray_ITER_NEXT(iternew)             # <<<<<<<<<<<<<<
@@ -12497,7 +12613,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     PyArray_ITER_NEXT(__pyx_v_iternew);
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":229
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":229
  *         PyArray_ITER_NEXT(iternew)
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -12507,7 +12623,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":230
+    /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":230
  * 
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -12519,7 +12635,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     __pyx_t_13 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_17, __pyx_bstride_0_mask)) == 0);
     if (__pyx_t_13) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":231
+      /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":231
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:
  *             fillVec[i] = -1             # <<<<<<<<<<<<<<
@@ -12534,7 +12650,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     __pyx_L11:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":233
+  /* "/home/wesm/code/pandas/pandas/lib/src/reindex.pyx":233
  *             fillVec[i] = -1
  * 
  *     return fillVec, mask.astype(bool)             # <<<<<<<<<<<<<<
@@ -12545,9 +12661,9 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
-  __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
+  __Pyx_INCREF(((PyObject*)&PyBool_Type));
+  PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject*)&PyBool_Type));
+  __Pyx_GIVEREF(((PyObject*)&PyBool_Type));
   __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
@@ -12588,14 +12704,12 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_v_idx);
   __Pyx_DECREF((PyObject *)__pyx_v_fillVec);
   __Pyx_DECREF((PyObject *)__pyx_v_mask);
-  __Pyx_DECREF((PyObject *)__pyx_v_values);
-  __Pyx_DECREF(__pyx_v_oldMap);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":1
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":1
  * cdef double __add(double a, double b):             # <<<<<<<<<<<<<<
  *     return a + b
  * cdef double __sub(double a, double b):
@@ -12605,7 +12719,7 @@ static  double __pyx_f_7tseries___add(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__add");
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":2
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":2
  * cdef double __add(double a, double b):
  *     return a + b             # <<<<<<<<<<<<<<
  * cdef double __sub(double a, double b):
@@ -12620,7 +12734,7 @@ static  double __pyx_f_7tseries___add(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":3
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":3
  * cdef double __add(double a, double b):
  *     return a + b
  * cdef double __sub(double a, double b):             # <<<<<<<<<<<<<<
@@ -12632,7 +12746,7 @@ static  double __pyx_f_7tseries___sub(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__sub");
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":4
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":4
  *     return a + b
  * cdef double __sub(double a, double b):
  *     return a - b             # <<<<<<<<<<<<<<
@@ -12648,7 +12762,7 @@ static  double __pyx_f_7tseries___sub(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":5
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":5
  * cdef double __sub(double a, double b):
  *     return a - b
  * cdef double __div(double a, double b):             # <<<<<<<<<<<<<<
@@ -12660,7 +12774,7 @@ static  double __pyx_f_7tseries___div(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__div");
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":6
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":6
  *     return a - b
  * cdef double __div(double a, double b):
  *     return a / b             # <<<<<<<<<<<<<<
@@ -12684,7 +12798,7 @@ static  double __pyx_f_7tseries___div(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":7
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":7
  * cdef double __div(double a, double b):
  *     return a / b
  * cdef double __mul(double a, double b):             # <<<<<<<<<<<<<<
@@ -12696,7 +12810,7 @@ static  double __pyx_f_7tseries___mul(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__mul");
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":8
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":8
  *     return a / b
  * cdef double __mul(double a, double b):
  *     return a * b             # <<<<<<<<<<<<<<
@@ -12712,7 +12826,7 @@ static  double __pyx_f_7tseries___mul(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":9
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":9
  * cdef double __mul(double a, double b):
  *     return a * b
  * cdef double __eq(double a, double b):             # <<<<<<<<<<<<<<
@@ -12724,7 +12838,7 @@ static  double __pyx_f_7tseries___eq(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__eq");
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":10
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":10
  *     return a * b
  * cdef double __eq(double a, double b):
  *     return a == b             # <<<<<<<<<<<<<<
@@ -12740,7 +12854,7 @@ static  double __pyx_f_7tseries___eq(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":11
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":11
  * cdef double __eq(double a, double b):
  *     return a == b
  * cdef double __ne(double a, double b):             # <<<<<<<<<<<<<<
@@ -12752,7 +12866,7 @@ static  double __pyx_f_7tseries___ne(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__ne");
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":12
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":12
  *     return a == b
  * cdef double __ne(double a, double b):
  *     return a != b             # <<<<<<<<<<<<<<
@@ -12768,7 +12882,7 @@ static  double __pyx_f_7tseries___ne(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":13
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":13
  * cdef double __ne(double a, double b):
  *     return a != b
  * cdef double __lt(double a, double b):             # <<<<<<<<<<<<<<
@@ -12780,7 +12894,7 @@ static  double __pyx_f_7tseries___lt(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__lt");
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":14
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":14
  *     return a != b
  * cdef double __lt(double a, double b):
  *     return a < b             # <<<<<<<<<<<<<<
@@ -12796,7 +12910,7 @@ static  double __pyx_f_7tseries___lt(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":15
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":15
  * cdef double __lt(double a, double b):
  *     return a < b
  * cdef double __gt(double a, double b):             # <<<<<<<<<<<<<<
@@ -12808,7 +12922,7 @@ static  double __pyx_f_7tseries___gt(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__gt");
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":16
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":16
  *     return a < b
  * cdef double __gt(double a, double b):
  *     return a > b             # <<<<<<<<<<<<<<
@@ -12824,7 +12938,7 @@ static  double __pyx_f_7tseries___gt(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":17
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":17
  * cdef double __gt(double a, double b):
  *     return a > b
  * cdef double __pow(double a, double b):             # <<<<<<<<<<<<<<
@@ -12836,7 +12950,7 @@ static  double __pyx_f_7tseries___pow(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__pow");
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":18
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":18
  *     return a > b
  * cdef double __pow(double a, double b):
  *     return a ** b             # <<<<<<<<<<<<<<
@@ -12852,7 +12966,7 @@ static  double __pyx_f_7tseries___pow(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":24
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":24
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
  * cdef ndarray _applyFunc(double_func func, ndarray index, ndarray ao,             # <<<<<<<<<<<<<<
@@ -12898,11 +13012,6 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   __Pyx_RefNannySetupContext("_applyFunc");
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF((PyObject *)__pyx_v_ao);
-  __Pyx_INCREF((PyObject *)__pyx_v_bo);
-  __Pyx_INCREF(__pyx_v_aMap);
-  __Pyx_INCREF(__pyx_v_bMap);
   __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_ibuf = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
@@ -12912,7 +13021,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_bstruct_A.buf = NULL;
   __pyx_bstruct_B.buf = NULL;
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":38
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":38
  *     cdef ndarray[double_t, ndim=1] A, B
  * 
  *     A = ao             # <<<<<<<<<<<<<<
@@ -12940,7 +13049,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __Pyx_DECREF(((PyObject *)__pyx_v_A));
   __pyx_v_A = ((PyArrayObject *)__pyx_v_ao);
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":39
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":39
  * 
  *     A = ao
  *     B = bo             # <<<<<<<<<<<<<<
@@ -12968,7 +13077,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __Pyx_DECREF(((PyObject *)__pyx_v_B));
   __pyx_v_B = ((PyArrayObject *)__pyx_v_bo);
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":41
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":41
  *     B = bo
  * 
  *     ibuf = index             # <<<<<<<<<<<<<<
@@ -12996,7 +13105,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __Pyx_DECREF(((PyObject *)__pyx_v_ibuf));
   __pyx_v_ibuf = ((PyArrayObject *)__pyx_v_index);
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":43
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":43
  *     ibuf = index
  * 
  *     nan = <double> np.NaN             # <<<<<<<<<<<<<<
@@ -13010,9 +13119,9 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_7 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_v_nan = ((double)__pyx_t_7);
+  __pyx_v_nan = __pyx_t_7;
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":44
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":44
  * 
  *     nan = <double> np.NaN
  *     length = len(index)             # <<<<<<<<<<<<<<
@@ -13022,7 +13131,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_t_8 = PyObject_Length(((PyObject *)__pyx_v_index)); if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_length = __pyx_t_8;
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":45
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":45
  *     nan = <double> np.NaN
  *     length = len(index)
  *     result = <ndarray> np.empty(length, dtype=float)             # <<<<<<<<<<<<<<
@@ -13054,7 +13163,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_v_result = ((PyArrayObject *)__pyx_t_10);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":46
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":46
  *     length = len(index)
  *     result = <ndarray> np.empty(length, dtype=float)
  *     result_data = <double *> result.data             # <<<<<<<<<<<<<<
@@ -13063,7 +13172,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
   __pyx_v_result_data = ((double *)__pyx_v_result->data);
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":48
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":48
  *     result_data = <double *> result.data
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -13073,7 +13182,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_t_1 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_1; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":49
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":49
  * 
  *     for i from 0 <= i < length:
  *         idx = ibuf[i]             # <<<<<<<<<<<<<<
@@ -13087,7 +13196,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     __pyx_v_idx = __pyx_t_10;
     __pyx_t_10 = 0;
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":51
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":51
  *         idx = ibuf[i]
  * 
  *         if idx not in aMap or idx not in bMap:             # <<<<<<<<<<<<<<
@@ -13111,7 +13220,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     }
     if (__pyx_t_13) {
 
-      /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":52
+      /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":52
  * 
  *         if idx not in aMap or idx not in bMap:
  *             result_data[i] = nan             # <<<<<<<<<<<<<<
@@ -13120,7 +13229,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
       (__pyx_v_result_data[__pyx_v_i]) = __pyx_v_nan;
 
-      /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":53
+      /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":53
  *         if idx not in aMap or idx not in bMap:
  *             result_data[i] = nan
  *             continue             # <<<<<<<<<<<<<<
@@ -13132,33 +13241,33 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     }
     __pyx_L5:;
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":55
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":55
  *             continue
  * 
  *         aidx = aMap[idx]             # <<<<<<<<<<<<<<
  *         bidx = bMap[idx]
  *         result_data[i] = func(A[aidx], B[bidx])
  */
-    __pyx_t_10 = PyObject_GetItem(((PyObject *)__pyx_v_aMap), __pyx_v_idx); if (!__pyx_t_10) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyDict_GetItem(((PyObject *)__pyx_v_aMap), __pyx_v_idx); if (!__pyx_t_10) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_10); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_v_aidx = __pyx_t_14;
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":56
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":56
  * 
  *         aidx = aMap[idx]
  *         bidx = bMap[idx]             # <<<<<<<<<<<<<<
  *         result_data[i] = func(A[aidx], B[bidx])
  * 
  */
-    __pyx_t_10 = PyObject_GetItem(((PyObject *)__pyx_v_bMap), __pyx_v_idx); if (!__pyx_t_10) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyDict_GetItem(((PyObject *)__pyx_v_bMap), __pyx_v_idx); if (!__pyx_t_10) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_10); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_v_bidx = __pyx_t_14;
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":57
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":57
  *         aidx = aMap[idx]
  *         bidx = bMap[idx]
  *         result_data[i] = func(A[aidx], B[bidx])             # <<<<<<<<<<<<<<
@@ -13171,7 +13280,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     __pyx_L3_continue:;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":59
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":59
  *         result_data[i] = func(A[aidx], B[bidx])
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -13209,17 +13318,12 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __Pyx_DECREF((PyObject *)__pyx_v_ibuf);
   __Pyx_DECREF((PyObject *)__pyx_v_A);
   __Pyx_DECREF((PyObject *)__pyx_v_B);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF((PyObject *)__pyx_v_ao);
-  __Pyx_DECREF((PyObject *)__pyx_v_bo);
-  __Pyx_DECREF(__pyx_v_aMap);
-  __Pyx_DECREF(__pyx_v_bMap);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":61
+/* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":61
  *     return result
  * 
  * def combineFunc(object name, ndarray index, ndarray ao,             # <<<<<<<<<<<<<<
@@ -13316,21 +13420,16 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[7]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.combineFunc");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF(__pyx_v_name);
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF((PyObject *)__pyx_v_ao);
-  __Pyx_INCREF((PyObject *)__pyx_v_bo);
-  __Pyx_INCREF(__pyx_v_aMap);
-  __Pyx_INCREF(__pyx_v_bMap);
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_ao), __pyx_ptype_5numpy_ndarray, 1, "ao", 0))) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_bo), __pyx_ptype_5numpy_ndarray, 1, "bo", 0))) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_aMap), &PyDict_Type, 1, "aMap", 1))) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_bMap), &PyDict_Type, 1, "bMap", 1))) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":67
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":67
  *     indicated function.
  *     '''
  *     if name == "__add__":             # <<<<<<<<<<<<<<
@@ -13343,7 +13442,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":68
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":68
  *     '''
  *     if name == "__add__":
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -13359,7 +13458,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":69
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":69
  *     if name == "__add__":
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)
  *     elif name == "__sub__":             # <<<<<<<<<<<<<<
@@ -13372,7 +13471,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":70
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":70
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)
  *     elif name == "__sub__":
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -13388,7 +13487,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":71
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":71
  *     elif name == "__sub__":
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)
  *     elif name == "__div__":             # <<<<<<<<<<<<<<
@@ -13401,7 +13500,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":72
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":72
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)
  *     elif name == "__div__":
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -13417,7 +13516,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":73
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":73
  *     elif name == "__div__":
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)
  *     elif name == "__mul__":             # <<<<<<<<<<<<<<
@@ -13430,7 +13529,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":74
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":74
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)
  *     elif name == "__mul__":
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -13446,7 +13545,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":75
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":75
  *     elif name == "__mul__":
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)
  *     elif name == "__eq__":             # <<<<<<<<<<<<<<
@@ -13459,7 +13558,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":76
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":76
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)
  *     elif name == "__eq__":
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -13475,7 +13574,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":77
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":77
  *     elif name == "__eq__":
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)
  *     elif name == "__ne__":             # <<<<<<<<<<<<<<
@@ -13488,7 +13587,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":78
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":78
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)
  *     elif name == "__ne__":
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -13504,7 +13603,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":79
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":79
  *     elif name == "__ne__":
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)
  *     elif name == "__lt__":             # <<<<<<<<<<<<<<
@@ -13517,7 +13616,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":80
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":80
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)
  *     elif name == "__lt__":
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -13533,7 +13632,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":81
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":81
  *     elif name == "__lt__":
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)
  *     elif name == "__gt__":             # <<<<<<<<<<<<<<
@@ -13546,7 +13645,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":82
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":82
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)
  *     elif name == "__gt__":
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -13562,7 +13661,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":83
+  /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":83
  *     elif name == "__gt__":
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)
  *     elif name == "__pow__":             # <<<<<<<<<<<<<<
@@ -13575,7 +13674,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":84
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":84
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)
  *     elif name == "__pow__":
  *         return _applyFunc(__pow, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -13592,7 +13691,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   }
   /*else*/ {
 
-    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":86
+    /* "/home/wesm/code/pandas/pandas/lib/src/operators.pyx":86
  *         return _applyFunc(__pow, index, ao, bo, aMap, bMap)
  *     else:
  *         raise Exception('bad funcname requested of Cython code')             # <<<<<<<<<<<<<<
@@ -13619,18 +13718,12 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_AddTraceback("tseries.combineFunc");
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_DECREF(__pyx_v_name);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF((PyObject *)__pyx_v_ao);
-  __Pyx_DECREF((PyObject *)__pyx_v_bo);
-  __Pyx_DECREF(__pyx_v_aMap);
-  __Pyx_DECREF(__pyx_v_bMap);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\io.pyx":5
+/* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":5
  * from datetime import date as pydate
  * 
  * cdef inline int64_t gmtime(object date):             # <<<<<<<<<<<<<<
@@ -13655,7 +13748,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   int __pyx_t_5;
   __Pyx_RefNannySetupContext("gmtime");
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":8
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":8
  *     cdef int y, m, d, h, mn, s, ms, days
  * 
  *     y = PyDateTime_GET_YEAR(date)             # <<<<<<<<<<<<<<
@@ -13665,7 +13758,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   if (!(likely(((__pyx_v_date) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_date, __pyx_ptype_7tseries_datetime))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_y = PyDateTime_GET_YEAR(((PyDateTime_DateTime *)__pyx_v_date));
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":9
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":9
  * 
  *     y = PyDateTime_GET_YEAR(date)
  *     m = PyDateTime_GET_MONTH(date)             # <<<<<<<<<<<<<<
@@ -13675,7 +13768,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   if (!(likely(((__pyx_v_date) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_date, __pyx_ptype_7tseries_datetime))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_m = PyDateTime_GET_MONTH(((PyDateTime_DateTime *)__pyx_v_date));
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":10
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":10
  *     y = PyDateTime_GET_YEAR(date)
  *     m = PyDateTime_GET_MONTH(date)
  *     d = PyDateTime_GET_DAY(date)             # <<<<<<<<<<<<<<
@@ -13685,7 +13778,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   if (!(likely(((__pyx_v_date) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_date, __pyx_ptype_7tseries_datetime))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_d = PyDateTime_GET_DAY(((PyDateTime_DateTime *)__pyx_v_date));
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":11
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":11
  *     m = PyDateTime_GET_MONTH(date)
  *     d = PyDateTime_GET_DAY(date)
  *     h = PyDateTime_DATE_GET_HOUR(date)             # <<<<<<<<<<<<<<
@@ -13695,7 +13788,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   if (!(likely(((__pyx_v_date) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_date, __pyx_ptype_7tseries_datetime))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_h = PyDateTime_DATE_GET_HOUR(((PyDateTime_DateTime *)__pyx_v_date));
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":12
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":12
  *     d = PyDateTime_GET_DAY(date)
  *     h = PyDateTime_DATE_GET_HOUR(date)
  *     mn = PyDateTime_DATE_GET_MINUTE(date)             # <<<<<<<<<<<<<<
@@ -13705,7 +13798,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   if (!(likely(((__pyx_v_date) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_date, __pyx_ptype_7tseries_datetime))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_mn = PyDateTime_DATE_GET_MINUTE(((PyDateTime_DateTime *)__pyx_v_date));
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":13
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":13
  *     h = PyDateTime_DATE_GET_HOUR(date)
  *     mn = PyDateTime_DATE_GET_MINUTE(date)
  *     s = PyDateTime_DATE_GET_SECOND(date)             # <<<<<<<<<<<<<<
@@ -13715,7 +13808,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   if (!(likely(((__pyx_v_date) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_date, __pyx_ptype_7tseries_datetime))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_s = PyDateTime_DATE_GET_SECOND(((PyDateTime_DateTime *)__pyx_v_date));
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":14
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":14
  *     mn = PyDateTime_DATE_GET_MINUTE(date)
  *     s = PyDateTime_DATE_GET_SECOND(date)
  *     ms = PyDateTime_DATE_GET_MICROSECOND(date) / 1000             # <<<<<<<<<<<<<<
@@ -13725,7 +13818,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   if (!(likely(((__pyx_v_date) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_date, __pyx_ptype_7tseries_datetime))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_ms = __Pyx_div_long(PyDateTime_DATE_GET_MICROSECOND(((PyDateTime_DateTime *)__pyx_v_date)), 1000);
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":16
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":16
  *     ms = PyDateTime_DATE_GET_MICROSECOND(date) / 1000
  * 
  *     days = pydate(y, m, 1).toordinal() - _EPOCH_ORD + d - 1             # <<<<<<<<<<<<<<
@@ -13778,7 +13871,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_days = __pyx_t_5;
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":17
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":17
  * 
  *     days = pydate(y, m, 1).toordinal() - _EPOCH_ORD + d - 1
  *     return ((<int64_t> (((days * 24 + h) * 60 + mn))) * 60 + s) * 1000             # <<<<<<<<<<<<<<
@@ -13802,7 +13895,7 @@ static CYTHON_INLINE __pyx_t_5numpy_int64_t __pyx_f_7tseries_gmtime(PyObject *__
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\io.pyx":19
+/* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":19
  *     return ((<int64_t> (((days * 24 + h) * 60 + mn))) * 60 + s) * 1000
  * 
  * cpdef object to_datetime(int64_t timestamp):             # <<<<<<<<<<<<<<
@@ -13818,7 +13911,7 @@ static  PyObject *__pyx_f_7tseries_to_datetime(__pyx_t_5numpy_int64_t __pyx_v_ti
   PyObject *__pyx_t_3 = NULL;
   __Pyx_RefNannySetupContext("to_datetime");
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":20
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":20
  * 
  * cpdef object to_datetime(int64_t timestamp):
  *     return pydatetime.utcfromtimestamp(timestamp / 1000.0)             # <<<<<<<<<<<<<<
@@ -13860,7 +13953,7 @@ static  PyObject *__pyx_f_7tseries_to_datetime(__pyx_t_5numpy_int64_t __pyx_v_ti
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\io.pyx":19
+/* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":19
  *     return ((<int64_t> (((days * 24 + h) * 60 + mn))) * 60 + s) * 1000
  * 
  * cpdef object to_datetime(int64_t timestamp):             # <<<<<<<<<<<<<<
@@ -13881,6 +13974,7 @@ static PyObject *__pyx_pf_7tseries_to_datetime(PyObject *__pyx_self, PyObject *_
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.to_datetime");
+  __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_XDECREF(__pyx_r);
@@ -13902,7 +13996,7 @@ static PyObject *__pyx_pf_7tseries_to_datetime(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\io.pyx":22
+/* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":22
  *     return pydatetime.utcfromtimestamp(timestamp / 1000.0)
  * 
  * cpdef object to_timestamp(object dt):             # <<<<<<<<<<<<<<
@@ -13916,7 +14010,7 @@ static  PyObject *__pyx_f_7tseries_to_timestamp(PyObject *__pyx_v_dt, int __pyx_
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("to_timestamp");
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":23
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":23
  * 
  * cpdef object to_timestamp(object dt):
  *     return gmtime(dt)             # <<<<<<<<<<<<<<
@@ -13942,7 +14036,7 @@ static  PyObject *__pyx_f_7tseries_to_timestamp(PyObject *__pyx_v_dt, int __pyx_
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\io.pyx":22
+/* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":22
  *     return pydatetime.utcfromtimestamp(timestamp / 1000.0)
  * 
  * cpdef object to_timestamp(object dt):             # <<<<<<<<<<<<<<
@@ -13975,7 +14069,7 @@ static PyObject *__pyx_pf_7tseries_to_timestamp(PyObject *__pyx_self, PyObject *
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\io.pyx":25
+/* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":25
  *     return gmtime(dt)
  * 
  * def array_to_timestamp(ndarray[object, ndim=1] arr):             # <<<<<<<<<<<<<<
@@ -14011,7 +14105,6 @@ static PyObject *__pyx_pf_7tseries_array_to_timestamp(PyObject *__pyx_self, PyOb
   int __pyx_t_14;
   __Pyx_RefNannySetupContext("array_to_timestamp");
   __pyx_self = __pyx_self;
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
   __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_result.buf = NULL;
   __pyx_bstruct_arr.buf = NULL;
@@ -14023,7 +14116,7 @@ static PyObject *__pyx_pf_7tseries_array_to_timestamp(PyObject *__pyx_self, PyOb
   __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
   __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":29
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":29
  *     cdef ndarray[int64_t, ndim=1] result
  * 
  *     n = len(arr)             # <<<<<<<<<<<<<<
@@ -14033,7 +14126,7 @@ static PyObject *__pyx_pf_7tseries_array_to_timestamp(PyObject *__pyx_self, PyOb
   __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_n = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":30
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":30
  * 
  *     n = len(arr)
  *     result = np.empty(n, dtype=np.int64)             # <<<<<<<<<<<<<<
@@ -14090,7 +14183,7 @@ static PyObject *__pyx_pf_7tseries_array_to_timestamp(PyObject *__pyx_self, PyOb
   __pyx_v_result = ((PyArrayObject *)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":32
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":32
  *     result = np.empty(n, dtype=np.int64)
  * 
  *     for i from 0 <= i < n:             # <<<<<<<<<<<<<<
@@ -14100,7 +14193,7 @@ static PyObject *__pyx_pf_7tseries_array_to_timestamp(PyObject *__pyx_self, PyOb
   __pyx_t_8 = __pyx_v_n;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\io.pyx":33
+    /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":33
  * 
  *     for i from 0 <= i < n:
  *         result[i] = gmtime(arr[i])             # <<<<<<<<<<<<<<
@@ -14133,7 +14226,7 @@ static PyObject *__pyx_pf_7tseries_array_to_timestamp(PyObject *__pyx_self, PyOb
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":35
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":35
  *         result[i] = gmtime(arr[i])
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -14166,13 +14259,12 @@ static PyObject *__pyx_pf_7tseries_array_to_timestamp(PyObject *__pyx_self, PyOb
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
   __pyx_L2:;
   __Pyx_DECREF((PyObject *)__pyx_v_result);
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\workspace\pandas\pandas\lib\src\io.pyx":37
+/* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":37
  *     return result
  * 
  * def array_to_datetime(ndarray[int64_t, ndim=1] arr):             # <<<<<<<<<<<<<<
@@ -14208,7 +14300,6 @@ static PyObject *__pyx_pf_7tseries_array_to_datetime(PyObject *__pyx_self, PyObj
   PyObject **__pyx_t_14;
   __Pyx_RefNannySetupContext("array_to_datetime");
   __pyx_self = __pyx_self;
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
   __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_result.buf = NULL;
   __pyx_bstruct_arr.buf = NULL;
@@ -14220,7 +14311,7 @@ static PyObject *__pyx_pf_7tseries_array_to_datetime(PyObject *__pyx_self, PyObj
   __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
   __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":41
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":41
  *     cdef ndarray[object, ndim=1] result
  * 
  *     n = len(arr)             # <<<<<<<<<<<<<<
@@ -14230,7 +14321,7 @@ static PyObject *__pyx_pf_7tseries_array_to_datetime(PyObject *__pyx_self, PyObj
   __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_n = __pyx_t_1;
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":42
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":42
  * 
  *     n = len(arr)
  *     result = np.empty(n, dtype=object)             # <<<<<<<<<<<<<<
@@ -14281,7 +14372,7 @@ static PyObject *__pyx_pf_7tseries_array_to_datetime(PyObject *__pyx_self, PyObj
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":44
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":44
  *     result = np.empty(n, dtype=object)
  * 
  *     for i from 0 <= i < n:             # <<<<<<<<<<<<<<
@@ -14291,7 +14382,7 @@ static PyObject *__pyx_pf_7tseries_array_to_datetime(PyObject *__pyx_self, PyObj
   __pyx_t_7 = __pyx_v_n;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\workspace\pandas\pandas\lib\src\io.pyx":45
+    /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":45
  * 
  *     for i from 0 <= i < n:
  *         result[i] = to_datetime(arr[i])             # <<<<<<<<<<<<<<
@@ -14328,7 +14419,7 @@ static PyObject *__pyx_pf_7tseries_array_to_datetime(PyObject *__pyx_self, PyObj
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":47
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":47
  *         result[i] = to_datetime(arr[i])
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -14358,13 +14449,12 @@ static PyObject *__pyx_pf_7tseries_array_to_datetime(PyObject *__pyx_self, PyObj
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
   __pyx_L2:;
   __Pyx_DECREF((PyObject *)__pyx_v_result);
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":187
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":188
  *         # experimental exception made for __getbuffer__ and __releasebuffer__
  *         # -- the details of this may change.
  *         def __getbuffer__(ndarray self, Py_buffer* info, int flags):             # <<<<<<<<<<<<<<
@@ -14372,8 +14462,8 @@ static PyObject *__pyx_pf_7tseries_array_to_datetime(PyObject *__pyx_self, PyObj
  *             # requirements, and does not yet fullfill the PEP.
  */
 
-static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
-static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags) {
+static CYTHON_UNUSED int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
+static CYTHON_UNUSED int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags) {
   int __pyx_v_copy_shape;
   int __pyx_v_i;
   int __pyx_v_ndim;
@@ -14398,9 +14488,8 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   if (__pyx_v_info == NULL) return 0;
   __pyx_v_info->obj = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(__pyx_v_info->obj);
-  __Pyx_INCREF((PyObject *)__pyx_v_self);
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":193
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":194
  *             # of flags
  *             cdef int copy_shape, i, ndim
  *             cdef int endian_detector = 1             # <<<<<<<<<<<<<<
@@ -14409,7 +14498,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_endian_detector = 1;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":194
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":195
  *             cdef int copy_shape, i, ndim
  *             cdef int endian_detector = 1
  *             cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)             # <<<<<<<<<<<<<<
@@ -14418,7 +14507,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_little_endian = ((((char *)(&__pyx_v_endian_detector))[0]) != 0);
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":196
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":197
  *             cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)
  * 
  *             ndim = PyArray_NDIM(self)             # <<<<<<<<<<<<<<
@@ -14427,7 +14516,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_ndim = PyArray_NDIM(((PyArrayObject *)__pyx_v_self));
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":198
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":199
  *             ndim = PyArray_NDIM(self)
  * 
  *             if sizeof(npy_intp) != sizeof(Py_ssize_t):             # <<<<<<<<<<<<<<
@@ -14437,7 +14526,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __pyx_t_1 = ((sizeof(npy_intp)) != (sizeof(Py_ssize_t)));
   if (__pyx_t_1) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":199
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":200
  * 
  *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
  *                 copy_shape = 1             # <<<<<<<<<<<<<<
@@ -14449,7 +14538,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   /*else*/ {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":201
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":202
  *                 copy_shape = 1
  *             else:
  *                 copy_shape = 0             # <<<<<<<<<<<<<<
@@ -14460,7 +14549,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   __pyx_L5:;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":203
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":204
  *                 copy_shape = 0
  * 
  *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)             # <<<<<<<<<<<<<<
@@ -14470,7 +14559,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_C_CONTIGUOUS) == PyBUF_C_CONTIGUOUS);
   if (__pyx_t_1) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":204
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":205
  * 
  *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)
  *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):             # <<<<<<<<<<<<<<
@@ -14484,29 +14573,29 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   if (__pyx_t_3) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":205
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":206
  *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)
  *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):
  *                 raise ValueError(u"ndarray is not C contiguous")             # <<<<<<<<<<<<<<
  * 
  *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
  */
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(((PyObject *)__pyx_kp_u_6));
     PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_6));
     __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_6));
-    __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_5, 0, 0);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    {__pyx_filename = __pyx_f[8]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[8]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L6;
   }
   __pyx_L6:;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":207
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":208
  *                 raise ValueError(u"ndarray is not C contiguous")
  * 
  *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)             # <<<<<<<<<<<<<<
@@ -14516,7 +14605,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __pyx_t_3 = ((__pyx_v_flags & PyBUF_F_CONTIGUOUS) == PyBUF_F_CONTIGUOUS);
   if (__pyx_t_3) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":208
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":209
  * 
  *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
  *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):             # <<<<<<<<<<<<<<
@@ -14530,29 +14619,29 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   if (__pyx_t_2) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":209
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":210
  *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
  *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):
  *                 raise ValueError(u"ndarray is not Fortran contiguous")             # <<<<<<<<<<<<<<
  * 
  *             info.buf = PyArray_DATA(self)
  */
-    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(((PyObject *)__pyx_kp_u_7));
     PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_7));
     __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_7));
-    __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    {__pyx_filename = __pyx_f[8]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[8]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L7;
   }
   __pyx_L7:;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":211
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":212
  *                 raise ValueError(u"ndarray is not Fortran contiguous")
  * 
  *             info.buf = PyArray_DATA(self)             # <<<<<<<<<<<<<<
@@ -14561,7 +14650,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->buf = PyArray_DATA(((PyArrayObject *)__pyx_v_self));
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":212
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":213
  * 
  *             info.buf = PyArray_DATA(self)
  *             info.ndim = ndim             # <<<<<<<<<<<<<<
@@ -14570,17 +14659,16 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->ndim = __pyx_v_ndim;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":213
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":214
  *             info.buf = PyArray_DATA(self)
  *             info.ndim = ndim
  *             if copy_shape:             # <<<<<<<<<<<<<<
  *                 # Allocate new buffer for strides and shape info. This is allocated
  *                 # as one block, strides first.
  */
-  __pyx_t_6 = __pyx_v_copy_shape;
-  if (__pyx_t_6) {
+  if (__pyx_v_copy_shape) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":216
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":217
  *                 # Allocate new buffer for strides and shape info. This is allocated
  *                 # as one block, strides first.
  *                 info.strides = <Py_ssize_t*>stdlib.malloc(sizeof(Py_ssize_t) * ndim * 2)             # <<<<<<<<<<<<<<
@@ -14589,7 +14677,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->strides = ((Py_ssize_t *)malloc((((sizeof(Py_ssize_t)) * __pyx_v_ndim) * 2)));
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":217
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":218
  *                 # as one block, strides first.
  *                 info.strides = <Py_ssize_t*>stdlib.malloc(sizeof(Py_ssize_t) * ndim * 2)
  *                 info.shape = info.strides + ndim             # <<<<<<<<<<<<<<
@@ -14598,7 +14686,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->shape = (__pyx_v_info->strides + __pyx_v_ndim);
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":218
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":219
  *                 info.strides = <Py_ssize_t*>stdlib.malloc(sizeof(Py_ssize_t) * ndim * 2)
  *                 info.shape = info.strides + ndim
  *                 for i in range(ndim):             # <<<<<<<<<<<<<<
@@ -14609,7 +14697,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
       __pyx_v_i = __pyx_t_7;
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":219
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":220
  *                 info.shape = info.strides + ndim
  *                 for i in range(ndim):
  *                     info.strides[i] = PyArray_STRIDES(self)[i]             # <<<<<<<<<<<<<<
@@ -14618,7 +14706,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
       (__pyx_v_info->strides[__pyx_v_i]) = (PyArray_STRIDES(((PyArrayObject *)__pyx_v_self))[__pyx_v_i]);
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":220
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":221
  *                 for i in range(ndim):
  *                     info.strides[i] = PyArray_STRIDES(self)[i]
  *                     info.shape[i] = PyArray_DIMS(self)[i]             # <<<<<<<<<<<<<<
@@ -14631,7 +14719,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   /*else*/ {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":222
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":223
  *                     info.shape[i] = PyArray_DIMS(self)[i]
  *             else:
  *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
@@ -14640,7 +14728,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->strides = ((Py_ssize_t *)PyArray_STRIDES(((PyArrayObject *)__pyx_v_self)));
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":223
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":224
  *             else:
  *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)
  *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)             # <<<<<<<<<<<<<<
@@ -14651,7 +14739,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   __pyx_L8:;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":224
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":225
  *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)
  *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)
  *             info.suboffsets = NULL             # <<<<<<<<<<<<<<
@@ -14660,7 +14748,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->suboffsets = NULL;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":225
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":226
  *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)
  *             info.suboffsets = NULL
  *             info.itemsize = PyArray_ITEMSIZE(self)             # <<<<<<<<<<<<<<
@@ -14669,7 +14757,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->itemsize = PyArray_ITEMSIZE(((PyArrayObject *)__pyx_v_self));
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":226
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":227
  *             info.suboffsets = NULL
  *             info.itemsize = PyArray_ITEMSIZE(self)
  *             info.readonly = not PyArray_ISWRITEABLE(self)             # <<<<<<<<<<<<<<
@@ -14678,7 +14766,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->readonly = (!PyArray_ISWRITEABLE(((PyArrayObject *)__pyx_v_self)));
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":229
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":230
  * 
  *             cdef int t
  *             cdef char* f = NULL             # <<<<<<<<<<<<<<
@@ -14687,7 +14775,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_f = NULL;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":230
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":231
  *             cdef int t
  *             cdef char* f = NULL
  *             cdef dtype descr = self.descr             # <<<<<<<<<<<<<<
@@ -14697,7 +14785,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_v_self)->descr));
   __pyx_v_descr = ((PyArrayObject *)__pyx_v_self)->descr;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":234
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":235
  *             cdef int offset
  * 
  *             cdef bint hasfields = PyDataType_HASFIELDS(descr)             # <<<<<<<<<<<<<<
@@ -14706,7 +14794,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_hasfields = PyDataType_HASFIELDS(__pyx_v_descr);
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":236
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":237
  *             cdef bint hasfields = PyDataType_HASFIELDS(descr)
  * 
  *             if not hasfields and not copy_shape:             # <<<<<<<<<<<<<<
@@ -14722,7 +14810,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   if (__pyx_t_1) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":238
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":239
  *             if not hasfields and not copy_shape:
  *                 # do not call releasebuffer
  *                 info.obj = None             # <<<<<<<<<<<<<<
@@ -14738,7 +14826,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   /*else*/ {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":241
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":242
  *             else:
  *                 # need to call releasebuffer
  *                 info.obj = self             # <<<<<<<<<<<<<<
@@ -14753,7 +14841,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   __pyx_L11:;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":243
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":244
  *                 info.obj = self
  * 
  *             if not hasfields:             # <<<<<<<<<<<<<<
@@ -14763,7 +14851,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __pyx_t_1 = (!__pyx_v_hasfields);
   if (__pyx_t_1) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":244
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":245
  * 
  *             if not hasfields:
  *                 t = descr.type_num             # <<<<<<<<<<<<<<
@@ -14772,7 +14860,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_t = __pyx_v_descr->type_num;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":245
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":246
  *             if not hasfields:
  *                 t = descr.type_num
  *                 if ((descr.byteorder == '>' and little_endian) or             # <<<<<<<<<<<<<<
@@ -14787,7 +14875,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     }
     if (!__pyx_t_2) {
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":246
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":247
  *                 t = descr.type_num
  *                 if ((descr.byteorder == '>' and little_endian) or
  *                     (descr.byteorder == '<' and not little_endian)):             # <<<<<<<<<<<<<<
@@ -14807,29 +14895,29 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     }
     if (__pyx_t_1) {
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":247
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":248
  *                 if ((descr.byteorder == '>' and little_endian) or
  *                     (descr.byteorder == '<' and not little_endian)):
  *                     raise ValueError(u"Non-native byte order not supported")             # <<<<<<<<<<<<<<
  *                 if   t == NPY_BYTE:        f = "b"
  *                 elif t == NPY_UBYTE:       f = "B"
  */
-      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_INCREF(((PyObject *)__pyx_kp_u_8));
       PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_8));
       __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_8));
-      __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_5, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       goto __pyx_L13;
     }
     __pyx_L13:;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":248
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":249
  *                     (descr.byteorder == '<' and not little_endian)):
  *                     raise ValueError(u"Non-native byte order not supported")
  *                 if   t == NPY_BYTE:        f = "b"             # <<<<<<<<<<<<<<
@@ -14842,7 +14930,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":249
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":250
  *                     raise ValueError(u"Non-native byte order not supported")
  *                 if   t == NPY_BYTE:        f = "b"
  *                 elif t == NPY_UBYTE:       f = "B"             # <<<<<<<<<<<<<<
@@ -14855,7 +14943,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":250
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":251
  *                 if   t == NPY_BYTE:        f = "b"
  *                 elif t == NPY_UBYTE:       f = "B"
  *                 elif t == NPY_SHORT:       f = "h"             # <<<<<<<<<<<<<<
@@ -14868,7 +14956,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":251
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":252
  *                 elif t == NPY_UBYTE:       f = "B"
  *                 elif t == NPY_SHORT:       f = "h"
  *                 elif t == NPY_USHORT:      f = "H"             # <<<<<<<<<<<<<<
@@ -14881,7 +14969,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":252
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":253
  *                 elif t == NPY_SHORT:       f = "h"
  *                 elif t == NPY_USHORT:      f = "H"
  *                 elif t == NPY_INT:         f = "i"             # <<<<<<<<<<<<<<
@@ -14894,7 +14982,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":253
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":254
  *                 elif t == NPY_USHORT:      f = "H"
  *                 elif t == NPY_INT:         f = "i"
  *                 elif t == NPY_UINT:        f = "I"             # <<<<<<<<<<<<<<
@@ -14907,7 +14995,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":254
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":255
  *                 elif t == NPY_INT:         f = "i"
  *                 elif t == NPY_UINT:        f = "I"
  *                 elif t == NPY_LONG:        f = "l"             # <<<<<<<<<<<<<<
@@ -14920,7 +15008,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":255
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":256
  *                 elif t == NPY_UINT:        f = "I"
  *                 elif t == NPY_LONG:        f = "l"
  *                 elif t == NPY_ULONG:       f = "L"             # <<<<<<<<<<<<<<
@@ -14933,7 +15021,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":256
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":257
  *                 elif t == NPY_LONG:        f = "l"
  *                 elif t == NPY_ULONG:       f = "L"
  *                 elif t == NPY_LONGLONG:    f = "q"             # <<<<<<<<<<<<<<
@@ -14946,7 +15034,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":257
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":258
  *                 elif t == NPY_ULONG:       f = "L"
  *                 elif t == NPY_LONGLONG:    f = "q"
  *                 elif t == NPY_ULONGLONG:   f = "Q"             # <<<<<<<<<<<<<<
@@ -14959,7 +15047,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":258
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":259
  *                 elif t == NPY_LONGLONG:    f = "q"
  *                 elif t == NPY_ULONGLONG:   f = "Q"
  *                 elif t == NPY_FLOAT:       f = "f"             # <<<<<<<<<<<<<<
@@ -14972,7 +15060,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":259
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":260
  *                 elif t == NPY_ULONGLONG:   f = "Q"
  *                 elif t == NPY_FLOAT:       f = "f"
  *                 elif t == NPY_DOUBLE:      f = "d"             # <<<<<<<<<<<<<<
@@ -14985,7 +15073,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":260
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":261
  *                 elif t == NPY_FLOAT:       f = "f"
  *                 elif t == NPY_DOUBLE:      f = "d"
  *                 elif t == NPY_LONGDOUBLE:  f = "g"             # <<<<<<<<<<<<<<
@@ -14998,7 +15086,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":261
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":262
  *                 elif t == NPY_DOUBLE:      f = "d"
  *                 elif t == NPY_LONGDOUBLE:  f = "g"
  *                 elif t == NPY_CFLOAT:      f = "Zf"             # <<<<<<<<<<<<<<
@@ -15011,7 +15099,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":262
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":263
  *                 elif t == NPY_LONGDOUBLE:  f = "g"
  *                 elif t == NPY_CFLOAT:      f = "Zf"
  *                 elif t == NPY_CDOUBLE:     f = "Zd"             # <<<<<<<<<<<<<<
@@ -15024,7 +15112,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":263
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":264
  *                 elif t == NPY_CFLOAT:      f = "Zf"
  *                 elif t == NPY_CDOUBLE:     f = "Zd"
  *                 elif t == NPY_CLONGDOUBLE: f = "Zg"             # <<<<<<<<<<<<<<
@@ -15037,7 +15125,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":264
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":265
  *                 elif t == NPY_CDOUBLE:     f = "Zd"
  *                 elif t == NPY_CLONGDOUBLE: f = "Zg"
  *                 elif t == NPY_OBJECT:      f = "O"             # <<<<<<<<<<<<<<
@@ -15051,33 +15139,33 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     }
     /*else*/ {
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":266
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":267
  *                 elif t == NPY_OBJECT:      f = "O"
  *                 else:
  *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)             # <<<<<<<<<<<<<<
  *                 info.format = f
  *                 return
  */
-      __pyx_t_5 = PyInt_FromLong(__pyx_v_t); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(__pyx_v_t); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_9), __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_9), __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(((PyObject *)__pyx_t_4));
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
-      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_t_4));
+      __Pyx_GIVEREF(((PyObject *)__pyx_t_4));
       __pyx_t_4 = 0;
-      __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_Raise(__pyx_t_4, 0, 0);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_L14:;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":267
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":268
  *                 else:
  *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
  *                 info.format = f             # <<<<<<<<<<<<<<
@@ -15086,7 +15174,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->format = __pyx_v_f;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":268
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":269
  *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
  *                 info.format = f
  *                 return             # <<<<<<<<<<<<<<
@@ -15099,7 +15187,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   /*else*/ {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":270
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":271
  *                 return
  *             else:
  *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)             # <<<<<<<<<<<<<<
@@ -15108,7 +15196,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->format = ((char *)malloc(255));
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":271
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":272
  *             else:
  *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)
  *                 info.format[0] = '^' # Native data types, manual alignment             # <<<<<<<<<<<<<<
@@ -15117,7 +15205,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     (__pyx_v_info->format[0]) = '^';
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":272
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":273
  *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)
  *                 info.format[0] = '^' # Native data types, manual alignment
  *                 offset = 0             # <<<<<<<<<<<<<<
@@ -15126,17 +15214,17 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_offset = 0;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":275
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":276
  *                 f = _util_dtypestring(descr, info.format + 1,
  *                                       info.format + _buffer_format_string_len,
  *                                       &offset)             # <<<<<<<<<<<<<<
  *                 f[0] = 0 # Terminate format string
  * 
  */
-    __pyx_t_9 = __pyx_f_5numpy__util_dtypestring(__pyx_v_descr, (__pyx_v_info->format + 1), (__pyx_v_info->format + 255), (&__pyx_v_offset)); if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __pyx_f_5numpy__util_dtypestring(__pyx_v_descr, (__pyx_v_info->format + 1), (__pyx_v_info->format + 255), (&__pyx_v_offset)); if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_v_f = __pyx_t_9;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":276
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":277
  *                                       info.format + _buffer_format_string_len,
  *                                       &offset)
  *                 f[0] = 0 # Terminate format string             # <<<<<<<<<<<<<<
@@ -15164,12 +15252,11 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_descr);
-  __Pyx_DECREF((PyObject *)__pyx_v_self);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":278
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":279
  *                 f[0] = 0 # Terminate format string
  * 
  *         def __releasebuffer__(ndarray self, Py_buffer* info):             # <<<<<<<<<<<<<<
@@ -15177,13 +15264,12 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  *                 stdlib.free(info.format)
  */
 
-static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info); /*proto*/
-static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info) {
+static CYTHON_UNUSED void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info); /*proto*/
+static CYTHON_UNUSED void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info) {
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("__releasebuffer__");
-  __Pyx_INCREF((PyObject *)__pyx_v_self);
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":279
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":280
  * 
  *         def __releasebuffer__(ndarray self, Py_buffer* info):
  *             if PyArray_HASFIELDS(self):             # <<<<<<<<<<<<<<
@@ -15193,7 +15279,7 @@ static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, P
   __pyx_t_1 = PyArray_HASFIELDS(((PyArrayObject *)__pyx_v_self));
   if (__pyx_t_1) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":280
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":281
  *         def __releasebuffer__(ndarray self, Py_buffer* info):
  *             if PyArray_HASFIELDS(self):
  *                 stdlib.free(info.format)             # <<<<<<<<<<<<<<
@@ -15205,7 +15291,7 @@ static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, P
   }
   __pyx_L5:;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":281
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":282
  *             if PyArray_HASFIELDS(self):
  *                 stdlib.free(info.format)
  *             if sizeof(npy_intp) != sizeof(Py_ssize_t):             # <<<<<<<<<<<<<<
@@ -15215,7 +15301,7 @@ static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, P
   __pyx_t_1 = ((sizeof(npy_intp)) != (sizeof(Py_ssize_t)));
   if (__pyx_t_1) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":282
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":283
  *                 stdlib.free(info.format)
  *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
  *                 stdlib.free(info.strides)             # <<<<<<<<<<<<<<
@@ -15227,11 +15313,10 @@ static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, P
   }
   __pyx_L6:;
 
-  __Pyx_DECREF((PyObject *)__pyx_v_self);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":755
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":756
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
@@ -15244,7 +15329,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew1(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1");
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":756
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":757
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
@@ -15252,7 +15337,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew1(PyObject *__
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -15270,7 +15355,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew1(PyObject *__
   return __pyx_r;
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":758
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":759
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
@@ -15283,7 +15368,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew2(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2");
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":759
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":760
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
@@ -15291,7 +15376,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew2(PyObject *__
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -15309,7 +15394,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew2(PyObject *__
   return __pyx_r;
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":761
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":762
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
@@ -15322,7 +15407,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew3(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3");
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":762
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":763
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
@@ -15330,7 +15415,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew3(PyObject *__
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -15348,7 +15433,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew3(PyObject *__
   return __pyx_r;
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":764
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":765
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
@@ -15361,7 +15446,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew4(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4");
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":765
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":766
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
@@ -15369,7 +15454,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew4(PyObject *__
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 765; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -15387,7 +15472,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew4(PyObject *__
   return __pyx_r;
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":767
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":768
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
@@ -15400,7 +15485,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew5(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5");
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":768
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":769
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
@@ -15408,7 +15493,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew5(PyObject *__
  * cdef inline char* _util_dtypestring(dtype descr, char* f, char* end, int* offset) except NULL:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 769; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -15426,7 +15511,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew5(PyObject *__
   return __pyx_r;
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":770
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":771
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline char* _util_dtypestring(dtype descr, char* f, char* end, int* offset) except NULL:             # <<<<<<<<<<<<<<
@@ -15454,14 +15539,13 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
   int __pyx_t_9;
   char *__pyx_t_10;
   __Pyx_RefNannySetupContext("_util_dtypestring");
-  __Pyx_INCREF((PyObject *)__pyx_v_descr);
   __pyx_v_child = ((PyArray_Descr *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_fields = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_childname = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_new_offset = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_t = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":777
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":778
  *     cdef int delta_offset
  *     cdef tuple i
  *     cdef int endian_detector = 1             # <<<<<<<<<<<<<<
@@ -15470,7 +15554,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
   __pyx_v_endian_detector = 1;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":778
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":779
  *     cdef tuple i
  *     cdef int endian_detector = 1
  *     cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)             # <<<<<<<<<<<<<<
@@ -15479,7 +15563,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
   __pyx_v_little_endian = ((((char *)(&__pyx_v_endian_detector))[0]) != 0);
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":781
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":782
  *     cdef tuple fields
  * 
  *     for childname in descr.names:             # <<<<<<<<<<<<<<
@@ -15489,7 +15573,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
   if (likely(((PyObject *)__pyx_v_descr->names) != Py_None)) {
     __pyx_t_1 = 0; __pyx_t_2 = ((PyObject *)__pyx_v_descr->names); __Pyx_INCREF(__pyx_t_2);
   } else {
-    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable"); {__pyx_filename = __pyx_f[8]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable"); {__pyx_filename = __pyx_f[8]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   for (;;) {
     if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
@@ -15498,21 +15582,21 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     __pyx_v_childname = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":782
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":783
  * 
  *     for childname in descr.names:
  *         fields = descr.fields[childname]             # <<<<<<<<<<<<<<
  *         child, new_offset = fields
  * 
  */
-    __pyx_t_3 = PyObject_GetItem(__pyx_v_descr->fields, __pyx_v_childname); if (!__pyx_t_3) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetItem(__pyx_v_descr->fields, __pyx_v_childname); if (!__pyx_t_3) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    if (!(likely(PyTuple_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_3)->tp_name), 0))) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(PyTuple_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_3)->tp_name), 0))) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_fields));
     __pyx_v_fields = ((PyObject *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":783
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":784
  *     for childname in descr.names:
  *         fields = descr.fields[childname]
  *         child, new_offset = fields             # <<<<<<<<<<<<<<
@@ -15522,7 +15606,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     if (likely(((PyObject *)__pyx_v_fields) != Py_None) && likely(PyTuple_GET_SIZE(((PyObject *)__pyx_v_fields)) == 2)) {
       PyObject* tuple = ((PyObject *)__pyx_v_fields);
       __pyx_t_3 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_3);
-      if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_dtype))))) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_dtype))))) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __pyx_t_4 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_4);
       __Pyx_DECREF(((PyObject *)__pyx_v_child));
       __pyx_v_child = ((PyArray_Descr *)__pyx_t_3);
@@ -15532,57 +15616,57 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       __pyx_t_4 = 0;
     } else {
       __Pyx_UnpackTupleError(((PyObject *)__pyx_v_fields), 2);
-      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":785
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":786
  *         child, new_offset = fields
  * 
  *         if (end - f) - (new_offset - offset[0]) < 15:             # <<<<<<<<<<<<<<
  *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")
  * 
  */
-    __pyx_t_4 = PyInt_FromLong((__pyx_v_end - __pyx_v_f)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyInt_FromLong((__pyx_v_end - __pyx_v_f)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyInt_FromLong((__pyx_v_offset[0])); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyInt_FromLong((__pyx_v_offset[0])); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = PyNumber_Subtract(__pyx_v_new_offset, __pyx_t_3); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyNumber_Subtract(__pyx_v_new_offset, __pyx_t_3); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyObject_RichCompare(__pyx_t_3, __pyx_int_15, Py_LT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_RichCompare(__pyx_t_3, __pyx_int_15, Py_LT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_6) {
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":786
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":787
  * 
  *         if (end - f) - (new_offset - offset[0]) < 15:
  *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")             # <<<<<<<<<<<<<<
  * 
  *         if ((child.byteorder == '>' and little_endian) or
  */
-      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_INCREF(((PyObject *)__pyx_kp_u_10));
       PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_10));
       __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_10));
-      __pyx_t_3 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       goto __pyx_L5;
     }
     __pyx_L5:;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":788
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":789
  *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")
  * 
  *         if ((child.byteorder == '>' and little_endian) or             # <<<<<<<<<<<<<<
@@ -15597,7 +15681,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     }
     if (!__pyx_t_7) {
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":789
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":790
  * 
  *         if ((child.byteorder == '>' and little_endian) or
  *             (child.byteorder == '<' and not little_endian)):             # <<<<<<<<<<<<<<
@@ -15617,29 +15701,29 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     }
     if (__pyx_t_6) {
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":790
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":791
  *         if ((child.byteorder == '>' and little_endian) or
  *             (child.byteorder == '<' and not little_endian)):
  *             raise ValueError(u"Non-native byte order not supported")             # <<<<<<<<<<<<<<
  *             # One could encode it in the format string and have Cython
  *             # complain instead, BUT: < and > in format strings also imply
  */
-      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(((PyObject *)__pyx_kp_u_8));
       PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_8));
       __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_8));
-      __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_Raise(__pyx_t_5, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[8]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       goto __pyx_L6;
     }
     __pyx_L6:;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":800
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":801
  * 
  *         # Output padding bytes
  *         while offset[0] < new_offset:             # <<<<<<<<<<<<<<
@@ -15647,16 +15731,16 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  *             f += 1
  */
     while (1) {
-      __pyx_t_5 = PyInt_FromLong((__pyx_v_offset[0])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong((__pyx_v_offset[0])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_v_new_offset, Py_LT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_v_new_offset, Py_LT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (!__pyx_t_6) break;
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":801
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":802
  *         # Output padding bytes
  *         while offset[0] < new_offset:
  *             f[0] = 120 # "x"; pad byte             # <<<<<<<<<<<<<<
@@ -15665,7 +15749,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
       (__pyx_v_f[0]) = 120;
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":802
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":803
  *         while offset[0] < new_offset:
  *             f[0] = 120 # "x"; pad byte
  *             f += 1             # <<<<<<<<<<<<<<
@@ -15674,7 +15758,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
       __pyx_v_f += 1;
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":803
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":804
  *             f[0] = 120 # "x"; pad byte
  *             f += 1
  *             offset[0] += 1             # <<<<<<<<<<<<<<
@@ -15684,7 +15768,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       (__pyx_v_offset[0]) += 1;
     }
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":805
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":806
  *             offset[0] += 1
  * 
  *         offset[0] += child.itemsize             # <<<<<<<<<<<<<<
@@ -15693,7 +15777,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
     (__pyx_v_offset[0]) += __pyx_v_child->elsize;
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":807
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":808
  *         offset[0] += child.itemsize
  * 
  *         if not PyDataType_HASFIELDS(child):             # <<<<<<<<<<<<<<
@@ -15703,20 +15787,20 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     __pyx_t_6 = (!PyDataType_HASFIELDS(__pyx_v_child));
     if (__pyx_t_6) {
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":808
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":809
  * 
  *         if not PyDataType_HASFIELDS(child):
  *             t = child.type_num             # <<<<<<<<<<<<<<
  *             if end - f < 5:
  *                 raise RuntimeError(u"Format string allocated too short.")
  */
-      __pyx_t_3 = PyInt_FromLong(__pyx_v_child->type_num); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(__pyx_v_child->type_num); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_v_t);
       __pyx_v_t = __pyx_t_3;
       __pyx_t_3 = 0;
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":809
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":810
  *         if not PyDataType_HASFIELDS(child):
  *             t = child.type_num
  *             if end - f < 5:             # <<<<<<<<<<<<<<
@@ -15726,288 +15810,288 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       __pyx_t_6 = ((__pyx_v_end - __pyx_v_f) < 5);
       if (__pyx_t_6) {
 
-        /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":810
+        /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":811
  *             t = child.type_num
  *             if end - f < 5:
  *                 raise RuntimeError(u"Format string allocated too short.")             # <<<<<<<<<<<<<<
  * 
  *             # Until ticket #99 is fixed, use integers to avoid warnings
  */
-        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 811; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(((PyObject *)__pyx_kp_u_11));
         PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_11));
         __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_11));
-        __pyx_t_5 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 811; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_Raise(__pyx_t_5, 0, 0);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        {__pyx_filename = __pyx_f[8]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[8]; __pyx_lineno = 811; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         goto __pyx_L10;
       }
       __pyx_L10:;
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":813
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":814
  * 
  *             # Until ticket #99 is fixed, use integers to avoid warnings
  *             if   t == NPY_BYTE:        f[0] =  98 #"b"             # <<<<<<<<<<<<<<
  *             elif t == NPY_UBYTE:       f[0] =  66 #"B"
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_BYTE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_BYTE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 98;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":814
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":815
  *             # Until ticket #99 is fixed, use integers to avoid warnings
  *             if   t == NPY_BYTE:        f[0] =  98 #"b"
  *             elif t == NPY_UBYTE:       f[0] =  66 #"B"             # <<<<<<<<<<<<<<
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_UBYTE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_UBYTE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 66;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":815
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":816
  *             if   t == NPY_BYTE:        f[0] =  98 #"b"
  *             elif t == NPY_UBYTE:       f[0] =  66 #"B"
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"             # <<<<<<<<<<<<<<
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"
  *             elif t == NPY_INT:         f[0] = 105 #"i"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_SHORT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_SHORT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 104;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":816
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":817
  *             elif t == NPY_UBYTE:       f[0] =  66 #"B"
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"             # <<<<<<<<<<<<<<
  *             elif t == NPY_INT:         f[0] = 105 #"i"
  *             elif t == NPY_UINT:        f[0] =  73 #"I"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_USHORT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_USHORT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 72;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":817
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":818
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"
  *             elif t == NPY_INT:         f[0] = 105 #"i"             # <<<<<<<<<<<<<<
  *             elif t == NPY_UINT:        f[0] =  73 #"I"
  *             elif t == NPY_LONG:        f[0] = 108 #"l"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_INT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_INT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 105;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":818
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":819
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"
  *             elif t == NPY_INT:         f[0] = 105 #"i"
  *             elif t == NPY_UINT:        f[0] =  73 #"I"             # <<<<<<<<<<<<<<
  *             elif t == NPY_LONG:        f[0] = 108 #"l"
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_UINT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_UINT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 73;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":819
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":820
  *             elif t == NPY_INT:         f[0] = 105 #"i"
  *             elif t == NPY_UINT:        f[0] =  73 #"I"
  *             elif t == NPY_LONG:        f[0] = 108 #"l"             # <<<<<<<<<<<<<<
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_LONG); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_LONG); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 108;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":820
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":821
  *             elif t == NPY_UINT:        f[0] =  73 #"I"
  *             elif t == NPY_LONG:        f[0] = 108 #"l"
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"             # <<<<<<<<<<<<<<
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_ULONG); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_ULONG); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 76;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":821
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":822
  *             elif t == NPY_LONG:        f[0] = 108 #"l"
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"             # <<<<<<<<<<<<<<
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_LONGLONG); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_LONGLONG); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 113;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":822
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":823
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"             # <<<<<<<<<<<<<<
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_ULONGLONG); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_ULONGLONG); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 81;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":823
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":824
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"             # <<<<<<<<<<<<<<
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_FLOAT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_FLOAT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 102;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":824
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":825
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"             # <<<<<<<<<<<<<<
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_DOUBLE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_DOUBLE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 100;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":825
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":826
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"             # <<<<<<<<<<<<<<
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_LONGDOUBLE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_LONGDOUBLE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 103;
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":826
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":827
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf             # <<<<<<<<<<<<<<
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
  *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_CFLOAT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_CFLOAT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 90;
@@ -16016,19 +16100,19 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":827
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":828
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd             # <<<<<<<<<<<<<<
  *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg
  *             elif t == NPY_OBJECT:      f[0] = 79 #"O"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_CDOUBLE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_CDOUBLE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 90;
@@ -16037,19 +16121,19 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":828
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":829
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
  *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg             # <<<<<<<<<<<<<<
  *             elif t == NPY_OBJECT:      f[0] = 79 #"O"
  *             else:
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_CLONGDOUBLE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_CLONGDOUBLE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 90;
@@ -16058,19 +16142,19 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":829
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":830
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
  *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg
  *             elif t == NPY_OBJECT:      f[0] = 79 #"O"             # <<<<<<<<<<<<<<
  *             else:
  *                 raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_OBJECT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_OBJECT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 79;
@@ -16078,30 +16162,30 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       }
       /*else*/ {
 
-        /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":831
+        /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":832
  *             elif t == NPY_OBJECT:      f[0] = 79 #"O"
  *             else:
  *                 raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)             # <<<<<<<<<<<<<<
  *             f += 1
  *         else:
  */
-        __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_9), __pyx_v_t); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_9), __pyx_v_t); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(((PyObject *)__pyx_t_3));
+        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
-        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_t_3));
+        __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
         __pyx_t_3 = 0;
-        __pyx_t_3 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_Raise(__pyx_t_3, 0, 0);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        {__pyx_filename = __pyx_f[8]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[8]; __pyx_lineno = 832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_L11:;
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":832
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":833
  *             else:
  *                 raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
  *             f += 1             # <<<<<<<<<<<<<<
@@ -16113,21 +16197,21 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     }
     /*else*/ {
 
-      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":836
+      /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":837
  *             # Cython ignores struct boundary information ("T{...}"),
  *             # so don't output it
  *             f = _util_dtypestring(child, f, end, offset)             # <<<<<<<<<<<<<<
  *     return f
  * 
  */
-      __pyx_t_10 = __pyx_f_5numpy__util_dtypestring(__pyx_v_child, __pyx_v_f, __pyx_v_end, __pyx_v_offset); if (unlikely(__pyx_t_10 == NULL)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = __pyx_f_5numpy__util_dtypestring(__pyx_v_child, __pyx_v_f, __pyx_v_end, __pyx_v_offset); if (unlikely(__pyx_t_10 == NULL)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __pyx_v_f = __pyx_t_10;
     }
     __pyx_L9:;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":837
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":838
  *             # so don't output it
  *             f = _util_dtypestring(child, f, end, offset)
  *     return f             # <<<<<<<<<<<<<<
@@ -16152,12 +16236,11 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
   __Pyx_DECREF(__pyx_v_childname);
   __Pyx_DECREF(__pyx_v_new_offset);
   __Pyx_DECREF(__pyx_v_t);
-  __Pyx_DECREF((PyObject *)__pyx_v_descr);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":952
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":953
  * 
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
@@ -16169,10 +16252,8 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
   PyObject *__pyx_v_baseptr;
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("set_array_base");
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
-  __Pyx_INCREF(__pyx_v_base);
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":954
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":955
  * cdef inline void set_array_base(ndarray arr, object base):
  *      cdef PyObject* baseptr
  *      if base is None:             # <<<<<<<<<<<<<<
@@ -16182,7 +16263,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
   __pyx_t_1 = (__pyx_v_base == Py_None);
   if (__pyx_t_1) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":955
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":956
  *      cdef PyObject* baseptr
  *      if base is None:
  *          baseptr = NULL             # <<<<<<<<<<<<<<
@@ -16194,7 +16275,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
   }
   /*else*/ {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":957
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":958
  *          baseptr = NULL
  *      else:
  *          Py_INCREF(base) # important to do this before decref below!             # <<<<<<<<<<<<<<
@@ -16203,7 +16284,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
  */
     Py_INCREF(__pyx_v_base);
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":958
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":959
  *      else:
  *          Py_INCREF(base) # important to do this before decref below!
  *          baseptr = <PyObject*>base             # <<<<<<<<<<<<<<
@@ -16214,7 +16295,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
   }
   __pyx_L3:;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":959
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":960
  *          Py_INCREF(base) # important to do this before decref below!
  *          baseptr = <PyObject*>base
  *      Py_XDECREF(arr.base)             # <<<<<<<<<<<<<<
@@ -16223,7 +16304,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
  */
   Py_XDECREF(__pyx_v_arr->base);
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":960
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":961
  *          baseptr = <PyObject*>base
  *      Py_XDECREF(arr.base)
  *      arr.base = baseptr             # <<<<<<<<<<<<<<
@@ -16232,12 +16313,10 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
  */
   __pyx_v_arr->base = __pyx_v_baseptr;
 
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
-  __Pyx_DECREF(__pyx_v_base);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":962
+/* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":963
  *      arr.base = baseptr
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
@@ -16249,9 +16328,8 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__py
   PyObject *__pyx_r = NULL;
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base");
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":963
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":964
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     if arr.base is NULL:             # <<<<<<<<<<<<<<
@@ -16261,7 +16339,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__py
   __pyx_t_1 = (__pyx_v_arr->base == NULL);
   if (__pyx_t_1) {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":964
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":965
  * cdef inline object get_array_base(ndarray arr):
  *     if arr.base is NULL:
  *         return None             # <<<<<<<<<<<<<<
@@ -16276,7 +16354,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__py
   }
   /*else*/ {
 
-    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":966
+    /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/numpy.pxd":967
  *         return None
  *     else:
  *         return <object>arr.base             # <<<<<<<<<<<<<<
@@ -16290,7 +16368,6 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__py
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
@@ -16337,6 +16414,20 @@ static int __pyx_tp_clear_7tseries_Node(PyObject *o) {
   return 0;
 }
 
+static PyObject *__pyx_getprop_7tseries_4Node_value(PyObject *o, void *x) {
+  return __pyx_pf_7tseries_4Node_5value___get__(o);
+}
+
+static int __pyx_setprop_7tseries_4Node_value(PyObject *o, PyObject *v, void *x) {
+  if (v) {
+    return __pyx_pf_7tseries_4Node_5value___set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
 static PyObject *__pyx_getprop_7tseries_4Node_next(PyObject *o, void *x) {
   return __pyx_pf_7tseries_4Node_4next___get__(o);
 }
@@ -16346,8 +16437,7 @@ static int __pyx_setprop_7tseries_4Node_next(PyObject *o, PyObject *v, void *x)
     return __pyx_pf_7tseries_4Node_4next___set__(o, v);
   }
   else {
-    PyErr_SetString(PyExc_NotImplementedError, "__del__");
-    return -1;
+    return __pyx_pf_7tseries_4Node_4next___del__(o);
   }
 }
 
@@ -16360,21 +16450,16 @@ static int __pyx_setprop_7tseries_4Node_width_arr(PyObject *o, PyObject *v, void
     return __pyx_pf_7tseries_4Node_9width_arr___set__(o, v);
   }
   else {
-    PyErr_SetString(PyExc_NotImplementedError, "__del__");
-    return -1;
+    return __pyx_pf_7tseries_4Node_9width_arr___del__(o);
   }
 }
 
-static struct PyMethodDef __pyx_methods_7tseries_Node[] = {
+static PyMethodDef __pyx_methods_7tseries_Node[] = {
   {0, 0, 0, 0}
 };
 
-static struct PyMemberDef __pyx_members_7tseries_Node[] = {
-  {(char *)"value", T_DOUBLE, offsetof(struct __pyx_obj_7tseries_Node, value), 0, 0},
-  {0, 0, 0, 0, 0}
-};
-
 static struct PyGetSetDef __pyx_getsets_7tseries_Node[] = {
+  {(char *)"value", __pyx_getprop_7tseries_4Node_value, __pyx_setprop_7tseries_4Node_value, 0, 0},
   {(char *)"next", __pyx_getprop_7tseries_4Node_next, __pyx_setprop_7tseries_4Node_next, 0, 0},
   {(char *)"width_arr", __pyx_getprop_7tseries_4Node_width_arr, __pyx_setprop_7tseries_4Node_width_arr, 0, 0},
   {0, 0, 0, 0, 0}
@@ -16404,10 +16489,10 @@ static PyNumberMethods __pyx_tp_as_number_Node = {
   0, /*nb_coerce*/
   #endif
   0, /*nb_int*/
-  #if PY_MAJOR_VERSION >= 3
-  0, /*reserved*/
-  #else
+  #if PY_MAJOR_VERSION < 3
   0, /*nb_long*/
+  #else
+  0, /*reserved*/
   #endif
   0, /*nb_float*/
   #if PY_MAJOR_VERSION < 3
@@ -16433,7 +16518,7 @@ static PyNumberMethods __pyx_tp_as_number_Node = {
   0, /*nb_true_divide*/
   0, /*nb_inplace_floor_divide*/
   0, /*nb_inplace_true_divide*/
-  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
+  #if PY_VERSION_HEX >= 0x02050000
   0, /*nb_index*/
   #endif
 };
@@ -16487,7 +16572,11 @@ PyTypeObject __pyx_type_7tseries_Node = {
   0, /*tp_print*/
   0, /*tp_getattr*/
   0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
   0, /*tp_compare*/
+  #else
+  0, /*reserved*/
+  #endif
   0, /*tp_repr*/
   &__pyx_tp_as_number_Node, /*tp_as_number*/
   &__pyx_tp_as_sequence_Node, /*tp_as_sequence*/
@@ -16507,7 +16596,7 @@ PyTypeObject __pyx_type_7tseries_Node = {
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_7tseries_Node, /*tp_methods*/
-  __pyx_members_7tseries_Node, /*tp_members*/
+  0, /*tp_members*/
   __pyx_getsets_7tseries_Node, /*tp_getset*/
   0, /*tp_base*/
   0, /*tp_dict*/
@@ -16529,12 +16618,14 @@ PyTypeObject __pyx_type_7tseries_Node = {
   0, /*tp_version_tag*/
   #endif
 };
+static struct __pyx_vtabstruct_7tseries_IndexableSkiplist __pyx_vtable_7tseries_IndexableSkiplist;
 
 static PyObject *__pyx_tp_new_7tseries_IndexableSkiplist(PyTypeObject *t, PyObject *a, PyObject *k) {
   struct __pyx_obj_7tseries_IndexableSkiplist *p;
   PyObject *o = (*t->tp_alloc)(t, 0);
   if (!o) return 0;
   p = ((struct __pyx_obj_7tseries_IndexableSkiplist *)o);
+  p->__pyx_vtab = __pyx_vtabptr_7tseries_IndexableSkiplist;
   p->head = ((struct __pyx_obj_7tseries_Node *)Py_None); Py_INCREF(Py_None);
   return o;
 }
@@ -16570,8 +16661,7 @@ static PyObject *__pyx_sq_item_7tseries_IndexableSkiplist(PyObject *o, Py_ssize_
   return r;
 }
 
-static struct PyMethodDef __pyx_methods_7tseries_IndexableSkiplist[] = {
-  {__Pyx_NAMESTR("__getitem__"), (PyCFunction)__pyx_pf_7tseries_17IndexableSkiplist___getitem__, METH_O|METH_COEXIST, __Pyx_DOCSTR(0)},
+static PyMethodDef __pyx_methods_7tseries_IndexableSkiplist[] = {
   {__Pyx_NAMESTR("get"), (PyCFunction)__pyx_pf_7tseries_17IndexableSkiplist_get, METH_O, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("insert"), (PyCFunction)__pyx_pf_7tseries_17IndexableSkiplist_insert, METH_O, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("remove"), (PyCFunction)__pyx_pf_7tseries_17IndexableSkiplist_remove, METH_O, __Pyx_DOCSTR(0)},
@@ -16602,10 +16692,10 @@ static PyNumberMethods __pyx_tp_as_number_IndexableSkiplist = {
   0, /*nb_coerce*/
   #endif
   0, /*nb_int*/
-  #if PY_MAJOR_VERSION >= 3
-  0, /*reserved*/
-  #else
+  #if PY_MAJOR_VERSION < 3
   0, /*nb_long*/
+  #else
+  0, /*reserved*/
   #endif
   0, /*nb_float*/
   #if PY_MAJOR_VERSION < 3
@@ -16631,7 +16721,7 @@ static PyNumberMethods __pyx_tp_as_number_IndexableSkiplist = {
   0, /*nb_true_divide*/
   0, /*nb_inplace_floor_divide*/
   0, /*nb_inplace_true_divide*/
-  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
+  #if PY_VERSION_HEX >= 0x02050000
   0, /*nb_index*/
   #endif
 };
@@ -16685,7 +16775,11 @@ PyTypeObject __pyx_type_7tseries_IndexableSkiplist = {
   0, /*tp_print*/
   0, /*tp_getattr*/
   0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
   0, /*tp_compare*/
+  #else
+  0, /*reserved*/
+  #endif
   0, /*tp_repr*/
   &__pyx_tp_as_number_IndexableSkiplist, /*tp_as_number*/
   &__pyx_tp_as_sequence_IndexableSkiplist, /*tp_as_sequence*/
@@ -16728,7 +16822,7 @@ PyTypeObject __pyx_type_7tseries_IndexableSkiplist = {
   #endif
 };
 
-static struct PyMethodDef __pyx_methods[] = {
+static PyMethodDef __pyx_methods[] = {
   {__Pyx_NAMESTR("map_indices"), (PyCFunction)__pyx_pf_7tseries_map_indices, METH_O, __Pyx_DOCSTR(__pyx_doc_7tseries_map_indices)},
   {__Pyx_NAMESTR("isAllDates"), (PyCFunction)__pyx_pf_7tseries_isAllDates, METH_O, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("isAllDates2"), (PyCFunction)__pyx_pf_7tseries_isAllDates2, METH_O, __Pyx_DOCSTR(__pyx_doc_7tseries_isAllDates2)},
@@ -16741,13 +16835,13 @@ static struct PyMethodDef __pyx_methods[] = {
   {__Pyx_NAMESTR("median"), (PyCFunction)__pyx_pf_7tseries_median, METH_O, __Pyx_DOCSTR(__pyx_doc_7tseries_median)},
   {__Pyx_NAMESTR("roll_sum"), (PyCFunction)__pyx_pf_7tseries_roll_sum, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("roll_mean"), (PyCFunction)__pyx_pf_7tseries_roll_mean, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
-  {__Pyx_NAMESTR("ewma"), (PyCFunction)__pyx_pf_7tseries_ewma, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
+  {__Pyx_NAMESTR("ewma"), (PyCFunction)__pyx_pf_7tseries_ewma, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_ewma)},
   {__Pyx_NAMESTR("roll_var"), (PyCFunction)__pyx_pf_7tseries_roll_var, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("roll_skew"), (PyCFunction)__pyx_pf_7tseries_roll_skew, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("roll_kurt"), (PyCFunction)__pyx_pf_7tseries_roll_kurt, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
-  {__Pyx_NAMESTR("roll_median"), (PyCFunction)__pyx_pf_7tseries_roll_median, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
-  {__Pyx_NAMESTR("roll_max"), (PyCFunction)__pyx_pf_7tseries_roll_max, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
-  {__Pyx_NAMESTR("roll_min"), (PyCFunction)__pyx_pf_7tseries_roll_min, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
+  {__Pyx_NAMESTR("roll_median"), (PyCFunction)__pyx_pf_7tseries_roll_median, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_roll_median)},
+  {__Pyx_NAMESTR("roll_max"), (PyCFunction)__pyx_pf_7tseries_roll_max, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_roll_max)},
+  {__Pyx_NAMESTR("roll_min"), (PyCFunction)__pyx_pf_7tseries_roll_min, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_roll_min)},
   {__Pyx_NAMESTR("getFillVec"), (PyCFunction)__pyx_pf_7tseries_getFillVec, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("_backfill"), (PyCFunction)__pyx_pf_7tseries__backfill, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries__backfill)},
   {__Pyx_NAMESTR("_pad"), (PyCFunction)__pyx_pf_7tseries__pad, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries__pad)},
@@ -16760,8 +16854,6 @@ static struct PyMethodDef __pyx_methods[] = {
   {0, 0, 0, 0}
 };
 
-static void __pyx_init_filenames(void); /*proto*/
-
 #if PY_MAJOR_VERSION >= 3
 static struct PyModuleDef __pyx_moduledef = {
     PyModuleDef_HEAD_INIT,
@@ -16780,7 +16872,17 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_kp_s_1, __pyx_k_1, sizeof(__pyx_k_1), 0, 0, 1, 0},
   {&__pyx_kp_u_10, __pyx_k_10, sizeof(__pyx_k_10), 0, 1, 0, 0},
   {&__pyx_kp_u_11, __pyx_k_11, sizeof(__pyx_k_11), 0, 1, 0, 0},
+  {&__pyx_kp_u_12, __pyx_k_12, sizeof(__pyx_k_12), 0, 1, 0, 0},
+  {&__pyx_kp_u_13, __pyx_k_13, sizeof(__pyx_k_13), 0, 1, 0, 0},
+  {&__pyx_kp_u_14, __pyx_k_14, sizeof(__pyx_k_14), 0, 1, 0, 0},
+  {&__pyx_kp_u_15, __pyx_k_15, sizeof(__pyx_k_15), 0, 1, 0, 0},
+  {&__pyx_kp_u_16, __pyx_k_16, sizeof(__pyx_k_16), 0, 1, 0, 0},
+  {&__pyx_kp_u_17, __pyx_k_17, sizeof(__pyx_k_17), 0, 1, 0, 0},
+  {&__pyx_kp_u_18, __pyx_k_18, sizeof(__pyx_k_18), 0, 1, 0, 0},
+  {&__pyx_kp_u_19, __pyx_k_19, sizeof(__pyx_k_19), 0, 1, 0, 0},
   {&__pyx_kp_s_2, __pyx_k_2, sizeof(__pyx_k_2), 0, 0, 1, 0},
+  {&__pyx_kp_u_20, __pyx_k_20, sizeof(__pyx_k_20), 0, 1, 0, 0},
+  {&__pyx_kp_u_21, __pyx_k_21, sizeof(__pyx_k_21), 0, 1, 0, 0},
   {&__pyx_kp_s_3, __pyx_k_3, sizeof(__pyx_k_3), 0, 0, 1, 0},
   {&__pyx_kp_s_4, __pyx_k_4, sizeof(__pyx_k_4), 0, 0, 1, 0},
   {&__pyx_kp_s_5, __pyx_k_5, sizeof(__pyx_k_5), 0, 0, 1, 0},
@@ -16806,6 +16908,7 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s____ne__, __pyx_k____ne__, sizeof(__pyx_k____ne__), 0, 0, 1, 1},
   {&__pyx_n_s____pow__, __pyx_k____pow__, sizeof(__pyx_k____pow__), 0, 0, 1, 1},
   {&__pyx_n_s____sub__, __pyx_k____sub__, sizeof(__pyx_k____sub__), 0, 0, 1, 1},
+  {&__pyx_n_s____test__, __pyx_k____test__, sizeof(__pyx_k____test__), 0, 0, 1, 1},
   {&__pyx_n_s___backfill, __pyx_k___backfill, sizeof(__pyx_k___backfill), 0, 0, 1, 1},
   {&__pyx_n_s___pad, __pyx_k___pad, sizeof(__pyx_k___pad), 0, 0, 1, 1},
   {&__pyx_n_s__a, __pyx_k__a, sizeof(__pyx_k__a), 0, 0, 1, 1},
@@ -16823,6 +16926,7 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__buf, __pyx_k__buf, sizeof(__pyx_k__buf), 0, 0, 1, 1},
   {&__pyx_n_s__byteorder, __pyx_k__byteorder, sizeof(__pyx_k__byteorder), 0, 0, 1, 1},
   {&__pyx_n_s__com, __pyx_k__com, sizeof(__pyx_k__com), 0, 0, 1, 1},
+  {&__pyx_n_s__combineFunc, __pyx_k__combineFunc, sizeof(__pyx_k__combineFunc), 0, 0, 1, 1},
   {&__pyx_n_s__copy, __pyx_k__copy, sizeof(__pyx_k__copy), 0, 0, 1, 1},
   {&__pyx_n_s__data, __pyx_k__data, sizeof(__pyx_k__data), 0, 0, 1, 1},
   {&__pyx_n_s__date, __pyx_k__date, sizeof(__pyx_k__date), 0, 0, 1, 1},
@@ -16830,6 +16934,7 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__descr, __pyx_k__descr, sizeof(__pyx_k__descr), 0, 0, 1, 1},
   {&__pyx_n_s__dtype, __pyx_k__dtype, sizeof(__pyx_k__dtype), 0, 0, 1, 1},
   {&__pyx_n_s__empty, __pyx_k__empty, sizeof(__pyx_k__empty), 0, 0, 1, 1},
+  {&__pyx_n_s__ewma, __pyx_k__ewma, sizeof(__pyx_k__ewma), 0, 0, 1, 1},
   {&__pyx_n_s__expected_size, __pyx_k__expected_size, sizeof(__pyx_k__expected_size), 0, 0, 1, 1},
   {&__pyx_n_s__fields, __pyx_k__fields, sizeof(__pyx_k__fields), 0, 0, 1, 1},
   {&__pyx_n_s__fill, __pyx_k__fill, sizeof(__pyx_k__fill), 0, 0, 1, 1},
@@ -16845,15 +16950,17 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__int32, __pyx_k__int32, sizeof(__pyx_k__int32), 0, 0, 1, 1},
   {&__pyx_n_s__int64, __pyx_k__int64, sizeof(__pyx_k__int64), 0, 0, 1, 1},
   {&__pyx_n_s__int8, __pyx_k__int8, sizeof(__pyx_k__int8), 0, 0, 1, 1},
+  {&__pyx_n_s__isAllDates2, __pyx_k__isAllDates2, sizeof(__pyx_k__isAllDates2), 0, 0, 1, 1},
   {&__pyx_n_s__isnan, __pyx_k__isnan, sizeof(__pyx_k__isnan), 0, 0, 1, 1},
   {&__pyx_n_s__isnullobj, __pyx_k__isnullobj, sizeof(__pyx_k__isnullobj), 0, 0, 1, 1},
   {&__pyx_n_s__itemsize, __pyx_k__itemsize, sizeof(__pyx_k__itemsize), 0, 0, 1, 1},
   {&__pyx_n_s__k, __pyx_k__k, sizeof(__pyx_k__k), 0, 0, 1, 1},
   {&__pyx_n_s__kind, __pyx_k__kind, sizeof(__pyx_k__kind), 0, 0, 1, 1},
   {&__pyx_n_s__kth_smallest, __pyx_k__kth_smallest, sizeof(__pyx_k__kth_smallest), 0, 0, 1, 1},
+  {&__pyx_n_s__map_indices, __pyx_k__map_indices, sizeof(__pyx_k__map_indices), 0, 0, 1, 1},
   {&__pyx_n_s__mapper, __pyx_k__mapper, sizeof(__pyx_k__mapper), 0, 0, 1, 1},
   {&__pyx_n_s__maxlevels, __pyx_k__maxlevels, sizeof(__pyx_k__maxlevels), 0, 0, 1, 1},
-  {&__pyx_n_s__min, __pyx_k__min, sizeof(__pyx_k__min), 0, 0, 1, 1},
+  {&__pyx_n_s__median, __pyx_k__median, sizeof(__pyx_k__median), 0, 0, 1, 1},
   {&__pyx_n_s__minp, __pyx_k__minp, sizeof(__pyx_k__minp), 0, 0, 1, 1},
   {&__pyx_n_s__name, __pyx_k__name, sizeof(__pyx_k__name), 0, 0, 1, 1},
   {&__pyx_n_s__names, __pyx_k__names, sizeof(__pyx_k__names), 0, 0, 1, 1},
@@ -16876,6 +16983,9 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__range, __pyx_k__range, sizeof(__pyx_k__range), 0, 0, 1, 1},
   {&__pyx_n_s__readonly, __pyx_k__readonly, sizeof(__pyx_k__readonly), 0, 0, 1, 1},
   {&__pyx_n_s__remove, __pyx_k__remove, sizeof(__pyx_k__remove), 0, 0, 1, 1},
+  {&__pyx_n_s__roll_max, __pyx_k__roll_max, sizeof(__pyx_k__roll_max), 0, 0, 1, 1},
+  {&__pyx_n_s__roll_median, __pyx_k__roll_median, sizeof(__pyx_k__roll_median), 0, 0, 1, 1},
+  {&__pyx_n_s__roll_min, __pyx_k__roll_min, sizeof(__pyx_k__roll_min), 0, 0, 1, 1},
   {&__pyx_n_s__shape, __pyx_k__shape, sizeof(__pyx_k__shape), 0, 0, 1, 1},
   {&__pyx_n_s__size, __pyx_k__size, sizeof(__pyx_k__size), 0, 0, 1, 1},
   {&__pyx_n_s__strides, __pyx_k__strides, sizeof(__pyx_k__strides), 0, 0, 1, 1},
@@ -16892,13 +17002,12 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {0, 0, 0, 0, 0, 0, 0}
 };
 static int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_Exception = __Pyx_GetName(__pyx_b, __pyx_n_s__Exception); if (!__pyx_builtin_Exception) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_builtin_ValueError = __Pyx_GetName(__pyx_b, __pyx_n_s__ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_Exception = __Pyx_GetName(__pyx_b, __pyx_n_s__Exception); if (!__pyx_builtin_Exception) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_ValueError = __Pyx_GetName(__pyx_b, __pyx_n_s__ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_builtin_range = __Pyx_GetName(__pyx_b, __pyx_n_s__range); if (!__pyx_builtin_range) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_builtin_min = __Pyx_GetName(__pyx_b, __pyx_n_s__min); if (!__pyx_builtin_min) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_builtin_KeyError = __Pyx_GetName(__pyx_b, __pyx_n_s__KeyError); if (!__pyx_builtin_KeyError) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_builtin_object = __Pyx_GetName(__pyx_b, __pyx_n_s__object); if (!__pyx_builtin_object) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_builtin_RuntimeError = __Pyx_GetName(__pyx_b, __pyx_n_s__RuntimeError); if (!__pyx_builtin_RuntimeError) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_RuntimeError = __Pyx_GetName(__pyx_b, __pyx_n_s__RuntimeError); if (!__pyx_builtin_RuntimeError) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   return 0;
   __pyx_L1_error:;
   return -1;
@@ -16942,12 +17051,10 @@ PyMODINIT_FUNC PyInit_tseries(void)
   }
   __pyx_refnanny = __Pyx_RefNanny->SetupContext("PyMODINIT_FUNC PyInit_tseries(void)", __LINE__, __FILE__);
   #endif
-  __pyx_init_filenames();
   __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  #if PY_MAJOR_VERSION < 3
-  __pyx_empty_bytes = PyString_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  #else
   __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  #ifdef __pyx_binding_PyCFunctionType_USED
+  if (__pyx_binding_PyCFunctionType_init() < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   #endif
   /*--- Library function declarations ---*/
   /*--- Threads initialization code ---*/
@@ -16979,87 +17086,99 @@ PyMODINIT_FUNC PyInit_tseries(void)
   /*--- Global init code ---*/
   /*--- Function export code ---*/
   /*--- Type init code ---*/
-  __pyx_ptype_7tseries_datetime = __Pyx_ImportType("datetime", "datetime", sizeof(PyDateTime_DateTime), 0); if (unlikely(!__pyx_ptype_7tseries_datetime)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_7tseries_datetime = __Pyx_ImportType("datetime", "datetime", sizeof(PyDateTime_DateTime), 0); if (unlikely(!__pyx_ptype_7tseries_datetime)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (PyType_Ready(&__pyx_type_7tseries_Node) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (__Pyx_SetAttrString(__pyx_m, "Node", (PyObject *)&__pyx_type_7tseries_Node) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_ptype_7tseries_Node = &__pyx_type_7tseries_Node;
+  __pyx_vtabptr_7tseries_IndexableSkiplist = &__pyx_vtable_7tseries_IndexableSkiplist;
+  #if PY_MAJOR_VERSION >= 3
+  __pyx_vtable_7tseries_IndexableSkiplist.get = (PyObject *(*)(struct __pyx_obj_7tseries_IndexableSkiplist *, int, int __pyx_skip_dispatch))__pyx_f_7tseries_17IndexableSkiplist_get;
+  __pyx_vtable_7tseries_IndexableSkiplist.insert = (PyObject *(*)(struct __pyx_obj_7tseries_IndexableSkiplist *, double, int __pyx_skip_dispatch))__pyx_f_7tseries_17IndexableSkiplist_insert;
+  __pyx_vtable_7tseries_IndexableSkiplist.remove = (PyObject *(*)(struct __pyx_obj_7tseries_IndexableSkiplist *, double, int __pyx_skip_dispatch))__pyx_f_7tseries_17IndexableSkiplist_remove;
+  #else
+  *(void(**)(void))&__pyx_vtable_7tseries_IndexableSkiplist.get = (void(*)(void))__pyx_f_7tseries_17IndexableSkiplist_get;
+  *(void(**)(void))&__pyx_vtable_7tseries_IndexableSkiplist.insert = (void(*)(void))__pyx_f_7tseries_17IndexableSkiplist_insert;
+  *(void(**)(void))&__pyx_vtable_7tseries_IndexableSkiplist.remove = (void(*)(void))__pyx_f_7tseries_17IndexableSkiplist_remove;
+  #endif
   if (PyType_Ready(&__pyx_type_7tseries_IndexableSkiplist) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (__Pyx_SetVtable(__pyx_type_7tseries_IndexableSkiplist.tp_dict, __pyx_vtabptr_7tseries_IndexableSkiplist) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (__Pyx_SetAttrString(__pyx_m, "IndexableSkiplist", (PyObject *)&__pyx_type_7tseries_IndexableSkiplist) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_ptype_7tseries_IndexableSkiplist = &__pyx_type_7tseries_IndexableSkiplist;
   /*--- Type import code ---*/
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType("numpy", "dtype", sizeof(PyArray_Descr), 0); if (unlikely(!__pyx_ptype_5numpy_dtype)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType("numpy", "flatiter", sizeof(PyArrayIterObject), 0); if (unlikely(!__pyx_ptype_5numpy_flatiter)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType("numpy", "broadcast", sizeof(PyArrayMultiIterObject), 0); if (unlikely(!__pyx_ptype_5numpy_broadcast)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType("numpy", "ndarray", sizeof(PyArrayObject), 0); if (unlikely(!__pyx_ptype_5numpy_ndarray)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType("numpy", "ufunc", sizeof(PyUFuncObject), 0); if (unlikely(!__pyx_ptype_5numpy_ufunc)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 848; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType("numpy", "dtype", sizeof(PyArray_Descr), 0); if (unlikely(!__pyx_ptype_5numpy_dtype)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType("numpy", "flatiter", sizeof(PyArrayIterObject), 0); if (unlikely(!__pyx_ptype_5numpy_flatiter)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType("numpy", "broadcast", sizeof(PyArrayMultiIterObject), 0); if (unlikely(!__pyx_ptype_5numpy_broadcast)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType("numpy", "ndarray", sizeof(PyArrayObject), 0); if (unlikely(!__pyx_ptype_5numpy_ndarray)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType("numpy", "ufunc", sizeof(PyUFuncObject), 0); if (unlikely(!__pyx_ptype_5numpy_ufunc)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 849; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "bool", sizeof(PyBoolObject), 0); if (unlikely(!__pyx_ptype_7cpython_4bool_bool)) {__pyx_filename = __pyx_f[10]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   /*--- Function import code ---*/
   /*--- Execution code ---*/
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":9
- * from python_float cimport PyFloat_Check
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":10
+ * from cpython cimport PyFloat_Check
  * 
  * import numpy as np             # <<<<<<<<<<<<<<
  * isnan = np.isnan
  * cdef double NaN = <double> np.NaN
  */
-  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__numpy), 0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__numpy), 0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__np, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__np, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":10
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":11
  * 
  * import numpy as np
  * isnan = np.isnan             # <<<<<<<<<<<<<<
  * cdef double NaN = <double> np.NaN
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__isnan); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__isnan); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__isnan, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__isnan, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":11
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":12
  * import numpy as np
  * isnan = np.isnan
  * cdef double NaN = <double> np.NaN             # <<<<<<<<<<<<<<
  * 
  * from datetime import datetime as pydatetime
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__NaN); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__NaN); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_7tseries_NaN = ((double)__pyx_t_3);
+  __pyx_v_7tseries_NaN = __pyx_t_3;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":13
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":14
  * cdef double NaN = <double> np.NaN
  * 
  * from datetime import datetime as pydatetime             # <<<<<<<<<<<<<<
  * 
  * cdef inline object trycall(object func, object arg):
  */
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
   __Pyx_INCREF(((PyObject *)__pyx_n_s__datetime));
   PyList_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__datetime));
   __Pyx_GIVEREF(((PyObject *)__pyx_n_s__datetime));
-  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s__datetime), ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s__datetime), ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__datetime); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__datetime); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__pydatetime, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__pydatetime, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":82
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":83
  * 
  * # import datetime C API
  * PyDateTime_IMPORT             # <<<<<<<<<<<<<<
@@ -17068,7 +17187,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   PyDateTime_IMPORT;
 
-  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":85
+  /* "/home/wesm/code/pandas/pandas/lib/src/common.pyx":86
  * 
  * # initialize numpy
  * import_array()             # <<<<<<<<<<<<<<
@@ -17077,7 +17196,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   import_array();
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":23
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":23
  * cimport numpy as np
  * from numpy cimport *
  * import numpy as np             # <<<<<<<<<<<<<<
@@ -17089,7 +17208,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__np, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":25
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":25
  * import numpy as np
  * 
  * from random import random             # <<<<<<<<<<<<<<
@@ -17110,7 +17229,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":28
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":28
  * 
  * # initialize numpy
  * import_array()             # <<<<<<<<<<<<<<
@@ -17119,7 +17238,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   import_array();
 
-  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":46
+  /* "/home/wesm/code/pandas/pandas/lib/src/skiplist.pyx":46
  *         self.width = <int *> width.data
  * 
  * NIL = Node(np.inf, [], np.array([])) # Singleton terminator node             # <<<<<<<<<<<<<<
@@ -17166,7 +17285,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__NIL, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":2
+  /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":2
  * 
  * cdef double INF = <double> np.inf             # <<<<<<<<<<<<<<
  * cdef double NEGINF = -INF
@@ -17179,9 +17298,9 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_v_7tseries_INF = ((double)__pyx_t_3);
+  __pyx_v_7tseries_INF = __pyx_t_3;
 
-  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":3
+  /* "/home/wesm/code/pandas/pandas/lib/src/isnull.pyx":3
  * 
  * cdef double INF = <double> np.inf
  * cdef double NEGINF = -INF             # <<<<<<<<<<<<<<
@@ -17190,14 +17309,14 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   __pyx_v_7tseries_NEGINF = (-__pyx_v_7tseries_INF);
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":1
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":1
  * cdef int _EPOCH_ORD = 719163             # <<<<<<<<<<<<<<
  * 
  * from datetime import date as pydate
  */
   __pyx_v_7tseries__EPOCH_ORD = 719163;
 
-  /* "H:\workspace\pandas\pandas\lib\src\io.pyx":3
+  /* "/home/wesm/code/pandas/pandas/lib/src/io.pyx":3
  * cdef int _EPOCH_ORD = 719163
  * 
  * from datetime import date as pydate             # <<<<<<<<<<<<<<
@@ -17218,10 +17337,91 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\python_dict.pxd":1
- * from python_ref cimport PyObject             # <<<<<<<<<<<<<<
+  /* "/home/wesm/code/pandas/pandas/lib/src/tseries.pyx":1
+ * include "common.pyx"             # <<<<<<<<<<<<<<
+ * include "skiplist.pyx"
+ * include "isnull.pyx"
+ */
+  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
+  __pyx_t_6 = PyObject_GetAttr(__pyx_m, __pyx_n_s__map_indices); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_1 = __Pyx_GetAttrString(__pyx_t_6, "__doc__"); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_12), __pyx_t_1) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_GetAttr(__pyx_m, __pyx_n_s__isAllDates2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_6 = __Pyx_GetAttrString(__pyx_t_1, "__doc__"); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_13), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = PyObject_GetAttr(__pyx_m, __pyx_n_s__median); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_1 = __Pyx_GetAttrString(__pyx_t_6, "__doc__"); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_14), __pyx_t_1) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_GetAttr(__pyx_m, __pyx_n_s__ewma); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_6 = __Pyx_GetAttrString(__pyx_t_1, "__doc__"); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_15), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = PyObject_GetAttr(__pyx_m, __pyx_n_s__roll_median); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_1 = __Pyx_GetAttrString(__pyx_t_6, "__doc__"); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_16), __pyx_t_1) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_GetAttr(__pyx_m, __pyx_n_s__roll_max); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_6 = __Pyx_GetAttrString(__pyx_t_1, "__doc__"); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_17), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = PyObject_GetAttr(__pyx_m, __pyx_n_s__roll_min); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_1 = __Pyx_GetAttrString(__pyx_t_6, "__doc__"); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_18), __pyx_t_1) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_GetAttr(__pyx_m, __pyx_n_s___backfill); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_6 = __Pyx_GetAttrString(__pyx_t_1, "__doc__"); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_19), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = PyObject_GetAttr(__pyx_m, __pyx_n_s___pad); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_1 = __Pyx_GetAttrString(__pyx_t_6, "__doc__"); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_20), __pyx_t_1) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_GetAttr(__pyx_m, __pyx_n_s__combineFunc); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_6 = __Pyx_GetAttrString(__pyx_t_1, "__doc__"); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_kp_u_21), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s____test__, ((PyObject *)__pyx_t_4)) < 0) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
+
+  /* "/usr/lib/epd-6.2/lib/python2.6/site-packages/Cython-0.13-py2.6-linux-x86_64.egg/Cython/Includes/cpython/type.pxd":2
+ * 
+ * cdef extern from "Python.h":             # <<<<<<<<<<<<<<
+ *     # The C structure of the objects used to describe built-in types.
  * 
- * cdef extern from "Python.h":
  */
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -17245,23 +17445,14 @@ PyMODINIT_FUNC PyInit_tseries(void)
   #endif
 }
 
-static const char *__pyx_filenames[] = {
-  "common.pyx",
-  "skiplist.pyx",
-  "io.pyx",
-  "isnull.pyx",
-  "groupby.pyx",
-  "moments.pyx",
-  "reindex.pyx",
-  "operators.pyx",
-  "numpy.pxd",
-  "tseries.pyx",
-};
-
 /* Runtime support code */
 
-static void __pyx_init_filenames(void) {
-  __pyx_f = __pyx_filenames;
+static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
+    PyObject *result;
+    result = PyObject_GetAttr(dict, name);
+    if (!result)
+        PyErr_SetObject(PyExc_NameError, name);
+    return result;
 }
 
 static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb) {
@@ -17310,6 +17501,26 @@ bad:
 }
 
 
+static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
+    const char *name, int exact)
+{
+    if (!type) {
+        PyErr_Format(PyExc_SystemError, "Missing type object");
+        return 0;
+    }
+    if (none_allowed && obj == Py_None) return 1;
+    else if (exact) {
+        if (Py_TYPE(obj) == type) return 1;
+    }
+    else {
+        if (PyObject_TypeCheck(obj, type)) return 1;
+    }
+    PyErr_Format(PyExc_TypeError,
+        "Argument '%s' has incorrect type (expected %s, got %s)",
+        name, type->tp_name, Py_TYPE(obj)->tp_name);
+    return 0;
+}
+
 static CYTHON_INLINE int __Pyx_IsLittleEndian(void) {
   unsigned int n = 1;
   return *(unsigned char*)(&n) != 0;
@@ -17715,7 +17926,7 @@ static CYTHON_INLINE void __Pyx_ZeroBuffer(Py_buffer* buf) {
   buf->suboffsets = __Pyx_minusones;
 }
 
-static int __Pyx_GetBufferAndValidate(Py_buffer* buf, PyObject* obj, __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack) {
+static CYTHON_INLINE int __Pyx_GetBufferAndValidate(Py_buffer* buf, PyObject* obj, __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack) {
   if (obj == Py_None) {
     __Pyx_ZeroBuffer(buf);
     return 0;
@@ -17932,6 +18143,10 @@ static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
 }
 
+static CYTHON_INLINE void __Pyx_RaiseNoneIndexingError(void) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is unsubscriptable");
+}
+
 static CYTHON_INLINE long __Pyx_mod_long(long a, long b) {
     long r = a % b;
     r += ((r != 0) & ((r ^ b) < 0)) * b;
@@ -17955,8 +18170,13 @@ static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
                  (index == 1) ? "" : "s");
 }
 
-static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(void) {
-    PyErr_SetString(PyExc_ValueError, "too many values to unpack");
+static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
+    PyErr_Format(PyExc_ValueError,
+        #if PY_VERSION_HEX < 0x02050000
+            "too many values to unpack (expected %d)", (int)expected);
+        #else
+            "too many values to unpack (expected %zd)", expected);
+        #endif
 }
 
 static PyObject *__Pyx_UnpackItem(PyObject *iter, Py_ssize_t index) {
@@ -17969,11 +18189,11 @@ static PyObject *__Pyx_UnpackItem(PyObject *iter, Py_ssize_t index) {
     return item;
 }
 
-static int __Pyx_EndUnpack(PyObject *iter) {
+static int __Pyx_EndUnpack(PyObject *iter, Py_ssize_t expected) {
     PyObject *item;
     if ((item = PyIter_Next(iter))) {
         Py_DECREF(item);
-        __Pyx_RaiseTooManyValuesError();
+        __Pyx_RaiseTooManyValuesError(expected);
         return -1;
     }
     else if (!PyErr_Occurred())
@@ -17988,28 +18208,8 @@ static void __Pyx_UnpackTupleError(PyObject *t, Py_ssize_t index) {
     } else if (PyTuple_GET_SIZE(t) < index) {
       __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(t));
     } else {
-      __Pyx_RaiseTooManyValuesError();
-    }
-}
-
-static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
-    const char *name, int exact)
-{
-    if (!type) {
-        PyErr_Format(PyExc_SystemError, "Missing type object");
-        return 0;
-    }
-    if (none_allowed && obj == Py_None) return 1;
-    else if (exact) {
-        if (Py_TYPE(obj) == type) return 1;
-    }
-    else {
-        if (PyObject_TypeCheck(obj, type)) return 1;
+      __Pyx_RaiseTooManyValuesError(index);
     }
-    PyErr_Format(PyExc_TypeError,
-        "Argument '%s' has incorrect type (expected %s, got %s)",
-        name, type->tp_name, Py_TYPE(obj)->tp_name);
-    return 0;
 }
 
 static CYTHON_INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb) {
@@ -18061,14 +18261,14 @@ if (PyObject_TypeCheck(obj, __pyx_ptype_5numpy_ndarray)) __pyx_pf_5numpy_7ndarra
 #endif
 
 static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
-    PyObject *__import__ = 0;
+    PyObject *py_import = 0;
     PyObject *empty_list = 0;
     PyObject *module = 0;
     PyObject *global_dict = 0;
     PyObject *empty_dict = 0;
     PyObject *list;
-    __import__ = __Pyx_GetAttrString(__pyx_b, "__import__");
-    if (!__import__)
+    py_import = __Pyx_GetAttrString(__pyx_b, "__import__");
+    if (!py_import)
         goto bad;
     if (from_list)
         list = from_list;
@@ -18084,23 +18284,15 @@ static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
     empty_dict = PyDict_New();
     if (!empty_dict)
         goto bad;
-    module = PyObject_CallFunctionObjArgs(__import__,
+    module = PyObject_CallFunctionObjArgs(py_import,
         name, global_dict, empty_dict, list, NULL);
 bad:
     Py_XDECREF(empty_list);
-    Py_XDECREF(__import__);
+    Py_XDECREF(py_import);
     Py_XDECREF(empty_dict);
     return module;
 }
 
-static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
-    PyObject *result;
-    result = PyObject_GetAttr(dict, name);
-    if (!result)
-        PyErr_SetObject(PyExc_NameError, name);
-    return result;
-}
-
 #if PY_MAJOR_VERSION < 3
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
     Py_XINCREF(type);
@@ -18212,8 +18404,8 @@ bad:
 #endif
 
 static CYTHON_INLINE npy_int32 __Pyx_PyInt_from_py_npy_int32(PyObject* x) {
-    const npy_int32 neg_one = (npy_int32)-1, const_zero = 0;
-    const int is_unsigned = neg_one > const_zero;
+    const npy_int32 neg_one = (npy_int32)-1, const_zero = (npy_int32)0;
+    const int is_unsigned = const_zero < neg_one;
     if (sizeof(npy_int32) == sizeof(char)) {
         if (is_unsigned)
             return (npy_int32)__Pyx_PyInt_AsUnsignedChar(x);
@@ -18239,34 +18431,52 @@ static CYTHON_INLINE npy_int32 __Pyx_PyInt_from_py_npy_int32(PyObject* x) {
             return (npy_int32)__Pyx_PyInt_AsUnsignedLongLong(x);
         else
             return (npy_int32)__Pyx_PyInt_AsSignedLongLong(x);
-#if 0
-    } else if (sizeof(npy_int32) > sizeof(short) &&
-               sizeof(npy_int32) < sizeof(int)) { /*  __int32 ILP64 ? */
-        if (is_unsigned)
-            return (npy_int32)__Pyx_PyInt_AsUnsignedInt(x);
-        else
-            return (npy_int32)__Pyx_PyInt_AsSignedInt(x);
-#endif
+    }  else {
+        npy_int32 val;
+        PyObject *v = __Pyx_PyNumber_Int(x);
+        #if PY_VERSION_HEX < 0x03000000
+        if (likely(v) && !PyLong_Check(v)) {
+            PyObject *tmp = v;
+            v = PyNumber_Long(tmp);
+            Py_DECREF(tmp);
+        }
+        #endif
+        if (likely(v)) {
+            int one = 1; int is_little = (int)*(unsigned char *)&one;
+            unsigned char *bytes = (unsigned char *)&val;
+            int ret = _PyLong_AsByteArray((PyLongObject *)v,
+                                          bytes, sizeof(val),
+                                          is_little, !is_unsigned);
+            Py_DECREF(v);
+            if (likely(!ret))
+                return val;
+        }
+        return (npy_int32)-1;
     }
-    PyErr_SetString(PyExc_TypeError, "npy_int32");
-    return (npy_int32)-1;
 }
 
 static CYTHON_INLINE PyObject *__Pyx_PyInt_to_py_npy_int64(npy_int64 val) {
-    const npy_int64 neg_one = (npy_int64)-1, const_zero = 0;
-    const int is_unsigned = neg_one > const_zero;
-    if (sizeof(npy_int64) <  sizeof(long)) {
+    const npy_int64 neg_one = (npy_int64)-1, const_zero = (npy_int64)0;
+    const int is_unsigned = const_zero < neg_one;
+    if ((sizeof(npy_int64) == sizeof(char))  ||
+        (sizeof(npy_int64) == sizeof(short))) {
         return PyInt_FromLong((long)val);
-    } else if (sizeof(npy_int64) == sizeof(long)) {
+    } else if ((sizeof(npy_int64) == sizeof(int)) ||
+               (sizeof(npy_int64) == sizeof(long))) {
         if (is_unsigned)
             return PyLong_FromUnsignedLong((unsigned long)val);
         else
             return PyInt_FromLong((long)val);
-    } else { /* (sizeof(npy_int64) > sizeof(long)) */
+    } else if (sizeof(npy_int64) == sizeof(PY_LONG_LONG)) {
         if (is_unsigned)
             return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG)val);
         else
             return PyLong_FromLongLong((PY_LONG_LONG)val);
+    } else {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&val;
+        return _PyLong_FromByteArray(bytes, sizeof(npy_int64), 
+                                     little, !is_unsigned);
     }
 }
 
@@ -18591,6 +18801,25 @@ static CYTHON_INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject* x) {
     return (signed int)__Pyx_PyInt_AsSignedLong(x);
 }
 
+static CYTHON_INLINE int __Pyx_PyInt_AsLongDouble(PyObject* x) {
+    const int neg_one = (int)-1, const_zero = 0;
+    const int is_unsigned = neg_one > const_zero;
+    if (sizeof(int) < sizeof(long)) {
+        long val = __Pyx_PyInt_AsLong(x);
+        if (unlikely(val != (long)(int)val)) {
+            if (!unlikely(val == -1 && PyErr_Occurred())) {
+                PyErr_SetString(PyExc_OverflowError,
+                    (is_unsigned && unlikely(val < 0)) ?
+                    "can't convert negative value to int" :
+                    "value too large to convert to int");
+            }
+            return (int)-1;
+        }
+        return (int)val;
+    }
+    return (int)__Pyx_PyInt_AsLong(x);
+}
+
 static CYTHON_INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject* x) {
     const unsigned long neg_one = (unsigned long)-1, const_zero = 0;
     const int is_unsigned = neg_one > const_zero;
@@ -18820,8 +19049,8 @@ static void __Pyx_WriteUnraisable(const char *name) {
 }
 
 static CYTHON_INLINE npy_int64 __Pyx_PyInt_from_py_npy_int64(PyObject* x) {
-    const npy_int64 neg_one = (npy_int64)-1, const_zero = 0;
-    const int is_unsigned = neg_one > const_zero;
+    const npy_int64 neg_one = (npy_int64)-1, const_zero = (npy_int64)0;
+    const int is_unsigned = const_zero < neg_one;
     if (sizeof(npy_int64) == sizeof(char)) {
         if (is_unsigned)
             return (npy_int64)__Pyx_PyInt_AsUnsignedChar(x);
@@ -18847,17 +19076,28 @@ static CYTHON_INLINE npy_int64 __Pyx_PyInt_from_py_npy_int64(PyObject* x) {
             return (npy_int64)__Pyx_PyInt_AsUnsignedLongLong(x);
         else
             return (npy_int64)__Pyx_PyInt_AsSignedLongLong(x);
-#if 0
-    } else if (sizeof(npy_int64) > sizeof(short) &&
-               sizeof(npy_int64) < sizeof(int)) { /*  __int32 ILP64 ? */
-        if (is_unsigned)
-            return (npy_int64)__Pyx_PyInt_AsUnsignedInt(x);
-        else
-            return (npy_int64)__Pyx_PyInt_AsSignedInt(x);
-#endif
+    }  else {
+        npy_int64 val;
+        PyObject *v = __Pyx_PyNumber_Int(x);
+        #if PY_VERSION_HEX < 0x03000000
+        if (likely(v) && !PyLong_Check(v)) {
+            PyObject *tmp = v;
+            v = PyNumber_Long(tmp);
+            Py_DECREF(tmp);
+        }
+        #endif
+        if (likely(v)) {
+            int one = 1; int is_little = (int)*(unsigned char *)&one;
+            unsigned char *bytes = (unsigned char *)&val;
+            int ret = _PyLong_AsByteArray((PyLongObject *)v,
+                                          bytes, sizeof(val),
+                                          is_little, !is_unsigned);
+            Py_DECREF(v);
+            if (likely(!ret))
+                return val;
+        }
+        return (npy_int64)-1;
     }
-    PyErr_SetString(PyExc_TypeError, "npy_int64");
-    return (npy_int64)-1;
 }
 
 #ifndef __PYX_HAVE_RT_ImportType
@@ -18897,7 +19137,11 @@ static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class
         PyOS_snprintf(warning, sizeof(warning), 
             "%s.%s size changed, may indicate binary incompatibility",
             module_name, class_name);
+        #if PY_VERSION_HEX < 0x02050000
+        PyErr_Warn(NULL, warning);
+        #else
         PyErr_WarnEx(NULL, warning, 0);
+        #endif
     }
     else if (((PyTypeObject *)result)->tp_basicsize != size) {
         PyErr_Format(PyExc_ValueError, 
@@ -18935,6 +19179,23 @@ bad:
 }
 #endif
 
+static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
+#if PY_VERSION_HEX >= 0x02070000 && !(PY_MAJOR_VERSION==3&&PY_MINOR_VERSION==0)
+    PyObject *ob = PyCapsule_New(vtable, 0, 0);
+#else
+    PyObject *ob = PyCObject_FromVoidPtr(vtable, 0);
+#endif
+    if (!ob)
+        goto bad;
+    if (PyDict_SetItemString(dict, "__pyx_vtable__", ob) < 0)
+        goto bad;
+    Py_DECREF(ob);
+    return 0;
+bad:
+    Py_XDECREF(ob);
+    return -1;
+}
+
 #include "compile.h"
 #include "frameobject.h"
 #include "traceback.h"
@@ -19038,8 +19299,8 @@ static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
 /* Type Conversion Functions */
 
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
-   if (x == Py_True) return 1;
-   else if ((x == Py_False) | (x == Py_None)) return 0;
+   int is_true = x == Py_True;
+   if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
    else return PyObject_IsTrue(x);
 }
 
diff --git a/pandas/rpy/common.py b/pandas/rpy/common.py
index ab65fa2c9..6d8ee6de8 100644
--- a/pandas/rpy/common.py
+++ b/pandas/rpy/common.py
@@ -5,7 +5,8 @@ developer-friendly.
 
 import numpy as np
 
-from pandas import DataFrame, DataMatrix
+import pandas as pandas
+import pandas.util.testing as _test
 
 from rpy2.robjects.packages import importr
 from rpy2.robjects import r
@@ -13,12 +14,18 @@ import rpy2.robjects as robj
 
 __all__ = ['convert_robj', 'load_data']
 
-def load_data(name, package=None):
+def load_data(name, package=None, convert=True):
     if package:
         pack = importr(package)
 
     r.data(name)
-    return convert_robj(r[name])
+
+    robj = r[name]
+
+    if convert:
+        return convert_robj(robj)
+    else:
+        return robj
 
 def _rclass(obj):
     """
@@ -30,10 +37,14 @@ def _is_null(obj):
     return _rclass(obj) == 'NULL'
 
 def _convert_list(obj):
-    pass
+    """
+    Convert named Vector to dict
+    """
+    values = [convert_robj(x) for x in obj]
+    return dict(zip(obj.names, values))
 
-def _convert_named_list(obj):
-    pass
+def _convert_vector(obj):
+    return list(obj)
 
 def _convert_DataFrame(rdf):
     columns = list(rdf.colnames)
@@ -44,16 +55,18 @@ def _convert_DataFrame(rdf):
         vec = rdf.rx2(i + 1)
         data[col] = list(vec)
 
-    return DataFrame(data, index=rows)
+    return pandas.DataFrame(data, index=_check_int(rows))
 
 def _convert_Matrix(mat):
     columns = mat.colnames
     rows = mat.rownames
 
     columns = None if _is_null(columns) else list(columns)
-    index = None if _is_null(index) else list(index)
+    index = None if _is_null(rows) else list(rows)
 
-    return DataMatrix(np.array(mat), index=index, columns=columns)
+    return pandas.DataMatrix(np.array(mat),
+                             index=_check_int(index),
+                             columns=columns)
 
 def _check_int(vec):
     try:
@@ -67,6 +80,9 @@ def _check_int(vec):
 _converters = [
     (robj.DataFrame , _convert_DataFrame),
     (robj.Matrix , _convert_Matrix),
+    (robj.StrVector, _convert_vector),
+    (robj.FloatVector, _convert_vector),
+    (robj.Vector, _convert_list),
 ]
 
 def convert_robj(obj):
@@ -81,31 +97,41 @@ def convert_robj(obj):
     -------
     Non-rpy data structure, mix of NumPy and pandas objects
     """
-    if not isinstance(obj, orbj.RObjectMixin):
+    if not isinstance(obj, robj.RObjectMixin):
         return obj
 
     for rpy_type, converter in _converters:
         if isinstance(obj, rpy_type):
             return converter(obj)
 
-    raise Exception('Do not know what to do with %s object' % klass)
-
-
-import pandas.util.testing as _test
+    raise Exception('Do not know what to do with %s object' % type(obj))
 
 def test_convert_list():
     obj = r('list(a=1, b=2, c=3)')
+
+    converted = convert_robj(obj)
+    expected = {'a' : [1], 'b' : [2], 'c' : [3]}
+
+    _test.assert_dict_equal(converted, expected)
+
+def test_convert_nested_list():
+    obj = r('list(a=list(foo=1, bar=2))')
+
     converted = convert_robj(obj)
+    expected = {'a' : {'foo' : [1], 'bar' : [2]}}
 
-    _test.assert_dict_equal
+    _test.assert_dict_equal(converted, expected)
 
 def test_convert_frame():
     # built-in dataset
     df = r['faithful']
 
-    converted = convert_robj(obj)
+    converted = convert_robj(df)
+
+    assert np.array_equal(converted.columns, ['eruptions', 'waiting'])
+    assert np.array_equal(converted.index, np.arange(1, 273))
 
-def _named_matrix():
+def _test_matrix():
     r('mat <- matrix(rnorm(9), ncol=3)')
     r('colnames(mat) <- c("one", "two", "three")')
     r('rownames(mat) <- c("a", "b", "c")')
@@ -113,14 +139,13 @@ def _named_matrix():
     return r['mat']
 
 def test_convert_matrix():
-    mat = _named_matrix()
+    mat = _test_matrix()
 
     converted = convert_robj(mat)
 
     assert np.array_equal(converted.index, ['a', 'b', 'c'])
     assert np.array_equal(converted.columns, ['one', 'two', 'three'])
 
-def test_convert_nested():
-    pass
-
 
+if __name__ == '__main__':
+    pass
diff --git a/pandas/stats/tests/test_var.py b/pandas/stats/tests/test_var.py
index c6930de68..8c8d34fd0 100644
--- a/pandas/stats/tests/test_var.py
+++ b/pandas/stats/tests/test_var.py
@@ -1,19 +1,62 @@
+
+import rpy2.robjects as robj
 from rpy2.robjects import r
 from rpy2.robjects.packages import importr
+import pandas.rpy.common as rpy
+
+import scikits.statsmodels.tsa.var as sm_var
+import pandas.stats.var as pvar
 
 vars = importr('vars')
 urca = importr('urca')
 
 class RVAR(object):
-    pass
+    """
+    Estimates VAR model using R vars package and rpy
+    """
+
+    def __init__(self, data, p=1, type='both'):
+        self.rdata = data
+        self.p = p
+        self.type = type
+
+        self.pydata = rpy.convert_robj(data)
+
+        self._estimate = None
+
+        self.estimate()
+
+    def summary(self, equation=None):
+        print r.summary(self._estimate, equation=equation)
+
+    def output(self):
+        print self._estimate
+
+    def estimate(self):
+        self._estimate = r.VAR(self.rdata, p=self.p, type=self.type)
+
+    def plot(self, names=None):
+        r.plot(model._estimate, names=names)
+
+    def serial_test(self, lags_pt=16, type='PT.asymptotic'):
+        f = r['serial.test']
+
+        test = f(self._estimate, **{'lags.pt' : lags_pt,
+                                    'type' : type})
+
+        return test
+
+    @property
+    def beta(self):
+        return rpy.convert_robj(r.coef(self._estimate))
+
+    def data_summary(self):
+        print r.summary(self.rdata)
 
 if __name__ == '__main__':
-    r.data("Canada")
-    can = r['Canada']
-    p1ct = r('p1ct <- VAR(Canada, p=1, type="both")')
-    coefs = r('coefs <- coef(p1ct)')
+    canada = rpy.load_data('Canada', package='vars', convert=False)
 
-    ecoef = coefs.rx2('e')
+    model = RVAR(canada, p=1)
 
     # summary(Canada)
 
diff --git a/pandas/util/testing.py b/pandas/util/testing.py
index 141afba8c..0e803a5fb 100644
--- a/pandas/util/testing.py
+++ b/pandas/util/testing.py
@@ -3,6 +3,7 @@
 from datetime import datetime
 import random
 import string
+import sys
 
 from numpy.random import randn
 import numpy as np
@@ -13,14 +14,28 @@ from pandas.core.api import (DateRange, Index, Series, DataFrame,
 N = 30
 K = 4
 
+def rands(n):
+    choices = string.letters + string.digits
+    return ''.join([random.choice(choices) for _ in xrange(n)])
+
+#-------------------------------------------------------------------------------
+# Console debugging tools
+
 def debug(f, *args, **kwargs):
     from IPython.Debugger import Pdb
     Pdb(color_scheme='Linux').set_trace()
     return f(*args, **kwargs)
 
-def rands(n):
-    choices = string.letters + string.digits
-    return ''.join([random.choice(choices) for _ in xrange(n)])
+def set_trace():
+    from IPython.Debugger import Pdb
+    try:
+        Pdb(color_scheme='Linux').set_trace(sys._getframe().f_back)
+    except:
+        from pdb import Pdb as OldPdb
+        OldPdb().set_trace(sys._getframe().f_back)
+
+#-------------------------------------------------------------------------------
+# Comparators
 
 def equalContents(arr1, arr2):
     """Checks if the set of unique elements of arr1 and arr2 are equivalent.
@@ -31,6 +46,9 @@ def isiterable(obj):
     return hasattr(obj, '__iter__')
 
 def assert_almost_equal(a, b):
+    if isinstance(a, dict) or isinstance(b, dict):
+        return assert_dict_equal(a, b)
+
     if isiterable(a):
         np.testing.assert_(isiterable(b))
         np.testing.assert_equal(len(a), len(b))
