commit 46af33538ce3a56ad3e4da9904a6c7c9d296338f
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed Nov 2 12:25:55 2011 -0400

    ENH: Cython ismember function for Series.isin, really fast

diff --git a/pandas/core/series.py b/pandas/core/series.py
index a2d662a7e..fb5df8052 100644
--- a/pandas/core/series.py
+++ b/pandas/core/series.py
@@ -1628,7 +1628,9 @@ copy : boolean, default False
         isin : Series (boolean dtype)
         """
         value_set = set(values)
-        return self.map(value_set.__contains__)
+        result = lib.ismember(self, value_set)
+        # return self.map(value_set.__contains__)
+        return Series(result, self.index, name=self.name)
 
 #-------------------------------------------------------------------------------
 # Miscellaneous
diff --git a/pandas/src/tseries.pyx b/pandas/src/tseries.pyx
index 3caab8eb4..04f3a404c 100644
--- a/pandas/src/tseries.pyx
+++ b/pandas/src/tseries.pyx
@@ -164,6 +164,26 @@ def isAllDates(ndarray[object, ndim=1] arr):
 
     return True
 
+def ismember(ndarray arr, set values):
+    cdef:
+        Py_ssize_t i, n
+        flatiter it
+        ndarray[uint8_t] result
+        object val
+
+    it = <flatiter> PyArray_IterNew(arr)
+    n = len(arr)
+    result = np.empty(n, dtype=np.uint8)
+    for i from 0 <= i < n:
+        val = PyArray_GETITEM(arr, PyArray_ITER_DATA(it))
+        if val in values:
+            result[i] = 1
+        else:
+            result[i] = 0
+        PyArray_ITER_NEXT(it)
+
+    return result.view(np.bool_)
+
 #----------------------------------------------------------------------
 # datetime / io related
 
