commit 0a36dd58eb9873b9f240f95eb5f14ff8efd0c0f9
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Tue May 8 15:13:40 2012 -0400

    BUG: raise TypeError when comparing None with float series, unit test to close #1079

diff --git a/pandas/core/series.py b/pandas/core/series.py
index 2210ed612..c233567ae 100644
--- a/pandas/core/series.py
+++ b/pandas/core/series.py
@@ -115,6 +115,10 @@ def _comp_method(op, name):
             return NotImplemented
         else:
             # scalars
+            res = na_op(self.values, other)
+            if np.isscalar(res):
+                raise TypeError('Could not compare %s type with Series'
+                                % type(other))
             return Series(na_op(self.values, other),
                           index=self.index, name=self.name)
     return wrapper
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 561dc1e3c..bc587f508 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -2544,6 +2544,12 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         assert_frame_equal(df[mask_b], df.ix[0:0,:])
         assert_frame_equal(df[-mask_b], df.ix[1:1,:])
 
+    def test_float_none_comparison(self):
+        df = DataFrame(np.random.randn(8, 3), index=range(8),
+                       columns=['A', 'B', 'C'])
+
+        self.assertRaises(TypeError, df.__eq__, None)
+
     def test_to_csv_from_csv(self):
         path = '__tmp__'
 
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index 2e948890f..632405723 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -164,6 +164,11 @@ class TestNanops(unittest.TestCase):
 
         assert_almost_equal(result, expected)
 
+    def test_none_comparison(self):
+        # bug brought up by #1079
+        s = Series(np.random.randn(10), index=range(0, 20, 2))
+        self.assertRaises(TypeError, s.__eq__, None)
+
     def test_sum_zero(self):
         arr = np.array([])
         self.assert_(nanops.nansum(arr) == 0)
