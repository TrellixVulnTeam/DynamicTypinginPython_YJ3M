commit 0d8b44f5370c6274f1915de1a5f9029a944a8562
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Jan 9 22:43:42 2012 -0500

    BLD: 32->64 bit cast for 32-bit

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index d1d7455d0..f0e371691 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -373,7 +373,7 @@ class GroupBy(object):
 
         name_list = []
         for ping, labels in zip(self.groupings, recons_labels):
-            labels = _check_platform_int(labels)
+            labels = _ensure_platform_int(labels)
             name_list.append((ping.name, ping.group_index.take(labels)))
 
         return name_list
@@ -1327,6 +1327,8 @@ _cython_transforms = {
 def _compress_group_index(group_index, sort=True):
     uniques = []
     table = lib.Int64HashTable(len(group_index))
+
+    group_index = _ensure_int64(group_index)
     comp_ids = table.get_labels_groupby(group_index, uniques)
     max_group = len(uniques)
 
@@ -1356,11 +1358,16 @@ def _group_labels(values):
         values = values.astype('O')
     return lib.group_labels(values)
 
-def _check_platform_int(labels):
+def _ensure_platform_int(labels):
     if labels.dtype != np.int_:
         labels = labels.astype(np.int_)
     return labels
 
+def _ensure_int64(labels):
+    if labels.dtype != np.int64:
+        labels = labels.astype(np.int64)
+    return labels
+
 def sort_group_labels(ids, labels, counts):
     n = len(ids)
 
