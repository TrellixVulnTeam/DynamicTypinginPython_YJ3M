commit f68bf254a5a9503bbaef64e23bd53cd85527d20e
Author: Leif Walsh <leif.walsh@gmail.com>
Date:   Fri Nov 10 18:27:45 2017 -0500

    ENH: improve 'incompatible tolerance' error message in merge_asof (#17260)

diff --git a/pandas/core/reshape/merge.py b/pandas/core/reshape/merge.py
index 0234a5563..412c00dc9 100644
--- a/pandas/core/reshape/merge.py
+++ b/pandas/core/reshape/merge.py
@@ -126,7 +126,7 @@ def _groupby_and_merge(by, on, left, right, _merge_pieces,
             try:
                 if k in merged:
                     merged[k] = key
-            except:
+            except KeyError:
                 pass
 
         pieces.append(merged)
@@ -1268,8 +1268,10 @@ class _AsOfMerge(_OrderedMerge):
             else:
                 lt = left_join_keys[-1]
 
-            msg = "incompatible tolerance, must be compat " \
-                  "with type {lt}".format(lt=type(lt))
+            msg = ("incompatible tolerance {tolerance}, must be compat "
+                   "with type {lkdtype}".format(
+                       tolerance=type(self.tolerance),
+                       lkdtype=lt.dtype))
 
             if is_datetime64_dtype(lt) or is_datetime64tz_dtype(lt):
                 if not isinstance(self.tolerance, Timedelta):
@@ -1505,12 +1507,12 @@ def _sort_labels(uniques, left, right):
         # tuplesafe
         uniques = Index(uniques).values
 
-    l = len(left)
+    llength = len(left)
     labels = np.concatenate([left, right])
 
     _, new_labels = sorting.safe_sort(uniques, labels, na_sentinel=-1)
     new_labels = _ensure_int64(new_labels)
-    new_left, new_right = new_labels[:l], new_labels[l:]
+    new_left, new_right = new_labels[:llength], new_labels[llength:]
 
     return new_left, new_right
 
