commit 98030301bce1fdd2711a720aa2e26d9485324bdf
Author: jreback <jeff@reback.net>
Date:   Wed Dec 12 14:00:58 2012 -0500

    BUG: fixed version checking for PyTables >= 2.3 (and put the correct tests in this time)

diff --git a/pandas/io/pytables.py b/pandas/io/pytables.py
index bd271b05c..ad91c7562 100644
--- a/pandas/io/pytables.py
+++ b/pandas/io/pytables.py
@@ -91,9 +91,12 @@ def _tables():
         _table_mod = tables
 
         # version requirements
-        major, minor, subv = tables.__version__.split('.')
-        if int(major) >= 2 and int(minor[0]) >= 3:
-            _table_supports_index = True
+        ver = tables.__version__.split('.')
+        try:
+            if int(ver[0]) >= 2 and int(ver[1][0]) >= 3:
+                _table_supports_index = True
+        except:
+            pass
 
     return _table_mod
 
@@ -437,8 +440,9 @@ class HDFStore(object):
         """
 
         # version requirements
+        _tables()
         if not _table_supports_index:
-            raise("PyTables >= 2.3 is required for table indexing")
+            raise Exception("PyTables >= 2.3 is required for table indexing")
 
         group = self.get_node(key)
         if group is None: return
diff --git a/pandas/io/tests/test_pytables.py b/pandas/io/tests/test_pytables.py
index ad11fb875..88f717463 100644
--- a/pandas/io/tests/test_pytables.py
+++ b/pandas/io/tests/test_pytables.py
@@ -345,6 +345,25 @@ class TestHDFStore(unittest.TestCase):
         pytables._table_supports_index = False
         self.assertRaises(Exception, self.store.create_table_index, 'f')
 
+        # test out some versions
+        original = tables.__version__
+
+        for v in ['2.2','2.2b']:
+            pytables._table_mod = None
+            pytables._table_supports_index = False
+            tables.__version__ = v
+            self.assertRaises(Exception, self.store.create_table_index, 'f')
+
+        for v in ['2.3.1','2.3.1b','2.4dev','2.4',original]:
+            pytables._table_mod = None
+            pytables._table_supports_index = False
+            tables.__version__ = v
+            self.store.create_table_index('f')
+        pytables._table_mod = None
+        pytables._table_supports_index = False
+        tables.__version__ = original
+        
+
     def test_append_diff_item_order(self):
         wp = tm.makePanel()
         wp1 = wp.ix[:, :10, :]
