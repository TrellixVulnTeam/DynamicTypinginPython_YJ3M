commit 40f4b035f9b9172e46bf067833782a7766525a24
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Dec 26 09:45:21 2011 -0500

    BUG: use int64_t in factorize

diff --git a/pandas/src/sandbox.pyx b/pandas/src/sandbox.pyx
index f08a647f4..31bb946a7 100644
--- a/pandas/src/sandbox.pyx
+++ b/pandas/src/sandbox.pyx
@@ -397,7 +397,7 @@ cdef class Int64HashTable:
 
         return locs
 
-    def factorize(self, ndarray[object] values):
+    def factorize(self, ndarray[int64_t] values):
         cdef:
             Py_ssize_t i, n = len(values)
             ndarray[int32_t] labels = np.empty(n, dtype=np.int32)
