commit 9c44f9b2cad863bde17c7dd061d5b5b5ccbada21
Author: Jeff Reback <jeff@reback.net>
Date:   Sat Jul 8 12:08:31 2017 -0400

    COMPAT: moar 32-bit compat for testing of indexers (#16861)
    
    xref #16826

diff --git a/pandas/core/indexes/base.py b/pandas/core/indexes/base.py
index cefb080a3..e1053c161 100644
--- a/pandas/core/indexes/base.py
+++ b/pandas/core/indexes/base.py
@@ -2704,7 +2704,7 @@ class Index(IndexOpsMixin, StringAccessorMixin, PandasObject):
             tgt_values = target._values
 
         indexer, missing = self._engine.get_indexer_non_unique(tgt_values)
-        return indexer, missing
+        return _ensure_platform_int(indexer), missing
 
     def get_indexer_for(self, target, **kwargs):
         """
diff --git a/pandas/tests/indexes/test_category.py b/pandas/tests/indexes/test_category.py
index 493274fff..9dc2cfdec 100644
--- a/pandas/tests/indexes/test_category.py
+++ b/pandas/tests/indexes/test_category.py
@@ -401,7 +401,7 @@ class TestCategoricalIndex(Base):
         exp = CategoricalIndex(['a', 'a', 'c'], categories=['a', 'c'])
         tm.assert_index_equal(res, exp, exact=True)
         tm.assert_numpy_array_equal(indexer,
-                                    np.array([0, 3, 2], dtype=np.int64))
+                                    np.array([0, 3, 2], dtype=np.intp))
 
         c = CategoricalIndex(['a', 'b', 'c', 'a'],
                              categories=['a', 'b', 'c', 'd'])
@@ -409,7 +409,7 @@ class TestCategoricalIndex(Base):
         exp = Index(['a', 'a', 'c'], dtype='object')
         tm.assert_index_equal(res, exp, exact=True)
         tm.assert_numpy_array_equal(indexer,
-                                    np.array([0, 3, 2], dtype=np.int64))
+                                    np.array([0, 3, 2], dtype=np.intp))
 
         c = CategoricalIndex(['a', 'b', 'c', 'a'],
                              categories=['a', 'b', 'c', 'd'])
@@ -417,7 +417,7 @@ class TestCategoricalIndex(Base):
         exp = CategoricalIndex(['a', 'a', 'c'], categories=['a', 'c'])
         tm.assert_index_equal(res, exp, exact=True)
         tm.assert_numpy_array_equal(indexer,
-                                    np.array([0, 3, 2], dtype=np.int64))
+                                    np.array([0, 3, 2], dtype=np.intp))
 
     def test_duplicates(self):
 
