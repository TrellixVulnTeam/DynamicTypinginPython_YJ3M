commit 6194afedf55a99371c9d71e064bcae7e4637b2ee
Author: Adam Klein <adamklein@gmail.com>
Date:   Wed Feb 1 11:04:19 2012 -0500

    ENH: sortlevel fixes per comments for #720

diff --git a/pandas/core/index.py b/pandas/core/index.py
index b3b0dd56a..8c656da9b 100644
--- a/pandas/core/index.py
+++ b/pandas/core/index.py
@@ -1096,7 +1096,7 @@ class MultiIndex(Index):
         return np.dtype('O')
 
     @staticmethod
-    def _from_elements(self, values, labels=None, levels=None, names=None,
+    def _from_elements(values, labels=None, levels=None, names=None,
                        sortorder=None):
         index = values.view(MultiIndex)
         index.levels = levels
@@ -1536,18 +1536,24 @@ class MultiIndex(Index):
 
         level = self._get_level_number(level)
         primary = labels.pop(level)
+
+        shape = list(self.levshape)
+        primshp = shape.pop(level)
+
         indexer = _indexer_from_factorized((primary,) + tuple(labels),
-                                           self.levshape, compress=False)
+                                           (primshp,) + tuple(shape),
+                                           compress=False)
         if not ascending:
             indexer = indexer[::-1]
 
         new_labels = [lab.take(indexer) for lab in self.labels]
 
-        new_index = self._from_elements(self.values.take(indexer),
-                                        labels = new_labels,
-                                        levels = self.levels,
-                                        names = self.names,
-                                        sortorder = level)
+
+        new_index = MultiIndex._from_elements(self.values.take(indexer),
+                                              labels = new_labels,
+                                              levels = self.levels,
+                                              names = self.names,
+                                              sortorder = level)
 
         return new_index, indexer
 
diff --git a/pandas/tests/test_index.py b/pandas/tests/test_index.py
index c408cf383..12e96a1a1 100644
--- a/pandas/tests/test_index.py
+++ b/pandas/tests/test_index.py
@@ -1186,6 +1186,28 @@ class TestMultiIndex(unittest.TestCase):
         sorted_idx, _ = index.sortlevel(1, ascending=False)
         self.assert_(sorted_idx.equals(expected[::-1]))
 
+    def test_sortlevel_deterministic(self):
+        tuples = [('bar', 'one'), ('foo', 'two'), ('qux', 'two'),
+                  ('foo', 'one'), ('baz', 'two'), ('qux', 'one')]
+
+        index = MultiIndex.from_tuples(tuples)
+
+        sorted_idx, _ = index.sortlevel(0)
+        expected = MultiIndex.from_tuples(sorted(tuples))
+        self.assert_(sorted_idx.equals(expected))
+
+        sorted_idx, _ = index.sortlevel(0, ascending=False)
+        self.assert_(sorted_idx.equals(expected[::-1]))
+
+        sorted_idx, _ = index.sortlevel(1)
+        by1 = sorted(tuples, key=lambda x: (x[1], x[0]))
+        expected = MultiIndex.from_tuples(by1)
+        self.assert_(sorted_idx.equals(expected))
+
+        sorted_idx, _ = index.sortlevel(1, ascending=False)
+        self.assert_(sorted_idx.equals(expected[::-1]))
+
+
     def test_dims(self):
         pass
 
