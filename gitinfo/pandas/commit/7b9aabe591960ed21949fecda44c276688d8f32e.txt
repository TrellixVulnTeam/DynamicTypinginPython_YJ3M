commit 7b9aabe591960ed21949fecda44c276688d8f32e
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed May 2 22:17:14 2012 -0400

    BUG: fix annual by-month period conversion

diff --git a/pandas/src/period.c b/pandas/src/period.c
index 560fab451..6ee8e7fc2 100644
--- a/pandas/src/period.c
+++ b/pandas/src/period.c
@@ -1059,7 +1059,14 @@ int64_t get_period_ordinal(int year, int month, int day,
 
     if (freq_group == FR_ANN)
     {
+      fmonth = freq - FR_ANN;
+      if (fmonth == 0) fmonth = 12;
+      if (month <= fmonth) {
         return year;
+      }
+      else {
+        return year + 1;
+      }
     }
 
     Py_Error(PyExc_RuntimeError, "Unable to generate frequency ordinal");
diff --git a/pandas/tseries/tests/test_period.py b/pandas/tseries/tests/test_period.py
index ed3e71035..a4289b6e1 100644
--- a/pandas/tseries/tests/test_period.py
+++ b/pandas/tseries/tests/test_period.py
@@ -38,6 +38,15 @@ class TestPeriodProperties(TestCase):
             p = Period(stamp, freq=freq)
             self.assertEquals(p, exp)
 
+    def test_period_cons_annual(self):
+        # bugs in scikits.timeseries
+        for month in MONTHS:
+            freq = 'A-%s' % month
+            exp = Period('1989', freq=freq)
+            stamp = exp.to_timestamp('D', how='end') + 30
+            p = Period(stamp, freq=freq)
+            self.assertEquals(p, exp + 1)
+
     def test_period_constructor(self):
         i1 = Period('1/1/2005', freq='M')
         i2 = Period('Jan 2005')
