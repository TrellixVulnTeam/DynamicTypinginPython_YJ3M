commit 65e716af386e309a1d54e45d426966181c89bd86
Author: y-p <yoval@gmx.com>
Date:   Sun Nov 11 02:25:35 2012 +0200

    BUG: df with dupe cols should raise KeyError on accessing non-existent col via list #2218

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 31c1a09f4..2bd465537 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -1796,13 +1796,18 @@ class DataFrame(NDFrame):
                 indexer = self.columns.get_indexer(key)
                 mask = indexer == -1
                 if mask.any():
-                    raise KeyError("No column(s) named: %s" % str(key[mask]))
+                    raise KeyError("No column(s) named: %s" %
+                                   com.pprint_thing(key[mask]))
                 result = self.reindex(columns=key)
                 if result.columns.name is None:
                     result.columns.name = self.columns.name
                 return result
             else:
                 mask = self.columns.isin(key)
+                for k in key:
+                    if k not in self.columns:
+                        raise KeyError("No column(s) named: %s" %
+                                       com.pprint_thing(k))
                 return self.take(mask.nonzero()[0], axis=1)
 
     def _slice(self, slobj, axis=0):
