commit cbeff93c9ac027d64d711adaaba454116722a064
Author: y-p <yoval@gmx.com>
Date:   Thu Oct 4 23:59:52 2012 +0200

    ENH: rework console encoding detection in fmt.print_config

diff --git a/pandas/core/format.py b/pandas/core/format.py
index dca1976be..53d12e5e0 100644
--- a/pandas/core/format.py
+++ b/pandas/core/format.py
@@ -1099,9 +1099,31 @@ class _GlobalPrintConfig(object):
         self.date_dayfirst = False
         self.date_yearfirst = False
         self.multi_sparse = True
-        self.encoding = sys.getdefaultencoding()
-        if self.encoding == 'ascii':
-            self.encoding = 'UTF8'
+        self.encoding = self.detect_encoding()
+
+    def detect_encoding(self):
+        """
+        Try to find the most capable encoding supported by the console.
+        slighly modified from the way IPython handles the same issue.
+        """
+        import locale
+
+        encoding = None
+        try:
+            encoding=sys.stdin.encoding
+        except AttributeError:
+            pass
+
+        if not encoding or encoding =='ascii': # try again for something better
+            try:
+                encoding = locale.getpreferredencoding()
+            except Exception:
+                pass
+
+        if not encoding: # when all else fails. this will usually be "ascii"
+                encoding = sys.getdefaultencoding()
+
+        return encoding
 
     def reset(self):
         self.__init__()
