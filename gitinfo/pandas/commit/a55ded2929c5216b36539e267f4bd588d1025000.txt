commit a55ded2929c5216b36539e267f4bd588d1025000
Author: Adam Klein <adamklein@gmail.com>
Date:   Wed Feb 29 13:02:19 2012 -0500

    BUG: close #839, another case where nan may be assigned to int series

diff --git a/pandas/core/series.py b/pandas/core/series.py
index 1d45d6243..714b74fea 100644
--- a/pandas/core/series.py
+++ b/pandas/core/series.py
@@ -555,6 +555,10 @@ copy : boolean, default False
 
     def __setslice__(self, i, j, value):
         """Set slice equal to given value(s)"""
+        if issubclass(self.dtype.type, (np.integer, np.bool_)):
+            if np.isscalar(value) and isnull(value):
+                raise ValueError('Cannot assign nan to integer series')
+
         ndarray.__setslice__(self, i, j, value)
 
     def get(self, label, default=None):
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index 3603b6295..6fc9ec6d0 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -1158,8 +1158,13 @@ class TestSeries(unittest.TestCase, CheckNameIntegration):
             s = Series([True, True, False, False])
             s[::2] = np.nan
 
+        def testme3():
+            s = Series(np.arange(10))
+            s[:5] = np.nan
+
         self.assertRaises(Exception, testme1)
         self.assertRaises(Exception, testme2)
+        self.assertRaises(Exception, testme3)
 
     def test_scalar_na_cmp_corners(self):
         s = Series([2,3,4,5,6,7,8,9,10])
