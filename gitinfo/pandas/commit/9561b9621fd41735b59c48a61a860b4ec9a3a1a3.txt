commit 9561b9621fd41735b59c48a61a860b4ec9a3a1a3
Author: Shivam Rana <shivamrana95@yahoo.in>
Date:   Tue Feb 19 18:44:24 2019 +0530

    #23049: test for Fatal Stack Overflow stemming From Misuse of astype('category') (#25366)

diff --git a/pandas/tests/frame/test_combine_concat.py b/pandas/tests/frame/test_combine_concat.py
index 59497153c..c2364dc13 100644
--- a/pandas/tests/frame/test_combine_concat.py
+++ b/pandas/tests/frame/test_combine_concat.py
@@ -504,6 +504,16 @@ class TestDataFrameConcatCommon(TestData):
                                                                 names=[1, 2]))
         tm.assert_frame_equal(result, expected)
 
+    def test_concat_astype_dup_col(self):
+        # gh 23049
+        df = pd.DataFrame([{'a': 'b'}])
+        df = pd.concat([df, df], axis=1)
+
+        result = df.astype('category')
+        expected = pd.DataFrame(np.array(["b", "b"]).reshape(1, 2),
+                                columns=["a", "a"]).astype("category")
+        tm.assert_frame_equal(result, expected)
+
 
 class TestDataFrameCombineFirst(TestData):
 
