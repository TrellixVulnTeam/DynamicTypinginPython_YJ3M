commit f3e3cfeddac934fdb60ef9f54ea4e06af687014f
Author: Jeff Reback <jeff@reback.net>
Date:   Wed Mar 29 12:21:02 2017 -0400

    CI: upload coverage with flags

diff --git a/.travis.yml b/.travis.yml
index 1053f8925..d864b7555 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -108,7 +108,6 @@ install:
   - echo "install done"
 
 before_script:
-  - source activate pandas && pip install codecov
   - ci/install_db_travis.sh
 
 script:
@@ -120,9 +119,7 @@ script:
   - echo "script done"
 
 after_success:
-  - if [ "$COVERAGE" ]; then
-        source activate pandas && codecov --file /tmp/cov-single.xml /tmp/cov-multiple.xml;
-    fi
+  -  ci/upload_coverage.sh
 
 after_script:
   - echo "after_script start"
diff --git a/ci/install_travis.sh b/ci/install_travis.sh
index f71df979c..10556ccff 100755
--- a/ci/install_travis.sh
+++ b/ci/install_travis.sh
@@ -115,7 +115,7 @@ if [ "$LINT" ]; then
 fi
 
 if [ "$COVERAGE" ]; then
-    pip install coverage pytest-cov
+    pip install coverage pytest-cov codecov
 fi
 
 echo
diff --git a/ci/upload_coverage.sh b/ci/upload_coverage.sh
new file mode 100755
index 000000000..0da8e46a1
--- /dev/null
+++ b/ci/upload_coverage.sh
@@ -0,0 +1,11 @@
+#!/bin/bash
+
+if [ -z "$COVERAGE" ]; then
+   echo "no upload of coverage is needed"
+   exit 0
+fi
+
+source activate pandas
+
+codecov --file -c -F single /tmp/cov-single.xml
+codecov --file -c -F multiple /tmp/cov-multiple.xml
