commit 4a218da5735f0784554eb1b80c6d61a2e0b8cadb
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Thu Oct 20 10:43:22 2011 -0400

    ENH: speed boost in count by using Series.count

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 6e48360a5..eca9ee6ea 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -2387,10 +2387,18 @@ class DataFrame(NDFrame):
             return self._count_level(level, axis=axis,
                                      numeric_only=numeric_only)
 
-        y, axis_labels = self._get_agg_data(axis, numeric_only=numeric_only,
-                                            copy=False)
-        mask = notnull(y)
-        return Series(mask.sum(axis), index=axis_labels)
+        if numeric_only:
+            frame = self.ix[:, self._get_numeric_columns()]
+        else:
+            frame = self
+
+        result = frame.apply(Series.count, axis=axis)
+
+        # what happens with empty DataFrame
+        if isinstance(result, DataFrame):
+            result = Series({})
+
+        return result
 
     def _count_level(self, level, axis=0, numeric_only=False):
         # TODO: deal with sortedness??
