commit d354267ee0859b8fb5c55a2a418e8cb14768e6b2
Author: locojaydev <locojaydev@dev.com>
Date:   Thu Nov 22 16:10:36 2012 -0500

    adding float_format to ExcelFormatter

diff --git a/pandas/core/format.py b/pandas/core/format.py
index 70c2d8707..650dccace 100644
--- a/pandas/core/format.py
+++ b/pandas/core/format.py
@@ -720,23 +720,33 @@ class ExcelFormatter(object):
     ----------
     df : dataframe
     na_rep: na representation
-    index : boolean, default True
-        output row names (index)
+    float_format : string, default None
+            Format string for floating point numbers
     cols : sequence, optional
         Columns to write
+    index : boolean, default True
+        output row names (index)
     """
 
-    def __init__(self, df, na_rep='', cols=None):
+    def __init__(self,
+                 df,
+                 na_rep='',
+                 float_format=None,
+                 cols=None
+                 ):
         self.df = df
         self.rowcounter = 0
         self.na_rep = na_rep
         self.columns = cols
         if cols is None:
             self.columns = df.columns
+        self.float_format = float_format
 
     def _format_value(self, val):
         if lib.checknull(val):
             val = self.na_rep
+        if self.float_format is not None and com.is_float(val):
+            val = self.float_format % val
         return val
 
     def _format_header_mi(self):
diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 207f75cb7..98f06891e 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -1368,10 +1368,13 @@ class DataFrame(NDFrame):
         from pandas.io.parsers import ExcelWriter
         need_save = False
         if isinstance(excel_writer, basestring):
-            excel_writer = ExcelWriter(excel_writer, na_rep=na_rep)
+            excel_writer = ExcelWriter(excel_writer)
             need_save = True
 
-        formatter = fmt.ExcelFormatter(self, na_rep=na_rep, cols=cols)
+        formatter = fmt.ExcelFormatter(self,
+                                       na_rep=na_rep,
+                                       cols=cols,
+                                       float_format=float_format)
         formatted_cells = formatter.get_formatted_cells()
         excel_writer.write_cells(formatted_cells, sheet_name,
                                  startrow=startrow, startcol=startcol)
diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index 7f992e883..df1cd0603 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -2048,7 +2048,8 @@ class ExcelWriter(object):
             elif isinstance(cell.val, datetime.date):
                 style.num_format_str = "YYYY-MM-DD"
 
-            #merging requires openpyxl latest (works on 1.5.7)
+            #merging requires openpyxl latest (works on 1.6.1)
+            #todo add version check
             if cell.mergestart is not None and cell.mergeend is not None:
                 cletterstart = get_column_letter(startcol + cell.col + 1)
                 cletterend = get_column_letter(startcol + cell.mergeend + 1)
