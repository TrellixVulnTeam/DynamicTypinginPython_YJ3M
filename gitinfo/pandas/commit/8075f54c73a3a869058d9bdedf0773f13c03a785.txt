commit 8075f54c73a3a869058d9bdedf0773f13c03a785
Author: Chang She <changshe@gmail.com>
Date:   Sun Nov 4 16:26:29 2012 -0500

    BUG: Series.diff for integer dtypes #2087

diff --git a/pandas/core/series.py b/pandas/core/series.py
index 1b105d48f..044353f55 100644
--- a/pandas/core/series.py
+++ b/pandas/core/series.py
@@ -1511,7 +1511,22 @@ copy : boolean, default False
         -------
         diffed : Series
         """
-        return (self - self.shift(periods))
+        if com.is_integer_dtype(self):
+            new_values = np.empty(len(self), dtype=self.dtype)
+            new_values = _maybe_upcast(new_values)
+
+            if periods > 0:
+                new_values[periods:] = (self.values[periods:] -
+                                        self.values[:-periods])
+                new_values[:periods] = nan
+            elif periods < 0:
+                new_values[:periods] = (self.values[:periods] -
+                                        self.values[-periods:])
+                new_values[periods:] = nan
+
+            return Series(new_values, index=self.index, name=self.name)
+        else:
+            return self - self.shift(periods)
 
     def autocorr(self):
         """
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index 1f1b3285f..03bfccba8 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -2998,6 +2998,14 @@ class TestSeries(unittest.TestCase, CheckNameIntegration):
         # Just run the function
         self.ts.diff()
 
+        # int dtype
+        a = 10000000000000000
+        b = a + 1
+        s = Series([a, b])
+
+        rs = s.diff()
+        self.assertEqual(rs[1], 1)
+
     def test_pct_change(self):
         rs = self.ts.pct_change(fill_method=None)
         assert_series_equal(rs, self.ts / self.ts.shift(1) - 1)
