commit 9e7832e5d5c203e0943bbb358d6a0c071373d2d1
Author: Chang She <chang@lambdafoundry.com>
Date:   Wed May 2 21:06:54 2012 -0400

    ENH: first and nth for groupby. GH #994

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index c2c5e8951..29ed324ba 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -350,8 +350,19 @@ class GroupBy(object):
         return self._cython_agg_general('ohlc')
 
     def last(self):
+        return self.nth(-1)
+
+    def first(self):
+        return self.nth(0)
+
+    def nth(self, n):
         def picker(arr):
-            return arr[-1] if arr is not None and len(arr) else np.nan
+            if arr is not None:
+                n_ok_pos = n >= 0 and len(arr) > n
+                n_ok_neg = n < 0 and len(arr) >= n
+                if n_ok_pos or n_ok_neg:
+                    return arr.iget(n)
+            return np.nan
         return self.agg(picker)
 
     def _cython_agg_general(self, how):
diff --git a/pandas/tests/test_groupby.py b/pandas/tests/test_groupby.py
index bda00f2aa..a4c12cb98 100644
--- a/pandas/tests/test_groupby.py
+++ b/pandas/tests/test_groupby.py
@@ -120,6 +120,25 @@ class TestGroupBy(unittest.TestCase):
         # corner cases
         self.assertRaises(Exception, grouped.aggregate, lambda x: x * 2)
 
+        grouped = self.df.groupby('A')
+        first = grouped.first()
+        expected = grouped.get_group('bar')
+        expected = expected.xs(expected.index[0])[1:]
+        expected.name ='bar'
+        assert_series_equal(first.xs('bar'), expected)
+
+        last = grouped.last()
+        expected = grouped.get_group('bar')
+        expected = expected.xs(expected.index[-1])[1:]
+        expected.name ='bar'
+        assert_series_equal(last.xs('bar'), expected)
+
+        nth = grouped.nth(1)
+        expected = grouped.get_group('foo')
+        expected = expected.xs(expected.index[1])[1:]
+        expected.name ='foo'
+        assert_series_equal(nth.xs('foo'), expected)
+
     def test_groupby_dict_mapping(self):
         # GH #679
         from pandas import Series
