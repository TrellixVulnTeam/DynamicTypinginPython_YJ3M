commit 85a9f8c2d5218c92a042bc7fdafe619758bfe31c
Author: Jeff Reback <jeff@reback.net>
Date:   Fri Apr 14 21:31:31 2017 +0000

    TST: test addl feather dtypes (#16004)

diff --git a/pandas/tests/io/test_feather.py b/pandas/tests/io/test_feather.py
index 6e2c28a0f..3fad2637e 100644
--- a/pandas/tests/io/test_feather.py
+++ b/pandas/tests/io/test_feather.py
@@ -8,23 +8,18 @@ import pandas as pd
 from pandas.io.feather_format import to_feather, read_feather
 
 from feather import FeatherError
-import pandas.util.testing as tm
 from pandas.util.testing import assert_frame_equal, ensure_clean
 
 
-class TestFeather(tm.TestCase):
-
-    def setUp(self):
-        pass
+class TestFeather(object):
 
     def check_error_on_write(self, df, exc):
         # check that we are raising the exception
         # on writing
 
-        def f():
+        with pytest.raises(exc):
             with ensure_clean() as path:
                 to_feather(df, path)
-        self.assertRaises(exc, f)
 
     def check_round_trip(self, df):
 
@@ -41,17 +36,21 @@ class TestFeather(tm.TestCase):
 
     def test_basic(self):
 
-        df = pd.DataFrame({'a': list('abc'),
-                           'b': list(range(1, 4)),
-                           'c': np.arange(3, 6).astype('u1'),
-                           'd': np.arange(4.0, 7.0, dtype='float64'),
-                           'e': [True, False, True],
-                           'f': pd.Categorical(list('abc')),
-                           'g': pd.date_range('20130101', periods=3),
-                           'h': pd.date_range('20130101', periods=3,
-                                              tz='US/Eastern'),
-                           'i': pd.date_range('20130101', periods=3,
-                                              freq='ns')})
+        df = pd.DataFrame({'string': list('abc'),
+                           'int': list(range(1, 4)),
+                           'uint': np.arange(3, 6).astype('u1'),
+                           'float': np.arange(4.0, 7.0, dtype='float64'),
+                           'float_with_null': [1., np.nan, 3],
+                           'bool': [True, False, True],
+                           'bool_with_null': [True, np.nan, False],
+                           'cat': pd.Categorical(list('abc')),
+                           'dt': pd.date_range('20130101', periods=3),
+                           'dttz': pd.date_range('20130101', periods=3,
+                                                 tz='US/Eastern'),
+                           'dt_with_null': [pd.Timestamp('20130101'), pd.NaT,
+                                            pd.Timestamp('20130103')],
+                           'dtns': pd.date_range('20130101', periods=3,
+                                                 freq='ns')})
 
         self.check_round_trip(df)
 
@@ -80,6 +79,9 @@ class TestFeather(tm.TestCase):
         df = pd.DataFrame({'a': pd.period_range('2013', freq='M', periods=3)})
         self.check_error_on_write(df, ValueError)
 
+        df = pd.DataFrame({'a': pd.timedelta_range('1 day', periods=3)})
+        self.check_error_on_write(df, FeatherError)
+
         # non-strings
         df = pd.DataFrame({'a': ['a', 1, 2.0]})
         self.check_error_on_write(df, ValueError)
