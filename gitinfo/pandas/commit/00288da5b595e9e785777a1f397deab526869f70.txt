commit 00288da5b595e9e785777a1f397deab526869f70
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Apr 5 03:32:49 2010 +0000

    bit of getMergeFunc cleanup
    
    git-svn-id: http://pandas.googlecode.com/svn/trunk@152 d5231056-7de3-11de-ac95-d976489f1ece

diff --git a/pandas/lib/src/reindex.pyx b/pandas/lib/src/reindex.pyx
index 30539cf01..5ee9eb033 100644
--- a/pandas/lib/src/reindex.pyx
+++ b/pandas/lib/src/reindex.pyx
@@ -108,49 +108,6 @@ def reindexObject(ndarray[object, ndim=1] index,
 
     return result
 
-cdef tuple _nofill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
-    cdef int *fillLocs
-    cdef char *mask
-
-
-
-
-
-
-
-    cdef int i, j, length, newLength
-
-    cdef flatiter iterold
-    cdef object idx
-    cdef ndarray fillVec
-    cdef ndarray maskVec
-
-    fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)
-    maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
-
-    fillLocs = <int *> fillVec.data
-    mask = <char *> maskVec.data
-
-    newLength = PyArray_SIZE(fillVec)
-
-    length = PyArray_SIZE(oldIndex)
-    iterold = <flatiter> PyArray_IterNew(oldIndex)
-
-    for i from 0 <= i < length:
-        idx = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))
-        if i < length - 1:
-           PyArray_ITER_NEXT(iterold)
-        if idx in newMap:
-            j = newMap[idx]
-            fillLocs[j] = i
-            mask[j] = 1
-
-    for i from 0 <= i < newLength:
-        if mask[i] == 0:
-            fillLocs[i] = -1
-
-    return fillVec, maskVec
-
 cdef tuple _backfill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
     '''
     Backfilling logic for generating fill vector
@@ -384,7 +341,7 @@ def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,
                object kind):
 
     if kind == '':
-        fillVec, maskVec = _nofill(oldIndex, newIndex, oldMap, newMap)
+        fillVec, maskVec = getMergeVec(newIndex, oldMap)
     elif kind == 'PAD':
         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
     elif kind == 'BACKFILL':
@@ -394,39 +351,33 @@ def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,
 
     return fillVec, maskVec.astype(np.bool)
 
-def getMergeVec(ndarray values, dict indexMap):
-    cdef int *fillLocs
-    cdef char *mask
-    cdef int i, j, length
-
-    cdef flatiter itervals
-    cdef object val
-    cdef ndarray fillVec
-    cdef ndarray maskVec
+@cython.boundscheck(False)
+def getMergeVec(ndarray values, dict oldMap):
+    cdef int i, j, length, newLength
 
-    cdef int newLength = len(values)
+    cdef flatiter iternew
+    cdef object idx
+    cdef ndarray[int32_t, ndim=1] fillLocs
+    cdef ndarray[int8_t, ndim=1] mask
 
-    fillVec = <ndarray> np.empty(newLength, dtype = np.int32)
-    maskVec = <ndarray> np.zeros(newLength, dtype = np.int8)
+    newLength = len(values)
+    fillLocs = np.empty(newLength, dtype=np.int32)
+    mask = np.zeros(newLength, dtype=np.int8)
 
-    fillLocs = <int *> fillVec.data
-    mask = <char *> maskVec.data
+    iternew = <flatiter> PyArray_IterNew(values)
 
-    length = PyArray_SIZE(values)
-    itervals = <flatiter> PyArray_IterNew(values)
+    for i from 0 <= i < newLength:
+        idx = PyArray_GETITEM(values, PyArray_ITER_DATA(iternew))
 
-    for i from 0 <= i < length:
-        val = PyArray_GETITEM(values, PyArray_ITER_DATA(itervals))
-        if val in indexMap:
-            j = indexMap[val]
-            fillLocs[i] = j
+        if idx in oldMap:
+            fillLocs[i] = oldMap[idx]
             mask[i] = 1
 
-        PyArray_ITER_NEXT(itervals)
+        PyArray_ITER_NEXT(iternew)
 
     for i from 0 <= i < newLength:
         if mask[i] == 0:
             fillLocs[i] = -1
 
-    return fillVec, maskVec.astype(np.bool)
+    return fillLocs, mask.astype(bool)
 
diff --git a/pandas/lib/src/tseries.c b/pandas/lib/src/tseries.c
index 1a46af76b..9599e66ec 100644
--- a/pandas/lib/src/tseries.c
+++ b/pandas/lib/src/tseries.c
@@ -1,4 +1,4 @@
-/* Generated by Cython 0.12.1 on Sat Mar 20 16:42:50 2010 */
+/* Generated by Cython 0.12.1 on Sun Apr  4 23:21:28 2010 */
 
 #define PY_SSIZE_T_CLEAN
 #include "Python.h"
@@ -650,6 +650,8 @@ static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*
 
 static CYTHON_INLINE npy_intp __Pyx_PyInt_from_py_npy_intp(PyObject *);
 
+static CYTHON_INLINE npy_int32 __Pyx_PyInt_from_py_npy_int32(PyObject *);
+
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     #define __Pyx_CREAL(z) ((z).real())
@@ -823,7 +825,6 @@ static __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *)
 static PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *, int __pyx_skip_dispatch); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *); /*proto*/
 static PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *); /*proto*/
-static PyObject *__pyx_f_7tseries__nofill(PyArrayObject *, PyArrayObject *, PyObject *, PyObject *); /*proto*/
 static PyObject *__pyx_f_7tseries__backfill(PyArrayObject *, PyArrayObject *, PyObject *, PyObject *); /*proto*/
 static PyObject *__pyx_f_7tseries__pad(PyArrayObject *, PyArrayObject *, PyObject *, PyObject *); /*proto*/
 static double __pyx_f_7tseries___add(double, double); /*proto*/
@@ -840,6 +841,8 @@ static __Pyx_TypeInfo __Pyx_TypeInfo_object = { "Python object", NULL, sizeof(Py
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn_npy_int8 = { "numpy.npy_int8", NULL, sizeof(npy_int8), 'I' };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn_npy_float64 = { "numpy.npy_float64", NULL, sizeof(npy_float64), 'R' };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_double_t = { "numpy.double_t", NULL, sizeof(__pyx_t_5numpy_double_t), 'R' };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t = { "numpy.int32_t", NULL, sizeof(__pyx_t_5numpy_int32_t), 'I' };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t = { "numpy.int8_t", NULL, sizeof(__pyx_t_5numpy_int8_t), 'I' };
 #define __Pyx_MODULE_NAME "tseries"
 int __pyx_module_is_main_tseries = 0;
 
@@ -955,6 +958,7 @@ static char __pyx_k____div__[] = "__div__";
 static char __pyx_k____mul__[] = "__mul__";
 static char __pyx_k____pow__[] = "__pow__";
 static char __pyx_k____sub__[] = "__sub__";
+static char __pyx_k___nofill[] = "_nofill";
 static char __pyx_k__asarray[] = "asarray";
 static char __pyx_k__float64[] = "float64";
 static char __pyx_k__keyfunc[] = "keyfunc";
@@ -964,7 +968,6 @@ static char __pyx_k__BACKFILL[] = "BACKFILL";
 static char __pyx_k__KeyError[] = "KeyError";
 static char __pyx_k____main__[] = "__main__";
 static char __pyx_k__datetime[] = "datetime";
-static char __pyx_k__indexMap[] = "indexMap";
 static char __pyx_k__isfinite[] = "isfinite";
 static char __pyx_k__itemsize[] = "itemsize";
 static char __pyx_k__newIndex[] = "newIndex";
@@ -984,6 +987,7 @@ static char __pyx_k___roll_mean[] = "_roll_mean";
 static char __pyx_k___roll_skew[] = "_roll_skew";
 static char __pyx_k__pydatetime[] = "pydatetime";
 static char __pyx_k__suboffsets[] = "suboffsets";
+static char __pyx_k__getMergeVec[] = "getMergeVec";
 static char __pyx_k__rolling_var[] = "rolling_var";
 static char __pyx_k__RuntimeError[] = "RuntimeError";
 static char __pyx_k___roll_median[] = "_roll_median";
@@ -1022,6 +1026,7 @@ static PyObject *__pyx_n_s____ne__;
 static PyObject *__pyx_n_s____pow__;
 static PyObject *__pyx_n_s____sub__;
 static PyObject *__pyx_n_s___ewma;
+static PyObject *__pyx_n_s___nofill;
 static PyObject *__pyx_n_s___roll_kurt;
 static PyObject *__pyx_n_s___roll_mean;
 static PyObject *__pyx_n_s___roll_median;
@@ -1055,10 +1060,10 @@ static PyObject *__pyx_n_s__float64;
 static PyObject *__pyx_n_s__format;
 static PyObject *__pyx_n_s__func;
 static PyObject *__pyx_n_s__get;
+static PyObject *__pyx_n_s__getMergeVec;
 static PyObject *__pyx_n_s__head;
 static PyObject *__pyx_n_s__idxMap;
 static PyObject *__pyx_n_s__index;
-static PyObject *__pyx_n_s__indexMap;
 static PyObject *__pyx_n_s__inf;
 static PyObject *__pyx_n_s__input;
 static PyObject *__pyx_n_s__insert;
@@ -14487,7 +14492,7 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
  * 
  *     return result             # <<<<<<<<<<<<<<
  * 
- * cdef tuple _nofill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
+ * cdef tuple _backfill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_result));
@@ -14529,345 +14534,6 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
 /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":111
  *     return result
  * 
- * cdef tuple _nofill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):             # <<<<<<<<<<<<<<
- *     cdef int *fillLocs
- *     cdef char *mask
- */
-
-static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyArrayObject *__pyx_v_newIndex, PyObject *__pyx_v_oldMap, PyObject *__pyx_v_newMap) {
-  int *__pyx_v_fillLocs;
-  char *__pyx_v_mask;
-  int __pyx_v_i;
-  int __pyx_v_j;
-  int __pyx_v_length;
-  int __pyx_v_newLength;
-  PyArrayIterObject *__pyx_v_iterold;
-  PyObject *__pyx_v_idx;
-  PyArrayObject *__pyx_v_fillVec;
-  PyArrayObject *__pyx_v_maskVec;
-  PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  Py_ssize_t __pyx_t_3;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
-  int __pyx_t_7;
-  int __pyx_t_8;
-  int __pyx_t_9;
-  __Pyx_RefNannySetupContext("_nofill");
-  __Pyx_INCREF((PyObject *)__pyx_v_oldIndex);
-  __Pyx_INCREF((PyObject *)__pyx_v_newIndex);
-  __Pyx_INCREF(__pyx_v_oldMap);
-  __Pyx_INCREF(__pyx_v_newMap);
-  __pyx_v_iterold = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_fillVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_maskVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":128
- *     cdef ndarray maskVec
- * 
- *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
- *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
- * 
- */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_1);
-  __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
-  __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_6)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_fillVec));
-  __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":129
- * 
- *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)
- *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
- * 
- *     fillLocs = <int *> fillVec.data
- */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
-  __Pyx_GIVEREF(__pyx_t_6);
-  __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
-  __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_maskVec));
-  __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":131
- *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
- * 
- *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
- *     mask = <char *> maskVec.data
- * 
- */
-  __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":132
- * 
- *     fillLocs = <int *> fillVec.data
- *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
- * 
- *     newLength = PyArray_SIZE(fillVec)
- */
-  __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":134
- *     mask = <char *> maskVec.data
- * 
- *     newLength = PyArray_SIZE(fillVec)             # <<<<<<<<<<<<<<
- * 
- *     length = PyArray_SIZE(oldIndex)
- */
-  __pyx_v_newLength = PyArray_SIZE(__pyx_v_fillVec);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":136
- *     newLength = PyArray_SIZE(fillVec)
- * 
- *     length = PyArray_SIZE(oldIndex)             # <<<<<<<<<<<<<<
- *     iterold = <flatiter> PyArray_IterNew(oldIndex)
- * 
- */
-  __pyx_v_length = PyArray_SIZE(__pyx_v_oldIndex);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":137
- * 
- *     length = PyArray_SIZE(oldIndex)
- *     iterold = <flatiter> PyArray_IterNew(oldIndex)             # <<<<<<<<<<<<<<
- * 
- *     for i from 0 <= i < length:
- */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_iterold));
-  __pyx_v_iterold = ((PyArrayIterObject *)__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":139
- *     iterold = <flatiter> PyArray_IterNew(oldIndex)
- * 
- *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
- *         idx = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))
- *         if i < length - 1:
- */
-  __pyx_t_7 = __pyx_v_length;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":140
- * 
- *     for i from 0 <= i < length:
- *         idx = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
- *         if i < length - 1:
- *            PyArray_ITER_NEXT(iterold)
- */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_v_idx);
-    __pyx_v_idx = __pyx_t_5;
-    __pyx_t_5 = 0;
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":141
- *     for i from 0 <= i < length:
- *         idx = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))
- *         if i < length - 1:             # <<<<<<<<<<<<<<
- *            PyArray_ITER_NEXT(iterold)
- *         if idx in newMap:
- */
-    __pyx_t_8 = (__pyx_v_i < (__pyx_v_length - 1));
-    if (__pyx_t_8) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":142
- *         idx = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))
- *         if i < length - 1:
- *            PyArray_ITER_NEXT(iterold)             # <<<<<<<<<<<<<<
- *         if idx in newMap:
- *             j = newMap[idx]
- */
-      PyArray_ITER_NEXT(__pyx_v_iterold);
-      goto __pyx_L5;
-    }
-    __pyx_L5:;
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":143
- *         if i < length - 1:
- *            PyArray_ITER_NEXT(iterold)
- *         if idx in newMap:             # <<<<<<<<<<<<<<
- *             j = newMap[idx]
- *             fillLocs[j] = i
- */
-    if (unlikely(((PyObject *)__pyx_v_newMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {
-      __pyx_t_8 = ((PyDict_Contains(((PyObject *)__pyx_v_newMap), __pyx_v_idx))); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    if (__pyx_t_8) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":144
- *            PyArray_ITER_NEXT(iterold)
- *         if idx in newMap:
- *             j = newMap[idx]             # <<<<<<<<<<<<<<
- *             fillLocs[j] = i
- *             mask[j] = 1
- */
-      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_newMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_t_5); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_v_j = __pyx_t_9;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":145
- *         if idx in newMap:
- *             j = newMap[idx]
- *             fillLocs[j] = i             # <<<<<<<<<<<<<<
- *             mask[j] = 1
- * 
- */
-      (__pyx_v_fillLocs[__pyx_v_j]) = __pyx_v_i;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":146
- *             j = newMap[idx]
- *             fillLocs[j] = i
- *             mask[j] = 1             # <<<<<<<<<<<<<<
- * 
- *     for i from 0 <= i < newLength:
- */
-      (__pyx_v_mask[__pyx_v_j]) = 1;
-      goto __pyx_L6;
-    }
-    __pyx_L6:;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":148
- *             mask[j] = 1
- * 
- *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
- *         if mask[i] == 0:
- *             fillLocs[i] = -1
- */
-  __pyx_t_7 = __pyx_v_newLength;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":149
- * 
- *     for i from 0 <= i < newLength:
- *         if mask[i] == 0:             # <<<<<<<<<<<<<<
- *             fillLocs[i] = -1
- * 
- */
-    __pyx_t_8 = ((__pyx_v_mask[__pyx_v_i]) == 0);
-    if (__pyx_t_8) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":150
- *     for i from 0 <= i < newLength:
- *         if mask[i] == 0:
- *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
- * 
- *     return fillVec, maskVec
- */
-      (__pyx_v_fillLocs[__pyx_v_i]) = -1;
-      goto __pyx_L9;
-    }
-    __pyx_L9:;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":152
- *             fillLocs[i] = -1
- * 
- *     return fillVec, maskVec             # <<<<<<<<<<<<<<
- * 
- * cdef tuple _backfill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
- */
-  __Pyx_XDECREF(((PyObject *)__pyx_r));
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
-  PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_v_fillVec));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_fillVec));
-  __Pyx_INCREF(((PyObject *)__pyx_v_maskVec));
-  PyTuple_SET_ITEM(__pyx_t_5, 1, ((PyObject *)__pyx_v_maskVec));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_maskVec));
-  if (!(likely(PyTuple_CheckExact(__pyx_t_5))||((__pyx_t_5) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_5)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_r = ((PyObject *)__pyx_t_5);
-  __pyx_t_5 = 0;
-  goto __pyx_L0;
-
-  __pyx_r = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_AddTraceback("tseries._nofill");
-  __pyx_r = 0;
-  __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_iterold);
-  __Pyx_DECREF(__pyx_v_idx);
-  __Pyx_DECREF((PyObject *)__pyx_v_fillVec);
-  __Pyx_DECREF((PyObject *)__pyx_v_maskVec);
-  __Pyx_DECREF((PyObject *)__pyx_v_oldIndex);
-  __Pyx_DECREF((PyObject *)__pyx_v_newIndex);
-  __Pyx_DECREF(__pyx_v_oldMap);
-  __Pyx_DECREF(__pyx_v_newMap);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":154
- *     return fillVec, maskVec
- * 
  * cdef tuple _backfill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):             # <<<<<<<<<<<<<<
  *     '''
  *     Backfilling logic for generating fill vector
@@ -14909,36 +14575,36 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_v_prevOld = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_curOld = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":183
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":140
  *     cdef ndarray fillVec
  *     cdef ndarray maskVec
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -14948,36 +14614,36 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":184
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":141
  *     cdef ndarray maskVec
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
  * 
  *     # Get references
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -14987,7 +14653,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":189
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":146
  *     cdef int *fillLocs
  *     cdef char *mask
  *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
@@ -14996,7 +14662,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":190
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":147
  *     cdef char *mask
  *     fillLocs = <int *> fillVec.data
  *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
@@ -15005,35 +14671,35 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":194
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":151
  *     # Create the iterators
  *     cdef flatiter iterold, iternew
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)             # <<<<<<<<<<<<<<
  *     iternew = <flatiter> PyArray_IterNew(newIndex)
  * 
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iterold));
   __pyx_v_iterold = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":195
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":152
  *     cdef flatiter iterold, iternew
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)
  *     iternew = <flatiter> PyArray_IterNew(newIndex)             # <<<<<<<<<<<<<<
  * 
  *     # Get the size
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iternew));
   __pyx_v_iternew = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":198
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":155
  * 
  *     # Get the size
  *     oldLength = PyArray_SIZE(oldIndex)             # <<<<<<<<<<<<<<
@@ -15042,7 +14708,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_oldLength = PyArray_SIZE(__pyx_v_oldIndex);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":199
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":156
  *     # Get the size
  *     oldLength = PyArray_SIZE(oldIndex)
  *     newLength = PyArray_SIZE(newIndex)             # <<<<<<<<<<<<<<
@@ -15051,7 +14717,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_newLength = PyArray_SIZE(__pyx_v_newIndex);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":203
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":160
  *     # Current positions
  *     cdef int newPos, oldPos
  *     oldPos = oldLength - 1             # <<<<<<<<<<<<<<
@@ -15060,7 +14726,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_oldPos = (__pyx_v_oldLength - 1);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":204
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":161
  *     cdef int newPos, oldPos
  *     oldPos = oldLength - 1
  *     newPos = newLength - 1             # <<<<<<<<<<<<<<
@@ -15069,7 +14735,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_newPos = (__pyx_v_newLength - 1);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":209
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":166
  *     cdef object prevOld, curOld
  * 
  *     while newPos >= 0:             # <<<<<<<<<<<<<<
@@ -15080,7 +14746,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_t_7 = (__pyx_v_newPos >= 0);
     if (!__pyx_t_7) break;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":211
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":168
  *     while newPos >= 0:
  *         # Move to the current position
  *         PyArray_ITER_GOTO1D(iternew, newPos)             # <<<<<<<<<<<<<<
@@ -15089,7 +14755,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
     PyArray_ITER_GOTO1D(__pyx_v_iternew, __pyx_v_newPos);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":212
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":169
  *         # Move to the current position
  *         PyArray_ITER_GOTO1D(iternew, newPos)
  *         PyArray_ITER_GOTO1D(iterold, oldPos)             # <<<<<<<<<<<<<<
@@ -15098,20 +14764,20 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
     PyArray_ITER_GOTO1D(__pyx_v_iterold, __pyx_v_oldPos);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":215
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":172
  * 
  *         # Get the current index
  *         curOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *         # Until we reach a point where we are before the curOld point
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_curOld);
     __pyx_v_curOld = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":218
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":175
  * 
  *         # Until we reach a point where we are before the curOld point
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > curOld:             # <<<<<<<<<<<<<<
@@ -15119,16 +14785,16 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  *             if newPos < 0:
  */
     while (1) {
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (!__pyx_t_7) break;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":219
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":176
  *         # Until we reach a point where we are before the curOld point
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > curOld:
  *             newPos -= 1             # <<<<<<<<<<<<<<
@@ -15137,7 +14803,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
       __pyx_v_newPos -= 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":220
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":177
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > curOld:
  *             newPos -= 1
  *             if newPos < 0:             # <<<<<<<<<<<<<<
@@ -15147,7 +14813,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
       __pyx_t_7 = (__pyx_v_newPos < 0);
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":221
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":178
  *             newPos -= 1
  *             if newPos < 0:
  *                 break             # <<<<<<<<<<<<<<
@@ -15159,7 +14825,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
       }
       __pyx_L7:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":222
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":179
  *             if newPos < 0:
  *                 break
  *             PyArray_ITER_GOTO1D(iternew, newPos)             # <<<<<<<<<<<<<<
@@ -15170,20 +14836,20 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     }
     __pyx_L6_break:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":225
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":182
  * 
  *         # Get the location in the old index
  *         curLoc = oldMap[curOld]             # <<<<<<<<<<<<<<
  * 
  *         # At the beginning of the old index
  */
-    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_curLoc = __pyx_t_8;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":228
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":185
  * 
  *         # At the beginning of the old index
  *         if oldPos == 0:             # <<<<<<<<<<<<<<
@@ -15193,47 +14859,47 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_t_7 = (__pyx_v_oldPos == 0);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":231
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":188
  * 
  *             # Make sure we are before the curOld index
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) <= curOld:             # <<<<<<<<<<<<<<
  *                 fillVec[:newPos + 1] = curLoc
  *                 maskVec[:newPos + 1] = 1
  */
-      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_LE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_LE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":232
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":189
  *             # Make sure we are before the curOld index
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) <= curOld:
  *                 fillVec[:newPos + 1] = curLoc             # <<<<<<<<<<<<<<
  *                 maskVec[:newPos + 1] = 1
  * 
  */
-        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), 0, (__pyx_v_newPos + 1), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), 0, (__pyx_v_newPos + 1), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":233
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":190
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) <= curOld:
  *                 fillVec[:newPos + 1] = curLoc
  *                 maskVec[:newPos + 1] = 1             # <<<<<<<<<<<<<<
  * 
  *             # Exit the main loop
  */
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), 0, (__pyx_v_newPos + 1), __pyx_int_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), 0, (__pyx_v_newPos + 1), __pyx_int_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         goto __pyx_L9;
       }
       __pyx_L9:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":236
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":193
  * 
  *             # Exit the main loop
  *             break             # <<<<<<<<<<<<<<
@@ -15245,7 +14911,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     }
     /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":240
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":197
  *         else:
  *             # Move one position back
  *             PyArray_ITER_GOTO1D(iterold, oldPos - 1)             # <<<<<<<<<<<<<<
@@ -15254,20 +14920,20 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
       PyArray_ITER_GOTO1D(__pyx_v_iterold, (__pyx_v_oldPos - 1));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":243
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":200
  * 
  *             # Get the index there
  *             prevOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *             # Until we reach the previous index
  */
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_v_prevOld);
       __pyx_v_prevOld = __pyx_t_5;
       __pyx_t_5 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":246
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":203
  * 
  *             # Until we reach the previous index
  *             while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > prevOld:             # <<<<<<<<<<<<<<
@@ -15275,16 +14941,16 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  *                 # Set the current fill location
  */
       while (1) {
-        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_prevOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_prevOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         if (!__pyx_t_7) break;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":249
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":206
  * 
  *                 # Set the current fill location
  *                 fillLocs[newPos] = curLoc             # <<<<<<<<<<<<<<
@@ -15293,7 +14959,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
         (__pyx_v_fillLocs[__pyx_v_newPos]) = __pyx_v_curLoc;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":250
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":207
  *                 # Set the current fill location
  *                 fillLocs[newPos] = curLoc
  *                 mask[newPos] = 1             # <<<<<<<<<<<<<<
@@ -15302,7 +14968,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
         (__pyx_v_mask[__pyx_v_newPos]) = 1;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":252
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":209
  *                 mask[newPos] = 1
  * 
  *                 newPos -= 1             # <<<<<<<<<<<<<<
@@ -15311,7 +14977,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
         __pyx_v_newPos -= 1;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":253
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":210
  * 
  *                 newPos -= 1
  *                 if newPos < 0:             # <<<<<<<<<<<<<<
@@ -15321,7 +14987,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
         __pyx_t_7 = (__pyx_v_newPos < 0);
         if (__pyx_t_7) {
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":254
+          /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":211
  *                 newPos -= 1
  *                 if newPos < 0:
  *                     break             # <<<<<<<<<<<<<<
@@ -15333,7 +14999,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
         }
         __pyx_L12:;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":257
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":214
  * 
  *                 # Move the iterator back
  *                 PyArray_ITER_GOTO1D(iternew, newPos)             # <<<<<<<<<<<<<<
@@ -15346,7 +15012,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     }
     __pyx_L8:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":260
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":217
  * 
  *         # Move one period back
  *         oldPos -= 1             # <<<<<<<<<<<<<<
@@ -15357,7 +15023,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   }
   __pyx_L4_break:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":262
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":219
  *         oldPos -= 1
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -15367,7 +15033,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":263
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":220
  * 
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -15377,7 +15043,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_t_7 = ((__pyx_v_mask[__pyx_v_i]) == 0);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":265
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":222
  *         if mask[i] == 0:
  *             # Fill from some generic location
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
@@ -15390,7 +15056,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_L15:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":267
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":224
  *             fillLocs[i] = -1
  * 
  *     return (fillVec, maskVec)             # <<<<<<<<<<<<<<
@@ -15398,7 +15064,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  * cdef tuple _pad(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
  */
   __Pyx_XDECREF(((PyObject *)__pyx_r));
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
   PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillVec));
@@ -15406,7 +15072,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __Pyx_INCREF(((PyObject *)__pyx_v_maskVec));
   PyTuple_SET_ITEM(__pyx_t_6, 1, ((PyObject *)__pyx_v_maskVec));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_maskVec));
-  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_r = ((PyObject *)__pyx_t_6);
   __pyx_t_6 = 0;
   goto __pyx_L0;
@@ -15437,7 +15103,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":269
+/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":226
  *     return (fillVec, maskVec)
  * 
  * cdef tuple _pad(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):             # <<<<<<<<<<<<<<
@@ -15483,36 +15149,36 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_v_nextOld = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_curOld = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":303
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":260
  * 
  *     # Make empty fill vector and mask vector, cast to ndarray
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -15522,36 +15188,36 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":304
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":261
  *     # Make empty fill vector and mask vector, cast to ndarray
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
  * 
  *     # Get reference to the arrays inside
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -15561,7 +15227,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":307
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":264
  * 
  *     # Get reference to the arrays inside
  *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
@@ -15570,7 +15236,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":308
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":265
  *     # Get reference to the arrays inside
  *     fillLocs = <int *> fillVec.data
  *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
@@ -15579,35 +15245,35 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":311
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":268
  * 
  *     # Create simple ndarray iterators using C API
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)             # <<<<<<<<<<<<<<
  *     iternew = <flatiter> PyArray_IterNew(newIndex)
  * 
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iterold));
   __pyx_v_iterold = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":312
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":269
  *     # Create simple ndarray iterators using C API
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)
  *     iternew = <flatiter> PyArray_IterNew(newIndex)             # <<<<<<<<<<<<<<
  * 
  *     # Length of each index
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iternew));
   __pyx_v_iternew = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":315
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":272
  * 
  *     # Length of each index
  *     oldLength = PyArray_SIZE(oldIndex)             # <<<<<<<<<<<<<<
@@ -15616,7 +15282,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_oldLength = PyArray_SIZE(__pyx_v_oldIndex);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":316
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":273
  *     # Length of each index
  *     oldLength = PyArray_SIZE(oldIndex)
  *     newLength = PyArray_SIZE(newIndex)             # <<<<<<<<<<<<<<
@@ -15625,7 +15291,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_newLength = PyArray_SIZE(__pyx_v_newIndex);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":318
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":275
  *     newLength = PyArray_SIZE(newIndex)
  * 
  *     oldPos = 0             # <<<<<<<<<<<<<<
@@ -15634,7 +15300,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_oldPos = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":319
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":276
  * 
  *     oldPos = 0
  *     newPos = 0             # <<<<<<<<<<<<<<
@@ -15643,7 +15309,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_newPos = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":320
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":277
  *     oldPos = 0
  *     newPos = 0
  *     while newPos < newLength:             # <<<<<<<<<<<<<<
@@ -15654,20 +15320,20 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_t_7 = (__pyx_v_newPos < __pyx_v_newLength);
     if (!__pyx_t_7) break;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":321
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":278
  *     newPos = 0
  *     while newPos < newLength:
  *         curOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *         # At beginning, keep going until we go exceed the
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_curOld);
     __pyx_v_curOld = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":325
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":282
  *         # At beginning, keep going until we go exceed the
  *         # first OLD index in the NEW index
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < curOld:             # <<<<<<<<<<<<<<
@@ -15675,16 +15341,16 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  *             if newPos > newLength - 1:
  */
     while (1) {
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (!__pyx_t_7) break;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":326
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":283
  *         # first OLD index in the NEW index
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < curOld:
  *             newPos += 1             # <<<<<<<<<<<<<<
@@ -15693,7 +15359,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
       __pyx_v_newPos += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":327
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":284
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < curOld:
  *             newPos += 1
  *             if newPos > newLength - 1:             # <<<<<<<<<<<<<<
@@ -15703,7 +15369,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       __pyx_t_7 = (__pyx_v_newPos > (__pyx_v_newLength - 1));
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":328
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":285
  *             newPos += 1
  *             if newPos > newLength - 1:
  *                 break             # <<<<<<<<<<<<<<
@@ -15715,7 +15381,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       }
       __pyx_L7:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":329
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":286
  *             if newPos > newLength - 1:
  *                 break
  *             PyArray_ITER_NEXT(iternew)             # <<<<<<<<<<<<<<
@@ -15726,20 +15392,20 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     }
     __pyx_L6_break:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":332
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":289
  * 
  *         # We got there, get the current location in the old index
  *         curLoc = oldMap[curOld]             # <<<<<<<<<<<<<<
  * 
  *         # We're at the end of the road, need to propagate this value to the end
  */
-    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_curLoc = __pyx_t_8;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":335
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":292
  * 
  *         # We're at the end of the road, need to propagate this value to the end
  *         if oldPos == oldLength - 1:             # <<<<<<<<<<<<<<
@@ -15749,47 +15415,47 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_t_7 = (__pyx_v_oldPos == (__pyx_v_oldLength - 1));
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":336
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":293
  *         # We're at the end of the road, need to propagate this value to the end
  *         if oldPos == oldLength - 1:
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) >= curOld:             # <<<<<<<<<<<<<<
  *                 fillVec[newPos:] = curLoc
  *                 maskVec[newPos:] = 1
  */
-      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_GE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_GE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":337
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":294
  *         if oldPos == oldLength - 1:
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) >= curOld:
  *                 fillVec[newPos:] = curLoc             # <<<<<<<<<<<<<<
  *                 maskVec[newPos:] = 1
  *             break
  */
-        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":338
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":295
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) >= curOld:
  *                 fillVec[newPos:] = curLoc
  *                 maskVec[newPos:] = 1             # <<<<<<<<<<<<<<
  *             break
  *         else:
  */
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_int_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_int_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         goto __pyx_L9;
       }
       __pyx_L9:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":339
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":296
  *                 fillVec[newPos:] = curLoc
  *                 maskVec[newPos:] = 1
  *             break             # <<<<<<<<<<<<<<
@@ -15801,7 +15467,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     }
     /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":344
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":301
  * 
  *             # Get the next index so we know when to stop propagating this value
  *             PyArray_ITER_NEXT(iterold)             # <<<<<<<<<<<<<<
@@ -15810,20 +15476,20 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
       PyArray_ITER_NEXT(__pyx_v_iterold);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":345
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":302
  *             # Get the next index so we know when to stop propagating this value
  *             PyArray_ITER_NEXT(iterold)
  *             nextOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *             done = 0
  */
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_v_nextOld);
       __pyx_v_nextOld = __pyx_t_5;
       __pyx_t_5 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":347
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":304
  *             nextOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))
  * 
  *             done = 0             # <<<<<<<<<<<<<<
@@ -15832,7 +15498,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
       __pyx_v_done = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":350
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":307
  * 
  *             # Until we reach the next OLD value in the NEW index
  *             while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < nextOld:             # <<<<<<<<<<<<<<
@@ -15840,16 +15506,16 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  *                 # Use this location to fill
  */
       while (1) {
-        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_nextOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_nextOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         if (!__pyx_t_7) break;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":353
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":310
  * 
  *                 # Use this location to fill
  *                 fillLocs[newPos] = curLoc             # <<<<<<<<<<<<<<
@@ -15858,7 +15524,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
         (__pyx_v_fillLocs[__pyx_v_newPos]) = __pyx_v_curLoc;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":356
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":313
  * 
  *                 # Set mask to be 1 so will not be NaN'd
  *                 mask[newPos] = 1             # <<<<<<<<<<<<<<
@@ -15867,7 +15533,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
         (__pyx_v_mask[__pyx_v_newPos]) = 1;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":357
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":314
  *                 # Set mask to be 1 so will not be NaN'd
  *                 mask[newPos] = 1
  *                 newPos += 1             # <<<<<<<<<<<<<<
@@ -15876,7 +15542,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
         __pyx_v_newPos += 1;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":360
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":317
  * 
  *                 # We got to the end of the new index
  *                 if newPos > newLength - 1:             # <<<<<<<<<<<<<<
@@ -15886,7 +15552,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
         __pyx_t_7 = (__pyx_v_newPos > (__pyx_v_newLength - 1));
         if (__pyx_t_7) {
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":361
+          /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":318
  *                 # We got to the end of the new index
  *                 if newPos > newLength - 1:
  *                     done = 1             # <<<<<<<<<<<<<<
@@ -15895,7 +15561,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
           __pyx_v_done = 1;
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":362
+          /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":319
  *                 if newPos > newLength - 1:
  *                     done = 1
  *                     break             # <<<<<<<<<<<<<<
@@ -15907,7 +15573,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
         }
         __pyx_L12:;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":365
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":322
  * 
  *                 # Advance the pointer
  *                 PyArray_ITER_NEXT(iternew)             # <<<<<<<<<<<<<<
@@ -15918,7 +15584,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       }
       __pyx_L11_break:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":368
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":325
  * 
  *             # We got to the end of the new index
  *             if done:             # <<<<<<<<<<<<<<
@@ -15928,7 +15594,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       __pyx_t_9 = __pyx_v_done;
       if (__pyx_t_9) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":369
+        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":326
  *             # We got to the end of the new index
  *             if done:
  *                 break             # <<<<<<<<<<<<<<
@@ -15942,7 +15608,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     }
     __pyx_L8:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":373
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":330
  *         # We already advanced the iterold pointer to the next value,
  *         # inc the count
  *         oldPos += 1             # <<<<<<<<<<<<<<
@@ -15953,7 +15619,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   }
   __pyx_L4_break:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":377
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":334
  *     # Places where the mask is 0, fill with an arbitrary value
  *     # (will be NA'd out)
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -15963,7 +15629,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":378
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":335
  *     # (will be NA'd out)
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -15973,7 +15639,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_t_7 = ((__pyx_v_mask[__pyx_v_i]) == 0);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":379
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":336
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
@@ -15986,7 +15652,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_L16:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":381
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":338
  *             fillLocs[i] = -1
  * 
  *     return fillVec, maskVec             # <<<<<<<<<<<<<<
@@ -15994,7 +15660,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  * def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,
  */
   __Pyx_XDECREF(((PyObject *)__pyx_r));
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
   PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillVec));
@@ -16002,7 +15668,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __Pyx_INCREF(((PyObject *)__pyx_v_maskVec));
   PyTuple_SET_ITEM(__pyx_t_6, 1, ((PyObject *)__pyx_v_maskVec));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_maskVec));
-  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_r = ((PyObject *)__pyx_t_6);
   __pyx_t_6 = 0;
   goto __pyx_L0;
@@ -16033,7 +15699,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":383
+/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":340
  *     return fillVec, maskVec
  * 
  * def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,             # <<<<<<<<<<<<<<
@@ -16055,6 +15721,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__oldIndex,&__pyx_n_s__newIndex,&__pyx_n_s__oldMap,&__pyx_n_s__newMap,&__pyx_n_s__kind,0};
   __Pyx_RefNannySetupContext("getFillVec");
   __pyx_self = __pyx_self;
@@ -16079,29 +15746,29 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__newIndex);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__oldMap);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__newMap);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 3); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 3); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  4:
       values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__kind);
       if (likely(values[4])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 4); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 4); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getFillVec") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getFillVec") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_oldIndex = ((PyArrayObject *)values[0]);
     __pyx_v_newIndex = ((PyArrayObject *)values[1]);
@@ -16119,7 +15786,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.getFillVec");
   return NULL;
@@ -16131,189 +15798,214 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   __Pyx_INCREF(__pyx_v_kind);
   __pyx_v_fillVec = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_maskVec = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldIndex), __pyx_ptype_5numpy_ndarray, 1, "oldIndex", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newIndex), __pyx_ptype_5numpy_ndarray, 1, "newIndex", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newMap), &PyDict_Type, 1, "newMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldIndex), __pyx_ptype_5numpy_ndarray, 1, "oldIndex", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newIndex), __pyx_ptype_5numpy_ndarray, 1, "newIndex", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newMap), &PyDict_Type, 1, "newMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":386
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":343
  *                object kind):
  * 
  *     if kind == '':             # <<<<<<<<<<<<<<
- *         fillVec, maskVec = _nofill(oldIndex, newIndex, oldMap, newMap)
+ *         fillVec, maskVec = _nofill(newIndex, oldMap)
  *     elif kind == 'PAD':
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_kp_s_5), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_kp_s_5), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":387
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":344
  * 
  *     if kind == '':
- *         fillVec, maskVec = _nofill(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
+ *         fillVec, maskVec = _nofill(newIndex, oldMap)             # <<<<<<<<<<<<<<
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  */
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__nofill(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s___nofill); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    if (likely(__pyx_t_1 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_1) == 2)) {
-      PyObject* tuple = __pyx_t_1;
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_INCREF(((PyObject *)__pyx_v_newIndex));
+    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_newIndex));
+    __Pyx_GIVEREF(((PyObject *)__pyx_v_newIndex));
+    __Pyx_INCREF(((PyObject *)__pyx_v_oldMap));
+    PyTuple_SET_ITEM(__pyx_t_3, 1, ((PyObject *)__pyx_v_oldMap));
+    __Pyx_GIVEREF(((PyObject *)__pyx_v_oldMap));
+    __pyx_t_4 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (PyTuple_CheckExact(__pyx_t_4) && likely(PyTuple_GET_SIZE(__pyx_t_4) == 2)) {
+      PyObject* tuple = __pyx_t_4;
       __pyx_t_3 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_3);
-      __pyx_t_4 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_4);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
       __pyx_v_fillVec = __pyx_t_3;
       __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_v_maskVec);
-      __pyx_v_maskVec = __pyx_t_4;
-      __pyx_t_4 = 0;
+      __pyx_v_maskVec = __pyx_t_1;
+      __pyx_t_1 = 0;
     } else {
-      __Pyx_UnpackTupleError(__pyx_t_1, 2);
-      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_3 = __Pyx_UnpackItem(__pyx_t_5, 0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_1 = __Pyx_UnpackItem(__pyx_t_5, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_1);
+      if (__Pyx_EndUnpack(__pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_v_fillVec);
+      __pyx_v_fillVec = __pyx_t_3;
+      __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_v_maskVec);
+      __pyx_v_maskVec = __pyx_t_1;
+      __pyx_t_1 = 0;
     }
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":388
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":345
  *     if kind == '':
- *         fillVec, maskVec = _nofill(oldIndex, newIndex, oldMap, newMap)
+ *         fillVec, maskVec = _nofill(newIndex, oldMap)
  *     elif kind == 'PAD':             # <<<<<<<<<<<<<<
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__PAD), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_4 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__PAD), Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":389
- *         fillVec, maskVec = _nofill(oldIndex, newIndex, oldMap, newMap)
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":346
+ *         fillVec, maskVec = _nofill(newIndex, oldMap)
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
  *     elif kind == 'BACKFILL':
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  */
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__pad(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    if (likely(__pyx_t_1 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_1) == 2)) {
-      PyObject* tuple = __pyx_t_1;
-      __pyx_t_4 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_4);
+    __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__pad(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    if (likely(__pyx_t_4 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_4) == 2)) {
+      PyObject* tuple = __pyx_t_4;
+      __pyx_t_1 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_1);
       __pyx_t_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
-      __pyx_v_fillVec = __pyx_t_4;
-      __pyx_t_4 = 0;
+      __pyx_v_fillVec = __pyx_t_1;
+      __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_v_maskVec);
       __pyx_v_maskVec = __pyx_t_3;
       __pyx_t_3 = 0;
     } else {
-      __Pyx_UnpackTupleError(__pyx_t_1, 2);
-      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_UnpackTupleError(__pyx_t_4, 2);
+      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":390
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":347
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':             # <<<<<<<<<<<<<<
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  *     else:
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__BACKFILL), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_4 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__BACKFILL), Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":391
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":348
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
  *     else:
  *         raise Exception("Don't recognize fillMethod: %s" % kind)
  */
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__backfill(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    if (likely(__pyx_t_1 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_1) == 2)) {
-      PyObject* tuple = __pyx_t_1;
+    __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__backfill(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    if (likely(__pyx_t_4 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_4) == 2)) {
+      PyObject* tuple = __pyx_t_4;
       __pyx_t_3 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_3);
-      __pyx_t_4 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_4);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
       __pyx_v_fillVec = __pyx_t_3;
       __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_v_maskVec);
-      __pyx_v_maskVec = __pyx_t_4;
-      __pyx_t_4 = 0;
+      __pyx_v_maskVec = __pyx_t_1;
+      __pyx_t_1 = 0;
     } else {
-      __Pyx_UnpackTupleError(__pyx_t_1, 2);
-      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_UnpackTupleError(__pyx_t_4, 2);
+      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     goto __pyx_L6;
   }
   /*else*/ {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":393
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":350
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  *     else:
  *         raise Exception("Don't recognize fillMethod: %s" % kind)             # <<<<<<<<<<<<<<
  * 
  *     return fillVec, maskVec.astype(np.bool)
  */
-    __pyx_t_1 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_6), __pyx_v_kind); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_6), __pyx_v_kind); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
-    __Pyx_GIVEREF(__pyx_t_1);
-    __pyx_t_1 = 0;
-    __pyx_t_1 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_Raise(__pyx_t_1, 0, 0);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_4);
+    __pyx_t_4 = 0;
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_Raise(__pyx_t_4, 0, 0);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":395
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":352
  *         raise Exception("Don't recognize fillMethod: %s" % kind)
  * 
  *     return fillVec, maskVec.astype(np.bool)             # <<<<<<<<<<<<<<
  * 
- * def getMergeVec(ndarray values, dict indexMap):
+ * def getMergeVec(ndarray values, dict oldMap):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_v_maskVec, __pyx_n_s__astype); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_v_maskVec, __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__bool); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__bool); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_fillVec);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_fillVec);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_fillVec);
   __Pyx_GIVEREF(__pyx_v_fillVec);
-  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_r = __pyx_t_4;
-  __pyx_t_4 = 0;
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
@@ -16322,6 +16014,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
   __Pyx_AddTraceback("tseries.getFillVec");
   __pyx_r = NULL;
   __pyx_L0:;
@@ -16337,28 +16030,30 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":397
+/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":354
  *     return fillVec, maskVec.astype(np.bool)
  * 
- * def getMergeVec(ndarray values, dict indexMap):             # <<<<<<<<<<<<<<
- *     cdef int *fillLocs
- *     cdef char *mask
+ * def getMergeVec(ndarray values, dict oldMap):             # <<<<<<<<<<<<<<
+ *     cdef int i, j, length, newLength
+ * 
  */
 
 static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_values = 0;
-  PyObject *__pyx_v_indexMap = 0;
-  int *__pyx_v_fillLocs;
-  char *__pyx_v_mask;
+  PyObject *__pyx_v_oldMap = 0;
   int __pyx_v_i;
-  int __pyx_v_j;
-  int __pyx_v_length;
-  PyArrayIterObject *__pyx_v_itervals;
-  PyObject *__pyx_v_val;
-  PyArrayObject *__pyx_v_fillVec;
-  PyArrayObject *__pyx_v_maskVec;
   int __pyx_v_newLength;
+  PyArrayIterObject *__pyx_v_iternew;
+  PyObject *__pyx_v_idx;
+  PyArrayObject *__pyx_v_fillLocs;
+  PyArrayObject *__pyx_v_mask;
+  Py_buffer __pyx_bstruct_mask;
+  Py_ssize_t __pyx_bstride_0_mask = 0;
+  Py_ssize_t __pyx_bshape_0_mask = 0;
+  Py_buffer __pyx_bstruct_fillLocs;
+  Py_ssize_t __pyx_bstride_0_fillLocs = 0;
+  Py_ssize_t __pyx_bshape_0_fillLocs = 0;
   PyObject *__pyx_r = NULL;
   Py_ssize_t __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -16366,10 +16061,20 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
-  int __pyx_t_7;
+  PyArrayObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
-  int __pyx_t_9;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__values,&__pyx_n_s__indexMap,0};
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  PyObject *__pyx_t_11 = NULL;
+  PyArrayObject *__pyx_t_12 = NULL;
+  int __pyx_t_13;
+  __pyx_t_5numpy_int32_t __pyx_t_14;
+  int __pyx_t_15;
+  int __pyx_t_16;
+  int __pyx_t_17;
+  int __pyx_t_18;
+  int __pyx_t_19;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__values,&__pyx_n_s__oldMap,0};
   __Pyx_RefNannySetupContext("getMergeVec");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
@@ -16387,308 +16092,348 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__indexMap);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__oldMap);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getMergeVec") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getMergeVec") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_values = ((PyArrayObject *)values[0]);
-    __pyx_v_indexMap = ((PyObject *)values[1]);
+    __pyx_v_oldMap = ((PyObject *)values[1]);
   } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_values = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_indexMap = ((PyObject *)PyTuple_GET_ITEM(__pyx_args, 1));
+    __pyx_v_oldMap = ((PyObject *)PyTuple_GET_ITEM(__pyx_args, 1));
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.getMergeVec");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_values);
-  __Pyx_INCREF(__pyx_v_indexMap);
-  __pyx_v_itervals = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_val = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_fillVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_maskVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_indexMap), &PyDict_Type, 1, "indexMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_INCREF(__pyx_v_oldMap);
+  __pyx_v_iternew = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
+  __pyx_v_fillLocs = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_bstruct_fillLocs.buf = NULL;
+  __pyx_bstruct_mask.buf = NULL;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":407
- *     cdef ndarray maskVec
- * 
- *     cdef int newLength = len(values)             # <<<<<<<<<<<<<<
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":362
+ *     cdef ndarray[int8_t, ndim=1] mask
  * 
- *     fillVec = <ndarray> np.empty(newLength, dtype = np.int32)
+ *     newLength = len(values)             # <<<<<<<<<<<<<<
+ *     fillLocs = np.empty(newLength, dtype=np.int32)
+ *     mask = np.zeros(newLength, dtype=np.int8)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_values)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_values)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_newLength = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":409
- *     cdef int newLength = len(values)
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":363
  * 
- *     fillVec = <ndarray> np.empty(newLength, dtype = np.int32)             # <<<<<<<<<<<<<<
- *     maskVec = <ndarray> np.zeros(newLength, dtype = np.int8)
+ *     newLength = len(values)
+ *     fillLocs = np.empty(newLength, dtype=np.int32)             # <<<<<<<<<<<<<<
+ *     mask = np.zeros(newLength, dtype=np.int8)
  * 
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_6)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_fillVec));
-  __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_fillLocs);
+    __pyx_t_8 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_fillLocs, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_8 < 0)) {
+      PyErr_Fetch(&__pyx_t_9, &__pyx_t_10, &__pyx_t_11);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_fillLocs, (PyObject*)__pyx_v_fillLocs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_9, __pyx_t_10, __pyx_t_11);
+      }
+    }
+    __pyx_bstride_0_fillLocs = __pyx_bstruct_fillLocs.strides[0];
+    __pyx_bshape_0_fillLocs = __pyx_bstruct_fillLocs.shape[0];
+    if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_t_7 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_fillLocs));
+  __pyx_v_fillLocs = ((PyArrayObject *)__pyx_t_6);
+  __pyx_t_6 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":410
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":364
+ *     newLength = len(values)
+ *     fillLocs = np.empty(newLength, dtype=np.int32)
+ *     mask = np.zeros(newLength, dtype=np.int8)             # <<<<<<<<<<<<<<
  * 
- *     fillVec = <ndarray> np.empty(newLength, dtype = np.int32)
- *     maskVec = <ndarray> np.zeros(newLength, dtype = np.int8)             # <<<<<<<<<<<<<<
- * 
- *     fillLocs = <int *> fillVec.data
+ *     iternew = <flatiter> PyArray_IterNew(values)
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
-  __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_maskVec));
-  __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":412
- *     maskVec = <ndarray> np.zeros(newLength, dtype = np.int8)
- * 
- *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
- *     mask = <char *> maskVec.data
- * 
- */
-  __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":413
- * 
- *     fillLocs = <int *> fillVec.data
- *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
- * 
- *     length = PyArray_SIZE(values)
- */
-  __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":415
- *     mask = <char *> maskVec.data
- * 
- *     length = PyArray_SIZE(values)             # <<<<<<<<<<<<<<
- *     itervals = <flatiter> PyArray_IterNew(values)
- * 
- */
-  __pyx_v_length = PyArray_SIZE(__pyx_v_values);
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_12 = ((PyArrayObject *)__pyx_t_5);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mask);
+    __pyx_t_8 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_mask, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_8 < 0)) {
+      PyErr_Fetch(&__pyx_t_11, &__pyx_t_10, &__pyx_t_9);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_mask, (PyObject*)__pyx_v_mask, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_11, __pyx_t_10, __pyx_t_9);
+      }
+    }
+    __pyx_bstride_0_mask = __pyx_bstruct_mask.strides[0];
+    __pyx_bshape_0_mask = __pyx_bstruct_mask.shape[0];
+    if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_t_12 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_mask));
+  __pyx_v_mask = ((PyArrayObject *)__pyx_t_5);
+  __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":416
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":366
+ *     mask = np.zeros(newLength, dtype=np.int8)
  * 
- *     length = PyArray_SIZE(values)
- *     itervals = <flatiter> PyArray_IterNew(values)             # <<<<<<<<<<<<<<
+ *     iternew = <flatiter> PyArray_IterNew(values)             # <<<<<<<<<<<<<<
  * 
- *     for i from 0 <= i < length:
+ *     for i from 0 <= i < newLength:
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_values)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_values)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_itervals));
-  __pyx_v_itervals = ((PyArrayIterObject *)__pyx_t_5);
+  __Pyx_DECREF(((PyObject *)__pyx_v_iternew));
+  __pyx_v_iternew = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":418
- *     itervals = <flatiter> PyArray_IterNew(values)
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":368
+ *     iternew = <flatiter> PyArray_IterNew(values)
+ * 
+ *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
+ *         idx = PyArray_GETITEM(values, PyArray_ITER_DATA(iternew))
  * 
- *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
- *         val = PyArray_GETITEM(values, PyArray_ITER_DATA(itervals))
- *         if val in indexMap:
  */
-  __pyx_t_7 = __pyx_v_length;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
+  __pyx_t_8 = __pyx_v_newLength;
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":419
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":369
  * 
- *     for i from 0 <= i < length:
- *         val = PyArray_GETITEM(values, PyArray_ITER_DATA(itervals))             # <<<<<<<<<<<<<<
- *         if val in indexMap:
- *             j = indexMap[val]
+ *     for i from 0 <= i < newLength:
+ *         idx = PyArray_GETITEM(values, PyArray_ITER_DATA(iternew))             # <<<<<<<<<<<<<<
+ * 
+ *         if idx in oldMap:
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_values, PyArray_ITER_DATA(__pyx_v_itervals)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_values, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_v_val);
-    __pyx_v_val = __pyx_t_5;
+    __Pyx_DECREF(__pyx_v_idx);
+    __pyx_v_idx = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":420
- *     for i from 0 <= i < length:
- *         val = PyArray_GETITEM(values, PyArray_ITER_DATA(itervals))
- *         if val in indexMap:             # <<<<<<<<<<<<<<
- *             j = indexMap[val]
- *             fillLocs[i] = j
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":371
+ *         idx = PyArray_GETITEM(values, PyArray_ITER_DATA(iternew))
+ * 
+ *         if idx in oldMap:             # <<<<<<<<<<<<<<
+ *             fillLocs[i] = oldMap[idx]
+ *             mask[i] = 1
  */
-    if (unlikely(((PyObject *)__pyx_v_indexMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(((PyObject *)__pyx_v_oldMap) == Py_None)) {
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_8 = ((PyDict_Contains(((PyObject *)__pyx_v_indexMap), __pyx_v_val))); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_13 = ((PyDict_Contains(((PyObject *)__pyx_v_oldMap), __pyx_v_idx))); if (unlikely(__pyx_t_13 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    if (__pyx_t_8) {
+    if (__pyx_t_13) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":421
- *         val = PyArray_GETITEM(values, PyArray_ITER_DATA(itervals))
- *         if val in indexMap:
- *             j = indexMap[val]             # <<<<<<<<<<<<<<
- *             fillLocs[i] = j
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":372
+ * 
+ *         if idx in oldMap:
+ *             fillLocs[i] = oldMap[idx]             # <<<<<<<<<<<<<<
  *             mask[i] = 1
+ * 
  */
-      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_indexMap), __pyx_v_val); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_t_5); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_14 = __Pyx_PyInt_from_py_npy_int32(__pyx_t_5); if (unlikely((__pyx_t_14 == (npy_int32)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_v_j = __pyx_t_9;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":422
- *         if val in indexMap:
- *             j = indexMap[val]
- *             fillLocs[i] = j             # <<<<<<<<<<<<<<
- *             mask[i] = 1
- * 
- */
-      (__pyx_v_fillLocs[__pyx_v_i]) = __pyx_v_j;
+      __pyx_t_15 = __pyx_v_i;
+      __pyx_t_16 = -1;
+      if (__pyx_t_15 < 0) {
+        __pyx_t_15 += __pyx_bshape_0_fillLocs;
+        if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
+      } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_fillLocs)) __pyx_t_16 = 0;
+      if (unlikely(__pyx_t_16 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_16);
+        {__pyx_filename = __pyx_f[3]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_bstruct_fillLocs.buf, __pyx_t_15, __pyx_bstride_0_fillLocs) = __pyx_t_14;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":423
- *             j = indexMap[val]
- *             fillLocs[i] = j
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":373
+ *         if idx in oldMap:
+ *             fillLocs[i] = oldMap[idx]
  *             mask[i] = 1             # <<<<<<<<<<<<<<
  * 
- *         PyArray_ITER_NEXT(itervals)
+ *         PyArray_ITER_NEXT(iternew)
  */
-      (__pyx_v_mask[__pyx_v_i]) = 1;
+      __pyx_t_16 = __pyx_v_i;
+      __pyx_t_17 = -1;
+      if (__pyx_t_16 < 0) {
+        __pyx_t_16 += __pyx_bshape_0_mask;
+        if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
+      } else if (unlikely(__pyx_t_16 >= __pyx_bshape_0_mask)) __pyx_t_17 = 0;
+      if (unlikely(__pyx_t_17 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_17);
+        {__pyx_filename = __pyx_f[3]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_16, __pyx_bstride_0_mask) = 1;
       goto __pyx_L8;
     }
     __pyx_L8:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":425
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":375
  *             mask[i] = 1
  * 
- *         PyArray_ITER_NEXT(itervals)             # <<<<<<<<<<<<<<
+ *         PyArray_ITER_NEXT(iternew)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < newLength:
  */
-    PyArray_ITER_NEXT(__pyx_v_itervals);
+    PyArray_ITER_NEXT(__pyx_v_iternew);
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":427
- *         PyArray_ITER_NEXT(itervals)
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":377
+ *         PyArray_ITER_NEXT(iternew)
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
  *         if mask[i] == 0:
  *             fillLocs[i] = -1
  */
-  __pyx_t_7 = __pyx_v_newLength;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
+  __pyx_t_8 = __pyx_v_newLength;
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":428
+    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":378
  * 
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
  *             fillLocs[i] = -1
  * 
  */
-    __pyx_t_8 = ((__pyx_v_mask[__pyx_v_i]) == 0);
-    if (__pyx_t_8) {
+    __pyx_t_17 = __pyx_v_i;
+    __pyx_t_18 = -1;
+    if (__pyx_t_17 < 0) {
+      __pyx_t_17 += __pyx_bshape_0_mask;
+      if (unlikely(__pyx_t_17 < 0)) __pyx_t_18 = 0;
+    } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_mask)) __pyx_t_18 = 0;
+    if (unlikely(__pyx_t_18 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_18);
+      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_t_13 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_17, __pyx_bstride_0_mask)) == 0);
+    if (__pyx_t_13) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":429
+      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":379
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
  * 
- *     return fillVec, maskVec.astype(np.bool)
- */
-      (__pyx_v_fillLocs[__pyx_v_i]) = -1;
+ *     return fillLocs, mask.astype(bool)
+ */
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_19 = -1;
+      if (__pyx_t_18 < 0) {
+        __pyx_t_18 += __pyx_bshape_0_fillLocs;
+        if (unlikely(__pyx_t_18 < 0)) __pyx_t_19 = 0;
+      } else if (unlikely(__pyx_t_18 >= __pyx_bshape_0_fillLocs)) __pyx_t_19 = 0;
+      if (unlikely(__pyx_t_19 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_19);
+        {__pyx_filename = __pyx_f[3]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_bstruct_fillLocs.buf, __pyx_t_18, __pyx_bstride_0_fillLocs) = -1;
       goto __pyx_L11;
     }
     __pyx_L11:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":431
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":381
  *             fillLocs[i] = -1
  * 
- *     return fillVec, maskVec.astype(np.bool)             # <<<<<<<<<<<<<<
+ *     return fillLocs, mask.astype(bool)             # <<<<<<<<<<<<<<
  * 
+ * # def _nofill(ndarray newIndex, dict oldMap):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_maskVec), __pyx_n_s__astype); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__bool); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_6);
-  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
-  __Pyx_GIVEREF(__pyx_t_4);
-  __pyx_t_4 = 0;
-  __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
+  PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
+  __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
+  __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
-  PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillVec));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_fillVec));
+  __Pyx_INCREF(((PyObject *)__pyx_v_fillLocs));
+  PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillLocs));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_fillLocs));
   PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   __pyx_t_4 = 0;
@@ -16704,15 +16449,24 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mask);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_fillLocs);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
   __Pyx_AddTraceback("tseries.getMergeVec");
   __pyx_r = NULL;
+  goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_itervals);
-  __Pyx_DECREF(__pyx_v_val);
-  __Pyx_DECREF((PyObject *)__pyx_v_fillVec);
-  __Pyx_DECREF((PyObject *)__pyx_v_maskVec);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mask);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_fillLocs);
+  __pyx_L2:;
+  __Pyx_DECREF((PyObject *)__pyx_v_iternew);
+  __Pyx_DECREF(__pyx_v_idx);
+  __Pyx_DECREF((PyObject *)__pyx_v_fillLocs);
+  __Pyx_DECREF((PyObject *)__pyx_v_mask);
   __Pyx_DECREF((PyObject *)__pyx_v_values);
-  __Pyx_DECREF(__pyx_v_indexMap);
+  __Pyx_DECREF(__pyx_v_oldMap);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
@@ -20157,6 +19911,7 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s____pow__, __pyx_k____pow__, sizeof(__pyx_k____pow__), 0, 0, 1, 1},
   {&__pyx_n_s____sub__, __pyx_k____sub__, sizeof(__pyx_k____sub__), 0, 0, 1, 1},
   {&__pyx_n_s___ewma, __pyx_k___ewma, sizeof(__pyx_k___ewma), 0, 0, 1, 1},
+  {&__pyx_n_s___nofill, __pyx_k___nofill, sizeof(__pyx_k___nofill), 0, 0, 1, 1},
   {&__pyx_n_s___roll_kurt, __pyx_k___roll_kurt, sizeof(__pyx_k___roll_kurt), 0, 0, 1, 1},
   {&__pyx_n_s___roll_mean, __pyx_k___roll_mean, sizeof(__pyx_k___roll_mean), 0, 0, 1, 1},
   {&__pyx_n_s___roll_median, __pyx_k___roll_median, sizeof(__pyx_k___roll_median), 0, 0, 1, 1},
@@ -20190,10 +19945,10 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__format, __pyx_k__format, sizeof(__pyx_k__format), 0, 0, 1, 1},
   {&__pyx_n_s__func, __pyx_k__func, sizeof(__pyx_k__func), 0, 0, 1, 1},
   {&__pyx_n_s__get, __pyx_k__get, sizeof(__pyx_k__get), 0, 0, 1, 1},
+  {&__pyx_n_s__getMergeVec, __pyx_k__getMergeVec, sizeof(__pyx_k__getMergeVec), 0, 0, 1, 1},
   {&__pyx_n_s__head, __pyx_k__head, sizeof(__pyx_k__head), 0, 0, 1, 1},
   {&__pyx_n_s__idxMap, __pyx_k__idxMap, sizeof(__pyx_k__idxMap), 0, 0, 1, 1},
   {&__pyx_n_s__index, __pyx_k__index, sizeof(__pyx_k__index), 0, 0, 1, 1},
-  {&__pyx_n_s__indexMap, __pyx_k__indexMap, sizeof(__pyx_k__indexMap), 0, 0, 1, 1},
   {&__pyx_n_s__inf, __pyx_k__inf, sizeof(__pyx_k__inf), 0, 0, 1, 1},
   {&__pyx_n_s__input, __pyx_k__input, sizeof(__pyx_k__input), 0, 0, 1, 1},
   {&__pyx_n_s__insert, __pyx_k__insert, sizeof(__pyx_k__insert), 0, 0, 1, 1},
@@ -20545,6 +20300,16 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   __pyx_v_7tseries_NEGINF = (-__pyx_v_7tseries_INF);
 
+  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":410
+ * 
+ * #     return fillLocs, mask.astype(bool)
+ * _nofill = getMergeVec             # <<<<<<<<<<<<<<
+ */
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__getMergeVec); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s___nofill, __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
   /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/python_dict.pxd":1
  * from python_ref cimport PyObject             # <<<<<<<<<<<<<<
  * 
@@ -21578,6 +21343,47 @@ static CYTHON_INLINE npy_intp __Pyx_PyInt_from_py_npy_intp(PyObject* x) {
     return (npy_intp)-1;
 }
 
+static CYTHON_INLINE npy_int32 __Pyx_PyInt_from_py_npy_int32(PyObject* x) {
+    const npy_int32 neg_one = (npy_int32)-1, const_zero = 0;
+    const int is_unsigned = neg_one > const_zero;
+    if (sizeof(npy_int32) == sizeof(char)) {
+        if (is_unsigned)
+            return (npy_int32)__Pyx_PyInt_AsUnsignedChar(x);
+        else
+            return (npy_int32)__Pyx_PyInt_AsSignedChar(x);
+    } else if (sizeof(npy_int32) == sizeof(short)) {
+        if (is_unsigned)
+            return (npy_int32)__Pyx_PyInt_AsUnsignedShort(x);
+        else
+            return (npy_int32)__Pyx_PyInt_AsSignedShort(x);
+    } else if (sizeof(npy_int32) == sizeof(int)) {
+        if (is_unsigned)
+            return (npy_int32)__Pyx_PyInt_AsUnsignedInt(x);
+        else
+            return (npy_int32)__Pyx_PyInt_AsSignedInt(x);
+    } else if (sizeof(npy_int32) == sizeof(long)) {
+        if (is_unsigned)
+            return (npy_int32)__Pyx_PyInt_AsUnsignedLong(x);
+        else
+            return (npy_int32)__Pyx_PyInt_AsSignedLong(x);
+    } else if (sizeof(npy_int32) == sizeof(PY_LONG_LONG)) {
+        if (is_unsigned)
+            return (npy_int32)__Pyx_PyInt_AsUnsignedLongLong(x);
+        else
+            return (npy_int32)__Pyx_PyInt_AsSignedLongLong(x);
+#if 0
+    } else if (sizeof(npy_int32) > sizeof(short) &&
+               sizeof(npy_int32) < sizeof(int)) { /*  __int32 ILP64 ? */
+        if (is_unsigned)
+            return (npy_int32)__Pyx_PyInt_AsUnsignedInt(x);
+        else
+            return (npy_int32)__Pyx_PyInt_AsSignedInt(x);
+#endif
+    }
+    PyErr_SetString(PyExc_TypeError, "npy_int32");
+    return (npy_int32)-1;
+}
+
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
