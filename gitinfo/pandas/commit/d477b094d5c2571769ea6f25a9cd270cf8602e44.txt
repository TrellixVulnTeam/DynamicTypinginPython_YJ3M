commit d477b094d5c2571769ea6f25a9cd270cf8602e44
Author: y-p <yoval@gmx.com>
Date:   Mon Apr 22 14:33:26 2013 +0300

    BUG: rework get_console_size to handle cases properly

diff --git a/pandas/core/format.py b/pandas/core/format.py
index 527730651..5a464c2c5 100644
--- a/pandas/core/format.py
+++ b/pandas/core/format.py
@@ -1675,16 +1675,37 @@ def detect_console_encoding():
 
 
 def get_console_size():
-    """Return console size as tuple = (width, height)."""
+    """Return console size as tuple = (width, height).
+
+    May return (None,None) in some cases.
+    """
     display_width = get_option('display.width')
     display_height = get_option('display.height')
 
-    if com.in_interactive_session() and not com.in_ipnb_frontend():
-        # pure terminal
-        terminal_width, terminal_height = get_terminal_size()
+    # Consider
+    # interactive shell terminal, can detect term size
+    # interactive non-shell terminal (ipnb/ipqtconsole), cannot detect term size
+    # non-interactive script, should disregard term size
+
+    # in addition
+    # width,height have default values, but setting to 'None' signals
+    # should use Auto-Detection, But only in interactive shell-terminal.
+    # Simple. yeah.
+
+    if com.in_interactive_session():
+        if com.in_ipnb_frontend():
+            # sane defaults for interactive non-shell terminal
+            # match default for width,height in config_init
+            terminal_width, terminal_height = 100, 60
+        else:
+            # pure terminal
+            terminal_width, terminal_height = get_terminal_size()
     else:
-        terminal_width, terminal_height = 100, 60
+        terminal_width, terminal_height = None,None
 
+    # Note if the User sets width/Height to None (auto-detection)
+    # and we're in a script (non-inter), this will return (None,None)
+    # caller needs to deal.
     return (display_width or terminal_width, display_height or terminal_height)
 
 
