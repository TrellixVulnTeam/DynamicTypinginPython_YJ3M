commit dc0db65e0f6158c381469ebc32fcbf8e08ca362b
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sat Sep 8 21:33:32 2012 -0400

    BUG: bugs in DataFrame.duplicated with datetime64 columns close #1833

diff --git a/RELEASE.rst b/RELEASE.rst
index fbe147be0..3f371d89c 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -51,6 +51,7 @@ pandas 0.9.0
   - Don't modify NumPy suppress printoption at import time
   - The internal HDF5 data arrangement for DataFrames has been
     transposed. Legacy files will still be readable by HDFStore (#1834, #1824)
+  - Legacy cruft removed: pandas.stats.misc.quantileTS
 
 **Bug fixes**
 
@@ -118,6 +119,7 @@ pandas 0.9.0
   - Fix bug in __doc__ patching when -OO passed to interpreter (#1792, #1741)
   - Fix unicode console encoding issue in IPython notebook (#1782, #1768)
   - Fix unicode formatting issue with Series.name (#1782)
+  - Fix bug in DataFrame.duplicated with datetime64 columns (#1833)
 
 pandas 0.8.1
 ============
diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index a6d35b7e5..3b816e860 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -2663,11 +2663,17 @@ class DataFrame(NDFrame):
         -------
         duplicated : Series
         """
+        # kludge for #1833
+        def _m8_to_i8(x):
+            if issubclass(x.dtype.type, np.datetime64):
+                return x.view(np.int64)
+            return x
+
         if cols is None:
-            values = list(self.values.T)
+            values = list(_m8_to_i8(self.values.T))
         else:
             if np.iterable(cols):
-                values = [self[x].values for x in cols]
+                values = [_m8_to_i8(self[x].values) for x in cols]
             else:
                 values = [self[cols]]
 
diff --git a/pandas/tseries/tests/test_timeseries.py b/pandas/tseries/tests/test_timeseries.py
index 886dbad7e..6f22b2b48 100644
--- a/pandas/tseries/tests/test_timeseries.py
+++ b/pandas/tseries/tests/test_timeseries.py
@@ -1085,6 +1085,17 @@ class TestTimeSeries(unittest.TestCase):
 
         result = df.to_records(index=False)
 
+    def test_frame_datetime64_duplicated(self):
+        dates = date_range('2010-07-01', end='2010-08-05')
+
+        tst = DataFrame({'symbol': 'AAA', 'date': dates})
+        result = tst.duplicated(['date', 'symbol'])
+        self.assert_((-result).all())
+
+        tst = DataFrame({'date': dates})
+        result = tst.duplicated()
+        self.assert_((-result).all())
+
 def _simple_ts(start, end, freq='D'):
     rng = date_range(start, end, freq=freq)
     return Series(np.random.randn(len(rng)), index=rng)
