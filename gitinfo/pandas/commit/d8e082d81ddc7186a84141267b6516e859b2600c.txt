commit d8e082d81ddc7186a84141267b6516e859b2600c
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Tue Apr 10 12:04:22 2012 -0400

    BUG: check array lengths in vec_compare/vec_binop in Cython, close #1016

diff --git a/pandas/src/tseries.pyx b/pandas/src/tseries.pyx
index 06319c4d9..7898da506 100644
--- a/pandas/src/tseries.pyx
+++ b/pandas/src/tseries.pyx
@@ -549,6 +549,10 @@ def vec_compare(ndarray[object] left, ndarray[object] right, object op):
         ndarray[uint8_t, cast=True] result
         int flag
 
+    if n != len(right):
+        raise ValueError('Arrays were different lengths: %d vs %d'
+                         % (n, len(right)))
+
     if op is operator.lt:
         flag = cpython.Py_LT
     elif op is operator.le:
@@ -612,6 +616,11 @@ def scalar_binop(ndarray[object] values, object val, object op):
 def vec_binop(ndarray[object] left, ndarray[object] right, object op):
     cdef:
         Py_ssize_t i, n = len(left)
+        ndarray[object] result
+
+    if n != len(right):
+        raise ValueError('Arrays were different lengths: %d vs %d'
+                         % (n, len(right)))
 
     result = np.empty(n, dtype=object)
 
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index 05563266f..e8c966c65 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -1252,6 +1252,11 @@ class TestSeries(unittest.TestCase, CheckNameIntegration):
         expected = Series([True, True, True])
         assert_series_equal(result, expected)
 
+    def test_comparison_different_length(self):
+        a = Series(['a', 'b', 'c'])
+        b = Series(['b', 'a'])
+        self.assertRaises(ValueError, a.__lt__, b)
+
     def test_between(self):
         from pandas import DateRange
 
