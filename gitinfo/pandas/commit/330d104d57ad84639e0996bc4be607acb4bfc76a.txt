commit 330d104d57ad84639e0996bc4be607acb4bfc76a
Author: RuiDC <RuiDC@Yahoo.com>
Date:   Fri May 11 10:39:46 2012 +0200

    treat XLRD.XL_CELL_ERROR as NaN

diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index e218fdce9..5912b3c97 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -1001,7 +1001,7 @@ class ExcelFile(object):
                    parse_dates=False, date_parser=None, na_values=None,
                    thousands=None, chunksize=None):
         from datetime import MINYEAR, time, datetime
-        from xlrd import xldate_as_tuple, XL_CELL_DATE
+        from xlrd import xldate_as_tuple, XL_CELL_DATE, XL_CELL_ERROR
 
         datemode = self.book.datemode
         sheet = self.book.sheet_by_name(sheetname)
@@ -1017,6 +1017,8 @@ class ExcelFile(object):
                         value = time(*dt[3:])
                     else:
                         value = datetime(*dt)
+				if typ == XL_CELL_ERROR:
+					value = np.nan
                 row.append(value)
             data.append(row)
 
diff --git a/pandas/io/tests/test3.xls b/pandas/io/tests/test3.xls
new file mode 100644
index 000000000..f73943d67
Binary files /dev/null and b/pandas/io/tests/test3.xls differ
diff --git a/pandas/io/tests/test_parsers.py b/pandas/io/tests/test_parsers.py
index 02fc25329..cc67e8956 100644
--- a/pandas/io/tests/test_parsers.py
+++ b/pandas/io/tests/test_parsers.py
@@ -376,6 +376,17 @@ baz,7,8,9
         parsed = excel_data.parse('Sheet1')
         expected = DataFrame([['aaaa','bbbbb']], columns=['Test', 'Test1'])
         assert_frame_equal(parsed, expected)
+		
+	def test_excel_cell_error_na(self):
+        try:
+            import xlrd
+        except ImportError:
+            raise nose.SkipTest('xlrd not installed, skipping')
+
+        excel_data = ExcelFile(os.path.join(self.dirpath, 'test3.xls'))
+        parsed = excel_data.parse('Sheet1')
+        expected = DataFrame([[np.nan]], columns=['Test'])
+        assert_frame_equal(parsed, expected)
 
     def test_excel_table(self):
         try:
