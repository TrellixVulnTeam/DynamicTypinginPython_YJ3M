commit edd55c2c542758353ecd734f951f80e8305509f2
Author: Chang She <chang@lambdafoundry.com>
Date:   Thu May 3 14:06:17 2012 -0400

    BUG: writing heterogenous Index to HDFStore. GH #1078

diff --git a/pandas/io/pytables.py b/pandas/io/pytables.py
index 97a1cde7a..5139780f0 100644
--- a/pandas/io/pytables.py
+++ b/pandas/io/pytables.py
@@ -784,30 +784,29 @@ class HDFStore(object):
 def _convert_index(index):
     inferred_type = lib.infer_dtype(index)
 
-    # Let's assume the index is homogeneous
     values = np.asarray(index)
 
     if inferred_type == 'datetime64':
         converted = values.view('i8')
         return converted, 'datetime64', _tables().Int64Col()
-    elif isinstance(values[0], datetime):
+    elif inferred_type == 'datetime':
         converted = np.array([(time.mktime(v.timetuple()) +
                             v.microsecond / 1E6) for v in values],
                             dtype=np.float64)
         return converted, 'datetime', _tables().Time64Col()
-    elif isinstance(values[0], date):
+    elif inferred_type == 'date':
         converted = np.array([time.mktime(v.timetuple()) for v in values],
                             dtype=np.int32)
         return converted, 'date', _tables().Time32Col()
-    elif isinstance(values[0], basestring):
+    elif inferred_type =='string':
         converted = np.array(list(values), dtype=np.str_)
         itemsize = converted.dtype.itemsize
         return converted, 'string', _tables().StringCol(itemsize)
-    elif com.is_integer(values[0]):
+    elif inferred_type == 'integer':
         # take a guess for now, hope the values fit
         atom = _tables().Int64Col()
         return np.asarray(values, dtype=np.int64), 'integer', atom
-    elif com.is_float(values[0]):
+    elif inferred_type == 'floating':
         atom = _tables().Float64Col()
         return np.asarray(values, dtype=np.float64), 'float', atom
     else: # pragma: no cover
diff --git a/pandas/io/tests/test_pytables.py b/pandas/io/tests/test_pytables.py
index 77ee18659..f8c3ccbd1 100644
--- a/pandas/io/tests/test_pytables.py
+++ b/pandas/io/tests/test_pytables.py
@@ -215,6 +215,28 @@ class TesttHDFStore(unittest.TestCase):
         DF = DataFrame(data, index=idx, columns=col)
         self._check_roundtrip(DF, tm.assert_frame_equal)
 
+    def test_mixed_index(self):
+        values = np.random.randn(2)
+
+        ser = Series(values, [0, 'y'])
+        self._check_roundtrip(ser, tm.assert_series_equal)
+
+        ser = Series(values, [datetime.today(), 0])
+        self._check_roundtrip(ser, tm.assert_series_equal)
+
+        ser = Series(values, ['y', 0])
+        self._check_roundtrip(ser, tm.assert_series_equal)
+
+        from datetime import date
+        ser = Series(values, [date.today(), 'a'])
+        self._check_roundtrip(ser, tm.assert_series_equal)
+
+        ser = Series(values, [1.23, 'b'])
+        self._check_roundtrip(ser, tm.assert_series_equal)
+
+        ser = Series(values, [1, 1.53])
+        self._check_roundtrip(ser, tm.assert_series_equal)
+
     def test_timeseries_preepoch(self):
         if sys.version_info[0] == 2 and sys.version_info[1] < 7:
             raise nose.SkipTest
