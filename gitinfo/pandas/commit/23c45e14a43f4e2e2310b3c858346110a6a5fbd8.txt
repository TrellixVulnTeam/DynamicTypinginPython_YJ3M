commit 23c45e14a43f4e2e2310b3c858346110a6a5fbd8
Author: Chang She <changshe@gmail.com>
Date:   Mon Sep 17 22:17:52 2012 -0400

    BUG: df.set_index fails for MultiIndex columns #1885

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index cfd2b981f..f28c0c288 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -2396,7 +2396,7 @@ class DataFrame(NDFrame):
         -------
         dataframe : DataFrame
         """
-        if not isinstance(keys, (list, tuple)):
+        if not isinstance(keys, list):
             keys = [keys]
 
         if inplace:
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 2764eb670..023fe57bc 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -1491,6 +1491,15 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         idf = df.set_index('A')
         self.assert_(isinstance(idf.index, DatetimeIndex))
 
+    def test_set_index_multiindexcolumns(self):
+        columns = MultiIndex.from_tuples([('foo', 1), ('foo', 2), ('bar', 1)])
+        df = DataFrame(np.random.randn(3, 3), columns=columns)
+        rs = df.set_index(df.columns[0])
+        xp = df.ix[:, 1:]
+        xp.index = df.ix[:, 0].values
+        xp.index.names = [df.columns[0]]
+        assert_frame_equal(rs, xp)
+
     def test_set_columns(self):
         cols = Index(np.arange(len(self.mixed_frame.columns)))
         self.mixed_frame.columns = cols
