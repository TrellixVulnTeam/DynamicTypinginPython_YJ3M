commit 06f74e5d06c4766ec59564374640c4758a72409d
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Nov 4 18:03:13 2012 -0500

    ENH: generify common.diff per #2174, close #2087

diff --git a/RELEASE.rst b/RELEASE.rst
index 1446ea560..0fb4314d7 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -79,6 +79,7 @@ pandas 0.9.1
   - Fix groupby(...).first() issue with datetime64 (#2133)
   - Better floating point error robustness in some rolling_* functions (#2114)
   - Fix ewma NA handling in the middle of Series (#2128)
+  - Fix numerical precision issues in diff with integer data (#2087)
 
 pandas 0.9.0
 ============
diff --git a/pandas/core/common.py b/pandas/core/common.py
index bcb05c9f1..4dbfedc0f 100644
--- a/pandas/core/common.py
+++ b/pandas/core/common.py
@@ -377,29 +377,13 @@ def diff(arr, n, indexer, axis=0):
     out_arr = arr - arr.take(indexer, axis=axis)
     out_arr = _maybe_upcast(out_arr)
 
-    if axis == 0:
-        if n > 0:
-            out_arr[:n] = np.nan
-        elif n < 0:
-            out_arr[n:] = np.nan
-        else:
-            out_arr[:] = np.nan
-    elif axis == 1:
-        if n > 0:
-            out_arr[:, :n] = np.nan
-        elif n < 0:
-            out_arr[:, n:] = np.nan
-        else:
-            out_arr[:, :] = np.nan
-    elif axis == 2:
-        if n > 0:
-            out_arr[:, :, :n] = np.nan
-        elif n < 0:
-            out_arr[:, :, n:] = np.nan
-        else:
-            out_arr[:, :, :] = np.nan
-    else:
-        raise NotImplementedError()
+    indexer = [slice(None)] * arr.ndim
+    if n > 0:
+        indexer[axis] = slice(None, n)
+    elif n < 0:
+        indexer[axis] = slice(None, n)
+    out_arr[tuple(indexer)] = np.nan
+
     return out_arr
 
 
