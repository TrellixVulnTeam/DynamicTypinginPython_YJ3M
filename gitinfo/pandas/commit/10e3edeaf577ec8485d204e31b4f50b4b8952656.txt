commit 10e3edeaf577ec8485d204e31b4f50b4b8952656
Author: Chang She <chang@lambdafoundry.com>
Date:   Tue May 29 08:28:11 2012 -0400

    ENH: better error msg for fillna() with invalid method

diff --git a/pandas/core/common.py b/pandas/core/common.py
index a284e6bed..b560c8978 100644
--- a/pandas/core/common.py
+++ b/pandas/core/common.py
@@ -769,6 +769,10 @@ def _clean_fill_method(method):
         method = 'pad'
     if method == 'bfill':
         method = 'backfill'
+    if method not in ['pad', 'backfill']:
+        msg = ('Invalid fill method. Expecting pad (ffill) or backfill (bfill).'
+               ' Got %s' % method)
+        raise ValueError(msg)
     return method
 
 def _all_none(*args):
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 3168e3e7f..426caa9c7 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -3800,6 +3800,12 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         expected = df.astype(float).fillna(axis=1)
         assert_frame_equal(result, expected)
 
+    def test_fillna_invalid_method(self):
+        try:
+            self.frame.fillna(method='ffil')
+        except ValueError, inst:
+            self.assert_('ffil' in str(inst))
+
     def test_replace_inplace(self):
         self.tsframe['A'][:5] = nan
         self.tsframe['A'][-5:] = nan
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index 7867c60eb..426b703e0 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -2574,6 +2574,12 @@ class TestSeries(unittest.TestCase, CheckNameIntegration):
         expected = x.fillna(value=0)
         assert_series_equal(y2, expected)
 
+    def test_fillna_invalid_method(self):
+        try:
+            self.ts.fillna(method='ffil')
+        except ValueError, inst:
+            self.assert_('ffil' in str(inst))
+
     def test_replace(self):
         N = 100
         ser = Series(np.random.randn(N))
