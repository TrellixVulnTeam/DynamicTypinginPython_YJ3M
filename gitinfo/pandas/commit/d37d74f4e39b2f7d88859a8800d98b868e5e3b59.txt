commit d37d74f4e39b2f7d88859a8800d98b868e5e3b59
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed Dec 12 20:45:43 2012 -0500

    BLD: cdef import Py_TYPE b/c older Cython doesn'thave it in cpython headers. re #2509, #2510

diff --git a/pandas/tslib.pyx b/pandas/tslib.pyx
index 18eee8c30..b6e824891 100644
--- a/pandas/tslib.pyx
+++ b/pandas/tslib.pyx
@@ -7,6 +7,11 @@ import numpy as np
 
 from cpython cimport *
 
+# Cython < 0.17 doesn't have this in cpython
+cdef extern from "Python.h":
+    cdef PyTypeObject *Py_TYPE(object)
+
+
 from libc.stdlib cimport free
 
 from util cimport is_integer_object, is_datetime64_object
diff --git a/setup.py b/setup.py
index ca9482095..ad2b76f9e 100755
--- a/setup.py
+++ b/setup.py
@@ -290,7 +290,12 @@ class CleanCommand(Command):
 class CheckSDist(sdist):
     """Custom sdist that ensures Cython has compiled all pyx files to c."""
 
-    _pyxfiles = ['pandas/src/tseries.pyx'
+    _pyxfiles = ['pandas/lib.pyx',
+                 'pandas/hashtable.pyx',
+                 'pandas/tslib.pyx',
+                 'pandas/index.pyx',
+                 'pandas/algos.pyx',
+                 'pandas/src/parser.pyx',
                  'pandas/src/sparse.pyx']
 
     def initialize_options(self):
@@ -530,14 +535,15 @@ class DummyBuildSrc(Command):
         pass
 
 cmdclass = {'clean': CleanCommand,
-            'build': build}
+            'build': build,
+            'sdist': CheckSDist}
+
 if cython:
     suffix = '.pyx'
     cmdclass['build_ext'] = build_ext
     if BUILD_CACHE_DIR: # use the cache
         cmdclass['build_ext'] = CachingBuildExt
     cmdclass['cython'] = CythonCommand
-    cmdclass['sdist'] =  CheckSDist
 else:
     suffix = '.c'
     cmdclass['build_src'] = DummyBuildSrc
