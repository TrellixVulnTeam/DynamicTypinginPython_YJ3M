commit 8d1e0cdf01d32127335dafde2f990937981105fc
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed Mar 24 17:50:33 2010 +0000

    bugfix + unit tests
    
    git-svn-id: http://pandas.googlecode.com/svn/trunk@145 d5231056-7de3-11de-ac95-d976489f1ece

diff --git a/pandas/core/datetools.py b/pandas/core/datetools.py
index 2206a18fe..6fc76b379 100644
--- a/pandas/core/datetools.py
+++ b/pandas/core/datetools.py
@@ -601,17 +601,3 @@ def getOffsetName(offset):
         return name
     else:
         raise Exception('Bad offset name requested: %s!' % offset)
-
-# OK aqr/gaa/backtest/docs.py
-# OK aqr/gaa/tests/test_timerule.py
-# OK aqr/gaa/timerule.py
-# OK pandas/core/datetools.py
-# OK pandas/core/tests/test_datetools.py
-# OK prod/gaa/pmtools/utils/dateUtils.py
-# OK research/credit/timing.py
-# OK research/eq/eqe_com_factor/com_factor_test.py
-# research/eq/ExporterImporter/analysis.py
-# research/eq/ExporterImporter/factors.py
-# research/fx/Returns/IMM_Forward_Points.py
-# users/mst/mispricing.py
-# users/sargent/XSReturnVol.py
diff --git a/pandas/core/matrix.py b/pandas/core/matrix.py
index 7d95917a2..01da4707e 100644
--- a/pandas/core/matrix.py
+++ b/pandas/core/matrix.py
@@ -684,16 +684,19 @@ class DataMatrix(DataFrame):
             return self * NaN
 
         myValues = myReindex.values
-        if self.columns.equals(other.columns):
+        safe = self.columns.equals(other.columns)
+
+        if safe:
             newCols = self.columns
             commonCols = self.columns
         else:
             newCols = self.columns.union(other.columns)
             commonCols = self.columns.intersection(other.columns)
+
         hisValues = hisReindex.values
         hisCols = hisReindex.columns
 
-        if len(newCols) == len(commonCols):
+        if safe:
             resultMatrix = func(myValues, hisValues)
         else:
             T, N = len(newIndex), len(newCols)
diff --git a/pandas/core/tests/test_frame.py b/pandas/core/tests/test_frame.py
index bf79d389b..e2988f6fc 100644
--- a/pandas/core/tests/test_frame.py
+++ b/pandas/core/tests/test_frame.py
@@ -411,6 +411,11 @@ class TestDataFrame(unittest.TestCase):
         empty_empty = self.empty + self.empty
         self.assert_(not empty_empty)
 
+        # out of order
+        reverse = self.frame.reindex(columns=self.frame.columns[::-1])
+
+        assert_frame_equal(reverse + self.frame, self.frame * 2)
+
     def test_combineSeries(self):
 
         # Series
