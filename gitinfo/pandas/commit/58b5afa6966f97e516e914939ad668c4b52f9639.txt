commit 58b5afa6966f97e516e914939ad668c4b52f9639
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed Jul 11 16:52:53 2012 -0400

    BUG: fix to_panel NA handling with non-floating poitn data close #1582

diff --git a/pandas/core/reshape.py b/pandas/core/reshape.py
index 475a6822e..621d1d689 100644
--- a/pandas/core/reshape.py
+++ b/pandas/core/reshape.py
@@ -741,7 +741,10 @@ def block2d_to_block3d(values, items, shape, major_labels, minor_labels,
     mask.put(selector, True)
 
     pvalues = np.empty(panel_shape, dtype=values.dtype)
-    if not issubclass(pvalues.dtype.type, np.integer):
+    if not issubclass(pvalues.dtype.type, (np.integer, np.bool_)):
+        pvalues.fill(np.nan)
+    elif not mask.all():
+        pvalues = com._maybe_upcast(pvalues)
         pvalues.fill(np.nan)
 
     values = values
diff --git a/pandas/tests/test_panel.py b/pandas/tests/test_panel.py
index 67f4ce994..3c568562c 100644
--- a/pandas/tests/test_panel.py
+++ b/pandas/tests/test_panel.py
@@ -971,6 +971,14 @@ class TestPanel(unittest.TestCase, PanelTests, CheckIndexing,
         self.assertEqual(wp['bool'].values.dtype, np.bool_)
         assert_frame_equal(wp['bool'], panel['bool'])
 
+    def test_to_panel_na_handling(self):
+        df = DataFrame(np.random.randint(0, 10, size=20).reshape((10, 2)),
+                       index=[[0, 0, 0, 0, 0, 0, 1, 1, 1, 1],
+                              [0, 1, 2, 3, 4, 5, 2, 3, 4, 5]])
+
+        panel = df.to_panel()
+        self.assert_(isnull(panel[0].ix[1, [0, 1]]).all())
+
     def test_filter(self):
         pass
 
