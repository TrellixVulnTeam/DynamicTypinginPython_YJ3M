commit 1723257b0a5ee911f3f9be3b32902b198c00ad85
Author: Adam Klein <adamklein@gmail.com>
Date:   Tue Mar 6 11:56:10 2012 -0500

    BUG: close #870, ensure platform in group_index

diff --git a/pandas/core/reshape.py b/pandas/core/reshape.py
index b19cb2db1..5275e5c09 100644
--- a/pandas/core/reshape.py
+++ b/pandas/core/reshape.py
@@ -7,9 +7,8 @@ import numpy as np
 
 from pandas.core.series import Series
 from pandas.core.frame import DataFrame
-from pandas.core.panel import Panel
 
-from pandas.core.common import notnull
+from pandas.core.common import notnull, _ensure_platform_int
 from pandas.core.groupby import get_group_index
 from pandas.core.index import MultiIndex
 
@@ -91,6 +90,8 @@ class _Unstacker(object):
         group_index = get_group_index(self.sorted_labels,
                                       [len(x) for x in new_levels])
 
+        group_index = _ensure_platform_int(group_index)
+
         group_mask = np.zeros(self.full_shape[0], dtype=bool)
         group_mask.put(group_index, True)
 
