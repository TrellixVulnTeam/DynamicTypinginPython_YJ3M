commit 7916e76a3da5baf803ac37f8f5c2260656f03fb2
Author: y-p <yoval@gmx.com>
Date:   Sun Mar 31 22:56:22 2013 +0300

    BUG: check and raise on df.applymap with df having dupe columns

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 9b3f63581..6b59980cd 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -4244,6 +4244,9 @@ class DataFrame(NDFrame):
             if com.is_datetime64_dtype(x):
                 x = lib.map_infer(x, lib.Timestamp)
             return lib.map_infer(x, func)
+        #GH2786
+        if not self.columns.is_unique:
+            raise ValueError("applymap does not support dataframes having duplicate column labels")
         return self.apply(infer)
 
     #----------------------------------------------------------------------
