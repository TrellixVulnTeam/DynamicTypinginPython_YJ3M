commit b91da389d9c7d6e025f36e1fef49591b230ba7ad
Author: jreback <jeff@reback.net>
Date:   Thu May 16 13:12:03 2013 -0400

    BUG: Fix not consolidating before to_csv (GH3624_)

diff --git a/RELEASE.rst b/RELEASE.rst
index aeaebd88c..219eec42e 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -124,6 +124,7 @@ pandas 0.11.1
   - Fix indexing issue in ndim >= 3 with ``iloc`` (GH3617_)
   - Correctly parse date columns with embedded (nan/NaT) into datetime64[ns] dtype in ``read_csv``
     when ``parse_dates`` is specified (GH3062_)
+  - Fix not consolidating before to_csv (GH3624_)
 
 .. _GH3164: https://github.com/pydata/pandas/issues/3164
 .. _GH2786: https://github.com/pydata/pandas/issues/2786
@@ -175,6 +176,7 @@ pandas 0.11.1
 .. _GH3435: https://github.com/pydata/pandas/issues/3435
 .. _GH3611: https://github.com/pydata/pandas/issues/3611
 .. _GH3062: https://github.com/pydata/pandas/issues/3062
+.. _GH3624: https://github.com/pydata/pandas/issues/3624
 .. _GH1512: https://github.com/pydata/pandas/issues/1512
 
 
diff --git a/pandas/core/format.py b/pandas/core/format.py
index 2924f1579..bea4b59bf 100644
--- a/pandas/core/format.py
+++ b/pandas/core/format.py
@@ -777,6 +777,8 @@ class CSVFormatter(object):
                line_terminator='\n', chunksize=None, engine=None):
 
         self.engine = engine  # remove for 0.12
+
+        obj._consolidate_inplace()
         self.obj = obj
 
         self.path_or_buf = path_or_buf
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index b39fab1bd..de49eca7d 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -4939,6 +4939,19 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
             assert_frame_equal(self.frame, recons, check_names=False)  # TODO to_csv drops column name
             assert_frame_equal(np.isinf(self.frame), np.isinf(recons), check_names=False)
 
+    def test_to_csv_no_index(self):
+        # GH 3624, after appending columns, to_csv fails
+        pname = '__tmp_to_csv_no_index__'
+        with ensure_clean(pname) as path:
+            df = DataFrame({'c1':[1,2,3], 'c2':[4,5,6]})
+            df.to_csv(path, index=False)
+            result = read_csv(path)
+            assert_frame_equal(df,result)
+            df['c3'] = [7,8,9]
+            df.to_csv(path, index=False)
+            result = read_csv(path)
+            assert_frame_equal(df,result)
+
     def test_to_csv_multiindex(self):
 
         pname = '__tmp_to_csv_multiindex__'
