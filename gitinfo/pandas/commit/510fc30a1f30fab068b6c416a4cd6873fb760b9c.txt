commit 510fc30a1f30fab068b6c416a4cd6873fb760b9c
Author: y-p <yoval@gmx.com>
Date:   Fri Oct 12 18:34:28 2012 +0200

    CLN: cleanup tox.ini, remove stale pandas/setup.py, fix tox warning
    
    tox was complaining about "this is the wrong setup.py to use"
    because tox.ini was manually invoking pandas/setup.py, which
    has been superceeed by the root setup.py
    
    - the use of changedir= has been made clearer.
    - now removes the pandas uninstall from the venv after the tests.
      (but only if they succeed due to a limitation in tox)

diff --git a/pandas/setup.py b/pandas/setup.py
deleted file mode 100644
index f9945f0fd..000000000
--- a/pandas/setup.py
+++ /dev/null
@@ -1,26 +0,0 @@
-#!/usr/bin/env python
-
-import numpy
-
-def configuration(parent_package='',top_path=None):
-    from numpy.distutils.misc_util import Configuration
-    config = Configuration('pandas', parent_package, top_path)
-    config.add_subpackage('core')
-    config.add_subpackage('io')
-    config.add_subpackage('rpy')
-    config.add_subpackage('sandbox')
-    config.add_subpackage('stats')
-    config.add_subpackage('util')
-    config.add_data_dir('tests')
-
-    config.add_extension('_tseries',
-                         sources=['src/tseries.c'],
-                         include_dirs=[numpy.get_include()])
-    config.add_extension('_sparse',
-                         sources=['src/sparse.c'],
-                         include_dirs=[numpy.get_include()])
-    return config
-
-if __name__ == '__main__':
-    print('This is the wrong setup.py file to run')
-
diff --git a/tox.ini b/tox.ini
index 9baf33cf8..f4e03e167 100644
--- a/tox.ini
+++ b/tox.ini
@@ -7,18 +7,36 @@
 envlist = py25, py26, py27, py31, py32
 
 [testenv]
-commands =
-    {envpython} setup.py clean build_ext install
-    {envbindir}/nosetests tests
-    /bin/rm -rf {toxinidir}/build {toxinidir}/tests
 deps =
     cython
     numpy >= 1.6.1
     nose
     pytz
 
+# cd to anything but the default {toxinidir} which
+# contains the pandas subdirectory and confuses
+# nose away from the fresh install in site-packages
+changedir = {envdir}
+
+commands =
+    # TODO:  --exe because of GH #761
+    {envbindir}/nosetests --exe pandas.tests
+    # cleanup the temp. build dir created by the tox build
+    /bin/rm -rf {toxinidir}/build
+
+    # quietly rollback the install.
+    # Note this line will only be reached if the tests
+    # previous lines succeed (in particular, the tests),
+    # but an uninstall is really only required when
+    # files are removed from source tree, in which case,
+    # stale versions of files will will remain in the venv,
+    # until the next time uninstall is run.
+    #
+    # tox should provide a preinstall-commands hook.
+    pip uninstall pandas -qy
+
+
 [testenv:py25]
-changedir = .tox/py25/lib/python2.5/site-packages/pandas
 deps =
     cython
     numpy >= 1.6.1
@@ -27,13 +45,9 @@ deps =
     simplejson
 
 [testenv:py26]
-changedir = .tox/py26/lib/python2.6/site-packages/pandas
 
 [testenv:py27]
-changedir = .tox/py27/lib/python2.7/site-packages/pandas
 
 [testenv:py31]
-changedir = .tox/py31/lib/python3.1/site-packages/pandas
 
 [testenv:py32]
-changedir = .tox/py32/lib/python3.2/site-packages/pandas
