commit 6b3980066569fed7ba3bbaff8a439ccc5fcc0423
Author: John McNamara <jmcnamara@cpan.org>
Date:   Mon Jan 27 01:01:55 2014 +0000

    TST: Add xlsm to Excel parsing tests.
    
    Added an Excel xlsm file to the excel.py reader tests.
    Test for issue #4172

diff --git a/pandas/io/tests/data/test.xlsm b/pandas/io/tests/data/test.xlsm
new file mode 100644
index 000000000..4c873e55a
Binary files /dev/null and b/pandas/io/tests/data/test.xlsm differ
diff --git a/pandas/io/tests/test_excel.py b/pandas/io/tests/test_excel.py
index 5335c7691..8e6ac3cf5 100644
--- a/pandas/io/tests/test_excel.py
+++ b/pandas/io/tests/test_excel.py
@@ -90,10 +90,10 @@ class ExcelReaderTests(SharedItems, tm.TestCase):
         _skip_if_no_openpyxl()
         _skip_if_no_xlrd()
 
-        suffix = ['', 'x']
+        suffix = ['xls', 'xlsx', 'xlsm']
 
         for s in suffix:
-            pth = os.path.join(self.dirpath, 'test.xls%s' % s)
+            pth = os.path.join(self.dirpath, 'test.%s' % s)
             xls = ExcelFile(pth)
             df = xls.parse('Sheet1', index_col=0, parse_dates=True,
                            parse_cols=3)
@@ -109,10 +109,10 @@ class ExcelReaderTests(SharedItems, tm.TestCase):
         _skip_if_no_openpyxl()
         _skip_if_no_xlrd()
 
-        suffix = ['', 'x']
+        suffix = ['xls', 'xlsx', 'xlsm']
 
         for s in suffix:
-            pth = os.path.join(self.dirpath, 'test.xls%s' % s)
+            pth = os.path.join(self.dirpath, 'test.%s' % s)
             xls = ExcelFile(pth)
             df = xls.parse('Sheet1', index_col=0, parse_dates=True,
                            parse_cols=[0, 2, 3])
@@ -129,11 +129,11 @@ class ExcelReaderTests(SharedItems, tm.TestCase):
         _skip_if_no_openpyxl()
         _skip_if_no_xlrd()
 
-        suffix = ['', 'x']
+        suffix = ['xls', 'xlsx', 'xlsm']
 
         for s in suffix:
 
-            pth = os.path.join(self.dirpath, 'test.xls%s' % s)
+            pth = os.path.join(self.dirpath, 'test.%s' % s)
             xls = ExcelFile(pth)
 
             df = xls.parse('Sheet1', index_col=0, parse_dates=True,
@@ -677,26 +677,26 @@ class ExcelWriterBase(SharedItems):
         with ensure_clean(self.ext) as filename1:
             with ensure_clean(self.ext) as filename2:
                 writer1 = ExcelWriter(filename1)
-                writer2 = ExcelWriter(filename2, 
+                writer2 = ExcelWriter(filename2,
                   date_format='DD.MM.YYYY',
                   datetime_format='DD.MM.YYYY HH-MM-SS')
 
                 df.to_excel(writer1, 'test1')
                 df.to_excel(writer2, 'test1')
-                
+
                 writer1.close()
                 writer2.close()
 
                 reader1 = ExcelFile(filename1)
                 reader2 = ExcelFile(filename2)
-                
+
                 rs1 = reader1.parse('test1', index_col=None)
                 rs2 = reader2.parse('test1', index_col=None)
-               
+
                 tm.assert_frame_equal(rs1, rs2)
 
                 # since the reader returns a datetime object for dates, we need
-                # to use df_expected to check the result         
+                # to use df_expected to check the result
                 tm.assert_frame_equal(rs2, df_expected)
 
     def test_to_excel_periodindex(self):
diff --git a/setup.py b/setup.py
index 1c82da240..d5c52395a 100755
--- a/setup.py
+++ b/setup.py
@@ -567,6 +567,7 @@ setup(name=DISTNAME,
                                   'tests/data/*.txt',
                                   'tests/data/*.xls',
                                   'tests/data/*.xlsx',
+                                  'tests/data/*.xlsm',
                                   'tests/data/*.table',
                                   'tests/data/*.html',
                                   'tests/test_json/data/*.json'],
