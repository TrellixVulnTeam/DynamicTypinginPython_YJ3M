commit 616975afbaa0ad36e129f33698a3deedd77e5c09
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Oct 2 18:36:39 2011 -0400

    BUG: fix left_join_indexer bug

diff --git a/pandas/src/generate_code.py b/pandas/src/generate_code.py
index bb4b51e81..381a040e1 100644
--- a/pandas/src/generate_code.py
+++ b/pandas/src/generate_code.py
@@ -369,9 +369,13 @@ def left_join_indexer_%(name)s(ndarray[%(c_type)s] left,
     nright = len(right)
 
     indexer = np.empty(nleft, dtype=np.int32)
-    for i from 0 <= i < nleft:
+    while True:
+        if i == nleft:
+            break
+
         if j == nright:
             indexer[i] = -1
+            i += 1
             continue
 
         lval = left[i]
@@ -379,12 +383,14 @@ def left_join_indexer_%(name)s(ndarray[%(c_type)s] left,
 
         if lval == right[j]:
             indexer[i] = j
+            i += 1
+            j += 1
         elif lval > rval:
             indexer[i] = -1
             j += 1
         else:
             indexer[i] = -1
-
+            i += 1
     return indexer
 
 """
diff --git a/pandas/src/generated.pyx b/pandas/src/generated.pyx
index 2699e07bc..860806410 100644
--- a/pandas/src/generated.pyx
+++ b/pandas/src/generated.pyx
@@ -1418,9 +1418,13 @@ def left_join_indexer_object(ndarray[object] left,
     nright = len(right)
 
     indexer = np.empty(nleft, dtype=np.int32)
-    for i from 0 <= i < nleft:
+    while True:
+        if i == nleft:
+            break
+
         if j == nright:
             indexer[i] = -1
+            i += 1
             continue
 
         lval = left[i]
@@ -1428,12 +1432,14 @@ def left_join_indexer_object(ndarray[object] left,
 
         if lval == right[j]:
             indexer[i] = j
+            i += 1
+            j += 1
         elif lval > rval:
             indexer[i] = -1
             j += 1
         else:
             indexer[i] = -1
-
+            i += 1
     return indexer
 
 @cython.wraparound(False)
@@ -1451,9 +1457,13 @@ def left_join_indexer_int64(ndarray[int64_t] left,
     nright = len(right)
 
     indexer = np.empty(nleft, dtype=np.int32)
-    for i from 0 <= i < nleft:
+    while True:
+        if i == nleft:
+            break
+
         if j == nright:
             indexer[i] = -1
+            i += 1
             continue
 
         lval = left[i]
@@ -1461,12 +1471,14 @@ def left_join_indexer_int64(ndarray[int64_t] left,
 
         if lval == right[j]:
             indexer[i] = j
+            i += 1
+            j += 1
         elif lval > rval:
             indexer[i] = -1
             j += 1
         else:
             indexer[i] = -1
-
+            i += 1
     return indexer
 
 
