commit a0b59f8d62b206052f383318012d691d9a324ba3
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sat Sep 8 23:17:28 2012 -0400

    BUG: prevent segfault since MultiIndex not supported in HDF5 table format. close #1848

diff --git a/RELEASE.rst b/RELEASE.rst
index 3e751952e..5133889c4 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -122,6 +122,8 @@ pandas 0.9.0
   - Fix bug in DataFrame.duplicated with datetime64 columns (#1833)
   - Fix bug in Panel internals resulting in error when doing fillna after
     truncate not changing size of panel (#1823)
+  - Prevent segfault due to MultiIndex not being supported in HDFStore table
+    format (#1848)
 
 pandas 0.8.1
 ============
diff --git a/pandas/io/pytables.py b/pandas/io/pytables.py
index 97bc55f21..266d06d4e 100644
--- a/pandas/io/pytables.py
+++ b/pandas/io/pytables.py
@@ -931,6 +931,9 @@ def _convert_index(index):
         atom = _tables().Int64Col()
         return index.values, 'integer', atom
 
+    if isinstance(index, MultiIndex):
+        raise Exception('MultiIndex not supported here!')
+
     inferred_type = lib.infer_dtype(index)
 
     values = np.asarray(index)
diff --git a/pandas/io/tests/test_pytables.py b/pandas/io/tests/test_pytables.py
index 29d3b45f2..ae4958a61 100644
--- a/pandas/io/tests/test_pytables.py
+++ b/pandas/io/tests/test_pytables.py
@@ -677,6 +677,14 @@ class TestHDFStore(unittest.TestCase):
         df['d'] = ts.index[:3]
         self._check_roundtrip(df, tm.assert_frame_equal)
 
+    def test_cant_write_multiindex_table(self):
+        # for now, #1848
+        df = DataFrame(np.random.randn(10, 4),
+                       index=[np.arange(5).repeat(2),
+                              np.tile(np.arange(2), 5)])
+
+        self.assertRaises(Exception, self.store.put, 'foo', df, table=True)
+
 def curpath():
     pth, _ = os.path.split(os.path.abspath(__file__))
     return pth
