commit 82d4ec40537619ce5a4c19585843a012bf70b9c1
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Jun 27 23:36:24 2011 -0400

    BUG: summing boolean DataFrame

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 490eaf951..f9695fe40 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -2002,7 +2002,10 @@ class DataFrame(PandasGeneric):
                 y[-mask] = 0
             the_sum = y.sum(axis)
             the_count = mask.sum(axis)
-            the_sum[the_count == 0] = nan
+
+            ct_mask = the_count == 0
+            if ct_mask.any():
+                the_sum[ct_mask] = nan
 
         return Series(the_sum, index=axis_labels)
 
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index ebaeec371..46703e751 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -2079,6 +2079,12 @@ class TestDataFrame(unittest.TestCase, CheckIndexing):
         deltas = frame * timedelta(1)
         deltas.sum()
 
+    def test_sum_bool(self):
+        # ensure this works, bug report
+        bools = np.isnan(self.frame)
+        bools.sum(1)
+        bools.sum(0)
+
     def test_product(self):
         def f(x):
             x = np.asarray(x)
