commit 57590935f5a4125133d660aed8367e6e2b304c78
Author: locojaydev <locojaydev@dev.com>
Date:   Thu Dec 6 18:19:42 2012 -0500

    large files

diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index 128e99f9f..9bb1a4c32 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -21,6 +21,8 @@ from pandas.util.decorators import Appender
 import pandas.lib as lib
 import pandas._parser as _parser
 from pandas.tseries.period import Period
+import json
+
 
 class DateConversionError(Exception):
     pass
@@ -2125,14 +2127,24 @@ class ExcelWriter(object):
             wks = self.book.add_sheet(sheet_name)
             self.sheets[sheet_name] = wks
 
+        style_dict = {}
+
         for cell in cells:
             val = _conv_value(cell.val)
-            style = CellStyleConverter.to_xls(cell.style)
+
+            stylekey = json.dumps(cell.style)
+            if stylekey in style_dict:
+                style = style_dict[stylekey]
+            else:
+                style = CellStyleConverter.to_xls(cell.style)
+                style_dict[stylekey] = style
+
             if isinstance(val, datetime.datetime):
                 style.num_format_str = "YYYY-MM-DD HH:MM:SS"
             elif isinstance(val, datetime.date):
                 style.num_format_str = "YYYY-MM-DD"
 
+
             if cell.mergestart is not None and cell.mergeend is not None:
                 wks.write_merge(startrow + cell.row,
                                 startrow + cell.mergestart,
