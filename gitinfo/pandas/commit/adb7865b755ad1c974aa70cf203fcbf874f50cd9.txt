commit adb7865b755ad1c974aa70cf203fcbf874f50cd9
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon May 30 23:58:06 2011 +0100

    get view when calling xs in DataMatrix

diff --git a/pandas/core/matrix.py b/pandas/core/matrix.py
index c3e229df8..5acb485e7 100644
--- a/pandas/core/matrix.py
+++ b/pandas/core/matrix.py
@@ -946,7 +946,7 @@ class DataMatrix(DataFrame):
             return DataMatrix(vals, index=self.index, columns=self.columns,
                               objects=objects)
 
-    def xs(self, key):
+    def xs(self, key, copy=True):
         """
         Returns a row from the DataMatrix as a Series object.
 
@@ -962,12 +962,15 @@ class DataMatrix(DataFrame):
             raise Exception('No cross-section for %s' % key)
 
         loc = self.index.indexMap[key]
-        theSlice = self.values[loc, :].copy()
-        xsIndex = self.columns
+        xs = self.values[loc, :]
 
-        result = Series(theSlice, index=xsIndex)
+        if copy:
+            xs = xs.copy()
+        result = Series(xs, index=self.columns)
 
         if self.objects is not None and len(self.objects.columns) > 0:
+            if not copy:
+                raise Exception('cannot get view of mixed-type cross-section')
             result = result.append(self.objects.xs(key))
 
         return result
diff --git a/pandas/core/tests/test_matrix.py b/pandas/core/tests/test_matrix.py
index 2ab3a024c..40e046b6e 100644
--- a/pandas/core/tests/test_matrix.py
+++ b/pandas/core/tests/test_matrix.py
@@ -275,5 +275,21 @@ class TestDataMatrix(test_frame.TestDataFrame):
                         index=range(4), columns=range(5))
         result = dm.cumsum()
 
+    def test_xs_view(self):
+        dm = DataMatrix(np.arange(20).reshape(4, 5),
+                        index=range(4), columns=range(5))
+
+        dm.xs(2, copy=False)[:] = 5
+        self.assert_((dm.xs(2) == 5).all())
+
+        dm.xs(2)[:] = 10
+        self.assert_((dm.xs(2) == 5).all())
+
+        # TODO: deal with mixed-type fiasco?
+        self.assertRaises(Exception, self.mixed_frame.xs,
+                          self.mixed_frame.index[2], copy=False)
+
 if __name__ == '__main__':
-    unittest.main()
+    import nose
+    nose.runmodule(argv=[__file__,'-vvs','-x','--pdb', '--pdb-failure'],
+                   exit=False)
