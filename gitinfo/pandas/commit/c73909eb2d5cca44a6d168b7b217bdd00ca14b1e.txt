commit c73909eb2d5cca44a6d168b7b217bdd00ca14b1e
Author: Kieran O'Mahony <kieranom@gmail.com>
Date:   Mon Aug 5 11:31:40 2013 +1000

    BUG: values array for non-unique, interleaved cols incorrect

diff --git a/pandas/core/internals.py b/pandas/core/internals.py
index abe70e903..56a6c8081 100644
--- a/pandas/core/internals.py
+++ b/pandas/core/internals.py
@@ -1546,15 +1546,16 @@ class BlockManager(PandasObject):
                 result[indexer] = block.get_values(dtype)
                 itemmask[indexer] = 1
 
-            if not itemmask.all():
-                raise AssertionError('Some items were not contained in blocks')
-
         else:
 
             # non-unique, must use ref_locs
             rl = self._set_ref_locs()
             for i, (block, idx) in enumerate(rl):
-                result[i] = block.iget(idx)
+                result[i] = block.get_values(dtype)[idx]
+                itemmask[i] = 1
+
+        if not itemmask.all():
+            raise AssertionError('Some items were not contained in blocks')
 
         return result
 
diff --git a/pandas/tests/test_internals.py b/pandas/tests/test_internals.py
index 6f1367833..57827857e 100644
--- a/pandas/tests/test_internals.py
+++ b/pandas/tests/test_internals.py
@@ -457,6 +457,17 @@ class TestBlockManager(unittest.TestCase):
     def test_interleave(self):
         pass
 
+    def test_interleave_non_unique_cols(self):
+        df = DataFrame([
+            [Timestamp('20130101'), 3.5],
+            [Timestamp('20130102'), 4.5]],
+            columns=['x', 'x'],
+            index=[1, 2])
+
+        df_unique = df.copy()
+        df_unique.columns = ['x', 'y']
+        np.testing.assert_array_equal(df_unique.values, df.values)
+
     def test_consolidate(self):
         pass
 
