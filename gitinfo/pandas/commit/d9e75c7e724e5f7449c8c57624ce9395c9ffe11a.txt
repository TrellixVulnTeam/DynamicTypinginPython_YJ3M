commit d9e75c7e724e5f7449c8c57624ce9395c9ffe11a
Author: Jeff Reback <jeff@reback.net>
Date:   Sun Feb 12 21:54:11 2017 -0500

    TST: xfail most test_gbq tests for now

diff --git a/pandas/tests/io/test_gbq.py b/pandas/tests/io/test_gbq.py
index 0317ebc49..316afaf30 100644
--- a/pandas/tests/io/test_gbq.py
+++ b/pandas/tests/io/test_gbq.py
@@ -253,7 +253,7 @@ def test_generate_bq_schema_deprecated():
         gbq.generate_bq_schema(df)
 
 
-@pytest.mark.single
+@pytest.mark.xfail(run=False, reason="flaky tests")
 class TestGBQConnectorIntegrationWithLocalUserAccountAuth(tm.TestCase):
 
     def setUp(self):
@@ -299,7 +299,7 @@ class TestGBQConnectorIntegrationWithLocalUserAccountAuth(tm.TestCase):
         self.assertTrue(isinstance(credentials, GoogleCredentials))
 
 
-@pytest.mark.single
+@pytest.mark.xfail(run=False, reason="flaky tests")
 class TestGBQConnectorIntegrationWithServiceAccountKeyPath(tm.TestCase):
     def setUp(self):
         _setup_common()
@@ -331,7 +331,7 @@ class TestGBQConnectorIntegrationWithServiceAccountKeyPath(tm.TestCase):
         self.assertTrue(pages is not None)
 
 
-@pytest.mark.single
+@pytest.mark.xfail(run=False, reason="flaky tests")
 class TestGBQConnectorIntegrationWithServiceAccountKeyContents(tm.TestCase):
     def setUp(self):
         _setup_common()
@@ -363,7 +363,6 @@ class TestGBQConnectorIntegrationWithServiceAccountKeyContents(tm.TestCase):
         self.assertTrue(pages is not None)
 
 
-@pytest.mark.single
 class GBQUnitTests(tm.TestCase):
 
     def setUp(self):
@@ -450,7 +449,7 @@ class GBQUnitTests(tm.TestCase):
                 private_key=re.sub('[a-z]', '9', _get_private_key_contents()))
 
 
-@pytest.mark.single
+@pytest.mark.xfail(run=False, reason="flaky tests")
 class TestReadGBQIntegration(tm.TestCase):
 
     @classmethod
@@ -504,7 +503,7 @@ class TestReadGBQIntegration(tm.TestCase):
         tm.assert_frame_equal(df, DataFrame({'valid_string': ['PI']}))
 
 
-@pytest.mark.single
+@pytest.mark.xfail(run=False, reason="flaky tests")
 class TestReadGBQIntegrationWithServiceAccountKeyPath(tm.TestCase):
 
     @classmethod
@@ -907,7 +906,7 @@ class TestReadGBQIntegrationWithServiceAccountKeyPath(tm.TestCase):
                          configuration=config)
 
 
-@pytest.mark.single
+@pytest.mark.xfail(run=False, reason="flaky tests")
 class TestToGBQIntegrationWithServiceAccountKeyPath(tm.TestCase):
     # Changes to BigQuery table schema may take up to 2 minutes as of May 2015
     # As a workaround to this issue, each test should use a unique table name.
@@ -1022,8 +1021,6 @@ class TestToGBQIntegrationWithServiceAccountKeyPath(tm.TestCase):
 
     def test_upload_data_if_table_exists_replace(self):
 
-        pytest.skip("buggy test")
-
         destination_table = DESTINATION_TABLE + "4"
 
         test_size = 10
@@ -1222,7 +1219,7 @@ class TestToGBQIntegrationWithServiceAccountKeyPath(tm.TestCase):
             DATASET_ID + "_not_found"), 'Expected dataset not to exist')
 
 
-@pytest.mark.single
+@pytest.mark.xfail(run=False, reason="flaky tests")
 class TestToGBQIntegrationWithLocalUserAccountAuth(tm.TestCase):
     # Changes to BigQuery table schema may take up to 2 minutes as of May 2015
     # As a workaround to this issue, each test should use a unique table name.
@@ -1280,7 +1277,7 @@ class TestToGBQIntegrationWithLocalUserAccountAuth(tm.TestCase):
         self.assertEqual(result['num_rows'][0], test_size)
 
 
-@pytest.mark.single
+@pytest.mark.xfail(run=False, reason="flaky tests")
 class TestToGBQIntegrationWithServiceAccountKeyContents(tm.TestCase):
     # Changes to BigQuery table schema may take up to 2 minutes as of May 2015
     # As a workaround to this issue, each test should use a unique table name.
