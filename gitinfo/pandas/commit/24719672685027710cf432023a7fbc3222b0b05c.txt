commit 24719672685027710cf432023a7fbc3222b0b05c
Author: Matti Picus <matti.picus@gmail.com>
Date:   Tue May 2 13:28:22 2017 +0300

    COMPAT: PySlice_GetIndicesEx is a macro on PyPy (#16194)

diff --git a/pandas/_libs/src/compat_helper.h b/pandas/_libs/src/compat_helper.h
index 8f86bb3f8..bdff61d7d 100644
--- a/pandas/_libs/src/compat_helper.h
+++ b/pandas/_libs/src/compat_helper.h
@@ -26,8 +26,10 @@ https://github.com/pandas-dev/pandas/issues/15961
 https://bugs.python.org/issue29943
 */
 
-#if PY_VERSION_HEX < 0x03070000 && defined(PySlice_GetIndicesEx)
-  #undef PySlice_GetIndicesEx
+#ifndef PYPY_VERSION
+# if PY_VERSION_HEX < 0x03070000 && defined(PySlice_GetIndicesEx)
+#   undef PySlice_GetIndicesEx
+# endif
 #endif
 
 PANDAS_INLINE int slice_get_indices(PyObject *s,
