commit 15a02d711dc313192e9162e1ace3a06cc1ff9afc
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Jun 11 13:00:17 2012 -0400

    BUG: properly detect tz-aware/tz-naive joins and raise exceptions. close #1426

diff --git a/pandas/tseries/index.py b/pandas/tseries/index.py
index 8094cbd10..f1293aa67 100644
--- a/pandas/tseries/index.py
+++ b/pandas/tseries/index.py
@@ -765,6 +765,12 @@ class DatetimeIndex(Int64Index):
     def _maybe_utc_convert(self, other):
         this = self
         if isinstance(other, DatetimeIndex):
+            if self.tz is not None:
+                if other.tz is None:
+                    raise Exception('Cannot join tz-naive with tz-aware DatetimeIndex')
+            elif other.tz is not None:
+                raise Exception('Cannot join tz-naive with tz-aware DatetimeIndex')
+
             if self.tz != other.tz:
                 this = self.tz_convert('UTC')
                 other = other.tz_convert('UTC')
diff --git a/pandas/tseries/tests/test_timezones.py b/pandas/tseries/tests/test_timezones.py
index a91365c5c..f5e1a3446 100644
--- a/pandas/tseries/tests/test_timezones.py
+++ b/pandas/tseries/tests/test_timezones.py
@@ -401,6 +401,15 @@ class TestTimeZones(unittest.TestCase):
             self.assert_(isinstance(result, DatetimeIndex))
             self.assert_(result.tz.zone == 'UTC')
 
+    def test_join_naive_with_aware(self):
+        rng = date_range('1/1/2011', periods=10, freq='H')
+        ts = Series(np.random.randn(len(rng)), index=rng)
+
+        ts_utc = ts.tz_localize('utc')
+
+        self.assertRaises(Exception, ts.__add__, ts_utc)
+        self.assertRaises(Exception, ts_utc.__add__, ts)
+
     def test_arith_utc_convert(self):
         rng = date_range('1/1/2011', periods=100, freq='H', tz='utc')
 
