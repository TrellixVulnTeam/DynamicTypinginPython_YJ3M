commit 6e921529455d0e9ed79b1e298a28cddc3f92e962
Author: y-p <yoval@gmx.com>
Date:   Tue Nov 27 19:05:22 2012 +0200

    VB: add tool to measure per benchmark memory consumption (experimental)

diff --git a/vb_suite/measure_memory_consumption.py b/vb_suite/measure_memory_consumption.py
new file mode 100755
index 000000000..cdc2fe0d4
--- /dev/null
+++ b/vb_suite/measure_memory_consumption.py
@@ -0,0 +1,54 @@
+#!/usr/bin/env python
+# -*- coding: utf-8 -*-
+
+from __future__ import print_function
+
+"""Short one-line summary
+
+long summary
+"""
+
+def main():
+    import shutil
+    import tempfile
+    import warnings
+
+    from pandas import Series
+
+    from vbench.api import BenchmarkRunner
+    from suite import (REPO_PATH, BUILD, DB_PATH, PREPARE,
+                       dependencies, benchmarks)
+
+    from memory_profiler import memory_usage
+
+    warnings.filterwarnings('ignore',category=FutureWarning)
+
+    try:
+        TMP_DIR =  tempfile.mkdtemp()
+        runner = BenchmarkRunner(benchmarks, REPO_PATH, REPO_PATH, BUILD, DB_PATH,
+                                 TMP_DIR, PREPARE, always_clean=True,
+            #                             run_option='eod', start_date=START_DATE,
+                                 module_dependencies=dependencies)
+        results = {}
+        for b in runner.benchmarks:
+            k=b.name
+            try:
+                vs=memory_usage((b.run,))
+                v = max(vs)
+                #print(k, v)
+                results[k]=v
+            except Exception as e:
+                print("Exception caught in %s\n" % k)
+                print(str(e))
+
+        s=Series(results)
+        s.sort()
+        print((s))
+
+    finally:
+        shutil.rmtree(TMP_DIR)
+
+
+
+if __name__ == "__main__":
+	main()
