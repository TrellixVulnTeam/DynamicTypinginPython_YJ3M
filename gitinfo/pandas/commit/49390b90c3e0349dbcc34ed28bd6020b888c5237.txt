commit 49390b90c3e0349dbcc34ed28bd6020b888c5237
Author: Chang She <chang@lambdafoundry.com>
Date:   Fri Mar 29 10:44:08 2013 -0700

    BUG: remove unused columns from final result

diff --git a/pandas/core/reshape.py b/pandas/core/reshape.py
index 92d90e625..adc824544 100644
--- a/pandas/core/reshape.py
+++ b/pandas/core/reshape.py
@@ -17,7 +17,7 @@ import pandas.core.common as com
 import pandas.algos as algos
 
 
-from pandas.core.index import MultiIndex
+from pandas.core.index import MultiIndex, Index
 
 
 class ReshapeError(Exception):
@@ -506,12 +506,14 @@ def _stack_multi_columns(frame, level=-1, dropna=True):
     new_data = {}
     level_vals = this.columns.levels[-1]
     levsize = len(level_vals)
+    drop_cols = []
     for key in unique_groups:
         loc = this.columns.get_loc(key)
         slice_len = loc.stop - loc.start
         # can make more efficient?
 
         if slice_len == 0:
+            drop_cols.append(key)
             continue
         elif slice_len != levsize:
             chunk = this.ix[:, this.columns[loc]]
@@ -525,6 +527,9 @@ def _stack_multi_columns(frame, level=-1, dropna=True):
 
         new_data[key] = value_slice.ravel()
 
+    if len(drop_cols) > 0:
+        new_columns = new_columns - drop_cols
+
     N = len(this)
 
     if isinstance(this.index, MultiIndex):
diff --git a/pandas/tests/test_multilevel.py b/pandas/tests/test_multilevel.py
index 04f389b19..08d214570 100644
--- a/pandas/tests/test_multilevel.py
+++ b/pandas/tests/test_multilevel.py
@@ -942,8 +942,9 @@ Thur,Lunch,Yes,51.51,17"""
         unst = multi.unstack('ID')
         down = unst.resample('W-THU')
 
-        rs = down.stack('ID') # It works!
-
+        rs = down.stack('ID')
+        xp = unst.ix[:, ['VAR1']].resample('W-THU').stack('ID')
+        assert_frame_equal(rs, xp)
 
     def test_unstack_multiple_hierarchical(self):
         df = DataFrame(index=[[0, 0, 0, 0, 1, 1, 1, 1],
