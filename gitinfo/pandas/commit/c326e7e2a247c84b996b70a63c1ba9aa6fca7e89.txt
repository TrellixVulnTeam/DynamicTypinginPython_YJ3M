commit c326e7e2a247c84b996b70a63c1ba9aa6fca7e89
Author: Dieter Vandenbussche <dvandenbussche@axioma.com>
Date:   Fri Feb 3 15:52:38 2012 -0500

    Special case np.int64 in ExcelWriter and add unittest

diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index 8deda3415..d8953e958 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -682,6 +682,8 @@ class ExcelWriter(object):
                     sheetrow.write(i,val,self.fm_datetime)
                 else:
                     sheetrow.write(i,val,self.fm_date)
+            elif isinstance(val, np.int64):
+                sheetrow.write(i,int(val))
             else:
                 sheetrow.write(i,val)
         row_idx += 1
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 9ce8bde73..b91fbe849 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -2288,6 +2288,13 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         recons = reader.parse('test1',index_col=0)
         assert_frame_equal(self.tsframe, recons)
 
+        #Test np.int64
+        frame = DataFrame(np.random.randn(10,2))
+        frame.to_excel(path,'test1')
+        reader = ExcelFile(path)
+        recons = reader.parse('test1',index_col=0)
+        assert_frame_equal(frame, recons)
+
         # Test writing to separate sheets
         writer = ExcelWriter(path)
         self.frame.to_excel(writer,'test1')
