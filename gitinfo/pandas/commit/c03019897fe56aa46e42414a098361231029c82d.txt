commit c03019897fe56aa46e42414a098361231029c82d
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Aug 12 18:14:31 2012 -0400

    BUG: fix isnull handling of objects on which bool fails e.g. DataFrame close #1749

diff --git a/RELEASE.rst b/RELEASE.rst
index 31ded56bb..9ea69d24b 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -85,6 +85,7 @@ pandas 0.8.2
   - Support StaticTzInfo in DatetimeIndex infrastructure (#1692)
   - Allow MultiIndex setops with length-0 other type indexes (#1727)
   - Fix handling of DatetimeIndex in DataFrame.to_records (#1720)
+  - Fix handling of general objects in isnull on which bool(...) fails (#1749)
 
 pandas 0.8.1
 ============
diff --git a/pandas/src/util.pxd b/pandas/src/util.pxd
index 694fd9202..f25f7b55c 100644
--- a/pandas/src/util.pxd
+++ b/pandas/src/util.pxd
@@ -58,7 +58,10 @@ cdef inline is_array(object o):
 
 
 cdef inline bint _checknull(object val):
-    return not cnp.PyArray_Check(val) and (val is None or val != val)
+    try:
+        return bool(val is None or val != val)
+    except ValueError:
+        return False
 
 cdef inline bint _checknan(object val):
     return not cnp.PyArray_Check(val) and val != val
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index daefbd745..26f6a5f2e 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -1020,6 +1020,17 @@ class TestSeries(unittest.TestCase, CheckNameIntegration):
         rep_str = repr(ser)
         self.assert_("Name: 0" in rep_str)
 
+    def test_repr_bool_fails(self):
+        s = Series([DataFrame(np.random.randn(2,2)) for i in range(5)])
+
+        import sys
+
+        buf = StringIO()
+        sys.stderr = buf
+        # it works (with no Cython exception barf)!
+        repr(s)
+        sys.stderr = sys.__stderr__
+        self.assertEquals(buf.getvalue(), '')
 
     def test_timeseries_repr_object_dtype(self):
         index = Index([datetime(2000, 1, 1) + timedelta(i)
