commit b874d836295e6b83628fb0c8bd9f9a1db3016233
Author: Chang She <chang@lambdafoundry.com>
Date:   Sun Jun 3 13:34:57 2012 -0400

    BUG: fixed Series.replace with later replacements clobbering earlier ones. Still need DataFrame fix

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index d79db0c15..39ba9614c 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -2956,7 +2956,6 @@ class DataFrame(NDFrame):
             else:
                 return self._constructor(new_data)
 
-
     def _replace_dest_dict(self, to_replace, value, inplace):
         rs = self if inplace else self.copy()
         for k, v in value.iteritems():
diff --git a/pandas/core/series.py b/pandas/core/series.py
index 4792f035c..a124fbc4c 100644
--- a/pandas/core/series.py
+++ b/pandas/core/series.py
@@ -2242,8 +2242,12 @@ copy : boolean, default False
             dd = {} # group by unique destination value
             [dd.setdefault(d, []).append(s) for s, d in to_rep.iteritems()]
 
+            masks = {}
             for d, sset in dd.iteritems(): # now replace by each dest
-                rs = _rep_one(rs, sset, d)
+                masks[d] = com.mask_missing(rs.values, sset)
+
+            for d, m in masks.iteritems():
+                np.putmask(rs.values, m, d)
             return rs
 
         if np.isscalar(to_replace):
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index 17e6e0aec..f0deaf289 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -2668,6 +2668,10 @@ class TestSeries(unittest.TestCase, CheckNameIntegration):
         self.assertRaises(ValueError, ser.replace, [1,2,3], [np.nan, 0])
         self.assertRaises(ValueError, ser.replace, xrange(1,3), [np.nan, 0])
 
+        ser = Series([0, 1, 2, 3, 4])
+        result = ser.replace([0, 1, 2, 3, 4], [4, 3, 2, 1, 0])
+        assert_series_equal(result, Series([4, 3, 2, 1, 0]))
+
     def test_asfreq(self):
         ts = Series([0., 1., 2.], index=[datetime(2009, 10, 30),
                                          datetime(2009, 11, 30),
