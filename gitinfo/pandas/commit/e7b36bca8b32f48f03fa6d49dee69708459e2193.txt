commit e7b36bca8b32f48f03fa6d49dee69708459e2193
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Thu Oct 20 18:25:42 2011 -0400

    BUG: don't convert Python long to float

diff --git a/pandas/io/tests/test_parsers.py b/pandas/io/tests/test_parsers.py
index 2da9ebaee..030194233 100644
--- a/pandas/io/tests/test_parsers.py
+++ b/pandas/io/tests/test_parsers.py
@@ -246,6 +246,17 @@ class TestParseSQL(unittest.TestCase):
         expected = np.array([1, 2, 3, np.nan, 4], dtype='f8')
         assert_same_values_and_dtype(result, expected)
 
+    def test_convert_sql_column_longs(self):
+        arr = np.array([1L, 2L, 3L, 4L], dtype='O')
+        result = lib.convert_sql_column(arr)
+        expected = np.array([1, 2, 3, 4], dtype='i8')
+        assert_same_values_and_dtype(result, expected)
+
+        arr = np.array([1L, 2L, 3L, None, 4L], dtype='O')
+        result = lib.convert_sql_column(arr)
+        expected = np.array([1, 2, 3, np.nan, 4], dtype='f8')
+        assert_same_values_and_dtype(result, expected)
+
     def test_convert_sql_column_bools(self):
         arr = np.array([True, False, True, False], dtype='O')
         result = lib.convert_sql_column(arr)
diff --git a/pandas/src/parsing.pyx b/pandas/src/parsing.pyx
index 044c0ac05..486c2550c 100644
--- a/pandas/src/parsing.pyx
+++ b/pandas/src/parsing.pyx
@@ -126,7 +126,7 @@ def convert_sql_column(ndarray[object] objects):
         elif cpython.PyBool_Check(val):
             seen_bool = 1
             bools[i] = val
-        elif cpython.PyInt_Check(val):
+        elif cpython.PyInt_Check(val) or cpython.PyLong_Check(val):
             seen_int = 1
             floats[i] = <float64_t> val
             if not seen_null:
