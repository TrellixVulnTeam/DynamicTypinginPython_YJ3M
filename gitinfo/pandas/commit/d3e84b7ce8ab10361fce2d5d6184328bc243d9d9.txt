commit d3e84b7ce8ab10361fce2d5d6184328bc243d9d9
Author: Abdullah İhsan Seçer <abdullahsecer@std.sehir.edu.tr>
Date:   Thu Jul 11 19:44:37 2019 +0300

     ENH: Raise ValueError for unsupported Window functions (#27275)

diff --git a/doc/source/whatsnew/v0.25.0.rst b/doc/source/whatsnew/v0.25.0.rst
index 2e7d5e953..72b714043 100644
--- a/doc/source/whatsnew/v0.25.0.rst
+++ b/doc/source/whatsnew/v0.25.0.rst
@@ -1138,6 +1138,7 @@ Groupby/resample/rolling
 - Bug in :meth:`pandas.core.window.Rolling.median` and :meth:`pandas.core.window.Rolling.quantile` where incorrect results are returned with ``closed='left'`` and ``closed='neither'`` (:issue:`26005`)
 - Improved :class:`pandas.core.window.Rolling`, :class:`pandas.core.window.Window` and :class:`pandas.core.window.EWM` functions to exclude nuisance columns from results instead of raising errors and raise a ``DataError`` only if all columns are nuisance (:issue:`12537`)
 - Bug in :meth:`pandas.core.window.Rolling.max` and :meth:`pandas.core.window.Rolling.min` where incorrect results are returned with an empty variable window (:issue:`26005`)
+- Raise a helpful exception when an unsupported weighted window function is used as an argument of :meth:`pandas.core.window.Window.aggregate` (:issue:`26597`)
 
 Reshaping
 ^^^^^^^^^
diff --git a/pandas/core/base.py b/pandas/core/base.py
index 15baf1bed..9480e2e42 100644
--- a/pandas/core/base.py
+++ b/pandas/core/base.py
@@ -314,9 +314,16 @@ class SelectionMixin:
 
         f = getattr(np, arg, None)
         if f is not None:
-            return f(self, *args, **kwargs)
+            try:
+                return f(self, *args, **kwargs)
+
+            except (AttributeError, TypeError):
+                pass
 
-        raise ValueError("{arg} is an unknown string function".format(arg=arg))
+        raise AttributeError(
+            "'{arg}' is not a valid function for "
+            "'{cls}' object".format(arg=arg, cls=type(self).__name__)
+        )
 
     def _aggregate(self, arg, *args, **kwargs):
         """
diff --git a/pandas/tests/window/test_window.py b/pandas/tests/window/test_window.py
index 2f3b83e17..3945a8aaa 100644
--- a/pandas/tests/window/test_window.py
+++ b/pandas/tests/window/test_window.py
@@ -439,6 +439,22 @@ class TestWindow(Base):
         with pytest.raises(UnsupportedFunctionCall, match=msg):
             getattr(w, method)(dtype=np.float64)
 
+    @td.skip_if_no_scipy
+    @pytest.mark.parametrize("arg", ["median", "var", "std", "kurt", "skew"])
+    def test_agg_function_support(self, arg):
+        df = pd.DataFrame({"A": np.arange(5)})
+        roll = df.rolling(2, win_type="triang")
+
+        msg = "'{arg}' is not a valid function for " "'Window' object".format(arg=arg)
+        with pytest.raises(AttributeError, match=msg):
+            roll.agg(arg)
+
+        with pytest.raises(AttributeError, match=msg):
+            roll.agg([arg])
+
+        with pytest.raises(AttributeError, match=msg):
+            roll.agg({"A": arg})
+
 
 class TestRolling(Base):
     def setup_method(self, method):
