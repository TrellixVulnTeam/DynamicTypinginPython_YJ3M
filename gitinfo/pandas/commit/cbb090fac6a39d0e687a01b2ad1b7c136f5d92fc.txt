commit cbb090fac6a39d0e687a01b2ad1b7c136f5d92fc
Author: Jeff Reback <jeff@reback.net>
Date:   Sun Sep 17 18:14:15 2017 -0400

    Revert "Remove pyx dependencies from setup (#17478)" (#17565)
    
    This reverts commit e6aed2ebb7374ed2a6a7c284750d47728aec285e.

diff --git a/setup.py b/setup.py
index 664478cc3..0e4e22b87 100755
--- a/setup.py
+++ b/setup.py
@@ -348,6 +348,14 @@ class CheckSDist(sdist_class):
     def initialize_options(self):
         sdist_class.initialize_options(self)
 
+        '''
+        self._pyxfiles = []
+        for root, dirs, files in os.walk('pandas'):
+            for f in files:
+                if f.endswith('.pyx'):
+                    self._pyxfiles.append(pjoin(root, f))
+        '''
+
     def run(self):
         if 'cython' in cmdclass:
             self.run_command('cython')
@@ -471,10 +479,11 @@ ext_data = {
     '_libs.lib': {'pyxfile': '_libs/lib',
                   'depends': lib_depends + tseries_depends},
     '_libs.hashtable': {'pyxfile': '_libs/hashtable',
+                        'pxdfiles': ['_libs/hashtable'],
                         'depends': (['pandas/_libs/src/klib/khash_python.h']
                                     + _pxi_dep['hashtable'])},
     '_libs.tslib': {'pyxfile': '_libs/tslib',
-                    'pxdfiles': ['_libs/src/util'],
+                    'pxdfiles': ['_libs/src/util', '_libs/lib'],
                     'depends': tseries_depends,
                     'sources': ['pandas/_libs/src/datetime/np_datetime.c',
                                 'pandas/_libs/src/datetime/np_datetime_strings.c']},
@@ -490,20 +499,21 @@ ext_data = {
     '_libs.index': {'pyxfile': '_libs/index',
                     'sources': ['pandas/_libs/src/datetime/np_datetime.c',
                                 'pandas/_libs/src/datetime/np_datetime_strings.c'],
-                    'pxdfiles': ['_libs/src/util'],
+                    'pxdfiles': ['_libs/src/util', '_libs/hashtable'],
                     'depends': _pxi_dep['index']},
     '_libs.algos': {'pyxfile': '_libs/algos',
-                    'pxdfiles': ['_libs/src/util'],
+                    'pxdfiles': ['_libs/src/util', '_libs/algos', '_libs/hashtable'],
                     'depends': _pxi_dep['algos']},
     '_libs.groupby': {'pyxfile': '_libs/groupby',
-                      'pxdfiles': ['_libs/src/util'],
-                      'depends': _pxi_dep['groupby']},
+                    'pxdfiles': ['_libs/src/util', '_libs/algos'],
+                    'depends': _pxi_dep['groupby']},
     '_libs.join': {'pyxfile': '_libs/join',
-                   'pxdfiles': ['_libs/src/util'],
+                   'pxdfiles': ['_libs/src/util', '_libs/hashtable'],
                    'depends': _pxi_dep['join']},
     '_libs.reshape': {'pyxfile': '_libs/reshape',
                       'depends': _pxi_dep['reshape']},
     '_libs.interval': {'pyxfile': '_libs/interval',
+                       'pxdfiles': ['_libs/hashtable'],
                        'depends': _pxi_dep['interval']},
     '_libs.window': {'pyxfile': '_libs/window',
                      'pxdfiles': ['_libs/src/skiplist', '_libs/src/util'],
@@ -516,9 +526,12 @@ ext_data = {
                       'sources': ['pandas/_libs/src/parser/tokenizer.c',
                                   'pandas/_libs/src/parser/io.c']},
     '_libs.sparse': {'pyxfile': '_libs/sparse',
-                     'depends': _pxi_dep['sparse']},
-    '_libs.testing': {'pyxfile': '_libs/testing'},
-    '_libs.hashing': {'pyxfile': '_libs/hashing'},
+                     'depends': (['pandas/_libs/sparse.pyx'] +
+                                 _pxi_dep['sparse'])},
+    '_libs.testing': {'pyxfile': '_libs/testing',
+                      'depends': ['pandas/_libs/testing.pyx']},
+    '_libs.hashing': {'pyxfile': '_libs/hashing',
+                      'depends': ['pandas/_libs/hashing.pyx']},
     'io.sas._sas': {'pyxfile': 'io/sas/sas'},
     }
 
