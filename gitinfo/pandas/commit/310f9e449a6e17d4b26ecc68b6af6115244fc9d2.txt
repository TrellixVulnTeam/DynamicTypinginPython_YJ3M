commit 310f9e449a6e17d4b26ecc68b6af6115244fc9d2
Author: Jeff Reback <jeff@reback.net>
Date:   Tue Aug 18 20:20:37 2015 -0400

    COMPAT: windows compat for #9838

diff --git a/pandas/core/internals.py b/pandas/core/internals.py
index 8fdc97bf2..1d6269ae9 100644
--- a/pandas/core/internals.py
+++ b/pandas/core/internals.py
@@ -676,7 +676,9 @@ class Block(PandasObject):
             # direction, then explictly repeat and reshape new instead
             if getattr(new, 'ndim', 0) >= 1:
                 if self.ndim - 1 == new.ndim and axis == 1:
-                    new = np.repeat(new, new_values.shape[-1]).reshape(self.shape)
+                    new = np.repeat(new, new_values.shape[-1]).reshape(
+                        self.shape)
+                new = new.astype(new_values.dtype)
 
             np.putmask(new_values, mask, new)
 
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 4d1d47430..7b6243f39 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -10144,8 +10144,8 @@ class TestDataFrame(tm.TestCase, CheckIndexing,
         midx = pd.MultiIndex.from_product([range(2), range(3), range(2)],
                                  names=('a', 'b', 'c'))
         idx = pd.Index(range(2), name='b')
-        df1 = pd.DataFrame(np.arange(12), index=midx)
-        df2 = pd.DataFrame(np.arange(2), index=idx)
+        df1 = pd.DataFrame(np.arange(12,dtype='int64'), index=midx)
+        df2 = pd.DataFrame(np.arange(2,dtype='int64'), index=idx)
 
         # these must be the same results (but flipped)
         res1l, res1r = df1.align(df2, join='left')
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index 030f11376..56146df37 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -6357,8 +6357,8 @@ class TestSeries(tm.TestCase, CheckNameIntegration):
         midx = pd.MultiIndex.from_product([range(2), range(3), range(2)],
                                  names=('a', 'b', 'c'))
         idx = pd.Index(range(2), name='b')
-        s1 = pd.Series(np.arange(12), index=midx)
-        s2 = pd.Series(np.arange(2), index=idx)
+        s1 = pd.Series(np.arange(12,dtype='int64'), index=midx)
+        s2 = pd.Series(np.arange(2,dtype='int64'), index=idx)
 
         # these must be the same results (but flipped)
         res1l, res1r = s1.align(s2, join='left')
