commit 1c3752334dcec4666bb7e6d51fb718a7674849ed
Author: DSM <dsm054@gmail.com>
Date:   Thu Jul 6 18:42:11 2017 -0400

    TST: Verify that float columns stay float after pivot (#7142) (#16815)

diff --git a/pandas/tests/reshape/test_pivot.py b/pandas/tests/reshape/test_pivot.py
index fc5a2eb46..9881ab72f 100644
--- a/pandas/tests/reshape/test_pivot.py
+++ b/pandas/tests/reshape/test_pivot.py
@@ -167,6 +167,24 @@ class TestPivotTable(object):
         expected = Series(dict(float64=2))
         tm.assert_series_equal(result, expected)
 
+    @pytest.mark.parametrize('columns,values',
+                             [('bool1', ['float1', 'float2']),
+                              ('bool1', ['float1', 'float2', 'bool1']),
+                              ('bool2', ['float1', 'float2', 'bool1'])])
+    def test_pivot_preserve_dtypes(self, columns, values):
+        # GH 7142 regression test
+        v = np.arange(5, dtype=np.float64)
+        df = DataFrame({'float1': v, 'float2': v + 2.0,
+                        'bool1': v <= 2, 'bool2': v <= 3})
+
+        df_res = df.reset_index().pivot_table(
+            index='index', columns=columns, values=values)
+
+        result = dict(df_res.dtypes)
+        expected = {col: np.dtype('O') if col[0].startswith('b')
+                    else np.dtype('float64') for col in df_res}
+        assert result == expected
+
     def test_pivot_no_values(self):
         # GH 14380
         idx = pd.DatetimeIndex(['2011-01-01', '2011-02-01', '2011-01-02',
