commit 952c6e767dbde55ee0a86726f99dbfbd244cd721
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Fri Sep 23 14:09:36 2011 -0400

    ENH: cython type fixes

diff --git a/pandas/src/reindex.pyx b/pandas/src/reindex.pyx
index c91fb8e7f..902bed97e 100644
--- a/pandas/src/reindex.pyx
+++ b/pandas/src/reindex.pyx
@@ -409,6 +409,8 @@ def ordered_left_join_put(ndarray[int64_t] left, ndarray[int64_t] right,
             for k from kleft <= k < kleft + kright:
                 out[i, k] = NaN
 
+@cython.wraparound(False)
+@cython.boundscheck(False)
 def inner_join_indexer(ndarray[int64_t] left, ndarray[int64_t] right):
     '''
     Two-pass algorithm?
@@ -459,10 +461,12 @@ def inner_join_indexer(ndarray[int64_t] left, ndarray[int64_t] right):
 def _inner_join_count(ndarray[int64_t] left, ndarray[int64_t] right):
     pass
 
+@cython.wraparound(False)
+@cython.boundscheck(False)
 def outer_join_indexer(ndarray[int64_t] left, ndarray[int64_t] right):
     cdef:
         Py_ssize_t i, j, nright, nleft, tot, count
-        int64_t val
+        int64_t lval, rval
         ndarray[int32_t] lindexer, rindexer
         ndarray[int64_t] result
 
@@ -489,6 +493,7 @@ def outer_join_indexer(ndarray[int64_t] left, ndarray[int64_t] right):
                     result[count] = right[j]
                     j += 1
                     count += 1
+                break
         elif j == nright:
             while i < nleft:
                 lindexer[count] = i
