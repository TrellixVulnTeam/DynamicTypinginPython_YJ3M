commit aa04812aa8da5505a52b094acffb8296f041b637
Author: Jeff Reback <jeff@reback.net>
Date:   Thu Aug 20 12:04:47 2015 -0400

    update legacy_storage for pickles

diff --git a/doc/source/whatsnew/v0.17.0.txt b/doc/source/whatsnew/v0.17.0.txt
index 039772f68..0c3af5c4b 100644
--- a/doc/source/whatsnew/v0.17.0.txt
+++ b/doc/source/whatsnew/v0.17.0.txt
@@ -198,6 +198,8 @@ Other enhancements
 
   ``tolerance`` is also exposed by the lower level ``Index.get_indexer`` and ``Index.get_loc`` methods.
 
+- Support pickling of ``Period`` objects (:issue:`10439`)
+
 .. _whatsnew_0170.api:
 
 .. _whatsnew_0170.api_breaking:
diff --git a/pandas/io/tests/data/legacy_msgpack/0.16.2/0.16.2_x86_64_darwin_2.7.10.msgpack b/pandas/io/tests/data/legacy_msgpack/0.16.2/0.16.2_x86_64_darwin_2.7.10.msgpack
index 6bf1b9b9a..000879f4c 100644
Binary files a/pandas/io/tests/data/legacy_msgpack/0.16.2/0.16.2_x86_64_darwin_2.7.10.msgpack and b/pandas/io/tests/data/legacy_msgpack/0.16.2/0.16.2_x86_64_darwin_2.7.10.msgpack differ
diff --git a/pandas/io/tests/data/legacy_pickle/0.16.2/0.16.2_x86_64_darwin_2.7.10.pickle b/pandas/io/tests/data/legacy_pickle/0.16.2/0.16.2_x86_64_darwin_2.7.10.pickle
index 60101c2f1..d45936baa 100644
Binary files a/pandas/io/tests/data/legacy_pickle/0.16.2/0.16.2_x86_64_darwin_2.7.10.pickle and b/pandas/io/tests/data/legacy_pickle/0.16.2/0.16.2_x86_64_darwin_2.7.10.pickle differ
diff --git a/pandas/io/tests/generate_legacy_storage_files.py b/pandas/io/tests/generate_legacy_storage_files.py
index 686efde84..86c5a9e0d 100644
--- a/pandas/io/tests/generate_legacy_storage_files.py
+++ b/pandas/io/tests/generate_legacy_storage_files.py
@@ -4,7 +4,8 @@ from distutils.version import LooseVersion
 from pandas import (Series, TimeSeries, DataFrame, Panel,
                     SparseSeries, SparseTimeSeries, SparseDataFrame, SparsePanel,
                     Index, MultiIndex, PeriodIndex, bdate_range, to_msgpack,
-                    date_range, period_range, bdate_range, Timestamp, Categorical)
+                    date_range, period_range, bdate_range, Timestamp, Categorical,
+                    Period)
 import os
 import sys
 import numpy as np
@@ -63,6 +64,10 @@ def create_data():
         'E': [0., 1, Timestamp('20100101'), 'foo', 2.]
     }
 
+    scalars = dict(timestamp=Timestamp('20130101'))
+    if LooseVersion(pandas.__version__) >= '0.17.0':
+        scalars['period'] = Period('2012','M')
+
     index = dict(int=Index(np.arange(10)),
                  date=date_range('20130101', periods=10),
                  period=period_range('2013-01-01', freq='M', periods=10))
@@ -78,8 +83,9 @@ def create_data():
                             index=MultiIndex.from_tuples(tuple(zip(*[[1, 1, 2, 2, 2], [3, 4, 3, 4, 5]])),
                                                          names=['one', 'two'])),
                   dup=Series(np.arange(5).astype(np.float64), index=['A', 'B', 'C', 'D', 'A']),
-                  cat=Series(Categorical(['foo', 'bar', 'baz'])),
-                  per=Series([Period('2000Q1')] * 5))
+                  cat=Series(Categorical(['foo', 'bar', 'baz'])))
+    if LooseVersion(pandas.__version__) >= '0.17.0':
+        series['period'] = Series([Period('2000Q1')] * 5)
 
     mixed_dup_df = DataFrame(data)
     mixed_dup_df.columns = list("ABCDA")
@@ -108,6 +114,7 @@ def create_data():
                 frame=frame,
                 panel=panel,
                 index=index,
+                scalars=scalars,
                 mi=mi,
                 sp_series=dict(float=_create_sp_series(),
                                ts=_create_sp_tsseries()),
diff --git a/pandas/io/tests/test_pickle.py b/pandas/io/tests/test_pickle.py
index e691fac21..8f2079722 100644
--- a/pandas/io/tests/test_pickle.py
+++ b/pandas/io/tests/test_pickle.py
@@ -48,7 +48,7 @@ class TestPickle():
             comparator = getattr(test_sparse,"assert_%s_equal" % typ)
             comparator(result,expected,exact_indices=False)
         else:
-            comparator = getattr(tm,"assert_%s_equal" % typ)
+            comparator = getattr(tm,"assert_%s_equal" % typ,tm.assert_almost_equal)
             comparator(result,expected)
 
     def compare(self, vf):
diff --git a/pandas/tseries/tests/test_period.py b/pandas/tseries/tests/test_period.py
index b78b5d5ad..eb5c6759b 100644
--- a/pandas/tseries/tests/test_period.py
+++ b/pandas/tseries/tests/test_period.py
@@ -6,9 +6,6 @@ Parts derived from scikits.timeseries code, original authors:
 
 """
 
-import pickle
-import os
-
 from datetime import datetime, date, timedelta
 
 from numpy.ma.testutils import assert_equal
@@ -2474,7 +2471,6 @@ class TestPeriodIndex(tm.TestCase):
 
     def test_pickle_freq(self):
         # GH2891
-        import pickle
         prng = period_range('1/1/2011', '1/1/2012', freq='M')
         new_prng = self.round_trip_pickle(prng)
         self.assertEqual(new_prng.freq,'M')
@@ -2541,9 +2537,7 @@ class TestPeriodIndex(tm.TestCase):
 
     def test_round_trip(self):
 
-        import pickle
         p = Period('2000Q1')
-
         new_p = self.round_trip_pickle(p)
         self.assertEqual(new_p, p)
 
