commit 5ad2d27db4e9ad8464e53f1131523d770ae31bc0
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Oct 9 15:37:04 2011 -0400

    BUG: work around unicode bug in py3.1 on win32

diff --git a/pandas/core/panel.py b/pandas/core/panel.py
index ed943c9b9..d0378821c 100644
--- a/pandas/core/panel.py
+++ b/pandas/core/panel.py
@@ -336,7 +336,7 @@ class Panel(NDFrame):
     def iteritems(self):
         for item in self.items:
             yield item, self[item]
-    
+
     # Name that won't get automatically converted to items by 2to3. items is
     # already in use for the first axis.
     iterkv = iteritems
@@ -654,7 +654,7 @@ class Panel(NDFrame):
     add = _panel_arith_method(operator.add, 'add')
     subtract = sub = _panel_arith_method(operator.sub, 'subtract')
     multiply = mul = _panel_arith_method(operator.mul, 'multiply')
-    
+
     try:
         divide = div = _panel_arith_method(operator.div, 'divide')
     except AttributeError:   # Python 3
@@ -1230,7 +1230,7 @@ class LongPanel(DataFrame):
     add = _panel_arith_method(operator.add, 'add')
     subtract = sub = _panel_arith_method(operator.sub, 'subtract')
     multiply = mul = _panel_arith_method(operator.mul, 'multiply')
-    
+
     try:
         divide = div = _panel_arith_method(operator.div, 'divide')
     except AttributeError:   # Python 3
@@ -1383,7 +1383,7 @@ class LongPanel(DataFrame):
             mapped = np.array([transform(val) for val in items])
 
             items = np.array(sorted(set(mapped)))
-            labels = items.searchsorted(mapped[labels])
+            labels = Index(items).get_indexer(mapped[labels])
             dim = len(items)
 
         values = np.eye(dim, dtype=float)
