commit 924c419070bc6d7c4edc6779b501377a22bce58d
Author: Loïc Séguin-C <lsc@loicseguin.com>
Date:   Thu Sep 17 21:49:11 2015 -0400

    BUG: remove midrule in latex output with header=False

diff --git a/doc/source/whatsnew/v0.17.1.txt b/doc/source/whatsnew/v0.17.1.txt
index 04c9bc501..bf6a9c3d4 100755
--- a/doc/source/whatsnew/v0.17.1.txt
+++ b/doc/source/whatsnew/v0.17.1.txt
@@ -44,4 +44,29 @@ Bug Fixes
 ~~~~~~~~~
 
 - Bug in ``.to_latex()`` output broken when the index has a name (:issue: `10660`)
+
+
+
+
+
+
+
+
+
+
+
+
 - Bug in ``squeeze()`` with zero length arrays (:issue:`11230`, :issue:`8999`)
+
+
+
+
+
+
+
+
+
+
+
+
+- Bug in ``DataFrame.to_latex()`` produces an extra rule when ``header=False`` (:issue:`7124`)
diff --git a/pandas/core/format.py b/pandas/core/format.py
index 1ad6f2501..bc25d14be 100644
--- a/pandas/core/format.py
+++ b/pandas/core/format.py
@@ -672,7 +672,7 @@ class DataFrameFormatter(TableFormatter):
             if any(frame.index.names):
                 nlevels += 1
             for i, row in enumerate(zip(*strcols)):
-                if i == nlevels:
+                if i == nlevels and self.header:
                     buf.write('\\midrule\n')  # End of header
                     if longtable:
                         buf.write('\\endhead\n')
diff --git a/pandas/tests/test_format.py b/pandas/tests/test_format.py
index b96a6d099..14ff9e65c 100644
--- a/pandas/tests/test_format.py
+++ b/pandas/tests/test_format.py
@@ -2793,6 +2793,30 @@ b &       b &     b \\
 """
         self.assertEqual(observed, expected)
 
+    def test_to_latex_no_header(self):
+        # GH 7124
+        df = DataFrame({'a': [1, 2],
+                        'b': ['b1', 'b2']})
+        withindex_result = df.to_latex(header=False)
+        withindex_expected = r"""\begin{tabular}{lrl}
+\toprule
+0 &  1 &  b1 \\
+1 &  2 &  b2 \\
+\bottomrule
+\end{tabular}
+"""
+        self.assertEqual(withindex_result, withindex_expected)
+
+        withoutindex_result = df.to_latex(index=False, header=False)
+        withoutindex_expected = r"""\begin{tabular}{rl}
+\toprule
+ 1 &  b1 \\
+ 2 &  b2 \\
+\bottomrule
+\end{tabular}
+"""
+        self.assertEqual(withoutindex_result, withoutindex_expected)
+
     def test_to_csv_quotechar(self):
         df = DataFrame({'col' : [1,2]})
         expected = """\
