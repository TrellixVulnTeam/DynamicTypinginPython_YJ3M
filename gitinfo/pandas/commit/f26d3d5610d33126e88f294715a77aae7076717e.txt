commit f26d3d5610d33126e88f294715a77aae7076717e
Author: Matteo Santamaria <matteosantama@gmail.com>
Date:   Fri May 22 04:58:30 2020 -0500

    TST: GH28813 test .diff() on Sparse dtype (#34268)

diff --git a/pandas/tests/frame/methods/test_diff.py b/pandas/tests/frame/methods/test_diff.py
index 6a9248e1c..e876e40aa 100644
--- a/pandas/tests/frame/methods/test_diff.py
+++ b/pandas/tests/frame/methods/test_diff.py
@@ -158,3 +158,14 @@ class TestDataFrameDiff:
 
         result = df.diff(axis=1, periods=-1)
         tm.assert_frame_equal(result, expected)
+
+    def test_diff_sparse(self):
+        # GH#28813 .diff() should work for sparse dataframes as well
+        sparse_df = pd.DataFrame([[0, 1], [1, 0]], dtype="Sparse[int]")
+
+        result = sparse_df.diff()
+        expected = pd.DataFrame(
+            [[np.nan, np.nan], [1.0, -1.0]], dtype=pd.SparseDtype("float", 0.0)
+        )
+
+        tm.assert_frame_equal(result, expected)
