commit 971db53b31fd2b632dea08efe1e552d6fb08e9ea
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Aug 21 20:58:42 2011 -0400

    BUG: fix groupby regression with differently-indexed Series. test coverage

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index 3758397d0..0ab66d8a8 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -469,7 +469,7 @@ def _convert_grouper(axis, grouper):
         if grouper.index.equals(axis):
             return np.asarray(grouper, dtype=object)
         else:
-            return grouper.__getitem__
+            return grouper.reindex(axis).astype(object)
     elif isinstance(grouper, (list, np.ndarray)):
         assert(len(grouper) == len(axis))
         return np.asarray(grouper, dtype=object)
diff --git a/pandas/core/internals.py b/pandas/core/internals.py
index 61fc561f4..8a0cdb136 100644
--- a/pandas/core/internals.py
+++ b/pandas/core/internals.py
@@ -262,13 +262,10 @@ class BlockManager(object):
             for block in self.blocks:
                 block.set_ref_items(self.items, maybe_rename=True)
 
-    def _set_items(self, value):
-        self.set_axis(0, value)
-
+    # make items read only for now
     def _get_items(self):
         return self.axes[0]
-
-    items = property(fget=_get_items, fset=_set_items)
+    items = property(fget=_get_items)
 
     def set_items_norename(self, value):
         value = _ensure_index(value)
diff --git a/pandas/tests/test_common.py b/pandas/tests/test_common.py
index 82f0dad64..2f3b1707b 100644
--- a/pandas/tests/test_common.py
+++ b/pandas/tests/test_common.py
@@ -92,6 +92,17 @@ def test_intersection():
 
     assert(a == inter)
 
+def test_groupby():
+    values = ['foo', 'bar', 'baz', 'baz2', 'qux', 'foo3']
+    expected = {'f' : ['foo', 'foo3'],
+                'b' : ['bar', 'baz', 'baz2'],
+                'q' : ['qux']}
+
+    grouped = common.groupby(values, lambda x: x[0])
+
+    for k, v in grouped:
+        assert v == expected[k]
+
 if __name__ == '__main__':
     import nose
     nose.runmodule(argv=[__file__,'-vvs','-x','--pdb', '--pdb-failure'],
diff --git a/pandas/tests/test_groupby.py b/pandas/tests/test_groupby.py
index 2af43b084..e072bcc25 100644
--- a/pandas/tests/test_groupby.py
+++ b/pandas/tests/test_groupby.py
@@ -665,6 +665,17 @@ class TestGroupBy(unittest.TestCase):
             group = x[-1]
             assert_frame_equal(result.ix[key], f(group))
 
+    def test_groupby_series_indexed_differently(self):
+        s1 = Series([5.0,-9.0,4.0,100.,-5.,55.,6.7],
+                    index=Index(['a','b','c','d','e','f','g']))
+        s2 = Series([1.0,1.0,4.0,5.0,5.0,7.0],
+                    index=Index(['a','b','d','f','g','h']))
+
+        grouped = s1.groupby(s2)
+        agged = grouped.mean()
+        exp = s1.groupby(s2.reindex(s1.index).get).mean()
+        assert_series_equal(agged, exp)
+
 class TestPanelGroupBy(unittest.TestCase):
 
     def setUp(self):
diff --git a/scripts/groupby_test.py b/scripts/groupby_test.py
index b69a63d0a..e2a0f107c 100644
--- a/scripts/groupby_test.py
+++ b/scripts/groupby_test.py
@@ -106,3 +106,10 @@ fillit = lambda x: x.fillna(method='pad')
 f = lambda x: x
 
 transformed = df.groupby(lambda x: x.strftime('%m/%y')).transform(lambda x: x)
+
+def ohlc(group):
+    return Series([group[0], group.max(), group.min(), group[-1]],
+                  index=['open', 'high', 'low', 'close'])
+grouper = [lambda x: x.year, lambda x: x.month]
+dr = DateRange('1/1/2000', '1/1/2002')
+ts = Series(np.random.randn(len(dr)), index=dr)
