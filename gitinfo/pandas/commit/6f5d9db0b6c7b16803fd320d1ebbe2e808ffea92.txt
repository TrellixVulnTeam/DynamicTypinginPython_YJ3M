commit 6f5d9db0b6c7b16803fd320d1ebbe2e808ffea92
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Jun 12 19:11:52 2011 -0400

    intermediate state atm

diff --git a/pandas/core/internals.py b/pandas/core/internals.py
index 0f33a4eb2..4b45c0cc6 100644
--- a/pandas/core/internals.py
+++ b/pandas/core/internals.py
@@ -87,21 +87,31 @@ class Block(object):
             common.null_out_axis(new_values, notmask, 0)
         return make_block(new_values, self.ref_locs, self.ref_columns)
 
-    # def reindex_columns(self, new_columns):
-    #     """
+    def reindex_columns(self, new_columns):
+        """
+
+        """
+        indexer, mask = self.columns.get_indexer(columns)
+        masked_idx = indexer[mask]
+        new_values = self.values.take(masked_idx, axis=1)
+        new_columns = self.columns.take(masked_idx)
+        return make_block(new_values, new_locs, columns)
 
-    #     """
-    #     indexer, mask = self.columns.get_indexer(new_columns)
-    #     new_values = self.values.take(indexer, axis=1)
+        indexer, mask = new_columns.get_indexer(self.ref_columns)
 
-    #     notmask = -mask
-    #     if len(mask) > 0 and notmask.any():
-    #         new_values = _cast_if_bool_int(new_values)
-    #         common.null_out_axis(new_values, notmask, 1)
+        loc_indexer = indexer.take(self.ref_locs)
+        loc_indexer = loc_indexer[mask.take(self.ref_locs)]
 
-    #     return make_block(new_values, new_columns)
+        new_values = self.values.take(indexer, axis=1)
+
+        notmask = -mask
+        if len(mask) > 0 and notmask.any():
+            new_values = _cast_if_bool_int(new_values)
+            common.null_out_axis(new_values, notmask, 1)
+
+        return make_block(new_values, new_columns)
 
-    def reindex_columns_from(self, columns):
+    def reindex_columns_from(self, indexer, notmask):
         """
         Reindex to only those columns contained in the input set of columns
 
diff --git a/pandas/core/tests/test_internals.py b/pandas/core/tests/test_internals.py
index 6d1f46607..03e3a5e91 100644
--- a/pandas/core/tests/test_internals.py
+++ b/pandas/core/tests/test_internals.py
@@ -22,13 +22,14 @@ class TestBlock(unittest.TestCase):
         pass
 
     def test_reindex_columns_from(self):
+        n = 10
         floats = np.repeat(np.atleast_2d(np.arange(3.)), n, axis=0)
         block = make_block(floats, [0, 2, 4],
                            ['a', 'b', 'c', 'd', 'e'])
 
         new_cols = Index(['e', 'b', 'c', 'f'])
 
-        reindexed = block.reindex_columns_from(new_cols)
+        reindexed = block.reindex_columns(new_cols)
         assert_almost_equal(reindexed.ref_locs, [0, 2])
         self.assertEquals(reindexed.values.shape[1], 2)
         self.assert_((reindexed.values[:, 0] == 2).all())
