commit 403c435b68d2dbf16b3af285322f7b395ae98429
Author: Vytautas Jancauskas <unaudio@gmail.com>
Date:   Thu Jul 26 18:07:40 2012 +0300

    Fixed issues with GeomPoint and GeomDensity2D

diff --git a/pandas/tools/rplot.py b/pandas/tools/rplot.py
index 3a1ef702e..aead4232a 100644
--- a/pandas/tools/rplot.py
+++ b/pandas/tools/rplot.py
@@ -191,7 +191,7 @@ def scale_constant(constant):
 		return constant
 	return scaler
 
-def default_aes(x, y):
+def default_aes(x=None, y=None):
 	"""Create the default aesthetics dictionary.
 	"""
 	return {
@@ -265,9 +265,9 @@ class GeomPoint(Layer):
 				s=size_scaler(self.data, index),
 				c=colour_scaler(self.data, index),
 				marker=shape_scaler(self.data, index),
-				alpha=alpha)
-		ax.set_xlabel(self.aesthetics['x'])
-		ax.set_ylabel(self.aesthetics['y'])
+				alpha=alpha(self.data, index))
+		ax.set_xlabel(self.aes['x'])
+		ax.set_ylabel(self.aes['y'])
 		return fig, ax
 
 class GeomDensity2D(Layer):
@@ -302,7 +302,7 @@ class GeomDensity2D(Layer):
 		kernel = stats.gaussian_kde(values)
 		Z = np.reshape(kernel(positions).T, X.shape)
 		ax.contour(Z, extent=[x_min, x_max, y_min, y_max])
-		return rplot
+		return fig, ax
 
 def display_grouped(grouped_data, x, y, fig):
 	"""A test routine to display grouped data.
@@ -466,7 +466,7 @@ class RPlot:
 	The main plot object. Add layers to an instance of this object to create a plot.
 	"""
 	def __init__(self, data, x=None, y=None):
-		self.layers = [Layer(data, aes(x=x, y=y))]
+		self.layers = [Layer(data, default_aes(x=x, y=y))]
 		trellised = False
 
 	def __add__(self, other):
