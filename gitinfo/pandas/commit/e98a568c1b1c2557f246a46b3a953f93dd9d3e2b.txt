commit e98a568c1b1c2557f246a46b3a953f93dd9d3e2b
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sat Sep 15 15:10:56 2012 -0400

    BUG: support datetime.date in rollback/rollforward

diff --git a/RELEASE.rst b/RELEASE.rst
index 40f5f0d5b..9c780b79b 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -164,6 +164,7 @@ pandas 0.9.0
   - Fix column name formatting issue in length-truncated column (#1906)
   - Fix broken handling of copying Index metadata to new instances created by
     view(...) calls inside the NumPy infrastructure
+  - Support datetime.date again in DateOffset.rollback/rollforward
 
 pandas 0.8.1
 ============
diff --git a/pandas/tseries/offsets.py b/pandas/tseries/offsets.py
index cb409290d..84781973f 100644
--- a/pandas/tseries/offsets.py
+++ b/pandas/tseries/offsets.py
@@ -1,4 +1,4 @@
-from datetime import datetime, timedelta
+from datetime import date, datetime, timedelta
 
 from pandas.tseries.tools import to_datetime
 
@@ -180,17 +180,29 @@ class DateOffset(object):
     def __neg__(self):
         return self.__class__(-self.n, **self.kwds)
 
-    def rollback(self, someDate):
+    def rollback(self, dt):
         """Roll provided date backward to next offset only if not on offset"""
-        if not self.onOffset(someDate):
-            someDate = someDate - self.__class__(1, **self.kwds)
-        return someDate
+        try:
+            if not self.onOffset(dt):
+                dt = dt - self.__class__(1, **self.kwds)
+            return dt
+        except Exception:
+            if isinstance(dt, date):
+                return self.rollback(datetime(dt.year, dt.month, dt.day))
+            else:
+                raise
 
     def rollforward(self, dt):
         """Roll provided date forward to next offset only if not on offset"""
-        if not self.onOffset(dt):
-            dt = dt + self.__class__(1, **self.kwds)
-        return dt
+        try:
+            if not self.onOffset(dt):
+                dt = dt + self.__class__(1, **self.kwds)
+            return dt
+        except Exception:
+            if isinstance(dt, date):
+                return self.rollforward(datetime(dt.year, dt.month, dt.day))
+            else:
+                raise
 
     def onOffset(self, dt):
         if type(self) == DateOffset:
diff --git a/pandas/tseries/tests/test_offsets.py b/pandas/tseries/tests/test_offsets.py
index db466f82a..8e4a15b60 100644
--- a/pandas/tseries/tests/test_offsets.py
+++ b/pandas/tseries/tests/test_offsets.py
@@ -1,4 +1,4 @@
-from datetime import datetime, timedelta
+from datetime import date, datetime, timedelta
 import unittest
 import numpy as np
 
@@ -173,6 +173,17 @@ class TestBusinessDay(unittest.TestCase):
     def testRollforward2(self):
         self.assertEqual(BDay(10).rollforward(datetime(2008, 1, 5)), datetime(2008, 1, 7))
 
+    def test_roll_date_object(self):
+        offset = BDay()
+
+        dt = date(2012, 9, 15)
+
+        result = offset.rollback(dt)
+        self.assertEqual(result, datetime(2012, 9, 14))
+
+        result = offset.rollforward(dt)
+        self.assertEqual(result, datetime(2012, 9, 17))
+
     def test_onOffset(self):
         tests = [(BDay(), datetime(2008, 1, 1), True),
                  (BDay(), datetime(2008, 1, 5), False)]
