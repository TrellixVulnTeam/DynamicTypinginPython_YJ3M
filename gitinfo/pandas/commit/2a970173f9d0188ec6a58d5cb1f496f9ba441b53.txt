commit 2a970173f9d0188ec6a58d5cb1f496f9ba441b53
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Thu Feb 25 21:07:41 2010 +0000

    added IndexableSkiplist and first version of a faster rolling median algo
    
    git-svn-id: http://pandas.googlecode.com/svn/trunk@128 d5231056-7de3-11de-ac95-d976489f1ece

diff --git a/pandas/lib/build.py b/pandas/lib/build.py
index f0f6d6c56..f036b8fe1 100644
--- a/pandas/lib/build.py
+++ b/pandas/lib/build.py
@@ -1,26 +1,15 @@
 #/usr/bin/env python
 
 from distutils.extension import Extension
-from numpy.distutils.misc_util import Configuration
 from numpy.distutils.core import setup
 import numpy
-
-config = Configuration('pandas', parent_package=None, top_path=None)
-
 from Cython.Distutils import build_ext
 
-
 pyx_ext = Extension('tseries', ['src/tseries.pyx',
-                                'src/wirth.c'],
+                                 'src/wirth.c'],
                     include_dirs=[numpy.get_include(),
                                   'include/'])
 
-
-dates_ext = Extension('tdates', ['src/tdates.c'],
-                      include_dirs=[numpy.get_include()])
-
-setup(name='tdates', description='Nothing', ext_modules=[dates_ext])
-
 setup(name='pandas.lib.tseries', description='Nothing',
       ext_modules=[pyx_ext],
       cmdclass = {
diff --git a/pandas/lib/src/moments.pyx b/pandas/lib/src/moments.pyx
index 04cc07337..7c172456e 100644
--- a/pandas/lib/src/moments.pyx
+++ b/pandas/lib/src/moments.pyx
@@ -1,6 +1,8 @@
 # Cython implementations of rolling sum, mean, variance, skewness,
 # other statistical moment functions
 
+include "skiplist.pyx"
+
 cdef extern from "wirth.h":
     double kth_smallest(double *a, int n, int k)
 
@@ -566,22 +568,6 @@ def median(ndarray arr):
         return (kth_smallest(values, n, n / 2) +
                 kth_smallest(values, n, n / 2 - 1)) / 2
 
-def roll_median(ndarray[npy_float64, ndim=1] arr, int window, int minp):
-    cdef char *mask_data
-    cdef ndarray mask
-    cdef ndarray[npy_float64, ndim=1] result
-    cdef int i, n
-
-    n = len(arr)
-    arr = arr.copy()
-
-    mask = <ndarray> np.isfinite(arr)
-    mask_data = <char *> mask.data
-
-    result = np.empty(len(arr), dtype=float)
-
-    for i from minp <= i <= n:
-        pass
 
 
 #-------------------------------------------------------------------------------
@@ -653,6 +639,52 @@ def _roll_min_noncontig(ndarray[double_t, ndim=1] input,
 
         output[j] = val
 
+def roll_median(ndarray[npy_float64, ndim=1] arr, int window, int minp):
+    cdef char *mask_data
+    cdef ndarray mask
+    cdef ndarray[npy_float64, ndim=1] result
+    cdef int i, n
+
+    n = len(arr)
+    arr = arr.copy()
+
+    mask = <ndarray> np.isfinite(arr)
+    mask_data = <char *> mask.data
+
+    result = np.empty(len(arr), dtype=float)
+
+    for i from minp <= i <= n:
+        pass
+
+def rolling_median(ndarray[double, ndim=1] arr, int window):
+    cdef int i, n, midpoint
+    cdef IndexableSkiplist skiplist
+    cdef ndarray[double, ndim=1] result
+
+    n = len(arr)
+    skiplist = IndexableSkiplist(window)
+    result = np.empty(n, dtype=float)
+    result[:window] = NaN
+
+    for i from 0 <= i < window:
+        skiplist.insert(arr[i])
+
+    midpoint = window / 2
+
+    cdef int flag = window % 2
+
+    for i from window <= i < n:
+        skiplist.remove(arr[i - window])
+        skiplist.insert(arr[i])
+
+        if flag:
+            result[i] = skiplist.get(midpoint)
+        else:
+            result[i] = (skiplist.get(midpoint) +
+                         skiplist.get(midpoint - 1)) / 2
+
+    return result
+
 #-------------------------------------------------------------------------------
 # Python interface
 
@@ -793,3 +825,4 @@ def rolling_kurt(ndarray input, window, minp=None):
         _roll_kurt_noncontig(input, output, window, minp, N)
 
     return output
+
diff --git a/pandas/lib/src/skiplist.pyx b/pandas/lib/src/skiplist.pyx
new file mode 100644
index 000000000..9a5f10644
--- /dev/null
+++ b/pandas/lib/src/skiplist.pyx
@@ -0,0 +1,153 @@
+# Cython version of IndexableSkiplist, for implementing moving median
+# with O(log n) updates
+# Original author: Raymond Hettinger
+# Original license: MIT
+# Link: http://code.activestate.com/recipes/576930/
+
+# Cython version: Wes McKinney
+
+cdef extern from "numpy/arrayobject.h":
+
+    void import_array()
+
+cdef extern from "math.h":
+    double log2(double x)
+
+cimport numpy as np
+from numpy cimport *
+import numpy as np
+
+from random import random
+
+# initialize numpy
+import_array()
+
+cdef class Node:
+
+    cdef public:
+        double value
+        list next
+        ndarray width_arr
+
+    cdef:
+        int *width
+
+    def __init__(self, double value, list next, ndarray width):
+        self.value = value
+        self.next = next
+        self.width_arr = width
+        self.width = <int *> width.data
+
+NIL = Node(np.inf, [], np.array([])) # Singleton terminator node
+
+cdef class IndexableSkiplist:
+    '''
+    Sorted collection supporting O(lg n) insertion, removal, and lookup by rank.
+    '''
+    cdef:
+        int size, maxlevels
+        Node head
+
+    def __init__(self, expected_size=100):
+        self.size = 0
+        self.maxlevels = int(1 + log2(expected_size))
+
+        self.head = Node(np.NaN, [NIL] * self.maxlevels,
+                         np.ones(self.maxlevels, dtype=int))
+
+    def __len__(self):
+        return self.size
+
+    def __getitem__(self, i):
+        return self.get(i)
+
+    def get(self, int i):
+        cdef int level
+        cdef Node node
+
+        node = self.head
+        i += 1
+
+        for level in range(self.maxlevels - 1, -1, -1):
+            while node.width[level] <= i:
+                i -= node.width[level]
+                node = node.next[level]
+
+        return node.value
+
+    def insert(self, double value):
+        cdef int level, steps, d
+        cdef Node node, prevnode, newnode, next_at_level
+        cdef list chain, steps_at_level
+
+        # find first node on each level where node.next[levels].value > value
+        chain = [None] * self.maxlevels
+        steps_at_level = [0] * self.maxlevels
+
+        node = self.head
+        for level in range(self.maxlevels - 1, -1, -1):
+            next_at_level = node.next[level]
+
+            while next_at_level.value <= value:
+                steps_at_level[level] = (steps_at_level[level] +
+                                         node.width[level])
+                node = next_at_level
+                next_at_level = node.next[level]
+
+            chain[level] = node
+
+        # insert a link to the newnode at each level
+        d = min(self.maxlevels, 1 - int(log2(random())))
+        newnode = Node(value, [None] * d, np.empty(d, dtype=int))
+        steps = 0
+
+        for level in range(d):
+            prevnode = chain[level]
+
+            newnode.next[level] = prevnode.next[level]
+            prevnode.next[level] = newnode
+
+            newnode.width[level] = prevnode.width[level] - steps
+            prevnode.width[level] = steps + 1
+
+            steps = steps + steps_at_level[level]
+
+        for level in range(d, self.maxlevels):
+            (<Node> chain[level]).width[level] += 1
+
+        self.size += 1
+
+    def remove(self, double value):
+        cdef int level, d
+        cdef Node node, prevnode, tmpnode, next_at_level
+        cdef list chain
+
+        # find first node on each level where node.next[levels].value >= value
+        chain = [None] * self.maxlevels
+        node = self.head
+
+        for level in range(self.maxlevels - 1, -1, -1):
+            next_at_level = node.next[level]
+            while next_at_level.value < value:
+                node = next_at_level
+                next_at_level = node.next[level]
+
+            chain[level] = node
+
+        if value != chain[0].next[0].value:
+            raise KeyError('Not Found')
+
+        # remove one link at each level
+        d = len(chain[0].next[0].next)
+
+        for level in range(d):
+            prevnode = chain[level]
+            tmpnode = prevnode.next[level]
+            prevnode.width[level] += tmpnode.width[level] - 1
+            prevnode.next[level] = tmpnode.next[level]
+
+        for level in range(d, self.maxlevels):
+            tmpnode = chain[level]
+            tmpnode.width[level] -= 1
+
+        self.size -= 1
diff --git a/pandas/lib/src/tseries.c b/pandas/lib/src/tseries.c
index 8c6b67c45..8cf272aba 100644
--- a/pandas/lib/src/tseries.c
+++ b/pandas/lib/src/tseries.c
@@ -1,4 +1,4 @@
-/* Generated by Cython 0.12.rc1 on Thu Dec 17 11:53:58 2009 */
+/* Generated by Cython 0.12.rc1 on Thu Feb 25 16:05:23 2010 */
 
 #define PY_SSIZE_T_CLEAN
 #include "Python.h"
@@ -362,6 +362,37 @@ typedef npy_cdouble __pyx_t_5numpy_complex_t;
 
 typedef double (*__pyx_t_7tseries_double_func)(double, double);
 
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":46
+ * NIL = Node(np.inf, [], np.array([])) # Singleton terminator node
+ * 
+ * cdef class IndexableSkiplist:             # <<<<<<<<<<<<<<
+ *     '''
+ *     Sorted collection supporting O(lg n) insertion, removal, and lookup by rank.
+ */
+
+struct __pyx_obj_7tseries_IndexableSkiplist {
+  PyObject_HEAD
+  int size;
+  int maxlevels;
+  struct __pyx_obj_7tseries_Node *head;
+};
+
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":25
+ * import_array()
+ * 
+ * cdef class Node:             # <<<<<<<<<<<<<<
+ * 
+ *     cdef public:
+ */
+
+struct __pyx_obj_7tseries_Node {
+  PyObject_HEAD
+  double value;
+  PyObject *next;
+  PyArrayObject *width_arr;
+  int *width;
+};
+
 #ifndef CYTHON_REFNANNY
   #define CYTHON_REFNANNY 0
 #endif
@@ -533,6 +564,33 @@ static INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int fit
     return r;
 }
 
+#define __Pyx_SetItemInt(o, i, v, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
+                                                    __Pyx_SetItemInt_Fast(o, i, v, size <= sizeof(long)) : \
+                                                    __Pyx_SetItemInt_Generic(o, to_py_func(i), v))
+
+static INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v) {
+    int r;
+    if (!j) return -1;
+    r = PyObject_SetItem(o, j, v);
+    Py_DECREF(j);
+    return r;
+}
+
+static INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v, int fits_long) {
+    if (PyList_CheckExact(o) && ((0 <= i) & (i < PyList_GET_SIZE(o)))) {
+        Py_INCREF(v);
+        Py_DECREF(PyList_GET_ITEM(o, i));
+        PyList_SET_ITEM(o, i, v);
+        return 1;
+    }
+    else if (Py_TYPE(o)->tp_as_sequence && Py_TYPE(o)->tp_as_sequence->sq_ass_item && (likely(i >= 0)))
+        return PySequence_SetItem(o, i, v);
+    else {
+        PyObject *j = fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i);
+        return __Pyx_SetItemInt_Generic(o, j, v);
+    }
+}
+
 static INLINE long __Pyx_mod_long(long, long); /* proto */
 
 static INLINE long __Pyx_div_long(long, long); /* proto */
@@ -742,6 +800,8 @@ static INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *); /*proto*
 /* Module declarations from tseries */
 
 static PyTypeObject *__pyx_ptype_7tseries_datetime = 0;
+static PyTypeObject *__pyx_ptype_7tseries_Node = 0;
+static PyTypeObject *__pyx_ptype_7tseries_IndexableSkiplist = 0;
 static double __pyx_v_7tseries_NaN;
 static double __pyx_v_7tseries_INF;
 static double __pyx_v_7tseries_NEGINF;
@@ -782,31 +842,34 @@ static __Pyx_TypeInfo __Pyx_TypeInfo_nn_npy_int8 = { "numpy.npy_int8", NULL, siz
 static __Pyx_TypeInfo __Pyx_TypeInfo_object = { "Python object", NULL, sizeof(PyObject *), 'O' };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn_npy_float64 = { "numpy.npy_float64", NULL, sizeof(npy_float64), 'R' };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_double_t = { "numpy.double_t", NULL, sizeof(__pyx_t_5numpy_double_t), 'R' };
+static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), 'R' };
 #define __Pyx_MODULE_NAME "tseries"
 int __pyx_module_is_main_tseries = 0;
 
 /* Implementation of tseries */
 static PyObject *__pyx_builtin_Exception;
 static PyObject *__pyx_builtin_ValueError;
-static PyObject *__pyx_builtin_max;
+static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_min;
+static PyObject *__pyx_builtin_KeyError;
+static PyObject *__pyx_builtin_max;
 static PyObject *__pyx_builtin_object;
-static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_RuntimeError;
 static char __pyx_k_1[] = "Error calling func on index %s";
 static char __pyx_k_2[] = "Tried to use data field on non-contiguous array!";
 static char __pyx_k_3[] = "Dates and values were not the same length!";
-static char __pyx_k_4[] = "_roll_mean_noncontig";
-static char __pyx_k_5[] = "_roll_skew_noncontig";
-static char __pyx_k_6[] = "_roll_kurt_noncontig";
-static char __pyx_k_7[] = "";
-static char __pyx_k_8[] = "bad funcname requested of Cython code";
-static char __pyx_k_9[] = "ndarray is not C contiguous";
-static char __pyx_k_10[] = "ndarray is not Fortran contiguous";
-static char __pyx_k_11[] = "Non-native byte order not supported";
-static char __pyx_k_12[] = "unknown dtype code in numpy.pxd (%d)";
-static char __pyx_k_13[] = "Format string allocated too short, see comment in numpy.pxd";
-static char __pyx_k_14[] = "Format string allocated too short.";
+static char __pyx_k_4[] = "Not Found";
+static char __pyx_k_5[] = "_roll_mean_noncontig";
+static char __pyx_k_6[] = "_roll_skew_noncontig";
+static char __pyx_k_7[] = "_roll_kurt_noncontig";
+static char __pyx_k_8[] = "";
+static char __pyx_k_9[] = "bad funcname requested of Cython code";
+static char __pyx_k_10[] = "ndarray is not C contiguous";
+static char __pyx_k_11[] = "ndarray is not Fortran contiguous";
+static char __pyx_k_12[] = "Non-native byte order not supported";
+static char __pyx_k_13[] = "unknown dtype code in numpy.pxd (%d)";
+static char __pyx_k_14[] = "Format string allocated too short, see comment in numpy.pxd";
+static char __pyx_k_15[] = "Format string allocated too short.";
 static char __pyx_k__B[] = "B";
 static char __pyx_k__H[] = "H";
 static char __pyx_k__I[] = "I";
@@ -829,12 +892,14 @@ static char __pyx_k__Zg[] = "Zg";
 static char __pyx_k__ao[] = "ao";
 static char __pyx_k__bo[] = "bo";
 static char __pyx_k__np[] = "np";
+static char __pyx_k__NIL[] = "NIL";
 static char __pyx_k__NaN[] = "NaN";
 static char __pyx_k__PAD[] = "PAD";
 static char __pyx_k__any[] = "any";
 static char __pyx_k__arr[] = "arr";
 static char __pyx_k__buf[] = "buf";
 static char __pyx_k__com[] = "com";
+static char __pyx_k__get[] = "get";
 static char __pyx_k__inf[] = "inf";
 static char __pyx_k__max[] = "max";
 static char __pyx_k__min[] = "min";
@@ -847,11 +912,15 @@ static char __pyx_k__bool[] = "bool";
 static char __pyx_k__copy[] = "copy";
 static char __pyx_k__data[] = "data";
 static char __pyx_k__func[] = "func";
+static char __pyx_k__head[] = "head";
 static char __pyx_k__int8[] = "int8";
 static char __pyx_k__kind[] = "kind";
 static char __pyx_k__minp[] = "minp";
 static char __pyx_k__name[] = "name";
 static char __pyx_k__ndim[] = "ndim";
+static char __pyx_k__next[] = "next";
+static char __pyx_k__ones[] = "ones";
+static char __pyx_k__size[] = "size";
 static char __pyx_k__sqrt[] = "sqrt";
 static char __pyx_k__type[] = "type";
 static char __pyx_k__array[] = "array";
@@ -866,6 +935,8 @@ static char __pyx_k__names[] = "names";
 static char __pyx_k__numpy[] = "numpy";
 static char __pyx_k__range[] = "range";
 static char __pyx_k__shape[] = "shape";
+static char __pyx_k__value[] = "value";
+static char __pyx_k__width[] = "width";
 static char __pyx_k__zeros[] = "zeros";
 static char __pyx_k____eq__[] = "__eq__";
 static char __pyx_k____gt__[] = "__gt__";
@@ -876,11 +947,14 @@ static char __pyx_k__astype[] = "astype";
 static char __pyx_k__fields[] = "fields";
 static char __pyx_k__format[] = "format";
 static char __pyx_k__idxMap[] = "idxMap";
+static char __pyx_k__insert[] = "insert";
 static char __pyx_k__isnull[] = "isnull";
 static char __pyx_k__newMap[] = "newMap";
 static char __pyx_k__object[] = "object";
 static char __pyx_k__oldMap[] = "oldMap";
 static char __pyx_k__output[] = "output";
+static char __pyx_k__random[] = "random";
+static char __pyx_k__remove[] = "remove";
 static char __pyx_k__values[] = "values";
 static char __pyx_k__window[] = "window";
 static char __pyx_k____add__[] = "__add__";
@@ -894,6 +968,7 @@ static char __pyx_k__keyfunc[] = "keyfunc";
 static char __pyx_k__object_[] = "object_";
 static char __pyx_k__strides[] = "strides";
 static char __pyx_k__BACKFILL[] = "BACKFILL";
+static char __pyx_k__KeyError[] = "KeyError";
 static char __pyx_k____main__[] = "__main__";
 static char __pyx_k__datetime[] = "datetime";
 static char __pyx_k__indexMap[] = "indexMap";
@@ -906,11 +981,14 @@ static char __pyx_k__type_num[] = "type_num";
 static char __pyx_k__Exception[] = "Exception";
 static char __pyx_k__applyfunc[] = "applyfunc";
 static char __pyx_k__byteorder[] = "byteorder";
+static char __pyx_k__maxlevels[] = "maxlevels";
+static char __pyx_k__width_arr[] = "width_arr";
 static char __pyx_k__ValueError[] = "ValueError";
 static char __pyx_k__pydatetime[] = "pydatetime";
 static char __pyx_k__suboffsets[] = "suboffsets";
 static char __pyx_k__rolling_var[] = "rolling_var";
 static char __pyx_k__RuntimeError[] = "RuntimeError";
+static char __pyx_k__expected_size[] = "expected_size";
 static char __pyx_k___ewma_noncontig[] = "_ewma_noncontig";
 static char __pyx_k___roll_sum_noncontig[] = "_roll_sum_noncontig";
 static char __pyx_k___roll_var_noncontig[] = "_roll_var_noncontig";
@@ -920,17 +998,20 @@ static PyObject *__pyx_kp_u_11;
 static PyObject *__pyx_kp_u_12;
 static PyObject *__pyx_kp_u_13;
 static PyObject *__pyx_kp_u_14;
+static PyObject *__pyx_kp_u_15;
 static PyObject *__pyx_kp_s_2;
 static PyObject *__pyx_kp_s_3;
-static PyObject *__pyx_n_s_4;
+static PyObject *__pyx_kp_s_4;
 static PyObject *__pyx_n_s_5;
 static PyObject *__pyx_n_s_6;
-static PyObject *__pyx_kp_s_7;
+static PyObject *__pyx_n_s_7;
 static PyObject *__pyx_kp_s_8;
-static PyObject *__pyx_kp_u_9;
+static PyObject *__pyx_kp_s_9;
 static PyObject *__pyx_n_s__BACKFILL;
 static PyObject *__pyx_n_s__Exception;
+static PyObject *__pyx_n_s__KeyError;
 static PyObject *__pyx_n_s__N;
+static PyObject *__pyx_n_s__NIL;
 static PyObject *__pyx_n_s__NaN;
 static PyObject *__pyx_n_s__O;
 static PyObject *__pyx_n_s__PAD;
@@ -972,15 +1053,19 @@ static PyObject *__pyx_n_s__datetime;
 static PyObject *__pyx_n_s__descr;
 static PyObject *__pyx_n_s__dtype;
 static PyObject *__pyx_n_s__empty;
+static PyObject *__pyx_n_s__expected_size;
 static PyObject *__pyx_n_s__fields;
 static PyObject *__pyx_n_s__float64;
 static PyObject *__pyx_n_s__format;
 static PyObject *__pyx_n_s__func;
+static PyObject *__pyx_n_s__get;
+static PyObject *__pyx_n_s__head;
 static PyObject *__pyx_n_s__idxMap;
 static PyObject *__pyx_n_s__index;
 static PyObject *__pyx_n_s__indexMap;
 static PyObject *__pyx_n_s__inf;
 static PyObject *__pyx_n_s__input;
+static PyObject *__pyx_n_s__insert;
 static PyObject *__pyx_n_s__int32;
 static PyObject *__pyx_n_s__int8;
 static PyObject *__pyx_n_s__isfinite;
@@ -990,6 +1075,7 @@ static PyObject *__pyx_n_s__itemsize;
 static PyObject *__pyx_n_s__keyfunc;
 static PyObject *__pyx_n_s__kind;
 static PyObject *__pyx_n_s__max;
+static PyObject *__pyx_n_s__maxlevels;
 static PyObject *__pyx_n_s__min;
 static PyObject *__pyx_n_s__minp;
 static PyObject *__pyx_n_s__name;
@@ -997,6 +1083,7 @@ static PyObject *__pyx_n_s__names;
 static PyObject *__pyx_n_s__ndim;
 static PyObject *__pyx_n_s__newIndex;
 static PyObject *__pyx_n_s__newMap;
+static PyObject *__pyx_n_s__next;
 static PyObject *__pyx_n_s__np;
 static PyObject *__pyx_n_s__numpy;
 static PyObject *__pyx_n_s__obj;
@@ -1004,26 +1091,35 @@ static PyObject *__pyx_n_s__object;
 static PyObject *__pyx_n_s__object_;
 static PyObject *__pyx_n_s__oldIndex;
 static PyObject *__pyx_n_s__oldMap;
+static PyObject *__pyx_n_s__ones;
 static PyObject *__pyx_n_s__output;
 static PyObject *__pyx_n_s__pydatetime;
+static PyObject *__pyx_n_s__random;
 static PyObject *__pyx_n_s__range;
 static PyObject *__pyx_n_s__readonly;
+static PyObject *__pyx_n_s__remove;
 static PyObject *__pyx_n_s__rolling_var;
 static PyObject *__pyx_n_s__shape;
+static PyObject *__pyx_n_s__size;
 static PyObject *__pyx_n_s__sqrt;
 static PyObject *__pyx_n_s__strides;
 static PyObject *__pyx_n_s__suboffsets;
 static PyObject *__pyx_n_s__type;
 static PyObject *__pyx_n_s__type_num;
+static PyObject *__pyx_n_s__value;
 static PyObject *__pyx_n_s__values;
+static PyObject *__pyx_n_s__width;
+static PyObject *__pyx_n_s__width_arr;
 static PyObject *__pyx_n_s__win;
 static PyObject *__pyx_n_s__window;
 static PyObject *__pyx_n_s__zeros;
+static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_2;
 static PyObject *__pyx_int_15;
+static PyObject *__pyx_int_100;
 
-/* "H:\pandas\pandas\lib\src\common.pyx":18
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":18
  * from datetime import datetime as pydatetime
  * 
  * cdef inline object trycall(object func, object arg):             # <<<<<<<<<<<<<<
@@ -1042,7 +1138,7 @@ static INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func, PyObjec
   __Pyx_INCREF(__pyx_v_func);
   __Pyx_INCREF(__pyx_v_arg);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":19
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":19
  * 
  * cdef inline object trycall(object func, object arg):
  *     try:             # <<<<<<<<<<<<<<
@@ -1057,7 +1153,7 @@ static INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func, PyObjec
     __Pyx_XGOTREF(__pyx_save_exc_tb);
     /*try:*/ {
 
-      /* "H:\pandas\pandas\lib\src\common.pyx":20
+      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":20
  * cdef inline object trycall(object func, object arg):
  *     try:
  *         return func(arg)             # <<<<<<<<<<<<<<
@@ -1091,7 +1187,7 @@ static INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func, PyObjec
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "H:\pandas\pandas\lib\src\common.pyx":21
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":21
  *     try:
  *         return func(arg)
  *     except:             # <<<<<<<<<<<<<<
@@ -1105,7 +1201,7 @@ static INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func, PyObjec
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GOTREF(__pyx_t_3);
 
-      /* "H:\pandas\pandas\lib\src\common.pyx":22
+      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":22
  *         return func(arg)
  *     except:
  *         raise Exception('Error calling func on index %s' % arg)             # <<<<<<<<<<<<<<
@@ -1162,7 +1258,7 @@ static INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func, PyObjec
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":24
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":24
  *         raise Exception('Error calling func on index %s' % arg)
  * 
  * cdef inline int int_max(int a, int b): return a if a >= b else b             # <<<<<<<<<<<<<<
@@ -1188,7 +1284,7 @@ static INLINE int __pyx_f_7tseries_int_max(int __pyx_v_a, int __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":25
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":25
  * 
  * cdef inline int int_max(int a, int b): return a if a >= b else b
  * cdef inline int int_min(int a, int b): return a if a >= b else b             # <<<<<<<<<<<<<<
@@ -1214,7 +1310,7 @@ static INLINE int __pyx_f_7tseries_int_min(int __pyx_v_a, int __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":29
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":29
  * ctypedef unsigned char UChar
  * 
  * cdef int is_contiguous(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1226,7 +1322,7 @@ static  int __pyx_f_7tseries_is_contiguous(PyArrayObject *__pyx_v_arr) {
   int __pyx_r;
   __Pyx_RefNannySetupContext("is_contiguous");
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":30
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":30
  * 
  * cdef int is_contiguous(ndarray arr):
  *     return np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS)             # <<<<<<<<<<<<<<
@@ -1242,7 +1338,7 @@ static  int __pyx_f_7tseries_is_contiguous(PyArrayObject *__pyx_v_arr) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":32
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":32
  *     return np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS)
  * 
  * cdef int _contiguous_check(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1258,7 +1354,7 @@ static  int __pyx_f_7tseries__contiguous_check(PyArrayObject *__pyx_v_arr) {
   __Pyx_RefNannySetupContext("_contiguous_check");
   __Pyx_INCREF((PyObject *)__pyx_v_arr);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":33
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":33
  * 
  * cdef int _contiguous_check(ndarray arr):
  *     if not is_contiguous(arr):             # <<<<<<<<<<<<<<
@@ -1268,7 +1364,7 @@ static  int __pyx_f_7tseries__contiguous_check(PyArrayObject *__pyx_v_arr) {
   __pyx_t_1 = (!__pyx_f_7tseries_is_contiguous(__pyx_v_arr));
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\common.pyx":34
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":34
  * cdef int _contiguous_check(ndarray arr):
  *     if not is_contiguous(arr):
  *         raise ValueError('Tried to use data field on non-contiguous array!')             # <<<<<<<<<<<<<<
@@ -1303,7 +1399,7 @@ static  int __pyx_f_7tseries__contiguous_check(PyArrayObject *__pyx_v_arr) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":36
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":36
  *         raise ValueError('Tried to use data field on non-contiguous array!')
  * 
  * cdef int16_t *get_int16_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1315,7 +1411,7 @@ static  __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *__
   __pyx_t_5numpy_int16_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_int16_ptr");
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":37
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":37
  * 
  * cdef int16_t *get_int16_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1324,7 +1420,7 @@ static  __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *__
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":39
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":39
  *     _contiguous_check(arr)
  * 
  *     return <int16_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1340,7 +1436,7 @@ static  __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *__
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":41
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":41
  *     return <int16_t *> arr.data
  * 
  * cdef int32_t *get_int32_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1352,7 +1448,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
   __pyx_t_5numpy_int32_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_int32_ptr");
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":42
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":42
  * 
  * cdef int32_t *get_int32_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1361,7 +1457,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":44
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":44
  *     _contiguous_check(arr)
  * 
  *     return <int32_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1377,7 +1473,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":46
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":46
  *     return <int32_t *> arr.data
  * 
  * cdef int64_t *get_int64_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1389,7 +1485,7 @@ static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__
   __pyx_t_5numpy_int64_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_int64_ptr");
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":47
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":47
  * 
  * cdef int64_t *get_int64_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1398,7 +1494,7 @@ static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":49
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":49
  *     _contiguous_check(arr)
  * 
  *     return <int64_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1414,7 +1510,7 @@ static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":51
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":51
  *     return <int64_t *> arr.data
  * 
  * cdef double_t *get_double_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1426,7 +1522,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
   __pyx_t_5numpy_double_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_double_ptr");
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":52
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":52
  * 
  * cdef double_t *get_double_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1435,7 +1531,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":54
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":54
  *     _contiguous_check(arr)
  * 
  *     return <double_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1451,7 +1547,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":56
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":56
  *     return <double_t *> arr.data
  * 
  * cpdef map_indices(ndarray index):             # <<<<<<<<<<<<<<
@@ -1475,7 +1571,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_v_result = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":71
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":71
  *     cdef object idx
  * 
  *     result = {}             # <<<<<<<<<<<<<<
@@ -1488,7 +1584,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_v_result = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":73
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":73
  *     result = {}
  * 
  *     iter = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
@@ -1502,7 +1598,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_v_iter = ((PyArrayIterObject *)__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":74
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":74
  * 
  *     iter = <flatiter> PyArray_IterNew(index)
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -1511,7 +1607,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_index);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":76
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":76
  *     length = PyArray_SIZE(index)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -1521,7 +1617,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_t_2 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\common.pyx":77
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":77
  * 
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))             # <<<<<<<<<<<<<<
@@ -1534,7 +1630,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
     __pyx_v_idx = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "H:\pandas\pandas\lib\src\common.pyx":78
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":78
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  *         result[idx] = i             # <<<<<<<<<<<<<<
@@ -1546,7 +1642,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
     if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_v_idx, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "H:\pandas\pandas\lib\src\common.pyx":79
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":79
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  *         result[idx] = i
  *         PyArray_ITER_NEXT(iter)             # <<<<<<<<<<<<<<
@@ -1556,7 +1652,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
     PyArray_ITER_NEXT(__pyx_v_iter);
   }
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":81
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":81
  *         PyArray_ITER_NEXT(iter)
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -1584,7 +1680,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":56
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":56
  *     return <double_t *> arr.data
  * 
  * cpdef map_indices(ndarray index):             # <<<<<<<<<<<<<<
@@ -1619,7 +1715,7 @@ static PyObject *__pyx_pf_7tseries_map_indices(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\isnull.pyx":5
+/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":5
  * cdef double NEGINF = -INF
  * 
  * cdef inline _checknull(object val):             # <<<<<<<<<<<<<<
@@ -1637,7 +1733,7 @@ static INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val) {
   __Pyx_RefNannySetupContext("_checknull");
   __Pyx_INCREF(__pyx_v_val);
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":6
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":6
  * 
  * cdef inline _checknull(object val):
  *     if isinstance(val, float):             # <<<<<<<<<<<<<<
@@ -1647,7 +1743,7 @@ static INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val) {
   __pyx_t_1 = PyObject_TypeCheck(__pyx_v_val, ((PyTypeObject *)((PyObject*)&PyFloat_Type))); 
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\isnull.pyx":7
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":7
  * cdef inline _checknull(object val):
  *     if isinstance(val, float):
  *         return val != val or val == INF or val == NEGINF             # <<<<<<<<<<<<<<
@@ -1655,22 +1751,22 @@ static INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val) {
  *         return val is None
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = PyObject_RichCompare(__pyx_v_val, __pyx_v_val, Py_NE); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_RichCompare(__pyx_v_val, __pyx_v_val, Py_NE); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     if (!__pyx_t_1) {
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_7tseries_INF); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_7tseries_INF); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = PyObject_RichCompare(__pyx_v_val, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyObject_RichCompare(__pyx_v_val, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       if (!__pyx_t_1) {
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_3 = PyFloat_FromDouble(__pyx_v_7tseries_NEGINF); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyFloat_FromDouble(__pyx_v_7tseries_NEGINF); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_5 = PyObject_RichCompare(__pyx_v_val, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyObject_RichCompare(__pyx_v_val, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_3 = __pyx_t_5;
@@ -1692,7 +1788,7 @@ static INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val) {
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\isnull.pyx":9
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":9
  *         return val != val or val == INF or val == NEGINF
  *     else:
  *         return val is None             # <<<<<<<<<<<<<<
@@ -1701,7 +1797,7 @@ static INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val) {
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_1 = (__pyx_v_val == Py_None);
-    __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_r = __pyx_t_4;
     __pyx_t_4 = 0;
@@ -1725,7 +1821,7 @@ static INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\isnull.pyx":11
+/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":11
  *         return val is None
  * 
  * cdef ndarray _isnullobj(input):             # <<<<<<<<<<<<<<
@@ -1763,45 +1859,45 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
   __pyx_v_iter = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_result.buf = NULL;
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":17
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":17
  *     cdef flatiter iter
  * 
  *     length = PyArray_SIZE(input)             # <<<<<<<<<<<<<<
  * 
  *     result = <ndarray> np.zeros(length, dtype=np.int8)
  */
-  if (!(likely(((__pyx_v_input) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_input, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_v_input) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_input, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_length = PyArray_SIZE(((PyArrayObject *)__pyx_v_input));
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":19
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":19
  *     length = PyArray_SIZE(input)
  * 
  *     result = <ndarray> np.zeros(length, dtype=np.int8)             # <<<<<<<<<<<<<<
  * 
  *     iter= PyArray_IterNew(input)
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -1822,7 +1918,7 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
     }
     __pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
     __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
-    if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_t_6 = 0;
   __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_5)));
@@ -1830,21 +1926,21 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":21
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":21
  *     result = <ndarray> np.zeros(length, dtype=np.int8)
  * 
  *     iter= PyArray_IterNew(input)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < length:
  */
-  __pyx_t_5 = PyArray_IterNew(__pyx_v_input); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(__pyx_v_input); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_flatiter))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_flatiter))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_iter));
   __pyx_v_iter = ((PyArrayIterObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":23
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":23
  *     iter= PyArray_IterNew(input)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -1854,34 +1950,34 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
   __pyx_t_7 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\isnull.pyx":24
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":24
  * 
  *     for i from 0 <= i < length:
  *         val = PyArray_GETITEM(input, PyArray_ITER_DATA(iter))             # <<<<<<<<<<<<<<
  * 
  *         if _checknull(val):
  */
-    if (!(likely(((__pyx_v_input) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_input, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_5 = PyArray_GETITEM(((PyArrayObject *)__pyx_v_input), PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_v_input) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_input, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(((PyArrayObject *)__pyx_v_input), PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_val);
     __pyx_v_val = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\isnull.pyx":26
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":26
  *         val = PyArray_GETITEM(input, PyArray_ITER_DATA(iter))
  * 
  *         if _checknull(val):             # <<<<<<<<<<<<<<
  *             result[i] = 1
  * 
  */
-    __pyx_t_5 = __pyx_f_7tseries__checknull(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = __pyx_f_7tseries__checknull(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_11 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_11 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_11) {
 
-      /* "H:\pandas\pandas\lib\src\isnull.pyx":27
+      /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":27
  * 
  *         if _checknull(val):
  *             result[i] = 1             # <<<<<<<<<<<<<<
@@ -1896,14 +1992,14 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
       } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_result)) __pyx_t_13 = 0;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        {__pyx_filename = __pyx_f[3]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[4]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_result.buf, __pyx_t_12, __pyx_bstride_0_result) = 1;
       goto __pyx_L5;
     }
     __pyx_L5:;
 
-    /* "H:\pandas\pandas\lib\src\isnull.pyx":29
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":29
  *             result[i] = 1
  * 
  *         PyArray_ITER_NEXT(iter)             # <<<<<<<<<<<<<<
@@ -1913,7 +2009,7 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
     PyArray_ITER_NEXT(__pyx_v_iter);
   }
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":31
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":31
  *         PyArray_ITER_NEXT(iter)
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -1952,7 +2048,7 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\isnull.pyx":33
+/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":33
  *     return result
  * 
  * def isnull(input):             # <<<<<<<<<<<<<<
@@ -1984,7 +2080,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_result.buf = NULL;
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":48
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":48
  *     cdef ndarray[npy_int8, ndim=1] result
  * 
  *     if isinstance(input, np.ndarray):             # <<<<<<<<<<<<<<
@@ -1994,27 +2090,27 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_t_1 = PyObject_TypeCheck(__pyx_v_input, ((PyTypeObject *)((PyObject*)__pyx_ptype_5numpy_ndarray))); 
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\isnull.pyx":49
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":49
  * 
  *     if isinstance(input, np.ndarray):
  *         if input.dtype.kind in ('O', 'S'):             # <<<<<<<<<<<<<<
  *             result = _isnullobj(input)
  * 
  */
-    __pyx_t_2 = PyObject_GetAttr(__pyx_v_input, __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(__pyx_v_input, __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__kind); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__kind); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_n_s__O), Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_n_s__O), Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_1 == (int)-1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_1 == (int)-1))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_4 = ((int)__pyx_t_1);
     if (!__pyx_t_4) {
-      __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_n_s__S), Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_n_s__S), Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_1 == (int)-1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_1 == (int)-1))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_5 = ((int)__pyx_t_1);
       __pyx_t_1 = __pyx_t_5;
@@ -2025,14 +2121,14 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_4) {
 
-      /* "H:\pandas\pandas\lib\src\isnull.pyx":50
+      /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":50
  *     if isinstance(input, np.ndarray):
  *         if input.dtype.kind in ('O', 'S'):
  *             result = _isnullobj(input)             # <<<<<<<<<<<<<<
  * 
  *             return result.astype(np.bool)
  */
-      __pyx_t_3 = ((PyObject *)__pyx_f_7tseries__isnullobj(__pyx_v_input)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = ((PyObject *)__pyx_f_7tseries__isnullobj(__pyx_v_input)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       {
         __Pyx_BufFmt_StackElem __pyx_stack[1];
@@ -2049,13 +2145,13 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
         }
         __pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
         __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
-        if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __Pyx_DECREF(((PyObject *)__pyx_v_result));
       __pyx_v_result = ((PyArrayObject *)__pyx_t_3);
       __pyx_t_3 = 0;
 
-      /* "H:\pandas\pandas\lib\src\isnull.pyx":52
+      /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":52
  *             result = _isnullobj(input)
  * 
  *             return result.astype(np.bool)             # <<<<<<<<<<<<<<
@@ -2063,19 +2159,19 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
  *             return -np.isfinite(input)
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_result), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_result), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_10 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__bool); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__bool); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_10);
       __Pyx_GIVEREF(__pyx_t_10);
       __pyx_t_10 = 0;
-      __pyx_t_10 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
@@ -2086,7 +2182,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\isnull.pyx":54
+      /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":54
  *             return result.astype(np.bool)
  *         else:
  *             return -np.isfinite(input)             # <<<<<<<<<<<<<<
@@ -2094,21 +2190,21 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
  *         return _checknull(input)
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_10 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_2 = PyObject_GetAttr(__pyx_t_10, __pyx_n_s__isfinite); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = PyObject_GetAttr(__pyx_t_10, __pyx_n_s__isfinite); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_INCREF(__pyx_v_input);
       PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_input);
       __Pyx_GIVEREF(__pyx_v_input);
-      __pyx_t_3 = PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyNumber_Negative(__pyx_t_3); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = PyNumber_Negative(__pyx_t_3); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_r = __pyx_t_10;
@@ -2120,7 +2216,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\isnull.pyx":56
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":56
  *             return -np.isfinite(input)
  *     else:
  *         return _checknull(input)             # <<<<<<<<<<<<<<
@@ -2128,7 +2224,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
  * def notnull(input):
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_10 = __pyx_f_7tseries__checknull(__pyx_v_input); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __pyx_f_7tseries__checknull(__pyx_v_input); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_r = __pyx_t_10;
     __pyx_t_10 = 0;
@@ -2159,7 +2255,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\isnull.pyx":58
+/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":58
  *         return _checknull(input)
  * 
  * def notnull(input):             # <<<<<<<<<<<<<<
@@ -2179,7 +2275,7 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
   __pyx_self = __pyx_self;
   __Pyx_INCREF(__pyx_v_input);
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":71
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":71
  *     boolean ndarray or boolean
  *     '''
  *     if isinstance(input, np.ndarray):             # <<<<<<<<<<<<<<
@@ -2189,7 +2285,7 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
   __pyx_t_1 = PyObject_TypeCheck(__pyx_v_input, ((PyTypeObject *)((PyObject*)__pyx_ptype_5numpy_ndarray))); 
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\isnull.pyx":72
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":72
  *     '''
  *     if isinstance(input, np.ndarray):
  *         return -isnull(input)             # <<<<<<<<<<<<<<
@@ -2197,18 +2293,18 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
  *         return not bool(_checknull(input))
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__isnull); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__isnull); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_input);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_input);
     __Pyx_GIVEREF(__pyx_v_input);
-    __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Negative(__pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyNumber_Negative(__pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_r = __pyx_t_3;
@@ -2218,26 +2314,26 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\isnull.pyx":74
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":74
  *         return -isnull(input)
  *     else:
  *         return not bool(_checknull(input))             # <<<<<<<<<<<<<<
  * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __pyx_f_7tseries__checknull(__pyx_v_input); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __pyx_f_7tseries__checknull(__pyx_v_input); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)&PyBool_Type)), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)&PyBool_Type)), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyBool_FromLong((!__pyx_t_1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __Pyx_PyBool_FromLong((!__pyx_t_1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
@@ -2260,7 +2356,7 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\groupby.pyx":6
+/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":6
  * 
  * @cython.boundscheck(False)
  * def arrmap(ndarray[object, ndim=1] index, object func):             # <<<<<<<<<<<<<<
@@ -2313,11 +2409,11 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__func);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("arrmap", 1, 2, 2, 1); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("arrmap", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "arrmap") < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "arrmap") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_index = ((PyArrayObject *)values[0]);
     __pyx_v_func = values[1];
@@ -2329,7 +2425,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("arrmap", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("arrmap", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.arrmap");
   return NULL;
@@ -2338,15 +2434,15 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __Pyx_INCREF(__pyx_v_func);
   __pyx_bstruct_result.buf = NULL;
   __pyx_bstruct_index.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
   __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":7
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":7
  * @cython.boundscheck(False)
  * def arrmap(ndarray[object, ndim=1] index, object func):
  *     cdef int length = index.shape[0]             # <<<<<<<<<<<<<<
@@ -2355,7 +2451,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
  */
   __pyx_v_length = (__pyx_v_index->dimensions[0]);
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":8
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":8
  * def arrmap(ndarray[object, ndim=1] index, object func):
  *     cdef int length = index.shape[0]
  *     cdef int i = 0             # <<<<<<<<<<<<<<
@@ -2364,46 +2460,46 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
  */
   __pyx_v_i = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":10
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":10
  *     cdef int i = 0
  * 
  *     cdef ndarray[object, ndim=1] result = np.empty(length, dtype=np.object_)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < length:
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__object_); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__object_); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_result.buf = NULL;
-      {__pyx_filename = __pyx_f[4]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
       __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
     }
@@ -2412,7 +2508,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":12
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":12
  *     cdef ndarray[object, ndim=1] result = np.empty(length, dtype=np.object_)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -2422,7 +2518,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_t_7 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":13
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":13
  * 
  *     for i from 0 <= i < length:
  *         result[i] = func(index[i])             # <<<<<<<<<<<<<<
@@ -2433,12 +2529,12 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
     if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_bshape_0_index;
     __pyx_t_5 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_8, __pyx_bstride_0_index);
     __Pyx_INCREF((PyObject*)__pyx_t_5);
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_5);
     __pyx_t_5 = 0;
-    __pyx_t_5 = PyObject_Call(__pyx_v_func, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_Call(__pyx_v_func, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_9 = __pyx_v_i;
@@ -2451,7 +2547,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":15
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":15
  *         result[i] = func(index[i])
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -2491,7 +2587,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\groupby.pyx":18
+/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":18
  * 
  * @cython.boundscheck(False)
  * def groupby_withnull_old(ndarray[object, ndim = 1] index, object keyfunc):             # <<<<<<<<<<<<<<
@@ -2563,11 +2659,11 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__keyfunc);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupby_withnull_old", 1, 2, 2, 1); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("groupby_withnull_old", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby_withnull_old") < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby_withnull_old") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_index = ((PyArrayObject *)values[0]);
     __pyx_v_keyfunc = values[1];
@@ -2579,7 +2675,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("groupby_withnull_old", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("groupby_withnull_old", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.groupby_withnull_old");
   return NULL;
@@ -2596,15 +2692,15 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   __pyx_bstruct_mapped_index.buf = NULL;
   __pyx_bstruct_null_mask.buf = NULL;
   __pyx_bstruct_index.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
   __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":20
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":20
  * def groupby_withnull_old(ndarray[object, ndim = 1] index, object keyfunc):
  *     cdef dict groups
  *     cdef int length = index.shape[0]             # <<<<<<<<<<<<<<
@@ -2613,21 +2709,21 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
  */
   __pyx_v_length = (__pyx_v_index->dimensions[0]);
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":25
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":25
  *     cdef list members
  * 
  *     groups = PyDict_New()             # <<<<<<<<<<<<<<
  * 
  *     if length != index.shape[0]:
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_groups));
   __pyx_v_groups = ((PyObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":27
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":27
  *     groups = PyDict_New()
  * 
  *     if length != index.shape[0]:             # <<<<<<<<<<<<<<
@@ -2637,38 +2733,38 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   __pyx_t_2 = (__pyx_v_length != (__pyx_v_index->dimensions[0]));
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":28
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":28
  * 
  *     if length != index.shape[0]:
  *         raise Exception('Dates and values were not the same length!')             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(((PyObject *)__pyx_kp_s_3));
     PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_3));
     __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_3));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[4]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L6;
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":30
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":30
  *         raise Exception('Dates and values were not the same length!')
  * 
  *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
  */
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__arrmap); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__arrmap); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_v_index));
   PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_index));
@@ -2676,17 +2772,17 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   __Pyx_INCREF(__pyx_v_keyfunc);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_keyfunc);
   __Pyx_GIVEREF(__pyx_v_keyfunc);
-  __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_mapped_index, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_mapped_index = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_mapped_index.buf = NULL;
-      {__pyx_filename = __pyx_f[4]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_mapped_index = __pyx_bstruct_mapped_index.strides[0];
       __pyx_bshape_0_mapped_index = __pyx_bstruct_mapped_index.shape[0];
     }
@@ -2695,20 +2791,20 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   __pyx_v_mapped_index = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":32
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":32
  *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
  * 
  *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)             # <<<<<<<<<<<<<<
  * 
  *     bool_mask = null_mask.astype(bool)
  */
-  __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__isnullobj(((PyObject *)__pyx_v_mapped_index))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__isnullobj(((PyObject *)__pyx_v_mapped_index))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_null_mask, (PyObject*)((PyArrayObject *)__pyx_t_4), &__Pyx_TypeInfo_nn_npy_int8, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_null_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_null_mask.buf = NULL;
-      {__pyx_filename = __pyx_f[4]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_null_mask = __pyx_bstruct_null_mask.strides[0];
       __pyx_bshape_0_null_mask = __pyx_bstruct_null_mask.shape[0];
     }
@@ -2716,21 +2812,21 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   __pyx_v_null_mask = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":34
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":34
  *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
  * 
  *     bool_mask = null_mask.astype(bool)             # <<<<<<<<<<<<<<
  * 
  *     null_values = np.asarray(index)[bool_mask]
  */
-  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_null_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_null_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
   PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
   __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -2738,69 +2834,69 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   __pyx_v_bool_mask = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":36
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":36
  *     bool_mask = null_mask.astype(bool)
  * 
  *     null_values = np.asarray(index)[bool_mask]             # <<<<<<<<<<<<<<
  * 
  *     if null_values.any():
  */
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__asarray); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__asarray); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_index));
   PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_index));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_index));
-  __pyx_t_4 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_GetItem(__pyx_t_4, __pyx_v_bool_mask); if (!__pyx_t_3) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetItem(__pyx_t_4, __pyx_v_bool_mask); if (!__pyx_t_3) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_v_null_values);
   __pyx_v_null_values = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":38
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":38
  *     null_values = np.asarray(index)[bool_mask]
  * 
  *     if null_values.any():             # <<<<<<<<<<<<<<
  *         PyDict_SetItem(groups, np.NaN, null_values)
  * 
  */
-  __pyx_t_3 = PyObject_GetAttr(__pyx_v_null_values, __pyx_n_s__any); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_v_null_values, __pyx_n_s__any); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":39
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":39
  * 
  *     if null_values.any():
  *         PyDict_SetItem(groups, np.NaN, null_values)             # <<<<<<<<<<<<<<
  * 
  *     cdef int i = 0
  */
-    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__NaN); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__NaN); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_t_3, __pyx_v_null_values); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_t_3, __pyx_v_null_values); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L7;
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":41
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":41
  *         PyDict_SetItem(groups, np.NaN, null_values)
  * 
  *     cdef int i = 0             # <<<<<<<<<<<<<<
@@ -2809,7 +2905,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
  */
   __pyx_v_i = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":42
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":42
  * 
  *     cdef int i = 0
  *     idx = index[0]             # <<<<<<<<<<<<<<
@@ -2824,7 +2920,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   __pyx_v_idx = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":43
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":43
  *     cdef int i = 0
  *     idx = index[0]
  *     key = mapped_index[0]             # <<<<<<<<<<<<<<
@@ -2839,7 +2935,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   __pyx_v_key = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":49
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":49
  *     #   'lazily' evaluates
  * 
  *     while i < length:             # <<<<<<<<<<<<<<
@@ -2850,25 +2946,25 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
     __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
     if (!__pyx_t_2) break;
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":50
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":50
  * 
  *     while i < length:
  *         if not PyDict_Contains(groups, key):             # <<<<<<<<<<<<<<
  *             members = [idx]
  *             PyDict_SetItem(groups, key, members)
  */
-    __pyx_t_6 = PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_t_2 = (!__pyx_t_6);
     if (__pyx_t_2) {
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":51
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":51
  *     while i < length:
  *         if not PyDict_Contains(groups, key):
  *             members = [idx]             # <<<<<<<<<<<<<<
  *             PyDict_SetItem(groups, key, members)
  *             i += 1
  */
-      __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(((PyObject *)__pyx_t_3));
       __Pyx_INCREF(__pyx_v_idx);
       PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_idx);
@@ -2877,16 +2973,16 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
       __pyx_v_members = __pyx_t_3;
       __pyx_t_3 = 0;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":52
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":52
  *         if not PyDict_Contains(groups, key):
  *             members = [idx]
  *             PyDict_SetItem(groups, key, members)             # <<<<<<<<<<<<<<
  *             i += 1
  *             curKey = key
  */
-      __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":53
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":53
  *             members = [idx]
  *             PyDict_SetItem(groups, key, members)
  *             i += 1             # <<<<<<<<<<<<<<
@@ -2895,7 +2991,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
  */
       __pyx_v_i += 1;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":54
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":54
  *             PyDict_SetItem(groups, key, members)
  *             i += 1
  *             curKey = key             # <<<<<<<<<<<<<<
@@ -2906,7 +3002,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
       __Pyx_DECREF(__pyx_v_curKey);
       __pyx_v_curKey = __pyx_v_key;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":55
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":55
  *             i += 1
  *             curKey = key
  *             while i < length:             # <<<<<<<<<<<<<<
@@ -2917,7 +3013,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
         if (!__pyx_t_2) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":56
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":56
  *             curKey = key
  *             while i < length:
  *                 if null_mask[i]:             # <<<<<<<<<<<<<<
@@ -2929,7 +3025,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_6, __pyx_bstride_0_null_mask));
         if (__pyx_t_9) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":57
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":57
  *             while i < length:
  *                 if null_mask[i]:
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -2938,7 +3034,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
  */
           __pyx_v_i += 1;
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":58
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":58
  *                 if null_mask[i]:
  *                     i += 1
  *                     continue             # <<<<<<<<<<<<<<
@@ -2950,7 +3046,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         }
         __pyx_L13:;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":60
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":60
  *                     continue
  * 
  *                 idx = index[i]             # <<<<<<<<<<<<<<
@@ -2965,7 +3061,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         __pyx_v_idx = __pyx_t_3;
         __pyx_t_3 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":61
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":61
  * 
  *                 idx = index[i]
  *                 key = mapped_index[i]             # <<<<<<<<<<<<<<
@@ -2980,20 +3076,20 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         __pyx_v_key = __pyx_t_3;
         __pyx_t_3 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":62
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":62
  *                 idx = index[i]
  *                 key = mapped_index[i]
  *                 if key == curKey:             # <<<<<<<<<<<<<<
  *                     members.append(idx)
  *                     i += 1
  */
-        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (__pyx_t_2) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":63
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":63
  *                 key = mapped_index[i]
  *                 if key == curKey:
  *                     members.append(idx)             # <<<<<<<<<<<<<<
@@ -3001,11 +3097,11 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
  *                 else:
  */
           if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
           }
-          __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":64
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":64
  *                 if key == curKey:
  *                     members.append(idx)
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -3017,7 +3113,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         }
         /*else*/ {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":66
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":66
  *                     i += 1
  *                 else:
  *                     break             # <<<<<<<<<<<<<<
@@ -3034,7 +3130,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":68
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":68
  *                     break
  *         else:
  *             members = <list> PyDict_GetItem(groups, key)             # <<<<<<<<<<<<<<
@@ -3046,7 +3142,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
       __Pyx_DECREF(((PyObject *)__pyx_v_members));
       __pyx_v_members = ((PyObject *)__pyx_t_13);
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":69
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":69
  *         else:
  *             members = <list> PyDict_GetItem(groups, key)
  *             members.append(idx)             # <<<<<<<<<<<<<<
@@ -3054,11 +3150,11 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
  *             curKey = key
  */
       if (unlikely(__pyx_v_members == Py_None)) {
-        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
       }
-      __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":70
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":70
  *             members = <list> PyDict_GetItem(groups, key)
  *             members.append(idx)
  *             i += 1             # <<<<<<<<<<<<<<
@@ -3067,7 +3163,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
  */
       __pyx_v_i += 1;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":71
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":71
  *             members.append(idx)
  *             i += 1
  *             curKey = key             # <<<<<<<<<<<<<<
@@ -3078,7 +3174,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
       __Pyx_DECREF(__pyx_v_curKey);
       __pyx_v_curKey = __pyx_v_key;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":72
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":72
  *             i += 1
  *             curKey = key
  *             while null_mask[i] and i < length:             # <<<<<<<<<<<<<<
@@ -3097,7 +3193,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         }
         if (!__pyx_t_14) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":73
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":73
  *             curKey = key
  *             while null_mask[i] and i < length:
  *                 i += 1             # <<<<<<<<<<<<<<
@@ -3107,7 +3203,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         __pyx_v_i += 1;
       }
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":75
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":75
  *                 i += 1
  * 
  *             while i < length:             # <<<<<<<<<<<<<<
@@ -3118,7 +3214,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         __pyx_t_14 = (__pyx_v_i < __pyx_v_length);
         if (!__pyx_t_14) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":76
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":76
  * 
  *             while i < length:
  *                 if null_mask[i]:             # <<<<<<<<<<<<<<
@@ -3130,7 +3226,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_15, __pyx_bstride_0_null_mask));
         if (__pyx_t_9) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":77
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":77
  *             while i < length:
  *                 if null_mask[i]:
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -3139,7 +3235,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
  */
           __pyx_v_i += 1;
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":78
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":78
  *                 if null_mask[i]:
  *                     i += 1
  *                     continue             # <<<<<<<<<<<<<<
@@ -3151,7 +3247,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         }
         __pyx_L19:;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":80
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":80
  *                     continue
  * 
  *                 idx = index[i]             # <<<<<<<<<<<<<<
@@ -3166,7 +3262,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         __pyx_v_idx = __pyx_t_3;
         __pyx_t_3 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":81
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":81
  * 
  *                 idx = index[i]
  *                 key = mapped_index[i]             # <<<<<<<<<<<<<<
@@ -3181,20 +3277,20 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         __pyx_v_key = __pyx_t_3;
         __pyx_t_3 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":82
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":82
  *                 idx = index[i]
  *                 key = mapped_index[i]
  *                 if key == curKey:             # <<<<<<<<<<<<<<
  *                     members.append(idx)
  *                     i += 1
  */
-        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_14 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_14 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (__pyx_t_14) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":83
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":83
  *                 key = mapped_index[i]
  *                 if key == curKey:
  *                     members.append(idx)             # <<<<<<<<<<<<<<
@@ -3202,11 +3298,11 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
  *                 else:
  */
           if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
           }
-          __pyx_t_18 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_18 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":84
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":84
  *                 if key == curKey:
  *                     members.append(idx)
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -3218,7 +3314,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
         }
         /*else*/ {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":86
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":86
  *                     i += 1
  *                 else:
  *                     break             # <<<<<<<<<<<<<<
@@ -3235,7 +3331,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
     __pyx_L10:;
   }
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":88
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":88
  *                     break
  * 
  *     return groups             # <<<<<<<<<<<<<<
@@ -3283,7 +3379,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\groupby.pyx":91
+/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":91
  * 
  * @cython.boundscheck(False)
  * def groupby_withnull(ndarray[object, ndim = 1] index, object keyfunc):             # <<<<<<<<<<<<<<
@@ -3354,11 +3450,11 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__keyfunc);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupby_withnull", 1, 2, 2, 1); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("groupby_withnull", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby_withnull") < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby_withnull") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_index = ((PyArrayObject *)values[0]);
     __pyx_v_keyfunc = values[1];
@@ -3370,7 +3466,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("groupby_withnull", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("groupby_withnull", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.groupby_withnull");
   return NULL;
@@ -3387,15 +3483,15 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   __pyx_bstruct_mapped_index.buf = NULL;
   __pyx_bstruct_null_mask.buf = NULL;
   __pyx_bstruct_index.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
   __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":93
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":93
  * def groupby_withnull(ndarray[object, ndim = 1] index, object keyfunc):
  *     cdef dict groups
  *     cdef int length = index.shape[0]             # <<<<<<<<<<<<<<
@@ -3404,21 +3500,21 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  */
   __pyx_v_length = (__pyx_v_index->dimensions[0]);
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":98
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":98
  *     cdef list members
  * 
  *     groups = PyDict_New()             # <<<<<<<<<<<<<<
  * 
  *     if length != index.shape[0]:
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_groups));
   __pyx_v_groups = ((PyObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":100
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":100
  *     groups = PyDict_New()
  * 
  *     if length != index.shape[0]:             # <<<<<<<<<<<<<<
@@ -3428,38 +3524,38 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   __pyx_t_2 = (__pyx_v_length != (__pyx_v_index->dimensions[0]));
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":101
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":101
  * 
  *     if length != index.shape[0]:
  *         raise Exception('Dates and values were not the same length!')             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(((PyObject *)__pyx_kp_s_3));
     PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_3));
     __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_3));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[4]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L6;
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":103
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":103
  *         raise Exception('Dates and values were not the same length!')
  * 
  *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
  */
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__arrmap); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__arrmap); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_v_index));
   PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_index));
@@ -3467,17 +3563,17 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   __Pyx_INCREF(__pyx_v_keyfunc);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_keyfunc);
   __Pyx_GIVEREF(__pyx_v_keyfunc);
-  __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_mapped_index, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_mapped_index = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_mapped_index.buf = NULL;
-      {__pyx_filename = __pyx_f[4]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_mapped_index = __pyx_bstruct_mapped_index.strides[0];
       __pyx_bshape_0_mapped_index = __pyx_bstruct_mapped_index.shape[0];
     }
@@ -3486,20 +3582,20 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   __pyx_v_mapped_index = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":105
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":105
  *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
  * 
  *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)             # <<<<<<<<<<<<<<
  * 
  *     bool_mask = null_mask.astype(bool)
  */
-  __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__isnullobj(((PyObject *)__pyx_v_mapped_index))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__isnullobj(((PyObject *)__pyx_v_mapped_index))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_null_mask, (PyObject*)((PyArrayObject *)__pyx_t_4), &__Pyx_TypeInfo_nn_npy_int8, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_null_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_null_mask.buf = NULL;
-      {__pyx_filename = __pyx_f[4]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_null_mask = __pyx_bstruct_null_mask.strides[0];
       __pyx_bshape_0_null_mask = __pyx_bstruct_null_mask.shape[0];
     }
@@ -3507,21 +3603,21 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   __pyx_v_null_mask = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":107
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":107
  *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
  * 
  *     bool_mask = null_mask.astype(bool)             # <<<<<<<<<<<<<<
  * 
  *     null_values = np.asarray(index)[bool_mask]
  */
-  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_null_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_null_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
   PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
   __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -3529,69 +3625,69 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   __pyx_v_bool_mask = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":109
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":109
  *     bool_mask = null_mask.astype(bool)
  * 
  *     null_values = np.asarray(index)[bool_mask]             # <<<<<<<<<<<<<<
  * 
  *     if null_values.any():
  */
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__asarray); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__asarray); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_index));
   PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_index));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_index));
-  __pyx_t_4 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_GetItem(__pyx_t_4, __pyx_v_bool_mask); if (!__pyx_t_3) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetItem(__pyx_t_4, __pyx_v_bool_mask); if (!__pyx_t_3) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_v_null_values);
   __pyx_v_null_values = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":111
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":111
  *     null_values = np.asarray(index)[bool_mask]
  * 
  *     if null_values.any():             # <<<<<<<<<<<<<<
  *         PyDict_SetItem(groups, np.NaN, null_values)
  * 
  */
-  __pyx_t_3 = PyObject_GetAttr(__pyx_v_null_values, __pyx_n_s__any); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_v_null_values, __pyx_n_s__any); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":112
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":112
  * 
  *     if null_values.any():
  *         PyDict_SetItem(groups, np.NaN, null_values)             # <<<<<<<<<<<<<<
  * 
  *     cdef int i = 0
  */
-    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__NaN); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__NaN); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_t_3, __pyx_v_null_values); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_t_3, __pyx_v_null_values); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L7;
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":114
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":114
  *         PyDict_SetItem(groups, np.NaN, null_values)
  * 
  *     cdef int i = 0             # <<<<<<<<<<<<<<
@@ -3600,7 +3696,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  */
   __pyx_v_i = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":115
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":115
  * 
  *     cdef int i = 0
  *     idx = index[0]             # <<<<<<<<<<<<<<
@@ -3615,7 +3711,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   __pyx_v_idx = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":116
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":116
  *     cdef int i = 0
  *     idx = index[0]
  *     key = mapped_index[0]             # <<<<<<<<<<<<<<
@@ -3630,7 +3726,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   __pyx_v_key = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":122
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":122
  *     #   'lazily' evaluates
  * 
  *     while i < length:             # <<<<<<<<<<<<<<
@@ -3641,7 +3737,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
     __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
     if (!__pyx_t_2) break;
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":123
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":123
  * 
  *     while i < length:
  *         if key not in groups:             # <<<<<<<<<<<<<<
@@ -3649,20 +3745,20 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  *             groups[key] = members
  */
     if (unlikely(((PyObject *)__pyx_v_groups) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_2 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key))); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key))); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     if (__pyx_t_2) {
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":124
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":124
  *     while i < length:
  *         if key not in groups:
  *             members = [idx]             # <<<<<<<<<<<<<<
  *             groups[key] = members
  *             i += 1
  */
-      __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(((PyObject *)__pyx_t_3));
       __Pyx_INCREF(__pyx_v_idx);
       PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_idx);
@@ -3671,16 +3767,16 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
       __pyx_v_members = __pyx_t_3;
       __pyx_t_3 = 0;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":125
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":125
  *         if key not in groups:
  *             members = [idx]
  *             groups[key] = members             # <<<<<<<<<<<<<<
  *             i += 1
  *             curKey = key
  */
-      if (PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      if (PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":126
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":126
  *             members = [idx]
  *             groups[key] = members
  *             i += 1             # <<<<<<<<<<<<<<
@@ -3689,7 +3785,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  */
       __pyx_v_i += 1;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":127
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":127
  *             groups[key] = members
  *             i += 1
  *             curKey = key             # <<<<<<<<<<<<<<
@@ -3700,7 +3796,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
       __Pyx_DECREF(__pyx_v_curKey);
       __pyx_v_curKey = __pyx_v_key;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":128
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":128
  *             i += 1
  *             curKey = key
  *             while i < length:             # <<<<<<<<<<<<<<
@@ -3711,7 +3807,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
         if (!__pyx_t_2) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":129
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":129
  *             curKey = key
  *             while i < length:
  *                 if null_mask[i]:             # <<<<<<<<<<<<<<
@@ -3723,7 +3819,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_6, __pyx_bstride_0_null_mask));
         if (__pyx_t_9) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":130
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":130
  *             while i < length:
  *                 if null_mask[i]:
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -3732,7 +3828,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  */
           __pyx_v_i += 1;
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":131
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":131
  *                 if null_mask[i]:
  *                     i += 1
  *                     continue             # <<<<<<<<<<<<<<
@@ -3744,7 +3840,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         }
         __pyx_L13:;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":133
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":133
  *                     continue
  * 
  *                 idx = index[i]             # <<<<<<<<<<<<<<
@@ -3759,7 +3855,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         __pyx_v_idx = __pyx_t_3;
         __pyx_t_3 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":134
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":134
  * 
  *                 idx = index[i]
  *                 key = mapped_index[i]             # <<<<<<<<<<<<<<
@@ -3774,20 +3870,20 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         __pyx_v_key = __pyx_t_3;
         __pyx_t_3 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":135
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":135
  *                 idx = index[i]
  *                 key = mapped_index[i]
  *                 if key == curKey:             # <<<<<<<<<<<<<<
  *                     members.append(idx)
  *                     i += 1
  */
-        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (__pyx_t_2) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":136
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":136
  *                 key = mapped_index[i]
  *                 if key == curKey:
  *                     members.append(idx)             # <<<<<<<<<<<<<<
@@ -3795,11 +3891,11 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  *                 else:
  */
           if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
           }
-          __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":137
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":137
  *                 if key == curKey:
  *                     members.append(idx)
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -3811,7 +3907,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         }
         /*else*/ {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":139
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":139
  *                     i += 1
  *                 else:
  *                     break             # <<<<<<<<<<<<<<
@@ -3828,21 +3924,21 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":141
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":141
  *                     break
  *         else:
  *             members = <list> groups[key]             # <<<<<<<<<<<<<<
  *             members.append(idx)
  *             i += 1
  */
-      __pyx_t_3 = PyObject_GetItem(((PyObject *)__pyx_v_groups), __pyx_v_key); if (!__pyx_t_3) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_GetItem(((PyObject *)__pyx_v_groups), __pyx_v_key); if (!__pyx_t_3) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(((PyObject *)((PyObject *)__pyx_t_3)));
       __Pyx_DECREF(((PyObject *)__pyx_v_members));
       __pyx_v_members = ((PyObject *)__pyx_t_3);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":142
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":142
  *         else:
  *             members = <list> groups[key]
  *             members.append(idx)             # <<<<<<<<<<<<<<
@@ -3850,11 +3946,11 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  *             curKey = key
  */
       if (unlikely(__pyx_v_members == Py_None)) {
-        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
       }
-      __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":143
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":143
  *             members = <list> groups[key]
  *             members.append(idx)
  *             i += 1             # <<<<<<<<<<<<<<
@@ -3863,7 +3959,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  */
       __pyx_v_i += 1;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":144
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":144
  *             members.append(idx)
  *             i += 1
  *             curKey = key             # <<<<<<<<<<<<<<
@@ -3874,7 +3970,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
       __Pyx_DECREF(__pyx_v_curKey);
       __pyx_v_curKey = __pyx_v_key;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":145
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":145
  *             i += 1
  *             curKey = key
  *             while null_mask[i] and i < length:             # <<<<<<<<<<<<<<
@@ -3893,7 +3989,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         }
         if (!__pyx_t_13) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":146
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":146
  *             curKey = key
  *             while null_mask[i] and i < length:
  *                 i += 1             # <<<<<<<<<<<<<<
@@ -3903,7 +3999,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         __pyx_v_i += 1;
       }
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":148
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":148
  *                 i += 1
  * 
  *             while i < length:             # <<<<<<<<<<<<<<
@@ -3914,7 +4010,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         __pyx_t_13 = (__pyx_v_i < __pyx_v_length);
         if (!__pyx_t_13) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":149
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":149
  * 
  *             while i < length:
  *                 if null_mask[i]:             # <<<<<<<<<<<<<<
@@ -3926,7 +4022,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_14, __pyx_bstride_0_null_mask));
         if (__pyx_t_9) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":150
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":150
  *             while i < length:
  *                 if null_mask[i]:
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -3935,7 +4031,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  */
           __pyx_v_i += 1;
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":151
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":151
  *                 if null_mask[i]:
  *                     i += 1
  *                     continue             # <<<<<<<<<<<<<<
@@ -3947,7 +4043,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         }
         __pyx_L19:;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":153
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":153
  *                     continue
  * 
  *                 idx = index[i]             # <<<<<<<<<<<<<<
@@ -3962,7 +4058,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         __pyx_v_idx = __pyx_t_3;
         __pyx_t_3 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":154
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":154
  * 
  *                 idx = index[i]
  *                 key = mapped_index[i]             # <<<<<<<<<<<<<<
@@ -3977,20 +4073,20 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         __pyx_v_key = __pyx_t_3;
         __pyx_t_3 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":155
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":155
  *                 idx = index[i]
  *                 key = mapped_index[i]
  *                 if key == curKey:             # <<<<<<<<<<<<<<
  *                     members.append(idx)
  *                     i += 1
  */
-        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_13 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_13 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (__pyx_t_13) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":156
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":156
  *                 key = mapped_index[i]
  *                 if key == curKey:
  *                     members.append(idx)             # <<<<<<<<<<<<<<
@@ -3998,11 +4094,11 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
  *                 else:
  */
           if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
           }
-          __pyx_t_17 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_17 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":157
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":157
  *                 if key == curKey:
  *                     members.append(idx)
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -4014,7 +4110,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
         }
         /*else*/ {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":159
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":159
  *                     i += 1
  *                 else:
  *                     break             # <<<<<<<<<<<<<<
@@ -4031,7 +4127,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
     __pyx_L10:;
   }
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":161
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":161
  *                     break
  * 
  *     return groups             # <<<<<<<<<<<<<<
@@ -4079,7 +4175,7 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\groupby.pyx":164
+/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":164
  * 
  * @cython.boundscheck(False)
  * def groupby(ndarray[object, ndim = 1] index, object keyfunc):             # <<<<<<<<<<<<<<
@@ -4131,11 +4227,11 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__keyfunc);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupby", 1, 2, 2, 1); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("groupby", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby") < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_index = ((PyArrayObject *)values[0]);
     __pyx_v_keyfunc = values[1];
@@ -4147,7 +4243,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("groupby", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("groupby", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.groupby");
   return NULL;
@@ -4160,15 +4256,15 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_v_key = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_members = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_index.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
   __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":166
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":166
  * def groupby(ndarray[object, ndim = 1] index, object keyfunc):
  *     cdef dict groups
  *     cdef int length = index.shape[0]             # <<<<<<<<<<<<<<
@@ -4177,21 +4273,21 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
  */
   __pyx_v_length = (__pyx_v_index->dimensions[0]);
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":171
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":171
  *     cdef list members
  * 
  *     groups = PyDict_New()             # <<<<<<<<<<<<<<
  * 
  *     if length != index.shape[0]:
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_groups));
   __pyx_v_groups = ((PyObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":173
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":173
  *     groups = PyDict_New()
  * 
  *     if length != index.shape[0]:             # <<<<<<<<<<<<<<
@@ -4201,29 +4297,29 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_t_2 = (__pyx_v_length != (__pyx_v_index->dimensions[0]));
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":174
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":174
  * 
  *     if length != index.shape[0]:
  *         raise Exception('Dates and values were not the same length!')             # <<<<<<<<<<<<<<
  * 
  *     cdef int i = 0
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(((PyObject *)__pyx_kp_s_3));
     PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_3));
     __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_3));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[4]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L6;
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":176
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":176
  *         raise Exception('Dates and values were not the same length!')
  * 
  *     cdef int i = 0             # <<<<<<<<<<<<<<
@@ -4232,7 +4328,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
  */
   __pyx_v_i = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":177
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":177
  * 
  *     cdef int i = 0
  *     idx = index[i]             # <<<<<<<<<<<<<<
@@ -4247,26 +4343,26 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   __pyx_v_idx = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":178
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":178
  *     cdef int i = 0
  *     idx = index[i]
  *     key = keyfunc(idx)             # <<<<<<<<<<<<<<
  * 
  *     # Algorithm notes
  */
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_idx);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_idx);
   __Pyx_GIVEREF(__pyx_v_idx);
-  __pyx_t_1 = PyObject_Call(__pyx_v_keyfunc, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Call(__pyx_v_keyfunc, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_v_key);
   __pyx_v_key = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":183
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":183
  *     #   - Tries to reduce the number of calls to PyDict_GetItem, 'lazily' evaluates
  * 
  *     while i < length:             # <<<<<<<<<<<<<<
@@ -4277,25 +4373,25 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
     if (!__pyx_t_2) break;
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":184
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":184
  * 
  *     while i < length:
  *         if not PyDict_Contains(groups, key):             # <<<<<<<<<<<<<<
  *             members = [idx]
  *             PyDict_SetItem(groups, key, members)
  */
-    __pyx_t_5 = PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key); if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key); if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_t_2 = (!__pyx_t_5);
     if (__pyx_t_2) {
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":185
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":185
  *     while i < length:
  *         if not PyDict_Contains(groups, key):
  *             members = [idx]             # <<<<<<<<<<<<<<
  *             PyDict_SetItem(groups, key, members)
  *             i += 1
  */
-      __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(((PyObject *)__pyx_t_1));
       __Pyx_INCREF(__pyx_v_idx);
       PyList_SET_ITEM(__pyx_t_1, 0, __pyx_v_idx);
@@ -4304,16 +4400,16 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
       __pyx_v_members = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":186
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":186
  *         if not PyDict_Contains(groups, key):
  *             members = [idx]
  *             PyDict_SetItem(groups, key, members)             # <<<<<<<<<<<<<<
  *             i += 1
  *             curKey = key
  */
-      __pyx_t_5 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)); if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)); if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":187
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":187
  *             members = [idx]
  *             PyDict_SetItem(groups, key, members)
  *             i += 1             # <<<<<<<<<<<<<<
@@ -4322,7 +4418,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
  */
       __pyx_v_i += 1;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":188
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":188
  *             PyDict_SetItem(groups, key, members)
  *             i += 1
  *             curKey = key             # <<<<<<<<<<<<<<
@@ -4333,7 +4429,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
       __Pyx_DECREF(__pyx_v_curKey);
       __pyx_v_curKey = __pyx_v_key;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":189
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":189
  *             i += 1
  *             curKey = key
  *             while i < length:             # <<<<<<<<<<<<<<
@@ -4344,7 +4440,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
         __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
         if (!__pyx_t_2) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":190
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":190
  *             curKey = key
  *             while i < length:
  *                 idx = index[i]             # <<<<<<<<<<<<<<
@@ -4359,33 +4455,33 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
         __pyx_v_idx = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":191
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":191
  *             while i < length:
  *                 idx = index[i]
  *                 key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
  *                 if key == curKey:
  *                     members.append(idx)
  */
-        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_v_key);
         __pyx_v_key = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":192
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":192
  *                 idx = index[i]
  *                 key = trycall(keyfunc, idx)
  *                 if key == curKey:             # <<<<<<<<<<<<<<
  *                     members.append(idx)
  *                     i += 1
  */
-        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         if (__pyx_t_2) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":193
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":193
  *                 key = trycall(keyfunc, idx)
  *                 if key == curKey:
  *                     members.append(idx)             # <<<<<<<<<<<<<<
@@ -4393,11 +4489,11 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
  *                 else:
  */
           if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
           }
-          __pyx_t_6 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_6 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":194
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":194
  *                 if key == curKey:
  *                     members.append(idx)
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -4409,7 +4505,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
         }
         /*else*/ {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":196
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":196
  *                     i += 1
  *                 else:
  *                     break             # <<<<<<<<<<<<<<
@@ -4425,7 +4521,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":198
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":198
  *                     break
  *         else:
  *             members = <list> PyDict_GetItem(groups, key)             # <<<<<<<<<<<<<<
@@ -4437,7 +4533,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
       __Pyx_DECREF(((PyObject *)__pyx_v_members));
       __pyx_v_members = ((PyObject *)__pyx_t_7);
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":199
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":199
  *         else:
  *             members = <list> PyDict_GetItem(groups, key)
  *             members.append(idx)             # <<<<<<<<<<<<<<
@@ -4445,11 +4541,11 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
  *             curKey = key
  */
       if (unlikely(__pyx_v_members == Py_None)) {
-        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
       }
-      __pyx_t_6 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":200
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":200
  *             members = <list> PyDict_GetItem(groups, key)
  *             members.append(idx)
  *             i += 1             # <<<<<<<<<<<<<<
@@ -4458,7 +4554,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
  */
       __pyx_v_i += 1;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":201
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":201
  *             members.append(idx)
  *             i += 1
  *             curKey = key             # <<<<<<<<<<<<<<
@@ -4469,7 +4565,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
       __Pyx_DECREF(__pyx_v_curKey);
       __pyx_v_curKey = __pyx_v_key;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":202
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":202
  *             i += 1
  *             curKey = key
  *             while i < length:             # <<<<<<<<<<<<<<
@@ -4480,7 +4576,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
         __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
         if (!__pyx_t_2) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":203
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":203
  *             curKey = key
  *             while i < length:
  *                 idx = index[i]             # <<<<<<<<<<<<<<
@@ -4495,33 +4591,33 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
         __pyx_v_idx = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":204
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":204
  *             while i < length:
  *                 idx = index[i]
  *                 key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
  *                 if key == curKey:
  *                     members.append(idx)
  */
-        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_v_key);
         __pyx_v_key = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":205
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":205
  *                 idx = index[i]
  *                 key = trycall(keyfunc, idx)
  *                 if key == curKey:             # <<<<<<<<<<<<<<
  *                     members.append(idx)
  *                     i += 1
  */
-        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         if (__pyx_t_2) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":206
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":206
  *                 key = trycall(keyfunc, idx)
  *                 if key == curKey:
  *                     members.append(idx)             # <<<<<<<<<<<<<<
@@ -4529,11 +4625,11 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
  *                 else:
  */
           if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
           }
-          __pyx_t_8 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_8 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":207
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":207
  *                 if key == curKey:
  *                     members.append(idx)
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -4545,7 +4641,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
         }
         /*else*/ {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":209
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":209
  *                     i += 1
  *                 else:
  *                     break             # <<<<<<<<<<<<<<
@@ -4561,7 +4657,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
     __pyx_L9:;
   }
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":211
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":211
  *                     break
  * 
  *     return groups             # <<<<<<<<<<<<<<
@@ -4600,7 +4696,7 @@ static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\groupby.pyx":214
+/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":214
  * 
  * @cython.boundscheck(False)
  * def groupbyfunc(ndarray[object, ndim = 1] index,             # <<<<<<<<<<<<<<
@@ -4668,23 +4764,23 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__values);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, 1); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__keyfunc);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, 2); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__applyfunc);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, 3); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, 3); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupbyfunc") < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupbyfunc") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_index = ((PyArrayObject *)values[0]);
     __pyx_v_values = ((PyArrayObject *)values[1]);
@@ -4700,7 +4796,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.groupbyfunc");
   return NULL;
@@ -4717,22 +4813,22 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
   __pyx_v_grouplist = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_index.buf = NULL;
   __pyx_bstruct_values.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
   __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_values, (PyObject*)__pyx_v_values, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_values, (PyObject*)__pyx_v_values, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_values = __pyx_bstruct_values.strides[0];
   __pyx_bshape_0_values = __pyx_bstruct_values.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":222
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":222
  *     '''
  *     cdef dict groups
  *     cdef int length = values.shape[0]             # <<<<<<<<<<<<<<
@@ -4741,21 +4837,21 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
  */
   __pyx_v_length = (__pyx_v_values->dimensions[0]);
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":227
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":227
  *     cdef list members, grouplist
  * 
  *     groups = PyDict_New()             # <<<<<<<<<<<<<<
  * 
  *     if length != index.shape[0]:
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_groups));
   __pyx_v_groups = ((PyObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":229
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":229
  *     groups = PyDict_New()
  * 
  *     if length != index.shape[0]:             # <<<<<<<<<<<<<<
@@ -4765,29 +4861,29 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
   __pyx_t_2 = (__pyx_v_length != (__pyx_v_index->dimensions[0]));
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":230
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":230
  * 
  *     if length != index.shape[0]:
  *         raise Exception('Dates and values were not the same length!')             # <<<<<<<<<<<<<<
  * 
  *     cdef int i = 0
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(((PyObject *)__pyx_kp_s_3));
     PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_3));
     __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_3));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[4]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L6;
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":232
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":232
  *         raise Exception('Dates and values were not the same length!')
  * 
  *     cdef int i = 0             # <<<<<<<<<<<<<<
@@ -4796,7 +4892,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
  */
   __pyx_v_i = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":233
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":233
  * 
  *     cdef int i = 0
  *     idx = index[i]             # <<<<<<<<<<<<<<
@@ -4811,20 +4907,20 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
   __pyx_v_idx = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":234
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":234
  *     cdef int i = 0
  *     idx = index[i]
  *     key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
  * 
  *     # Algorithm notes
  */
-  __pyx_t_3 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_v_key);
   __pyx_v_key = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":240
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":240
  *     #   'lazily' evaluates
  * 
  *     while i < length:             # <<<<<<<<<<<<<<
@@ -4835,18 +4931,18 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
     __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
     if (!__pyx_t_2) break;
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":241
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":241
  * 
  *     while i < length:
  *         if not PyDict_Contains(groups, key):             # <<<<<<<<<<<<<<
  *             members = [values[i]]
  *             PyDict_SetItem(groups, key, members)
  */
-    __pyx_t_5 = PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key); if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key); if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_t_2 = (!__pyx_t_5);
     if (__pyx_t_2) {
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":242
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":242
  *     while i < length:
  *         if not PyDict_Contains(groups, key):
  *             members = [values[i]]             # <<<<<<<<<<<<<<
@@ -4855,9 +4951,9 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
  */
       __pyx_t_5 = __pyx_v_i;
       if (__pyx_t_5 < 0) __pyx_t_5 += __pyx_bshape_0_values;
-      __pyx_t_3 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_5, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_5, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(((PyObject *)__pyx_t_1));
       PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_3);
@@ -4866,16 +4962,16 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
       __pyx_v_members = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":243
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":243
  *         if not PyDict_Contains(groups, key):
  *             members = [values[i]]
  *             PyDict_SetItem(groups, key, members)             # <<<<<<<<<<<<<<
  *             i += 1
  *             curKey = key
  */
-      __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":244
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":244
  *             members = [values[i]]
  *             PyDict_SetItem(groups, key, members)
  *             i += 1             # <<<<<<<<<<<<<<
@@ -4884,7 +4980,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
  */
       __pyx_v_i += 1;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":245
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":245
  *             PyDict_SetItem(groups, key, members)
  *             i += 1
  *             curKey = key             # <<<<<<<<<<<<<<
@@ -4895,7 +4991,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
       __Pyx_DECREF(__pyx_v_curKey);
       __pyx_v_curKey = __pyx_v_key;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":246
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":246
  *             i += 1
  *             curKey = key
  *             while i < length:             # <<<<<<<<<<<<<<
@@ -4906,7 +5002,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
         __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
         if (!__pyx_t_2) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":247
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":247
  *             curKey = key
  *             while i < length:
  *                 idx = index[i]             # <<<<<<<<<<<<<<
@@ -4921,33 +5017,33 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
         __pyx_v_idx = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":248
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":248
  *             while i < length:
  *                 idx = index[i]
  *                 key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
  *                 if key == curKey:
  *                     members.append(values[i])
  */
-        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_v_key);
         __pyx_v_key = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":249
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":249
  *                 idx = index[i]
  *                 key = trycall(keyfunc, idx)
  *                 if key == curKey:             # <<<<<<<<<<<<<<
  *                     members.append(values[i])
  *                     i += 1
  */
-        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         if (__pyx_t_2) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":250
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":250
  *                 key = trycall(keyfunc, idx)
  *                 if key == curKey:
  *                     members.append(values[i])             # <<<<<<<<<<<<<<
@@ -4955,16 +5051,16 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
  *                 else:
  */
           if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
           }
           __pyx_t_7 = __pyx_v_i;
           if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_bshape_0_values;
-          __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_7, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_7, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_8 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_t_1); if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_8 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_t_1); if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":251
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":251
  *                 if key == curKey:
  *                     members.append(values[i])
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -4976,7 +5072,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
         }
         /*else*/ {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":253
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":253
  *                     i += 1
  *                 else:
  *                     break             # <<<<<<<<<<<<<<
@@ -4992,7 +5088,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":255
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":255
  *                     break
  *         else:
  *             members = <list> PyDict_GetItem(groups, key)             # <<<<<<<<<<<<<<
@@ -5004,7 +5100,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
       __Pyx_DECREF(((PyObject *)__pyx_v_members));
       __pyx_v_members = ((PyObject *)__pyx_t_9);
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":256
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":256
  *         else:
  *             members = <list> PyDict_GetItem(groups, key)
  *             members.append(values[i])             # <<<<<<<<<<<<<<
@@ -5012,16 +5108,16 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
  *             curKey = key
  */
       if (unlikely(__pyx_v_members == Py_None)) {
-        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
       }
       __pyx_t_8 = __pyx_v_i;
       if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_bshape_0_values;
-      __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_8, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_8, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_10 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_t_1); if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_t_1); if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":257
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":257
  *             members = <list> PyDict_GetItem(groups, key)
  *             members.append(values[i])
  *             i += 1             # <<<<<<<<<<<<<<
@@ -5030,7 +5126,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
  */
       __pyx_v_i += 1;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":258
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":258
  *             members.append(values[i])
  *             i += 1
  *             curKey = key             # <<<<<<<<<<<<<<
@@ -5041,7 +5137,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
       __Pyx_DECREF(__pyx_v_curKey);
       __pyx_v_curKey = __pyx_v_key;
 
-      /* "H:\pandas\pandas\lib\src\groupby.pyx":259
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":259
  *             i += 1
  *             curKey = key
  *             while i < length:             # <<<<<<<<<<<<<<
@@ -5052,7 +5148,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
         __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
         if (!__pyx_t_2) break;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":260
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":260
  *             curKey = key
  *             while i < length:
  *                 idx = index[i]             # <<<<<<<<<<<<<<
@@ -5067,33 +5163,33 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
         __pyx_v_idx = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":261
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":261
  *             while i < length:
  *                 idx = index[i]
  *                 key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
  *                 if key == curKey:
  *                     members.append(values[i])
  */
-        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_v_key);
         __pyx_v_key = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "H:\pandas\pandas\lib\src\groupby.pyx":262
+        /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":262
  *                 idx = index[i]
  *                 key = trycall(keyfunc, idx)
  *                 if key == curKey:             # <<<<<<<<<<<<<<
  *                     members.append(values[i])
  *                     i += 1
  */
-        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         if (__pyx_t_2) {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":263
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":263
  *                 key = trycall(keyfunc, idx)
  *                 if key == curKey:
  *                     members.append(values[i])             # <<<<<<<<<<<<<<
@@ -5101,16 +5197,16 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
  *                 else:
  */
           if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
           }
           __pyx_t_11 = __pyx_v_i;
           if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_bshape_0_values;
-          __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_11, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_11, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_t_1); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_t_1); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":264
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":264
  *                 if key == curKey:
  *                     members.append(values[i])
  *                     i += 1             # <<<<<<<<<<<<<<
@@ -5122,7 +5218,7 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
         }
         /*else*/ {
 
-          /* "H:\pandas\pandas\lib\src\groupby.pyx":266
+          /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":266
  *                     i += 1
  *                 else:
  *                     break             # <<<<<<<<<<<<<<
@@ -5138,21 +5234,21 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
     __pyx_L9:;
   }
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":268
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":268
  *                     break
  * 
  *     grouplist = PyDict_Keys(groups)             # <<<<<<<<<<<<<<
  * 
  *     i = 0
  */
-  __pyx_t_1 = PyDict_Keys(((PyObject *)__pyx_v_groups)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_Keys(((PyObject *)__pyx_v_groups)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyList_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected list, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyList_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected list, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_grouplist));
   __pyx_v_grouplist = ((PyObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":270
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":270
  *     grouplist = PyDict_Keys(groups)
  * 
  *     i = 0             # <<<<<<<<<<<<<<
@@ -5161,17 +5257,17 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
  */
   __pyx_v_i = 0;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":271
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":271
  * 
  *     i = 0
  *     length = len(grouplist)             # <<<<<<<<<<<<<<
  *     for i from 0 <= i < length:
  *         key = grouplist[i]
  */
-  __pyx_t_13 = PyObject_Length(((PyObject *)__pyx_v_grouplist)); if (unlikely(__pyx_t_13 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_13 = PyObject_Length(((PyObject *)__pyx_v_grouplist)); if (unlikely(__pyx_t_13 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_length = __pyx_t_13;
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":272
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":272
  *     i = 0
  *     length = len(grouplist)
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -5181,20 +5277,20 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
   __pyx_t_12 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_12; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":273
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":273
  *     length = len(grouplist)
  *     for i from 0 <= i < length:
  *         key = grouplist[i]             # <<<<<<<<<<<<<<
  *         members = <list> PyDict_GetItem(groups, key)
  *         PyDict_SetItem(groups, key, applyfunc(np.asarray(members)))
  */
-    __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_grouplist), __pyx_v_i, sizeof(int), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_grouplist), __pyx_v_i, sizeof(int), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_v_key);
     __pyx_v_key = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":274
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":274
  *     for i from 0 <= i < length:
  *         key = grouplist[i]
  *         members = <list> PyDict_GetItem(groups, key)             # <<<<<<<<<<<<<<
@@ -5206,40 +5302,40 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
     __Pyx_DECREF(((PyObject *)__pyx_v_members));
     __pyx_v_members = ((PyObject *)__pyx_t_9);
 
-    /* "H:\pandas\pandas\lib\src\groupby.pyx":275
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":275
  *         key = grouplist[i]
  *         members = <list> PyDict_GetItem(groups, key)
  *         PyDict_SetItem(groups, key, applyfunc(np.asarray(members)))             # <<<<<<<<<<<<<<
  * 
  *     return groups
  */
-    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__asarray); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__asarray); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(((PyObject *)__pyx_v_members));
     PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_members));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_members));
-    __pyx_t_14 = PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_14 = PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_14);
     __Pyx_GIVEREF(__pyx_t_14);
     __pyx_t_14 = 0;
-    __pyx_t_14 = PyObject_Call(__pyx_v_applyfunc, __pyx_t_1, NULL); if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_14 = PyObject_Call(__pyx_v_applyfunc, __pyx_t_1, NULL); if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_15 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, __pyx_t_14); if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_15 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, __pyx_t_14); if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   }
 
-  /* "H:\pandas\pandas\lib\src\groupby.pyx":277
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":277
  *         PyDict_SetItem(groups, key, applyfunc(np.asarray(members)))
  * 
  *     return groups             # <<<<<<<<<<<<<<
@@ -5282,718 +5378,1408 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":10
- * # Rolling sum
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":29
+ *     cdef public:
+ *         double value
+ *         list next             # <<<<<<<<<<<<<<
+ *         ndarray width_arr
  * 
- * cdef void _roll_sum(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
- *                     int win, int minp, int N):
- *     cdef double val, prev, sum_x = 0
  */
 
-static  void __pyx_f_7tseries__roll_sum(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_win, int __pyx_v_minp, int __pyx_v_N) {
-  double __pyx_v_val;
-  double __pyx_v_prev;
-  double __pyx_v_sum_x;
-  int __pyx_v_nobs;
-  int __pyx_v_i;
-  int __pyx_t_1;
-  long __pyx_t_2;
-  int __pyx_t_3;
-  __Pyx_RefNannySetupContext("_roll_sum");
+static PyObject *__pyx_pf_7tseries_4Node_4next___get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pf_7tseries_4Node_4next___get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannySetupContext("__get__");
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next));
+  __pyx_r = ((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next);
+  goto __pyx_L0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":12
- * cdef void _roll_sum(double_t *input, double_t *output,
- *                     int win, int minp, int N):
- *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
- *     cdef int nobs = 0, i
- * 
- */
-  __pyx_v_sum_x = 0;
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":13
- *                     int win, int minp, int N):
- *     cdef double val, prev, sum_x = 0
- *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
- * 
- *     if minp > N:
- */
-  __pyx_v_nobs = 0;
+static int __pyx_pf_7tseries_4Node_4next___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pf_7tseries_4Node_4next___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannySetupContext("__set__");
+  if (!(likely(PyList_CheckExact(__pyx_v_value))||((__pyx_v_value) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected list, got %.200s", Py_TYPE(__pyx_v_value)->tp_name), 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_INCREF(__pyx_v_value);
+  __Pyx_GIVEREF(__pyx_v_value);
+  __Pyx_GOTREF(((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next);
+  __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next));
+  ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next = ((PyObject *)__pyx_v_value);
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":15
- *     cdef int nobs = 0, i
- * 
- *     if minp > N:             # <<<<<<<<<<<<<<
- *         minp = N + 1
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("tseries.Node.next.__set__");
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":30
+ *         double value
+ *         list next
+ *         ndarray width_arr             # <<<<<<<<<<<<<<
  * 
+ *     cdef:
  */
-  __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
-  if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":16
- * 
- *     if minp > N:
- *         minp = N + 1             # <<<<<<<<<<<<<<
+static PyObject *__pyx_pf_7tseries_4Node_9width_arr___get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pf_7tseries_4Node_9width_arr___get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannySetupContext("__get__");
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr));
+  __pyx_r = ((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr);
+  goto __pyx_L0;
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_7tseries_4Node_9width_arr___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pf_7tseries_4Node_9width_arr___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannySetupContext("__set__");
+  if (!(likely(((__pyx_v_value) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_value, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_INCREF(__pyx_v_value);
+  __Pyx_GIVEREF(__pyx_v_value);
+  __Pyx_GOTREF(((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr);
+  __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr));
+  ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr = ((PyArrayObject *)__pyx_v_value);
+
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("tseries.Node.width_arr.__set__");
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":35
+ *         int *width
  * 
- *     for i from 0 <= i < minp - 1:
+ *     def __init__(self, double value, list next, ndarray width):             # <<<<<<<<<<<<<<
+ *         self.value = value
+ *         self.next = next
  */
-    __pyx_v_minp = (__pyx_v_N + 1);
-    goto __pyx_L3;
+
+static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  double __pyx_v_value;
+  PyObject *__pyx_v_next = 0;
+  PyArrayObject *__pyx_v_width = 0;
+  int __pyx_r;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__value,&__pyx_n_s__next,&__pyx_n_s__width,0};
+  __Pyx_RefNannySetupContext("__init__");
+  if (unlikely(__pyx_kwds)) {
+    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
+    PyObject* values[3] = {0,0,0};
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      case  0: break;
+      default: goto __pyx_L5_argtuple_error;
+    }
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  0:
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__value);
+      if (likely(values[0])) kw_args--;
+      else goto __pyx_L5_argtuple_error;
+      case  1:
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__next);
+      if (likely(values[1])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+      case  2:
+      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__width);
+      if (likely(values[2])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+    }
+    if (unlikely(kw_args > 0)) {
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    }
+    __pyx_v_value = __pyx_PyFloat_AsDouble(values[0]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_next = ((PyObject *)values[1]);
+    __pyx_v_width = ((PyArrayObject *)values[2]);
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
+    goto __pyx_L5_argtuple_error;
+  } else {
+    __pyx_v_value = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_next = ((PyObject *)PyTuple_GET_ITEM(__pyx_args, 1));
+    __pyx_v_width = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 2));
   }
-  __pyx_L3:;
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries.Node.__init__");
+  return -1;
+  __pyx_L4_argument_unpacking_done:;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_next), &PyList_Type, 1, "next", 1))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_width), __pyx_ptype_5numpy_ndarray, 1, "width", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":18
- *         minp = N + 1
- * 
- *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
- *         val = input[i]
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":36
  * 
+ *     def __init__(self, double value, list next, ndarray width):
+ *         self.value = value             # <<<<<<<<<<<<<<
+ *         self.next = next
+ *         self.width_arr = width
  */
-  __pyx_t_2 = (__pyx_v_minp - 1);
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
+  ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->value = __pyx_v_value;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":19
- * 
- *     for i from 0 <= i < minp - 1:
- *         val = input[i]             # <<<<<<<<<<<<<<
- * 
- *         # Not NaN
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":37
+ *     def __init__(self, double value, list next, ndarray width):
+ *         self.value = value
+ *         self.next = next             # <<<<<<<<<<<<<<
+ *         self.width_arr = width
+ *         self.width = <int *> width.data
  */
-    __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
+  __Pyx_INCREF(((PyObject *)__pyx_v_next));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_next));
+  __Pyx_GOTREF(((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next);
+  __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next));
+  ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next = __pyx_v_next;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":22
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":38
+ *         self.value = value
+ *         self.next = next
+ *         self.width_arr = width             # <<<<<<<<<<<<<<
+ *         self.width = <int *> width.data
  * 
- *         # Not NaN
- *         if val == val:             # <<<<<<<<<<<<<<
- *             nobs += 1
- *             sum_x += val
  */
-    __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
-    if (__pyx_t_1) {
+  __Pyx_INCREF(((PyObject *)__pyx_v_width));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_width));
+  __Pyx_GOTREF(((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr);
+  __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr));
+  ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr = __pyx_v_width;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":23
- *         # Not NaN
- *         if val == val:
- *             nobs += 1             # <<<<<<<<<<<<<<
- *             sum_x += val
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":39
+ *         self.next = next
+ *         self.width_arr = width
+ *         self.width = <int *> width.data             # <<<<<<<<<<<<<<
  * 
+ * #     cdef get_width(self, int i):
  */
-      __pyx_v_nobs += 1;
+  ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width = ((int *)__pyx_v_width->data);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":24
- *         if val == val:
- *             nobs += 1
- *             sum_x += val             # <<<<<<<<<<<<<<
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("tseries.Node.__init__");
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":54
+ *         Node head
  * 
- *         output[i] = NaN
+ *     def __init__(self, expected_size=100):             # <<<<<<<<<<<<<<
+ *         self.size = 0
+ *         self.maxlevels = int(1 + log2(expected_size))
  */
-      __pyx_v_sum_x += __pyx_v_val;
-      goto __pyx_L6;
+
+static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_expected_size = 0;
+  int __pyx_r;
+  double __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__expected_size,0};
+  __Pyx_RefNannySetupContext("__init__");
+  if (unlikely(__pyx_kwds)) {
+    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
+    PyObject* values[1] = {0};
+    values[0] = ((PyObject *)__pyx_int_100);
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      case  0: break;
+      default: goto __pyx_L5_argtuple_error;
     }
-    __pyx_L6:;
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  0:
+      if (kw_args > 1) {
+        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__expected_size);
+        if (unlikely(value)) { values[0] = value; kw_args--; }
+      }
+    }
+    if (unlikely(kw_args > 0)) {
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    }
+    __pyx_v_expected_size = values[0];
+  } else {
+    __pyx_v_expected_size = ((PyObject *)__pyx_int_100);
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  1: __pyx_v_expected_size = PyTuple_GET_ITEM(__pyx_args, 0);
+      case  0: break;
+      default: goto __pyx_L5_argtuple_error;
+    }
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.__init__");
+  return -1;
+  __pyx_L4_argument_unpacking_done:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":26
- *             sum_x += val
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":55
  * 
- *         output[i] = NaN             # <<<<<<<<<<<<<<
+ *     def __init__(self, expected_size=100):
+ *         self.size = 0             # <<<<<<<<<<<<<<
+ *         self.maxlevels = int(1 + log2(expected_size))
  * 
- *     for i from minp - 1 <= i < N:
  */
-    (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
-  }
+  ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->size = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":28
- *         output[i] = NaN
- * 
- *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
- *         val = input[i]
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":56
+ *     def __init__(self, expected_size=100):
+ *         self.size = 0
+ *         self.maxlevels = int(1 + log2(expected_size))             # <<<<<<<<<<<<<<
  * 
+ *         self.head = Node(np.NaN, [NIL] * self.maxlevels,
  */
-  __pyx_t_3 = __pyx_v_N;
-  for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_expected_size); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels = ((int)(1 + log2(__pyx_t_1)));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":29
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":58
+ *         self.maxlevels = int(1 + log2(expected_size))
  * 
- *     for i from minp - 1 <= i < N:
- *         val = input[i]             # <<<<<<<<<<<<<<
+ *         self.head = Node(np.NaN, [NIL] * self.maxlevels,             # <<<<<<<<<<<<<<
+ *                          np.ones(self.maxlevels, dtype=int))
  * 
- *         if i > win - 1:
  */
-    __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__NaN); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__NIL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
+  PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = PyNumber_Multiply(((PyObject *)__pyx_t_4), __pyx_t_2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":31
- *         val = input[i]
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":59
  * 
- *         if i > win - 1:             # <<<<<<<<<<<<<<
- *             prev = input[i - win]
- *             if prev == prev:
- */
-    __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
-    if (__pyx_t_1) {
-
-      /* "H:\pandas\pandas\lib\src\moments.pyx":32
+ *         self.head = Node(np.NaN, [NIL] * self.maxlevels,
+ *                          np.ones(self.maxlevels, dtype=int))             # <<<<<<<<<<<<<<
  * 
- *         if i > win - 1:
- *             prev = input[i - win]             # <<<<<<<<<<<<<<
- *             if prev == prev:
- *                 sum_x -= prev
+ *     def __len__(self):
  */
-      __pyx_v_prev = (__pyx_v_input[(__pyx_v_i - __pyx_v_win)]);
-
-      /* "H:\pandas\pandas\lib\src\moments.pyx":33
- *         if i > win - 1:
- *             prev = input[i - win]
- *             if prev == prev:             # <<<<<<<<<<<<<<
- *                 sum_x -= prev
- *                 nobs -= 1
- */
-      __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
-      if (__pyx_t_1) {
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__ones); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyInt_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_7);
+  __Pyx_GIVEREF(__pyx_t_7);
+  __pyx_t_3 = 0;
+  __pyx_t_5 = 0;
+  __pyx_t_7 = 0;
+  __pyx_t_7 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_Node)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":34
- *             prev = input[i - win]
- *             if prev == prev:
- *                 sum_x -= prev             # <<<<<<<<<<<<<<
- *                 nobs -= 1
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":58
+ *         self.maxlevels = int(1 + log2(expected_size))
  * 
- */
-        __pyx_v_sum_x -= __pyx_v_prev;
-
-        /* "H:\pandas\pandas\lib\src\moments.pyx":35
- *             if prev == prev:
- *                 sum_x -= prev
- *                 nobs -= 1             # <<<<<<<<<<<<<<
+ *         self.head = Node(np.NaN, [NIL] * self.maxlevels,             # <<<<<<<<<<<<<<
+ *                          np.ones(self.maxlevels, dtype=int))
  * 
- *         if val == val:
  */
-        __pyx_v_nobs -= 1;
-        goto __pyx_L10;
-      }
-      __pyx_L10:;
-      goto __pyx_L9;
-    }
-    __pyx_L9:;
+  __Pyx_GIVEREF(__pyx_t_7);
+  __Pyx_GOTREF(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head);
+  __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head));
+  ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head = ((struct __pyx_obj_7tseries_Node *)__pyx_t_7);
+  __pyx_t_7 = 0;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":37
- *                 nobs -= 1
- * 
- *         if val == val:             # <<<<<<<<<<<<<<
- *             nobs += 1
- *             sum_x += val
- */
-    __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
-    if (__pyx_t_1) {
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.__init__");
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":38
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":61
+ *                          np.ones(self.maxlevels, dtype=int))
  * 
- *         if val == val:
- *             nobs += 1             # <<<<<<<<<<<<<<
- *             sum_x += val
+ *     def __len__(self):             # <<<<<<<<<<<<<<
+ *         return self.size
  * 
  */
-      __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":39
- *         if val == val:
- *             nobs += 1
- *             sum_x += val             # <<<<<<<<<<<<<<
- * 
- *         if nobs >= minp:
- */
-      __pyx_v_sum_x += __pyx_v_val;
-      goto __pyx_L11;
-    }
-    __pyx_L11:;
+static Py_ssize_t __pyx_pf_7tseries_17IndexableSkiplist___len__(PyObject *__pyx_v_self); /*proto*/
+static Py_ssize_t __pyx_pf_7tseries_17IndexableSkiplist___len__(PyObject *__pyx_v_self) {
+  Py_ssize_t __pyx_r;
+  __Pyx_RefNannySetupContext("__len__");
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":41
- *             sum_x += val
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":62
  * 
- *         if nobs >= minp:             # <<<<<<<<<<<<<<
- *             output[i] = sum_x
- *         else:
+ *     def __len__(self):
+ *         return self.size             # <<<<<<<<<<<<<<
+ * 
+ *     def __getitem__(self, i):
  */
-    __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
-    if (__pyx_t_1) {
+  __pyx_r = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->size;
+  goto __pyx_L0;
+
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":42
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":64
+ *         return self.size
+ * 
+ *     def __getitem__(self, i):             # <<<<<<<<<<<<<<
+ *         return self.get(i)
  * 
- *         if nobs >= minp:
- *             output[i] = sum_x             # <<<<<<<<<<<<<<
- *         else:
- *             output[i] = NaN
  */
-      (__pyx_v_output[__pyx_v_i]) = __pyx_v_sum_x;
-      goto __pyx_L12;
-    }
-    /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":44
- *             output[i] = sum_x
- *         else:
- *             output[i] = NaN             # <<<<<<<<<<<<<<
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist___getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_i); /*proto*/
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist___getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_i) {
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  __Pyx_RefNannySetupContext("__getitem__");
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":65
  * 
- * def _roll_sum_noncontig(ndarray[double_t, ndim=1] input,
+ *     def __getitem__(self, i):
+ *         return self.get(i)             # <<<<<<<<<<<<<<
+ * 
+ *     def get(self, int i):
  */
-      (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
-    }
-    __pyx_L12:;
-  }
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__get); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_INCREF(__pyx_v_i);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_i);
+  __Pyx_GIVEREF(__pyx_v_i);
+  __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
+  goto __pyx_L0;
 
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.__getitem__");
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
+  return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":46
- *             output[i] = NaN
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":67
+ *         return self.get(i)
  * 
- * def _roll_sum_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *                         ndarray[double_t, ndim=1] output,
- *                         int win, int minp, int N):
+ *     def get(self, int i):             # <<<<<<<<<<<<<<
+ *         cdef int level
+ *         cdef Node node
  */
 
-static PyObject *__pyx_pf_7tseries__roll_sum_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_sum_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_input = 0;
-  PyArrayObject *__pyx_v_output = 0;
-  int __pyx_v_win;
-  int __pyx_v_minp;
-  int __pyx_v_N;
-  double __pyx_v_val;
-  double __pyx_v_prev;
-  double __pyx_v_sum_x;
-  int __pyx_v_nobs;
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_self, PyObject *__pyx_arg_i); /*proto*/
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_self, PyObject *__pyx_arg_i) {
   int __pyx_v_i;
-  Py_buffer __pyx_bstruct_output;
-  Py_ssize_t __pyx_bstride_0_output = 0;
-  Py_ssize_t __pyx_bshape_0_output = 0;
-  Py_buffer __pyx_bstruct_input;
-  Py_ssize_t __pyx_bstride_0_input = 0;
-  Py_ssize_t __pyx_bshape_0_input = 0;
+  int __pyx_v_level;
+  struct __pyx_obj_7tseries_Node *__pyx_v_node;
   PyObject *__pyx_r = NULL;
   int __pyx_t_1;
-  long __pyx_t_2;
-  int __pyx_t_3;
-  int __pyx_t_4;
-  int __pyx_t_5;
-  int __pyx_t_6;
-  int __pyx_t_7;
-  int __pyx_t_8;
-  int __pyx_t_9;
-  int __pyx_t_10;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__output,&__pyx_n_s__win,&__pyx_n_s__minp,&__pyx_n_s__N,0};
-  __Pyx_RefNannySetupContext("_roll_sum_noncontig");
-  __pyx_self = __pyx_self;
-  if (unlikely(__pyx_kwds)) {
-    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[5] = {0,0,0,0,0};
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      case  0: break;
-      default: goto __pyx_L5_argtuple_error;
-    }
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
-      if (likely(values[0])) kw_args--;
-      else goto __pyx_L5_argtuple_error;
-      case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
-      if (likely(values[1])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
-      if (likely(values[2])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  3:
-      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
-      if (likely(values[3])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  4:
-      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
-      if (likely(values[4])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-    }
-    if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_sum_noncontig") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    }
-    __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_output = ((PyArrayObject *)values[1]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
-    goto __pyx_L5_argtuple_error;
-  } else {
-    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  int __pyx_t_2;
+  PyObject *__pyx_t_3 = NULL;
+  __Pyx_RefNannySetupContext("get");
+  assert(__pyx_arg_i); {
+    __pyx_v_i = __Pyx_PyInt_AsInt(__pyx_arg_i); if (unlikely((__pyx_v_i == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_sum_noncontig");
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.get");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
-  __Pyx_INCREF((PyObject *)__pyx_v_output);
-  __pyx_bstruct_input.buf = NULL;
-  __pyx_bstruct_output.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
-  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
-  __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
+  __Pyx_INCREF((PyObject *)__pyx_v_self);
+  __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":49
- *                         ndarray[double_t, ndim=1] output,
- *                         int win, int minp, int N):
- *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
- *     cdef int nobs = 0, i
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":71
+ *         cdef Node node
+ * 
+ *         node = self.head             # <<<<<<<<<<<<<<
+ *         i += 1
  * 
  */
-  __pyx_v_sum_x = 0;
+  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head));
+  __Pyx_DECREF(((PyObject *)__pyx_v_node));
+  __pyx_v_node = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":50
- *                         int win, int minp, int N):
- *     cdef double val, prev, sum_x = 0
- *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":72
  * 
- *     if minp > N:
+ *         node = self.head
+ *         i += 1             # <<<<<<<<<<<<<<
+ * 
+ *         for level in range(self.maxlevels - 1, -1, -1):
  */
-  __pyx_v_nobs = 0;
+  __pyx_v_i += 1;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":52
- *     cdef int nobs = 0, i
- * 
- *     if minp > N:             # <<<<<<<<<<<<<<
- *         minp = N + 1
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":74
+ *         i += 1
  * 
+ *         for level in range(self.maxlevels - 1, -1, -1):             # <<<<<<<<<<<<<<
+ *             while node.width[level] <= i:
+ *                 i -= node.width[level]
  */
-  __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
-  if (__pyx_t_1) {
+  for (__pyx_t_1 = (((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels - 1); __pyx_t_1 > -1; __pyx_t_1-=1) {
+    __pyx_v_level = __pyx_t_1;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":53
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":75
  * 
- *     if minp > N:
- *         minp = N + 1             # <<<<<<<<<<<<<<
+ *         for level in range(self.maxlevels - 1, -1, -1):
+ *             while node.width[level] <= i:             # <<<<<<<<<<<<<<
+ *                 i -= node.width[level]
+ *                 node = node.next[level]
+ */
+    while (1) {
+      __pyx_t_2 = ((__pyx_v_node->width[__pyx_v_level]) <= __pyx_v_i);
+      if (!__pyx_t_2) break;
+
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":76
+ *         for level in range(self.maxlevels - 1, -1, -1):
+ *             while node.width[level] <= i:
+ *                 i -= node.width[level]             # <<<<<<<<<<<<<<
+ *                 node = node.next[level]
  * 
- *     for i from 0 <= i < minp - 1:
  */
-    __pyx_v_minp = (__pyx_v_N + 1);
-    goto __pyx_L6;
+      __pyx_v_i -= (__pyx_v_node->width[__pyx_v_level]);
+
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":77
+ *             while node.width[level] <= i:
+ *                 i -= node.width[level]
+ *                 node = node.next[level]             # <<<<<<<<<<<<<<
+ * 
+ *         return node.value
+ */
+      __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_node->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(((PyObject *)__pyx_v_node));
+      __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
+      __pyx_t_3 = 0;
+    }
   }
-  __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":55
- *         minp = N + 1
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":79
+ *                 node = node.next[level]
  * 
- *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
- *         val = input[i]
+ *         return node.value             # <<<<<<<<<<<<<<
  * 
+ *     def insert(self, double value):
  */
-  __pyx_t_2 = (__pyx_v_minp - 1);
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_node->value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
+  goto __pyx_L0;
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.get");
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_DECREF((PyObject *)__pyx_v_node);
+  __Pyx_DECREF((PyObject *)__pyx_v_self);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":81
+ *         return node.value
+ * 
+ *     def insert(self, double value):             # <<<<<<<<<<<<<<
+ *         cdef int level, steps, d
+ *         cdef Node node, prevnode, newnode, next_at_level
+ */
+
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
+  double __pyx_v_value;
+  int __pyx_v_level;
+  int __pyx_v_steps;
+  int __pyx_v_d;
+  struct __pyx_obj_7tseries_Node *__pyx_v_node;
+  struct __pyx_obj_7tseries_Node *__pyx_v_prevnode;
+  struct __pyx_obj_7tseries_Node *__pyx_v_newnode;
+  struct __pyx_obj_7tseries_Node *__pyx_v_next_at_level;
+  PyObject *__pyx_v_chain;
+  PyObject *__pyx_v_steps_at_level;
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  int __pyx_t_5;
+  double __pyx_t_6;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  int __pyx_t_10;
+  int __pyx_t_11;
+  __Pyx_RefNannySetupContext("insert");
+  assert(__pyx_arg_value); {
+    __pyx_v_value = __pyx_PyFloat_AsDouble(__pyx_arg_value); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.insert");
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __Pyx_INCREF((PyObject *)__pyx_v_self);
+  __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_newnode = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_chain = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_steps_at_level = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":56
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":87
  * 
- *     for i from 0 <= i < minp - 1:
- *         val = input[i]             # <<<<<<<<<<<<<<
+ *         # find first node on each level where node.next[levels].value > value
+ *         chain = [None] * self.maxlevels             # <<<<<<<<<<<<<<
+ *         steps_at_level = [0] * self.maxlevels
  * 
- *         # Not NaN
  */
-    __pyx_t_3 = __pyx_v_i;
-    __pyx_t_4 = -1;
-    if (__pyx_t_3 < 0) {
-      __pyx_t_3 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
-    } else if (unlikely(__pyx_t_3 >= __pyx_bshape_0_input)) __pyx_t_4 = 0;
-    if (unlikely(__pyx_t_4 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_4);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_3, __pyx_bstride_0_input));
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
+  __Pyx_INCREF(Py_None);
+  PyList_SET_ITEM(__pyx_t_1, 0, Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __pyx_t_2 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyNumber_Multiply(((PyObject *)__pyx_t_1), __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (!(likely(PyList_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected list, got %.200s", Py_TYPE(__pyx_t_3)->tp_name), 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(((PyObject *)__pyx_v_chain));
+  __pyx_v_chain = ((PyObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":59
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":88
+ *         # find first node on each level where node.next[levels].value > value
+ *         chain = [None] * self.maxlevels
+ *         steps_at_level = [0] * self.maxlevels             # <<<<<<<<<<<<<<
  * 
- *         # Not NaN
- *         if val == val:             # <<<<<<<<<<<<<<
- *             nobs += 1
- *             sum_x += val
+ *         node = self.head
  */
-    __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
-    if (__pyx_t_1) {
+  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
+  __Pyx_INCREF(__pyx_int_0);
+  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
+  __Pyx_GIVEREF(__pyx_int_0);
+  __pyx_t_2 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyNumber_Multiply(((PyObject *)__pyx_t_3), __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (!(likely(PyList_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected list, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(((PyObject *)__pyx_v_steps_at_level));
+  __pyx_v_steps_at_level = ((PyObject *)__pyx_t_1);
+  __pyx_t_1 = 0;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":60
- *         # Not NaN
- *         if val == val:
- *             nobs += 1             # <<<<<<<<<<<<<<
- *             sum_x += val
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":90
+ *         steps_at_level = [0] * self.maxlevels
  * 
+ *         node = self.head             # <<<<<<<<<<<<<<
+ *         for level in range(self.maxlevels - 1, -1, -1):
+ *             next_at_level = node.next[level]
  */
-      __pyx_v_nobs += 1;
+  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head));
+  __Pyx_DECREF(((PyObject *)__pyx_v_node));
+  __pyx_v_node = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":61
- *         if val == val:
- *             nobs += 1
- *             sum_x += val             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":91
+ * 
+ *         node = self.head
+ *         for level in range(self.maxlevels - 1, -1, -1):             # <<<<<<<<<<<<<<
+ *             next_at_level = node.next[level]
  * 
- *         output[i] = NaN
  */
-      __pyx_v_sum_x += __pyx_v_val;
-      goto __pyx_L9;
-    }
-    __pyx_L9:;
+  for (__pyx_t_4 = (((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels - 1); __pyx_t_4 > -1; __pyx_t_4-=1) {
+    __pyx_v_level = __pyx_t_4;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":63
- *             sum_x += val
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":92
+ *         node = self.head
+ *         for level in range(self.maxlevels - 1, -1, -1):
+ *             next_at_level = node.next[level]             # <<<<<<<<<<<<<<
  * 
- *         output[i] = NaN             # <<<<<<<<<<<<<<
+ *             while next_at_level.value <= value:
+ */
+    __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_node->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_1);
+    if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_next_at_level));
+    __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_1);
+    __pyx_t_1 = 0;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":94
+ *             next_at_level = node.next[level]
  * 
- *     for i from minp - 1 <= i < N:
+ *             while next_at_level.value <= value:             # <<<<<<<<<<<<<<
+ *                 steps_at_level[level] = (steps_at_level[level] +
+ *                                          node.width[level])
  */
-    __pyx_t_4 = __pyx_v_i;
-    __pyx_t_5 = -1;
-    if (__pyx_t_4 < 0) {
-      __pyx_t_4 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_4 < 0)) __pyx_t_5 = 0;
-    } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_5 = 0;
-    if (unlikely(__pyx_t_5 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
-  }
+    while (1) {
+      __pyx_t_5 = (__pyx_v_next_at_level->value <= __pyx_v_value);
+      if (!__pyx_t_5) break;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":65
- *         output[i] = NaN
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":95
  * 
- *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
- *         val = input[i]
+ *             while next_at_level.value <= value:
+ *                 steps_at_level[level] = (steps_at_level[level] +             # <<<<<<<<<<<<<<
+ *                                          node.width[level])
+ *                 node = next_at_level
+ */
+      __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_1);
+
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":96
+ *             while next_at_level.value <= value:
+ *                 steps_at_level[level] = (steps_at_level[level] +
+ *                                          node.width[level])             # <<<<<<<<<<<<<<
+ *                 node = next_at_level
+ *                 next_at_level = node.next[level]
+ */
+      __pyx_t_2 = PyInt_FromLong((__pyx_v_node->width[__pyx_v_level])); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":95
  * 
+ *             while next_at_level.value <= value:
+ *                 steps_at_level[level] = (steps_at_level[level] +             # <<<<<<<<<<<<<<
+ *                                          node.width[level])
+ *                 node = next_at_level
  */
-  __pyx_t_5 = __pyx_v_N;
-  for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_5; __pyx_v_i++) {
+      if (__Pyx_SetItemInt(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, __pyx_t_3, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":66
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":97
+ *                 steps_at_level[level] = (steps_at_level[level] +
+ *                                          node.width[level])
+ *                 node = next_at_level             # <<<<<<<<<<<<<<
+ *                 next_at_level = node.next[level]
  * 
- *     for i from minp - 1 <= i < N:
- *         val = input[i]             # <<<<<<<<<<<<<<
+ */
+      __Pyx_INCREF(((PyObject *)__pyx_v_next_at_level));
+      __Pyx_DECREF(((PyObject *)__pyx_v_node));
+      __pyx_v_node = __pyx_v_next_at_level;
+
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":98
+ *                                          node.width[level])
+ *                 node = next_at_level
+ *                 next_at_level = node.next[level]             # <<<<<<<<<<<<<<
  * 
- *         if i > win - 1:
+ *             chain[level] = node
  */
-    __pyx_t_6 = __pyx_v_i;
-    __pyx_t_7 = -1;
-    if (__pyx_t_6 < 0) {
-      __pyx_t_6 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_6 < 0)) __pyx_t_7 = 0;
-    } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_input)) __pyx_t_7 = 0;
-    if (unlikely(__pyx_t_7 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_node->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(((PyObject *)__pyx_v_next_at_level));
+      __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
+      __pyx_t_3 = 0;
     }
-    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":68
- *         val = input[i]
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":100
+ *                 next_at_level = node.next[level]
  * 
- *         if i > win - 1:             # <<<<<<<<<<<<<<
- *             prev = input[i - win]
- *             if prev == prev:
+ *             chain[level] = node             # <<<<<<<<<<<<<<
+ * 
+ *         # insert a link to the newnode at each level
  */
-    __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
-    if (__pyx_t_1) {
+    if (__Pyx_SetItemInt(((PyObject *)__pyx_v_chain), __pyx_v_level, ((PyObject *)__pyx_v_node), sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":69
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":103
  * 
- *         if i > win - 1:
- *             prev = input[i - win]             # <<<<<<<<<<<<<<
- *             if prev == prev:
- *                 sum_x -= prev
+ *         # insert a link to the newnode at each level
+ *         d = min(self.maxlevels, 1 - int(log2(random())))             # <<<<<<<<<<<<<<
+ *         newnode = Node(value, [None] * d, np.empty(d, dtype=int))
+ *         steps = 0
  */
-      __pyx_t_7 = (__pyx_v_i - __pyx_v_win);
-      __pyx_t_8 = -1;
-      if (__pyx_t_7 < 0) {
-        __pyx_t_7 += __pyx_bshape_0_input;
-        if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
-      } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_8 = 0;
-      if (unlikely(__pyx_t_8 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_8);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
+  __pyx_t_3 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__random); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyFloat_FromDouble(log2(__pyx_t_6)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)&PyInt_Type)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyNumber_Subtract(__pyx_int_1, __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_3 = 0;
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyObject_Call(__pyx_builtin_min, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_4 = __Pyx_PyInt_AsInt(__pyx_t_2); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_d = __pyx_t_4;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":70
- *         if i > win - 1:
- *             prev = input[i - win]
- *             if prev == prev:             # <<<<<<<<<<<<<<
- *                 sum_x -= prev
- *                 nobs -= 1
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":104
+ *         # insert a link to the newnode at each level
+ *         d = min(self.maxlevels, 1 - int(log2(random())))
+ *         newnode = Node(value, [None] * d, np.empty(d, dtype=int))             # <<<<<<<<<<<<<<
+ *         steps = 0
+ * 
  */
-      __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
-      if (__pyx_t_1) {
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
+  __Pyx_INCREF(Py_None);
+  PyList_SET_ITEM(__pyx_t_1, 0, Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __pyx_t_3 = PyInt_FromLong(__pyx_v_d); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_7 = PyNumber_Multiply(((PyObject *)__pyx_t_1), __pyx_t_3); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyInt_FromLong(__pyx_v_d); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_8);
+  PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
+  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyInt_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_9 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_8, ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_9);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_7);
+  __Pyx_GIVEREF(__pyx_t_7);
+  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_9);
+  __Pyx_GIVEREF(__pyx_t_9);
+  __pyx_t_2 = 0;
+  __pyx_t_7 = 0;
+  __pyx_t_9 = 0;
+  __pyx_t_9 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_Node)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_9);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_newnode));
+  __pyx_v_newnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_9);
+  __pyx_t_9 = 0;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":71
- *             prev = input[i - win]
- *             if prev == prev:
- *                 sum_x -= prev             # <<<<<<<<<<<<<<
- *                 nobs -= 1
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":105
+ *         d = min(self.maxlevels, 1 - int(log2(random())))
+ *         newnode = Node(value, [None] * d, np.empty(d, dtype=int))
+ *         steps = 0             # <<<<<<<<<<<<<<
  * 
+ *         for level in range(d):
  */
-        __pyx_v_sum_x -= __pyx_v_prev;
+  __pyx_v_steps = 0;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":72
- *             if prev == prev:
- *                 sum_x -= prev
- *                 nobs -= 1             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":107
+ *         steps = 0
+ * 
+ *         for level in range(d):             # <<<<<<<<<<<<<<
+ *             prevnode = chain[level]
  * 
- *         if val == val:
  */
-        __pyx_v_nobs -= 1;
-        goto __pyx_L13;
-      }
-      __pyx_L13:;
-      goto __pyx_L12;
-    }
-    __pyx_L12:;
+  __pyx_t_4 = __pyx_v_d;
+  for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_4; __pyx_t_10+=1) {
+    __pyx_v_level = __pyx_t_10;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":74
- *                 nobs -= 1
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":108
  * 
- *         if val == val:             # <<<<<<<<<<<<<<
- *             nobs += 1
- *             sum_x += val
+ *         for level in range(d):
+ *             prevnode = chain[level]             # <<<<<<<<<<<<<<
+ * 
+ *             newnode.next[level] = prevnode.next[level]
  */
-    __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
-    if (__pyx_t_1) {
+    __pyx_t_9 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_9) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_9);
+    if (!(likely(((__pyx_t_9) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_9, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_prevnode));
+    __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_9);
+    __pyx_t_9 = 0;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":75
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":110
+ *             prevnode = chain[level]
  * 
- *         if val == val:
- *             nobs += 1             # <<<<<<<<<<<<<<
- *             sum_x += val
+ *             newnode.next[level] = prevnode.next[level]             # <<<<<<<<<<<<<<
+ *             prevnode.next[level] = newnode
  * 
  */
-      __pyx_v_nobs += 1;
+    __pyx_t_9 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_9) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_9);
+    if (__Pyx_SetItemInt(((PyObject *)__pyx_v_newnode->next), __pyx_v_level, __pyx_t_9, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":76
- *         if val == val:
- *             nobs += 1
- *             sum_x += val             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":111
  * 
- *         if nobs >= minp:
+ *             newnode.next[level] = prevnode.next[level]
+ *             prevnode.next[level] = newnode             # <<<<<<<<<<<<<<
+ * 
+ *             newnode.width[level] = prevnode.width[level] - steps
  */
-      __pyx_v_sum_x += __pyx_v_val;
-      goto __pyx_L14;
-    }
-    __pyx_L14:;
+    if (__Pyx_SetItemInt(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, ((PyObject *)__pyx_v_newnode), sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":78
- *             sum_x += val
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":113
+ *             prevnode.next[level] = newnode
+ * 
+ *             newnode.width[level] = prevnode.width[level] - steps             # <<<<<<<<<<<<<<
+ *             prevnode.width[level] = steps + 1
  * 
- *         if nobs >= minp:             # <<<<<<<<<<<<<<
- *             output[i] = sum_x
- *         else:
  */
-    __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
-    if (__pyx_t_1) {
+    (__pyx_v_newnode->width[__pyx_v_level]) = ((__pyx_v_prevnode->width[__pyx_v_level]) - __pyx_v_steps);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":79
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":114
  * 
- *         if nobs >= minp:
- *             output[i] = sum_x             # <<<<<<<<<<<<<<
- *         else:
- *             output[i] = NaN
+ *             newnode.width[level] = prevnode.width[level] - steps
+ *             prevnode.width[level] = steps + 1             # <<<<<<<<<<<<<<
+ * 
+ *             steps = steps + steps_at_level[level]
  */
-      __pyx_t_8 = __pyx_v_i;
-      __pyx_t_9 = -1;
-      if (__pyx_t_8 < 0) {
-        __pyx_t_8 += __pyx_bshape_0_output;
-        if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
-      } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
-      if (unlikely(__pyx_t_9 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_9);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = __pyx_v_sum_x;
-      goto __pyx_L15;
-    }
-    /*else*/ {
+    (__pyx_v_prevnode->width[__pyx_v_level]) = (__pyx_v_steps + 1);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":81
- *             output[i] = sum_x
- *         else:
- *             output[i] = NaN             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":116
+ *             prevnode.width[level] = steps + 1
  * 
- * #-------------------------------------------------------------------------------
+ *             steps = steps + steps_at_level[level]             # <<<<<<<<<<<<<<
+ * 
+ *         for level in range(d, self.maxlevels):
  */
-      __pyx_t_9 = __pyx_v_i;
-      __pyx_t_10 = -1;
-      if (__pyx_t_9 < 0) {
-        __pyx_t_9 += __pyx_bshape_0_output;
-        if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
-      } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_output)) __pyx_t_10 = 0;
-      if (unlikely(__pyx_t_10 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_10);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_9, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
+    __pyx_t_9 = PyInt_FromLong(__pyx_v_steps); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_7 = PyNumber_Add(__pyx_t_9, __pyx_t_3); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_11 = __Pyx_PyInt_AsInt(__pyx_t_7); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_v_steps = __pyx_t_11;
+  }
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":118
+ *             steps = steps + steps_at_level[level]
+ * 
+ *         for level in range(d, self.maxlevels):             # <<<<<<<<<<<<<<
+ *             (<Node> chain[level]).width[level] += 1
+ * 
+ */
+  __pyx_t_4 = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels;
+  for (__pyx_t_10 = __pyx_v_d; __pyx_t_10 < __pyx_t_4; __pyx_t_10+=1) {
+    __pyx_v_level = __pyx_t_10;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":119
+ * 
+ *         for level in range(d, self.maxlevels):
+ *             (<Node> chain[level]).width[level] += 1             # <<<<<<<<<<<<<<
+ * 
+ *         self.size += 1
+ */
+    __pyx_t_7 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_7) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_7);
+    (((struct __pyx_obj_7tseries_Node *)__pyx_t_7)->width[__pyx_v_level]) += 1;
+  }
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":121
+ *             (<Node> chain[level]).width[level] += 1
+ * 
+ *         self.size += 1             # <<<<<<<<<<<<<<
+ * 
+ *     def remove(self, double value):
+ */
+  ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->size += 1;
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.insert");
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_DECREF((PyObject *)__pyx_v_node);
+  __Pyx_DECREF((PyObject *)__pyx_v_prevnode);
+  __Pyx_DECREF((PyObject *)__pyx_v_newnode);
+  __Pyx_DECREF((PyObject *)__pyx_v_next_at_level);
+  __Pyx_DECREF(__pyx_v_chain);
+  __Pyx_DECREF(__pyx_v_steps_at_level);
+  __Pyx_DECREF((PyObject *)__pyx_v_self);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":123
+ *         self.size += 1
+ * 
+ *     def remove(self, double value):             # <<<<<<<<<<<<<<
+ *         cdef int level, d
+ *         cdef Node node, prevnode, tmpnode, next_at_level
+ */
+
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
+static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
+  double __pyx_v_value;
+  int __pyx_v_level;
+  int __pyx_v_d;
+  struct __pyx_obj_7tseries_Node *__pyx_v_node;
+  struct __pyx_obj_7tseries_Node *__pyx_v_prevnode;
+  struct __pyx_obj_7tseries_Node *__pyx_v_tmpnode;
+  struct __pyx_obj_7tseries_Node *__pyx_v_next_at_level;
+  PyObject *__pyx_v_chain;
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  int __pyx_t_5;
+  Py_ssize_t __pyx_t_6;
+  int __pyx_t_7;
+  __Pyx_RefNannySetupContext("remove");
+  assert(__pyx_arg_value); {
+    __pyx_v_value = __pyx_PyFloat_AsDouble(__pyx_arg_value); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.remove");
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __Pyx_INCREF((PyObject *)__pyx_v_self);
+  __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_chain = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":129
+ * 
+ *         # find first node on each level where node.next[levels].value >= value
+ *         chain = [None] * self.maxlevels             # <<<<<<<<<<<<<<
+ *         node = self.head
+ * 
+ */
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
+  __Pyx_INCREF(Py_None);
+  PyList_SET_ITEM(__pyx_t_1, 0, Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __pyx_t_2 = PyInt_FromLong(((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyNumber_Multiply(((PyObject *)__pyx_t_1), __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (!(likely(PyList_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected list, got %.200s", Py_TYPE(__pyx_t_3)->tp_name), 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(((PyObject *)__pyx_v_chain));
+  __pyx_v_chain = ((PyObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":130
+ *         # find first node on each level where node.next[levels].value >= value
+ *         chain = [None] * self.maxlevels
+ *         node = self.head             # <<<<<<<<<<<<<<
+ * 
+ *         for level in range(self.maxlevels - 1, -1, -1):
+ */
+  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head));
+  __Pyx_DECREF(((PyObject *)__pyx_v_node));
+  __pyx_v_node = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head;
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":132
+ *         node = self.head
+ * 
+ *         for level in range(self.maxlevels - 1, -1, -1):             # <<<<<<<<<<<<<<
+ *             next_at_level = node.next[level]
+ *             while next_at_level.value < value:
+ */
+  for (__pyx_t_4 = (((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels - 1); __pyx_t_4 > -1; __pyx_t_4-=1) {
+    __pyx_v_level = __pyx_t_4;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":133
+ * 
+ *         for level in range(self.maxlevels - 1, -1, -1):
+ *             next_at_level = node.next[level]             # <<<<<<<<<<<<<<
+ *             while next_at_level.value < value:
+ *                 node = next_at_level
+ */
+    __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_node->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_next_at_level));
+    __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
+    __pyx_t_3 = 0;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":134
+ *         for level in range(self.maxlevels - 1, -1, -1):
+ *             next_at_level = node.next[level]
+ *             while next_at_level.value < value:             # <<<<<<<<<<<<<<
+ *                 node = next_at_level
+ *                 next_at_level = node.next[level]
+ */
+    while (1) {
+      __pyx_t_5 = (__pyx_v_next_at_level->value < __pyx_v_value);
+      if (!__pyx_t_5) break;
+
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":135
+ *             next_at_level = node.next[level]
+ *             while next_at_level.value < value:
+ *                 node = next_at_level             # <<<<<<<<<<<<<<
+ *                 next_at_level = node.next[level]
+ * 
+ */
+      __Pyx_INCREF(((PyObject *)__pyx_v_next_at_level));
+      __Pyx_DECREF(((PyObject *)__pyx_v_node));
+      __pyx_v_node = __pyx_v_next_at_level;
+
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":136
+ *             while next_at_level.value < value:
+ *                 node = next_at_level
+ *                 next_at_level = node.next[level]             # <<<<<<<<<<<<<<
+ * 
+ *             chain[level] = node
+ */
+      __pyx_t_3 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_node->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(((PyObject *)__pyx_v_next_at_level));
+      __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
+      __pyx_t_3 = 0;
     }
-    __pyx_L15:;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":138
+ *                 next_at_level = node.next[level]
+ * 
+ *             chain[level] = node             # <<<<<<<<<<<<<<
+ * 
+ *         if value != chain[0].next[0].value:
+ */
+    if (__Pyx_SetItemInt(((PyObject *)__pyx_v_chain), __pyx_v_level, ((PyObject *)__pyx_v_node), sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":140
+ *             chain[level] = node
+ * 
+ *         if value != chain[0].next[0].value:             # <<<<<<<<<<<<<<
+ *             raise KeyError('Not Found')
+ * 
+ */
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__next); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__value); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_t_1, Py_NE); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (__pyx_t_5) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":141
+ * 
+ *         if value != chain[0].next[0].value:
+ *             raise KeyError('Not Found')             # <<<<<<<<<<<<<<
+ * 
+ *         # remove one link at each level
+ */
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_INCREF(((PyObject *)__pyx_kp_s_4));
+    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_kp_s_4));
+    __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_4));
+    __pyx_t_1 = PyObject_Call(__pyx_builtin_KeyError, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_Raise(__pyx_t_1, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    {__pyx_filename = __pyx_f[1]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    goto __pyx_L9;
+  }
+  __pyx_L9:;
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":144
+ * 
+ *         # remove one link at each level
+ *         d = len(chain[0].next[0].next)             # <<<<<<<<<<<<<<
+ * 
+ *         for level in range(d):
+ */
+  __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__next); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__next); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_6 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_d = __pyx_t_6;
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":146
+ *         d = len(chain[0].next[0].next)
+ * 
+ *         for level in range(d):             # <<<<<<<<<<<<<<
+ *             prevnode = chain[level]
+ *             tmpnode = prevnode.next[level]
+ */
+  __pyx_t_4 = __pyx_v_d;
+  for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_4; __pyx_t_7+=1) {
+    __pyx_v_level = __pyx_t_7;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":147
+ * 
+ *         for level in range(d):
+ *             prevnode = chain[level]             # <<<<<<<<<<<<<<
+ *             tmpnode = prevnode.next[level]
+ *             prevnode.width[level] += tmpnode.width[level] - 1
+ */
+    __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_prevnode));
+    __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_2);
+    __pyx_t_2 = 0;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":148
+ *         for level in range(d):
+ *             prevnode = chain[level]
+ *             tmpnode = prevnode.next[level]             # <<<<<<<<<<<<<<
+ *             prevnode.width[level] += tmpnode.width[level] - 1
+ *             prevnode.next[level] = tmpnode.next[level]
+ */
+    __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_tmpnode));
+    __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_2);
+    __pyx_t_2 = 0;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":149
+ *             prevnode = chain[level]
+ *             tmpnode = prevnode.next[level]
+ *             prevnode.width[level] += tmpnode.width[level] - 1             # <<<<<<<<<<<<<<
+ *             prevnode.next[level] = tmpnode.next[level]
+ * 
+ */
+    (__pyx_v_prevnode->width[__pyx_v_level]) += ((__pyx_v_tmpnode->width[__pyx_v_level]) - 1);
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":150
+ *             tmpnode = prevnode.next[level]
+ *             prevnode.width[level] += tmpnode.width[level] - 1
+ *             prevnode.next[level] = tmpnode.next[level]             # <<<<<<<<<<<<<<
+ * 
+ *         for level in range(d, self.maxlevels):
+ */
+    __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_tmpnode->next), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    if (__Pyx_SetItemInt(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, __pyx_t_2, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  }
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":152
+ *             prevnode.next[level] = tmpnode.next[level]
+ * 
+ *         for level in range(d, self.maxlevels):             # <<<<<<<<<<<<<<
+ *             tmpnode = chain[level]
+ *             tmpnode.width[level] -= 1
+ */
+  __pyx_t_4 = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels;
+  for (__pyx_t_7 = __pyx_v_d; __pyx_t_7 < __pyx_t_4; __pyx_t_7+=1) {
+    __pyx_v_level = __pyx_t_7;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":153
+ * 
+ *         for level in range(d, self.maxlevels):
+ *             tmpnode = chain[level]             # <<<<<<<<<<<<<<
+ *             tmpnode.width[level] -= 1
+ * 
+ */
+    __pyx_t_2 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_chain), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7tseries_Node))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_tmpnode));
+    __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_2);
+    __pyx_t_2 = 0;
+
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":154
+ *         for level in range(d, self.maxlevels):
+ *             tmpnode = chain[level]
+ *             tmpnode.width[level] -= 1             # <<<<<<<<<<<<<<
+ * 
+ *         self.size -= 1
+ */
+    (__pyx_v_tmpnode->width[__pyx_v_level]) -= 1;
   }
 
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":156
+ *             tmpnode.width[level] -= 1
+ * 
+ *         self.size -= 1             # <<<<<<<<<<<<<<
+ */
+  ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->size -= 1;
+
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
-    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_sum_noncontig");
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_AddTraceback("tseries.IndexableSkiplist.remove");
   __pyx_r = NULL;
-  goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __pyx_L2:;
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_DECREF((PyObject *)__pyx_v_output);
+  __Pyx_DECREF((PyObject *)__pyx_v_node);
+  __Pyx_DECREF((PyObject *)__pyx_v_prevnode);
+  __Pyx_DECREF((PyObject *)__pyx_v_tmpnode);
+  __Pyx_DECREF((PyObject *)__pyx_v_next_at_level);
+  __Pyx_DECREF(__pyx_v_chain);
+  __Pyx_DECREF((PyObject *)__pyx_v_self);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":86
- * # Rolling mean
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":12
+ * # Rolling sum
  * 
- * cdef void _roll_mean(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
+ * cdef void _roll_sum(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
  *                     int win, int minp, int N):
  *     cdef double val, prev, sum_x = 0
  */
 
-static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_win, int __pyx_v_minp, int __pyx_v_N) {
+static  void __pyx_f_7tseries__roll_sum(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_win, int __pyx_v_minp, int __pyx_v_N) {
   double __pyx_v_val;
   double __pyx_v_prev;
   double __pyx_v_sum_x;
@@ -6002,10 +6788,10 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
   int __pyx_t_1;
   long __pyx_t_2;
   int __pyx_t_3;
-  __Pyx_RefNannySetupContext("_roll_mean");
+  __Pyx_RefNannySetupContext("_roll_sum");
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":88
- * cdef void _roll_mean(double_t *input, double_t *output,
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":14
+ * cdef void _roll_sum(double_t *input, double_t *output,
  *                     int win, int minp, int N):
  *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
  *     cdef int nobs = 0, i
@@ -6013,7 +6799,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
   __pyx_v_sum_x = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":89
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":15
  *                     int win, int minp, int N):
  *     cdef double val, prev, sum_x = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -6022,7 +6808,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":91
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":17
  *     cdef int nobs = 0, i
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -6032,7 +6818,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":92
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":18
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -6044,7 +6830,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
   }
   __pyx_L3:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":94
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":20
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -6054,7 +6840,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_2 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":95
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":21
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -6063,7 +6849,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
     __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":98
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":24
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -6073,7 +6859,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":99
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":25
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -6082,7 +6868,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":100
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":26
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -6094,7 +6880,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L6:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":102
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":28
  *             sum_x += val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -6104,7 +6890,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
     (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":104
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":30
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -6114,7 +6900,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_3 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":105
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":31
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -6123,7 +6909,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
     __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":107
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":33
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -6133,7 +6919,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":108
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":34
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -6142,7 +6928,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_prev = (__pyx_v_input[(__pyx_v_i - __pyx_v_win)]);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":109
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":35
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -6152,7 +6938,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
       __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_1) {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":110
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":36
  *             prev = input[i - win]
  *             if prev == prev:
  *                 sum_x -= prev             # <<<<<<<<<<<<<<
@@ -6161,7 +6947,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_sum_x -= __pyx_v_prev;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":111
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":37
  *             if prev == prev:
  *                 sum_x -= prev
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -6176,7 +6962,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L9:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":113
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":39
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -6186,7 +6972,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":114
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":40
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -6195,7 +6981,7 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":115
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":41
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -6207,61 +6993,53 @@ static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L11:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":117
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":43
  *             sum_x += val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
- *             output[i] = sum_x / nobs
+ *             output[i] = sum_x
  *         else:
  */
     __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":118
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":44
  * 
  *         if nobs >= minp:
- *             output[i] = sum_x / nobs             # <<<<<<<<<<<<<<
+ *             output[i] = sum_x             # <<<<<<<<<<<<<<
  *         else:
  *             output[i] = NaN
  */
-      if (unlikely(__pyx_v_nobs == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      (__pyx_v_output[__pyx_v_i]) = (__pyx_v_sum_x / __pyx_v_nobs);
+      (__pyx_v_output[__pyx_v_i]) = __pyx_v_sum_x;
       goto __pyx_L12;
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":120
- *             output[i] = sum_x / nobs
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":46
+ *             output[i] = sum_x
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
  * 
- * def _roll_mean_noncontig(ndarray[double_t, ndim=1] input,
+ * def _roll_sum_noncontig(ndarray[double_t, ndim=1] input,
  */
       (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
     }
     __pyx_L12:;
   }
 
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_WriteUnraisable("tseries._roll_mean");
-  __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":122
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":48
  *             output[i] = NaN
  * 
- * def _roll_mean_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *                          ndarray[double_t, ndim=1] output,
- *                          int win, int minp, int N):
+ * def _roll_sum_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *                         ndarray[double_t, ndim=1] output,
+ *                         int win, int minp, int N):
  */
 
-static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__roll_sum_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_sum_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   PyArrayObject *__pyx_v_output = 0;
   int __pyx_v_win;
@@ -6290,7 +7068,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
   int __pyx_t_9;
   int __pyx_t_10;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__output,&__pyx_n_s__win,&__pyx_n_s__minp,&__pyx_n_s__N,0};
-  __Pyx_RefNannySetupContext("_roll_mean_noncontig");
+  __Pyx_RefNannySetupContext("_roll_sum_noncontig");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -6313,81 +7091,81 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  4:
       values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
       if (likely(values[4])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_mean_noncontig") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_sum_noncontig") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_output = ((PyArrayObject *)values[1]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
     __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_sum_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_mean_noncontig");
+  __Pyx_AddTraceback("tseries._roll_sum_noncontig");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __Pyx_INCREF((PyObject *)__pyx_v_output);
   __pyx_bstruct_input.buf = NULL;
   __pyx_bstruct_output.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
   __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":125
- *                          ndarray[double_t, ndim=1] output,
- *                          int win, int minp, int N):
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":51
+ *                         ndarray[double_t, ndim=1] output,
+ *                         int win, int minp, int N):
  *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
  *     cdef int nobs = 0, i
  * 
  */
   __pyx_v_sum_x = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":126
- *                          int win, int minp, int N):
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":52
+ *                         int win, int minp, int N):
  *     cdef double val, prev, sum_x = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
  * 
@@ -6395,7 +7173,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":128
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":54
  *     cdef int nobs = 0, i
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -6405,7 +7183,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
   __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":129
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":55
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -6417,7 +7195,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":131
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":57
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -6427,7 +7205,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
   __pyx_t_2 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":132
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":58
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -6442,11 +7220,11 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     } else if (unlikely(__pyx_t_3 >= __pyx_bshape_0_input)) __pyx_t_4 = 0;
     if (unlikely(__pyx_t_4 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_4);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_3, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":135
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":61
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -6456,7 +7234,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":136
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":62
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -6465,7 +7243,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":137
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":63
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -6477,7 +7255,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     }
     __pyx_L9:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":139
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":65
  *             sum_x += val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -6492,12 +7270,12 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_5 = 0;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":141
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":67
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -6507,7 +7285,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
   __pyx_t_5 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_5; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":142
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":68
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -6522,11 +7300,11 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_input)) __pyx_t_7 = 0;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":144
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":70
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -6536,7 +7314,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":145
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":71
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -6551,11 +7329,11 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
       } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_8 = 0;
       if (unlikely(__pyx_t_8 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_8);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":146
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":72
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -6565,7 +7343,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
       __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_1) {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":147
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":73
  *             prev = input[i - win]
  *             if prev == prev:
  *                 sum_x -= prev             # <<<<<<<<<<<<<<
@@ -6574,7 +7352,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
  */
         __pyx_v_sum_x -= __pyx_v_prev;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":148
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":74
  *             if prev == prev:
  *                 sum_x -= prev
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -6589,7 +7367,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     }
     __pyx_L12:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":150
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":76
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -6599,7 +7377,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":151
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":77
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -6608,7 +7386,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":152
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":78
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -6620,27 +7398,23 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     }
     __pyx_L14:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":154
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":80
  *             sum_x += val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
- *             output[i] = sum_x / nobs
+ *             output[i] = sum_x
  *         else:
  */
     __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":155
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":81
  * 
  *         if nobs >= minp:
- *             output[i] = sum_x / nobs             # <<<<<<<<<<<<<<
+ *             output[i] = sum_x             # <<<<<<<<<<<<<<
  *         else:
  *             output[i] = NaN
  */
-      if (unlikely(__pyx_v_nobs == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
       __pyx_t_8 = __pyx_v_i;
       __pyx_t_9 = -1;
       if (__pyx_t_8 < 0) {
@@ -6649,15 +7423,15 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
       } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
       if (unlikely(__pyx_t_9 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_9);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = (__pyx_v_sum_x / __pyx_v_nobs);
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = __pyx_v_sum_x;
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":157
- *             output[i] = sum_x / nobs
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":83
+ *             output[i] = sum_x
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
  * 
@@ -6671,7 +7445,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
       } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_output)) __pyx_t_10 = 0;
       if (unlikely(__pyx_t_10 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_10);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_9, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
@@ -6686,7 +7460,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_mean_noncontig");
+  __Pyx_AddTraceback("tseries._roll_sum_noncontig");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
@@ -6700,237 +7474,292 @@ static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, Py
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":162
- * # Exponentially weighted moving average
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":88
+ * # Rolling mean
  * 
- * cdef void _ewma(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
- *                       int com, int N):
- *     cdef double cur, prev, neww, oldw, adj
+ * cdef void _roll_mean(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
+ *                     int win, int minp, int N):
+ *     cdef double val, prev, sum_x = 0
  */
 
-static  void __pyx_f_7tseries__ewma(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_com, int __pyx_v_N) {
-  double __pyx_v_cur;
+static  void __pyx_f_7tseries__roll_mean(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_win, int __pyx_v_minp, int __pyx_v_N) {
+  double __pyx_v_val;
   double __pyx_v_prev;
-  double __pyx_v_neww;
-  double __pyx_v_oldw;
-  double __pyx_v_adj;
+  double __pyx_v_sum_x;
+  int __pyx_v_nobs;
   int __pyx_v_i;
-  double __pyx_t_1;
-  int __pyx_t_2;
+  int __pyx_t_1;
+  long __pyx_t_2;
   int __pyx_t_3;
-  __pyx_t_5numpy_double_t __pyx_t_4;
-  __Pyx_RefNannySetupContext("_ewma");
+  __Pyx_RefNannySetupContext("_roll_mean");
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":167
- *     cdef int i
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":90
+ * cdef void _roll_mean(double_t *input, double_t *output,
+ *                     int win, int minp, int N):
+ *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
+ *     cdef int nobs = 0, i
  * 
- *     neww = 1. / (1. + com)             # <<<<<<<<<<<<<<
- *     oldw = 1. - neww
- *     adj = oldw
  */
-  __pyx_t_1 = (1.0 + __pyx_v_com);
-  if (unlikely(__pyx_t_1 == 0)) {
-    PyErr_Format(PyExc_ZeroDivisionError, "float division");
-    {__pyx_filename = __pyx_f[1]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_v_neww = (1.0 / __pyx_t_1);
+  __pyx_v_sum_x = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":168
- * 
- *     neww = 1. / (1. + com)
- *     oldw = 1. - neww             # <<<<<<<<<<<<<<
- *     adj = oldw
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":91
+ *                     int win, int minp, int N):
+ *     cdef double val, prev, sum_x = 0
+ *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
  * 
+ *     if minp > N:
  */
-  __pyx_v_oldw = (1.0 - __pyx_v_neww);
+  __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":169
- *     neww = 1. / (1. + com)
- *     oldw = 1. - neww
- *     adj = oldw             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":93
+ *     cdef int nobs = 0, i
+ * 
+ *     if minp > N:             # <<<<<<<<<<<<<<
+ *         minp = N + 1
  * 
- *     output[0] = neww * input[0]
  */
-  __pyx_v_adj = __pyx_v_oldw;
+  __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
+  if (__pyx_t_1) {
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":171
- *     adj = oldw
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":94
  * 
- *     output[0] = neww * input[0]             # <<<<<<<<<<<<<<
+ *     if minp > N:
+ *         minp = N + 1             # <<<<<<<<<<<<<<
  * 
- *     for i from 1 <= i < N:
+ *     for i from 0 <= i < minp - 1:
  */
-  (__pyx_v_output[0]) = (__pyx_v_neww * (__pyx_v_input[0]));
+    __pyx_v_minp = (__pyx_v_N + 1);
+    goto __pyx_L3;
+  }
+  __pyx_L3:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":173
- *     output[0] = neww * input[0]
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":96
+ *         minp = N + 1
+ * 
+ *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
+ *         val = input[i]
  * 
- *     for i from 1 <= i < N:             # <<<<<<<<<<<<<<
- *         cur = input[i]
- *         prev = output[i - 1]
  */
-  __pyx_t_2 = __pyx_v_N;
-  for (__pyx_v_i = 1; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
+  __pyx_t_2 = (__pyx_v_minp - 1);
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":174
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":97
  * 
- *     for i from 1 <= i < N:
- *         cur = input[i]             # <<<<<<<<<<<<<<
- *         prev = output[i - 1]
+ *     for i from 0 <= i < minp - 1:
+ *         val = input[i]             # <<<<<<<<<<<<<<
  * 
+ *         # Not NaN
  */
-    __pyx_v_cur = (__pyx_v_input[__pyx_v_i]);
+    __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":175
- *     for i from 1 <= i < N:
- *         cur = input[i]
- *         prev = output[i - 1]             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":100
  * 
- *         if cur == cur:
+ *         # Not NaN
+ *         if val == val:             # <<<<<<<<<<<<<<
+ *             nobs += 1
+ *             sum_x += val
  */
-    __pyx_v_prev = (__pyx_v_output[(__pyx_v_i - 1)]);
+    __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
+    if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":177
- *         prev = output[i - 1]
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":101
+ *         # Not NaN
+ *         if val == val:
+ *             nobs += 1             # <<<<<<<<<<<<<<
+ *             sum_x += val
  * 
- *         if cur == cur:             # <<<<<<<<<<<<<<
- *             if prev == prev:
- *                 output[i] = oldw * prev + neww * cur
  */
-    __pyx_t_3 = (__pyx_v_cur == __pyx_v_cur);
-    if (__pyx_t_3) {
+      __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":178
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":102
+ *         if val == val:
+ *             nobs += 1
+ *             sum_x += val             # <<<<<<<<<<<<<<
  * 
- *         if cur == cur:
- *             if prev == prev:             # <<<<<<<<<<<<<<
- *                 output[i] = oldw * prev + neww * cur
- *             else:
- */
-      __pyx_t_3 = (__pyx_v_prev == __pyx_v_prev);
-      if (__pyx_t_3) {
-
-        /* "H:\pandas\pandas\lib\src\moments.pyx":179
- *         if cur == cur:
- *             if prev == prev:
- *                 output[i] = oldw * prev + neww * cur             # <<<<<<<<<<<<<<
- *             else:
- *                 output[i] = neww * cur
- */
-        (__pyx_v_output[__pyx_v_i]) = ((__pyx_v_oldw * __pyx_v_prev) + (__pyx_v_neww * __pyx_v_cur));
-        goto __pyx_L6;
-      }
-      /*else*/ {
-
-        /* "H:\pandas\pandas\lib\src\moments.pyx":181
- *                 output[i] = oldw * prev + neww * cur
- *             else:
- *                 output[i] = neww * cur             # <<<<<<<<<<<<<<
- *         else:
- *             output[i] = prev
+ *         output[i] = NaN
  */
-        (__pyx_v_output[__pyx_v_i]) = (__pyx_v_neww * __pyx_v_cur);
-      }
-      __pyx_L6:;
-      goto __pyx_L5;
+      __pyx_v_sum_x += __pyx_v_val;
+      goto __pyx_L6;
     }
-    /*else*/ {
+    __pyx_L6:;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":183
- *                 output[i] = neww * cur
- *         else:
- *             output[i] = prev             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":104
+ *             sum_x += val
  * 
- *     for i from 0 <= i < N:
+ *         output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ *     for i from minp - 1 <= i < N:
  */
-      (__pyx_v_output[__pyx_v_i]) = __pyx_v_prev;
-    }
-    __pyx_L5:;
+    (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":185
- *             output[i] = prev
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":106
+ *         output[i] = NaN
+ * 
+ *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         val = input[i]
  * 
- *     for i from 0 <= i < N:             # <<<<<<<<<<<<<<
- *         cur = input[i]
- *         output[i] = output[i] / (1. - adj)
  */
-  __pyx_t_2 = __pyx_v_N;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
+  __pyx_t_3 = __pyx_v_N;
+  for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":186
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":107
  * 
- *     for i from 0 <= i < N:
- *         cur = input[i]             # <<<<<<<<<<<<<<
- *         output[i] = output[i] / (1. - adj)
+ *     for i from minp - 1 <= i < N:
+ *         val = input[i]             # <<<<<<<<<<<<<<
  * 
+ *         if i > win - 1:
  */
-    __pyx_v_cur = (__pyx_v_input[__pyx_v_i]);
+    __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":187
- *     for i from 0 <= i < N:
- *         cur = input[i]
- *         output[i] = output[i] / (1. - adj)             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":109
+ *         val = input[i]
  * 
- *         if cur == cur:
+ *         if i > win - 1:             # <<<<<<<<<<<<<<
+ *             prev = input[i - win]
+ *             if prev == prev:
  */
-    __pyx_t_4 = (__pyx_v_output[__pyx_v_i]);
-    __pyx_t_1 = (1.0 - __pyx_v_adj);
-    if (unlikely(__pyx_t_1 == 0)) {
-      PyErr_Format(PyExc_ZeroDivisionError, "float division");
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    (__pyx_v_output[__pyx_v_i]) = (__pyx_t_4 / __pyx_t_1);
+    __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
+    if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":189
- *         output[i] = output[i] / (1. - adj)
- * 
- *         if cur == cur:             # <<<<<<<<<<<<<<
- *             adj *= oldw
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":110
  * 
+ *         if i > win - 1:
+ *             prev = input[i - win]             # <<<<<<<<<<<<<<
+ *             if prev == prev:
+ *                 sum_x -= prev
  */
-    __pyx_t_3 = (__pyx_v_cur == __pyx_v_cur);
-    if (__pyx_t_3) {
+      __pyx_v_prev = (__pyx_v_input[(__pyx_v_i - __pyx_v_win)]);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":190
- * 
- *         if cur == cur:
- *             adj *= oldw             # <<<<<<<<<<<<<<
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":111
+ *         if i > win - 1:
+ *             prev = input[i - win]
+ *             if prev == prev:             # <<<<<<<<<<<<<<
+ *                 sum_x -= prev
+ *                 nobs -= 1
+ */
+      __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
+      if (__pyx_t_1) {
+
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":112
+ *             prev = input[i - win]
+ *             if prev == prev:
+ *                 sum_x -= prev             # <<<<<<<<<<<<<<
+ *                 nobs -= 1
  * 
- * def _ewma_noncontig(ndarray[double_t, ndim=1] input,
  */
-      __pyx_v_adj *= __pyx_v_oldw;
-      goto __pyx_L9;
-    }
-    __pyx_L9:;
-  }
+        __pyx_v_sum_x -= __pyx_v_prev;
+
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":113
+ *             if prev == prev:
+ *                 sum_x -= prev
+ *                 nobs -= 1             # <<<<<<<<<<<<<<
+ * 
+ *         if val == val:
+ */
+        __pyx_v_nobs -= 1;
+        goto __pyx_L10;
+      }
+      __pyx_L10:;
+      goto __pyx_L9;
+    }
+    __pyx_L9:;
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":115
+ *                 nobs -= 1
+ * 
+ *         if val == val:             # <<<<<<<<<<<<<<
+ *             nobs += 1
+ *             sum_x += val
+ */
+    __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
+    if (__pyx_t_1) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":116
+ * 
+ *         if val == val:
+ *             nobs += 1             # <<<<<<<<<<<<<<
+ *             sum_x += val
+ * 
+ */
+      __pyx_v_nobs += 1;
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":117
+ *         if val == val:
+ *             nobs += 1
+ *             sum_x += val             # <<<<<<<<<<<<<<
+ * 
+ *         if nobs >= minp:
+ */
+      __pyx_v_sum_x += __pyx_v_val;
+      goto __pyx_L11;
+    }
+    __pyx_L11:;
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":119
+ *             sum_x += val
+ * 
+ *         if nobs >= minp:             # <<<<<<<<<<<<<<
+ *             output[i] = sum_x / nobs
+ *         else:
+ */
+    __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
+    if (__pyx_t_1) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":120
+ * 
+ *         if nobs >= minp:
+ *             output[i] = sum_x / nobs             # <<<<<<<<<<<<<<
+ *         else:
+ *             output[i] = NaN
+ */
+      if (unlikely(__pyx_v_nobs == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      (__pyx_v_output[__pyx_v_i]) = (__pyx_v_sum_x / __pyx_v_nobs);
+      goto __pyx_L12;
+    }
+    /*else*/ {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":122
+ *             output[i] = sum_x / nobs
+ *         else:
+ *             output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ * def _roll_mean_noncontig(ndarray[double_t, ndim=1] input,
+ */
+      (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
+    }
+    __pyx_L12:;
+  }
 
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_WriteUnraisable("tseries._ewma");
+  __Pyx_WriteUnraisable("tseries._roll_mean");
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":192
- *             adj *= oldw
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":124
+ *             output[i] = NaN
  * 
- * def _ewma_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *                           ndarray[double_t, ndim=1] output,
- *                           int com, int N):
+ * def _roll_mean_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *                          ndarray[double_t, ndim=1] output,
+ *                          int win, int minp, int N):
  */
 
-static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_mean_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   PyArrayObject *__pyx_v_output = 0;
-  int __pyx_v_com;
+  int __pyx_v_win;
+  int __pyx_v_minp;
   int __pyx_v_N;
-  double __pyx_v_cur;
+  double __pyx_v_val;
   double __pyx_v_prev;
-  double __pyx_v_neww;
-  double __pyx_v_oldw;
-  double __pyx_v_adj;
+  double __pyx_v_sum_x;
+  int __pyx_v_nobs;
   int __pyx_v_i;
   Py_buffer __pyx_bstruct_output;
   Py_ssize_t __pyx_bstride_0_output = 0;
@@ -6939,28 +7768,24 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
   Py_ssize_t __pyx_bstride_0_input = 0;
   Py_ssize_t __pyx_bshape_0_input = 0;
   PyObject *__pyx_r = NULL;
-  double __pyx_t_1;
+  int __pyx_t_1;
   long __pyx_t_2;
   int __pyx_t_3;
-  long __pyx_t_4;
+  int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_t_6;
-  long __pyx_t_7;
+  int __pyx_t_7;
   int __pyx_t_8;
   int __pyx_t_9;
   int __pyx_t_10;
-  int __pyx_t_11;
-  int __pyx_t_12;
-  int __pyx_t_13;
-  __pyx_t_5numpy_double_t __pyx_t_14;
-  int __pyx_t_15;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__output,&__pyx_n_s__com,&__pyx_n_s__N,0};
-  __Pyx_RefNannySetupContext("_ewma_noncontig");
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__output,&__pyx_n_s__win,&__pyx_n_s__minp,&__pyx_n_s__N,0};
+  __Pyx_RefNannySetupContext("_roll_mean_noncontig");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[4] = {0,0,0,0};
+    PyObject* values[5] = {0,0,0,0,0};
     switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
@@ -6977,182 +7802,846 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_ewma_noncontig", 1, 4, 4, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__com);
+      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_ewma_noncontig", 1, 4, 4, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
-      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
+      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_ewma_noncontig", 1, 4, 4, 3); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+      case  4:
+      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
+      if (likely(values[4])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_ewma_noncontig") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_mean_noncontig") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_output = ((PyArrayObject *)values[1]);
-    __pyx_v_com = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
     __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_com = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_ewma_noncontig", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_mean_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._ewma_noncontig");
+  __Pyx_AddTraceback("tseries._roll_mean_noncontig");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __Pyx_INCREF((PyObject *)__pyx_v_output);
   __pyx_bstruct_input.buf = NULL;
   __pyx_bstruct_output.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
   __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":198
- *     cdef int i
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":127
+ *                          ndarray[double_t, ndim=1] output,
+ *                          int win, int minp, int N):
+ *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
+ *     cdef int nobs = 0, i
  * 
- *     neww = 1. / (1. + com)             # <<<<<<<<<<<<<<
- *     oldw = 1. - neww
- *     adj = oldw
  */
-  __pyx_t_1 = (1.0 + __pyx_v_com);
-  if (unlikely(__pyx_t_1 == 0)) {
-    PyErr_Format(PyExc_ZeroDivisionError, "float division");
-    {__pyx_filename = __pyx_f[1]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_v_neww = (1.0 / __pyx_t_1);
+  __pyx_v_sum_x = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":199
- * 
- *     neww = 1. / (1. + com)
- *     oldw = 1. - neww             # <<<<<<<<<<<<<<
- *     adj = oldw
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":128
+ *                          int win, int minp, int N):
+ *     cdef double val, prev, sum_x = 0
+ *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
  * 
+ *     if minp > N:
  */
-  __pyx_v_oldw = (1.0 - __pyx_v_neww);
+  __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":200
- *     neww = 1. / (1. + com)
- *     oldw = 1. - neww
- *     adj = oldw             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":130
+ *     cdef int nobs = 0, i
+ * 
+ *     if minp > N:             # <<<<<<<<<<<<<<
+ *         minp = N + 1
  * 
- *     output[0] = neww * input[0]
  */
-  __pyx_v_adj = __pyx_v_oldw;
+  __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
+  if (__pyx_t_1) {
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":202
- *     adj = oldw
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":131
  * 
- *     output[0] = neww * input[0]             # <<<<<<<<<<<<<<
+ *     if minp > N:
+ *         minp = N + 1             # <<<<<<<<<<<<<<
  * 
- *     for i from 1 <= i < N:
+ *     for i from 0 <= i < minp - 1:
  */
-  __pyx_t_2 = 0;
-  __pyx_t_3 = -1;
-  if (__pyx_t_2 < 0) {
-    __pyx_t_2 += __pyx_bshape_0_input;
-    if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
-  } else if (unlikely(__pyx_t_2 >= __pyx_bshape_0_input)) __pyx_t_3 = 0;
-  if (unlikely(__pyx_t_3 != -1)) {
-    __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    {__pyx_filename = __pyx_f[1]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_t_4 = 0;
-  __pyx_t_3 = -1;
-  if (__pyx_t_4 < 0) {
-    __pyx_t_4 += __pyx_bshape_0_output;
-    if (unlikely(__pyx_t_4 < 0)) __pyx_t_3 = 0;
-  } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_3 = 0;
-  if (unlikely(__pyx_t_3 != -1)) {
-    __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    {__pyx_filename = __pyx_f[1]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_v_minp = (__pyx_v_N + 1);
+    goto __pyx_L6;
   }
-  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = (__pyx_v_neww * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_2, __pyx_bstride_0_input)));
+  __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":204
- *     output[0] = neww * input[0]
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":133
+ *         minp = N + 1
+ * 
+ *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
+ *         val = input[i]
  * 
- *     for i from 1 <= i < N:             # <<<<<<<<<<<<<<
- *         cur = input[i]
- *         prev = output[i - 1]
  */
-  __pyx_t_3 = __pyx_v_N;
-  for (__pyx_v_i = 1; __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
+  __pyx_t_2 = (__pyx_v_minp - 1);
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":205
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":134
  * 
- *     for i from 1 <= i < N:
- *         cur = input[i]             # <<<<<<<<<<<<<<
- *         prev = output[i - 1]
+ *     for i from 0 <= i < minp - 1:
+ *         val = input[i]             # <<<<<<<<<<<<<<
  * 
+ *         # Not NaN
  */
-    __pyx_t_5 = __pyx_v_i;
-    __pyx_t_6 = -1;
-    if (__pyx_t_5 < 0) {
-      __pyx_t_5 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_5 < 0)) __pyx_t_6 = 0;
-    } else if (unlikely(__pyx_t_5 >= __pyx_bshape_0_input)) __pyx_t_6 = 0;
-    if (unlikely(__pyx_t_6 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_6);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __pyx_v_i;
+    __pyx_t_4 = -1;
+    if (__pyx_t_3 < 0) {
+      __pyx_t_3 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
+    } else if (unlikely(__pyx_t_3 >= __pyx_bshape_0_input)) __pyx_t_4 = 0;
+    if (unlikely(__pyx_t_4 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_4);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    __pyx_v_cur = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_5, __pyx_bstride_0_input));
+    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_3, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":206
- *     for i from 1 <= i < N:
- *         cur = input[i]
- *         prev = output[i - 1]             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":137
  * 
- *         if cur == cur:
+ *         # Not NaN
+ *         if val == val:             # <<<<<<<<<<<<<<
+ *             nobs += 1
+ *             sum_x += val
  */
-    __pyx_t_7 = (__pyx_v_i - 1);
-    __pyx_t_6 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_6 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_output)) __pyx_t_6 = 0;
-    if (unlikely(__pyx_t_6 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_6);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_7, __pyx_bstride_0_output));
+    __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
+    if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":208
- *         prev = output[i - 1]
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":138
+ *         # Not NaN
+ *         if val == val:
+ *             nobs += 1             # <<<<<<<<<<<<<<
+ *             sum_x += val
  * 
- *         if cur == cur:             # <<<<<<<<<<<<<<
- *             if prev == prev:
+ */
+      __pyx_v_nobs += 1;
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":139
+ *         if val == val:
+ *             nobs += 1
+ *             sum_x += val             # <<<<<<<<<<<<<<
+ * 
+ *         output[i] = NaN
+ */
+      __pyx_v_sum_x += __pyx_v_val;
+      goto __pyx_L9;
+    }
+    __pyx_L9:;
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":141
+ *             sum_x += val
+ * 
+ *         output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ *     for i from minp - 1 <= i < N:
+ */
+    __pyx_t_4 = __pyx_v_i;
+    __pyx_t_5 = -1;
+    if (__pyx_t_4 < 0) {
+      __pyx_t_4 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_4 < 0)) __pyx_t_5 = 0;
+    } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_5 = 0;
+    if (unlikely(__pyx_t_5 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_5);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
+  }
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":143
+ *         output[i] = NaN
+ * 
+ *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         val = input[i]
+ * 
+ */
+  __pyx_t_5 = __pyx_v_N;
+  for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_5; __pyx_v_i++) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":144
+ * 
+ *     for i from minp - 1 <= i < N:
+ *         val = input[i]             # <<<<<<<<<<<<<<
+ * 
+ *         if i > win - 1:
+ */
+    __pyx_t_6 = __pyx_v_i;
+    __pyx_t_7 = -1;
+    if (__pyx_t_6 < 0) {
+      __pyx_t_6 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_6 < 0)) __pyx_t_7 = 0;
+    } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_input)) __pyx_t_7 = 0;
+    if (unlikely(__pyx_t_7 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_7);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input));
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":146
+ *         val = input[i]
+ * 
+ *         if i > win - 1:             # <<<<<<<<<<<<<<
+ *             prev = input[i - win]
+ *             if prev == prev:
+ */
+    __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
+    if (__pyx_t_1) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":147
+ * 
+ *         if i > win - 1:
+ *             prev = input[i - win]             # <<<<<<<<<<<<<<
+ *             if prev == prev:
+ *                 sum_x -= prev
+ */
+      __pyx_t_7 = (__pyx_v_i - __pyx_v_win);
+      __pyx_t_8 = -1;
+      if (__pyx_t_7 < 0) {
+        __pyx_t_7 += __pyx_bshape_0_input;
+        if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
+      } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_8 = 0;
+      if (unlikely(__pyx_t_8 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_8);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":148
+ *         if i > win - 1:
+ *             prev = input[i - win]
+ *             if prev == prev:             # <<<<<<<<<<<<<<
+ *                 sum_x -= prev
+ *                 nobs -= 1
+ */
+      __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
+      if (__pyx_t_1) {
+
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":149
+ *             prev = input[i - win]
+ *             if prev == prev:
+ *                 sum_x -= prev             # <<<<<<<<<<<<<<
+ *                 nobs -= 1
+ * 
+ */
+        __pyx_v_sum_x -= __pyx_v_prev;
+
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":150
+ *             if prev == prev:
+ *                 sum_x -= prev
+ *                 nobs -= 1             # <<<<<<<<<<<<<<
+ * 
+ *         if val == val:
+ */
+        __pyx_v_nobs -= 1;
+        goto __pyx_L13;
+      }
+      __pyx_L13:;
+      goto __pyx_L12;
+    }
+    __pyx_L12:;
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":152
+ *                 nobs -= 1
+ * 
+ *         if val == val:             # <<<<<<<<<<<<<<
+ *             nobs += 1
+ *             sum_x += val
+ */
+    __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
+    if (__pyx_t_1) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":153
+ * 
+ *         if val == val:
+ *             nobs += 1             # <<<<<<<<<<<<<<
+ *             sum_x += val
+ * 
+ */
+      __pyx_v_nobs += 1;
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":154
+ *         if val == val:
+ *             nobs += 1
+ *             sum_x += val             # <<<<<<<<<<<<<<
+ * 
+ *         if nobs >= minp:
+ */
+      __pyx_v_sum_x += __pyx_v_val;
+      goto __pyx_L14;
+    }
+    __pyx_L14:;
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":156
+ *             sum_x += val
+ * 
+ *         if nobs >= minp:             # <<<<<<<<<<<<<<
+ *             output[i] = sum_x / nobs
+ *         else:
+ */
+    __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
+    if (__pyx_t_1) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":157
+ * 
+ *         if nobs >= minp:
+ *             output[i] = sum_x / nobs             # <<<<<<<<<<<<<<
+ *         else:
+ *             output[i] = NaN
+ */
+      if (unlikely(__pyx_v_nobs == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_t_8 = __pyx_v_i;
+      __pyx_t_9 = -1;
+      if (__pyx_t_8 < 0) {
+        __pyx_t_8 += __pyx_bshape_0_output;
+        if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+      } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
+      if (unlikely(__pyx_t_9 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_9);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = (__pyx_v_sum_x / __pyx_v_nobs);
+      goto __pyx_L15;
+    }
+    /*else*/ {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":159
+ *             output[i] = sum_x / nobs
+ *         else:
+ *             output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ * #-------------------------------------------------------------------------------
+ */
+      __pyx_t_9 = __pyx_v_i;
+      __pyx_t_10 = -1;
+      if (__pyx_t_9 < 0) {
+        __pyx_t_9 += __pyx_bshape_0_output;
+        if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
+      } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_output)) __pyx_t_10 = 0;
+      if (unlikely(__pyx_t_10 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_10);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_9, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
+    }
+    __pyx_L15:;
+  }
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
+  __Pyx_AddTraceback("tseries._roll_mean_noncontig");
+  __pyx_r = NULL;
+  goto __pyx_L2;
+  __pyx_L0:;
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __pyx_L2:;
+  __Pyx_DECREF((PyObject *)__pyx_v_input);
+  __Pyx_DECREF((PyObject *)__pyx_v_output);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":164
+ * # Exponentially weighted moving average
+ * 
+ * cdef void _ewma(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
+ *                       int com, int N):
+ *     cdef double cur, prev, neww, oldw, adj
+ */
+
+static  void __pyx_f_7tseries__ewma(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_com, int __pyx_v_N) {
+  double __pyx_v_cur;
+  double __pyx_v_prev;
+  double __pyx_v_neww;
+  double __pyx_v_oldw;
+  double __pyx_v_adj;
+  int __pyx_v_i;
+  double __pyx_t_1;
+  int __pyx_t_2;
+  int __pyx_t_3;
+  __pyx_t_5numpy_double_t __pyx_t_4;
+  __Pyx_RefNannySetupContext("_ewma");
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":169
+ *     cdef int i
+ * 
+ *     neww = 1. / (1. + com)             # <<<<<<<<<<<<<<
+ *     oldw = 1. - neww
+ *     adj = oldw
+ */
+  __pyx_t_1 = (1.0 + __pyx_v_com);
+  if (unlikely(__pyx_t_1 == 0)) {
+    PyErr_Format(PyExc_ZeroDivisionError, "float division");
+    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_v_neww = (1.0 / __pyx_t_1);
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":170
+ * 
+ *     neww = 1. / (1. + com)
+ *     oldw = 1. - neww             # <<<<<<<<<<<<<<
+ *     adj = oldw
+ * 
+ */
+  __pyx_v_oldw = (1.0 - __pyx_v_neww);
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":171
+ *     neww = 1. / (1. + com)
+ *     oldw = 1. - neww
+ *     adj = oldw             # <<<<<<<<<<<<<<
+ * 
+ *     output[0] = neww * input[0]
+ */
+  __pyx_v_adj = __pyx_v_oldw;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":173
+ *     adj = oldw
+ * 
+ *     output[0] = neww * input[0]             # <<<<<<<<<<<<<<
+ * 
+ *     for i from 1 <= i < N:
+ */
+  (__pyx_v_output[0]) = (__pyx_v_neww * (__pyx_v_input[0]));
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":175
+ *     output[0] = neww * input[0]
+ * 
+ *     for i from 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         cur = input[i]
+ *         prev = output[i - 1]
+ */
+  __pyx_t_2 = __pyx_v_N;
+  for (__pyx_v_i = 1; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":176
+ * 
+ *     for i from 1 <= i < N:
+ *         cur = input[i]             # <<<<<<<<<<<<<<
+ *         prev = output[i - 1]
+ * 
+ */
+    __pyx_v_cur = (__pyx_v_input[__pyx_v_i]);
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":177
+ *     for i from 1 <= i < N:
+ *         cur = input[i]
+ *         prev = output[i - 1]             # <<<<<<<<<<<<<<
+ * 
+ *         if cur == cur:
+ */
+    __pyx_v_prev = (__pyx_v_output[(__pyx_v_i - 1)]);
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":179
+ *         prev = output[i - 1]
+ * 
+ *         if cur == cur:             # <<<<<<<<<<<<<<
+ *             if prev == prev:
+ *                 output[i] = oldw * prev + neww * cur
+ */
+    __pyx_t_3 = (__pyx_v_cur == __pyx_v_cur);
+    if (__pyx_t_3) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":180
+ * 
+ *         if cur == cur:
+ *             if prev == prev:             # <<<<<<<<<<<<<<
+ *                 output[i] = oldw * prev + neww * cur
+ *             else:
+ */
+      __pyx_t_3 = (__pyx_v_prev == __pyx_v_prev);
+      if (__pyx_t_3) {
+
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":181
+ *         if cur == cur:
+ *             if prev == prev:
+ *                 output[i] = oldw * prev + neww * cur             # <<<<<<<<<<<<<<
+ *             else:
+ *                 output[i] = neww * cur
+ */
+        (__pyx_v_output[__pyx_v_i]) = ((__pyx_v_oldw * __pyx_v_prev) + (__pyx_v_neww * __pyx_v_cur));
+        goto __pyx_L6;
+      }
+      /*else*/ {
+
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":183
+ *                 output[i] = oldw * prev + neww * cur
+ *             else:
+ *                 output[i] = neww * cur             # <<<<<<<<<<<<<<
+ *         else:
+ *             output[i] = prev
+ */
+        (__pyx_v_output[__pyx_v_i]) = (__pyx_v_neww * __pyx_v_cur);
+      }
+      __pyx_L6:;
+      goto __pyx_L5;
+    }
+    /*else*/ {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":185
+ *                 output[i] = neww * cur
+ *         else:
+ *             output[i] = prev             # <<<<<<<<<<<<<<
+ * 
+ *     for i from 0 <= i < N:
+ */
+      (__pyx_v_output[__pyx_v_i]) = __pyx_v_prev;
+    }
+    __pyx_L5:;
+  }
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":187
+ *             output[i] = prev
+ * 
+ *     for i from 0 <= i < N:             # <<<<<<<<<<<<<<
+ *         cur = input[i]
+ *         output[i] = output[i] / (1. - adj)
+ */
+  __pyx_t_2 = __pyx_v_N;
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":188
+ * 
+ *     for i from 0 <= i < N:
+ *         cur = input[i]             # <<<<<<<<<<<<<<
+ *         output[i] = output[i] / (1. - adj)
+ * 
+ */
+    __pyx_v_cur = (__pyx_v_input[__pyx_v_i]);
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":189
+ *     for i from 0 <= i < N:
+ *         cur = input[i]
+ *         output[i] = output[i] / (1. - adj)             # <<<<<<<<<<<<<<
+ * 
+ *         if cur == cur:
+ */
+    __pyx_t_4 = (__pyx_v_output[__pyx_v_i]);
+    __pyx_t_1 = (1.0 - __pyx_v_adj);
+    if (unlikely(__pyx_t_1 == 0)) {
+      PyErr_Format(PyExc_ZeroDivisionError, "float division");
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    (__pyx_v_output[__pyx_v_i]) = (__pyx_t_4 / __pyx_t_1);
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":191
+ *         output[i] = output[i] / (1. - adj)
+ * 
+ *         if cur == cur:             # <<<<<<<<<<<<<<
+ *             adj *= oldw
+ * 
+ */
+    __pyx_t_3 = (__pyx_v_cur == __pyx_v_cur);
+    if (__pyx_t_3) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":192
+ * 
+ *         if cur == cur:
+ *             adj *= oldw             # <<<<<<<<<<<<<<
+ * 
+ * def _ewma_noncontig(ndarray[double_t, ndim=1] input,
+ */
+      __pyx_v_adj *= __pyx_v_oldw;
+      goto __pyx_L9;
+    }
+    __pyx_L9:;
+  }
+
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_WriteUnraisable("tseries._ewma");
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":194
+ *             adj *= oldw
+ * 
+ * def _ewma_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *                           ndarray[double_t, ndim=1] output,
+ *                           int com, int N):
+ */
+
+static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_input = 0;
+  PyArrayObject *__pyx_v_output = 0;
+  int __pyx_v_com;
+  int __pyx_v_N;
+  double __pyx_v_cur;
+  double __pyx_v_prev;
+  double __pyx_v_neww;
+  double __pyx_v_oldw;
+  double __pyx_v_adj;
+  int __pyx_v_i;
+  Py_buffer __pyx_bstruct_output;
+  Py_ssize_t __pyx_bstride_0_output = 0;
+  Py_ssize_t __pyx_bshape_0_output = 0;
+  Py_buffer __pyx_bstruct_input;
+  Py_ssize_t __pyx_bstride_0_input = 0;
+  Py_ssize_t __pyx_bshape_0_input = 0;
+  PyObject *__pyx_r = NULL;
+  double __pyx_t_1;
+  long __pyx_t_2;
+  int __pyx_t_3;
+  long __pyx_t_4;
+  int __pyx_t_5;
+  int __pyx_t_6;
+  long __pyx_t_7;
+  int __pyx_t_8;
+  int __pyx_t_9;
+  int __pyx_t_10;
+  int __pyx_t_11;
+  int __pyx_t_12;
+  int __pyx_t_13;
+  __pyx_t_5numpy_double_t __pyx_t_14;
+  int __pyx_t_15;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__output,&__pyx_n_s__com,&__pyx_n_s__N,0};
+  __Pyx_RefNannySetupContext("_ewma_noncontig");
+  __pyx_self = __pyx_self;
+  if (unlikely(__pyx_kwds)) {
+    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
+    PyObject* values[4] = {0,0,0,0};
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      case  0: break;
+      default: goto __pyx_L5_argtuple_error;
+    }
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  0:
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
+      if (likely(values[0])) kw_args--;
+      else goto __pyx_L5_argtuple_error;
+      case  1:
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
+      if (likely(values[1])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("_ewma_noncontig", 1, 4, 4, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+      case  2:
+      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__com);
+      if (likely(values[2])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("_ewma_noncontig", 1, 4, 4, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+      case  3:
+      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
+      if (likely(values[3])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("_ewma_noncontig", 1, 4, 4, 3); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+    }
+    if (unlikely(kw_args > 0)) {
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_ewma_noncontig") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    }
+    __pyx_v_input = ((PyArrayObject *)values[0]);
+    __pyx_v_output = ((PyArrayObject *)values[1]);
+    __pyx_v_com = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
+    goto __pyx_L5_argtuple_error;
+  } else {
+    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+    __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
+    __pyx_v_com = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("_ewma_noncontig", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries._ewma_noncontig");
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __Pyx_INCREF((PyObject *)__pyx_v_input);
+  __Pyx_INCREF((PyObject *)__pyx_v_output);
+  __pyx_bstruct_input.buf = NULL;
+  __pyx_bstruct_output.buf = NULL;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
+  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
+  __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":200
+ *     cdef int i
+ * 
+ *     neww = 1. / (1. + com)             # <<<<<<<<<<<<<<
+ *     oldw = 1. - neww
+ *     adj = oldw
+ */
+  __pyx_t_1 = (1.0 + __pyx_v_com);
+  if (unlikely(__pyx_t_1 == 0)) {
+    PyErr_Format(PyExc_ZeroDivisionError, "float division");
+    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_v_neww = (1.0 / __pyx_t_1);
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":201
+ * 
+ *     neww = 1. / (1. + com)
+ *     oldw = 1. - neww             # <<<<<<<<<<<<<<
+ *     adj = oldw
+ * 
+ */
+  __pyx_v_oldw = (1.0 - __pyx_v_neww);
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":202
+ *     neww = 1. / (1. + com)
+ *     oldw = 1. - neww
+ *     adj = oldw             # <<<<<<<<<<<<<<
+ * 
+ *     output[0] = neww * input[0]
+ */
+  __pyx_v_adj = __pyx_v_oldw;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":204
+ *     adj = oldw
+ * 
+ *     output[0] = neww * input[0]             # <<<<<<<<<<<<<<
+ * 
+ *     for i from 1 <= i < N:
+ */
+  __pyx_t_2 = 0;
+  __pyx_t_3 = -1;
+  if (__pyx_t_2 < 0) {
+    __pyx_t_2 += __pyx_bshape_0_input;
+    if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
+  } else if (unlikely(__pyx_t_2 >= __pyx_bshape_0_input)) __pyx_t_3 = 0;
+  if (unlikely(__pyx_t_3 != -1)) {
+    __Pyx_RaiseBufferIndexError(__pyx_t_3);
+    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_t_4 = 0;
+  __pyx_t_3 = -1;
+  if (__pyx_t_4 < 0) {
+    __pyx_t_4 += __pyx_bshape_0_output;
+    if (unlikely(__pyx_t_4 < 0)) __pyx_t_3 = 0;
+  } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_3 = 0;
+  if (unlikely(__pyx_t_3 != -1)) {
+    __Pyx_RaiseBufferIndexError(__pyx_t_3);
+    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = (__pyx_v_neww * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_2, __pyx_bstride_0_input)));
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":206
+ *     output[0] = neww * input[0]
+ * 
+ *     for i from 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         cur = input[i]
+ *         prev = output[i - 1]
+ */
+  __pyx_t_3 = __pyx_v_N;
+  for (__pyx_v_i = 1; __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":207
+ * 
+ *     for i from 1 <= i < N:
+ *         cur = input[i]             # <<<<<<<<<<<<<<
+ *         prev = output[i - 1]
+ * 
+ */
+    __pyx_t_5 = __pyx_v_i;
+    __pyx_t_6 = -1;
+    if (__pyx_t_5 < 0) {
+      __pyx_t_5 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_5 < 0)) __pyx_t_6 = 0;
+    } else if (unlikely(__pyx_t_5 >= __pyx_bshape_0_input)) __pyx_t_6 = 0;
+    if (unlikely(__pyx_t_6 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_6);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_cur = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_5, __pyx_bstride_0_input));
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":208
+ *     for i from 1 <= i < N:
+ *         cur = input[i]
+ *         prev = output[i - 1]             # <<<<<<<<<<<<<<
+ * 
+ *         if cur == cur:
+ */
+    __pyx_t_7 = (__pyx_v_i - 1);
+    __pyx_t_6 = -1;
+    if (__pyx_t_7 < 0) {
+      __pyx_t_7 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_7 < 0)) __pyx_t_6 = 0;
+    } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_output)) __pyx_t_6 = 0;
+    if (unlikely(__pyx_t_6 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_6);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_7, __pyx_bstride_0_output));
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":210
+ *         prev = output[i - 1]
+ * 
+ *         if cur == cur:             # <<<<<<<<<<<<<<
+ *             if prev == prev:
  *                 output[i] = oldw * prev + neww * cur
  */
     __pyx_t_8 = (__pyx_v_cur == __pyx_v_cur);
     if (__pyx_t_8) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":209
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":211
  * 
  *         if cur == cur:
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -7162,7 +8651,7 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
       __pyx_t_8 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_8) {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":210
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":212
  *         if cur == cur:
  *             if prev == prev:
  *                 output[i] = oldw * prev + neww * cur             # <<<<<<<<<<<<<<
@@ -7177,14 +8666,14 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
         } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
         if (unlikely(__pyx_t_9 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_9);
-          {__pyx_filename = __pyx_f[1]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_6, __pyx_bstride_0_output) = ((__pyx_v_oldw * __pyx_v_prev) + (__pyx_v_neww * __pyx_v_cur));
         goto __pyx_L9;
       }
       /*else*/ {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":212
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":214
  *                 output[i] = oldw * prev + neww * cur
  *             else:
  *                 output[i] = neww * cur             # <<<<<<<<<<<<<<
@@ -7199,7 +8688,7 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
         } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_output)) __pyx_t_10 = 0;
         if (unlikely(__pyx_t_10 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_10);
-          {__pyx_filename = __pyx_f[1]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_9, __pyx_bstride_0_output) = (__pyx_v_neww * __pyx_v_cur);
       }
@@ -7208,7 +8697,7 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":214
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":216
  *                 output[i] = neww * cur
  *         else:
  *             output[i] = prev             # <<<<<<<<<<<<<<
@@ -7223,14 +8712,14 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
       } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
       if (unlikely(__pyx_t_11 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_11);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_prev;
     }
     __pyx_L8:;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":216
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":218
  *             output[i] = prev
  * 
  *     for i from 0 <= i < N:             # <<<<<<<<<<<<<<
@@ -7240,7 +8729,7 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
   __pyx_t_3 = __pyx_v_N;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":217
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":219
  * 
  *     for i from 0 <= i < N:
  *         cur = input[i]             # <<<<<<<<<<<<<<
@@ -7255,11 +8744,11 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
     } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_input)) __pyx_t_12 = 0;
     if (unlikely(__pyx_t_12 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_12);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_cur = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_11, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":218
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":220
  *     for i from 0 <= i < N:
  *         cur = input[i]
  *         output[i] = output[i] / (1. - adj)             # <<<<<<<<<<<<<<
@@ -7274,13 +8763,13 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_output)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_t_14 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_12, __pyx_bstride_0_output));
     __pyx_t_1 = (1.0 - __pyx_v_adj);
     if (unlikely(__pyx_t_1 == 0)) {
       PyErr_Format(PyExc_ZeroDivisionError, "float division");
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_t_13 = __pyx_v_i;
     __pyx_t_15 = -1;
@@ -7290,11 +8779,11 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
     } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
     if (unlikely(__pyx_t_15 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_15);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_13, __pyx_bstride_0_output) = (__pyx_t_14 / __pyx_t_1);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":220
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":222
  *         output[i] = output[i] / (1. - adj)
  * 
  *         if cur == cur:             # <<<<<<<<<<<<<<
@@ -7304,7 +8793,7 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
     __pyx_t_8 = (__pyx_v_cur == __pyx_v_cur);
     if (__pyx_t_8) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":221
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":223
  * 
  *         if cur == cur:
  *             adj *= oldw             # <<<<<<<<<<<<<<
@@ -7339,7 +8828,7 @@ static PyObject *__pyx_pf_7tseries__ewma_noncontig(PyObject *__pyx_self, PyObjec
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":226
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":228
  * # Rolling variance
  * 
  * cdef void _roll_var(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
@@ -7361,7 +8850,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
   int __pyx_t_5;
   __Pyx_RefNannySetupContext("_roll_var");
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":228
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":230
  * cdef void _roll_var(double_t *input, double_t *output,
  *                     int win, int minp, int N):
  *     cdef double val, prev, sum_x = 0, sum_xx = 0             # <<<<<<<<<<<<<<
@@ -7371,7 +8860,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_v_sum_x = 0;
   __pyx_v_sum_xx = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":229
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":231
  *                     int win, int minp, int N):
  *     cdef double val, prev, sum_x = 0, sum_xx = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -7380,7 +8869,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":231
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":233
  *     cdef int nobs = 0, i
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -7390,7 +8879,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":232
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":234
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -7402,7 +8891,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
   }
   __pyx_L3:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":234
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":236
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -7412,7 +8901,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_2 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":235
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":237
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -7421,7 +8910,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
     __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":238
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":240
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -7431,7 +8920,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":239
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":241
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -7440,7 +8929,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":240
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":242
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -7449,7 +8938,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_sum_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":241
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":243
  *             nobs += 1
  *             sum_x += val
  *             sum_xx += val * val             # <<<<<<<<<<<<<<
@@ -7461,7 +8950,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L6:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":243
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":245
  *             sum_xx += val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -7471,7 +8960,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
     (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":245
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":247
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -7481,7 +8970,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_3 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":246
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":248
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -7490,7 +8979,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
     __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":248
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":250
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -7500,7 +8989,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":249
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":251
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -7509,7 +8998,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_prev = (__pyx_v_input[(__pyx_v_i - __pyx_v_win)]);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":250
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":252
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -7519,7 +9008,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
       __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_1) {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":251
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":253
  *             prev = input[i - win]
  *             if prev == prev:
  *                 sum_x -= prev             # <<<<<<<<<<<<<<
@@ -7528,7 +9017,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_sum_x -= __pyx_v_prev;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":252
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":254
  *             if prev == prev:
  *                 sum_x -= prev
  *                 sum_xx -= prev * prev             # <<<<<<<<<<<<<<
@@ -7537,7 +9026,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_sum_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":253
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":255
  *                 sum_x -= prev
  *                 sum_xx -= prev * prev
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -7552,7 +9041,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L9:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":255
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":257
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -7562,7 +9051,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":256
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":258
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -7571,7 +9060,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":257
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":259
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -7580,7 +9069,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_sum_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":258
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":260
  *             nobs += 1
  *             sum_x += val
  *             sum_xx += val * val             # <<<<<<<<<<<<<<
@@ -7592,7 +9081,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L11:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":260
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":262
  *             sum_xx += val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -7602,7 +9091,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":261
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":263
  * 
  *         if nobs >= minp:
  *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)             # <<<<<<<<<<<<<<
@@ -7613,14 +9102,14 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
       __pyx_t_5 = ((__pyx_v_nobs * __pyx_v_nobs) - __pyx_v_nobs);
       if (unlikely(__pyx_t_5 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       (__pyx_v_output[__pyx_v_i]) = (__pyx_t_4 / __pyx_t_5);
       goto __pyx_L12;
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":263
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":265
  *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -7639,7 +9128,7 @@ static  void __pyx_f_7tseries__roll_var(__pyx_t_5numpy_double_t *__pyx_v_input,
   __Pyx_RefNannyFinishContext();
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":266
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":268
  * 
  * 
  * def _roll_var_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
@@ -7702,47 +9191,47 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  4:
       values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
       if (likely(values[4])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_var_noncontig") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_var_noncontig") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_output = ((PyArrayObject *)values[1]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
     __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_var_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries._roll_var_noncontig");
   return NULL;
@@ -7751,22 +9240,22 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
   __Pyx_INCREF((PyObject *)__pyx_v_output);
   __pyx_bstruct_input.buf = NULL;
   __pyx_bstruct_output.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
   __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":269
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":271
  *                         ndarray[double_t, ndim=1] output,
  *                         int win, int minp, int N):
  *     cdef double val, prev, sum_x = 0, sum_xx = 0             # <<<<<<<<<<<<<<
@@ -7776,7 +9265,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
   __pyx_v_sum_x = 0;
   __pyx_v_sum_xx = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":270
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":272
  *                         int win, int minp, int N):
  *     cdef double val, prev, sum_x = 0, sum_xx = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -7785,7 +9274,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":272
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":274
  *     cdef int nobs = 0, i
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -7795,7 +9284,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
   __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":273
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":275
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -7807,7 +9296,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":275
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":277
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -7817,7 +9306,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
   __pyx_t_2 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":276
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":278
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -7832,11 +9321,11 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     } else if (unlikely(__pyx_t_3 >= __pyx_bshape_0_input)) __pyx_t_4 = 0;
     if (unlikely(__pyx_t_4 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_4);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_3, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":279
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":281
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -7846,7 +9335,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":280
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":282
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -7855,7 +9344,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":281
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":283
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -7864,7 +9353,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
  */
       __pyx_v_sum_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":282
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":284
  *             nobs += 1
  *             sum_x += val
  *             sum_xx += val * val             # <<<<<<<<<<<<<<
@@ -7876,7 +9365,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     }
     __pyx_L9:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":284
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":286
  *             sum_xx += val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -7891,12 +9380,12 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_5 = 0;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":286
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":288
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -7906,7 +9395,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
   __pyx_t_5 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_5; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":287
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":289
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -7921,11 +9410,11 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_input)) __pyx_t_7 = 0;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":289
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":291
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -7935,7 +9424,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":290
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":292
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -7950,11 +9439,11 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
       } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_8 = 0;
       if (unlikely(__pyx_t_8 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_8);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":291
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":293
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -7964,7 +9453,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
       __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_1) {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":292
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":294
  *             prev = input[i - win]
  *             if prev == prev:
  *                 sum_x -= prev             # <<<<<<<<<<<<<<
@@ -7973,7 +9462,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
  */
         __pyx_v_sum_x -= __pyx_v_prev;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":293
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":295
  *             if prev == prev:
  *                 sum_x -= prev
  *                 sum_xx -= prev * prev             # <<<<<<<<<<<<<<
@@ -7982,7 +9471,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
  */
         __pyx_v_sum_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":294
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":296
  *                 sum_x -= prev
  *                 sum_xx -= prev * prev
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -7997,7 +9486,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     }
     __pyx_L12:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":296
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":298
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -8007,7 +9496,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":297
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":299
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -8016,7 +9505,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":298
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":300
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -8025,7 +9514,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
  */
       __pyx_v_sum_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":299
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":301
  *             nobs += 1
  *             sum_x += val
  *             sum_xx += val * val             # <<<<<<<<<<<<<<
@@ -8037,7 +9526,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     }
     __pyx_L14:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":301
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":303
  *             sum_xx += val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -8047,7 +9536,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
     __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":302
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":304
  * 
  *         if nobs >= minp:
  *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)             # <<<<<<<<<<<<<<
@@ -8058,7 +9547,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
       __pyx_t_8 = ((__pyx_v_nobs * __pyx_v_nobs) - __pyx_v_nobs);
       if (unlikely(__pyx_t_8 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_t_10 = __pyx_v_i;
       __pyx_t_11 = -1;
@@ -8068,14 +9557,14 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
       } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
       if (unlikely(__pyx_t_11 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_11);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = (__pyx_t_9 / __pyx_t_8);
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":304
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":306
  *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -8090,7 +9579,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
       } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
       if (unlikely(__pyx_t_11 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_11);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
@@ -8119,7 +9608,7 @@ static PyObject *__pyx_pf_7tseries__roll_var_noncontig(PyObject *__pyx_self, PyO
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":309
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":311
  * # Rolling skewness
  * 
  * cdef void _roll_skew(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
@@ -8146,7 +9635,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
   double __pyx_t_5;
   __Pyx_RefNannySetupContext("_roll_skew");
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":312
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":314
  *                     int win, int minp, int N):
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0             # <<<<<<<<<<<<<<
@@ -8157,7 +9646,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_v_xx = 0;
   __pyx_v_xxx = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":313
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":315
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -8166,7 +9655,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":318
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":320
  *     cdef double A, B, C, R
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -8176,7 +9665,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":319
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":321
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -8188,7 +9677,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
   }
   __pyx_L3:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":321
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":323
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -8198,7 +9687,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_2 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":322
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":324
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -8207,7 +9696,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
     __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":325
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":327
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -8217,7 +9706,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":326
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":328
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -8226,7 +9715,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":327
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":329
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -8235,7 +9724,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":328
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":330
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -8244,7 +9733,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":329
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":331
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -8256,7 +9745,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L6:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":331
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":333
  *             xxx += val * val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -8266,7 +9755,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
     (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":333
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":335
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -8276,7 +9765,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_3 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":334
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":336
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -8285,7 +9774,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
     __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":336
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":338
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -8295,7 +9784,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":337
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":339
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -8304,7 +9793,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_prev = (__pyx_v_input[(__pyx_v_i - __pyx_v_win)]);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":338
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":340
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -8314,7 +9803,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
       __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_1) {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":339
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":341
  *             prev = input[i - win]
  *             if prev == prev:
  *                 x -= prev             # <<<<<<<<<<<<<<
@@ -8323,7 +9812,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_x -= __pyx_v_prev;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":340
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":342
  *             if prev == prev:
  *                 x -= prev
  *                 xx -= prev * prev             # <<<<<<<<<<<<<<
@@ -8332,7 +9821,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":341
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":343
  *                 x -= prev
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev             # <<<<<<<<<<<<<<
@@ -8341,7 +9830,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_xxx -= ((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":343
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":345
  *                 xxx -= prev * prev * prev
  * 
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -8356,7 +9845,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L9:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":345
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":347
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -8366,7 +9855,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":346
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":348
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -8375,7 +9864,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":347
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":349
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -8384,7 +9873,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":348
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":350
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -8393,7 +9882,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":349
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":351
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -8405,7 +9894,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L11:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":351
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":353
  *             xxx += val * val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -8415,7 +9904,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":352
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":354
  * 
  *         if nobs >= minp:
  *             A = x / nobs             # <<<<<<<<<<<<<<
@@ -8424,11 +9913,11 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_A = (__pyx_v_x / __pyx_v_nobs);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":353
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":355
  *         if nobs >= minp:
  *             A = x / nobs
  *             B = xx / nobs - A * A             # <<<<<<<<<<<<<<
@@ -8437,11 +9926,11 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - (__pyx_v_A * __pyx_v_A));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":354
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":356
  *             A = x / nobs
  *             B = xx / nobs - A * A
  *             C = xxx / nobs - A * A * A - 3 * A * B             # <<<<<<<<<<<<<<
@@ -8450,11 +9939,11 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - ((__pyx_v_A * __pyx_v_A) * __pyx_v_A)) - ((3 * __pyx_v_A) * __pyx_v_B));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":356
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":358
  *             C = xxx / nobs - A * A * A - 3 * A * B
  * 
  *             R = sqrt(B)             # <<<<<<<<<<<<<<
@@ -8463,7 +9952,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_R = sqrt(__pyx_v_B);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":358
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":360
  *             R = sqrt(B)
  * 
  *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
@@ -8472,7 +9961,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_t_4 = (sqrt((__pyx_v_nobs * (__pyx_v_nobs - 1.0))) * __pyx_v_C);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":359
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":361
  * 
  *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /
  *                          ((nobs-2) * R * R * R))             # <<<<<<<<<<<<<<
@@ -8482,10 +9971,10 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
       __pyx_t_5 = ((((__pyx_v_nobs - 2) * __pyx_v_R) * __pyx_v_R) * __pyx_v_R);
       if (unlikely(__pyx_t_5 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":358
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":360
  *             R = sqrt(B)
  * 
  *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
@@ -8497,7 +9986,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":361
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":363
  *                          ((nobs-2) * R * R * R))
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -8516,7 +10005,7 @@ static  void __pyx_f_7tseries__roll_skew(__pyx_t_5numpy_double_t *__pyx_v_input,
   __Pyx_RefNannyFinishContext();
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":364
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":366
  * 
  * 
  * def _roll_skew_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
@@ -8585,47 +10074,47 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  4:
       values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
       if (likely(values[4])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_skew_noncontig") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_skew_noncontig") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_output = ((PyArrayObject *)values[1]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
     __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_skew_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries._roll_skew_noncontig");
   return NULL;
@@ -8634,22 +10123,22 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
   __Pyx_INCREF((PyObject *)__pyx_v_output);
   __pyx_bstruct_input.buf = NULL;
   __pyx_bstruct_output.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
   __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":368
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":370
  *                          int win, int minp, int N):
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0             # <<<<<<<<<<<<<<
@@ -8660,7 +10149,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
   __pyx_v_xx = 0;
   __pyx_v_xxx = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":369
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":371
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -8669,7 +10158,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":374
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":376
  *     cdef double A, B, C, R
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -8679,7 +10168,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
   __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":375
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":377
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -8691,7 +10180,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":377
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":379
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -8701,7 +10190,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
   __pyx_t_2 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":378
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":380
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -8716,11 +10205,11 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     } else if (unlikely(__pyx_t_3 >= __pyx_bshape_0_input)) __pyx_t_4 = 0;
     if (unlikely(__pyx_t_4 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_4);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_3, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":381
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":383
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -8730,7 +10219,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":382
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":384
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -8739,7 +10228,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":383
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":385
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -8748,7 +10237,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":384
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":386
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -8757,7 +10246,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":385
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":387
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -8769,7 +10258,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     }
     __pyx_L9:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":387
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":389
  *             xxx += val * val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -8784,12 +10273,12 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_5 = 0;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":389
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":391
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -8799,7 +10288,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
   __pyx_t_5 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_5; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":390
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":392
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -8814,11 +10303,11 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_input)) __pyx_t_7 = 0;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":392
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":394
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -8828,7 +10317,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":393
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":395
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -8843,11 +10332,11 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
       } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_8 = 0;
       if (unlikely(__pyx_t_8 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_8);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":394
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":396
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -8857,7 +10346,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
       __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_1) {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":395
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":397
  *             prev = input[i - win]
  *             if prev == prev:
  *                 x -= prev             # <<<<<<<<<<<<<<
@@ -8866,7 +10355,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
         __pyx_v_x -= __pyx_v_prev;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":396
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":398
  *             if prev == prev:
  *                 x -= prev
  *                 xx -= prev * prev             # <<<<<<<<<<<<<<
@@ -8875,7 +10364,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
         __pyx_v_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":397
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":399
  *                 x -= prev
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev             # <<<<<<<<<<<<<<
@@ -8884,7 +10373,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
         __pyx_v_xxx -= ((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":399
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":401
  *                 xxx -= prev * prev * prev
  * 
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -8899,7 +10388,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     }
     __pyx_L12:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":401
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":403
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -8909,7 +10398,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":402
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":404
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -8918,7 +10407,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":403
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":405
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -8927,7 +10416,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":404
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":406
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -8936,7 +10425,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":405
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":407
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -8948,7 +10437,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     }
     __pyx_L14:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":407
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":409
  *             xxx += val * val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -8958,7 +10447,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":408
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":410
  * 
  *         if nobs >= minp:
  *             A = x / nobs             # <<<<<<<<<<<<<<
@@ -8967,11 +10456,11 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_A = (__pyx_v_x / __pyx_v_nobs);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":409
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":411
  *         if nobs >= minp:
  *             A = x / nobs
  *             B = xx / nobs - A * A             # <<<<<<<<<<<<<<
@@ -8980,11 +10469,11 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - (__pyx_v_A * __pyx_v_A));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":410
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":412
  *             A = x / nobs
  *             B = xx / nobs - A * A
  *             C = xxx / nobs - A * A * A - 3 * A * B             # <<<<<<<<<<<<<<
@@ -8993,11 +10482,11 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - ((__pyx_v_A * __pyx_v_A) * __pyx_v_A)) - ((3 * __pyx_v_A) * __pyx_v_B));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":412
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":414
  *             C = xxx / nobs - A * A * A - 3 * A * B
  * 
  *             R = sqrt(B)             # <<<<<<<<<<<<<<
@@ -9006,7 +10495,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_R = sqrt(__pyx_v_B);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":414
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":416
  *             R = sqrt(B)
  * 
  *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
@@ -9015,7 +10504,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_t_9 = (sqrt((__pyx_v_nobs * (__pyx_v_nobs - 1.0))) * __pyx_v_C);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":415
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":417
  * 
  *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /
  *                          ((nobs-2) * R * R * R))             # <<<<<<<<<<<<<<
@@ -9025,10 +10514,10 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
       __pyx_t_10 = ((((__pyx_v_nobs - 2) * __pyx_v_R) * __pyx_v_R) * __pyx_v_R);
       if (unlikely(__pyx_t_10 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":414
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":416
  *             R = sqrt(B)
  * 
  *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
@@ -9043,14 +10532,14 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
       } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
       if (unlikely(__pyx_t_11 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_11);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = (__pyx_t_9 / __pyx_t_10);
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":417
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":419
  *                          ((nobs-2) * R * R * R))
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -9065,7 +10554,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
       } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_output)) __pyx_t_12 = 0;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_11, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
@@ -9094,7 +10583,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew_noncontig(PyObject *__pyx_self, Py
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":423
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":425
  * 
  * 
  * cdef void _roll_kurt(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
@@ -9124,7 +10613,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
   double __pyx_t_5;
   __Pyx_RefNannySetupContext("_roll_kurt");
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":426
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":428
  *                      int win, int minp, int N):
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0             # <<<<<<<<<<<<<<
@@ -9136,7 +10625,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_v_xxx = 0;
   __pyx_v_xxxx = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":427
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":429
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -9145,7 +10634,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":432
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":434
  *     cdef double A, B, C, D, R, K
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -9155,7 +10644,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":433
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":435
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -9167,7 +10656,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
   }
   __pyx_L3:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":435
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":437
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -9177,7 +10666,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_2 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":436
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":438
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9186,7 +10675,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
     __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":439
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":441
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -9196,7 +10685,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":440
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":442
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -9205,7 +10694,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":441
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":443
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -9214,7 +10703,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":442
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":444
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -9223,7 +10712,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":443
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":445
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -9232,7 +10721,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":444
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":446
  *             xx += val * val
  *             xxx += val * val * val
  *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
@@ -9244,7 +10733,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L6:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":446
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":448
  *             xxxx += val * val * val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -9254,7 +10743,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
     (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":448
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":450
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -9264,7 +10753,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_3 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":449
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":451
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9273,7 +10762,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
     __pyx_v_val = (__pyx_v_input[__pyx_v_i]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":451
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":453
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -9283,7 +10772,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":452
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":454
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -9292,7 +10781,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_prev = (__pyx_v_input[(__pyx_v_i - __pyx_v_win)]);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":453
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":455
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -9302,7 +10791,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
       __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_1) {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":454
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":456
  *             prev = input[i - win]
  *             if prev == prev:
  *                 x -= prev             # <<<<<<<<<<<<<<
@@ -9311,7 +10800,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_x -= __pyx_v_prev;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":455
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":457
  *             if prev == prev:
  *                 x -= prev
  *                 xx -= prev * prev             # <<<<<<<<<<<<<<
@@ -9320,7 +10809,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":456
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":458
  *                 x -= prev
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev             # <<<<<<<<<<<<<<
@@ -9329,7 +10818,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_xxx -= ((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":457
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":459
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev
  *                 xxxx -= prev * prev * prev * prev             # <<<<<<<<<<<<<<
@@ -9338,7 +10827,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
         __pyx_v_xxxx -= (((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":459
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":461
  *                 xxxx -= prev * prev * prev * prev
  * 
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -9353,7 +10842,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L9:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":461
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":463
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -9363,7 +10852,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":462
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":464
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -9372,7 +10861,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":463
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":465
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -9381,7 +10870,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":464
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":466
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -9390,7 +10879,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":465
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":467
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -9399,7 +10888,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":466
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":468
  *             xx += val * val
  *             xxx += val * val * val
  *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
@@ -9411,7 +10900,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     __pyx_L11:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":468
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":470
  *             xxxx += val * val * val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -9421,7 +10910,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
     __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":469
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":471
  * 
  *         if nobs >= minp:
  *             A = x / nobs             # <<<<<<<<<<<<<<
@@ -9430,11 +10919,11 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_A = (__pyx_v_x / __pyx_v_nobs);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":470
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":472
  *         if nobs >= minp:
  *             A = x / nobs
  *             R = A * A             # <<<<<<<<<<<<<<
@@ -9443,7 +10932,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_R = (__pyx_v_A * __pyx_v_A);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":471
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":473
  *             A = x / nobs
  *             R = A * A
  *             B = xx / nobs - R             # <<<<<<<<<<<<<<
@@ -9452,11 +10941,11 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - __pyx_v_R);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":472
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":474
  *             R = A * A
  *             B = xx / nobs - R
  *             R = R * A             # <<<<<<<<<<<<<<
@@ -9465,7 +10954,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_R = (__pyx_v_R * __pyx_v_A);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":473
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":475
  *             B = xx / nobs - R
  *             R = R * A
  *             C = xxx / nobs - R - 3 * A * B             # <<<<<<<<<<<<<<
@@ -9474,11 +10963,11 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - __pyx_v_R) - ((3 * __pyx_v_A) * __pyx_v_B));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":474
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":476
  *             R = R * A
  *             C = xxx / nobs - R - 3 * A * B
  *             R = R * A             # <<<<<<<<<<<<<<
@@ -9487,7 +10976,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       __pyx_v_R = (__pyx_v_R * __pyx_v_A);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":475
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":477
  *             C = xxx / nobs - R - 3 * A * B
  *             R = R * A
  *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A             # <<<<<<<<<<<<<<
@@ -9496,11 +10985,11 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_D = ((((__pyx_v_xxxx / __pyx_v_nobs) - __pyx_v_R) - (((6 * __pyx_v_B) * __pyx_v_A) * __pyx_v_A)) - ((4 * __pyx_v_C) * __pyx_v_A));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":477
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":479
  *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A
  * 
  *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)             # <<<<<<<<<<<<<<
@@ -9511,11 +11000,11 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
       __pyx_t_5 = (__pyx_v_B * __pyx_v_B);
       if (unlikely(__pyx_t_5 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_K = ((__pyx_t_4 / __pyx_t_5) - (3 * pow((__pyx_v_nobs - 1.0), 2)));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":478
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":480
  * 
  *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)
  *             K = K / ((nobs - 2.)*(nobs-3.))             # <<<<<<<<<<<<<<
@@ -9525,11 +11014,11 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
       __pyx_t_5 = ((__pyx_v_nobs - 2.0) * (__pyx_v_nobs - 3.0));
       if (unlikely(__pyx_t_5 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 480; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_K = (__pyx_v_K / __pyx_t_5);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":480
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":482
  *             K = K / ((nobs - 2.)*(nobs-3.))
  * 
  *             output[i] = K             # <<<<<<<<<<<<<<
@@ -9541,7 +11030,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":482
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":484
  *             output[i] = K
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -9560,7 +11049,7 @@ static  void __pyx_f_7tseries__roll_kurt(__pyx_t_5numpy_double_t *__pyx_v_input,
   __Pyx_RefNannyFinishContext();
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":484
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":486
  *             output[i] = NaN
  * 
  * def _roll_kurt_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
@@ -9632,47 +11121,47 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, 3); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  4:
       values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
       if (likely(values[4])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, 4); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_kurt_noncontig") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_kurt_noncontig") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_output = ((PyArrayObject *)values[1]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(values[4]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
     __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_kurt_noncontig", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries._roll_kurt_noncontig");
   return NULL;
@@ -9681,22 +11170,22 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
   __Pyx_INCREF((PyObject *)__pyx_v_output);
   __pyx_bstruct_input.buf = NULL;
   __pyx_bstruct_output.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
   __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":488
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":490
  *                          int win, int minp, int N):
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0             # <<<<<<<<<<<<<<
@@ -9708,7 +11197,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
   __pyx_v_xxx = 0;
   __pyx_v_xxxx = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":489
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":491
  *     cdef double val, prev
  *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
@@ -9717,7 +11206,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
   __pyx_v_nobs = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":494
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":496
  *     cdef double A, B, C, D, R, K
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -9727,7 +11216,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
   __pyx_t_1 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_1) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":495
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":497
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -9739,7 +11228,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":497
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":499
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -9749,7 +11238,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
   __pyx_t_2 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":498
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":500
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9764,11 +11253,11 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     } else if (unlikely(__pyx_t_3 >= __pyx_bshape_0_input)) __pyx_t_4 = 0;
     if (unlikely(__pyx_t_4 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_4);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_3, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":501
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":503
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -9778,7 +11267,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":502
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":504
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -9787,7 +11276,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":505
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":507
  * 
  *             # seriously don't ask me why this is faster
  *             x += val             # <<<<<<<<<<<<<<
@@ -9796,7 +11285,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":506
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":508
  *             # seriously don't ask me why this is faster
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -9805,7 +11294,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":507
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":509
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -9814,7 +11303,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":508
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":510
  *             xx += val * val
  *             xxx += val * val * val
  *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
@@ -9826,7 +11315,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     }
     __pyx_L9:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":510
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":512
  *             xxxx += val * val * val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -9841,12 +11330,12 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_5 = 0;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":512
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":514
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -9856,7 +11345,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
   __pyx_t_5 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_5; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":513
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":515
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9871,11 +11360,11 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_input)) __pyx_t_7 = 0;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":515
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":517
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -9885,7 +11374,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":516
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":518
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -9900,11 +11389,11 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
       } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_8 = 0;
       if (unlikely(__pyx_t_8 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_8);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":517
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":519
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -9914,7 +11403,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
       __pyx_t_1 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_1) {
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":518
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":520
  *             prev = input[i - win]
  *             if prev == prev:
  *                 x -= prev             # <<<<<<<<<<<<<<
@@ -9923,7 +11412,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
         __pyx_v_x -= __pyx_v_prev;
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":519
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":521
  *             if prev == prev:
  *                 x -= prev
  *                 xx -= prev * prev             # <<<<<<<<<<<<<<
@@ -9932,7 +11421,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
         __pyx_v_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":520
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":522
  *                 x -= prev
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev             # <<<<<<<<<<<<<<
@@ -9941,7 +11430,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
         __pyx_v_xxx -= ((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":521
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":523
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev
  *                 xxxx -= prev * prev * prev * prev             # <<<<<<<<<<<<<<
@@ -9950,7 +11439,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
         __pyx_v_xxxx -= (((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "H:\pandas\pandas\lib\src\moments.pyx":523
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":525
  *                 xxxx -= prev * prev * prev * prev
  * 
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -9965,7 +11454,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     }
     __pyx_L12:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":525
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":527
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -9975,7 +11464,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":526
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":528
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -9984,7 +11473,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_nobs += 1;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":527
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":529
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -9993,7 +11482,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":528
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":530
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
@@ -10002,7 +11491,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":529
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":531
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
@@ -10011,7 +11500,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":530
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":532
  *             xx += val * val
  *             xxx += val * val * val
  *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
@@ -10023,7 +11512,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     }
     __pyx_L14:;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":532
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":534
  *             xxxx += val * val * val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
@@ -10033,7 +11522,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
     __pyx_t_1 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_1) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":533
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":535
  * 
  *         if nobs >= minp:
  *             A = x / nobs             # <<<<<<<<<<<<<<
@@ -10042,11 +11531,11 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_A = (__pyx_v_x / __pyx_v_nobs);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":534
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":536
  *         if nobs >= minp:
  *             A = x / nobs
  *             R = A * A             # <<<<<<<<<<<<<<
@@ -10055,7 +11544,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_R = (__pyx_v_A * __pyx_v_A);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":535
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":537
  *             A = x / nobs
  *             R = A * A
  *             B = xx / nobs - R             # <<<<<<<<<<<<<<
@@ -10064,11 +11553,11 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - __pyx_v_R);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":536
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":538
  *             R = A * A
  *             B = xx / nobs - R
  *             R = R * A             # <<<<<<<<<<<<<<
@@ -10077,7 +11566,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_R = (__pyx_v_R * __pyx_v_A);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":537
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":539
  *             B = xx / nobs - R
  *             R = R * A
  *             C = xxx / nobs - R - 3 * A * B             # <<<<<<<<<<<<<<
@@ -10086,11 +11575,11 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - __pyx_v_R) - ((3 * __pyx_v_A) * __pyx_v_B));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":538
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":540
  *             R = R * A
  *             C = xxx / nobs - R - 3 * A * B
  *             R = R * A             # <<<<<<<<<<<<<<
@@ -10099,7 +11588,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       __pyx_v_R = (__pyx_v_R * __pyx_v_A);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":539
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":541
  *             C = xxx / nobs - R - 3 * A * B
  *             R = R * A
  *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A             # <<<<<<<<<<<<<<
@@ -10108,11 +11597,11 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 541; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_D = ((((__pyx_v_xxxx / __pyx_v_nobs) - __pyx_v_R) - (((6 * __pyx_v_B) * __pyx_v_A) * __pyx_v_A)) - ((4 * __pyx_v_C) * __pyx_v_A));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":541
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":543
  *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A
  * 
  *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)             # <<<<<<<<<<<<<<
@@ -10123,11 +11612,11 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
       __pyx_t_10 = (__pyx_v_B * __pyx_v_B);
       if (unlikely(__pyx_t_10 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 541; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_K = ((__pyx_t_9 / __pyx_t_10) - (3 * pow((__pyx_v_nobs - 1.0), 2)));
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":542
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":544
  * 
  *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)
  *             K = K / ((nobs - 2.)*(nobs-3.))             # <<<<<<<<<<<<<<
@@ -10137,11 +11626,11 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
       __pyx_t_10 = ((__pyx_v_nobs - 2.0) * (__pyx_v_nobs - 3.0));
       if (unlikely(__pyx_t_10 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_K = (__pyx_v_K / __pyx_t_10);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":544
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":546
  *             K = K / ((nobs - 2.)*(nobs-3.))
  * 
  *             output[i] = K             # <<<<<<<<<<<<<<
@@ -10156,14 +11645,14 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
       } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
       if (unlikely(__pyx_t_11 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_11);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = __pyx_v_K;
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":546
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":548
  *             output[i] = K
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
@@ -10178,7 +11667,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
       } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_output)) __pyx_t_12 = 0;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_11, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
@@ -10207,7 +11696,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt_noncontig(PyObject *__pyx_self, Py
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":551
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":553
  * # Rolling median
  * 
  * def median(ndarray arr):             # <<<<<<<<<<<<<<
@@ -10229,30 +11718,30 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
   __Pyx_RefNannySetupContext("median");
   __pyx_self = __pyx_self;
   __Pyx_INCREF((PyObject *)__pyx_v_arr);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":553
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":555
  * def median(ndarray arr):
  *     cdef double *values
  *     cdef int n = len(arr)             # <<<<<<<<<<<<<<
  * 
  *     if len(arr) == 0:
  */
-  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_n = __pyx_t_1;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":555
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":557
  *     cdef int n = len(arr)
  * 
  *     if len(arr) == 0:             # <<<<<<<<<<<<<<
  *         return np.NaN
  * 
  */
-  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_2 = (__pyx_t_1 == 0);
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":556
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":558
  * 
  *     if len(arr) == 0:
  *         return np.NaN             # <<<<<<<<<<<<<<
@@ -10260,9 +11749,9 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
  *     if not np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS):
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 558; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__NaN); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__NaN); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 558; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_r = __pyx_t_4;
@@ -10272,7 +11761,7 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
   }
   __pyx_L5:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":558
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":560
  *         return np.NaN
  * 
  *     if not np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS):             # <<<<<<<<<<<<<<
@@ -10282,153 +11771,269 @@ static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_t_2 = (!PyArray_CHKFLAGS(((PyArrayObject *)__pyx_v_arr), NPY_C_CONTIGUOUS));
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":559
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":561
  * 
  *     if not np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS):
  *         arr = np.array(arr)             # <<<<<<<<<<<<<<
  * 
  *     values = <double *> arr.data
  */
-    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__array); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__array); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_arr);
     __Pyx_GIVEREF(__pyx_v_arr);
-    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_v_arr);
     __pyx_v_arr = __pyx_t_5;
     __pyx_t_5 = 0;
     goto __pyx_L6;
   }
-  __pyx_L6:;
+  __pyx_L6:;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":563
+ *         arr = np.array(arr)
+ * 
+ *     values = <double *> arr.data             # <<<<<<<<<<<<<<
+ * 
+ *     if n % 2:
+ */
+  __pyx_v_values = ((double *)((PyArrayObject *)__pyx_v_arr)->data);
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":565
+ *     values = <double *> arr.data
+ * 
+ *     if n % 2:             # <<<<<<<<<<<<<<
+ *         return kth_smallest(values, n, n / 2)
+ *     else:
+ */
+  __pyx_t_6 = __Pyx_mod_long(__pyx_v_n, 2);
+  if (__pyx_t_6) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":566
+ * 
+ *     if n % 2:
+ *         return kth_smallest(values, n, n / 2)             # <<<<<<<<<<<<<<
+ *     else:
+ *         return (kth_smallest(values, n, n / 2) +
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_5 = PyFloat_FromDouble(kth_smallest(__pyx_v_values, __pyx_v_n, __Pyx_div_long(__pyx_v_n, 2))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_r = __pyx_t_5;
+    __pyx_t_5 = 0;
+    goto __pyx_L0;
+    goto __pyx_L7;
+  }
+  /*else*/ {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":568
+ *         return kth_smallest(values, n, n / 2)
+ *     else:
+ *         return (kth_smallest(values, n, n / 2) +             # <<<<<<<<<<<<<<
+ *                 kth_smallest(values, n, n / 2 - 1)) / 2
+ * 
+ */
+    __Pyx_XDECREF(__pyx_r);
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":569
+ *     else:
+ *         return (kth_smallest(values, n, n / 2) +
+ *                 kth_smallest(values, n, n / 2 - 1)) / 2             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+    __pyx_t_5 = PyFloat_FromDouble(((kth_smallest(__pyx_v_values, __pyx_v_n, __Pyx_div_long(__pyx_v_n, 2)) + kth_smallest(__pyx_v_values, __pyx_v_n, (__Pyx_div_long(__pyx_v_n, 2) - 1))) / 2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_r = __pyx_t_5;
+    __pyx_t_5 = 0;
+    goto __pyx_L0;
+  }
+  __pyx_L7:;
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("tseries.median");
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_DECREF((PyObject *)__pyx_v_arr);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":576
+ * # Rolling min / max
+ * 
+ * cdef void _roll_max(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
+ *                     int win, int N):
+ *     cdef double val
+ */
+
+static  void __pyx_f_7tseries__roll_max(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_win, int __pyx_v_N) {
+  double __pyx_v_val;
+  int __pyx_v_i;
+  int __pyx_v_j;
+  long __pyx_t_1;
+  int __pyx_t_2;
+  int __pyx_t_3;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  double __pyx_t_7;
+  __Pyx_RefNannySetupContext("_roll_max");
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":581
+ *     cdef int i, j
+ * 
+ *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
+ *         output[i] = NaN
+ * 
+ */
+  __pyx_t_1 = (__pyx_v_win - 1);
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_1; __pyx_v_i++) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":582
+ * 
+ *     for i from 0 <= i < win - 1:
+ *         output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ *     for i from win - 1 <= i < N:
+ */
+    (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
+  }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":561
- *         arr = np.array(arr)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":584
+ *         output[i] = NaN
  * 
- *     values = <double *> arr.data             # <<<<<<<<<<<<<<
+ *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         val = input[i - win + 1]
  * 
- *     if n % 2:
  */
-  __pyx_v_values = ((double *)((PyArrayObject *)__pyx_v_arr)->data);
+  __pyx_t_2 = __pyx_v_N;
+  for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":563
- *     values = <double *> arr.data
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":585
  * 
- *     if n % 2:             # <<<<<<<<<<<<<<
- *         return kth_smallest(values, n, n / 2)
- *     else:
+ *     for i from win - 1 <= i < N:
+ *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
+ * 
+ *         for j from (i - win + 1) <= j <= i:
  */
-  __pyx_t_6 = __Pyx_mod_long(__pyx_v_n, 2);
-  if (__pyx_t_6) {
+    __pyx_v_val = (__pyx_v_input[((__pyx_v_i - __pyx_v_win) + 1)]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":564
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":587
+ *         val = input[i - win + 1]
+ * 
+ *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
+ *             val = max(val, input[j])
  * 
- *     if n % 2:
- *         return kth_smallest(values, n, n / 2)             # <<<<<<<<<<<<<<
- *     else:
- *         return (kth_smallest(values, n, n / 2) +
  */
-    __Pyx_XDECREF(__pyx_r);
-    __pyx_t_5 = PyFloat_FromDouble(kth_smallest(__pyx_v_values, __pyx_v_n, __Pyx_div_long(__pyx_v_n, 2))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_r = __pyx_t_5;
-    __pyx_t_5 = 0;
-    goto __pyx_L0;
-    goto __pyx_L7;
-  }
-  /*else*/ {
+    __pyx_t_3 = __pyx_v_i;
+    for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_3; __pyx_v_j++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":566
- *         return kth_smallest(values, n, n / 2)
- *     else:
- *         return (kth_smallest(values, n, n / 2) +             # <<<<<<<<<<<<<<
- *                 kth_smallest(values, n, n / 2 - 1)) / 2
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":588
  * 
+ *         for j from (i - win + 1) <= j <= i:
+ *             val = max(val, input[j])             # <<<<<<<<<<<<<<
+ * 
+ *         output[j] = val
  */
-    __Pyx_XDECREF(__pyx_r);
+      __pyx_t_4 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_5 = PyFloat_FromDouble((__pyx_v_input[__pyx_v_j])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_6);
+      PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_5);
+      __pyx_t_4 = 0;
+      __pyx_t_5 = 0;
+      __pyx_t_5 = PyObject_Call(__pyx_builtin_max, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_val = __pyx_t_7;
+    }
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":567
- *     else:
- *         return (kth_smallest(values, n, n / 2) +
- *                 kth_smallest(values, n, n / 2 - 1)) / 2             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":590
+ *             val = max(val, input[j])
  * 
- * def roll_median(ndarray[npy_float64, ndim=1] arr, int window, int minp):
+ *         output[j] = val             # <<<<<<<<<<<<<<
+ * 
+ * def _roll_max_noncontig(ndarray[double_t, ndim=1] input,
  */
-    __pyx_t_5 = PyFloat_FromDouble(((kth_smallest(__pyx_v_values, __pyx_v_n, __Pyx_div_long(__pyx_v_n, 2)) + kth_smallest(__pyx_v_values, __pyx_v_n, (__Pyx_div_long(__pyx_v_n, 2) - 1))) / 2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 567; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_r = __pyx_t_5;
-    __pyx_t_5 = 0;
-    goto __pyx_L0;
+    (__pyx_v_output[__pyx_v_j]) = __pyx_v_val;
   }
-  __pyx_L7:;
 
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.median");
-  __pyx_r = NULL;
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_WriteUnraisable("tseries._roll_max");
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
-  __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
-  return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":569
- *                 kth_smallest(values, n, n / 2 - 1)) / 2
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":592
+ *         output[j] = val
  * 
- * def roll_median(ndarray[npy_float64, ndim=1] arr, int window, int minp):             # <<<<<<<<<<<<<<
- *     cdef char *mask_data
- *     cdef ndarray mask
+ * def _roll_max_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *                         ndarray[double_t, ndim=1] output,
+ *                         int win, int N):
  */
 
-static PyObject *__pyx_pf_7tseries_roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_arr = 0;
-  int __pyx_v_window;
-  int __pyx_v_minp;
-  char *__pyx_v_mask_data;
-  PyArrayObject *__pyx_v_mask;
-  PyArrayObject *__pyx_v_result;
+static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_input = 0;
+  PyArrayObject *__pyx_v_output = 0;
+  int __pyx_v_win;
+  int __pyx_v_N;
+  double __pyx_v_val;
   int __pyx_v_i;
-  int __pyx_v_n;
-  Py_buffer __pyx_bstruct_arr;
-  Py_ssize_t __pyx_bstride_0_arr = 0;
-  Py_ssize_t __pyx_bshape_0_arr = 0;
-  Py_buffer __pyx_bstruct_result;
-  Py_ssize_t __pyx_bstride_0_result = 0;
-  Py_ssize_t __pyx_bshape_0_result = 0;
+  int __pyx_v_j;
+  Py_buffer __pyx_bstruct_output;
+  Py_ssize_t __pyx_bstride_0_output = 0;
+  Py_ssize_t __pyx_bshape_0_output = 0;
+  Py_buffer __pyx_bstruct_input;
+  Py_ssize_t __pyx_bstride_0_input = 0;
+  Py_ssize_t __pyx_bshape_0_input = 0;
   PyObject *__pyx_r = NULL;
-  Py_ssize_t __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyArrayObject *__pyx_t_4 = NULL;
-  int __pyx_t_5;
-  PyObject *__pyx_t_6 = NULL;
-  PyObject *__pyx_t_7 = NULL;
+  long __pyx_t_1;
+  int __pyx_t_2;
+  int __pyx_t_3;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  int __pyx_t_6;
+  int __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
-  PyArrayObject *__pyx_t_11 = NULL;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__arr,&__pyx_n_s__window,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("roll_median");
+  double __pyx_t_10;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__output,&__pyx_n_s__win,&__pyx_n_s__N,0};
+  __Pyx_RefNannySetupContext("_roll_max_noncontig");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[3] = {0,0,0};
+    PyObject* values[4] = {0,0,0,0};
     switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -10437,235 +12042,229 @@ static PyObject *__pyx_pf_7tseries_roll_median(PyObject *__pyx_self, PyObject *_
     }
     switch (PyTuple_GET_SIZE(__pyx_args)) {
       case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__arr);
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_max_noncontig", 1, 4, 4, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
+      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_max_noncontig", 1, 4, 4, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+      case  3:
+      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
+      if (likely(values[3])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("_roll_max_noncontig", 1, 4, 4, 3); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_median") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_max_noncontig") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
-    __pyx_v_arr = ((PyArrayObject *)values[0]);
-    __pyx_v_window = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_window == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
+    __pyx_v_input = ((PyArrayObject *)values[0]);
+    __pyx_v_output = ((PyArrayObject *)values[1]);
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 594; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 594; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
     goto __pyx_L5_argtuple_error;
   } else {
-    __pyx_v_arr = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_window = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_window == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+    __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 594; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 594; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_max_noncontig", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.roll_median");
+  __Pyx_AddTraceback("tseries._roll_max_noncontig");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
-  __pyx_v_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_bstruct_result.buf = NULL;
-  __pyx_bstruct_arr.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_INCREF((PyObject *)__pyx_v_input);
+  __Pyx_INCREF((PyObject *)__pyx_v_output);
+  __pyx_bstruct_input.buf = NULL;
+  __pyx_bstruct_output.buf = NULL;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 593; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
-  __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
+  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
+  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
+  __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":575
- *     cdef int i, n
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":598
+ *     cdef int i, j
  * 
- *     n = len(arr)             # <<<<<<<<<<<<<<
- *     arr = arr.copy()
+ *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
+ *         output[i] = NaN
  * 
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_arr)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_v_n = __pyx_t_1;
+  __pyx_t_1 = (__pyx_v_win - 1);
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_1; __pyx_v_i++) {
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":576
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":599
  * 
- *     n = len(arr)
- *     arr = arr.copy()             # <<<<<<<<<<<<<<
+ *     for i from 0 <= i < win - 1:
+ *         output[i] = NaN             # <<<<<<<<<<<<<<
  * 
- *     mask = <ndarray> np.isfinite(arr)
+ *     for i from win - 1 <= i < N:
  */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_arr), __pyx_n_s__copy); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 576; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 576; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 576; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_4 = ((PyArrayObject *)__pyx_t_3);
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
-    __pyx_t_5 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_t_4, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
-    if (unlikely(__pyx_t_5 < 0)) {
-      PyErr_Fetch(&__pyx_t_6, &__pyx_t_7, &__pyx_t_8);
-      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
-        Py_XDECREF(__pyx_t_6); Py_XDECREF(__pyx_t_7); Py_XDECREF(__pyx_t_8);
-        __Pyx_RaiseBufferFallbackError();
-      } else {
-        PyErr_Restore(__pyx_t_6, __pyx_t_7, __pyx_t_8);
-      }
+    __pyx_t_2 = __pyx_v_i;
+    __pyx_t_3 = -1;
+    if (__pyx_t_2 < 0) {
+      __pyx_t_2 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
+    } else if (unlikely(__pyx_t_2 >= __pyx_bshape_0_output)) __pyx_t_3 = 0;
+    if (unlikely(__pyx_t_3 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_3);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
-    __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
-    if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 576; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_2, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
-  __pyx_t_4 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_v_arr));
-  __pyx_v_arr = ((PyArrayObject *)__pyx_t_3);
-  __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":578
- *     arr = arr.copy()
- * 
- *     mask = <ndarray> np.isfinite(arr)             # <<<<<<<<<<<<<<
- *     mask_data = <char *> mask.data
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":601
+ *         output[i] = NaN
  * 
- */
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 578; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__isfinite); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 578; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 578; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_INCREF(((PyObject *)__pyx_v_arr));
-  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_arr));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_arr));
-  __pyx_t_9 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 578; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_9);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_9)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_mask));
-  __pyx_v_mask = ((PyArrayObject *)__pyx_t_9);
-  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+ *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         val = input[i - win + 1]
+ * 
+ */
+  __pyx_t_3 = __pyx_v_N;
+  for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":579
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":602
  * 
- *     mask = <ndarray> np.isfinite(arr)
- *     mask_data = <char *> mask.data             # <<<<<<<<<<<<<<
+ *     for i from win - 1 <= i < N:
+ *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
  * 
- *     result = np.empty(len(arr), dtype=float)
+ *         for j from (i - win + 1) <= j <= i:
  */
-  __pyx_v_mask_data = ((char *)__pyx_v_mask->data);
+    __pyx_t_1 = ((__pyx_v_i - __pyx_v_win) + 1);
+    __pyx_t_4 = -1;
+    if (__pyx_t_1 < 0) {
+      __pyx_t_1 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_1 < 0)) __pyx_t_4 = 0;
+    } else if (unlikely(__pyx_t_1 >= __pyx_bshape_0_input)) __pyx_t_4 = 0;
+    if (unlikely(__pyx_t_4 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_4);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_1, __pyx_bstride_0_input));
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":581
- *     mask_data = <char *> mask.data
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":604
+ *         val = input[i - win + 1]
  * 
- *     result = np.empty(len(arr), dtype=float)             # <<<<<<<<<<<<<<
+ *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
+ *             val = max(val, input[j])
  * 
- *     for i from minp <= i <= n:
  */
-  __pyx_t_9 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_9);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_9, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_arr)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_9);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_9);
-  __Pyx_GIVEREF(__pyx_t_9);
-  __pyx_t_9 = 0;
-  __pyx_t_9 = PyDict_New(); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_9));
-  if (PyDict_SetItem(__pyx_t_9, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_10 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_2, ((PyObject *)__pyx_t_9)); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
-  if (!(likely(((__pyx_t_10) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_10, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_11 = ((PyArrayObject *)__pyx_t_10);
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
-    __pyx_t_5 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
-    if (unlikely(__pyx_t_5 < 0)) {
-      PyErr_Fetch(&__pyx_t_8, &__pyx_t_7, &__pyx_t_6);
-      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_v_result, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
-        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_7); Py_XDECREF(__pyx_t_6);
-        __Pyx_RaiseBufferFallbackError();
-      } else {
-        PyErr_Restore(__pyx_t_8, __pyx_t_7, __pyx_t_6);
+    __pyx_t_4 = __pyx_v_i;
+    for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_4; __pyx_v_j++) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":605
+ * 
+ *         for j from (i - win + 1) <= j <= i:
+ *             val = max(val, input[j])             # <<<<<<<<<<<<<<
+ * 
+ *         output[j] = val
+ */
+      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_6 = __pyx_v_j;
+      __pyx_t_7 = -1;
+      if (__pyx_t_6 < 0) {
+        __pyx_t_6 += __pyx_bshape_0_input;
+        if (unlikely(__pyx_t_6 < 0)) __pyx_t_7 = 0;
+      } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_input)) __pyx_t_7 = 0;
+      if (unlikely(__pyx_t_7 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_7);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
+      __pyx_t_8 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input))); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_8);
+      __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_9);
+      PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_5);
+      PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_8);
+      __Pyx_GIVEREF(__pyx_t_8);
+      __pyx_t_5 = 0;
+      __pyx_t_8 = 0;
+      __pyx_t_8 = PyObject_Call(__pyx_builtin_max, __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_8);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __pyx_t_10 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __pyx_v_val = __pyx_t_10;
     }
-    __pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
-    __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
-    if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_t_11 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_v_result));
-  __pyx_v_result = ((PyArrayObject *)__pyx_t_10);
-  __pyx_t_10 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":583
- *     result = np.empty(len(arr), dtype=float)
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":607
+ *             val = max(val, input[j])
  * 
- *     for i from minp <= i <= n:             # <<<<<<<<<<<<<<
- *         pass
+ *         output[j] = val             # <<<<<<<<<<<<<<
  * 
+ * cdef void _roll_min(double_t *input, double_t *output,
  */
-  __pyx_t_5 = __pyx_v_n;
-  for (__pyx_v_i = __pyx_v_minp; __pyx_v_i <= __pyx_t_5; __pyx_v_i++) {
+    __pyx_t_4 = __pyx_v_j;
+    __pyx_t_7 = -1;
+    if (__pyx_t_4 < 0) {
+      __pyx_t_4 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_4 < 0)) __pyx_t_7 = 0;
+    } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_7 = 0;
+    if (unlikely(__pyx_t_7 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_7);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_val;
   }
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries.roll_median");
+  __Pyx_AddTraceback("tseries._roll_max_noncontig");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __pyx_L2:;
-  __Pyx_DECREF((PyObject *)__pyx_v_mask);
-  __Pyx_DECREF((PyObject *)__pyx_v_result);
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
+  __Pyx_DECREF((PyObject *)__pyx_v_input);
+  __Pyx_DECREF((PyObject *)__pyx_v_output);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":590
- * # Rolling min / max
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":609
+ *         output[j] = val
  * 
- * cdef void _roll_max(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
+ * cdef void _roll_min(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
  *                     int win, int N):
  *     cdef double val
  */
 
-static  void __pyx_f_7tseries__roll_max(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_win, int __pyx_v_N) {
+static  void __pyx_f_7tseries__roll_min(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_win, int __pyx_v_N) {
   double __pyx_v_val;
   int __pyx_v_i;
   int __pyx_v_j;
@@ -10676,9 +12275,9 @@ static  void __pyx_f_7tseries__roll_max(__pyx_t_5numpy_double_t *__pyx_v_input,
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   double __pyx_t_7;
-  __Pyx_RefNannySetupContext("_roll_max");
+  __Pyx_RefNannySetupContext("_roll_min");
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":595
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":614
  *     cdef int i, j
  * 
  *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
@@ -10688,7 +12287,7 @@ static  void __pyx_f_7tseries__roll_max(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_1 = (__pyx_v_win - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_1; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":596
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":615
  * 
  *     for i from 0 <= i < win - 1:
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -10698,7 +12297,7 @@ static  void __pyx_f_7tseries__roll_max(__pyx_t_5numpy_double_t *__pyx_v_input,
     (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":598
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":617
  *         output[i] = NaN
  * 
  *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -10708,7 +12307,7 @@ static  void __pyx_f_7tseries__roll_max(__pyx_t_5numpy_double_t *__pyx_v_input,
   __pyx_t_2 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":599
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":618
  * 
  *     for i from win - 1 <= i < N:
  *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
@@ -10717,28 +12316,28 @@ static  void __pyx_f_7tseries__roll_max(__pyx_t_5numpy_double_t *__pyx_v_input,
  */
     __pyx_v_val = (__pyx_v_input[((__pyx_v_i - __pyx_v_win) + 1)]);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":601
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":620
  *         val = input[i - win + 1]
  * 
  *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
- *             val = max(val, input[j])
+ *             val = min(val, input[j])
  * 
  */
     __pyx_t_3 = __pyx_v_i;
     for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_3; __pyx_v_j++) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":602
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":621
  * 
  *         for j from (i - win + 1) <= j <= i:
- *             val = max(val, input[j])             # <<<<<<<<<<<<<<
+ *             val = min(val, input[j])             # <<<<<<<<<<<<<<
  * 
  *         output[j] = val
  */
-      __pyx_t_4 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = PyFloat_FromDouble((__pyx_v_input[__pyx_v_j])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyFloat_FromDouble((__pyx_v_input[__pyx_v_j])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_4);
@@ -10746,20 +12345,20 @@ static  void __pyx_f_7tseries__roll_max(__pyx_t_5numpy_double_t *__pyx_v_input,
       __Pyx_GIVEREF(__pyx_t_5);
       __pyx_t_4 = 0;
       __pyx_t_5 = 0;
-      __pyx_t_5 = PyObject_Call(__pyx_builtin_max, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_Call(__pyx_builtin_min, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_v_val = __pyx_t_7;
     }
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":604
- *             val = max(val, input[j])
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":623
+ *             val = min(val, input[j])
  * 
  *         output[j] = val             # <<<<<<<<<<<<<<
  * 
- * def _roll_max_noncontig(ndarray[double_t, ndim=1] input,
+ * def _roll_min_noncontig(ndarray[double_t, ndim=1] input,
  */
     (__pyx_v_output[__pyx_v_j]) = __pyx_v_val;
   }
@@ -10769,21 +12368,21 @@ static  void __pyx_f_7tseries__roll_max(__pyx_t_5numpy_double_t *__pyx_v_input,
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_WriteUnraisable("tseries._roll_max");
+  __Pyx_WriteUnraisable("tseries._roll_min");
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":606
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":625
  *         output[j] = val
  * 
- * def _roll_max_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ * def _roll_min_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
  *                         ndarray[double_t, ndim=1] output,
  *                         int win, int N):
  */
 
-static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__roll_min_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_min_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   PyArrayObject *__pyx_v_output = 0;
   int __pyx_v_win;
@@ -10809,7 +12408,7 @@ static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyO
   PyObject *__pyx_t_9 = NULL;
   double __pyx_t_10;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__output,&__pyx_n_s__win,&__pyx_n_s__N,0};
-  __Pyx_RefNannySetupContext("_roll_max_noncontig");
+  __Pyx_RefNannySetupContext("_roll_min_noncontig");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -10831,63 +12430,63 @@ static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyO
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_max_noncontig", 1, 4, 4, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_min_noncontig", 1, 4, 4, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_max_noncontig", 1, 4, 4, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_min_noncontig", 1, 4, 4, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_max_noncontig", 1, 4, 4, 3); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_min_noncontig", 1, 4, 4, 3); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_max_noncontig") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_min_noncontig") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_output = ((PyArrayObject *)values[1]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 627; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 627; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
     __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 627; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 627; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_max_noncontig", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_min_noncontig", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_max_noncontig");
+  __Pyx_AddTraceback("tseries._roll_min_noncontig");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __Pyx_INCREF((PyObject *)__pyx_v_output);
   __pyx_bstruct_input.buf = NULL;
   __pyx_bstruct_output.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
   __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":612
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":631
  *     cdef int i, j
  * 
  *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
@@ -10897,7 +12496,7 @@ static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyO
   __pyx_t_1 = (__pyx_v_win - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_1; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":613
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":632
  * 
  *     for i from 0 <= i < win - 1:
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -10912,12 +12511,12 @@ static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyO
     } else if (unlikely(__pyx_t_2 >= __pyx_bshape_0_output)) __pyx_t_3 = 0;
     if (unlikely(__pyx_t_3 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_3);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 613; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_2, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":615
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":634
  *         output[i] = NaN
  * 
  *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -10927,7 +12526,7 @@ static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyO
   __pyx_t_3 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":616
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":635
  * 
  *     for i from win - 1 <= i < N:
  *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
@@ -10942,28 +12541,28 @@ static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyO
     } else if (unlikely(__pyx_t_1 >= __pyx_bshape_0_input)) __pyx_t_4 = 0;
     if (unlikely(__pyx_t_4 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_4);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_1, __pyx_bstride_0_input));
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":618
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":637
  *         val = input[i - win + 1]
  * 
  *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
- *             val = max(val, input[j])
+ *             val = min(val, input[j])
  * 
  */
     __pyx_t_4 = __pyx_v_i;
     for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_4; __pyx_v_j++) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":619
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":638
  * 
  *         for j from (i - win + 1) <= j <= i:
- *             val = max(val, input[j])             # <<<<<<<<<<<<<<
+ *             val = min(val, input[j])             # <<<<<<<<<<<<<<
  * 
  *         output[j] = val
  */
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_6 = __pyx_v_j;
       __pyx_t_7 = -1;
@@ -10973,11 +12572,11 @@ static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyO
       } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_input)) __pyx_t_7 = 0;
       if (unlikely(__pyx_t_7 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_7);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      __pyx_t_8 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input))); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_8 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input))); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_9);
       PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_5);
@@ -10985,20 +12584,20 @@ static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyO
       __Pyx_GIVEREF(__pyx_t_8);
       __pyx_t_5 = 0;
       __pyx_t_8 = 0;
-      __pyx_t_8 = PyObject_Call(__pyx_builtin_max, __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_8 = PyObject_Call(__pyx_builtin_min, __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_10 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_v_val = __pyx_t_10;
     }
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":621
- *             val = max(val, input[j])
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":640
+ *             val = min(val, input[j])
  * 
  *         output[j] = val             # <<<<<<<<<<<<<<
  * 
- * cdef void _roll_min(double_t *input, double_t *output,
+ * def roll_median(ndarray[npy_float64, ndim=1] arr, int window, int minp):
  */
     __pyx_t_4 = __pyx_v_j;
     __pyx_t_7 = -1;
@@ -11008,196 +12607,356 @@ static PyObject *__pyx_pf_7tseries__roll_max_noncontig(PyObject *__pyx_self, PyO
     } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_7 = 0;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_val;
+  }
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
+  __Pyx_AddTraceback("tseries._roll_min_noncontig");
+  __pyx_r = NULL;
+  goto __pyx_L2;
+  __pyx_L0:;
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __pyx_L2:;
+  __Pyx_DECREF((PyObject *)__pyx_v_input);
+  __Pyx_DECREF((PyObject *)__pyx_v_output);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":642
+ *         output[j] = val
+ * 
+ * def roll_median(ndarray[npy_float64, ndim=1] arr, int window, int minp):             # <<<<<<<<<<<<<<
+ *     cdef char *mask_data
+ *     cdef ndarray mask
+ */
+
+static PyObject *__pyx_pf_7tseries_roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_arr = 0;
+  int __pyx_v_window;
+  int __pyx_v_minp;
+  char *__pyx_v_mask_data;
+  PyArrayObject *__pyx_v_mask;
+  PyArrayObject *__pyx_v_result;
+  int __pyx_v_i;
+  int __pyx_v_n;
+  Py_buffer __pyx_bstruct_arr;
+  Py_ssize_t __pyx_bstride_0_arr = 0;
+  Py_ssize_t __pyx_bshape_0_arr = 0;
+  Py_buffer __pyx_bstruct_result;
+  Py_ssize_t __pyx_bstride_0_result = 0;
+  Py_ssize_t __pyx_bshape_0_result = 0;
+  PyObject *__pyx_r = NULL;
+  Py_ssize_t __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyArrayObject *__pyx_t_4 = NULL;
+  int __pyx_t_5;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  PyArrayObject *__pyx_t_11 = NULL;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__arr,&__pyx_n_s__window,&__pyx_n_s__minp,0};
+  __Pyx_RefNannySetupContext("roll_median");
+  __pyx_self = __pyx_self;
+  if (unlikely(__pyx_kwds)) {
+    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
+    PyObject* values[3] = {0,0,0};
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      case  0: break;
+      default: goto __pyx_L5_argtuple_error;
+    }
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  0:
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__arr);
+      if (likely(values[0])) kw_args--;
+      else goto __pyx_L5_argtuple_error;
+      case  1:
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
+      if (likely(values[1])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+      case  2:
+      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
+      if (likely(values[2])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
     }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_val;
+    if (unlikely(kw_args > 0)) {
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "roll_median") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    }
+    __pyx_v_arr = ((PyArrayObject *)values[0]);
+    __pyx_v_window = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_window == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
+    goto __pyx_L5_argtuple_error;
+  } else {
+    __pyx_v_arr = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+    __pyx_v_window = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_window == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("roll_median", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries.roll_median");
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __Pyx_INCREF((PyObject *)__pyx_v_arr);
+  __pyx_v_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_bstruct_result.buf = NULL;
+  __pyx_bstruct_arr.buf = NULL;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
+  __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
 
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
-  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
-    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_max_noncontig");
-  __pyx_r = NULL;
-  goto __pyx_L2;
-  __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __pyx_L2:;
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_DECREF((PyObject *)__pyx_v_output);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "H:\pandas\pandas\lib\src\moments.pyx":623
- *         output[j] = val
- * 
- * cdef void _roll_min(double_t *input, double_t *output,             # <<<<<<<<<<<<<<
- *                     int win, int N):
- *     cdef double val
- */
-
-static  void __pyx_f_7tseries__roll_min(__pyx_t_5numpy_double_t *__pyx_v_input, __pyx_t_5numpy_double_t *__pyx_v_output, int __pyx_v_win, int __pyx_v_N) {
-  double __pyx_v_val;
-  int __pyx_v_i;
-  int __pyx_v_j;
-  long __pyx_t_1;
-  int __pyx_t_2;
-  int __pyx_t_3;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
-  double __pyx_t_7;
-  __Pyx_RefNannySetupContext("_roll_min");
-
-  /* "H:\pandas\pandas\lib\src\moments.pyx":628
- *     cdef int i, j
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":648
+ *     cdef int i, n
  * 
- *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
- *         output[i] = NaN
+ *     n = len(arr)             # <<<<<<<<<<<<<<
+ *     arr = arr.copy()
  * 
  */
-  __pyx_t_1 = (__pyx_v_win - 1);
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_1; __pyx_v_i++) {
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_arr)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_n = __pyx_t_1;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":629
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":649
  * 
- *     for i from 0 <= i < win - 1:
- *         output[i] = NaN             # <<<<<<<<<<<<<<
+ *     n = len(arr)
+ *     arr = arr.copy()             # <<<<<<<<<<<<<<
  * 
- *     for i from win - 1 <= i < N:
+ *     mask = <ndarray> np.isfinite(arr)
  */
-    (__pyx_v_output[__pyx_v_i]) = __pyx_v_7tseries_NaN;
+  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_arr), __pyx_n_s__copy); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = ((PyArrayObject *)__pyx_t_3);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
+    __pyx_t_5 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_t_4, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_5 < 0)) {
+      PyErr_Fetch(&__pyx_t_6, &__pyx_t_7, &__pyx_t_8);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_6); Py_XDECREF(__pyx_t_7); Py_XDECREF(__pyx_t_8);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_6, __pyx_t_7, __pyx_t_8);
+      }
+    }
+    __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
+    __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
+    if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
+  __pyx_t_4 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_arr));
+  __pyx_v_arr = ((PyArrayObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":631
- *         output[i] = NaN
- * 
- *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
- *         val = input[i - win + 1]
- * 
- */
-  __pyx_t_2 = __pyx_v_N;
-  for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
-
-    /* "H:\pandas\pandas\lib\src\moments.pyx":632
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":651
+ *     arr = arr.copy()
  * 
- *     for i from win - 1 <= i < N:
- *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
+ *     mask = <ndarray> np.isfinite(arr)             # <<<<<<<<<<<<<<
+ *     mask_data = <char *> mask.data
  * 
- *         for j from (i - win + 1) <= j <= i:
  */
-    __pyx_v_val = (__pyx_v_input[((__pyx_v_i - __pyx_v_win) + 1)]);
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__isfinite); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_INCREF(((PyObject *)__pyx_v_arr));
+  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_arr));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_arr));
+  __pyx_t_9 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_9);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_9)));
+  __Pyx_DECREF(((PyObject *)__pyx_v_mask));
+  __pyx_v_mask = ((PyArrayObject *)__pyx_t_9);
+  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":634
- *         val = input[i - win + 1]
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":652
  * 
- *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
- *             val = min(val, input[j])
+ *     mask = <ndarray> np.isfinite(arr)
+ *     mask_data = <char *> mask.data             # <<<<<<<<<<<<<<
  * 
+ *     result = np.empty(len(arr), dtype=float)
  */
-    __pyx_t_3 = __pyx_v_i;
-    for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_3; __pyx_v_j++) {
+  __pyx_v_mask_data = ((char *)__pyx_v_mask->data);
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":635
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":654
+ *     mask_data = <char *> mask.data
  * 
- *         for j from (i - win + 1) <= j <= i:
- *             val = min(val, input[j])             # <<<<<<<<<<<<<<
+ *     result = np.empty(len(arr), dtype=float)             # <<<<<<<<<<<<<<
  * 
- *         output[j] = val
+ *     for i from minp <= i <= n:
  */
-      __pyx_t_4 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = PyFloat_FromDouble((__pyx_v_input[__pyx_v_j])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_6);
-      PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
-      __Pyx_GIVEREF(__pyx_t_4);
-      PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
-      __Pyx_GIVEREF(__pyx_t_5);
-      __pyx_t_4 = 0;
-      __pyx_t_5 = 0;
-      __pyx_t_5 = PyObject_Call(__pyx_builtin_min, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_v_val = __pyx_t_7;
+  __pyx_t_9 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_9);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_9, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_arr)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_9);
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_9);
+  __Pyx_GIVEREF(__pyx_t_9);
+  __pyx_t_9 = 0;
+  __pyx_t_9 = PyDict_New(); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_9));
+  if (PyDict_SetItem(__pyx_t_9, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_10 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_2, ((PyObject *)__pyx_t_9)); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_10);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
+  if (!(likely(((__pyx_t_10) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_10, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_11 = ((PyArrayObject *)__pyx_t_10);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
+    __pyx_t_5 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_5 < 0)) {
+      PyErr_Fetch(&__pyx_t_8, &__pyx_t_7, &__pyx_t_6);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_v_result, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_7); Py_XDECREF(__pyx_t_6);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_8, __pyx_t_7, __pyx_t_6);
+      }
     }
+    __pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
+    __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
+    if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_t_11 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_result));
+  __pyx_v_result = ((PyArrayObject *)__pyx_t_10);
+  __pyx_t_10 = 0;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":637
- *             val = min(val, input[j])
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":656
+ *     result = np.empty(len(arr), dtype=float)
  * 
- *         output[j] = val             # <<<<<<<<<<<<<<
+ *     for i from minp <= i <= n:             # <<<<<<<<<<<<<<
+ *         pass
  * 
- * def _roll_min_noncontig(ndarray[double_t, ndim=1] input,
  */
-    (__pyx_v_output[__pyx_v_j]) = __pyx_v_val;
+  __pyx_t_5 = __pyx_v_n;
+  for (__pyx_v_i = __pyx_v_minp; __pyx_v_i <= __pyx_t_5; __pyx_v_i++) {
   }
 
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_WriteUnraisable("tseries._roll_min");
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
+  __Pyx_AddTraceback("tseries.roll_median");
+  __pyx_r = NULL;
+  goto __pyx_L2;
   __pyx_L0:;
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
+  __pyx_L2:;
+  __Pyx_DECREF((PyObject *)__pyx_v_mask);
+  __Pyx_DECREF((PyObject *)__pyx_v_result);
+  __Pyx_DECREF((PyObject *)__pyx_v_arr);
+  __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
+  return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":639
- *         output[j] = val
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":659
+ *         pass
  * 
- * def _roll_min_noncontig(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *                         ndarray[double_t, ndim=1] output,
- *                         int win, int N):
- */
-
-static PyObject *__pyx_pf_7tseries__roll_min_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_min_noncontig(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_input = 0;
-  PyArrayObject *__pyx_v_output = 0;
-  int __pyx_v_win;
-  int __pyx_v_N;
-  double __pyx_v_val;
-  int __pyx_v_i;
-  int __pyx_v_j;
-  Py_buffer __pyx_bstruct_output;
-  Py_ssize_t __pyx_bstride_0_output = 0;
-  Py_ssize_t __pyx_bshape_0_output = 0;
-  Py_buffer __pyx_bstruct_input;
-  Py_ssize_t __pyx_bstride_0_input = 0;
-  Py_ssize_t __pyx_bshape_0_input = 0;
+ * def rolling_median(ndarray[double, ndim=1] arr, int window):             # <<<<<<<<<<<<<<
+ *     cdef int i, n, midpoint
+ *     cdef IndexableSkiplist skiplist
+ */
+
+static PyObject *__pyx_pf_7tseries_rolling_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_rolling_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_arr = 0;
+  int __pyx_v_window;
+  int __pyx_v_i;
+  int __pyx_v_n;
+  int __pyx_v_midpoint;
+  struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_skiplist;
+  PyArrayObject *__pyx_v_result;
+  int __pyx_v_flag;
+  Py_buffer __pyx_bstruct_arr;
+  Py_ssize_t __pyx_bstride_0_arr = 0;
+  Py_ssize_t __pyx_bshape_0_arr = 0;
+  Py_buffer __pyx_bstruct_result;
+  Py_ssize_t __pyx_bstride_0_result = 0;
+  Py_ssize_t __pyx_bshape_0_result = 0;
   PyObject *__pyx_r = NULL;
-  long __pyx_t_1;
-  int __pyx_t_2;
-  int __pyx_t_3;
-  int __pyx_t_4;
+  Py_ssize_t __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
+  PyArrayObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
-  double __pyx_t_10;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__output,&__pyx_n_s__win,&__pyx_n_s__N,0};
-  __Pyx_RefNannySetupContext("_roll_min_noncontig");
+  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_11;
+  int __pyx_t_12;
+  int __pyx_t_13;
+  int __pyx_t_14;
+  double __pyx_t_15;
+  int __pyx_t_16;
+  int __pyx_t_17;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__arr,&__pyx_n_s__window,0};
+  __Pyx_RefNannySetupContext("rolling_median");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[4] = {0,0,0,0};
+    PyObject* values[2] = {0,0};
     switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       case  0: break;
@@ -11205,221 +12964,436 @@ static PyObject *__pyx_pf_7tseries__roll_min_noncontig(PyObject *__pyx_self, PyO
     }
     switch (PyTuple_GET_SIZE(__pyx_args)) {
       case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__arr);
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_min_noncontig", 1, 4, 4, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
-      if (likely(values[2])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_min_noncontig", 1, 4, 4, 2); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  3:
-      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__N);
-      if (likely(values[3])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_min_noncontig", 1, 4, 4, 3); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_median", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_min_noncontig") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_median") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
-    __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_output = ((PyArrayObject *)values[1]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(values[3]); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
+    __pyx_v_arr = ((PyArrayObject *)values[0]);
+    __pyx_v_window = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_window == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
     goto __pyx_L5_argtuple_error;
   } else {
-    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_output = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_N = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_N == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_arr = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+    __pyx_v_window = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_window == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_min_noncontig", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_median", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_min_noncontig");
+  __Pyx_AddTraceback("tseries.rolling_median");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
-  __Pyx_INCREF((PyObject *)__pyx_v_output);
-  __pyx_bstruct_input.buf = NULL;
-  __pyx_bstruct_output.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_output), __pyx_ptype_5numpy_ndarray, 1, "output", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_INCREF((PyObject *)__pyx_v_arr);
+  __pyx_v_skiplist = ((struct __pyx_obj_7tseries_IndexableSkiplist *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_bstruct_result.buf = NULL;
+  __pyx_bstruct_arr.buf = NULL;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
-  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
+  __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
+  __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":664
+ *     cdef ndarray[double, ndim=1] result
+ * 
+ *     n = len(arr)             # <<<<<<<<<<<<<<
+ *     skiplist = IndexableSkiplist(window)
+ *     result = np.empty(n, dtype=float)
+ */
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_arr)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 664; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_n = __pyx_t_1;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":665
+ * 
+ *     n = len(arr)
+ *     skiplist = IndexableSkiplist(window)             # <<<<<<<<<<<<<<
+ *     result = np.empty(n, dtype=float)
+ *     result[:window] = NaN
+ */
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_window); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_IndexableSkiplist)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_skiplist));
+  __pyx_v_skiplist = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":666
+ *     n = len(arr)
+ *     skiplist = IndexableSkiplist(window)
+ *     result = np.empty(n, dtype=float)             # <<<<<<<<<<<<<<
+ *     result[:window] = NaN
+ * 
+ */
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_v_output, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
+    __pyx_t_7 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_7 < 0)) {
+      PyErr_Fetch(&__pyx_t_8, &__pyx_t_9, &__pyx_t_10);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_v_result, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_8, __pyx_t_9, __pyx_t_10);
+      }
+    }
+    __pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
+    __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
+    if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
-  __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
+  __pyx_t_6 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_result));
+  __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
+  __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":645
- *     cdef int i, j
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":667
+ *     skiplist = IndexableSkiplist(window)
+ *     result = np.empty(n, dtype=float)
+ *     result[:window] = NaN             # <<<<<<<<<<<<<<
  * 
- *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
- *         output[i] = NaN
+ *     for i from 0 <= i < window:
+ */
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_7tseries_NaN); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 667; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  if (PySequence_SetSlice(((PyObject *)__pyx_v_result), 0, __pyx_v_window, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 667; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":669
+ *     result[:window] = NaN
+ * 
+ *     for i from 0 <= i < window:             # <<<<<<<<<<<<<<
+ *         skiplist.insert(arr[i])
  * 
  */
-  __pyx_t_1 = (__pyx_v_win - 1);
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_1; __pyx_v_i++) {
+  __pyx_t_7 = __pyx_v_window;
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":646
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":670
  * 
- *     for i from 0 <= i < win - 1:
- *         output[i] = NaN             # <<<<<<<<<<<<<<
+ *     for i from 0 <= i < window:
+ *         skiplist.insert(arr[i])             # <<<<<<<<<<<<<<
  * 
- *     for i from win - 1 <= i < N:
+ *     midpoint = window / 2
  */
-    __pyx_t_2 = __pyx_v_i;
-    __pyx_t_3 = -1;
-    if (__pyx_t_2 < 0) {
-      __pyx_t_2 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
-    } else if (unlikely(__pyx_t_2 >= __pyx_bshape_0_output)) __pyx_t_3 = 0;
-    if (unlikely(__pyx_t_3 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_3);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__insert); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_11 = __pyx_v_i;
+    __pyx_t_12 = -1;
+    if (__pyx_t_11 < 0) {
+      __pyx_t_11 += __pyx_bshape_0_arr;
+      if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
+    } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_arr)) __pyx_t_12 = 0;
+    if (unlikely(__pyx_t_12 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_12);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_2, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
+    __pyx_t_2 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(double *, __pyx_bstruct_arr.buf, __pyx_t_11, __pyx_bstride_0_arr))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+    __Pyx_GIVEREF(__pyx_t_2);
+    __pyx_t_2 = 0;
+    __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":648
- *         output[i] = NaN
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":672
+ *         skiplist.insert(arr[i])
  * 
- *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
- *         val = input[i - win + 1]
+ *     midpoint = window / 2             # <<<<<<<<<<<<<<
  * 
+ *     cdef int flag = window % 2
  */
-  __pyx_t_3 = __pyx_v_N;
-  for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
+  __pyx_v_midpoint = __Pyx_div_long(__pyx_v_window, 2);
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":649
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":674
+ *     midpoint = window / 2
  * 
- *     for i from win - 1 <= i < N:
- *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
+ *     cdef int flag = window % 2             # <<<<<<<<<<<<<<
  * 
- *         for j from (i - win + 1) <= j <= i:
+ *     for i from window <= i < n:
  */
-    __pyx_t_1 = ((__pyx_v_i - __pyx_v_win) + 1);
-    __pyx_t_4 = -1;
-    if (__pyx_t_1 < 0) {
-      __pyx_t_1 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_1 < 0)) __pyx_t_4 = 0;
-    } else if (unlikely(__pyx_t_1 >= __pyx_bshape_0_input)) __pyx_t_4 = 0;
-    if (unlikely(__pyx_t_4 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_4);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_flag = __Pyx_mod_long(__pyx_v_window, 2);
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":676
+ *     cdef int flag = window % 2
+ * 
+ *     for i from window <= i < n:             # <<<<<<<<<<<<<<
+ *         skiplist.remove(arr[i - window])
+ *         skiplist.insert(arr[i])
+ */
+  __pyx_t_7 = __pyx_v_n;
+  for (__pyx_v_i = __pyx_v_window; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":677
+ * 
+ *     for i from window <= i < n:
+ *         skiplist.remove(arr[i - window])             # <<<<<<<<<<<<<<
+ *         skiplist.insert(arr[i])
+ * 
+ */
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__remove); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_12 = (__pyx_v_i - __pyx_v_window);
+    __pyx_t_13 = -1;
+    if (__pyx_t_12 < 0) {
+      __pyx_t_12 += __pyx_bshape_0_arr;
+      if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 0;
+    } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_arr)) __pyx_t_13 = 0;
+    if (unlikely(__pyx_t_13 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_13);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_1, __pyx_bstride_0_input));
+    __pyx_t_4 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(double *, __pyx_bstruct_arr.buf, __pyx_t_12, __pyx_bstride_0_arr))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_4);
+    __pyx_t_4 = 0;
+    __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":651
- *         val = input[i - win + 1]
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":678
+ *     for i from window <= i < n:
+ *         skiplist.remove(arr[i - window])
+ *         skiplist.insert(arr[i])             # <<<<<<<<<<<<<<
  * 
- *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
- *             val = min(val, input[j])
+ *         if flag:
+ */
+    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__insert); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_13 = __pyx_v_i;
+    __pyx_t_14 = -1;
+    if (__pyx_t_13 < 0) {
+      __pyx_t_13 += __pyx_bshape_0_arr;
+      if (unlikely(__pyx_t_13 < 0)) __pyx_t_14 = 0;
+    } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_arr)) __pyx_t_14 = 0;
+    if (unlikely(__pyx_t_14 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_14);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_t_5 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(double *, __pyx_bstruct_arr.buf, __pyx_t_13, __pyx_bstride_0_arr))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_5);
+    __pyx_t_5 = 0;
+    __pyx_t_5 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":680
+ *         skiplist.insert(arr[i])
  * 
+ *         if flag:             # <<<<<<<<<<<<<<
+ *             result[i] = skiplist.get(midpoint)
+ *         else:
  */
-    __pyx_t_4 = __pyx_v_i;
-    for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_4; __pyx_v_j++) {
+    __pyx_t_14 = __pyx_v_flag;
+    if (__pyx_t_14) {
 
-      /* "H:\pandas\pandas\lib\src\moments.pyx":652
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":681
  * 
- *         for j from (i - win + 1) <= j <= i:
- *             val = min(val, input[j])             # <<<<<<<<<<<<<<
+ *         if flag:
+ *             result[i] = skiplist.get(midpoint)             # <<<<<<<<<<<<<<
+ *         else:
+ *             result[i] = (skiplist.get(midpoint) +
+ */
+      __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_2 = PyInt_FromLong(__pyx_v_midpoint); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+      __Pyx_GIVEREF(__pyx_t_2);
+      __pyx_t_2 = 0;
+      __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_14 = __pyx_v_i;
+      __pyx_t_16 = -1;
+      if (__pyx_t_14 < 0) {
+        __pyx_t_14 += __pyx_bshape_0_result;
+        if (unlikely(__pyx_t_14 < 0)) __pyx_t_16 = 0;
+      } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_result)) __pyx_t_16 = 0;
+      if (unlikely(__pyx_t_16 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_16);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(double *, __pyx_bstruct_result.buf, __pyx_t_14, __pyx_bstride_0_result) = __pyx_t_15;
+      goto __pyx_L10;
+    }
+    /*else*/ {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":683
+ *             result[i] = skiplist.get(midpoint)
+ *         else:
+ *             result[i] = (skiplist.get(midpoint) +             # <<<<<<<<<<<<<<
+ *                          skiplist.get(midpoint - 1)) / 2
  * 
- *         output[j] = val
  */
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_4 = PyInt_FromLong(__pyx_v_midpoint); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __pyx_v_j;
-      __pyx_t_7 = -1;
-      if (__pyx_t_6 < 0) {
-        __pyx_t_6 += __pyx_bshape_0_input;
-        if (unlikely(__pyx_t_6 < 0)) __pyx_t_7 = 0;
-      } else if (unlikely(__pyx_t_6 >= __pyx_bshape_0_input)) __pyx_t_7 = 0;
-      if (unlikely(__pyx_t_7 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_7);
-        {__pyx_filename = __pyx_f[1]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
+      __Pyx_GIVEREF(__pyx_t_4);
+      __pyx_t_4 = 0;
+      __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":684
+ *         else:
+ *             result[i] = (skiplist.get(midpoint) +
+ *                          skiplist.get(midpoint - 1)) / 2             # <<<<<<<<<<<<<<
+ * 
+ *     return result
+ */
+      __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_2 = PyInt_FromLong((__pyx_v_midpoint - 1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+      __Pyx_GIVEREF(__pyx_t_2);
+      __pyx_t_2 = 0;
+      __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_int_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":683
+ *             result[i] = skiplist.get(midpoint)
+ *         else:
+ *             result[i] = (skiplist.get(midpoint) +             # <<<<<<<<<<<<<<
+ *                          skiplist.get(midpoint - 1)) / 2
+ * 
+ */
+      __pyx_t_16 = __pyx_v_i;
+      __pyx_t_17 = -1;
+      if (__pyx_t_16 < 0) {
+        __pyx_t_16 += __pyx_bshape_0_result;
+        if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
+      } else if (unlikely(__pyx_t_16 >= __pyx_bshape_0_result)) __pyx_t_17 = 0;
+      if (unlikely(__pyx_t_17 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_17);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      __pyx_t_8 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_6, __pyx_bstride_0_input))); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_9);
-      PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_5);
-      __Pyx_GIVEREF(__pyx_t_5);
-      PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_8);
-      __Pyx_GIVEREF(__pyx_t_8);
-      __pyx_t_5 = 0;
-      __pyx_t_8 = 0;
-      __pyx_t_8 = PyObject_Call(__pyx_builtin_min, __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_8);
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_10 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_v_val = __pyx_t_10;
+      *__Pyx_BufPtrStrided1d(double *, __pyx_bstruct_result.buf, __pyx_t_16, __pyx_bstride_0_result) = __pyx_t_15;
     }
+    __pyx_L10:;
+  }
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":654
- *             val = min(val, input[j])
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":686
+ *                          skiplist.get(midpoint - 1)) / 2
  * 
- *         output[j] = val             # <<<<<<<<<<<<<<
+ *     return result             # <<<<<<<<<<<<<<
  * 
  * #-------------------------------------------------------------------------------
  */
-    __pyx_t_4 = __pyx_v_j;
-    __pyx_t_7 = -1;
-    if (__pyx_t_4 < 0) {
-      __pyx_t_4 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_4 < 0)) __pyx_t_7 = 0;
-    } else if (unlikely(__pyx_t_4 >= __pyx_bshape_0_output)) __pyx_t_7 = 0;
-    if (unlikely(__pyx_t_7 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_4, __pyx_bstride_0_output) = __pyx_v_val;
-  }
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)__pyx_v_result));
+  __pyx_r = ((PyObject *)__pyx_v_result);
+  goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_min_noncontig");
+  __Pyx_AddTraceback("tseries.rolling_median");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
   __pyx_L2:;
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_DECREF((PyObject *)__pyx_v_output);
+  __Pyx_DECREF((PyObject *)__pyx_v_skiplist);
+  __Pyx_DECREF((PyObject *)__pyx_v_result);
+  __Pyx_DECREF((PyObject *)__pyx_v_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":661
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":693
  * # I could use function pointers here and trim down the code duplication
  * 
  * def rolling_sum(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
@@ -11469,7 +13443,7 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_sum", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_sum", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 693; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -11478,7 +13452,7 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_sum") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_sum") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 693; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -11497,7 +13471,7 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_sum", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_sum", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 693; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.rolling_sum");
   return NULL;
@@ -11506,23 +13480,23 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
   __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":675
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":707
  *     ndarray with length of input
  *     '''
  *     N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     if minp is None:
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 707; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 707; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_v_N);
   __pyx_v_N = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":677
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":709
  *     N = len(input)
  * 
  *     if minp is None:             # <<<<<<<<<<<<<<
@@ -11532,7 +13506,7 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
   __pyx_t_3 = (__pyx_v_minp == Py_None);
   if (__pyx_t_3) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":678
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":710
  * 
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
@@ -11546,42 +13520,42 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":680
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":712
  *         minp = window
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 680; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 680; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_4, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 680; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_4, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_5 = (!__pyx_t_3);
   if (__pyx_t_5) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":681
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":713
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)
  */
-    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
     PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
     __pyx_t_6 = 0;
@@ -11589,36 +13563,36 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":683
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":715
  *         input = input.astype(float)
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if is_contiguous(input):
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_N);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_N);
   __Pyx_GIVEREF(__pyx_v_N);
-  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_4));
-  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_6, ((PyObject *)__pyx_t_4)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_6, ((PyObject *)__pyx_t_4)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_output = ((PyArrayObject *)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":685
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":717
  *     cdef ndarray output = np.empty(N, dtype=float)
  * 
  *     if is_contiguous(input):             # <<<<<<<<<<<<<<
@@ -11628,31 +13602,31 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
   __pyx_t_8 = __pyx_f_7tseries_is_contiguous(__pyx_v_input);
   if (__pyx_t_8) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":687
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":719
  *     if is_contiguous(input):
  *         _roll_sum(get_double_ptr(input), get_double_ptr(output),
  *                    window, minp, N)             # <<<<<<<<<<<<<<
  *     else:
  *         _roll_sum_noncontig(input, output, window, minp, N)
  */
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_f_7tseries__roll_sum(__pyx_f_7tseries_get_double_ptr(__pyx_v_input), __pyx_f_7tseries_get_double_ptr(__pyx_v_output), __pyx_t_8, __pyx_t_9, __pyx_t_10);
     goto __pyx_L8;
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":689
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":721
  *                    window, minp, N)
  *     else:
  *         _roll_sum_noncontig(input, output, window, minp, N)             # <<<<<<<<<<<<<<
  * 
  *     return output
  */
-    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_sum_noncontig); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_sum_noncontig); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 721; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 721; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(((PyObject *)__pyx_v_input));
     PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_input));
@@ -11669,7 +13643,7 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
     __Pyx_INCREF(__pyx_v_N);
     PyTuple_SET_ITEM(__pyx_t_4, 4, __pyx_v_N);
     __Pyx_GIVEREF(__pyx_v_N);
-    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 721; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -11677,7 +13651,7 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L8:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":691
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":723
  *         _roll_sum_noncontig(input, output, window, minp, N)
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -11709,7 +13683,7 @@ static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":693
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":725
  *     return output
  * 
  * def rolling_mean(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
@@ -11758,7 +13732,7 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_mean", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 693; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_mean", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 725; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -11767,7 +13741,7 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_mean") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 693; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_mean") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 725; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -11786,7 +13760,7 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_mean", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 693; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_mean", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 725; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.rolling_mean");
   return NULL;
@@ -11795,23 +13769,23 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
   __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 725; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":694
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":726
  * 
  * def rolling_mean(ndarray input, window, minp=None):
  *     N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     if minp is None:
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 694; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 694; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_v_N);
   __pyx_v_N = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":696
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":728
  *     N = len(input)
  * 
  *     if minp is None:             # <<<<<<<<<<<<<<
@@ -11821,7 +13795,7 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
   __pyx_t_3 = (__pyx_v_minp == Py_None);
   if (__pyx_t_3) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":697
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":729
  * 
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
@@ -11835,42 +13809,42 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":699
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":731
  *         minp = window
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 699; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 699; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_4, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 699; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_4, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_5 = (!__pyx_t_3);
   if (__pyx_t_5) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":700
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":732
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)
  */
-    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 700; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 700; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
     PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 700; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 700; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
     __pyx_t_6 = 0;
@@ -11878,36 +13852,36 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":702
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":734
  *         input = input.astype(float)
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if is_contiguous(input):
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_N);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_N);
   __Pyx_GIVEREF(__pyx_v_N);
-  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_4));
-  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_6, ((PyObject *)__pyx_t_4)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_6, ((PyObject *)__pyx_t_4)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_output = ((PyArrayObject *)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":704
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":736
  *     cdef ndarray output = np.empty(N, dtype=float)
  * 
  *     if is_contiguous(input):             # <<<<<<<<<<<<<<
@@ -11917,31 +13891,31 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
   __pyx_t_8 = __pyx_f_7tseries_is_contiguous(__pyx_v_input);
   if (__pyx_t_8) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":706
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":738
  *     if is_contiguous(input):
  *         _roll_mean(get_double_ptr(input), get_double_ptr(output),
  *                    window, minp, N)             # <<<<<<<<<<<<<<
  *     else:
  *         _roll_mean_noncontig(input, output, window, minp, N)
  */
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_f_7tseries__roll_mean(__pyx_f_7tseries_get_double_ptr(__pyx_v_input), __pyx_f_7tseries_get_double_ptr(__pyx_v_output), __pyx_t_8, __pyx_t_9, __pyx_t_10);
     goto __pyx_L8;
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":708
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":740
  *                    window, minp, N)
  *     else:
  *         _roll_mean_noncontig(input, output, window, minp, N)             # <<<<<<<<<<<<<<
  * 
  *     return output
  */
-    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_4); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_5); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(((PyObject *)__pyx_v_input));
     PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_input));
@@ -11958,7 +13932,7 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
     __Pyx_INCREF(__pyx_v_N);
     PyTuple_SET_ITEM(__pyx_t_4, 4, __pyx_v_N);
     __Pyx_GIVEREF(__pyx_v_N);
-    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -11966,7 +13940,7 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
   }
   __pyx_L8:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":710
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":742
  *         _roll_mean_noncontig(input, output, window, minp, N)
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -11998,7 +13972,7 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":713
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":745
  * 
  * 
  * def ewma(ndarray input, com):             # <<<<<<<<<<<<<<
@@ -12043,11 +14017,11 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__com);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "ewma") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "ewma") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_com = values[1];
@@ -12059,7 +14033,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.ewma");
   return NULL;
@@ -12067,58 +14041,58 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __Pyx_INCREF(__pyx_v_com);
   __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 745; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":714
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":746
  * 
  * def ewma(ndarray input, com):
  *     N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     if not issubclass(input.dtype.type, float):
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 714; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 714; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_v_N);
   __pyx_v_N = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":716
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":748
  *     N = len(input)
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_5 = (!__pyx_t_4);
   if (__pyx_t_5) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":717
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":749
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)
  */
-    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
     PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
     __pyx_t_6 = 0;
@@ -12126,36 +14100,36 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":719
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":751
  *         input = input.astype(float)
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if is_contiguous(input):
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_N);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_N);
   __Pyx_GIVEREF(__pyx_v_N);
-  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_3));
-  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_6, ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_6, ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
-  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_output = ((PyArrayObject *)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":721
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":753
  *     cdef ndarray output = np.empty(N, dtype=float)
  * 
  *     if is_contiguous(input):             # <<<<<<<<<<<<<<
@@ -12165,30 +14139,30 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   __pyx_t_8 = __pyx_f_7tseries_is_contiguous(__pyx_v_input);
   if (__pyx_t_8) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":723
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":755
  *     if is_contiguous(input):
  *         _ewma(get_double_ptr(input), get_double_ptr(output),
  *               com, N)             # <<<<<<<<<<<<<<
  *     else:
  *         _ewma_noncontig(input, output, com, N)
  */
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_com); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 723; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 723; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_com); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_f_7tseries__ewma(__pyx_f_7tseries_get_double_ptr(__pyx_v_input), __pyx_f_7tseries_get_double_ptr(__pyx_v_output), __pyx_t_8, __pyx_t_9);
     goto __pyx_L7;
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":725
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":757
  *               com, N)
  *     else:
  *         _ewma_noncontig(input, output, com, N)             # <<<<<<<<<<<<<<
  * 
  *     return output
  */
-    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s___ewma_noncontig); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 725; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s___ewma_noncontig); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 725; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(((PyObject *)__pyx_v_input));
     PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_input));
@@ -12202,7 +14176,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
     __Pyx_INCREF(__pyx_v_N);
     PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_v_N);
     __Pyx_GIVEREF(__pyx_v_N);
-    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 725; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -12210,7 +14184,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":727
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":759
  *         _ewma_noncontig(input, output, com, N)
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -12241,7 +14215,7 @@ static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_ar
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":729
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":761
  *     return output
  * 
  * def rolling_var(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
@@ -12290,7 +14264,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_var", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_var", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -12299,7 +14273,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_var") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_var") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -12318,7 +14292,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_var", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_var", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.rolling_var");
   return NULL;
@@ -12327,23 +14301,23 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
   __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":730
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":762
  * 
  * def rolling_var(ndarray input, window, minp=None):
  *     N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     if minp is None:
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_v_N);
   __pyx_v_N = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":732
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":764
  *     N = len(input)
  * 
  *     if minp is None:             # <<<<<<<<<<<<<<
@@ -12353,7 +14327,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   __pyx_t_3 = (__pyx_v_minp == Py_None);
   if (__pyx_t_3) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":733
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":765
  * 
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
@@ -12367,14 +14341,14 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":735
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":767
  *         minp = window
  *     else:
  *         minp = max(2, minp)             # <<<<<<<<<<<<<<
  * 
  *     if not issubclass(input.dtype.type, float):
  */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 767; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_int_2);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
@@ -12382,7 +14356,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
     __Pyx_INCREF(__pyx_v_minp);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
     __Pyx_GIVEREF(__pyx_v_minp);
-    __pyx_t_4 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 767; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_v_minp);
@@ -12391,42 +14365,42 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":737
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":769
  *         minp = max(2, minp)
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 769; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 769; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 769; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_5 = (!__pyx_t_3);
   if (__pyx_t_5) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":738
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":770
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)
  */
-    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
     PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
     __pyx_t_6 = 0;
@@ -12434,36 +14408,36 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":740
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":772
  *         input = input.astype(float)
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if is_contiguous(input):
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_N);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_N);
   __Pyx_GIVEREF(__pyx_v_N);
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_output = ((PyArrayObject *)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":742
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":774
  *     cdef ndarray output = np.empty(N, dtype=float)
  * 
  *     if is_contiguous(input):             # <<<<<<<<<<<<<<
@@ -12473,31 +14447,31 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   __pyx_t_8 = __pyx_f_7tseries_is_contiguous(__pyx_v_input);
   if (__pyx_t_8) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":744
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":776
  *     if is_contiguous(input):
  *         _roll_var(get_double_ptr(input), get_double_ptr(output),
  *                    window, minp, N)             # <<<<<<<<<<<<<<
  *     else:
  *         _roll_var_noncontig(input, output, window, minp, N)
  */
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_f_7tseries__roll_var(__pyx_f_7tseries_get_double_ptr(__pyx_v_input), __pyx_f_7tseries_get_double_ptr(__pyx_v_output), __pyx_t_8, __pyx_t_9, __pyx_t_10);
     goto __pyx_L8;
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":746
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":778
  *                    window, minp, N)
  *     else:
  *         _roll_var_noncontig(input, output, window, minp, N)             # <<<<<<<<<<<<<<
  * 
  *     return output
  */
-    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_var_noncontig); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_var_noncontig); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_v_input));
     PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
@@ -12514,7 +14488,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
     __Pyx_INCREF(__pyx_v_N);
     PyTuple_SET_ITEM(__pyx_t_2, 4, __pyx_v_N);
     __Pyx_GIVEREF(__pyx_v_N);
-    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
@@ -12522,7 +14496,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L8:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":748
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":780
  *         _roll_var_noncontig(input, output, window, minp, N)
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -12554,7 +14528,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":750
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":782
  *     return output
  * 
  * def rolling_std(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
@@ -12596,7 +14570,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -12605,7 +14579,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_std") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_std") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -12624,24 +14598,24 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.rolling_std");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_v_output = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":751
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":783
  * 
  * def rolling_std(ndarray input, window, minp=None):
  *     output = rolling_var(input, window, minp=minp)             # <<<<<<<<<<<<<<
  * 
  *     return np.sqrt(output)
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__rolling_var); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__rolling_var); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_input));
   PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
@@ -12649,10 +14623,10 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   __Pyx_INCREF(__pyx_v_window);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_window);
   __Pyx_GIVEREF(__pyx_v_window);
-  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_3));
-  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__minp), __pyx_v_minp) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_2, ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__minp), __pyx_v_minp) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_2, ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
@@ -12661,7 +14635,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   __pyx_v_output = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":753
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":785
  *     output = rolling_var(input, window, minp=minp)
  * 
  *     return np.sqrt(output)             # <<<<<<<<<<<<<<
@@ -12669,17 +14643,17 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
  * def rolling_skew(ndarray input, window, minp=None):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__sqrt); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__sqrt); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_output);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_output);
   __Pyx_GIVEREF(__pyx_v_output);
-  __pyx_t_2 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -12703,7 +14677,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":755
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":787
  *     return np.sqrt(output)
  * 
  * def rolling_skew(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
@@ -12752,7 +14726,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -12761,7 +14735,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_skew") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_skew") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -12780,7 +14754,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.rolling_skew");
   return NULL;
@@ -12789,23 +14763,23 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
   __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":756
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":788
  * 
  * def rolling_skew(ndarray input, window, minp=None):
  *     N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     if minp is None:
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_v_N);
   __pyx_v_N = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":758
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":790
  *     N = len(input)
  * 
  *     if minp is None:             # <<<<<<<<<<<<<<
@@ -12815,7 +14789,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   __pyx_t_3 = (__pyx_v_minp == Py_None);
   if (__pyx_t_3) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":759
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":791
  * 
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
@@ -12829,14 +14803,14 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":761
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":793
  *         minp = window
  *     else:
  *         minp = max(2, minp)             # <<<<<<<<<<<<<<
  * 
  *     if not issubclass(input.dtype.type, float):
  */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_int_2);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
@@ -12844,7 +14818,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
     __Pyx_INCREF(__pyx_v_minp);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
     __Pyx_GIVEREF(__pyx_v_minp);
-    __pyx_t_4 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_v_minp);
@@ -12853,42 +14827,42 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":763
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":795
  *         minp = max(2, minp)
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_5 = (!__pyx_t_3);
   if (__pyx_t_5) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":764
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":796
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)
  */
-    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 796; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 796; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
     PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 796; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 796; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
     __pyx_t_6 = 0;
@@ -12896,36 +14870,36 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":766
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":798
  *         input = input.astype(float)
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if is_contiguous(input):
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_N);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_N);
   __Pyx_GIVEREF(__pyx_v_N);
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_output = ((PyArrayObject *)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":768
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":800
  *     cdef ndarray output = np.empty(N, dtype=float)
  * 
  *     if is_contiguous(input):             # <<<<<<<<<<<<<<
@@ -12935,31 +14909,31 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   __pyx_t_8 = __pyx_f_7tseries_is_contiguous(__pyx_v_input);
   if (__pyx_t_8) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":770
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":802
  *     if is_contiguous(input):
  *         _roll_skew(get_double_ptr(input), get_double_ptr(output),
  *                    window, minp, N)             # <<<<<<<<<<<<<<
  *     else:
  *         _roll_skew_noncontig(input, output, window, minp, N)
  */
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_f_7tseries__roll_skew(__pyx_f_7tseries_get_double_ptr(__pyx_v_input), __pyx_f_7tseries_get_double_ptr(__pyx_v_output), __pyx_t_8, __pyx_t_9, __pyx_t_10);
     goto __pyx_L8;
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":772
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":804
  *                    window, minp, N)
  *     else:
  *         _roll_skew_noncontig(input, output, window, minp, N)             # <<<<<<<<<<<<<<
  * 
  *     return output
  */
-    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_5); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_6); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_v_input));
     PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
@@ -12976,7 +14950,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
     __Pyx_INCREF(__pyx_v_N);
     PyTuple_SET_ITEM(__pyx_t_2, 4, __pyx_v_N);
     __Pyx_GIVEREF(__pyx_v_N);
-    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
@@ -12984,7 +14958,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   }
   __pyx_L8:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":774
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":806
  *         _roll_skew_noncontig(input, output, window, minp, N)
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -13016,7 +14990,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":776
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":808
  *     return output
  * 
  * def rolling_kurt(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
@@ -13065,7 +15039,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -13074,7 +15048,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_kurt") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_kurt") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -13093,7 +15067,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.rolling_kurt");
   return NULL;
@@ -13102,23 +15076,23 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
   __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":777
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":809
  * 
  * def rolling_kurt(ndarray input, window, minp=None):
  *     N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     if minp is None:
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_v_N);
   __pyx_v_N = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":779
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":811
  *     N = len(input)
  * 
  *     if minp is None:             # <<<<<<<<<<<<<<
@@ -13128,7 +15102,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   __pyx_t_3 = (__pyx_v_minp == Py_None);
   if (__pyx_t_3) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":780
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":812
  * 
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
@@ -13142,14 +15116,14 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":782
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":814
  *         minp = window
  *     else:
  *         minp = max(2, minp)             # <<<<<<<<<<<<<<
  * 
  *     if not issubclass(input.dtype.type, float):
  */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_int_2);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
@@ -13157,7 +15131,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
     __Pyx_INCREF(__pyx_v_minp);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
     __Pyx_GIVEREF(__pyx_v_minp);
-    __pyx_t_4 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_v_minp);
@@ -13166,42 +15140,42 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":784
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":816
  *         minp = max(2, minp)
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_5 = (!__pyx_t_3);
   if (__pyx_t_5) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":785
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":817
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)
  */
-    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
     PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
     __pyx_t_6 = 0;
@@ -13209,36 +15183,36 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":787
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":819
  *         input = input.astype(float)
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if is_contiguous(input):
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_N);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_N);
   __Pyx_GIVEREF(__pyx_v_N);
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_output = ((PyArrayObject *)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":789
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":821
  *     cdef ndarray output = np.empty(N, dtype=float)
  * 
  *     if is_contiguous(input):             # <<<<<<<<<<<<<<
@@ -13248,31 +15222,31 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   __pyx_t_8 = __pyx_f_7tseries_is_contiguous(__pyx_v_input);
   if (__pyx_t_8) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":791
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":823
  *     if is_contiguous(input):
  *         _roll_kurt(get_double_ptr(input), get_double_ptr(output),
  *                    window, minp, N)             # <<<<<<<<<<<<<<
  *     else:
  *         _roll_kurt_noncontig(input, output, window, minp, N)
  */
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_f_7tseries__roll_kurt(__pyx_f_7tseries_get_double_ptr(__pyx_v_input), __pyx_f_7tseries_get_double_ptr(__pyx_v_output), __pyx_t_8, __pyx_t_9, __pyx_t_10);
     goto __pyx_L8;
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":793
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":825
  *                    window, minp, N)
  *     else:
  *         _roll_kurt_noncontig(input, output, window, minp, N)             # <<<<<<<<<<<<<<
  * 
  *     return output
  */
-    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_6); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_7); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_v_input));
     PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
@@ -13289,7 +15263,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
     __Pyx_INCREF(__pyx_v_N);
     PyTuple_SET_ITEM(__pyx_t_2, 4, __pyx_v_N);
     __Pyx_GIVEREF(__pyx_v_N);
-    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
@@ -13297,10 +15271,11 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   __pyx_L8:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":795
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":827
  *         _roll_kurt_noncontig(input, output, window, minp, N)
  * 
  *     return output             # <<<<<<<<<<<<<<
+ * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_output));
@@ -13327,7 +15302,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\reindex.pyx":2
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":2
  * 
  * def reindex(ndarray index, ndarray arr, dict idxMap):             # <<<<<<<<<<<<<<
  *     '''
@@ -13379,17 +15354,17 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__arr);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("reindex", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("reindex", 1, 3, 3, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__idxMap);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("reindex", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("reindex", 1, 3, 3, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "reindex") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "reindex") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_index = ((PyArrayObject *)values[0]);
     __pyx_v_arr = ((PyArrayObject *)values[1]);
@@ -13403,7 +15378,7 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("reindex", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("reindex", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.reindex");
   return NULL;
@@ -13415,27 +15390,27 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
   __pyx_v_itera = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_iteridx = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_idxMap), &PyDict_Type, 1, "idxMap", 1))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_idxMap), &PyDict_Type, 1, "idxMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":17
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":17
  *     cdef object idx
  * 
  *     nan = <double> np.NaN             # <<<<<<<<<<<<<<
  * 
  *     length = PyArray_SIZE(index)
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_nan = ((double)__pyx_t_3);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":19
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":19
  *     nan = <double> np.NaN
  * 
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -13444,26 +15419,26 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_index);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":21
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":21
  *     length = PyArray_SIZE(index)
  * 
  *     result = <ndarray> np.empty(length, np.float64)             # <<<<<<<<<<<<<<
  * 
  *     result_data = <double *> result.data
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__float64); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__float64); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
@@ -13471,7 +15446,7 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
   __Pyx_GIVEREF(__pyx_t_5);
   __pyx_t_2 = 0;
   __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -13480,7 +15455,7 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":23
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":23
  *     result = <ndarray> np.empty(length, np.float64)
  * 
  *     result_data = <double *> result.data             # <<<<<<<<<<<<<<
@@ -13489,35 +15464,35 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
  */
   __pyx_v_result_data = ((double *)__pyx_v_result->data);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":25
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":25
  *     result_data = <double *> result.data
  * 
  *     itera = <flatiter> PyArray_IterNew(arr)             # <<<<<<<<<<<<<<
  *     iteridx = <flatiter> PyArray_IterNew(index)
  * 
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_arr)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_arr)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_itera));
   __pyx_v_itera = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":26
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":26
  * 
  *     itera = <flatiter> PyArray_IterNew(arr)
  *     iteridx = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < length:
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iteridx));
   __pyx_v_iteridx = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":28
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":28
  *     iteridx = <flatiter> PyArray_IterNew(index)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -13527,20 +15502,20 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
   __pyx_t_6 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":29
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":29
  * 
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))             # <<<<<<<<<<<<<<
  *         PyArray_ITER_NEXT(iteridx)
  *         if idx not in idxMap:
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iteridx)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iteridx)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_idx);
     __pyx_v_idx = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":30
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":30
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
  *         PyArray_ITER_NEXT(iteridx)             # <<<<<<<<<<<<<<
@@ -13549,7 +15524,7 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
  */
     PyArray_ITER_NEXT(__pyx_v_iteridx);
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":31
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":31
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
  *         PyArray_ITER_NEXT(iteridx)
  *         if idx not in idxMap:             # <<<<<<<<<<<<<<
@@ -13557,13 +15532,13 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
  *             continue
  */
     if (unlikely(((PyObject *)__pyx_v_idxMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_7 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_idxMap), __pyx_v_idx))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_idxMap), __pyx_v_idx))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     if (__pyx_t_7) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":32
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":32
  *         PyArray_ITER_NEXT(iteridx)
  *         if idx not in idxMap:
  *             result_data[i] = nan             # <<<<<<<<<<<<<<
@@ -13572,7 +15547,7 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
  */
       (__pyx_v_result_data[__pyx_v_i]) = __pyx_v_nan;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":33
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":33
  *         if idx not in idxMap:
  *             result_data[i] = nan
  *             continue             # <<<<<<<<<<<<<<
@@ -13584,20 +15559,20 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
     }
     __pyx_L8:;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":34
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":34
  *             result_data[i] = nan
  *             continue
  *         PyArray_ITER_GOTO1D(itera, idxMap[idx])             # <<<<<<<<<<<<<<
  *         result_data[i] = (<double *>PyArray_ITER_DATA(itera))[0]
  * 
  */
-    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_idxMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_idxMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = __Pyx_PyInt_from_py_npy_intp(__pyx_t_5); if (unlikely((__pyx_t_8 == (npy_intp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_from_py_npy_intp(__pyx_t_5); if (unlikely((__pyx_t_8 == (npy_intp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     PyArray_ITER_GOTO1D(__pyx_v_itera, __pyx_t_8);
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":35
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":35
  *             continue
  *         PyArray_ITER_GOTO1D(itera, idxMap[idx])
  *         result_data[i] = (<double *>PyArray_ITER_DATA(itera))[0]             # <<<<<<<<<<<<<<
@@ -13608,7 +15583,7 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
     __pyx_L6_continue:;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":37
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":37
  *         result_data[i] = (<double *>PyArray_ITER_DATA(itera))[0]
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -13642,7 +15617,7 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\reindex.pyx":39
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":39
  *     return result
  * 
  * def reindexObj(ndarray index, ndarray arr, dict idxMap):             # <<<<<<<<<<<<<<
@@ -13697,17 +15672,17 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__arr);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("reindexObj", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("reindexObj", 1, 3, 3, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__idxMap);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("reindexObj", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("reindexObj", 1, 3, 3, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "reindexObj") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "reindexObj") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_index = ((PyArrayObject *)values[0]);
     __pyx_v_arr = ((PyArrayObject *)values[1]);
@@ -13721,7 +15696,7 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("reindexObj", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("reindexObj", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.reindexObj");
   return NULL;
@@ -13736,27 +15711,27 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_nan = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_obj = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_idxMap), &PyDict_Type, 1, "idxMap", 1))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_idxMap), &PyDict_Type, 1, "idxMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":52
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":52
  *     cdef object idx, nan, obj
  * 
  *     nan = np.NaN             # <<<<<<<<<<<<<<
  *     length = PyArray_SIZE(index)
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_v_nan);
   __pyx_v_nan = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":53
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":53
  * 
  *     nan = np.NaN
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -13765,35 +15740,35 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_index);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":55
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":55
  *     length = PyArray_SIZE(index)
  * 
  *     result = <ndarray> np.empty(length, dtype=np.object_)             # <<<<<<<<<<<<<<
  * 
  *     itera = <flatiter> PyArray_IterNew(arr)
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__object_); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__object_); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_3, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_3, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -13803,49 +15778,49 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":57
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":57
  *     result = <ndarray> np.empty(length, dtype=np.object_)
  * 
  *     itera = <flatiter> PyArray_IterNew(arr)             # <<<<<<<<<<<<<<
  *     iteridx = <flatiter> PyArray_IterNew(index)
  *     iterresult = <flatiter> PyArray_IterNew(result)
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_arr)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_arr)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_itera));
   __pyx_v_itera = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":58
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":58
  * 
  *     itera = <flatiter> PyArray_IterNew(arr)
  *     iteridx = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
  *     iterresult = <flatiter> PyArray_IterNew(result)
  * 
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iteridx));
   __pyx_v_iteridx = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":59
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":59
  *     itera = <flatiter> PyArray_IterNew(arr)
  *     iteridx = <flatiter> PyArray_IterNew(index)
  *     iterresult = <flatiter> PyArray_IterNew(result)             # <<<<<<<<<<<<<<
  * 
  *     cdef int res
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_result)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_result)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iterresult));
   __pyx_v_iterresult = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":63
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":63
  *     cdef int res
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -13855,20 +15830,20 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
   __pyx_t_6 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":64
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":64
  * 
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))             # <<<<<<<<<<<<<<
  *         PyArray_ITER_NEXT(iteridx)
  * 
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iteridx)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iteridx)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_idx);
     __pyx_v_idx = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":65
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":65
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
  *         PyArray_ITER_NEXT(iteridx)             # <<<<<<<<<<<<<<
@@ -13877,7 +15852,7 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
  */
     PyArray_ITER_NEXT(__pyx_v_iteridx);
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":67
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":67
  *         PyArray_ITER_NEXT(iteridx)
  * 
  *         if idx not in idxMap:             # <<<<<<<<<<<<<<
@@ -13885,13 +15860,13 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
  *             PyArray_ITER_NEXT(iterresult)
  */
     if (unlikely(((PyObject *)__pyx_v_idxMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_7 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_idxMap), __pyx_v_idx))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_idxMap), __pyx_v_idx))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     if (__pyx_t_7) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":68
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":68
  * 
  *         if idx not in idxMap:
  *             PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), nan)             # <<<<<<<<<<<<<<
@@ -13900,7 +15875,7 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
  */
       PyArray_SETITEM(__pyx_v_result, PyArray_ITER_DATA(__pyx_v_iterresult), __pyx_v_nan);
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":69
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":69
  *         if idx not in idxMap:
  *             PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), nan)
  *             PyArray_ITER_NEXT(iterresult)             # <<<<<<<<<<<<<<
@@ -13909,7 +15884,7 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
  */
       PyArray_ITER_NEXT(__pyx_v_iterresult);
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":70
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":70
  *             PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), nan)
  *             PyArray_ITER_NEXT(iterresult)
  *             continue             # <<<<<<<<<<<<<<
@@ -13921,33 +15896,33 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
     }
     __pyx_L8:;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":72
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":72
  *             continue
  * 
  *         PyArray_ITER_GOTO1D(itera, idxMap[idx])             # <<<<<<<<<<<<<<
  *         obj = PyArray_GETITEM(arr, PyArray_ITER_DATA(itera))
  * 
  */
-    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_idxMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_idxMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = __Pyx_PyInt_from_py_npy_intp(__pyx_t_5); if (unlikely((__pyx_t_8 == (npy_intp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_from_py_npy_intp(__pyx_t_5); if (unlikely((__pyx_t_8 == (npy_intp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     PyArray_ITER_GOTO1D(__pyx_v_itera, __pyx_t_8);
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":73
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":73
  * 
  *         PyArray_ITER_GOTO1D(itera, idxMap[idx])
  *         obj = PyArray_GETITEM(arr, PyArray_ITER_DATA(itera))             # <<<<<<<<<<<<<<
  * 
  *         res = PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), obj)
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_arr, PyArray_ITER_DATA(__pyx_v_itera)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_arr, PyArray_ITER_DATA(__pyx_v_itera)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_obj);
     __pyx_v_obj = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":75
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":75
  *         obj = PyArray_GETITEM(arr, PyArray_ITER_DATA(itera))
  * 
  *         res = PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), obj)             # <<<<<<<<<<<<<<
@@ -13956,7 +15931,7 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
  */
     __pyx_v_res = PyArray_SETITEM(__pyx_v_result, PyArray_ITER_DATA(__pyx_v_iterresult), __pyx_v_obj);
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":76
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":76
  * 
  *         res = PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), obj)
  *         PyArray_ITER_NEXT(iterresult)             # <<<<<<<<<<<<<<
@@ -13967,7 +15942,7 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
     __pyx_L6_continue:;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":78
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":78
  *         PyArray_ITER_NEXT(iterresult)
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -14005,7 +15980,7 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\reindex.pyx":81
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":81
  * 
  * @cython.boundscheck(False)
  * def reindexObject(ndarray[object, ndim=1] index,             # <<<<<<<<<<<<<<
@@ -14070,17 +16045,17 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__arr);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("reindexObject", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("reindexObject", 1, 3, 3, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__idxMap);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("reindexObject", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("reindexObject", 1, 3, 3, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "reindexObject") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "reindexObject") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_index = ((PyArrayObject *)values[0]);
     __pyx_v_arr = ((PyArrayObject *)values[1]);
@@ -14094,7 +16069,7 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("reindexObject", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("reindexObject", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.reindexObject");
   return NULL;
@@ -14107,38 +16082,38 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
   __pyx_bstruct_result.buf = NULL;
   __pyx_bstruct_index.buf = NULL;
   __pyx_bstruct_arr.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_idxMap), &PyDict_Type, 1, "idxMap", 1))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_idxMap), &PyDict_Type, 1, "idxMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
   __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
   __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":96
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":96
  *     cdef int i, loc, length
  *     cdef object idx, value
  *     cdef object nan = np.NaN             # <<<<<<<<<<<<<<
  * 
  *     length = index.shape[0]
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_nan = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":98
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":98
  *     cdef object nan = np.NaN
  * 
  *     length = index.shape[0]             # <<<<<<<<<<<<<<
@@ -14147,34 +16122,34 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
  */
   __pyx_v_length = (__pyx_v_index->dimensions[0]);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":99
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":99
  * 
  *     length = index.shape[0]
  *     result = np.empty(length, dtype=object)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < length:
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_builtin_object) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_3, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_builtin_object) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_3, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
@@ -14191,14 +16166,14 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
     }
     __pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
     __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
-    if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_t_5 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_v_result));
   __pyx_v_result = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":101
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":101
  *     result = np.empty(length, dtype=object)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -14208,7 +16183,7 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
   __pyx_t_6 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":102
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":102
  * 
  *     for i from 0 <= i < length:
  *         idx = index[i]             # <<<<<<<<<<<<<<
@@ -14223,7 +16198,7 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
     __pyx_v_idx = __pyx_t_4;
     __pyx_t_4 = 0;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":103
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":103
  *     for i from 0 <= i < length:
  *         idx = index[i]
  *         if idx not in idxMap:             # <<<<<<<<<<<<<<
@@ -14231,13 +16206,13 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
  *             continue
  */
     if (unlikely(((PyObject *)__pyx_v_idxMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_11 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_idxMap), __pyx_v_idx))); if (unlikely(__pyx_t_11 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_11 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_idxMap), __pyx_v_idx))); if (unlikely(__pyx_t_11 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     if (__pyx_t_11) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":104
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":104
  *         idx = index[i]
  *         if idx not in idxMap:
  *             result[i] = nan             # <<<<<<<<<<<<<<
@@ -14252,7 +16227,7 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
       *__pyx_t_13 = __pyx_v_nan;
       __Pyx_GIVEREF(*__pyx_t_13);
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":105
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":105
  *         if idx not in idxMap:
  *             result[i] = nan
  *             continue             # <<<<<<<<<<<<<<
@@ -14264,16 +16239,16 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
     }
     __pyx_L8:;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":107
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":107
  *             continue
  * 
  *         result[i] = arr[idxMap[idx]]             # <<<<<<<<<<<<<<
  * 
  *     return result
  */
-    __pyx_t_4 = PyObject_GetItem(((PyObject *)__pyx_v_idxMap), __pyx_v_idx); if (!__pyx_t_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_GetItem(((PyObject *)__pyx_v_idxMap), __pyx_v_idx); if (!__pyx_t_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyObject_GetItem(((PyObject *)__pyx_v_arr), __pyx_t_4); if (!__pyx_t_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetItem(((PyObject *)__pyx_v_arr), __pyx_t_4); if (!__pyx_t_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_14 = __pyx_v_i;
@@ -14287,7 +16262,7 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
     __pyx_L6_continue:;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":109
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":109
  *         result[i] = arr[idxMap[idx]]
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -14331,7 +16306,7 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\reindex.pyx":111
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":111
  *     return result
  * 
  * cdef tuple _nofill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):             # <<<<<<<<<<<<<<
@@ -14370,36 +16345,36 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
   __pyx_v_fillVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_maskVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":128
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":128
  *     cdef ndarray maskVec
  * 
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -14409,36 +16384,36 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":129
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":129
  * 
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
  * 
  *     fillLocs = <int *> fillVec.data
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -14448,7 +16423,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
   __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":131
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":131
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
  * 
  *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
@@ -14457,7 +16432,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
  */
   __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":132
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":132
  * 
  *     fillLocs = <int *> fillVec.data
  *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
@@ -14466,7 +16441,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
  */
   __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":134
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":134
  *     mask = <char *> maskVec.data
  * 
  *     newLength = PyArray_SIZE(fillVec)             # <<<<<<<<<<<<<<
@@ -14475,7 +16450,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
  */
   __pyx_v_newLength = PyArray_SIZE(__pyx_v_fillVec);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":136
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":136
  *     newLength = PyArray_SIZE(fillVec)
  * 
  *     length = PyArray_SIZE(oldIndex)             # <<<<<<<<<<<<<<
@@ -14484,21 +16459,21 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_oldIndex);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":137
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":137
  * 
  *     length = PyArray_SIZE(oldIndex)
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < length:
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iterold));
   __pyx_v_iterold = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":139
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":139
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -14508,20 +16483,20 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
   __pyx_t_7 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":140
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":140
  * 
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  *         if i < length - 1:
  *            PyArray_ITER_NEXT(iterold)
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_idx);
     __pyx_v_idx = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":141
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":141
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))
  *         if i < length - 1:             # <<<<<<<<<<<<<<
@@ -14531,7 +16506,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
     __pyx_t_8 = (__pyx_v_i < (__pyx_v_length - 1));
     if (__pyx_t_8) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":142
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":142
  *         idx = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))
  *         if i < length - 1:
  *            PyArray_ITER_NEXT(iterold)             # <<<<<<<<<<<<<<
@@ -14543,7 +16518,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
     }
     __pyx_L5:;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":143
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":143
  *         if i < length - 1:
  *            PyArray_ITER_NEXT(iterold)
  *         if idx in newMap:             # <<<<<<<<<<<<<<
@@ -14551,26 +16526,26 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
  *             fillLocs[j] = i
  */
     if (unlikely(((PyObject *)__pyx_v_newMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_8 = ((PyDict_Contains(((PyObject *)__pyx_v_newMap), __pyx_v_idx))); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_8 = ((PyDict_Contains(((PyObject *)__pyx_v_newMap), __pyx_v_idx))); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     if (__pyx_t_8) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":144
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":144
  *            PyArray_ITER_NEXT(iterold)
  *         if idx in newMap:
  *             j = newMap[idx]             # <<<<<<<<<<<<<<
  *             fillLocs[j] = i
  *             mask[j] = 1
  */
-      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_newMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_newMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_t_5); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_t_5); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_v_j = __pyx_t_9;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":145
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":145
  *         if idx in newMap:
  *             j = newMap[idx]
  *             fillLocs[j] = i             # <<<<<<<<<<<<<<
@@ -14579,7 +16554,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
  */
       (__pyx_v_fillLocs[__pyx_v_j]) = __pyx_v_i;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":146
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":146
  *             j = newMap[idx]
  *             fillLocs[j] = i
  *             mask[j] = 1             # <<<<<<<<<<<<<<
@@ -14592,7 +16567,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
     __pyx_L6:;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":148
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":148
  *             mask[j] = 1
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -14602,7 +16577,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
   __pyx_t_7 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":149
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":149
  * 
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -14612,7 +16587,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
     __pyx_t_8 = ((__pyx_v_mask[__pyx_v_i]) == 0);
     if (__pyx_t_8) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":150
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":150
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
@@ -14625,7 +16600,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
     __pyx_L9:;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":152
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":152
  *             fillLocs[i] = -1
  * 
  *     return fillVec, maskVec             # <<<<<<<<<<<<<<
@@ -14633,7 +16608,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
  * cdef tuple _backfill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
  */
   __Pyx_XDECREF(((PyObject *)__pyx_r));
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
   PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_v_fillVec));
@@ -14641,7 +16616,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
   __Pyx_INCREF(((PyObject *)__pyx_v_maskVec));
   PyTuple_SET_ITEM(__pyx_t_5, 1, ((PyObject *)__pyx_v_maskVec));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_maskVec));
-  if (!(likely(PyTuple_CheckExact(__pyx_t_5))||((__pyx_t_5) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_5)->tp_name), 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyTuple_CheckExact(__pyx_t_5))||((__pyx_t_5) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_5)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_r = ((PyObject *)__pyx_t_5);
   __pyx_t_5 = 0;
   goto __pyx_L0;
@@ -14670,7 +16645,7 @@ static  PyObject *__pyx_f_7tseries__nofill(PyArrayObject *__pyx_v_oldIndex, PyAr
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\reindex.pyx":154
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":154
  *     return fillVec, maskVec
  * 
  * cdef tuple _backfill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):             # <<<<<<<<<<<<<<
@@ -14714,36 +16689,36 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_v_prevOld = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_curOld = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":183
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":183
  *     cdef ndarray fillVec
  *     cdef ndarray maskVec
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -14753,36 +16728,36 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":184
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":184
  *     cdef ndarray maskVec
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
  * 
  *     # Get references
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -14792,7 +16767,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":189
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":189
  *     cdef int *fillLocs
  *     cdef char *mask
  *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
@@ -14801,7 +16776,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":190
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":190
  *     cdef char *mask
  *     fillLocs = <int *> fillVec.data
  *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
@@ -14810,35 +16785,35 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":194
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":194
  *     # Create the iterators
  *     cdef flatiter iterold, iternew
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)             # <<<<<<<<<<<<<<
  *     iternew = <flatiter> PyArray_IterNew(newIndex)
  * 
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iterold));
   __pyx_v_iterold = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":195
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":195
  *     cdef flatiter iterold, iternew
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)
  *     iternew = <flatiter> PyArray_IterNew(newIndex)             # <<<<<<<<<<<<<<
  * 
  *     # Get the size
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iternew));
   __pyx_v_iternew = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":198
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":198
  * 
  *     # Get the size
  *     oldLength = PyArray_SIZE(oldIndex)             # <<<<<<<<<<<<<<
@@ -14847,7 +16822,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_oldLength = PyArray_SIZE(__pyx_v_oldIndex);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":199
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":199
  *     # Get the size
  *     oldLength = PyArray_SIZE(oldIndex)
  *     newLength = PyArray_SIZE(newIndex)             # <<<<<<<<<<<<<<
@@ -14856,7 +16831,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_newLength = PyArray_SIZE(__pyx_v_newIndex);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":203
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":203
  *     # Current positions
  *     cdef int newPos, oldPos
  *     oldPos = oldLength - 1             # <<<<<<<<<<<<<<
@@ -14865,7 +16840,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_oldPos = (__pyx_v_oldLength - 1);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":204
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":204
  *     cdef int newPos, oldPos
  *     oldPos = oldLength - 1
  *     newPos = newLength - 1             # <<<<<<<<<<<<<<
@@ -14874,7 +16849,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_newPos = (__pyx_v_newLength - 1);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":209
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":209
  *     cdef object prevOld, curOld
  * 
  *     while newPos >= 0:             # <<<<<<<<<<<<<<
@@ -14885,7 +16860,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_t_7 = (__pyx_v_newPos >= 0);
     if (!__pyx_t_7) break;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":211
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":211
  *     while newPos >= 0:
  *         # Move to the current position
  *         PyArray_ITER_GOTO1D(iternew, newPos)             # <<<<<<<<<<<<<<
@@ -14894,7 +16869,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
     PyArray_ITER_GOTO1D(__pyx_v_iternew, __pyx_v_newPos);
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":212
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":212
  *         # Move to the current position
  *         PyArray_ITER_GOTO1D(iternew, newPos)
  *         PyArray_ITER_GOTO1D(iterold, oldPos)             # <<<<<<<<<<<<<<
@@ -14903,20 +16878,20 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
     PyArray_ITER_GOTO1D(__pyx_v_iterold, __pyx_v_oldPos);
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":215
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":215
  * 
  *         # Get the current index
  *         curOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *         # Until we reach a point where we are before the curOld point
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_curOld);
     __pyx_v_curOld = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":218
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":218
  * 
  *         # Until we reach a point where we are before the curOld point
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > curOld:             # <<<<<<<<<<<<<<
@@ -14924,16 +16899,16 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  *             if newPos < 0:
  */
     while (1) {
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (!__pyx_t_7) break;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":219
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":219
  *         # Until we reach a point where we are before the curOld point
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > curOld:
  *             newPos -= 1             # <<<<<<<<<<<<<<
@@ -14942,7 +16917,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
       __pyx_v_newPos -= 1;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":220
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":220
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > curOld:
  *             newPos -= 1
  *             if newPos < 0:             # <<<<<<<<<<<<<<
@@ -14952,7 +16927,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
       __pyx_t_7 = (__pyx_v_newPos < 0);
       if (__pyx_t_7) {
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":221
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":221
  *             newPos -= 1
  *             if newPos < 0:
  *                 break             # <<<<<<<<<<<<<<
@@ -14964,7 +16939,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
       }
       __pyx_L7:;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":222
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":222
  *             if newPos < 0:
  *                 break
  *             PyArray_ITER_GOTO1D(iternew, newPos)             # <<<<<<<<<<<<<<
@@ -14975,20 +16950,20 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     }
     __pyx_L6_break:;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":225
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":225
  * 
  *         # Get the location in the old index
  *         curLoc = oldMap[curOld]             # <<<<<<<<<<<<<<
  * 
  *         # At the beginning of the old index
  */
-    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_curLoc = __pyx_t_8;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":228
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":228
  * 
  *         # At the beginning of the old index
  *         if oldPos == 0:             # <<<<<<<<<<<<<<
@@ -14998,47 +16973,47 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_t_7 = (__pyx_v_oldPos == 0);
     if (__pyx_t_7) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":231
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":231
  * 
  *             # Make sure we are before the curOld index
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) <= curOld:             # <<<<<<<<<<<<<<
  *                 fillVec[:newPos + 1] = curLoc
  *                 maskVec[:newPos + 1] = 1
  */
-      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_LE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_LE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_7) {
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":232
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":232
  *             # Make sure we are before the curOld index
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) <= curOld:
  *                 fillVec[:newPos + 1] = curLoc             # <<<<<<<<<<<<<<
  *                 maskVec[:newPos + 1] = 1
  * 
  */
-        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), 0, (__pyx_v_newPos + 1), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), 0, (__pyx_v_newPos + 1), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":233
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":233
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) <= curOld:
  *                 fillVec[:newPos + 1] = curLoc
  *                 maskVec[:newPos + 1] = 1             # <<<<<<<<<<<<<<
  * 
  *             # Exit the main loop
  */
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), 0, (__pyx_v_newPos + 1), __pyx_int_1) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), 0, (__pyx_v_newPos + 1), __pyx_int_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         goto __pyx_L9;
       }
       __pyx_L9:;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":236
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":236
  * 
  *             # Exit the main loop
  *             break             # <<<<<<<<<<<<<<
@@ -15050,7 +17025,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":240
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":240
  *         else:
  *             # Move one position back
  *             PyArray_ITER_GOTO1D(iterold, oldPos - 1)             # <<<<<<<<<<<<<<
@@ -15059,20 +17034,20 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
       PyArray_ITER_GOTO1D(__pyx_v_iterold, (__pyx_v_oldPos - 1));
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":243
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":243
  * 
  *             # Get the index there
  *             prevOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *             # Until we reach the previous index
  */
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_v_prevOld);
       __pyx_v_prevOld = __pyx_t_5;
       __pyx_t_5 = 0;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":246
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":246
  * 
  *             # Until we reach the previous index
  *             while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > prevOld:             # <<<<<<<<<<<<<<
@@ -15080,16 +17055,16 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  *                 # Set the current fill location
  */
       while (1) {
-        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_prevOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_prevOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         if (!__pyx_t_7) break;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":249
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":249
  * 
  *                 # Set the current fill location
  *                 fillLocs[newPos] = curLoc             # <<<<<<<<<<<<<<
@@ -15098,7 +17073,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
         (__pyx_v_fillLocs[__pyx_v_newPos]) = __pyx_v_curLoc;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":250
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":250
  *                 # Set the current fill location
  *                 fillLocs[newPos] = curLoc
  *                 mask[newPos] = 1             # <<<<<<<<<<<<<<
@@ -15107,7 +17082,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
         (__pyx_v_mask[__pyx_v_newPos]) = 1;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":252
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":252
  *                 mask[newPos] = 1
  * 
  *                 newPos -= 1             # <<<<<<<<<<<<<<
@@ -15116,7 +17091,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
         __pyx_v_newPos -= 1;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":253
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":253
  * 
  *                 newPos -= 1
  *                 if newPos < 0:             # <<<<<<<<<<<<<<
@@ -15126,7 +17101,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
         __pyx_t_7 = (__pyx_v_newPos < 0);
         if (__pyx_t_7) {
 
-          /* "H:\pandas\pandas\lib\src\reindex.pyx":254
+          /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":254
  *                 newPos -= 1
  *                 if newPos < 0:
  *                     break             # <<<<<<<<<<<<<<
@@ -15138,7 +17113,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
         }
         __pyx_L12:;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":257
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":257
  * 
  *                 # Move the iterator back
  *                 PyArray_ITER_GOTO1D(iternew, newPos)             # <<<<<<<<<<<<<<
@@ -15151,7 +17126,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     }
     __pyx_L8:;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":260
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":260
  * 
  *         # Move one period back
  *         oldPos -= 1             # <<<<<<<<<<<<<<
@@ -15162,7 +17137,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   }
   __pyx_L4_break:;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":262
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":262
  *         oldPos -= 1
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -15172,7 +17147,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":263
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":263
  * 
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -15182,7 +17157,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_t_7 = ((__pyx_v_mask[__pyx_v_i]) == 0);
     if (__pyx_t_7) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":265
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":265
  *         if mask[i] == 0:
  *             # Fill from some generic location
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
@@ -15195,7 +17170,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_L15:;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":267
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":267
  *             fillLocs[i] = -1
  * 
  *     return (fillVec, maskVec)             # <<<<<<<<<<<<<<
@@ -15203,7 +17178,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  * cdef tuple _pad(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
  */
   __Pyx_XDECREF(((PyObject *)__pyx_r));
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
   PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillVec));
@@ -15211,7 +17186,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __Pyx_INCREF(((PyObject *)__pyx_v_maskVec));
   PyTuple_SET_ITEM(__pyx_t_6, 1, ((PyObject *)__pyx_v_maskVec));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_maskVec));
-  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_r = ((PyObject *)__pyx_t_6);
   __pyx_t_6 = 0;
   goto __pyx_L0;
@@ -15242,7 +17217,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\reindex.pyx":269
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":269
  *     return (fillVec, maskVec)
  * 
  * cdef tuple _pad(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):             # <<<<<<<<<<<<<<
@@ -15288,36 +17263,36 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_v_nextOld = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_curOld = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":303
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":303
  * 
  *     # Make empty fill vector and mask vector, cast to ndarray
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -15327,36 +17302,36 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":304
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":304
  *     # Make empty fill vector and mask vector, cast to ndarray
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
  * 
  *     # Get reference to the arrays inside
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -15366,7 +17341,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":307
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":307
  * 
  *     # Get reference to the arrays inside
  *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
@@ -15375,7 +17350,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":308
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":308
  *     # Get reference to the arrays inside
  *     fillLocs = <int *> fillVec.data
  *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
@@ -15384,35 +17359,35 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":311
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":311
  * 
  *     # Create simple ndarray iterators using C API
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)             # <<<<<<<<<<<<<<
  *     iternew = <flatiter> PyArray_IterNew(newIndex)
  * 
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iterold));
   __pyx_v_iterold = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":312
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":312
  *     # Create simple ndarray iterators using C API
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)
  *     iternew = <flatiter> PyArray_IterNew(newIndex)             # <<<<<<<<<<<<<<
  * 
  *     # Length of each index
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iternew));
   __pyx_v_iternew = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":315
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":315
  * 
  *     # Length of each index
  *     oldLength = PyArray_SIZE(oldIndex)             # <<<<<<<<<<<<<<
@@ -15421,7 +17396,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_oldLength = PyArray_SIZE(__pyx_v_oldIndex);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":316
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":316
  *     # Length of each index
  *     oldLength = PyArray_SIZE(oldIndex)
  *     newLength = PyArray_SIZE(newIndex)             # <<<<<<<<<<<<<<
@@ -15430,7 +17405,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_newLength = PyArray_SIZE(__pyx_v_newIndex);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":318
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":318
  *     newLength = PyArray_SIZE(newIndex)
  * 
  *     oldPos = 0             # <<<<<<<<<<<<<<
@@ -15439,7 +17414,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_oldPos = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":319
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":319
  * 
  *     oldPos = 0
  *     newPos = 0             # <<<<<<<<<<<<<<
@@ -15448,7 +17423,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_newPos = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":320
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":320
  *     oldPos = 0
  *     newPos = 0
  *     while newPos < newLength:             # <<<<<<<<<<<<<<
@@ -15459,20 +17434,20 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_t_7 = (__pyx_v_newPos < __pyx_v_newLength);
     if (!__pyx_t_7) break;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":321
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":321
  *     newPos = 0
  *     while newPos < newLength:
  *         curOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *         # At beginning, keep going until we go exceed the
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_curOld);
     __pyx_v_curOld = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":325
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":325
  *         # At beginning, keep going until we go exceed the
  *         # first OLD index in the NEW index
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < curOld:             # <<<<<<<<<<<<<<
@@ -15480,16 +17455,16 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  *             if newPos > newLength - 1:
  */
     while (1) {
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (!__pyx_t_7) break;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":326
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":326
  *         # first OLD index in the NEW index
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < curOld:
  *             newPos += 1             # <<<<<<<<<<<<<<
@@ -15498,7 +17473,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
       __pyx_v_newPos += 1;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":327
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":327
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < curOld:
  *             newPos += 1
  *             if newPos > newLength - 1:             # <<<<<<<<<<<<<<
@@ -15508,7 +17483,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       __pyx_t_7 = (__pyx_v_newPos > (__pyx_v_newLength - 1));
       if (__pyx_t_7) {
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":328
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":328
  *             newPos += 1
  *             if newPos > newLength - 1:
  *                 break             # <<<<<<<<<<<<<<
@@ -15520,7 +17495,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       }
       __pyx_L7:;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":329
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":329
  *             if newPos > newLength - 1:
  *                 break
  *             PyArray_ITER_NEXT(iternew)             # <<<<<<<<<<<<<<
@@ -15531,20 +17506,20 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     }
     __pyx_L6_break:;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":332
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":332
  * 
  *         # We got there, get the current location in the old index
  *         curLoc = oldMap[curOld]             # <<<<<<<<<<<<<<
  * 
  *         # We're at the end of the road, need to propagate this value to the end
  */
-    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_curLoc = __pyx_t_8;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":335
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":335
  * 
  *         # We're at the end of the road, need to propagate this value to the end
  *         if oldPos == oldLength - 1:             # <<<<<<<<<<<<<<
@@ -15554,47 +17529,47 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_t_7 = (__pyx_v_oldPos == (__pyx_v_oldLength - 1));
     if (__pyx_t_7) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":336
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":336
  *         # We're at the end of the road, need to propagate this value to the end
  *         if oldPos == oldLength - 1:
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) >= curOld:             # <<<<<<<<<<<<<<
  *                 fillVec[newPos:] = curLoc
  *                 maskVec[newPos:] = 1
  */
-      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_GE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_GE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_7) {
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":337
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":337
  *         if oldPos == oldLength - 1:
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) >= curOld:
  *                 fillVec[newPos:] = curLoc             # <<<<<<<<<<<<<<
  *                 maskVec[newPos:] = 1
  *             break
  */
-        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":338
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":338
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) >= curOld:
  *                 fillVec[newPos:] = curLoc
  *                 maskVec[newPos:] = 1             # <<<<<<<<<<<<<<
  *             break
  *         else:
  */
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_int_1) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_int_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         goto __pyx_L9;
       }
       __pyx_L9:;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":339
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":339
  *                 fillVec[newPos:] = curLoc
  *                 maskVec[newPos:] = 1
  *             break             # <<<<<<<<<<<<<<
@@ -15606,7 +17581,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     }
     /*else*/ {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":344
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":344
  * 
  *             # Get the next index so we know when to stop propagating this value
  *             PyArray_ITER_NEXT(iterold)             # <<<<<<<<<<<<<<
@@ -15615,20 +17590,20 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
       PyArray_ITER_NEXT(__pyx_v_iterold);
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":345
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":345
  *             # Get the next index so we know when to stop propagating this value
  *             PyArray_ITER_NEXT(iterold)
  *             nextOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *             done = 0
  */
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_v_nextOld);
       __pyx_v_nextOld = __pyx_t_5;
       __pyx_t_5 = 0;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":347
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":347
  *             nextOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))
  * 
  *             done = 0             # <<<<<<<<<<<<<<
@@ -15637,7 +17612,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
       __pyx_v_done = 0;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":350
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":350
  * 
  *             # Until we reach the next OLD value in the NEW index
  *             while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < nextOld:             # <<<<<<<<<<<<<<
@@ -15645,16 +17620,16 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  *                 # Use this location to fill
  */
       while (1) {
-        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_nextOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_nextOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         if (!__pyx_t_7) break;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":353
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":353
  * 
  *                 # Use this location to fill
  *                 fillLocs[newPos] = curLoc             # <<<<<<<<<<<<<<
@@ -15663,7 +17638,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
         (__pyx_v_fillLocs[__pyx_v_newPos]) = __pyx_v_curLoc;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":356
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":356
  * 
  *                 # Set mask to be 1 so will not be NaN'd
  *                 mask[newPos] = 1             # <<<<<<<<<<<<<<
@@ -15672,7 +17647,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
         (__pyx_v_mask[__pyx_v_newPos]) = 1;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":357
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":357
  *                 # Set mask to be 1 so will not be NaN'd
  *                 mask[newPos] = 1
  *                 newPos += 1             # <<<<<<<<<<<<<<
@@ -15681,7 +17656,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
         __pyx_v_newPos += 1;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":360
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":360
  * 
  *                 # We got to the end of the new index
  *                 if newPos > newLength - 1:             # <<<<<<<<<<<<<<
@@ -15691,7 +17666,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
         __pyx_t_7 = (__pyx_v_newPos > (__pyx_v_newLength - 1));
         if (__pyx_t_7) {
 
-          /* "H:\pandas\pandas\lib\src\reindex.pyx":361
+          /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":361
  *                 # We got to the end of the new index
  *                 if newPos > newLength - 1:
  *                     done = 1             # <<<<<<<<<<<<<<
@@ -15700,7 +17675,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
           __pyx_v_done = 1;
 
-          /* "H:\pandas\pandas\lib\src\reindex.pyx":362
+          /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":362
  *                 if newPos > newLength - 1:
  *                     done = 1
  *                     break             # <<<<<<<<<<<<<<
@@ -15712,7 +17687,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
         }
         __pyx_L12:;
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":365
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":365
  * 
  *                 # Advance the pointer
  *                 PyArray_ITER_NEXT(iternew)             # <<<<<<<<<<<<<<
@@ -15723,7 +17698,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       }
       __pyx_L11_break:;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":368
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":368
  * 
  *             # We got to the end of the new index
  *             if done:             # <<<<<<<<<<<<<<
@@ -15733,7 +17708,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       __pyx_t_9 = __pyx_v_done;
       if (__pyx_t_9) {
 
-        /* "H:\pandas\pandas\lib\src\reindex.pyx":369
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":369
  *             # We got to the end of the new index
  *             if done:
  *                 break             # <<<<<<<<<<<<<<
@@ -15747,7 +17722,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     }
     __pyx_L8:;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":373
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":373
  *         # We already advanced the iterold pointer to the next value,
  *         # inc the count
  *         oldPos += 1             # <<<<<<<<<<<<<<
@@ -15758,7 +17733,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   }
   __pyx_L4_break:;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":377
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":377
  *     # Places where the mask is 0, fill with an arbitrary value
  *     # (will be NA'd out)
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -15768,7 +17743,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":378
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":378
  *     # (will be NA'd out)
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -15778,7 +17753,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_t_7 = ((__pyx_v_mask[__pyx_v_i]) == 0);
     if (__pyx_t_7) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":379
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":379
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
@@ -15791,7 +17766,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_L16:;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":381
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":381
  *             fillLocs[i] = -1
  * 
  *     return fillVec, maskVec             # <<<<<<<<<<<<<<
@@ -15799,7 +17774,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  * def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,
  */
   __Pyx_XDECREF(((PyObject *)__pyx_r));
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
   PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillVec));
@@ -15807,7 +17782,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __Pyx_INCREF(((PyObject *)__pyx_v_maskVec));
   PyTuple_SET_ITEM(__pyx_t_6, 1, ((PyObject *)__pyx_v_maskVec));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_maskVec));
-  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_r = ((PyObject *)__pyx_t_6);
   __pyx_t_6 = 0;
   goto __pyx_L0;
@@ -15838,7 +17813,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\reindex.pyx":383
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":383
  *     return fillVec, maskVec
  * 
  * def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,             # <<<<<<<<<<<<<<
@@ -15884,29 +17859,29 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__newIndex);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__oldMap);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__newMap);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 3); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 3); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  4:
       values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__kind);
       if (likely(values[4])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 4); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 4); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getFillVec") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getFillVec") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_oldIndex = ((PyArrayObject *)values[0]);
     __pyx_v_newIndex = ((PyArrayObject *)values[1]);
@@ -15924,7 +17899,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.getFillVec");
   return NULL;
@@ -15936,32 +17911,32 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   __Pyx_INCREF(__pyx_v_kind);
   __pyx_v_fillVec = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_maskVec = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldIndex), __pyx_ptype_5numpy_ndarray, 1, "oldIndex", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newIndex), __pyx_ptype_5numpy_ndarray, 1, "newIndex", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newMap), &PyDict_Type, 1, "newMap", 1))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldIndex), __pyx_ptype_5numpy_ndarray, 1, "oldIndex", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newIndex), __pyx_ptype_5numpy_ndarray, 1, "newIndex", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newMap), &PyDict_Type, 1, "newMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":386
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":386
  *                object kind):
  * 
  *     if kind == '':             # <<<<<<<<<<<<<<
  *         fillVec, maskVec = _nofill(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'PAD':
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_kp_s_7), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_kp_s_8), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":387
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":387
  * 
  *     if kind == '':
  *         fillVec, maskVec = _nofill(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  */
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__nofill(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__nofill(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     if (likely(__pyx_t_1 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_1) == 2)) {
       PyObject* tuple = __pyx_t_1;
@@ -15976,32 +17951,32 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
       __pyx_t_4 = 0;
     } else {
       __Pyx_UnpackTupleError(__pyx_t_1, 2);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":388
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":388
  *     if kind == '':
  *         fillVec, maskVec = _nofill(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'PAD':             # <<<<<<<<<<<<<<
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__PAD), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__PAD), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":389
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":389
  *         fillVec, maskVec = _nofill(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
  *     elif kind == 'BACKFILL':
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  */
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__pad(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__pad(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     if (likely(__pyx_t_1 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_1) == 2)) {
       PyObject* tuple = __pyx_t_1;
@@ -16016,32 +17991,32 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
       __pyx_t_3 = 0;
     } else {
       __Pyx_UnpackTupleError(__pyx_t_1, 2);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":390
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":390
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':             # <<<<<<<<<<<<<<
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  * 
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__BACKFILL), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__BACKFILL), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":391
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":391
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
  * 
  *     return fillVec, maskVec.astype(np.bool)
  */
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__backfill(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__backfill(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     if (likely(__pyx_t_1 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_1) == 2)) {
       PyObject* tuple = __pyx_t_1;
@@ -16056,13 +18031,13 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
       __pyx_t_4 = 0;
     } else {
       __Pyx_UnpackTupleError(__pyx_t_1, 2);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     goto __pyx_L6;
   }
   __pyx_L6:;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":393
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":393
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  * 
  *     return fillVec, maskVec.astype(np.bool)             # <<<<<<<<<<<<<<
@@ -16070,23 +18045,23 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
  * def getMergeVec(ndarray values, dict indexMap):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_v_maskVec, __pyx_n_s__astype); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_v_maskVec, __pyx_n_s__astype); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__bool); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__bool); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_fillVec);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_fillVec);
@@ -16119,7 +18094,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\reindex.pyx":395
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":395
  *     return fillVec, maskVec.astype(np.bool)
  * 
  * def getMergeVec(ndarray values, dict indexMap):             # <<<<<<<<<<<<<<
@@ -16172,11 +18147,11 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__indexMap);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getMergeVec") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getMergeVec") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_values = ((PyArrayObject *)values[0]);
     __pyx_v_indexMap = ((PyObject *)values[1]);
@@ -16188,7 +18163,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.getMergeVec");
   return NULL;
@@ -16199,48 +18174,48 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_v_val = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_fillVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_maskVec = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_indexMap), &PyDict_Type, 1, "indexMap", 1))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_indexMap), &PyDict_Type, 1, "indexMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":405
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":405
  *     cdef ndarray maskVec
  * 
  *     cdef int newLength = len(values)             # <<<<<<<<<<<<<<
  * 
  *     fillVec = <ndarray> np.empty(newLength, dtype = np.int32)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_values)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_values)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_newLength = __pyx_t_1;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":407
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":407
  *     cdef int newLength = len(values)
  * 
  *     fillVec = <ndarray> np.empty(newLength, dtype = np.int32)             # <<<<<<<<<<<<<<
  *     maskVec = <ndarray> np.zeros(newLength, dtype = np.int8)
  * 
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -16250,35 +18225,35 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":408
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":408
  * 
  *     fillVec = <ndarray> np.empty(newLength, dtype = np.int32)
  *     maskVec = <ndarray> np.zeros(newLength, dtype = np.int8)             # <<<<<<<<<<<<<<
  * 
  *     fillLocs = <int *> fillVec.data
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -16288,7 +18263,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":410
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":410
  *     maskVec = <ndarray> np.zeros(newLength, dtype = np.int8)
  * 
  *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
@@ -16297,7 +18272,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
  */
   __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":411
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":411
  * 
  *     fillLocs = <int *> fillVec.data
  *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
@@ -16306,7 +18281,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
  */
   __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":413
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":413
  *     mask = <char *> maskVec.data
  * 
  *     length = PyArray_SIZE(values)             # <<<<<<<<<<<<<<
@@ -16315,21 +18290,21 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_values);
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":414
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":414
  * 
  *     length = PyArray_SIZE(values)
  *     itervals = <flatiter> PyArray_IterNew(values)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < length:
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_values)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_values)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_itervals));
   __pyx_v_itervals = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":416
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":416
  *     itervals = <flatiter> PyArray_IterNew(values)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -16339,20 +18314,20 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_t_7 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":417
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":417
  * 
  *     for i from 0 <= i < length:
  *         val = PyArray_GETITEM(values, PyArray_ITER_DATA(itervals))             # <<<<<<<<<<<<<<
  *         if val in indexMap:
  *             j = indexMap[val]
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_values, PyArray_ITER_DATA(__pyx_v_itervals)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_values, PyArray_ITER_DATA(__pyx_v_itervals)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_val);
     __pyx_v_val = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":418
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":418
  *     for i from 0 <= i < length:
  *         val = PyArray_GETITEM(values, PyArray_ITER_DATA(itervals))
  *         if val in indexMap:             # <<<<<<<<<<<<<<
@@ -16360,26 +18335,26 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
  *             fillLocs[i] = j
  */
     if (unlikely(((PyObject *)__pyx_v_indexMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_8 = ((PyDict_Contains(((PyObject *)__pyx_v_indexMap), __pyx_v_val))); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_8 = ((PyDict_Contains(((PyObject *)__pyx_v_indexMap), __pyx_v_val))); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     if (__pyx_t_8) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":419
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":419
  *         val = PyArray_GETITEM(values, PyArray_ITER_DATA(itervals))
  *         if val in indexMap:
  *             j = indexMap[val]             # <<<<<<<<<<<<<<
  *             fillLocs[i] = j
  *             mask[i] = 1
  */
-      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_indexMap), __pyx_v_val); if (!__pyx_t_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_indexMap), __pyx_v_val); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_t_5); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_t_5); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_v_j = __pyx_t_9;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":420
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":420
  *         if val in indexMap:
  *             j = indexMap[val]
  *             fillLocs[i] = j             # <<<<<<<<<<<<<<
@@ -16388,7 +18363,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
  */
       (__pyx_v_fillLocs[__pyx_v_i]) = __pyx_v_j;
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":421
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":421
  *             j = indexMap[val]
  *             fillLocs[i] = j
  *             mask[i] = 1             # <<<<<<<<<<<<<<
@@ -16400,7 +18375,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     }
     __pyx_L8:;
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":423
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":423
  *             mask[i] = 1
  * 
  *         PyArray_ITER_NEXT(itervals)             # <<<<<<<<<<<<<<
@@ -16410,7 +18385,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     PyArray_ITER_NEXT(__pyx_v_itervals);
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":425
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":425
  *         PyArray_ITER_NEXT(itervals)
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -16420,7 +18395,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_t_7 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\reindex.pyx":426
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":426
  * 
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -16430,7 +18405,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     __pyx_t_8 = ((__pyx_v_mask[__pyx_v_i]) == 0);
     if (__pyx_t_8) {
 
-      /* "H:\pandas\pandas\lib\src\reindex.pyx":427
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":427
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
@@ -16443,30 +18418,30 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     __pyx_L11:;
   }
 
-  /* "H:\pandas\pandas\lib\src\reindex.pyx":429
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":429
  *             fillLocs[i] = -1
  * 
  *     return fillVec, maskVec.astype(np.bool)             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_maskVec), __pyx_n_s__astype); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_maskVec), __pyx_n_s__astype); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__bool); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__bool); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
   PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillVec));
@@ -16500,7 +18475,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":1
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":1
  * cdef double __add(double a, double b):             # <<<<<<<<<<<<<<
  *     return a + b
  * cdef double __sub(double a, double b):
@@ -16510,7 +18485,7 @@ static  double __pyx_f_7tseries___add(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__add");
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":2
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":2
  * cdef double __add(double a, double b):
  *     return a + b             # <<<<<<<<<<<<<<
  * cdef double __sub(double a, double b):
@@ -16525,7 +18500,7 @@ static  double __pyx_f_7tseries___add(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":3
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":3
  * cdef double __add(double a, double b):
  *     return a + b
  * cdef double __sub(double a, double b):             # <<<<<<<<<<<<<<
@@ -16537,7 +18512,7 @@ static  double __pyx_f_7tseries___sub(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__sub");
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":4
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":4
  *     return a + b
  * cdef double __sub(double a, double b):
  *     return a - b             # <<<<<<<<<<<<<<
@@ -16553,7 +18528,7 @@ static  double __pyx_f_7tseries___sub(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":5
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":5
  * cdef double __sub(double a, double b):
  *     return a - b
  * cdef double __div(double a, double b):             # <<<<<<<<<<<<<<
@@ -16565,7 +18540,7 @@ static  double __pyx_f_7tseries___div(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__div");
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":6
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":6
  *     return a - b
  * cdef double __div(double a, double b):
  *     return a / b             # <<<<<<<<<<<<<<
@@ -16574,7 +18549,7 @@ static  double __pyx_f_7tseries___div(double __pyx_v_a, double __pyx_v_b) {
  */
   if (unlikely(__pyx_v_b == 0)) {
     PyErr_Format(PyExc_ZeroDivisionError, "float division");
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[6]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_r = (__pyx_v_a / __pyx_v_b);
   goto __pyx_L0;
@@ -16589,7 +18564,7 @@ static  double __pyx_f_7tseries___div(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":7
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":7
  * cdef double __div(double a, double b):
  *     return a / b
  * cdef double __mul(double a, double b):             # <<<<<<<<<<<<<<
@@ -16601,7 +18576,7 @@ static  double __pyx_f_7tseries___mul(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__mul");
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":8
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":8
  *     return a / b
  * cdef double __mul(double a, double b):
  *     return a * b             # <<<<<<<<<<<<<<
@@ -16617,7 +18592,7 @@ static  double __pyx_f_7tseries___mul(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":9
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":9
  * cdef double __mul(double a, double b):
  *     return a * b
  * cdef double __eq(double a, double b):             # <<<<<<<<<<<<<<
@@ -16629,7 +18604,7 @@ static  double __pyx_f_7tseries___eq(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__eq");
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":10
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":10
  *     return a * b
  * cdef double __eq(double a, double b):
  *     return a == b             # <<<<<<<<<<<<<<
@@ -16645,7 +18620,7 @@ static  double __pyx_f_7tseries___eq(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":11
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":11
  * cdef double __eq(double a, double b):
  *     return a == b
  * cdef double __ne(double a, double b):             # <<<<<<<<<<<<<<
@@ -16657,7 +18632,7 @@ static  double __pyx_f_7tseries___ne(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__ne");
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":12
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":12
  *     return a == b
  * cdef double __ne(double a, double b):
  *     return a != b             # <<<<<<<<<<<<<<
@@ -16673,7 +18648,7 @@ static  double __pyx_f_7tseries___ne(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":13
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":13
  * cdef double __ne(double a, double b):
  *     return a != b
  * cdef double __lt(double a, double b):             # <<<<<<<<<<<<<<
@@ -16685,7 +18660,7 @@ static  double __pyx_f_7tseries___lt(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__lt");
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":14
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":14
  *     return a != b
  * cdef double __lt(double a, double b):
  *     return a < b             # <<<<<<<<<<<<<<
@@ -16701,7 +18676,7 @@ static  double __pyx_f_7tseries___lt(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":15
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":15
  * cdef double __lt(double a, double b):
  *     return a < b
  * cdef double __gt(double a, double b):             # <<<<<<<<<<<<<<
@@ -16713,7 +18688,7 @@ static  double __pyx_f_7tseries___gt(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__gt");
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":16
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":16
  *     return a < b
  * cdef double __gt(double a, double b):
  *     return a > b             # <<<<<<<<<<<<<<
@@ -16729,7 +18704,7 @@ static  double __pyx_f_7tseries___gt(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":17
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":17
  * cdef double __gt(double a, double b):
  *     return a > b
  * cdef double __pow(double a, double b):             # <<<<<<<<<<<<<<
@@ -16741,7 +18716,7 @@ static  double __pyx_f_7tseries___pow(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__pow");
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":18
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":18
  *     return a > b
  * cdef double __pow(double a, double b):
  *     return a ** b             # <<<<<<<<<<<<<<
@@ -16757,7 +18732,7 @@ static  double __pyx_f_7tseries___pow(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":22
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":22
  * ctypedef double (* double_func)(double a, double b)
  * 
  * cdef ndarray _applyFunc(double_func func, ndarray index, object ao,             # <<<<<<<<<<<<<<
@@ -16801,51 +18776,51 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_v_iteridx = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":36
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":36
  *     # This is EXTREMELY important, otherwise you will get very
  *     # undesired results
  *     A = PyArray_ContiguousFromAny(ao, NPY_DOUBLE, 1, 1)             # <<<<<<<<<<<<<<
  *     B = PyArray_ContiguousFromAny(bo, NPY_DOUBLE, 1, 1)
  * 
  */
-  __pyx_t_1 = PyArray_ContiguousFromAny(__pyx_v_ao, NPY_DOUBLE, 1, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_ContiguousFromAny(__pyx_v_ao, NPY_DOUBLE, 1, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_A));
   __pyx_v_A = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":37
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":37
  *     # undesired results
  *     A = PyArray_ContiguousFromAny(ao, NPY_DOUBLE, 1, 1)
  *     B = PyArray_ContiguousFromAny(bo, NPY_DOUBLE, 1, 1)             # <<<<<<<<<<<<<<
  * 
  *     nan = <double> np.NaN
  */
-  __pyx_t_1 = PyArray_ContiguousFromAny(__pyx_v_bo, NPY_DOUBLE, 1, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_ContiguousFromAny(__pyx_v_bo, NPY_DOUBLE, 1, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_B));
   __pyx_v_B = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":39
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":39
  *     B = PyArray_ContiguousFromAny(bo, NPY_DOUBLE, 1, 1)
  * 
  *     nan = <double> np.NaN             # <<<<<<<<<<<<<<
  *     length = PyArray_SIZE(index)
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_nan = ((double)__pyx_t_3);
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":40
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":40
  * 
  *     nan = <double> np.NaN
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -16854,26 +18829,26 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_index);
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":42
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":42
  *     length = PyArray_SIZE(index)
  * 
  *     result = <ndarray> np.empty(length, np.float64)             # <<<<<<<<<<<<<<
  *     result_data = <double *>result.data
  * 
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__float64); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__float64); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
@@ -16881,7 +18856,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __Pyx_GIVEREF(__pyx_t_5);
   __pyx_t_2 = 0;
   __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -16890,7 +18865,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":43
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":43
  * 
  *     result = <ndarray> np.empty(length, np.float64)
  *     result_data = <double *>result.data             # <<<<<<<<<<<<<<
@@ -16899,35 +18874,35 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
   __pyx_v_result_data = ((double *)__pyx_v_result->data);
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":45
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":45
  *     result_data = <double *>result.data
  * 
  *     itera = <flatiter> PyArray_IterNew(A)             # <<<<<<<<<<<<<<
  *     iteridx = PyArray_IterNew(index)
  * 
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_A)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_A)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_itera));
   __pyx_v_itera = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":46
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":46
  * 
  *     itera = <flatiter> PyArray_IterNew(A)
  *     iteridx = PyArray_IterNew(index)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < length:
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_flatiter))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_flatiter))))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_iteridx));
   __pyx_v_iteridx = ((PyArrayIterObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":48
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":48
  *     iteridx = PyArray_IterNew(index)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -16937,20 +18912,20 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_t_6 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":49
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":49
  * 
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))             # <<<<<<<<<<<<<<
  *         PyArray_ITER_NEXT(iteridx)
  * 
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iteridx)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iteridx)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_idx);
     __pyx_v_idx = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":50
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":50
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
  *         PyArray_ITER_NEXT(iteridx)             # <<<<<<<<<<<<<<
@@ -16959,7 +18934,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
     PyArray_ITER_NEXT(__pyx_v_iteridx);
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":52
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":52
  *         PyArray_ITER_NEXT(iteridx)
  * 
  *         if idx not in aMap or idx not in bMap:             # <<<<<<<<<<<<<<
@@ -16967,15 +18942,15 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  *             continue
  */
     if (unlikely(((PyObject *)__pyx_v_aMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_7 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_aMap), __pyx_v_idx))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_aMap), __pyx_v_idx))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     if (!__pyx_t_7) {
       if (unlikely(((PyObject *)__pyx_v_bMap) == Py_None)) {
-        __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       } else {
-        __pyx_t_8 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_bMap), __pyx_v_idx))); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_8 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_bMap), __pyx_v_idx))); if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_t_9 = __pyx_t_8;
     } else {
@@ -16983,7 +18958,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     }
     if (__pyx_t_9) {
 
-      /* "H:\pandas\pandas\lib\src\operators.pyx":53
+      /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":53
  * 
  *         if idx not in aMap or idx not in bMap:
  *             result_data[i] = nan             # <<<<<<<<<<<<<<
@@ -16992,7 +18967,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
       (__pyx_v_result_data[__pyx_v_i]) = __pyx_v_nan;
 
-      /* "H:\pandas\pandas\lib\src\operators.pyx":54
+      /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":54
  *         if idx not in aMap or idx not in bMap:
  *             result_data[i] = nan
  *             continue             # <<<<<<<<<<<<<<
@@ -17004,31 +18979,31 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     }
     __pyx_L5:;
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":56
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":56
  *             continue
  * 
  *         result_data[i] = func((<double *>A.data)[aMap[idx]],             # <<<<<<<<<<<<<<
  *                             (<double *>B.data)[bMap[idx]])
  * 
  */
-    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_aMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_aMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_10 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":57
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":57
  * 
  *         result_data[i] = func((<double *>A.data)[aMap[idx]],
  *                             (<double *>B.data)[bMap[idx]])             # <<<<<<<<<<<<<<
  * 
  *     return result
  */
-    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_bMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_bMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":56
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":56
  *             continue
  * 
  *         result_data[i] = func((<double *>A.data)[aMap[idx]],             # <<<<<<<<<<<<<<
@@ -17039,7 +19014,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     __pyx_L3_continue:;
   }
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":59
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":59
  *                             (<double *>B.data)[bMap[idx]])
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -17077,7 +19052,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\operators.pyx":61
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":61
  *     return result
  * 
  * def combineFunc(object name, ndarray index, object ao,             # <<<<<<<<<<<<<<
@@ -17123,35 +19098,35 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__index);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 1); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__ao);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 2); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__bo);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 3); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 3); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  4:
       values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__aMap);
       if (likely(values[4])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 4); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 4); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  5:
       values[5] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__bMap);
       if (likely(values[5])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 5); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, 5); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "combineFunc") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "combineFunc") < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_name = values[0];
     __pyx_v_index = ((PyArrayObject *)values[1]);
@@ -17171,7 +19146,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("combineFunc", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.combineFunc");
   return NULL;
@@ -17182,24 +19157,24 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_INCREF(__pyx_v_bo);
   __Pyx_INCREF(__pyx_v_aMap);
   __Pyx_INCREF(__pyx_v_bMap);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_aMap), &PyDict_Type, 1, "aMap", 1))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_bMap), &PyDict_Type, 1, "bMap", 1))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_aMap), &PyDict_Type, 1, "aMap", 1))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_bMap), &PyDict_Type, 1, "bMap", 1))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":67
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":67
  *     indicated function.
  *     '''
  *     if name == "__add__":             # <<<<<<<<<<<<<<
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)
  *     elif name == "__sub__":
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____add__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____add__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":68
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":68
  *     '''
  *     if name == "__add__":
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17207,7 +19182,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___add, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___add, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -17215,20 +19190,20 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":69
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":69
  *     if name == "__add__":
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)
  *     elif name == "__sub__":             # <<<<<<<<<<<<<<
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)
  *     elif name == "__div__":
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____sub__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____sub__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":70
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":70
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)
  *     elif name == "__sub__":
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17236,7 +19211,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___sub, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___sub, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -17244,20 +19219,20 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":71
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":71
  *     elif name == "__sub__":
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)
  *     elif name == "__div__":             # <<<<<<<<<<<<<<
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)
  *     elif name == "__mul__":
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____div__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____div__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":72
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":72
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)
  *     elif name == "__div__":
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17265,7 +19240,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___div, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___div, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -17273,20 +19248,20 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":73
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":73
  *     elif name == "__div__":
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)
  *     elif name == "__mul__":             # <<<<<<<<<<<<<<
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)
  *     elif name == "__eq__":
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____mul__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____mul__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":74
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":74
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)
  *     elif name == "__mul__":
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17294,7 +19269,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___mul, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___mul, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -17302,20 +19277,20 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":75
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":75
  *     elif name == "__mul__":
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)
  *     elif name == "__eq__":             # <<<<<<<<<<<<<<
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)
  *     elif name == "__ne__":
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____eq__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____eq__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":76
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":76
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)
  *     elif name == "__eq__":
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17323,7 +19298,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___eq, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___eq, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -17331,20 +19306,20 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":77
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":77
  *     elif name == "__eq__":
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)
  *     elif name == "__ne__":             # <<<<<<<<<<<<<<
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)
  *     elif name == "__lt__":
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____ne__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____ne__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":78
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":78
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)
  *     elif name == "__ne__":
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17352,7 +19327,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___ne, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___ne, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -17360,20 +19335,20 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":79
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":79
  *     elif name == "__ne__":
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)
  *     elif name == "__lt__":             # <<<<<<<<<<<<<<
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)
  *     elif name == "__gt__":
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____lt__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____lt__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":80
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":80
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)
  *     elif name == "__lt__":
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17381,7 +19356,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___lt, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___lt, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -17389,20 +19364,20 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":81
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":81
  *     elif name == "__lt__":
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)
  *     elif name == "__gt__":             # <<<<<<<<<<<<<<
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)
  *     elif name == "__pow__":
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____gt__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____gt__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":82
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":82
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)
  *     elif name == "__gt__":
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17410,7 +19385,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
  *         return _applyFunc(__pow, index, ao, bo, aMap, bMap)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___gt, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___gt, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -17418,20 +19393,20 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "H:\pandas\pandas\lib\src\operators.pyx":83
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":83
  *     elif name == "__gt__":
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)
  *     elif name == "__pow__":             # <<<<<<<<<<<<<<
  *         return _applyFunc(__pow, index, ao, bo, aMap, bMap)
  *     else:
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____pow__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_name, ((PyObject *)__pyx_n_s____pow__), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":84
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":84
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)
  *     elif name == "__pow__":
  *         return _applyFunc(__pow, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17439,7 +19414,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
  *         raise Exception('bad funcname requested of Cython code')
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___pow, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = ((PyObject *)__pyx_f_7tseries__applyFunc(__pyx_f_7tseries___pow, __pyx_v_index, __pyx_v_ao, __pyx_v_bo, __pyx_v_aMap, __pyx_v_bMap)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
@@ -17448,22 +19423,22 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\operators.pyx":86
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":86
  *         return _applyFunc(__pow, index, ao, bo, aMap, bMap)
  *     else:
  *         raise Exception('bad funcname requested of Cython code')             # <<<<<<<<<<<<<<
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_s_8));
-    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_8));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_8));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_INCREF(((PyObject *)__pyx_kp_s_9));
+    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_9));
+    __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_9));
+    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[6]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_L6:;
 
@@ -17613,17 +19588,17 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  * 
  *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
  */
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_u_9));
-    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_9));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_9));
-    __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_INCREF(((PyObject *)__pyx_kp_u_10));
+    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_10));
+    __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_10));
+    __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_5, 0, 0);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    {__pyx_filename = __pyx_f[6]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[7]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L6;
   }
   __pyx_L6:;
@@ -17659,17 +19634,17 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  * 
  *             info.buf = PyArray_DATA(self)
  */
-    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_u_10));
-    PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_10));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_10));
-    __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_INCREF(((PyObject *)__pyx_kp_u_11));
+    PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_11));
+    __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_11));
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    {__pyx_filename = __pyx_f[6]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[7]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L7;
   }
   __pyx_L7:;
@@ -17936,17 +19911,17 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  *                 if   t == NPY_BYTE:        f = "b"
  *                 elif t == NPY_UBYTE:       f = "B"
  */
-      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_INCREF(((PyObject *)__pyx_kp_u_11));
-      PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_11));
-      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_11));
-      __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_INCREF(((PyObject *)__pyx_kp_u_12));
+      PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_12));
+      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_12));
+      __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_5, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      {__pyx_filename = __pyx_f[6]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[7]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       goto __pyx_L13;
     }
     __pyx_L13:;
@@ -18180,22 +20155,22 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  *                 info.format = f
  *                 return
  */
-      __pyx_t_5 = PyInt_FromLong(__pyx_v_t); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(__pyx_v_t); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_12), __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_13), __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_4);
       __pyx_t_4 = 0;
-      __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_Raise(__pyx_t_4, 0, 0);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      {__pyx_filename = __pyx_f[6]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[7]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_L14:;
 
@@ -18255,7 +20230,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  *                 f[0] = 0 # Terminate format string
  * 
  */
-    __pyx_t_9 = __pyx_f_5numpy__util_dtypestring(__pyx_v_descr, (__pyx_v_info->format + 1), (__pyx_v_info->format + 255), (&__pyx_v_offset)); if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __pyx_f_5numpy__util_dtypestring(__pyx_v_descr, (__pyx_v_info->format + 1), (__pyx_v_info->format + 255), (&__pyx_v_offset)); if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_v_f = __pyx_t_9;
 
     /* "C:\Python25\lib\site-packages\Cython\Includes\numpy.pxd":276
@@ -18374,7 +20349,7 @@ static INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew1(PyObject *__pyx_v_a
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -18413,7 +20388,7 @@ static INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew2(PyObject *__pyx_v_a
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -18452,7 +20427,7 @@ static INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew3(PyObject *__pyx_v_a
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -18491,7 +20466,7 @@ static INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew4(PyObject *__pyx_v_a
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 765; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 765; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -18530,7 +20505,7 @@ static INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew5(PyObject *__pyx_v_a
  * cdef inline char* _util_dtypestring(dtype descr, char* f, char* end, int* offset) except NULL:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -18611,7 +20586,7 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
   if (likely(((PyObject *)__pyx_v_descr->names) != Py_None)) {
     __pyx_t_1 = 0; __pyx_t_2 = ((PyObject *)__pyx_v_descr->names); __Pyx_INCREF(__pyx_t_2);
   } else {
-    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable"); {__pyx_filename = __pyx_f[6]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable"); {__pyx_filename = __pyx_f[7]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   for (;;) {
     if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
@@ -18627,9 +20602,9 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *         child, new_offset = fields
  * 
  */
-    __pyx_t_3 = PyObject_GetItem(__pyx_v_descr->fields, __pyx_v_childname); if (!__pyx_t_3) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetItem(__pyx_v_descr->fields, __pyx_v_childname); if (!__pyx_t_3) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    if (!(likely(PyTuple_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_3)->tp_name), 0))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(PyTuple_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_3)->tp_name), 0))) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_fields));
     __pyx_v_fields = ((PyObject *)__pyx_t_3);
     __pyx_t_3 = 0;
@@ -18644,7 +20619,7 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
     if (likely(((PyObject *)__pyx_v_fields) != Py_None) && likely(PyTuple_GET_SIZE(((PyObject *)__pyx_v_fields)) == 2)) {
       PyObject* tuple = ((PyObject *)__pyx_v_fields);
       __pyx_t_3 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_3);
-      if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_dtype))))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_dtype))))) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __pyx_t_4 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_4);
       __Pyx_DECREF(((PyObject *)__pyx_v_child));
       __pyx_v_child = ((PyArray_Descr *)__pyx_t_3);
@@ -18654,7 +20629,7 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
       __pyx_t_4 = 0;
     } else {
       __Pyx_UnpackTupleError(((PyObject *)__pyx_v_fields), 2);
-      {__pyx_filename = __pyx_f[6]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[7]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
 
     /* "C:\Python25\lib\site-packages\Cython\Includes\numpy.pxd":785
@@ -18664,21 +20639,21 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")
  * 
  */
-    __pyx_t_4 = PyInt_FromLong((__pyx_v_end - __pyx_v_f)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyInt_FromLong((__pyx_v_end - __pyx_v_f)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyInt_FromLong((__pyx_v_offset[0])); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyInt_FromLong((__pyx_v_offset[0])); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = PyNumber_Subtract(__pyx_v_new_offset, __pyx_t_3); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyNumber_Subtract(__pyx_v_new_offset, __pyx_t_3); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyObject_RichCompare(__pyx_t_3, __pyx_int_15, Py_LT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_RichCompare(__pyx_t_3, __pyx_int_15, Py_LT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_6) {
 
@@ -18689,17 +20664,17 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  * 
  *         if ((child.byteorder == '>' and little_endian) or
  */
-      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_INCREF(((PyObject *)__pyx_kp_u_13));
-      PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_13));
-      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_13));
-      __pyx_t_3 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_INCREF(((PyObject *)__pyx_kp_u_14));
+      PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_14));
+      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_14));
+      __pyx_t_3 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      {__pyx_filename = __pyx_f[6]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[7]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       goto __pyx_L5;
     }
     __pyx_L5:;
@@ -18746,17 +20721,17 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             # One could encode it in the format string and have Cython
  *             # complain instead, BUT: < and > in format strings also imply
  */
-      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_INCREF(((PyObject *)__pyx_kp_u_11));
-      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_11));
-      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_11));
-      __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_INCREF(((PyObject *)__pyx_kp_u_12));
+      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_12));
+      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_12));
+      __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_Raise(__pyx_t_5, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      {__pyx_filename = __pyx_f[6]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[7]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       goto __pyx_L6;
     }
     __pyx_L6:;
@@ -18769,12 +20744,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             f += 1
  */
     while (1) {
-      __pyx_t_5 = PyInt_FromLong((__pyx_v_offset[0])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong((__pyx_v_offset[0])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_v_new_offset, Py_LT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_v_new_offset, Py_LT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (!__pyx_t_6) break;
 
@@ -18832,7 +20807,7 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             if end - f < 5:
  *                 raise RuntimeError(u"Format string allocated too short.")
  */
-      __pyx_t_3 = PyInt_FromLong(__pyx_v_child->type_num); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(__pyx_v_child->type_num); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_v_t);
       __pyx_v_t = __pyx_t_3;
@@ -18855,17 +20830,17 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  * 
  *             # Until ticket #99 is fixed, use integers to avoid warnings
  */
-        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_INCREF(((PyObject *)__pyx_kp_u_14));
-        PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_14));
-        __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_14));
-        __pyx_t_5 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_INCREF(((PyObject *)__pyx_kp_u_15));
+        PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_15));
+        __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_15));
+        __pyx_t_5 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_Raise(__pyx_t_5, 0, 0);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        {__pyx_filename = __pyx_f[6]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[7]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         goto __pyx_L10;
       }
       __pyx_L10:;
@@ -18877,12 +20852,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_UBYTE:       f[0] =  66 #"B"
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_BYTE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_BYTE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 98;
@@ -18896,12 +20871,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_UBYTE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_UBYTE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 66;
@@ -18915,12 +20890,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"
  *             elif t == NPY_INT:         f[0] = 105 #"i"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_SHORT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_SHORT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 104;
@@ -18934,12 +20909,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_INT:         f[0] = 105 #"i"
  *             elif t == NPY_UINT:        f[0] =  73 #"I"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_USHORT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_USHORT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 72;
@@ -18953,12 +20928,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_UINT:        f[0] =  73 #"I"
  *             elif t == NPY_LONG:        f[0] = 108 #"l"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_INT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_INT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 105;
@@ -18972,12 +20947,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_LONG:        f[0] = 108 #"l"
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_UINT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_UINT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 73;
@@ -18991,12 +20966,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_LONG); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_LONG); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 108;
@@ -19010,12 +20985,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_ULONG); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_ULONG); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 76;
@@ -19029,12 +21004,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_LONGLONG); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_LONGLONG); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 113;
@@ -19048,12 +21023,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_ULONGLONG); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_ULONGLONG); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 81;
@@ -19067,12 +21042,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_FLOAT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_FLOAT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 102;
@@ -19086,12 +21061,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_DOUBLE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_DOUBLE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 100;
@@ -19105,12 +21080,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_LONGDOUBLE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_LONGDOUBLE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 103;
@@ -19124,12 +21099,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
  *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_CFLOAT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_CFLOAT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 90;
@@ -19145,12 +21120,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg
  *             elif t == NPY_OBJECT:      f[0] = 79 #"O"
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_CDOUBLE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_CDOUBLE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 90;
@@ -19166,12 +21141,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             elif t == NPY_OBJECT:      f[0] = 79 #"O"
  *             else:
  */
-      __pyx_t_3 = PyInt_FromLong(NPY_CLONGDOUBLE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyInt_FromLong(NPY_CLONGDOUBLE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 90;
@@ -19187,12 +21162,12 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             else:
  *                 raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
  */
-      __pyx_t_5 = PyInt_FromLong(NPY_OBJECT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyInt_FromLong(NPY_OBJECT); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_5, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_6) {
         (__pyx_v_f[0]) = 79;
@@ -19207,19 +21182,19 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *             f += 1
  *         else:
  */
-        __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_12), __pyx_v_t); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_13), __pyx_v_t); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
         PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
         __Pyx_GIVEREF(__pyx_t_3);
         __pyx_t_3 = 0;
-        __pyx_t_3 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_Raise(__pyx_t_3, 0, 0);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        {__pyx_filename = __pyx_f[6]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[7]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_L11:;
 
@@ -19242,7 +21217,7 @@ static INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_desc
  *     return f
  * 
  */
-      __pyx_t_10 = __pyx_f_5numpy__util_dtypestring(__pyx_v_child, __pyx_v_f, __pyx_v_end, __pyx_v_offset); if (unlikely(__pyx_t_10 == NULL)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = __pyx_f_5numpy__util_dtypestring(__pyx_v_child, __pyx_v_f, __pyx_v_end, __pyx_v_offset); if (unlikely(__pyx_t_10 == NULL)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __pyx_v_f = __pyx_t_10;
     }
     __pyx_L9:;
@@ -19418,6 +21393,438 @@ static INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr
   return __pyx_r;
 }
 
+static PyObject *__pyx_tp_new_7tseries_Node(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_7tseries_Node *p;
+  PyObject *o = (*t->tp_alloc)(t, 0);
+  if (!o) return 0;
+  p = ((struct __pyx_obj_7tseries_Node *)o);
+  p->next = ((PyObject *)Py_None); Py_INCREF(Py_None);
+  p->width_arr = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
+  return o;
+}
+
+static void __pyx_tp_dealloc_7tseries_Node(PyObject *o) {
+  struct __pyx_obj_7tseries_Node *p = (struct __pyx_obj_7tseries_Node *)o;
+  Py_XDECREF(((PyObject *)p->next));
+  Py_XDECREF(((PyObject *)p->width_arr));
+  (*Py_TYPE(o)->tp_free)(o);
+}
+
+static int __pyx_tp_traverse_7tseries_Node(PyObject *o, visitproc v, void *a) {
+  int e;
+  struct __pyx_obj_7tseries_Node *p = (struct __pyx_obj_7tseries_Node *)o;
+  if (p->next) {
+    e = (*v)(p->next, a); if (e) return e;
+  }
+  if (p->width_arr) {
+    e = (*v)(((PyObject*)p->width_arr), a); if (e) return e;
+  }
+  return 0;
+}
+
+static int __pyx_tp_clear_7tseries_Node(PyObject *o) {
+  struct __pyx_obj_7tseries_Node *p = (struct __pyx_obj_7tseries_Node *)o;
+  PyObject* tmp;
+  tmp = ((PyObject*)p->next);
+  p->next = ((PyObject *)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->width_arr);
+  p->width_arr = ((PyArrayObject *)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  return 0;
+}
+
+static PyObject *__pyx_getprop_7tseries_4Node_next(PyObject *o, void *x) {
+  return __pyx_pf_7tseries_4Node_4next___get__(o);
+}
+
+static int __pyx_setprop_7tseries_4Node_next(PyObject *o, PyObject *v, void *x) {
+  if (v) {
+    return __pyx_pf_7tseries_4Node_4next___set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_7tseries_4Node_width_arr(PyObject *o, void *x) {
+  return __pyx_pf_7tseries_4Node_9width_arr___get__(o);
+}
+
+static int __pyx_setprop_7tseries_4Node_width_arr(PyObject *o, PyObject *v, void *x) {
+  if (v) {
+    return __pyx_pf_7tseries_4Node_9width_arr___set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static struct PyMethodDef __pyx_methods_7tseries_Node[] = {
+  {0, 0, 0, 0}
+};
+
+static struct PyMemberDef __pyx_members_7tseries_Node[] = {
+  {(char *)"value", T_DOUBLE, offsetof(struct __pyx_obj_7tseries_Node, value), 0, 0},
+  {0, 0, 0, 0, 0}
+};
+
+static struct PyGetSetDef __pyx_getsets_7tseries_Node[] = {
+  {(char *)"next", __pyx_getprop_7tseries_4Node_next, __pyx_setprop_7tseries_4Node_next, 0, 0},
+  {(char *)"width_arr", __pyx_getprop_7tseries_4Node_width_arr, __pyx_setprop_7tseries_4Node_width_arr, 0, 0},
+  {0, 0, 0, 0, 0}
+};
+
+static PyNumberMethods __pyx_tp_as_number_Node = {
+  0, /*nb_add*/
+  0, /*nb_subtract*/
+  0, /*nb_multiply*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_divide*/
+  #endif
+  0, /*nb_remainder*/
+  0, /*nb_divmod*/
+  0, /*nb_power*/
+  0, /*nb_negative*/
+  0, /*nb_positive*/
+  0, /*nb_absolute*/
+  0, /*nb_nonzero*/
+  0, /*nb_invert*/
+  0, /*nb_lshift*/
+  0, /*nb_rshift*/
+  0, /*nb_and*/
+  0, /*nb_xor*/
+  0, /*nb_or*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_coerce*/
+  #endif
+  0, /*nb_int*/
+  #if PY_MAJOR_VERSION >= 3
+  0, /*reserved*/
+  #else
+  0, /*nb_long*/
+  #endif
+  0, /*nb_float*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_oct*/
+  #endif
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_hex*/
+  #endif
+  0, /*nb_inplace_add*/
+  0, /*nb_inplace_subtract*/
+  0, /*nb_inplace_multiply*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_inplace_divide*/
+  #endif
+  0, /*nb_inplace_remainder*/
+  0, /*nb_inplace_power*/
+  0, /*nb_inplace_lshift*/
+  0, /*nb_inplace_rshift*/
+  0, /*nb_inplace_and*/
+  0, /*nb_inplace_xor*/
+  0, /*nb_inplace_or*/
+  0, /*nb_floor_divide*/
+  0, /*nb_true_divide*/
+  0, /*nb_inplace_floor_divide*/
+  0, /*nb_inplace_true_divide*/
+  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
+  0, /*nb_index*/
+  #endif
+};
+
+static PySequenceMethods __pyx_tp_as_sequence_Node = {
+  0, /*sq_length*/
+  0, /*sq_concat*/
+  0, /*sq_repeat*/
+  0, /*sq_item*/
+  0, /*sq_slice*/
+  0, /*sq_ass_item*/
+  0, /*sq_ass_slice*/
+  0, /*sq_contains*/
+  0, /*sq_inplace_concat*/
+  0, /*sq_inplace_repeat*/
+};
+
+static PyMappingMethods __pyx_tp_as_mapping_Node = {
+  0, /*mp_length*/
+  0, /*mp_subscript*/
+  0, /*mp_ass_subscript*/
+};
+
+static PyBufferProcs __pyx_tp_as_buffer_Node = {
+  #if PY_MAJOR_VERSION < 3
+  0, /*bf_getreadbuffer*/
+  #endif
+  #if PY_MAJOR_VERSION < 3
+  0, /*bf_getwritebuffer*/
+  #endif
+  #if PY_MAJOR_VERSION < 3
+  0, /*bf_getsegcount*/
+  #endif
+  #if PY_MAJOR_VERSION < 3
+  0, /*bf_getcharbuffer*/
+  #endif
+  #if PY_VERSION_HEX >= 0x02060000
+  0, /*bf_getbuffer*/
+  #endif
+  #if PY_VERSION_HEX >= 0x02060000
+  0, /*bf_releasebuffer*/
+  #endif
+};
+
+PyTypeObject __pyx_type_7tseries_Node = {
+  PyVarObject_HEAD_INIT(0, 0)
+  __Pyx_NAMESTR("tseries.Node"), /*tp_name*/
+  sizeof(struct __pyx_obj_7tseries_Node), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_7tseries_Node, /*tp_dealloc*/
+  0, /*tp_print*/
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  0, /*tp_compare*/
+  0, /*tp_repr*/
+  &__pyx_tp_as_number_Node, /*tp_as_number*/
+  &__pyx_tp_as_sequence_Node, /*tp_as_sequence*/
+  &__pyx_tp_as_mapping_Node, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  &__pyx_tp_as_buffer_Node, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
+  0, /*tp_doc*/
+  __pyx_tp_traverse_7tseries_Node, /*tp_traverse*/
+  __pyx_tp_clear_7tseries_Node, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  __pyx_methods_7tseries_Node, /*tp_methods*/
+  __pyx_members_7tseries_Node, /*tp_members*/
+  __pyx_getsets_7tseries_Node, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  __pyx_pf_7tseries_4Node___init__, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_7tseries_Node, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  #if PY_VERSION_HEX >= 0x02060000
+  0, /*tp_version_tag*/
+  #endif
+};
+
+static PyObject *__pyx_tp_new_7tseries_IndexableSkiplist(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_7tseries_IndexableSkiplist *p;
+  PyObject *o = (*t->tp_alloc)(t, 0);
+  if (!o) return 0;
+  p = ((struct __pyx_obj_7tseries_IndexableSkiplist *)o);
+  p->head = ((struct __pyx_obj_7tseries_Node *)Py_None); Py_INCREF(Py_None);
+  return o;
+}
+
+static void __pyx_tp_dealloc_7tseries_IndexableSkiplist(PyObject *o) {
+  struct __pyx_obj_7tseries_IndexableSkiplist *p = (struct __pyx_obj_7tseries_IndexableSkiplist *)o;
+  Py_XDECREF(((PyObject *)p->head));
+  (*Py_TYPE(o)->tp_free)(o);
+}
+
+static int __pyx_tp_traverse_7tseries_IndexableSkiplist(PyObject *o, visitproc v, void *a) {
+  int e;
+  struct __pyx_obj_7tseries_IndexableSkiplist *p = (struct __pyx_obj_7tseries_IndexableSkiplist *)o;
+  if (p->head) {
+    e = (*v)(((PyObject*)p->head), a); if (e) return e;
+  }
+  return 0;
+}
+
+static int __pyx_tp_clear_7tseries_IndexableSkiplist(PyObject *o) {
+  struct __pyx_obj_7tseries_IndexableSkiplist *p = (struct __pyx_obj_7tseries_IndexableSkiplist *)o;
+  PyObject* tmp;
+  tmp = ((PyObject*)p->head);
+  p->head = ((struct __pyx_obj_7tseries_Node *)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  return 0;
+}
+static PyObject *__pyx_sq_item_7tseries_IndexableSkiplist(PyObject *o, Py_ssize_t i) {
+  PyObject *r;
+  PyObject *x = PyInt_FromSsize_t(i); if(!x) return 0;
+  r = Py_TYPE(o)->tp_as_mapping->mp_subscript(o, x);
+  Py_DECREF(x);
+  return r;
+}
+
+static struct PyMethodDef __pyx_methods_7tseries_IndexableSkiplist[] = {
+  {__Pyx_NAMESTR("__getitem__"), (PyCFunction)__pyx_pf_7tseries_17IndexableSkiplist___getitem__, METH_O|METH_COEXIST, __Pyx_DOCSTR(0)},
+  {__Pyx_NAMESTR("get"), (PyCFunction)__pyx_pf_7tseries_17IndexableSkiplist_get, METH_O, __Pyx_DOCSTR(0)},
+  {__Pyx_NAMESTR("insert"), (PyCFunction)__pyx_pf_7tseries_17IndexableSkiplist_insert, METH_O, __Pyx_DOCSTR(0)},
+  {__Pyx_NAMESTR("remove"), (PyCFunction)__pyx_pf_7tseries_17IndexableSkiplist_remove, METH_O, __Pyx_DOCSTR(0)},
+  {0, 0, 0, 0}
+};
+
+static PyNumberMethods __pyx_tp_as_number_IndexableSkiplist = {
+  0, /*nb_add*/
+  0, /*nb_subtract*/
+  0, /*nb_multiply*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_divide*/
+  #endif
+  0, /*nb_remainder*/
+  0, /*nb_divmod*/
+  0, /*nb_power*/
+  0, /*nb_negative*/
+  0, /*nb_positive*/
+  0, /*nb_absolute*/
+  0, /*nb_nonzero*/
+  0, /*nb_invert*/
+  0, /*nb_lshift*/
+  0, /*nb_rshift*/
+  0, /*nb_and*/
+  0, /*nb_xor*/
+  0, /*nb_or*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_coerce*/
+  #endif
+  0, /*nb_int*/
+  #if PY_MAJOR_VERSION >= 3
+  0, /*reserved*/
+  #else
+  0, /*nb_long*/
+  #endif
+  0, /*nb_float*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_oct*/
+  #endif
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_hex*/
+  #endif
+  0, /*nb_inplace_add*/
+  0, /*nb_inplace_subtract*/
+  0, /*nb_inplace_multiply*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*nb_inplace_divide*/
+  #endif
+  0, /*nb_inplace_remainder*/
+  0, /*nb_inplace_power*/
+  0, /*nb_inplace_lshift*/
+  0, /*nb_inplace_rshift*/
+  0, /*nb_inplace_and*/
+  0, /*nb_inplace_xor*/
+  0, /*nb_inplace_or*/
+  0, /*nb_floor_divide*/
+  0, /*nb_true_divide*/
+  0, /*nb_inplace_floor_divide*/
+  0, /*nb_inplace_true_divide*/
+  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
+  0, /*nb_index*/
+  #endif
+};
+
+static PySequenceMethods __pyx_tp_as_sequence_IndexableSkiplist = {
+  __pyx_pf_7tseries_17IndexableSkiplist___len__, /*sq_length*/
+  0, /*sq_concat*/
+  0, /*sq_repeat*/
+  __pyx_sq_item_7tseries_IndexableSkiplist, /*sq_item*/
+  0, /*sq_slice*/
+  0, /*sq_ass_item*/
+  0, /*sq_ass_slice*/
+  0, /*sq_contains*/
+  0, /*sq_inplace_concat*/
+  0, /*sq_inplace_repeat*/
+};
+
+static PyMappingMethods __pyx_tp_as_mapping_IndexableSkiplist = {
+  __pyx_pf_7tseries_17IndexableSkiplist___len__, /*mp_length*/
+  __pyx_pf_7tseries_17IndexableSkiplist___getitem__, /*mp_subscript*/
+  0, /*mp_ass_subscript*/
+};
+
+static PyBufferProcs __pyx_tp_as_buffer_IndexableSkiplist = {
+  #if PY_MAJOR_VERSION < 3
+  0, /*bf_getreadbuffer*/
+  #endif
+  #if PY_MAJOR_VERSION < 3
+  0, /*bf_getwritebuffer*/
+  #endif
+  #if PY_MAJOR_VERSION < 3
+  0, /*bf_getsegcount*/
+  #endif
+  #if PY_MAJOR_VERSION < 3
+  0, /*bf_getcharbuffer*/
+  #endif
+  #if PY_VERSION_HEX >= 0x02060000
+  0, /*bf_getbuffer*/
+  #endif
+  #if PY_VERSION_HEX >= 0x02060000
+  0, /*bf_releasebuffer*/
+  #endif
+};
+
+PyTypeObject __pyx_type_7tseries_IndexableSkiplist = {
+  PyVarObject_HEAD_INIT(0, 0)
+  __Pyx_NAMESTR("tseries.IndexableSkiplist"), /*tp_name*/
+  sizeof(struct __pyx_obj_7tseries_IndexableSkiplist), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_7tseries_IndexableSkiplist, /*tp_dealloc*/
+  0, /*tp_print*/
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  0, /*tp_compare*/
+  0, /*tp_repr*/
+  &__pyx_tp_as_number_IndexableSkiplist, /*tp_as_number*/
+  &__pyx_tp_as_sequence_IndexableSkiplist, /*tp_as_sequence*/
+  &__pyx_tp_as_mapping_IndexableSkiplist, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  &__pyx_tp_as_buffer_IndexableSkiplist, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
+  __Pyx_DOCSTR("\n    Sorted collection supporting O(lg n) insertion, removal, and lookup by rank.\n    "), /*tp_doc*/
+  __pyx_tp_traverse_7tseries_IndexableSkiplist, /*tp_traverse*/
+  __pyx_tp_clear_7tseries_IndexableSkiplist, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  __pyx_methods_7tseries_IndexableSkiplist, /*tp_methods*/
+  0, /*tp_members*/
+  0, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  __pyx_pf_7tseries_17IndexableSkiplist___init__, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_7tseries_IndexableSkiplist, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  #if PY_VERSION_HEX >= 0x02060000
+  0, /*tp_version_tag*/
+  #endif
+};
+
 static struct PyMethodDef __pyx_methods[] = {
   {__Pyx_NAMESTR("map_indices"), (PyCFunction)__pyx_pf_7tseries_map_indices, METH_O, __Pyx_DOCSTR(__pyx_doc_7tseries_map_indices)},
   {__Pyx_NAMESTR("isnull"), (PyCFunction)__pyx_pf_7tseries_isnull, METH_O, __Pyx_DOCSTR(__pyx_doc_7tseries_isnull)},
@@ -19434,9 +21841,10 @@ static struct PyMethodDef __pyx_methods[] = {
   {__Pyx_NAMESTR("_roll_skew_noncontig"), (PyCFunction)__pyx_pf_7tseries__roll_skew_noncontig, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("_roll_kurt_noncontig"), (PyCFunction)__pyx_pf_7tseries__roll_kurt_noncontig, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("median"), (PyCFunction)__pyx_pf_7tseries_median, METH_O, __Pyx_DOCSTR(0)},
-  {__Pyx_NAMESTR("roll_median"), (PyCFunction)__pyx_pf_7tseries_roll_median, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("_roll_max_noncontig"), (PyCFunction)__pyx_pf_7tseries__roll_max_noncontig, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("_roll_min_noncontig"), (PyCFunction)__pyx_pf_7tseries__roll_min_noncontig, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
+  {__Pyx_NAMESTR("roll_median"), (PyCFunction)__pyx_pf_7tseries_roll_median, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
+  {__Pyx_NAMESTR("rolling_median"), (PyCFunction)__pyx_pf_7tseries_rolling_median, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("rolling_sum"), (PyCFunction)__pyx_pf_7tseries_rolling_sum, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_rolling_sum)},
   {__Pyx_NAMESTR("rolling_mean"), (PyCFunction)__pyx_pf_7tseries_rolling_mean, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("ewma"), (PyCFunction)__pyx_pf_7tseries_ewma, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
@@ -19476,17 +21884,20 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_kp_u_12, __pyx_k_12, sizeof(__pyx_k_12), 0, 1, 0, 0},
   {&__pyx_kp_u_13, __pyx_k_13, sizeof(__pyx_k_13), 0, 1, 0, 0},
   {&__pyx_kp_u_14, __pyx_k_14, sizeof(__pyx_k_14), 0, 1, 0, 0},
+  {&__pyx_kp_u_15, __pyx_k_15, sizeof(__pyx_k_15), 0, 1, 0, 0},
   {&__pyx_kp_s_2, __pyx_k_2, sizeof(__pyx_k_2), 0, 0, 1, 0},
   {&__pyx_kp_s_3, __pyx_k_3, sizeof(__pyx_k_3), 0, 0, 1, 0},
-  {&__pyx_n_s_4, __pyx_k_4, sizeof(__pyx_k_4), 0, 0, 1, 1},
+  {&__pyx_kp_s_4, __pyx_k_4, sizeof(__pyx_k_4), 0, 0, 1, 0},
   {&__pyx_n_s_5, __pyx_k_5, sizeof(__pyx_k_5), 0, 0, 1, 1},
   {&__pyx_n_s_6, __pyx_k_6, sizeof(__pyx_k_6), 0, 0, 1, 1},
-  {&__pyx_kp_s_7, __pyx_k_7, sizeof(__pyx_k_7), 0, 0, 1, 0},
+  {&__pyx_n_s_7, __pyx_k_7, sizeof(__pyx_k_7), 0, 0, 1, 1},
   {&__pyx_kp_s_8, __pyx_k_8, sizeof(__pyx_k_8), 0, 0, 1, 0},
-  {&__pyx_kp_u_9, __pyx_k_9, sizeof(__pyx_k_9), 0, 1, 0, 0},
+  {&__pyx_kp_s_9, __pyx_k_9, sizeof(__pyx_k_9), 0, 0, 1, 0},
   {&__pyx_n_s__BACKFILL, __pyx_k__BACKFILL, sizeof(__pyx_k__BACKFILL), 0, 0, 1, 1},
   {&__pyx_n_s__Exception, __pyx_k__Exception, sizeof(__pyx_k__Exception), 0, 0, 1, 1},
+  {&__pyx_n_s__KeyError, __pyx_k__KeyError, sizeof(__pyx_k__KeyError), 0, 0, 1, 1},
   {&__pyx_n_s__N, __pyx_k__N, sizeof(__pyx_k__N), 0, 0, 1, 1},
+  {&__pyx_n_s__NIL, __pyx_k__NIL, sizeof(__pyx_k__NIL), 0, 0, 1, 1},
   {&__pyx_n_s__NaN, __pyx_k__NaN, sizeof(__pyx_k__NaN), 0, 0, 1, 1},
   {&__pyx_n_s__O, __pyx_k__O, sizeof(__pyx_k__O), 0, 0, 1, 1},
   {&__pyx_n_s__PAD, __pyx_k__PAD, sizeof(__pyx_k__PAD), 0, 0, 1, 1},
@@ -19528,15 +21939,19 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__descr, __pyx_k__descr, sizeof(__pyx_k__descr), 0, 0, 1, 1},
   {&__pyx_n_s__dtype, __pyx_k__dtype, sizeof(__pyx_k__dtype), 0, 0, 1, 1},
   {&__pyx_n_s__empty, __pyx_k__empty, sizeof(__pyx_k__empty), 0, 0, 1, 1},
+  {&__pyx_n_s__expected_size, __pyx_k__expected_size, sizeof(__pyx_k__expected_size), 0, 0, 1, 1},
   {&__pyx_n_s__fields, __pyx_k__fields, sizeof(__pyx_k__fields), 0, 0, 1, 1},
   {&__pyx_n_s__float64, __pyx_k__float64, sizeof(__pyx_k__float64), 0, 0, 1, 1},
   {&__pyx_n_s__format, __pyx_k__format, sizeof(__pyx_k__format), 0, 0, 1, 1},
   {&__pyx_n_s__func, __pyx_k__func, sizeof(__pyx_k__func), 0, 0, 1, 1},
+  {&__pyx_n_s__get, __pyx_k__get, sizeof(__pyx_k__get), 0, 0, 1, 1},
+  {&__pyx_n_s__head, __pyx_k__head, sizeof(__pyx_k__head), 0, 0, 1, 1},
   {&__pyx_n_s__idxMap, __pyx_k__idxMap, sizeof(__pyx_k__idxMap), 0, 0, 1, 1},
   {&__pyx_n_s__index, __pyx_k__index, sizeof(__pyx_k__index), 0, 0, 1, 1},
   {&__pyx_n_s__indexMap, __pyx_k__indexMap, sizeof(__pyx_k__indexMap), 0, 0, 1, 1},
   {&__pyx_n_s__inf, __pyx_k__inf, sizeof(__pyx_k__inf), 0, 0, 1, 1},
   {&__pyx_n_s__input, __pyx_k__input, sizeof(__pyx_k__input), 0, 0, 1, 1},
+  {&__pyx_n_s__insert, __pyx_k__insert, sizeof(__pyx_k__insert), 0, 0, 1, 1},
   {&__pyx_n_s__int32, __pyx_k__int32, sizeof(__pyx_k__int32), 0, 0, 1, 1},
   {&__pyx_n_s__int8, __pyx_k__int8, sizeof(__pyx_k__int8), 0, 0, 1, 1},
   {&__pyx_n_s__isfinite, __pyx_k__isfinite, sizeof(__pyx_k__isfinite), 0, 0, 1, 1},
@@ -19546,6 +21961,7 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__keyfunc, __pyx_k__keyfunc, sizeof(__pyx_k__keyfunc), 0, 0, 1, 1},
   {&__pyx_n_s__kind, __pyx_k__kind, sizeof(__pyx_k__kind), 0, 0, 1, 1},
   {&__pyx_n_s__max, __pyx_k__max, sizeof(__pyx_k__max), 0, 0, 1, 1},
+  {&__pyx_n_s__maxlevels, __pyx_k__maxlevels, sizeof(__pyx_k__maxlevels), 0, 0, 1, 1},
   {&__pyx_n_s__min, __pyx_k__min, sizeof(__pyx_k__min), 0, 0, 1, 1},
   {&__pyx_n_s__minp, __pyx_k__minp, sizeof(__pyx_k__minp), 0, 0, 1, 1},
   {&__pyx_n_s__name, __pyx_k__name, sizeof(__pyx_k__name), 0, 0, 1, 1},
@@ -19553,6 +21969,7 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__ndim, __pyx_k__ndim, sizeof(__pyx_k__ndim), 0, 0, 1, 1},
   {&__pyx_n_s__newIndex, __pyx_k__newIndex, sizeof(__pyx_k__newIndex), 0, 0, 1, 1},
   {&__pyx_n_s__newMap, __pyx_k__newMap, sizeof(__pyx_k__newMap), 0, 0, 1, 1},
+  {&__pyx_n_s__next, __pyx_k__next, sizeof(__pyx_k__next), 0, 0, 1, 1},
   {&__pyx_n_s__np, __pyx_k__np, sizeof(__pyx_k__np), 0, 0, 1, 1},
   {&__pyx_n_s__numpy, __pyx_k__numpy, sizeof(__pyx_k__numpy), 0, 0, 1, 1},
   {&__pyx_n_s__obj, __pyx_k__obj, sizeof(__pyx_k__obj), 0, 0, 1, 1},
@@ -19560,18 +21977,25 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__object_, __pyx_k__object_, sizeof(__pyx_k__object_), 0, 0, 1, 1},
   {&__pyx_n_s__oldIndex, __pyx_k__oldIndex, sizeof(__pyx_k__oldIndex), 0, 0, 1, 1},
   {&__pyx_n_s__oldMap, __pyx_k__oldMap, sizeof(__pyx_k__oldMap), 0, 0, 1, 1},
+  {&__pyx_n_s__ones, __pyx_k__ones, sizeof(__pyx_k__ones), 0, 0, 1, 1},
   {&__pyx_n_s__output, __pyx_k__output, sizeof(__pyx_k__output), 0, 0, 1, 1},
   {&__pyx_n_s__pydatetime, __pyx_k__pydatetime, sizeof(__pyx_k__pydatetime), 0, 0, 1, 1},
+  {&__pyx_n_s__random, __pyx_k__random, sizeof(__pyx_k__random), 0, 0, 1, 1},
   {&__pyx_n_s__range, __pyx_k__range, sizeof(__pyx_k__range), 0, 0, 1, 1},
   {&__pyx_n_s__readonly, __pyx_k__readonly, sizeof(__pyx_k__readonly), 0, 0, 1, 1},
+  {&__pyx_n_s__remove, __pyx_k__remove, sizeof(__pyx_k__remove), 0, 0, 1, 1},
   {&__pyx_n_s__rolling_var, __pyx_k__rolling_var, sizeof(__pyx_k__rolling_var), 0, 0, 1, 1},
   {&__pyx_n_s__shape, __pyx_k__shape, sizeof(__pyx_k__shape), 0, 0, 1, 1},
+  {&__pyx_n_s__size, __pyx_k__size, sizeof(__pyx_k__size), 0, 0, 1, 1},
   {&__pyx_n_s__sqrt, __pyx_k__sqrt, sizeof(__pyx_k__sqrt), 0, 0, 1, 1},
   {&__pyx_n_s__strides, __pyx_k__strides, sizeof(__pyx_k__strides), 0, 0, 1, 1},
   {&__pyx_n_s__suboffsets, __pyx_k__suboffsets, sizeof(__pyx_k__suboffsets), 0, 0, 1, 1},
   {&__pyx_n_s__type, __pyx_k__type, sizeof(__pyx_k__type), 0, 0, 1, 1},
   {&__pyx_n_s__type_num, __pyx_k__type_num, sizeof(__pyx_k__type_num), 0, 0, 1, 1},
+  {&__pyx_n_s__value, __pyx_k__value, sizeof(__pyx_k__value), 0, 0, 1, 1},
   {&__pyx_n_s__values, __pyx_k__values, sizeof(__pyx_k__values), 0, 0, 1, 1},
+  {&__pyx_n_s__width, __pyx_k__width, sizeof(__pyx_k__width), 0, 0, 1, 1},
+  {&__pyx_n_s__width_arr, __pyx_k__width_arr, sizeof(__pyx_k__width_arr), 0, 0, 1, 1},
   {&__pyx_n_s__win, __pyx_k__win, sizeof(__pyx_k__win), 0, 0, 1, 1},
   {&__pyx_n_s__window, __pyx_k__window, sizeof(__pyx_k__window), 0, 0, 1, 1},
   {&__pyx_n_s__zeros, __pyx_k__zeros, sizeof(__pyx_k__zeros), 0, 0, 1, 1},
@@ -19580,21 +22004,24 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
 static int __Pyx_InitCachedBuiltins(void) {
   __pyx_builtin_Exception = __Pyx_GetName(__pyx_b, __pyx_n_s__Exception); if (!__pyx_builtin_Exception) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_builtin_ValueError = __Pyx_GetName(__pyx_b, __pyx_n_s__ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_builtin_max = __Pyx_GetName(__pyx_b, __pyx_n_s__max); if (!__pyx_builtin_max) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_builtin_min = __Pyx_GetName(__pyx_b, __pyx_n_s__min); if (!__pyx_builtin_min) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_builtin_object = __Pyx_GetName(__pyx_b, __pyx_n_s__object); if (!__pyx_builtin_object) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_builtin_range = __Pyx_GetName(__pyx_b, __pyx_n_s__range); if (!__pyx_builtin_range) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_builtin_RuntimeError = __Pyx_GetName(__pyx_b, __pyx_n_s__RuntimeError); if (!__pyx_builtin_RuntimeError) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_range = __Pyx_GetName(__pyx_b, __pyx_n_s__range); if (!__pyx_builtin_range) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_min = __Pyx_GetName(__pyx_b, __pyx_n_s__min); if (!__pyx_builtin_min) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_KeyError = __Pyx_GetName(__pyx_b, __pyx_n_s__KeyError); if (!__pyx_builtin_KeyError) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_max = __Pyx_GetName(__pyx_b, __pyx_n_s__max); if (!__pyx_builtin_max) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_object = __Pyx_GetName(__pyx_b, __pyx_n_s__object); if (!__pyx_builtin_object) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_RuntimeError = __Pyx_GetName(__pyx_b, __pyx_n_s__RuntimeError); if (!__pyx_builtin_RuntimeError) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static int __Pyx_InitGlobals(void) {
-  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
-  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
-  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
-  __pyx_int_15 = PyInt_FromLong(15); if (unlikely(!__pyx_int_15)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  __pyx_int_15 = PyInt_FromLong(15); if (unlikely(!__pyx_int_15)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  __pyx_int_100 = PyInt_FromLong(100); if (unlikely(!__pyx_int_100)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
   return 0;
   __pyx_L1_error:;
   return -1;
@@ -19611,6 +22038,9 @@ PyMODINIT_FUNC PyInit_tseries(void)
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   double __pyx_t_3;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
   #if CYTHON_REFNANNY
   void* __pyx_refnanny = NULL;
   __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
@@ -19623,11 +22053,11 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __pyx_refnanny = __Pyx_RefNanny->SetupContext("PyMODINIT_FUNC PyInit_tseries(void)", __LINE__, __FILE__);
   #endif
   __pyx_init_filenames();
-  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   #if PY_MAJOR_VERSION < 3
-  __pyx_empty_bytes = PyString_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_empty_bytes = PyString_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   #else
-  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   #endif
   /*--- Library function declarations ---*/
   /*--- Threads initialization code ---*/
@@ -19642,34 +22072,40 @@ PyMODINIT_FUNC PyInit_tseries(void)
   #else
   __pyx_m = PyModule_Create(&__pyx_moduledef);
   #endif
-  if (!__pyx_m) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  if (!__pyx_m) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
   #if PY_MAJOR_VERSION < 3
   Py_INCREF(__pyx_m);
   #endif
   __pyx_b = PyImport_AddModule(__Pyx_NAMESTR(__Pyx_BUILTIN_MODULE_NAME));
-  if (!__pyx_b) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
-  if (__Pyx_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  if (!__pyx_b) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  if (__Pyx_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
   /*--- Initialize various global constants etc. ---*/
-  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (__pyx_module_is_main_tseries) {
-    if (__Pyx_SetAttrString(__pyx_m, "__name__", __pyx_n_s____main__) < 0) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+    if (__Pyx_SetAttrString(__pyx_m, "__name__", __pyx_n_s____main__) < 0) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
   }
   /*--- Builtin init code ---*/
-  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   /*--- Global init code ---*/
   /*--- Function export code ---*/
   /*--- Type init code ---*/
-  __pyx_ptype_7tseries_datetime = __Pyx_ImportType("datetime", "datetime", sizeof(PyDateTime_DateTime)); if (unlikely(!__pyx_ptype_7tseries_datetime)) {__pyx_filename = __pyx_f[8]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_7tseries_datetime = __Pyx_ImportType("datetime", "datetime", sizeof(PyDateTime_DateTime)); if (unlikely(!__pyx_ptype_7tseries_datetime)) {__pyx_filename = __pyx_f[9]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyType_Ready(&__pyx_type_7tseries_Node) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (__Pyx_SetAttrString(__pyx_m, "Node", (PyObject *)&__pyx_type_7tseries_Node) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_7tseries_Node = &__pyx_type_7tseries_Node;
+  if (PyType_Ready(&__pyx_type_7tseries_IndexableSkiplist) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (__Pyx_SetAttrString(__pyx_m, "IndexableSkiplist", (PyObject *)&__pyx_type_7tseries_IndexableSkiplist) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_7tseries_IndexableSkiplist = &__pyx_type_7tseries_IndexableSkiplist;
   /*--- Type import code ---*/
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType("numpy", "dtype", sizeof(PyArray_Descr)); if (unlikely(!__pyx_ptype_5numpy_dtype)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType("numpy", "flatiter", sizeof(PyArrayIterObject)); if (unlikely(!__pyx_ptype_5numpy_flatiter)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType("numpy", "broadcast", sizeof(PyArrayMultiIterObject)); if (unlikely(!__pyx_ptype_5numpy_broadcast)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType("numpy", "ndarray", sizeof(PyArrayObject)); if (unlikely(!__pyx_ptype_5numpy_ndarray)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType("numpy", "ufunc", sizeof(PyUFuncObject)); if (unlikely(!__pyx_ptype_5numpy_ufunc)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 848; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType("numpy", "dtype", sizeof(PyArray_Descr)); if (unlikely(!__pyx_ptype_5numpy_dtype)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType("numpy", "flatiter", sizeof(PyArrayIterObject)); if (unlikely(!__pyx_ptype_5numpy_flatiter)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType("numpy", "broadcast", sizeof(PyArrayMultiIterObject)); if (unlikely(!__pyx_ptype_5numpy_broadcast)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType("numpy", "ndarray", sizeof(PyArrayObject)); if (unlikely(!__pyx_ptype_5numpy_ndarray)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType("numpy", "ufunc", sizeof(PyUFuncObject)); if (unlikely(!__pyx_ptype_5numpy_ufunc)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 848; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   /*--- Function import code ---*/
   /*--- Execution code ---*/
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":12
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":12
  * from python_float cimport PyFloat_Check
  * 
  * import numpy as np             # <<<<<<<<<<<<<<
@@ -19681,7 +22117,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__np, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":13
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":13
  * 
  * import numpy as np
  * isnan = np.isnan             # <<<<<<<<<<<<<<
@@ -19696,7 +22132,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__isnan, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":14
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":14
  * import numpy as np
  * isnan = np.isnan
  * cdef double NaN = <double> np.NaN             # <<<<<<<<<<<<<<
@@ -19712,7 +22148,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_7tseries_NaN = ((double)__pyx_t_3);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":16
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":16
  * cdef double NaN = <double> np.NaN
  * 
  * from datetime import datetime as pydatetime             # <<<<<<<<<<<<<<
@@ -19733,7 +22169,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":88
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":88
  * 
  * # initialize numpy
  * import_array()             # <<<<<<<<<<<<<<
@@ -19741,22 +22177,22 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   import_array();
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":2
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":2
  * 
  * cdef double INF = <double> np.inf             # <<<<<<<<<<<<<<
  * cdef double NEGINF = -INF
  * 
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__inf); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__inf); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_7tseries_INF = ((double)__pyx_t_3);
 
-  /* "H:\pandas\pandas\lib\src\isnull.pyx":3
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":3
  * 
  * cdef double INF = <double> np.inf
  * cdef double NEGINF = -INF             # <<<<<<<<<<<<<<
@@ -19765,6 +22201,95 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   __pyx_v_7tseries_NEGINF = (-__pyx_v_7tseries_INF);
 
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":18
+ * cimport numpy as np
+ * from numpy cimport *
+ * import numpy as np             # <<<<<<<<<<<<<<
+ * 
+ * from random import random
+ */
+  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__numpy), 0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__np, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":20
+ * import numpy as np
+ * 
+ * from random import random             # <<<<<<<<<<<<<<
+ * 
+ * # initialize numpy
+ */
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
+  __Pyx_INCREF(((PyObject *)__pyx_n_s__random));
+  PyList_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__random));
+  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__random));
+  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s__random), ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__random); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__random, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":23
+ * 
+ * # initialize numpy
+ * import_array()             # <<<<<<<<<<<<<<
+ * 
+ * cdef class Node:
+ */
+  import_array();
+
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":44
+ * #         return self.width[i]
+ * 
+ * NIL = Node(np.inf, [], np.array([])) # Singleton terminator node             # <<<<<<<<<<<<<<
+ * 
+ * cdef class IndexableSkiplist:
+ */
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__inf); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__array); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_t_4));
+  __Pyx_GIVEREF(((PyObject *)__pyx_t_4));
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_6, 1, ((PyObject *)__pyx_t_2));
+  __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
+  PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_4);
+  __pyx_t_1 = 0;
+  __pyx_t_2 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_Node)), __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__NIL, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+
   /* "C:\Python25\lib\site-packages\Cython\Includes\python_dict.pxd":1
  * from python_ref cimport PyObject             # <<<<<<<<<<<<<<
  * 
@@ -19774,6 +22299,9 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
   if (__pyx_m) {
     __Pyx_AddTraceback("init tseries");
     Py_DECREF(__pyx_m); __pyx_m = 0;
@@ -19791,6 +22319,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
 
 static const char *__pyx_filenames[] = {
   "common.pyx",
+  "skiplist.pyx",
   "moments.pyx",
   "reindex.pyx",
   "isnull.pyx",
@@ -20474,6 +23003,7 @@ static INLINE void __Pyx_RaiseNoneNotIterableError(void) {
 }
 
 
+
 static INLINE long __Pyx_mod_long(long a, long b) {
     long r = a % b;
     r += ((r != 0) & ((r ^ b) < 0)) * b;
