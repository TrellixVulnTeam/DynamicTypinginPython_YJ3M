commit a9069f77c6a11cff0f34de3e11a1d24083761dc3
Author: Phillip Cloud <cpcloud@gmail.com>
Date:   Sat Feb 15 11:42:14 2014 -0500

    CLN: clarify code in com.mask_missing

diff --git a/pandas/core/common.py b/pandas/core/common.py
index e895c8ed0..d97ccda40 100644
--- a/pandas/core/common.py
+++ b/pandas/core/common.py
@@ -359,20 +359,18 @@ def mask_missing(arr, values_to_mask):
         if mask is None:
             mask = arr == x
 
-            # if x is a string and mask is not, then we get a scalar
-            # return value, which is not good
-            if not isinstance(mask, np.ndarray):
-                m = mask
-                mask = np.empty(arr.shape, dtype=np.bool)
-                mask.fill(m)
+            # if x is a string and arr is not, then we get False and we must
+            # expand the mask to size arr.shape
+            if np.isscalar(mask):
+                mask = np.zeros(arr.shape, dtype=bool)
         else:
-            mask = mask | (arr == x)
+            mask |= arr == x
 
     if na_mask.any():
         if mask is None:
             mask = isnull(arr)
         else:
-            mask = mask | isnull(arr)
+            mask |= isnull(arr)
 
     return mask
 
