commit 1a29c6f51afd0c879ef91b722b64ca8d5d6e073a
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed Jan 4 23:16:55 2012 -0500

    BUG: 32-bit compatibility

diff --git a/pandas/tools/merge.py b/pandas/tools/merge.py
index 37301586b..f6315f803 100644
--- a/pandas/tools/merge.py
+++ b/pandas/tools/merge.py
@@ -342,6 +342,13 @@ _join_functions = {
 def _factorize_int64(left_index, right_index, sort=True):
     rizer = lib.Int64Factorizer(max(len(left_index), len(right_index)))
 
+    # 32-bit compatibility
+    if left_index.dtype != np.int64:  # pragma: no cover
+        left_index = left_index.astype('i8')
+
+    if right_index.dtype != np.int64:  # pragma: no cover
+        right_index = right_index.astype('i8')
+
     llab, _ = rizer.factorize(left_index)
     rlab, _ = rizer.factorize(right_index)
 
