commit 5fba03bda35e906d73b74853da31e02c93a71798
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sat Sep 8 23:40:41 2012 -0400

    BUG: no unboundlocalerror in Panel.__setitem__ close #1826

diff --git a/RELEASE.rst b/RELEASE.rst
index ad3beb79e..eab72dd47 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -125,6 +125,7 @@ pandas 0.9.0
     truncate not changing size of panel (#1823)
   - Prevent segfault due to MultiIndex not being supported in HDFStore table
     format (#1848)
+  - Fix UnboundLocalError in Panel.__setitem__ and add better error (#1826)
 
 pandas 0.8.1
 ============
diff --git a/pandas/core/panel.py b/pandas/core/panel.py
index dda8cf113..c19f8d419 100644
--- a/pandas/core/panel.py
+++ b/pandas/core/panel.py
@@ -588,6 +588,8 @@ class Panel(NDFrame):
             dtype = _infer_dtype(value)
             mat = np.empty((N, K), dtype=dtype)
             mat.fill(value)
+        else:
+            raise TypeError('Cannot set item of type: %s' % str(type(value)))
 
         mat = mat.reshape((1, N, K))
         NDFrame._set_item(self, key, mat)
diff --git a/pandas/tests/test_panel.py b/pandas/tests/test_panel.py
index ead6ba842..5ffc7c982 100644
--- a/pandas/tests/test_panel.py
+++ b/pandas/tests/test_panel.py
@@ -408,6 +408,9 @@ class CheckIndexing(object):
         self.panel['ItemP'] = self.panel['ItemA'] > 0
         self.assert_(self.panel['ItemP'].values.dtype == np.bool_)
 
+        self.assertRaises(TypeError, self.panel.__setitem__, 'foo',
+                          self.panel.ix[['ItemP']])
+
     def test_setitem_ndarray(self):
         from pandas import date_range, datetools
 
