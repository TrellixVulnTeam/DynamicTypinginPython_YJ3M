commit a9a29b04722e850207c36f4821110e2542bd9d6a
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Jul 31 16:02:24 2011 -0400

    BUG: need to mask out aggregated levels

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index 5d45640a6..aec14504f 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -198,7 +198,7 @@ class GroupBy(object):
             for name, raveled in name_list:
                 factor = Factor.fromarray(raveled)
                 levels.append(factor.levels)
-                labels.append(factor.labels)
+                labels.append(factor.labels[mask])
 
             index = MultiIndex(levels=levels, labels=labels)
             return DataFrame(output, index=index)
