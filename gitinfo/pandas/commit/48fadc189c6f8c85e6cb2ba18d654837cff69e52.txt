commit 48fadc189c6f8c85e6cb2ba18d654837cff69e52
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sat Sep 29 17:33:35 2012 -0400

    BUG: work around NumPy unsafe object->int casting. close #1987

diff --git a/RELEASE.rst b/RELEASE.rst
index c9508c6a4..8e276e60c 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -241,6 +241,7 @@ pandas 0.9.0
   - Fix BlockManager.iget bug when dealing with non-unique MultiIndex as columns
     (#1970)
   - Fix reset_index bug if both drop and level are specified (#1957)
+  - Work around unsafe NumPy object->int casting with Cython function (#1987)
 
 
 pandas 0.8.1
diff --git a/pandas/core/common.py b/pandas/core/common.py
index e3c0efbf3..668017c29 100644
--- a/pandas/core/common.py
+++ b/pandas/core/common.py
@@ -786,7 +786,7 @@ _ensure_object = _algos.ensure_object
 
 
 def _astype_nansafe(arr, dtype):
-    if isinstance(dtype, basestring):
+    if not isinstance(dtype, np.dtype):
         dtype = np.dtype(dtype)
 
     if issubclass(arr.dtype.type, np.datetime64):
@@ -797,6 +797,9 @@ def _astype_nansafe(arr, dtype):
 
         if np.isnan(arr).any():
             raise ValueError('Cannot convert NA to integer')
+    elif arr.dtype == np.object_ and np.issubdtype(dtype.type, np.integer):
+        # work around NumPy brokenness, #1987
+        return lib.astype_intsafe(arr.ravel(), dtype).reshape(arr.shape)
 
     return arr.astype(dtype)
 
diff --git a/pandas/src/tseries.pyx b/pandas/src/tseries.pyx
index 2a4302f90..54641a78a 100644
--- a/pandas/src/tseries.pyx
+++ b/pandas/src/tseries.pyx
@@ -692,6 +692,17 @@ def value_count_int64(ndarray[int64_t] values):
 
     return result_keys, result_counts
 
+def astype_intsafe(ndarray[object] arr, new_dtype):
+    cdef:
+        Py_ssize_t i, n = len(arr)
+        ndarray result
+
+    result = np.empty(n, dtype=new_dtype)
+    for i in range(n):
+        util.set_value_at(result, i, arr[i])
+
+    return result
+
 include "hashtable.pyx"
 include "datetime.pyx"
 include "skiplist.pyx"
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index 9474f6061..3a28401fb 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -2341,6 +2341,17 @@ class TestSeries(unittest.TestCase, CheckNameIntegration):
         df = Series([1.0, 2.0, 3.0, np.nan])
         self.assertRaises(ValueError, df.astype, np.int64)
 
+    def test_astype_cast_object_int(self):
+        arr = Series(["car", "house", "tree","1"])
+
+        self.assertRaises(ValueError, arr.astype, int)
+        self.assertRaises(ValueError, arr.astype, np.int64)
+        self.assertRaises(ValueError, arr.astype, np.int8)
+
+        arr = Series(['1', '2', '3', '4'], dtype=object)
+        result = arr.astype(int)
+        self.assert_(np.array_equal(result, np.arange(1, 5)))
+
     def test_map(self):
         index, data = tm.getMixedTypeDict()
 
