commit d1008e8ced06d7ec703e68bbe2b9129e2c068882
Author: Chang She <changshe@gmail.com>
Date:   Fri Nov 2 10:37:28 2012 -0400

    BUG: setitem with Timestamp #2155

diff --git a/pandas/tseries/index.py b/pandas/tseries/index.py
index e596bab49..6b688b162 100644
--- a/pandas/tseries/index.py
+++ b/pandas/tseries/index.py
@@ -1255,7 +1255,7 @@ class DatetimeIndex(Int64Index):
         -------
         new_index : Index
         """
-        if type(item) == datetime:
+        if isinstance(item, datetime):
             item = _to_m8(item)
 
         new_index = np.concatenate((self[:loc].asi8,
diff --git a/pandas/tseries/tests/test_timeseries.py b/pandas/tseries/tests/test_timeseries.py
index 7a206d92b..c0b5c4c03 100644
--- a/pandas/tseries/tests/test_timeseries.py
+++ b/pandas/tseries/tests/test_timeseries.py
@@ -320,6 +320,16 @@ class TestTimeSeries(unittest.TestCase):
         expected.values[:3] = np.nan
         tm.assert_frame_equal(result, expected)
 
+    def test_frame_setitem_timestamp(self):
+        #2155
+        columns = DatetimeIndex(start='1/1/2012', end='2/1/2012',
+                                freq=datetools.bday)
+        index = range(10)
+        data = DataFrame(columns=columns, index=index)
+        t = datetime(2012, 11, 1)
+        ts = Timestamp(t)
+        data[ts] = np.nan #works
+
     def test_sparse_series_fillna_limit(self):
         index = np.arange(10)
         s = Series(np.random.randn(10), index=index)
