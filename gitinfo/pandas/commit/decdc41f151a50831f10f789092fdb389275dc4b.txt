commit decdc41f151a50831f10f789092fdb389275dc4b
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Tue May 31 13:37:34 2011 +0100

    code coverage, corner case when modifying sparse fill_value

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 46241069f..6295a7b13 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -794,21 +794,11 @@ class DataFrame(PandasGeneric):
     def _output_columns(self):
         return list(self.columns)
 
-    def head(self, buf=sys.stdout):
-        chunk = self[:5]
-        if len(self.cols()) > 6:
-            print 'Probably too wide to display, transposing'
-            chunk = chunk.T
-
-        chunk.toString(buf=buf)
+    def head(self):
+        return self[:5]
 
     def tail(self, buf=sys.stdout):
-        chunk = self[-5:]
-        if len(self.cols()) > 6:
-            print 'Probably too wide to display, transposing'
-            chunk = chunk.T
-
-        chunk.toString(buf=buf)
+        return self[-5:]
 
     def info(self, verbose=True, buf=sys.stdout):
         """
diff --git a/pandas/core/tests/test_frame.py b/pandas/core/tests/test_frame.py
index d42549499..c6df9c7cb 100644
--- a/pandas/core/tests/test_frame.py
+++ b/pandas/core/tests/test_frame.py
@@ -356,15 +356,15 @@ class TestDataFrame(unittest.TestCase):
         # columns are not sortable
         foo = repr(self.unsortable)
 
-        # do not fail!
-        self.frame.head(buf=buf)
-        self.frame.tail(buf=buf)
+    def test_head_tail(self):
+        assert_frame_equal(self.frame.head(), self.frame[:5])
+        assert_frame_equal(self.frame.tail(), self.frame[-5:])
 
-        for i in range(5):
-            self.frame['foo%d' % i] = 1
+        # for i in range(5):
+        #     self.frame['foo%d' % i] = 1
 
-        self.frame.head(buf=buf)
-        self.frame.tail(buf=buf)
+        # self.frame.head(buf=buf)
+        # self.frame.tail(buf=buf)
 
     def test_repr_corner(self):
         # representing infs poses no problems
diff --git a/pandas/core/tests/test_sparse.py b/pandas/core/tests/test_sparse.py
index ba79abfe9..8fa4126cf 100644
--- a/pandas/core/tests/test_sparse.py
+++ b/pandas/core/tests/test_sparse.py
@@ -535,6 +535,18 @@ class TestSparseSeries(TestCase):
                                    fill_value=0)}
         nose.tools.assert_raises(Exception, spm.homogenize, data)
 
+    def test_fill_value_corner(self):
+        cop = self.zbseries.copy()
+        cop.fill_value = 0
+        result = self.bseries / cop
+
+        self.assert_(np.isnan(result.fill_value))
+
+        cop2 = self.zbseries.copy()
+        cop2.fill_value = 1
+        result = cop2 / cop
+        self.assert_(np.isnan(result.fill_value))
+
 class TestSparseTimeSeries(TestCase):
     pass
 
