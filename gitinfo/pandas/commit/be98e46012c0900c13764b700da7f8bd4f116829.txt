commit be98e46012c0900c13764b700da7f8bd4f116829
Author: Chang She <changshe@gmail.com>
Date:   Thu Aug 23 17:41:24 2012 -0400

    ENH: primary key for sqlite schema

diff --git a/pandas/io/sql.py b/pandas/io/sql.py
index 47eef0c1a..4601063c7 100644
--- a/pandas/io/sql.py
+++ b/pandas/io/sql.py
@@ -169,10 +169,10 @@ def write_frame(frame, name=None, con=None, flavor='sqlite'):
     data = [tuple(x) for x in frame.values]
     con.executemany(insert_sql, data)
 
-def get_sqlite_schema(frame, name, dtypes=None):
+def get_sqlite_schema(frame, name, dtypes=None, keys=None):
     template = """
 CREATE TABLE %(name)s (
-  %(columns)s
+  %(columns)s%(keystr)s
 );"""
 
     column_types = []
@@ -195,7 +195,12 @@ CREATE TABLE %(name)s (
 
     columns = ',\n  '.join('%s %s' % x for x in column_types)
 
-    return template % {'name' : name, 'columns' : columns}
+    keystr = ''
+    if keys is not None:
+        if isinstance(keys, basestring):
+            keys = (keys,)
+        keystr = ', PRIMARY KEY (%s)' % ','.join(keys)
+    return template % {'name' : name, 'columns' : columns, 'keystr' : keystr}
 
 
 
diff --git a/pandas/io/tests/test_sql.py b/pandas/io/tests/test_sql.py
index d45ddb335..0e6c16b3e 100644
--- a/pandas/io/tests/test_sql.py
+++ b/pandas/io/tests/test_sql.py
@@ -60,6 +60,12 @@ class TestSQLite(unittest.TestCase):
             if len(tokens) == 2 and tokens[0] == 'A':
                 self.assert_(tokens[1] == 'DATETIME')
 
+        frame = tm.makeTimeDataFrame()
+        create_sql = sql.get_sqlite_schema(frame, 'test', keys=['A', 'B'])
+        lines = create_sql.splitlines()
+        self.assert_('PRIMARY KEY (A,B)' in create_sql)
+        self.db.execute(create_sql)
+
     def test_execute_fail(self):
         create_sql = """
         CREATE TABLE test
