commit 48474e03c6bf7b108dcf2788ec0f53fb2c9a2b69
Author: jreback <jeff@reback.net>
Date:   Sun Apr 19 18:13:03 2015 -0400

    dtype fix for GH9804 on win32

diff --git a/pandas/core/generic.py b/pandas/core/generic.py
index 9624b1308..f3d7c48c7 100644
--- a/pandas/core/generic.py
+++ b/pandas/core/generic.py
@@ -3341,10 +3341,18 @@ class NDFrame(PandasObject):
 
                 matches = (new_other == np.array(other))
                 if matches is False or not matches.all():
-                    other = np.array(other)
+                    
+                    # coerce other to a common dtype if we can
+                    if com.needs_i8_conversion(self.dtype):
+                        try:
+                            other = np.array(other, dtype=self.dtype)
+                        except:
+                            other = np.array(other)
+                    else:
+                        other = np.asarray(other)
+                        other = np.asarray(other, dtype=np.common_type(other, new_other))
 
-                    # we can't use our existing dtype
-                    # because of incompatibilities
+                    # we need to use the new dtype
                     try_quick = False
                 else:
                     other = new_other
