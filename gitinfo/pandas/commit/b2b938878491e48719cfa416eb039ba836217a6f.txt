commit b2b938878491e48719cfa416eb039ba836217a6f
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Tue Jun 5 12:37:57 2012 -0400

    BUG: fix broken UTC localization, add tz_localize method to Timestamp, close #1397

diff --git a/pandas/src/datetime.pyx b/pandas/src/datetime.pyx
index 90b13750b..199192de9 100644
--- a/pandas/src/datetime.pyx
+++ b/pandas/src/datetime.pyx
@@ -165,6 +165,24 @@ class Timestamp(_Timestamp):
     def asm8(self):
         return np.int64(self.value).view('M8[ns]')
 
+    def tz_localize(self, tz):
+        """
+        Convert naive Timestamp to local time zone
+
+        Parameters
+        ----------
+        tz : pytz.timezone
+
+        Returns
+        -------
+        localized : Timestamp
+        """
+        if self.tzinfo is None:
+            # tz naive, localize
+            return Timestamp(self.to_pydatetime(), tz=tz)
+        else:
+            raise Exception('Cannot localize tz-aware Timestamp')
+
     def tz_convert(self, tz):
         """
         Convert Timestamp to another time zone or localize to requested time
@@ -445,12 +463,15 @@ cpdef convert_to_tsobject(object ts, object tz=None):
             # sort of a temporary hack
             if ts.tzinfo is not None:
                 ts = tz.normalize(ts)
+                obj.value = _pydatetime_to_dts(ts, &obj.dts)
             elif tz is not pytz.utc:
                 ts = tz.localize(ts)
-
-            obj.value = _pydatetime_to_dts(ts, &obj.dts)
+                obj.value = _pydatetime_to_dts(ts, &obj.dts)
+                obj.value -= _delta_to_nanoseconds(ts.tzinfo._utcoffset)
+            else:
+                # UTC
+                obj.value = _pydatetime_to_dts(ts, &obj.dts)
             obj.tzinfo = ts.tzinfo
-            obj.value -= _delta_to_nanoseconds(obj.tzinfo._utcoffset)
         else:
             obj.value = _pydatetime_to_dts(ts, &obj.dts)
             obj.tzinfo = ts.tzinfo
diff --git a/pandas/tseries/tests/test_timeseries.py b/pandas/tseries/tests/test_timeseries.py
index ff1e34ea4..e41728272 100644
--- a/pandas/tseries/tests/test_timeseries.py
+++ b/pandas/tseries/tests/test_timeseries.py
@@ -1507,6 +1507,9 @@ class TestTimestamp(unittest.TestCase):
 
         self.assertEquals(stamp, rng[1])
 
+        utc_stamp = Timestamp('3/11/2012 05:00', tz='utc')
+        self.assertEquals(utc_stamp.hour, 5)
+
     def test_tz_convert_localize(self):
         stamp = Timestamp('3/11/2012 04:00')
 
