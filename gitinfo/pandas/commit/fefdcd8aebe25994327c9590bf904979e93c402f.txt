commit fefdcd8aebe25994327c9590bf904979e93c402f
Author: jreback <jeff@reback.net>
Date:   Mon Mar 25 07:37:48 2013 -0400

    BUG: GH3163 fixed to_csv with a boundry condition issue at the chunksize break

diff --git a/pandas/core/index.py b/pandas/core/index.py
index 0d6557754..0c6e490f3 100644
--- a/pandas/core/index.py
+++ b/pandas/core/index.py
@@ -470,12 +470,11 @@ class Index(np.ndarray):
         values = self
         if slicer is not None:
             values = values[slicer]
-        mask = isnull(values)
-        values = np.array(values,dtype=object)
-
         if self.is_all_dates:
-            return _date_formatter(self)
+            return _date_formatter(values)
         else:
+            mask = isnull(values)
+            values = np.array(values,dtype=object)
             values[mask] = na_rep
 
         return values.tolist()
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 313e4a967..881bc4c26 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -4697,6 +4697,22 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
                  lines = f.readlines()
                  self.assert_(lines[1].split(',')[2] == '999')
 
+    @slow
+    def test_to_csv_boundry_conditions(self):
+        from pandas.util.testing import makeTimeDataFrame
+
+        with ensure_clean() as path:
+
+            df = makeTimeDataFrame(25000)
+            df.to_csv(path)
+            rs = pan.read_csv(path, index_col=0, parse_dates=True)
+            assert_frame_equal(rs, df)
+
+            df = makeTimeDataFrame(25001)
+            df.to_csv(path) 
+            rs = pan.read_csv(path, index_col=0, parse_dates=True)
+            assert_frame_equal(rs, df)
+
     def test_to_csv_withcommas(self):
 
         # Commas inside fields should be correctly escaped when saving as CSV.
