commit 37fce3c6e61e596f3ee49e98d75c9d1051fa0dc7
Author: jreback <jeff@reback.net>
Date:   Thu Jun 13 19:06:39 2013 -0400

    TST: skip tests if xlrd has lower than needed version

diff --git a/pandas/io/tests/test_excel.py b/pandas/io/tests/test_excel.py
index 39e1042d1..baa4f6b64 100644
--- a/pandas/io/tests/test_excel.py
+++ b/pandas/io/tests/test_excel.py
@@ -808,11 +808,7 @@ class ExcelTests(unittest.TestCase):
     #         self.assertTrue(ws.cell(maddr).merged)
     #     os.remove(filename)
     def test_excel_010_hemstring(self):
-        try:
-            import xlwt
-            import openpyxl
-        except ImportError:
-            raise nose.SkipTest
+        _skip_if_no_excelsuite()
 
         from pandas.util.testing import makeCustomDataframe as mkdf
         # ensure limited functionality in 0.10
diff --git a/pandas/tests/test_panel.py b/pandas/tests/test_panel.py
index 380604b0d..4e57977a7 100644
--- a/pandas/tests/test_panel.py
+++ b/pandas/tests/test_panel.py
@@ -1381,7 +1381,11 @@ class TestPanel(unittest.TestCase, PanelTests, CheckIndexing,
             path = '__tmp__.' + ext
             with ensure_clean(path) as path:
                 self.panel.to_excel(path)
-                reader = ExcelFile(path)
+                try:
+                    reader = ExcelFile(path)
+                except ImportError:
+                    raise nose.SkipTest
+                
                 for item, df in self.panel.iterkv():
                     recdf = reader.parse(str(item), index_col=0)
                     assert_frame_equal(df, recdf)
