commit bf0c90466aea97217e60d53a4fa24b6e0fe0caa0
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Dec 9 14:55:01 2012 -0500

    TST: python 3 fixes

diff --git a/pandas/io/tests/test_excel.py b/pandas/io/tests/test_excel.py
index d00eccf67..78ab97185 100644
--- a/pandas/io/tests/test_excel.py
+++ b/pandas/io/tests/test_excel.py
@@ -490,6 +490,8 @@ class ExcelTests(unittest.TestCase):
         os.remove(path)
 
     def test_excel_roundtrip_indexname(self):
+        _skip_if_no_excelsuite()
+
         path = '%s.xls' % tm.rands(10)
 
         df = DataFrame(np.random.randn(10, 4))
diff --git a/pandas/src/parser.pyx b/pandas/src/parser.pyx
index 7f822081f..d84ab8024 100644
--- a/pandas/src/parser.pyx
+++ b/pandas/src/parser.pyx
@@ -1017,11 +1017,18 @@ def _ensure_encoded(list lst):
         if PyUnicode_Check(x):
             x = PyUnicode_AsUTF8String(x)
         elif not PyBytes_Check(x):
-            x = bytes(x)
+            x = asbytes(x)
 
         result.append(x)
     return result
 
+cdef asbytes(object o):
+    if PY3:
+        return str(o).encode('utf-8')
+    else:
+        return str(o)
+
+
 def _is_file_like(obj):
     if PY3:
         import io
