commit 1237f2041d7bbcf70122f6ca86144971da2fcc34
Author: Niklas Weber <nalderan@gmail.com>
Date:   Wed Jun 24 17:59:23 2020 +0200

    TST:add test for df replace GH34871 (#34904)

diff --git a/pandas/tests/frame/methods/test_replace.py b/pandas/tests/frame/methods/test_replace.py
index 3b9a724d7..498f7f779 100644
--- a/pandas/tests/frame/methods/test_replace.py
+++ b/pandas/tests/frame/methods/test_replace.py
@@ -1407,3 +1407,16 @@ class TestDataFrameReplace:
         result["B"] = result["B"].replace(7, replacement)
 
         tm.assert_frame_equal(result, expected)
+
+    @pytest.mark.xfail(
+        reason="replace() changes dtype from period to object, see GH34871", strict=True
+    )
+    def test_replace_period_ignore_float(self):
+        """
+        Regression test for GH#34871: if df.replace(1.0, 0.0) is called on a df
+        with a Period column the old, faulty behavior is to raise TypeError.
+        """
+        df = pd.DataFrame({"Per": [pd.Period("2020-01")] * 3})
+        result = df.replace(1.0, 0.0)
+        expected = pd.DataFrame({"Per": [pd.Period("2020-01")] * 3})
+        tm.assert_frame_equal(expected, result)
