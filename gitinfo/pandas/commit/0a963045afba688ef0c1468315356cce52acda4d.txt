commit 0a963045afba688ef0c1468315356cce52acda4d
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Thu Jun 28 18:40:18 2012 -0400

    BUG: fix incorrect bin labels from cut when labels=False and NA present. close #1511

diff --git a/pandas/tools/tests/test_tile.py b/pandas/tools/tests/test_tile.py
index d11759870..8dad25996 100644
--- a/pandas/tools/tests/test_tile.py
+++ b/pandas/tools/tests/test_tile.py
@@ -60,6 +60,12 @@ class TestCut(unittest.TestCase):
 
         self.assertRaises(ValueError, cut, [1, 2, 3], 0.5)
 
+    def test_cut_out_of_range_more(self):
+        # #1511
+        s = Series([0, -1, 0, 1, -3])
+        ind = cut(s, [0, 1], labels=False)
+        exp = [np.nan, np.nan, np.nan, 0, np.nan]
+        assert_almost_equal(ind, exp)
 
     def test_labels(self):
         arr = np.tile(np.arange(0, 1.01, 0.1), 4)
diff --git a/pandas/tools/tile.py b/pandas/tools/tile.py
index d4c9b2736..dc756e8ce 100644
--- a/pandas/tools/tile.py
+++ b/pandas/tools/tile.py
@@ -180,7 +180,7 @@ def _bins_to_cuts(x, bins, right=True, labels=None, retbins=False,
     else:
         fac = ids - 1
         if has_nas:
-            fac = ids.astype(np.float64)
+            fac = fac.astype(np.float64)
             np.putmask(fac, na_mask, np.nan)
 
     if not retbins:
