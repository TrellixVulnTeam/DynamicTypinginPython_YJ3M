commit b4343efa33c9456694bcfd6dee7bf5941288966b
Author: jbrockmendel <jbrockmendel@gmail.com>
Date:   Thu Dec 19 21:39:04 2019 -0800

    CI: troubleshoot codecov (#30070)

diff --git a/ci/run_tests.sh b/ci/run_tests.sh
index b91cfb3be..4c5dbabc8 100755
--- a/ci/run_tests.sh
+++ b/ci/run_tests.sh
@@ -37,7 +37,8 @@ echo $PYTEST_CMD
 sh -c "$PYTEST_CMD"
 
 if [[ "$COVERAGE" && $? == 0 && "$TRAVIS_BRANCH" == "master" ]]; then
+    SHA=`git rev-parse HEAD`
     echo "uploading coverage"
-    echo "bash <(curl -s https://codecov.io/bash) -Z -c -F $TYPE -f $COVERAGE_FNAME"
-          bash <(curl -s https://codecov.io/bash) -Z -c -F $TYPE -f $COVERAGE_FNAME
+    echo "bash <(curl -s https://codecov.io/bash) -Z -c -F $TYPE -f $COVERAGE_FNAME -C $SHA"
+          bash <(curl -s https://codecov.io/bash) -Z -c -F $TYPE -f $COVERAGE_FNAME -C `git rev-parse HEAD`
 fi
