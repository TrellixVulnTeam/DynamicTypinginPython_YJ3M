commit c2305d756541dfbbf213db3fc689a1a7f8d2bc7b
Author: ganevgv <ganevgv@users.noreply.github.com>
Date:   Fri Nov 8 04:17:27 2019 +0000

    TST: add test for empty frame groupby dtypes consistency (#29455)
    
    Closes https://github.com/pandas-dev/pandas/issues/20888

diff --git a/pandas/tests/test_multilevel.py b/pandas/tests/test_multilevel.py
index a1f58922e..3b1940441 100644
--- a/pandas/tests/test_multilevel.py
+++ b/pandas/tests/test_multilevel.py
@@ -1533,6 +1533,20 @@ Thur,Lunch,Yes,51.51,17"""
         DataFrame({"foo": s1, "bar": s2, "baz": s3})
         DataFrame.from_dict({"foo": s1, "baz": s3, "bar": s2})
 
+    @pytest.mark.parametrize("d", [4, "d"])
+    def test_empty_frame_groupby_dtypes_consistency(self, d):
+        # GH 20888
+        group_keys = ["a", "b", "c"]
+        df = DataFrame({"a": [1], "b": [2], "c": [3], "d": [d]})
+
+        g = df[df.a == 2].groupby(group_keys)
+        result = g.first().index
+        expected = MultiIndex(
+            levels=[[1], [2], [3]], codes=[[], [], []], names=["a", "b", "c"]
+        )
+
+        tm.assert_index_equal(result, expected)
+
     def test_multiindex_na_repr(self):
         # only an issue with long columns
         df3 = DataFrame(
