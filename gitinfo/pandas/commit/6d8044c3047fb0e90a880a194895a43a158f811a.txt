commit 6d8044c3047fb0e90a880a194895a43a158f811a
Author: znmean <znmean@gmail.com>
Date:   Fri Aug 19 05:50:14 2016 +0900

    DOC: fixed using IP.prompt_manager which is removed from IPython 5.x (#14004)
    
    * fixed using IP.prompt_manager which is removed from IPython 5.x
    
    class promptManager has removed in IPython 5.x, but this file
    still using that class, so it makes AttributeError.

diff --git a/doc/sphinxext/ipython_sphinxext/ipython_directive.py b/doc/sphinxext/ipython_sphinxext/ipython_directive.py
index ad7ada8e4..b8b0935cd 100644
--- a/doc/sphinxext/ipython_sphinxext/ipython_directive.py
+++ b/doc/sphinxext/ipython_sphinxext/ipython_directive.py
@@ -802,10 +802,14 @@ class IPythonDirective(Directive):
         # reset the execution count if we haven't processed this doc
         #NOTE: this may be borked if there are multiple seen_doc tmp files
         #check time stamp?
-        if not self.state.document.current_source in self.seen_docs:
+        if self.state.document.current_source not in self.seen_docs:
             self.shell.IP.history_manager.reset()
             self.shell.IP.execution_count = 1
-            self.shell.IP.prompt_manager.width = 0
+            try:
+                self.shell.IP.prompt_manager.width = 0
+            except AttributeError:
+                # GH14003: class promptManager has removed after IPython 5.x
+                pass
             self.seen_docs.add(self.state.document.current_source)
 
         # and attach to shell so we don't have to pass them around
