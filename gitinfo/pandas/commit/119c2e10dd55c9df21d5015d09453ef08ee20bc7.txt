commit 119c2e10dd55c9df21d5015d09453ef08ee20bc7
Author: Stephen Lin <stephenwlin@gmail.com>
Date:   Fri Feb 8 22:19:32 2013 -0500

    TST: add vb_suite test for reindex with upcasting

diff --git a/vb_suite/frame_methods.py b/vb_suite/frame_methods.py
index ce341b2de..2bd69d79a 100644
--- a/vb_suite/frame_methods.py
+++ b/vb_suite/frame_methods.py
@@ -54,6 +54,19 @@ frame_reindex_both_axes = Benchmark('df.reindex(index=idx, columns=idx)',
 frame_reindex_both_axes_ix = Benchmark('df.ix[idx, idx]', setup,
                                        start_date=datetime(2011, 1, 1))
 
+#----------------------------------------------------------------------
+# reindex with upcasts
+setup = common_setup + """
+df=DataFrame(dict([(c, {
+        0: randint(0, 2, 1000).astype(np.bool_),
+        1: randint(0, 1000, 1000).astype(np.int16),
+        2: randint(0, 1000, 1000).astype(np.int32),
+        3: randint(0, 1000, 1000).astype(np.int64)
+    }[randint(0, 4)]) for c in range(1000)]))
+"""
+
+frame_reindex_upcast = Benchmark('df.reindex(permutation(range(1200)))', setup)
+
 #----------------------------------------------------------------------
 # boolean indexing
 
@@ -71,6 +84,7 @@ frame_boolean_row_select = Benchmark('df[bool_arr]', setup,
 
 setup = common_setup + """
 df = DataFrame(randn(10000, 100))
+
 def f():
     if hasattr(df, '_item_cache'):
         df._item_cache.clear()
diff --git a/vb_suite/pandas_vb_common.py b/vb_suite/pandas_vb_common.py
index 58cd67227..77d0e2e27 100644
--- a/vb_suite/pandas_vb_common.py
+++ b/vb_suite/pandas_vb_common.py
@@ -2,6 +2,8 @@ from pandas import *
 from pandas.util.testing import rands
 from datetime import timedelta
 from numpy.random import randn
+from numpy.random import randint
+from numpy.random import permutation
 import pandas.util.testing as tm
 import random
 import numpy as np
