commit 42ce17237923c1c90eee9c13bb73598b6836803b
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Nov 6 22:05:21 2011 -0500

    TST: unit tests for NAs in duplicated

diff --git a/pandas/tests/test_tseries.py b/pandas/tests/test_tseries.py
index 0675a60d8..17678b597 100644
--- a/pandas/tests/test_tseries.py
+++ b/pandas/tests/test_tseries.py
@@ -147,6 +147,30 @@ def test_groupsort_indexer():
     expected = np.lexsort((b, a))
     assert(np.array_equal(result, expected))
 
+
+def test_duplicated_with_nas():
+    keys = [0, 1, np.nan, 0, 2, np.nan]
+
+    result = lib.duplicated(keys)
+    expected = [False, False, False, True, False, True]
+    assert(np.array_equal(result, expected))
+
+    result = lib.duplicated(keys, take_last=True)
+    expected = [True, False, True, False, False, False]
+    assert(np.array_equal(result, expected))
+
+    keys = [(0, 0), (0, np.nan), (np.nan, 0), (np.nan, np.nan)] * 2
+
+    result = lib.duplicated(keys)
+    falses = [False] * 4
+    trues = [True] * 4
+    expected = falses + trues
+    assert(np.array_equal(result, expected))
+
+    result = lib.duplicated(keys, take_last=True)
+    expected = trues + falses
+    assert(np.array_equal(result, expected))
+
 class TestMoments(unittest.TestCase):
     pass
 
