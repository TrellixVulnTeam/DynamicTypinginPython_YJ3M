commit 3a8b0f83a52e1ad87b7ccd19d50365fdb7f5e603
Author: Chang She <changshe@gmail.com>
Date:   Fri Nov 2 11:40:25 2012 -0400

    BUG: get_indexer for MultiIndex does not raise Exception for non-unique #2101

diff --git a/pandas/core/index.py b/pandas/core/index.py
index 6629024e4..5c85d4853 100644
--- a/pandas/core/index.py
+++ b/pandas/core/index.py
@@ -1894,6 +1894,10 @@ class MultiIndex(Index):
         if target_index.dtype != object:
             return np.ones(len(target_index)) * -1
 
+        if not self.is_unique:
+            raise Exception('Reindexing only valid with uniquely valued Index '
+                            'objects')
+
         self_index = self._tuple_index
 
         if method == 'pad':
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index c989e8c98..214847e42 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -4339,6 +4339,21 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         del df[('a','','')]
         assert(isinstance(df.columns, MultiIndex))
 
+    def test_drop_nonuq_multiindex(self):
+        df = DataFrame([["x-a", "x", "a", 1.5],["x-a", "x", "a", 1.2],
+                        ["z-c", "z", "c", 3.1], ["x-a", "x", "a", 4.1],
+                        ["x-b", "x", "b", 5.1],["x-b", "x", "b", 4.1],
+                        ["x-b", "x", "b", 2.2],
+                        ["y-a", "y", "a", 1.2],["z-b", "z", "b", 2.1]],
+                       columns=["var1", "var2", "var3", "var4"])
+
+        grp_size = df.groupby("var1").size()
+        drop_idx = grp_size.ix[grp_size == 1]
+
+        df = df.set_index(["var1", "var2", "var3"])
+
+        self.assertRaises(Exception, df.drop, drop_idx.index, level=0)
+
     def test_fillna(self):
         self.tsframe['A'][:5] = nan
         self.tsframe['A'][-5:] = nan
