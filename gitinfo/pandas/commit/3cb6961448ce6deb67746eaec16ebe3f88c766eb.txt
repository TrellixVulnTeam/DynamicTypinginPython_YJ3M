commit 3cb6961448ce6deb67746eaec16ebe3f88c766eb
Author: y-p <yoval@gmx.com>
Date:   Fri Feb 22 07:42:56 2013 +0200

    BUG: get_dtype_counts() works too hard to count column dtypes, GH2807

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 1a6adefba..486924eca 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -1676,7 +1676,11 @@ class DataFrame(NDFrame):
 
     def get_dtype_counts(self):
         """ return the counts of dtypes in this frame """
-        return Series(dict([ (dtype, len(df.columns)) for dtype, df in self.blocks.iteritems() ]))
+        self._consolidate_inplace()
+        counts = dict()
+        for b in self._data.blocks:
+            counts[b.dtype.name] = counts.get(b.dtype,0) + b.shape[0]
+        return Series(counts)
 
     #----------------------------------------------------------------------
     # properties for index and columns
