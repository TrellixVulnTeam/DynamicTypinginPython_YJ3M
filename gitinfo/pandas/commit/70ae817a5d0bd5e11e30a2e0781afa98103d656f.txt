commit 70ae817a5d0bd5e11e30a2e0781afa98103d656f
Author: Tom Augspurger <TomAugspurger@users.noreply.github.com>
Date:   Fri Apr 21 16:59:22 2017 -0500

    REF: Refactor pandas.util.testing to not use pytest at top-level (#16088)
    
    Closes https://github.com/pandas-dev/pandas/pull/16088

diff --git a/pandas/tests/io/parser/test_network.py b/pandas/tests/io/parser/test_network.py
index 4d6b6c7da..3845ca2d8 100644
--- a/pandas/tests/io/parser/test_network.py
+++ b/pandas/tests/io/parser/test_network.py
@@ -22,7 +22,8 @@ def salaries_table():
 @pytest.mark.parametrize(
     "compression,extension",
     [('gzip', '.gz'), ('bz2', '.bz2'), ('zip', '.zip'),
-     tm._mark_skipif_no_lzma(('xz', '.xz'))])
+     pytest.mark.skipif(not tm._check_if_lzma(),
+                        reason='need backports.lzma to run')(('xz', '.xz'))])
 @pytest.mark.parametrize('mode', ['explicit', 'infer'])
 @pytest.mark.parametrize('engine', ['python', 'c'])
 def test_compressed_urls(salaries_table, compression, extension, mode, engine):
diff --git a/pandas/util/testing.py b/pandas/util/testing.py
index c54def2b4..d2fb18be1 100644
--- a/pandas/util/testing.py
+++ b/pandas/util/testing.py
@@ -19,7 +19,6 @@ from contextlib import contextmanager
 from distutils.version import LooseVersion
 
 from numpy.random import randn, rand
-import pytest
 import numpy as np
 
 import pandas as pd
@@ -52,7 +51,13 @@ from pandas import (bdate_range, CategoricalIndex, Categorical, IntervalIndex,
 
 from pandas.util import libtesting
 from pandas.io.common import urlopen
-slow = pytest.mark.slow
+try:
+    import pytest
+    slow = pytest.mark.slow
+except ImportError:
+    # Should be ok to just ignore. If you actually need
+    # slow then you'll hit an import error long before getting here.
+    pass
 
 
 N = 30
@@ -347,15 +352,10 @@ def _check_if_lzma():
 
 
 def _skip_if_no_lzma():
+    import pytest
     return _check_if_lzma() or pytest.skip('need backports.lzma to run')
 
 
-_mark_skipif_no_lzma = pytest.mark.skipif(
-    not _check_if_lzma(),
-    reason='need backports.lzma to run'
-)
-
-
 def _skip_if_no_xarray():
     try:
         import xarray
