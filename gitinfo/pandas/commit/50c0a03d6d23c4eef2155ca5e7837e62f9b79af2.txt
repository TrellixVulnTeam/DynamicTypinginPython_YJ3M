commit 50c0a03d6d23c4eef2155ca5e7837e62f9b79af2
Author: Tobias Brandt <Tobias.Brandt@gmail.com>
Date:   Mon Sep 23 11:34:16 2013 +0200

    TST: Added tests for pairwise behaviour in rolling moments.
    
    Added a test for rolling_cov_pairwise similar to the test for
    rolling_corr_pairwise.
    
    Added tests for ewmcov_pairwise and ewmcorr_pairwise.
    
    Added test for expanding_cov_pairwise based on the test for
    expanding_corr_pairwise.

diff --git a/pandas/stats/tests/test_moments.py b/pandas/stats/tests/test_moments.py
index a8359c102..af77152fd 100644
--- a/pandas/stats/tests/test_moments.py
+++ b/pandas/stats/tests/test_moments.py
@@ -586,6 +586,10 @@ class TestMoments(tm.TestCase):
         result = mom.rolling_cov(A, B, 50, min_periods=25)
         assert_almost_equal(result[-1], np.cov(A[-50:], B[-50:])[0, 1])
 
+    def test_rolling_cov_pairwise(self):
+        self._check_pairwise_moment(mom.rolling_cov_pairwise,
+                                    mom.rolling_cov, 10, min_periods=5)
+
     def test_rolling_corr(self):
         A = self.series
         B = A + randn(len(A))
@@ -603,12 +607,15 @@ class TestMoments(tm.TestCase):
         assert_almost_equal(result[-1], a.corr(b))
 
     def test_rolling_corr_pairwise(self):
-        panel = mom.rolling_corr_pairwise(self.frame, 10, min_periods=5)
+        self._check_pairwise_moment(mom.rolling_corr_pairwise,
+                                    mom.rolling_corr, 10, min_periods=5)
+
+    def _check_pairwise_moment(self, func_pairwise, func, *args, **kwargs):
+        panel = func_pairwise(self.frame, self.frame, *args, **kwargs)
 
-        correl = panel.ix[:, 1, 5]
-        exp = mom.rolling_corr(self.frame[1], self.frame[5],
-                               10, min_periods=5)
-        tm.assert_series_equal(correl, exp)
+        actual = panel.ix[:, 1, 5]
+        expected = func(self.frame[1], self.frame[5], *args, **kwargs)
+        tm.assert_series_equal(actual, expected)
 
     def test_flex_binary_moment(self):
         # GH3155
@@ -666,9 +673,17 @@ class TestMoments(tm.TestCase):
     def test_ewmcov(self):
         self._check_binary_ew(mom.ewmcov)
 
+    def test_ewmcov_pairwise(self):
+        self._check_pairwise_moment(mom.ewmcov_pairwise, mom.ewmcov, 10,
+                                    min_periods=5)
+
     def test_ewmcorr(self):
         self._check_binary_ew(mom.ewmcorr)
 
+    def test_ewmcorr_pairwise(self):
+        self._check_pairwise_moment(mom.ewmcorr_pairwise, mom.ewmcorr, 10,
+                                    min_periods=5)
+
     def _check_binary_ew(self, func):
         A = Series(randn(50), index=np.arange(50))
         B = A[2:] + randn(48)
@@ -746,6 +761,16 @@ class TestMoments(tm.TestCase):
     def test_expanding_max(self):
         self._check_expanding(mom.expanding_max, np.max, preserve_nan=False)
 
+    def test_expanding_cov_pairwise(self):
+        result = mom.expanding_cov_pairwise(self.frame)
+
+        rolling_result = mom.rolling_cov_pairwise(self.frame,
+                                                   len(self.frame),
+                                                   min_periods=1)
+
+        for i in result.items:
+            assert_almost_equal(result[i], rolling_result[i])
+
     def test_expanding_corr_pairwise(self):
         result = mom.expanding_corr_pairwise(self.frame)
 
