commit ea4c617d0616d740eb5df2c56e86d6e01a2f7f72
Author: Jeff Reback <jeff@reback.net>
Date:   Sun Jun 7 16:39:23 2015 -0400

    CI: move build_docs.sh to separate section

diff --git a/.travis.yml b/.travis.yml
index 0d143d7f7..246154310 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -180,6 +180,7 @@ before_script:
 
 script:
   - echo "script"
+  - ci/run_build_docs.sh &
   - ci/script.sh
 # nothing here, or failed tests won't fail travis
 
diff --git a/ci/build_docs.sh b/ci/build_docs.sh
index da7a038ec..a8488e202 100755
--- a/ci/build_docs.sh
+++ b/ci/build_docs.sh
@@ -1,7 +1,7 @@
 #!/bin/bash
 
-
 cd "$TRAVIS_BUILD_DIR"
+echo "inside $0"
 
 git show --pretty="format:" --name-only HEAD~5.. --first-parent | grep -P "rst|txt|doc"
 
@@ -16,7 +16,9 @@ if [ x"$DOC_BUILD" != x"" ]; then
 
     # we're running network tests, let's build the docs in the meantime
     echo "Will build docs"
-    pip install sphinx==1.1.3 ipython
+    conda install -n pandas sphinx=1.1.3 pygments ipython=2.4 --yes
+
+    source activate pandas
 
     mv "$TRAVIS_BUILD_DIR"/doc /tmp
     cd /tmp/doc
@@ -24,10 +26,10 @@ if [ x"$DOC_BUILD" != x"" ]; then
     rm /tmp/doc/source/api.rst # no R
     rm /tmp/doc/source/r_interface.rst # no R
 
-    echo ############################### > /tmp/doc.log
-    echo # Log file for the doc build  # > /tmp/doc.log
-    echo ############################### > /tmp/doc.log
-    echo "" > /tmp/doc.log
+    echo ###############################
+    echo # Log file for the doc build  #
+    echo ###############################
+
     echo -e "y\n" | ./make.py --no-api 2>&1
 
     cd /tmp/doc/build/html
diff --git a/ci/run_build_docs.sh b/ci/run_build_docs.sh
new file mode 100755
index 000000000..c04c81529
--- /dev/null
+++ b/ci/run_build_docs.sh
@@ -0,0 +1,10 @@
+#!/bin/bash
+
+echo "inside $0"
+
+"$TRAVIS_BUILD_DIR"/ci/build_docs.sh 2>&1 > /tmp/doc.log &
+
+# wait until subprocesses finish (build_docs.sh)
+wait
+
+exit 0
diff --git a/ci/script.sh b/ci/script.sh
index fe9db792d..d50822340 100755
--- a/ci/script.sh
+++ b/ci/script.sh
@@ -12,10 +12,6 @@ if [ -n "$LOCALE_OVERRIDE" ]; then
     python -c "$pycmd"
 fi
 
-# conditionally build and upload docs to GH/pandas-docs/pandas-docs/travis
-"$TRAVIS_BUILD_DIR"/ci/build_docs.sh 2>&1 > /tmp/doc.log &
-# doc build log will be shown after tests
-
 if [ "$BUILD_TEST" ]; then
     echo "We are not running nosetests as this is simply a build test."
 else
@@ -25,7 +21,4 @@ fi
 
 RET="$?"
 
-# wait until subprocesses finish (build_docs.sh)
-wait
-
 exit "$RET"
diff --git a/doc/source/enhancingperf.rst b/doc/source/enhancingperf.rst
index 54fd0a213..517c91c93 100644
--- a/doc/source/enhancingperf.rst
+++ b/doc/source/enhancingperf.rst
@@ -98,7 +98,7 @@ First we're going to need to import the cython magic function to ipython:
 
 .. ipython:: python
 
-   %load_ext Cython
+   %load_ext cythonmagic
 
 
 Now, let's simply copy our functions over to cython as is (the suffix
