commit a71c1216f4b89884f6bcb631b84873240a38e3df
Author: Marc Garcia <garcia.marc@gmail.com>
Date:   Mon Dec 24 18:25:07 2018 +0000

    Making azure run all the checks even if the patterns step fail, adding tailing whitespace info (#24410)

diff --git a/azure-pipelines.yml b/azure-pipelines.yml
index 1e4e43ac0..f0567d766 100644
--- a/azure-pipelines.yml
+++ b/azure-pipelines.yml
@@ -43,6 +43,7 @@ jobs:
       ci/incremental/install_miniconda.sh
       ci/incremental/setup_conda_environment.sh
     displayName: 'Set up environment'
+    condition: true
 
   # Do not require pandas
   - script: |
diff --git a/ci/code_checks.sh b/ci/code_checks.sh
index b594f6a2f..da1b035cf 100755
--- a/ci/code_checks.sh
+++ b/ci/code_checks.sh
@@ -158,7 +158,12 @@ if [[ -z "$CHECK" || "$CHECK" == "patterns" ]]; then
     # RET=$(($RET + $?)) ; echo $MSG "DONE"
 
     MSG='Check that no file in the repo contains tailing whitespaces' ; echo $MSG
-    invgrep --exclude="*.svg" -RI "\s$" *
+    set -o pipefail
+    if [[ "$AZURE" == "true" ]]; then
+        ! grep -n --exclude="*.svg" -RI "\s$" * | awk -F ":" '{print "##vso[task.logissue type=error;sourcepath=" $1 ";linenumber=" $2 ";] Tailing whitespaces found: " $3}'
+    else
+        ! grep -n --exclude="*.svg" -RI "\s$" * | awk -F ":" '{print $1 ":" $2 ":Tailing whitespaces found: " $3}'
+    fi
     RET=$(($RET + $?)) ; echo $MSG "DONE"
 fi
 
