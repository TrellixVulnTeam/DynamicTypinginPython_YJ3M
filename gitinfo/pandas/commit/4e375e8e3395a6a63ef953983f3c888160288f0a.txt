commit 4e375e8e3395a6a63ef953983f3c888160288f0a
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Aug 30 20:37:56 2010 +0000

    formatting issues and copy issues
    
    git-svn-id: http://pandas.googlecode.com/svn/trunk@200 d5231056-7de3-11de-ac95-d976489f1ece

diff --git a/pandas/core/common.py b/pandas/core/common.py
index 1472849f8..1e1dd28a4 100644
--- a/pandas/core/common.py
+++ b/pandas/core/common.py
@@ -60,6 +60,10 @@ def _unpickle_array(bytes):
     arr = read_array(StringIO(bytes))
     return arr
 
+def _to_str(x):
+    # str(x) fails when x contains unicode
+    return '%s' % x
+
 def _pfixed(s, space, nanRep=None, float_format=None):
     if isinstance(s, float):
         if nanRep is not None and isnull(s):
@@ -75,7 +79,7 @@ def _pfixed(s, space, nanRep=None, float_format=None):
 
         return formatted.ljust(space)
     else:
-        return str(s)[:space-4].ljust(space)
+        return _to_str(s)[:space].ljust(space)
 
 
 
diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index af6392cd1..bd5b0b988 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -681,6 +681,9 @@ class DataFrame(Picklable, Groupable):
         fillMethod : {'backfill', 'pad', None}
                     Method to use for filling holes in new inde
         """
+        if len(self.index) == 0:
+            return self.copy()
+
         if isinstance(freq, datetools.DateOffset):
             dateRange = DateRange(self.index[0], self.index[-1], offset=freq)
         else:
diff --git a/pandas/stats/ols.py b/pandas/stats/ols.py
index e48916be1..555482937 100644
--- a/pandas/stats/ols.py
+++ b/pandas/stats/ols.py
@@ -1139,7 +1139,7 @@ def _combine_rhs(rhs):
     if isinstance(rhs, Series):
         series['x'] = rhs
     elif isinstance(rhs, DataFrame):
-        series = rhs
+        series = rhs.copy()
     elif isinstance(rhs, dict):
         for name, value in rhs.iteritems():
             if isinstance(value, Series):
