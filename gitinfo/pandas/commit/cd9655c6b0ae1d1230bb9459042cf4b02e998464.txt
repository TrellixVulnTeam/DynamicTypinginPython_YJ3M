commit cd9655c6b0ae1d1230bb9459042cf4b02e998464
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Fri Sep 7 22:34:43 2012 -0400

    BUG: Fix error when window size > array size in rolling_apply. close #1850

diff --git a/RELEASE.rst b/RELEASE.rst
index 9135c710f..827a69c7e 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -103,6 +103,8 @@ pandas 0.8.2
   - Let Series.str.split accept no arguments (like str.split) (#1859)
   - Allow user to have dateutil 2.1 installed on a Python 2 system (#1851)
   - Catch ImportError less aggressively in pandas/__init__.py (#1845)
+  - Fix pip source installation bug when installing from GitHub (#1805)
+  - Fix error when window size > array size in rolling_apply (#1850)  - Fix pip source installation issues via SSH from GitHub
 
 pandas 0.8.1
 ============
diff --git a/pandas/src/moments.pyx b/pandas/src/moments.pyx
index 8aa8d83cc..5ec264b6a 100644
--- a/pandas/src/moments.pyx
+++ b/pandas/src/moments.pyx
@@ -900,7 +900,7 @@ def roll_generic(ndarray[float64_t, cast=True] input, int win,
     oldbuf = <float64_t*> bufarr.data
 
     n = len(input)
-    for i from 0 <= i < win:
+    for i from 0 <= i < int_min(win, n):
         if counts[i] >= minp:
             output[i] = func(input[int_max(i - win + 1, 0) : i + 1])
         else:
diff --git a/pandas/stats/tests/test_moments.py b/pandas/stats/tests/test_moments.py
index c4f623c34..b72bb7f72 100644
--- a/pandas/stats/tests/test_moments.py
+++ b/pandas/stats/tests/test_moments.py
@@ -83,6 +83,17 @@ class TestMoments(unittest.TestCase):
                                          freq=freq)
         self._check_moment_func(roll_mean, np.mean)
 
+    def test_rolling_apply_out_of_bounds(self):
+        # #1850
+        arr = np.arange(4)
+
+        # it works!
+        result = mom.rolling_apply(arr, 10, np.sum)
+        self.assert_(isnull(result).all())
+
+        result = mom.rolling_apply(arr, 10, np.sum, min_periods=1)
+        assert_almost_equal(result, result)
+
     def test_rolling_std(self):
         self._check_moment_func(mom.rolling_std,
                                 lambda x: np.std(x, ddof=1))
