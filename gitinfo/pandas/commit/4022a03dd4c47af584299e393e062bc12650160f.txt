commit 4022a03dd4c47af584299e393e062bc12650160f
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Jan 20 16:37:22 2013 -0500

    BUG: fix groupby segfault on MultiIndex issue #2706

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index 32b4f46a1..86275550f 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -1081,6 +1081,9 @@ class Grouping(object):
         if isinstance(grouper, (Series, Index)) and name is None:
             self.name = grouper.name
 
+        if isinstance(grouper, MultiIndex):
+            self.grouper = grouper.values
+
         # pre-computed
         self._was_factor = False
         self._should_compress = True
diff --git a/pandas/tests/test_groupby.py b/pandas/tests/test_groupby.py
index 1e588e28d..114697bc5 100644
--- a/pandas/tests/test_groupby.py
+++ b/pandas/tests/test_groupby.py
@@ -2186,7 +2186,6 @@ class TestGroupBy(unittest.TestCase):
         got_dt = result.dtype
         self.assert_(issubclass(got_dt.type, np.datetime64))
 
-
 def assert_fp_equal(a, b):
     assert((np.abs(a - b) < 1e-12).all())
 
diff --git a/pandas/tests/test_multilevel.py b/pandas/tests/test_multilevel.py
index a6b75b523..c1c579c49 100644
--- a/pandas/tests/test_multilevel.py
+++ b/pandas/tests/test_multilevel.py
@@ -1745,6 +1745,16 @@ Thur,Lunch,Yes,51.51,17"""
         self.assertTrue(isnull(index[4][0]))
         self.assertTrue(isnull(index.values[4][0]))
 
+    def test_duplicate_groupby_issues(self):
+        idx_tp = [('600809', '20061231'), ('600809', '20070331'),
+                  ('600809', '20070630'), ('600809', '20070331')]
+        dt = ['demo','demo','demo','demo']
+
+        idx = MultiIndex.from_tuples(idx_tp,names = ['STK_ID','RPT_Date'])
+        s = Series(dt, index=idx)
+
+        result = s.groupby(s.index).first()
+        self.assertEquals(len(result), 3)
 
 if __name__ == '__main__':
 
