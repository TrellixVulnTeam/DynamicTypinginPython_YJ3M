commit 9266a389324f0ea6fea91bfaffadb5e945d82fd2
Author: jreback <jeff@reback.net>
Date:   Sat Feb 1 19:42:15 2014 -0500

    BUG: make sure to use platform int for GH6212

diff --git a/pandas/core/algorithms.py b/pandas/core/algorithms.py
index d82846bd8..b5be5b1a7 100644
--- a/pandas/core/algorithms.py
+++ b/pandas/core/algorithms.py
@@ -156,7 +156,7 @@ def factorize(values, sort=False, order=None, na_sentinel=-1):
                 np.sort(np.array([ e for i, e in enumerate(uniques) if f(e) ],dtype=object)) for f in [ lambda x: not isinstance(x,string_types),
                                                                                                         lambda x: isinstance(x,string_types) ]
                 ])
-            sorter = t.lookup(com._ensure_object(ordered))
+            sorter = com._ensure_platform_int(t.lookup(com._ensure_object(ordered)))
 
         reverse_indexer = np.empty(len(sorter), dtype=np.int_)
         reverse_indexer.put(sorter, np.arange(len(sorter)))
