commit c1f0c63191e318981b5a244a3f240090df63f1d0
Author: Yaroslav Halchenko <debian@onerussian.com>
Date:   Mon Feb 19 10:38:41 2018 -0500

    ENH: fake http proxy in case of --skip-network testing (#19757)

diff --git a/ci/script_multi.sh b/ci/script_multi.sh
index 6c354fc4c..45c61ee31 100755
--- a/ci/script_multi.sh
+++ b/ci/script_multi.sh
@@ -12,6 +12,11 @@ if [ -n "$LOCALE_OVERRIDE" ]; then
     python -c "$pycmd"
 fi
 
+# Enforce absent network during testing by faking a proxy
+if echo "$TEST_ARGS" | grep -e --skip-network -q; then
+    export http_proxy=http://1.2.3.4 https_proxy=http://1.2.3.4;
+fi
+
 # Workaround for pytest-xdist flaky collection order
 # https://github.com/pytest-dev/pytest/issues/920
 # https://github.com/pytest-dev/pytest/issues/1075
diff --git a/ci/script_single.sh b/ci/script_single.sh
index 74b0e897f..021a5a771 100755
--- a/ci/script_single.sh
+++ b/ci/script_single.sh
@@ -16,6 +16,11 @@ if [ "$SLOW" ]; then
     TEST_ARGS="--only-slow --skip-network"
 fi
 
+# Enforce absent network during testing by faking a proxy
+if echo "$TEST_ARGS" | grep -e --skip-network -q; then
+    export http_proxy=http://1.2.3.4 https_proxy=http://1.2.3.4;
+fi
+
 if [ "$PIP_BUILD_TEST" ]; then
     echo "We are not running pytest as this is a build test."
 
diff --git a/pandas/tests/test_downstream.py b/pandas/tests/test_downstream.py
index b438d6a61..a595d9f18 100644
--- a/pandas/tests/test_downstream.py
+++ b/pandas/tests/test_downstream.py
@@ -53,6 +53,7 @@ def test_xarray(df):
     assert df.to_xarray() is not None
 
 
+@tm.network
 def test_statsmodels():
 
     statsmodels = import_module('statsmodels')  # noqa
@@ -73,6 +74,7 @@ def test_scikit_learn(df):
     clf.predict(digits.data[-1:])
 
 
+@tm.network
 def test_seaborn():
 
     seaborn = import_module('seaborn')
