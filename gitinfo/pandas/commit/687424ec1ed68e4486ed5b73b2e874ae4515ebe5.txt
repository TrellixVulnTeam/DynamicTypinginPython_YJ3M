commit 687424ec1ed68e4486ed5b73b2e874ae4515ebe5
Author: Chang She <changshe@gmail.com>
Date:   Tue Nov 13 23:51:47 2012 -0500

    BUG: ExcelWriter raises exception on PeriodIndex #2240

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index d91be2d1f..5f1de83c4 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -1180,8 +1180,12 @@ class DataFrame(NDFrame):
                 encoded_cols = list(cols)
                 writer.writerow(encoded_cols)
 
-        nlevels = getattr(self.index, 'nlevels', 1)
-        for j, idx in enumerate(self.index):
+        data_index = self.index
+        if isinstance(self.index, PeriodIndex):
+            data_index = self.index.to_timestamp()
+
+        nlevels = getattr(data_index, 'nlevels', 1)
+        for j, idx in enumerate(data_index):
             row_fields = []
             if index:
                 if nlevels == 1:
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 7787a5c6e..a7120f3ea 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -3842,6 +3842,24 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         assert_frame_equal(frame, recons)
         os.remove(path)
 
+    def test_to_excel_periodindex(self):
+        try:
+            import xlwt
+            import xlrd
+            import openpyxl
+        except ImportError:
+            raise nose.SkipTest
+
+        for ext in ['xls', 'xlsx']:
+            path = '__tmp__.' + ext
+            frame = self.tsframe
+            xp = frame.resample('M', kind='period')
+            xp.to_excel(path, 'sht1')
+
+            reader = ExcelFile(path)
+            rs = reader.parse('sht1', index_col=0, parse_dates=True)
+            assert_frame_equal(xp, rs.to_period('M'))
+            os.remove(path)
 
     def test_to_excel_multiindex(self):
         try:
