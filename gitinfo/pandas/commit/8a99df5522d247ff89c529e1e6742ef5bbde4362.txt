commit 8a99df5522d247ff89c529e1e6742ef5bbde4362
Author: Adam Klein <adamklein@gmail.com>
Date:   Fri Feb 17 19:39:26 2012 -0500

    BUG: fixed sorted set diff of DatetimeIndex

diff --git a/pandas/core/index.py b/pandas/core/index.py
index 62e131728..5b6976c11 100644
--- a/pandas/core/index.py
+++ b/pandas/core/index.py
@@ -498,8 +498,10 @@ class Index(np.ndarray):
         if self.equals(other):
             return Index([])
 
-        otherArr = np.asarray(other)
-        theDiff = sorted(set(self) - set(otherArr))
+        if not isinstance(other, Index):
+            other = np.asarray(other)
+
+        theDiff = sorted(set(self) - set(other))
         return Index(theDiff)
 
     def get_loc(self, key):
diff --git a/pandas/tests/test_datetime64.py b/pandas/tests/test_datetime64.py
index 73b472b04..17fc88e9d 100644
--- a/pandas/tests/test_datetime64.py
+++ b/pandas/tests/test_datetime64.py
@@ -204,6 +204,12 @@ class TestDatetime64(unittest.TestCase):
     def test_datetimeindex_creation(self):
         dti = DatetimeIndex(freq='Q@JAN', start=datetime(1997,12,31), n=100)
         self.assert_(dti[0] == datetime(1997,12,31))
+        self.assert_(len(dti) == 100)
+
+    def test_datetimeindex_diff(self):
+        dti1 = DatetimeIndex(freq='Q@JAN', start=datetime(1997,12,31), n=100)
+        dti2 = DatetimeIndex(freq='Q@JAN', start=datetime(1997,12,31), n=98)
+        self.assert_( len(dti1.diff(dti2)) == 2)
 
     def test_datetimeindex_shift(self):
         dti = DatetimeIndex(freq='W@TUE', start=datetime(2005,1,4), n=100)
