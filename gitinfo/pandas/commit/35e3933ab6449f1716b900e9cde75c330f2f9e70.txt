commit 35e3933ab6449f1716b900e9cde75c330f2f9e70
Author: sinhrks <sinhrks@gmail.com>
Date:   Sat Apr 30 10:25:11 2016 -0400

    TST/BUG: Categorical dtypes cause error when attempting stacked bar plot
    
    closes #13019
    
    Author: sinhrks <sinhrks@gmail.com>
    
    Closes #13038 from sinhrks/plot_bar_categorical and squashes the following commits:
    
    dc57a6c [sinhrks] TST/BUG: Categorical dtypes cause error when attempting stacked bar plot

diff --git a/pandas/tests/test_graphics.py b/pandas/tests/test_graphics.py
index 6af789e80..604cd89da 100644
--- a/pandas/tests/test_graphics.py
+++ b/pandas/tests/test_graphics.py
@@ -2100,6 +2100,32 @@ class TestDataFramePlots(TestPlotBase):
         expected = [0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 15.0, 10.0, 40.0]
         self.assertEqual(result, expected)
 
+    @slow
+    def test_bar_categorical(self):
+        # GH 13019
+        df1 = pd.DataFrame(np.random.randn(6, 5),
+                           index=pd.Index(list('ABCDEF')),
+                           columns=pd.Index(list('abcde')))
+        # categorical index must behave the same
+        df2 = pd.DataFrame(np.random.randn(6, 5),
+                           index=pd.CategoricalIndex(list('ABCDEF')),
+                           columns=pd.CategoricalIndex(list('abcde')))
+
+        for df in [df1, df2]:
+            ax = df.plot.bar()
+            ticks = ax.xaxis.get_ticklocs()
+            tm.assert_numpy_array_equal(ticks, np.array([0, 1, 2, 3, 4, 5]))
+            self.assertEqual(ax.get_xlim(), (-0.5, 5.5))
+            # check left-edge of bars
+            self.assertEqual(ax.patches[0].get_x(), -0.25)
+            self.assertEqual(ax.patches[-1].get_x(), 5.15)
+
+            ax = df.plot.bar(stacked=True)
+            tm.assert_numpy_array_equal(ticks, np.array([0, 1, 2, 3, 4, 5]))
+            self.assertEqual(ax.get_xlim(), (-0.5, 5.5))
+            self.assertEqual(ax.patches[0].get_x(), -0.25)
+            self.assertEqual(ax.patches[-1].get_x(), 4.75)
+
     @slow
     def test_plot_scatter(self):
         df = DataFrame(randn(6, 4),
