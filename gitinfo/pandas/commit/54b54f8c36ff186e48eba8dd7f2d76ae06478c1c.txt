commit 54b54f8c36ff186e48eba8dd7f2d76ae06478c1c
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Sep 10 21:11:55 2012 -0400

    BUG: fix downsampling bug with intraday data when end.time() < start.time(). close #1772

diff --git a/RELEASE.rst b/RELEASE.rst
index 51d19a6d6..e67aeea86 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -143,6 +143,10 @@ pandas 0.9.0
   - Fixes to Period.start_time for non-daily frequencies (#1857)
   - Fix failure when converter used on index_col in read_csv (#1835)
   - Implement PeriodIndex.append so that pandas.concat works correctly (#1815)
+  - Avoid Cython out-of-bounds access causing segfault sometimes in pad_2d,
+    backfill_2d
+  - Fix resampling error with intraday times and anchored target time (like
+    AS-DEC) (#1772)
 
 pandas 0.8.1
 ============
diff --git a/pandas/tseries/resample.py b/pandas/tseries/resample.py
index 1b2394f6f..be5098ded 100644
--- a/pandas/tseries/resample.py
+++ b/pandas/tseries/resample.py
@@ -7,6 +7,7 @@ from pandas.tseries.frequencies import to_offset, is_subperiod, is_superperiod
 from pandas.tseries.index import DatetimeIndex, date_range
 from pandas.tseries.offsets import DateOffset, Tick, _delta_to_nanoseconds
 from pandas.tseries.period import PeriodIndex, period_range
+import pandas.tseries.tools as tools
 import pandas.core.common as com
 
 from pandas.lib import Timestamp
@@ -276,12 +277,18 @@ def _get_range_edges(axis, offset, closed='left', base=0):
             return _adjust_dates_anchored(axis[0], axis[-1], offset,
                                           closed=closed, base=base)
 
+    first, last = axis[0], axis[-1]
+    if not isinstance(offset, Tick):# and first.time() != last.time():
+        # hack!
+        first = tools.normalize_date(first)
+        last = tools.normalize_date(last)
+
     if closed == 'left':
-        first = Timestamp(offset.rollback(axis[0]))
+        first = Timestamp(offset.rollback(first))
     else:
-        first = Timestamp(axis[0] - offset)
+        first = Timestamp(first - offset)
 
-    last = Timestamp(axis[-1] + offset)
+    last = Timestamp(last + offset)
 
     return first, last
 
diff --git a/pandas/tseries/tests/test_resample.py b/pandas/tseries/tests/test_resample.py
index 79fb293b2..9fa8683a1 100644
--- a/pandas/tseries/tests/test_resample.py
+++ b/pandas/tseries/tests/test_resample.py
@@ -559,6 +559,18 @@ class TestResample(unittest.TestCase):
         tm.assert_series_equal(result['foo'], foo_exp)
         tm.assert_series_equal(result['bar'], bar_exp)
 
+    def test_resample_unequal_times(self):
+        # #1772
+        start = datetime(1999, 3, 1, 5)
+        # end hour is less than start
+        end = datetime(2012, 7, 31, 4)
+        bad_ind = date_range(start, end, freq="30min")
+        df = DataFrame({'close':1}, index=bad_ind)
+
+        # it works!
+        df.resample('AS', 'sum')
+
+
 def _simple_ts(start, end, freq='D'):
     rng = date_range(start, end, freq=freq)
     return Series(np.random.randn(len(rng)), index=rng)
