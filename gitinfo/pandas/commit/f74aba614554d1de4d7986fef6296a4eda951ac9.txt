commit f74aba614554d1de4d7986fef6296a4eda951ac9
Author: Joris Van den Bossche <jorisvandenbossche@gmail.com>
Date:   Mon Feb 18 15:37:54 2019 +0100

    DOC/BLD: fix --no-api option (#25209)

diff --git a/doc/source/conf.py b/doc/source/conf.py
index 776b1bfa7..c59d28a6d 100644
--- a/doc/source/conf.py
+++ b/doc/source/conf.py
@@ -98,9 +98,9 @@ if pattern:
                 if (fname == 'index.rst'
                         and os.path.abspath(dirname) == source_path):
                     continue
-                elif pattern == '-api' and dirname == 'api':
+                elif pattern == '-api' and dirname == 'reference':
                     exclude_patterns.append(fname)
-                elif fname != pattern:
+                elif pattern != '-api' and fname != pattern:
                     exclude_patterns.append(fname)
 
 with open(os.path.join(source_path, 'index.rst.template')) as f:
