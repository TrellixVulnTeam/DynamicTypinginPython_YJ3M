commit 002ab434d6c9a6b6878da227814851ef0bc81301
Author: Kaiqi Dong <kaiqidong1991@gmail.com>
Date:   Sun Nov 25 10:52:10 2018 +0800

    CI: Fixes to conda environment names (#23866)

diff --git a/.circleci/config.yml b/.circleci/config.yml
index 6e789d0aa..dc4162a06 100644
--- a/.circleci/config.yml
+++ b/.circleci/config.yml
@@ -26,7 +26,13 @@ jobs:
           name: build
           command: |
             ./ci/circle/install_circle.sh
-            ./ci/circle/show_circle.sh
+            export PATH="$MINICONDA_DIR/bin:$PATH"
+            source activate pandas-dev
+            python -c "import pandas; pandas.show_versions();"
       - run:
           name: test
-          command: ./ci/circle/run_circle.sh  --skip-slow --skip-network
+          command: |
+            export PATH="$MINICONDA_DIR/bin:$PATH"
+            source activate pandas-dev
+            echo "pytest --strict --durations=10 --color=no --junitxml=$CIRCLE_TEST_REPORTS/reports/junit.xml --skip-slow --skip-network pandas"
+            pytest       --strict --durations=10 --color=no --junitxml=$CIRCLE_TEST_REPORTS/reports/junit.xml --skip-slow --skip-network pandas
diff --git a/.travis.yml b/.travis.yml
index 6d31adcbf..3217fc5aa 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -105,6 +105,7 @@ before_script:
 
 script:
   - echo "script start"
+  - source activate pandas-dev
   - ci/run_build_docs.sh
   - ci/script_single.sh
   - ci/script_multi.sh
@@ -115,7 +116,7 @@ after_success:
 
 after_script:
   - echo "after_script start"
-  - source activate pandas && pushd /tmp && python -c "import pandas; pandas.show_versions();" && popd
+  - source activate pandas-dev && pushd /tmp && python -c "import pandas; pandas.show_versions();" && popd
   - if [ -e test-data-single.xml ]; then
     ci/print_skipped.py test-data-single.xml;
     fi
diff --git a/ci/azure/linux.yml b/ci/azure/linux.yml
index 23800f671..a773a06c1 100644
--- a/ci/azure/linux.yml
+++ b/ci/azure/linux.yml
@@ -12,20 +12,17 @@ jobs:
       py27_np_19:
         ENV_FILE: ci/deps/azure-27-compat.yaml
         CONDA_PY: "27"
-        CONDA_ENV: pandas
         TEST_ARGS: "--skip-slow --skip-network"
 
       py37_locale:
         ENV_FILE: ci/deps/azure-37-locale.yaml
         CONDA_PY: "37"
-        CONDA_ENV: pandas
         TEST_ARGS: "--skip-slow --skip-network"
         LOCALE_OVERRIDE: "zh_CN.UTF-8"
 
       py36_locale_slow:
         ENV_FILE: ci/deps/azure-36-locale_slow.yaml
         CONDA_PY: "36"
-        CONDA_ENV: pandas
         TEST_ARGS: "--only-slow --skip-network"
         LOCALE_OVERRIDE: "it_IT.UTF-8"
 
@@ -40,17 +37,19 @@ jobs:
       displayName: 'Before Install'
     - script: |
         export PATH=$HOME/miniconda3/bin:$PATH
+        source activate pandas-dev
         ci/incremental/build.sh
       displayName: 'Build'
     - script: |
         export PATH=$HOME/miniconda3/bin:$PATH
+        source activate pandas-dev
         ci/script_single.sh
         ci/script_multi.sh
         echo "[Test done]"
       displayName: 'Test'
     - script: |
         export PATH=$HOME/miniconda3/bin:$PATH
-        source activate pandas && pushd /tmp && python -c "import pandas; pandas.show_versions();" && popd
+        source activate pandas-dev && pushd /tmp && python -c "import pandas; pandas.show_versions();" && popd
     - task: PublishTestResults@2
       inputs:
         testResultsFiles: 'test-data-*.xml'
diff --git a/ci/azure/macos.yml b/ci/azure/macos.yml
index 16f2fa2d4..d537f0c70 100644
--- a/ci/azure/macos.yml
+++ b/ci/azure/macos.yml
@@ -12,7 +12,6 @@ jobs:
       py35_np_120:
         ENV_FILE: ci/deps/azure-macos-35.yaml
         CONDA_PY: "35"
-        CONDA_ENV: pandas
         TEST_ARGS: "--skip-slow --skip-network"
 
   steps:
@@ -26,17 +25,19 @@ jobs:
       displayName: 'Before Install'
     - script: |
         export PATH=$HOME/miniconda3/bin:$PATH
+        source activate pandas-dev
         ci/incremental/build.sh
       displayName: 'Build'
     - script: |
         export PATH=$HOME/miniconda3/bin:$PATH
+        source activate pandas-dev
         ci/script_single.sh
         ci/script_multi.sh
         echo "[Test done]"
       displayName: 'Test'
     - script: |
         export PATH=$HOME/miniconda3/bin:$PATH
-        source activate pandas && pushd /tmp && python -c "import pandas; pandas.show_versions();" && popd
+        source activate pandas-dev && pushd /tmp && python -c "import pandas; pandas.show_versions();" && popd
     - task: PublishTestResults@2
       inputs:
         testResultsFiles: 'test-data-*.xml'
@@ -65,4 +66,4 @@ jobs:
           # note that this will produce $LASTEXITCODE=1
           Write-Error "$($matches[1]) tests failed"
         }
-      displayName: Check for test failures
\ No newline at end of file
+      displayName: Check for test failures
diff --git a/ci/azure/windows-py27.yml b/ci/azure/windows-py27.yml
index fd72b7080..ac918f3be 100644
--- a/ci/azure/windows-py27.yml
+++ b/ci/azure/windows-py27.yml
@@ -12,7 +12,6 @@ jobs:
       py36_np121:
         ENV_FILE: ci/deps/azure-windows-27.yaml
         CONDA_PY: "27"
-        CONDA_ENV: pandas
 
   steps:
     - task: CondaEnvironment@1
@@ -33,10 +32,11 @@ jobs:
         ci\\incremental\\setup_conda_environment.cmd
       displayName: 'Before Install'
     - script: |
+        call activate pandas-dev
         ci\\incremental\\build.cmd
       displayName: 'Build'
     - script: |
-        call activate %CONDA_ENV%
+        call activate pandas-dev
         pytest --junitxml=test-data.xml --skip-slow --skip-network pandas -n 2 -r sxX --strict --durations=10 %*
       displayName: 'Test'
     - task: PublishTestResults@2
diff --git a/ci/azure/windows.yml b/ci/azure/windows.yml
index 9b87ac771..f0ebba509 100644
--- a/ci/azure/windows.yml
+++ b/ci/azure/windows.yml
@@ -12,7 +12,6 @@ jobs:
       py36_np14:
         ENV_FILE: ci/deps/azure-windows-36.yaml
         CONDA_PY: "36"
-        CONDA_ENV: pandas
 
   steps:
     - task: CondaEnvironment@1
@@ -24,10 +23,11 @@ jobs:
         ci\\incremental\\setup_conda_environment.cmd
       displayName: 'Before Install'
     - script: |
+        call activate pandas-dev
         ci\\incremental\\build.cmd
       displayName: 'Build'
     - script: |
-        call activate %CONDA_ENV%
+        call activate pandas-dev
         pytest --junitxml=test-data.xml --skip-slow --skip-network pandas -n 2 -r sxX --strict --durations=10 %*
       displayName: 'Test'
     - task: PublishTestResults@2
@@ -46,4 +46,4 @@ jobs:
           # note that this will produce $LASTEXITCODE=1
           Write-Error "$($matches[1]) tests failed"
         }
-      displayName: Check for test failures
\ No newline at end of file
+      displayName: Check for test failures
diff --git a/ci/build_docs.sh b/ci/build_docs.sh
index 33340a1c0..f89c4369d 100755
--- a/ci/build_docs.sh
+++ b/ci/build_docs.sh
@@ -12,8 +12,6 @@ if [ "$DOC" ]; then
 
     echo "Will build docs"
 
-    source activate pandas
-
     echo ###############################
     echo # Log file for the doc build  #
     echo ###############################
diff --git a/ci/circle/install_circle.sh b/ci/circle/install_circle.sh
index f8bcf6bcf..0918e8790 100755
--- a/ci/circle/install_circle.sh
+++ b/ci/circle/install_circle.sh
@@ -60,9 +60,9 @@ fi
 
 # create envbuild deps
 echo "[create env]"
-time conda env create -q -n pandas --file="${ENV_FILE}" || exit 1
+time conda env create -q --file="${ENV_FILE}" || exit 1
 
-source activate pandas
+source activate pandas-dev
 
 # remove any installed pandas package
 # w/o removing anything else
diff --git a/ci/circle/run_circle.sh b/ci/circle/run_circle.sh
deleted file mode 100755
index 803724c2f..000000000
--- a/ci/circle/run_circle.sh
+++ /dev/null
@@ -1,9 +0,0 @@
-#!/usr/bin/env bash
-
-echo "[running tests]"
-export PATH="$MINICONDA_DIR/bin:$PATH"
-
-source activate pandas
-
-echo "pytest --strict --durations=10 --color=no --junitxml=$CIRCLE_TEST_REPORTS/reports/junit.xml $@ pandas"
-pytest       --strict --durations=10 --color=no --junitxml=$CIRCLE_TEST_REPORTS/reports/junit.xml $@ pandas
diff --git a/ci/circle/show_circle.sh b/ci/circle/show_circle.sh
deleted file mode 100755
index bfaa65c1d..000000000
--- a/ci/circle/show_circle.sh
+++ /dev/null
@@ -1,8 +0,0 @@
-#!/usr/bin/env bash
-
-echo "[installed versions]"
-
-export PATH="$MINICONDA_DIR/bin:$PATH"
-source activate pandas
-
-python -c "import pandas; pandas.show_versions();"
diff --git a/ci/code_checks.sh b/ci/code_checks.sh
index 86e700368..e6cef3e42 100755
--- a/ci/code_checks.sh
+++ b/ci/code_checks.sh
@@ -20,7 +20,6 @@ echo "inside $0"
 [[ -z "$1" || "$1" == "lint" || "$1" == "patterns" || "$1" == "doctests" || "$1" == "dependencies"  ]] \
     || { echo "Unknown command $1. Usage: $0 [lint|patterns|doctests|dependencies]"; exit 9999; }
 
-source activate pandas
 BASE_DIR="$(dirname $0)/.."
 RET=0
 CHECK=$1
diff --git a/ci/deps/azure-27-compat.yaml b/ci/deps/azure-27-compat.yaml
index 44c561e9c..f3cc615c3 100644
--- a/ci/deps/azure-27-compat.yaml
+++ b/ci/deps/azure-27-compat.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/azure-36-locale_slow.yaml b/ci/deps/azure-36-locale_slow.yaml
index 7e40bd1a9..4bbc6a2c1 100644
--- a/ci/deps/azure-36-locale_slow.yaml
+++ b/ci/deps/azure-36-locale_slow.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/azure-37-locale.yaml b/ci/deps/azure-37-locale.yaml
index 064886d5c..11a698ce7 100644
--- a/ci/deps/azure-37-locale.yaml
+++ b/ci/deps/azure-37-locale.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/azure-macos-35.yaml b/ci/deps/azure-macos-35.yaml
index 6ccdc79d1..7a0c3b81a 100644
--- a/ci/deps/azure-macos-35.yaml
+++ b/ci/deps/azure-macos-35.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
 dependencies:
diff --git a/ci/deps/azure-windows-27.yaml b/ci/deps/azure-windows-27.yaml
index dc68129a5..b1533b071 100644
--- a/ci/deps/azure-windows-27.yaml
+++ b/ci/deps/azure-windows-27.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/azure-windows-36.yaml b/ci/deps/azure-windows-36.yaml
index af42545af..817aab66c 100644
--- a/ci/deps/azure-windows-36.yaml
+++ b/ci/deps/azure-windows-36.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/circle-36-locale.yaml b/ci/deps/circle-36-locale.yaml
index 59c8818ea..2b38465c0 100644
--- a/ci/deps/circle-36-locale.yaml
+++ b/ci/deps/circle-36-locale.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/travis-27-locale.yaml b/ci/deps/travis-27-locale.yaml
index c8d17cf19..0846ef5e8 100644
--- a/ci/deps/travis-27-locale.yaml
+++ b/ci/deps/travis-27-locale.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/travis-27.yaml b/ci/deps/travis-27.yaml
index 5a9e206ec..8d14673eb 100644
--- a/ci/deps/travis-27.yaml
+++ b/ci/deps/travis-27.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/travis-36-doc.yaml b/ci/deps/travis-36-doc.yaml
index fb54c784d..ed0764fab 100644
--- a/ci/deps/travis-36-doc.yaml
+++ b/ci/deps/travis-36-doc.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/travis-36-slow.yaml b/ci/deps/travis-36-slow.yaml
index 3157ecac3..a6ffdb95e 100644
--- a/ci/deps/travis-36-slow.yaml
+++ b/ci/deps/travis-36-slow.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/travis-36.yaml b/ci/deps/travis-36.yaml
index 1880fa250..1781f6704 100644
--- a/ci/deps/travis-36.yaml
+++ b/ci/deps/travis-36.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/deps/travis-37-numpydev.yaml b/ci/deps/travis-37-numpydev.yaml
index 82c75b7c9..99ae228f2 100644
--- a/ci/deps/travis-37-numpydev.yaml
+++ b/ci/deps/travis-37-numpydev.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
 dependencies:
diff --git a/ci/deps/travis-37.yaml b/ci/deps/travis-37.yaml
index 7dbd85ac2..a297786f6 100644
--- a/ci/deps/travis-37.yaml
+++ b/ci/deps/travis-37.yaml
@@ -1,4 +1,4 @@
-name: pandas
+name: pandas-dev
 channels:
   - defaults
   - conda-forge
diff --git a/ci/incremental/build.cmd b/ci/incremental/build.cmd
index d2fd06d7d..2cce38c03 100644
--- a/ci/incremental/build.cmd
+++ b/ci/incremental/build.cmd
@@ -1,5 +1,4 @@
 @rem https://github.com/numba/numba/blob/master/buildscripts/incremental/build.cmd
-call activate %CONDA_ENV%
 
 @rem Build numba extensions without silencing compile errors
 python setup.py build_ext -q --inplace
diff --git a/ci/incremental/build.sh b/ci/incremental/build.sh
index 8f2301a3b..056480379 100755
--- a/ci/incremental/build.sh
+++ b/ci/incremental/build.sh
@@ -1,7 +1,5 @@
 #!/bin/bash
 
-source activate $CONDA_ENV
-
 # Make sure any error below is reported as such
 set -v -e
 
diff --git a/ci/incremental/setup_conda_environment.cmd b/ci/incremental/setup_conda_environment.cmd
index 35595ffb0..c104d7859 100644
--- a/ci/incremental/setup_conda_environment.cmd
+++ b/ci/incremental/setup_conda_environment.cmd
@@ -11,11 +11,11 @@ call deactivate
 @rem Display root environment (for debugging)
 conda list
 @rem Clean up any left-over from a previous build
-conda remove --all -q -y -n %CONDA_ENV%
+conda remove --all -q -y -n pandas-dev
 @rem Scipy, CFFI, jinja2 and IPython are optional dependencies, but exercised in the test suite
-conda env create -n %CONDA_ENV% --file=ci\deps\azure-windows-%CONDA_PY%.yaml
+conda env create --file=ci\deps\azure-windows-%CONDA_PY%.yaml
 
-call activate %CONDA_ENV%
+call activate pandas-dev
 conda list
 
 if %errorlevel% neq 0 exit /b %errorlevel%
diff --git a/ci/incremental/setup_conda_environment.sh b/ci/incremental/setup_conda_environment.sh
index f3ac99d5e..f174c17a6 100755
--- a/ci/incremental/setup_conda_environment.sh
+++ b/ci/incremental/setup_conda_environment.sh
@@ -5,6 +5,7 @@ set -v -e
 CONDA_INSTALL="conda install -q -y"
 PIP_INSTALL="pip install -q"
 
+
 # Deactivate any environment
 source deactivate
 # Display root environment (for debugging)
@@ -12,15 +13,14 @@ conda list
 # Clean up any left-over from a previous build
 # (note workaround for https://github.com/conda/conda/issues/2679:
 #  `conda env remove` issue)
-conda remove --all -q -y -n $CONDA_ENV
+conda remove --all -q -y -n pandas-dev
 
 echo
 echo "[create env]"
-time conda env create -q -n "${CONDA_ENV}" --file="${ENV_FILE}" || exit 1
+time conda env create -q --file="${ENV_FILE}" || exit 1
 
-# Activate first
 set +v
-source activate $CONDA_ENV
+source activate pandas-dev
 set -v
 
 # remove any installed pandas package
diff --git a/ci/install_travis.sh b/ci/install_travis.sh
index fd4a36f86..d1a940f11 100755
--- a/ci/install_travis.sh
+++ b/ci/install_travis.sh
@@ -80,9 +80,9 @@ echo
 echo "[create env]"
 
 # create our environment
-time conda env create -q -n pandas --file="${ENV_FILE}" || exit 1
+time conda env create -q --file="${ENV_FILE}" || exit 1
 
-source activate pandas
+source activate pandas-dev
 
 # remove any installed pandas package
 # w/o removing anything else
diff --git a/ci/script_multi.sh b/ci/script_multi.sh
index 98dd5137b..fba0c7ba1 100755
--- a/ci/script_multi.sh
+++ b/ci/script_multi.sh
@@ -2,8 +2,6 @@
 
 echo "[script multi]"
 
-source activate pandas
-
 if [ -n "$LOCALE_OVERRIDE" ]; then
     export LC_ALL="$LOCALE_OVERRIDE";
     export LANG="$LOCALE_OVERRIDE";
diff --git a/ci/script_single.sh b/ci/script_single.sh
index ea0d48bc2..cbbb7a495 100755
--- a/ci/script_single.sh
+++ b/ci/script_single.sh
@@ -2,8 +2,6 @@
 
 echo "[script_single]"
 
-source activate pandas
-
 if [ -n "$LOCALE_OVERRIDE" ]; then
     echo "Setting LC_ALL and LANG to $LOCALE_OVERRIDE"
     export LC_ALL="$LOCALE_OVERRIDE";
diff --git a/ci/upload_coverage.sh b/ci/upload_coverage.sh
index a7ef2fa90..88aca2059 100755
--- a/ci/upload_coverage.sh
+++ b/ci/upload_coverage.sh
@@ -5,7 +5,6 @@ if [ -z "$COVERAGE" ]; then
    exit 0
 fi
 
-source activate pandas
 
 echo "uploading coverage"
 bash <(curl -s https://codecov.io/bash) -Z -c -F single -f /tmp/cov-single.xml
