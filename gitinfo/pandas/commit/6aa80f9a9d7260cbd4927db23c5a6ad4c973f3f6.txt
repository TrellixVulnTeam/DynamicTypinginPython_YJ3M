commit 6aa80f9a9d7260cbd4927db23c5a6ad4c973f3f6
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Dec 11 21:57:43 2011 -0500

    BUG: use map_infer in applymap, speed boost and fix #465

diff --git a/RELEASE.rst b/RELEASE.rst
index c79f2e9bf..00c6f32e4 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -42,6 +42,8 @@ pandas 0.6.1
   - Implement new SparseList and SparseArray data structures. SparseSeries now
     derives from SparseArray (GH #463)
   - max_columns / max_rows options in set_printoptions (PR #453)
+  - Implement Series.rank and DataFrame.rank, fast versions of
+    scipy.stats.rankdata (GH #428)
 
 **Improvements to existing features**
 
diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 432fec9f1..a92c4a186 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -2410,17 +2410,7 @@ class DataFrame(NDFrame):
         -------
         applied : DataFrame
         """
-        npfunc = np.frompyfunc(func, 1, 1)
-
-        def f(x):
-            result = npfunc(x)
-            try:
-                result = result.astype(x.dtype)
-            except Exception:
-                pass
-            return result
-
-        return self.apply(f)
+        return self.apply(lambda x: lib.map_infer(x, func))
 
     #----------------------------------------------------------------------
     # Merging / joining methods
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 02f209d5f..d39932cbd 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -2923,6 +2923,10 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         assert_frame_equal(applied, self.frame * 2)
         result = self.frame.applymap(type)
 
+        # GH #465, function returning tuples
+        result = self.frame.applymap(lambda x: (x, x))
+        self.assert_(isinstance(result['A'][0], tuple))
+
     def test_filter(self):
         # items
 
