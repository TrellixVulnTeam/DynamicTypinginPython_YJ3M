commit 801a35d548ce02f14d1c20a85d3897b75c8f24ad
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Thu Jan 19 20:52:32 2012 -0500

    BUG: NA handling when sorting indexers

diff --git a/pandas/tools/merge.py b/pandas/tools/merge.py
index 22b0ca464..de4c7ca42 100644
--- a/pandas/tools/merge.py
+++ b/pandas/tools/merge.py
@@ -386,8 +386,14 @@ def _sort_labels(uniques, left, right):
 
     reverse_indexer = np.empty(len(sorter), dtype=np.int32)
     reverse_indexer.put(sorter, np.arange(len(sorter)))
-    return reverse_indexer.take(left), reverse_indexer.take(right)
 
+    new_left = reverse_indexer.take(left)
+    np.putmask(new_left, left == -1, -1)
+
+    new_right = reverse_indexer.take(right)
+    np.putmask(new_right, right == -1, -1)
+
+    return new_left, new_right
 
 class _BlockJoinOperation(object):
     """
diff --git a/pandas/tools/tests/test_merge.py b/pandas/tools/tests/test_merge.py
index 2f08974ff..232a18f78 100644
--- a/pandas/tools/tests/test_merge.py
+++ b/pandas/tools/tests/test_merge.py
@@ -565,6 +565,20 @@ class TestMergeMulti(unittest.TestCase):
                        right_on=['k1', 'k2'], how='right')
         tm.assert_frame_equal(joined.ix[:, expected.columns], expected)
 
+    def test_left_merge_na_buglet(self):
+        left = DataFrame({'id': list('abcde'), 'v1': randn(5),
+                          'v2': randn(5), 'dummy' : list('abcde'),
+                          'v3' : randn(5)},
+                         columns=['id', 'v1', 'v2', 'dummy', 'v3'])
+        right = DataFrame({'id' : ['a', 'b', np.nan, np.nan, np.nan],
+                           'sv3' : [1.234, 5.678, np.nan, np.nan, np.nan]})
+
+        merged = merge(left, right, on='id', how='left')
+
+        rdf = right.drop(['id'], axis=1)
+        expected = left.join(rdf)
+        tm.assert_frame_equal(merged, expected)
+
 def _check_join(left, right, result, join_col, how='left',
                 lsuffix='.x', rsuffix='.y'):
 
