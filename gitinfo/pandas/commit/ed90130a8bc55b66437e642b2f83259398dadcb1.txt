commit ed90130a8bc55b66437e642b2f83259398dadcb1
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Jun 27 19:05:32 2011 -0400

    BUG: fillna bug in Series GH#54

diff --git a/RELEASE.rst b/RELEASE.rst
index 30bcf741c..de159197d 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -103,8 +103,9 @@ Release notes
 * Cython is now required to build `pandas` from a development branch. This was
   done to avoid continuing to check in cythonized C files into source
   control. Builds from released source distributions will not require Cython
-* Cython extension modules have been renamed and promoted from the `lib`
-  subpackage to the top level, i.e.
+* Cython code has been moved up to a top level `pandas/src` directory. Cython
+  extension modules have been renamed and promoted from the `lib` subpackage to
+  the top level, i.e.
   * `pandas.lib.tseries` -> `pandas._tseries`
   * `pandas.lib.sparse` -> `pandas._sparse`
 * A `copy` argument has been added to the `DataFrame` constructor to avoid
diff --git a/pandas/core/series.py b/pandas/core/series.py
index 930187277..b5d15516a 100644
--- a/pandas/core/series.py
+++ b/pandas/core/series.py
@@ -1062,8 +1062,25 @@ class Series(np.ndarray, PandasGeneric):
             newSeries[isnull(newSeries)] = value
             return newSeries
         else: # Using reindex to pad / backfill
-            withoutna = remove_na(self)
-            return withoutna.reindex(self.index, method=method)
+            if method is None: # pragma: no cover
+                raise ValueError('must specify a fill method')
+
+            method = method.lower()
+
+            if method == 'ffill':
+                method = 'pad'
+            if method == 'bfill':
+                method = 'backfill'
+
+            mask = isnull(self.values)
+
+            if method == 'pad':
+                indexer = _tseries.get_pad_indexer(mask)
+            elif method == 'backfill':
+                indexer = _tseries.get_backfill_indexer(mask)
+
+            new_values = self.values.take(indexer)
+            return Series(new_values, index=self.index)
 
 #-------------------------------------------------------------------------------
 # Miscellaneous
diff --git a/pandas/tests/test_series.py b/pandas/tests/test_series.py
index e2c132a0f..cf403de81 100644
--- a/pandas/tests/test_series.py
+++ b/pandas/tests/test_series.py
@@ -915,6 +915,16 @@ class TestSeries(unittest.TestCase):
 
         self.assert_(np.array_equal(ts.fillna(value=5), [0., 1., 5., 3., 4.]))
 
+    def test_fillna_bug(self):
+        x = Series([nan, 1., nan, 3., nan],['z','a','b','c','d'])
+        filled = x.fillna(method='ffill')
+        expected = Series([nan, 1., 1., 3., 3.], x.index)
+        assert_series_equal(filled, expected)
+
+        filled = x.fillna(method='bfill')
+        expected = Series([1., 1., 3., 3., nan], x.index)
+        assert_series_equal(filled, expected)
+
     def test_asfreq(self):
         ts = Series([0., 1., 2.], index=[datetime(2009, 10, 30),
                                          datetime(2009, 11, 30),
