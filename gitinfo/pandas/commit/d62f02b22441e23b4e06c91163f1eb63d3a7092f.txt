commit d62f02b22441e23b4e06c91163f1eb63d3a7092f
Author: Ka Wo Chen <kawoc@tepper.cmu.edu>
Date:   Wed Jun 24 01:22:56 2015 -0400

    BUG: GH9907 generate_range when start and end have higher resolution than offset

diff --git a/doc/source/whatsnew/v0.17.0.txt b/doc/source/whatsnew/v0.17.0.txt
index 14e185b5b..592c3ad2e 100644
--- a/doc/source/whatsnew/v0.17.0.txt
+++ b/doc/source/whatsnew/v0.17.0.txt
@@ -90,12 +90,14 @@ Bug Fixes
 
 
 - Bug in ``Table.select_column`` where name is not preserved (:issue:`10392`)
+- Bug in ``offsets.generate_range`` where ``start`` and ``end`` have finer precision than ``offset`` (:issue:`9907`)
 
 
 - Bug in ``DataFrame.interpolate`` with ``axis=1`` and ``inplace=True`` (:issue:`10395`)
 
 
 
+
 - Bug in ``test_categorical`` on big-endian builds (:issue:`10425`)
 
 
diff --git a/pandas/tseries/offsets.py b/pandas/tseries/offsets.py
index 3bebd0daa..3a69a1373 100644
--- a/pandas/tseries/offsets.py
+++ b/pandas/tseries/offsets.py
@@ -2450,12 +2450,12 @@ def generate_range(start=None, end=None, periods=None,
     if start and not offset.onOffset(start):
         start = offset.rollforward(start)
 
-    if end and not offset.onOffset(end):
+    elif end and not offset.onOffset(end):
         end = offset.rollback(end)
 
-        if periods is None and end < start:
-            end = None
-            periods = 0
+    if periods is None and end < start:
+        end = None
+        periods = 0
 
     if end is None:
         end = start + (periods - 1) * offset
@@ -2465,7 +2465,6 @@ def generate_range(start=None, end=None, periods=None,
 
     cur = start
 
-    next_date = cur
     while cur <= end:
         yield cur
 
diff --git a/pandas/tseries/tests/test_daterange.py b/pandas/tseries/tests/test_daterange.py
index d5a63adba..ee30b188b 100644
--- a/pandas/tseries/tests/test_daterange.py
+++ b/pandas/tseries/tests/test_daterange.py
@@ -57,6 +57,26 @@ class TestGenRangeGeneration(tm.TestCase):
                           end=datetime(2008, 1, 6)),
                      [])
 
+    def test_precision_finer_than_offset(self):
+        # GH 9907
+        result1 = DatetimeIndex(start='2015-04-15 00:00:03',
+                                end='2016-04-22 00:00:00', freq='Q')
+        result2 = DatetimeIndex(start='2015-04-15 00:00:03',
+                                end='2015-06-22 00:00:04', freq='W')
+        expected1_list = ['2015-06-30 00:00:03', '2015-09-30 00:00:03',
+                          '2015-12-31 00:00:03', '2016-03-31 00:00:03']
+        expected2_list = ['2015-04-19 00:00:03', '2015-04-26 00:00:03',
+                          '2015-05-03 00:00:03', '2015-05-10 00:00:03',
+                          '2015-05-17 00:00:03', '2015-05-24 00:00:03',
+                          '2015-05-31 00:00:03', '2015-06-07 00:00:03',
+                          '2015-06-14 00:00:03', '2015-06-21 00:00:03']
+        expected1 = DatetimeIndex(expected1_list, dtype='datetime64[ns]',
+                                  freq='Q-DEC', tz=None)
+        expected2 = DatetimeIndex(expected2_list, dtype='datetime64[ns]',
+                                  freq='W-SUN', tz=None)
+        self.assertTrue(result1.equals(expected1))
+        self.assertTrue(result2.equals(expected2))
+
 
 class TestDateRange(tm.TestCase):
 
