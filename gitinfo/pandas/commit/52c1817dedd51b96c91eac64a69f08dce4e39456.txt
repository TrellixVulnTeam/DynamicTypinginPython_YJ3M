commit 52c1817dedd51b96c91eac64a69f08dce4e39456
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Dec 19 21:42:27 2011 -0500

    TST: don't use Py_ssize_t in the buffer for now

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index 8786955e9..a8a84811d 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -1358,7 +1358,8 @@ def generate_groups(data, label_list, shape, axis=0, factory=lambda x: x):
         def slicer(data, slob):
             return data[slob]
 
-    starts, ends = lib.generate_slices(group_index, np.prod(shape))
+    starts, ends = lib.generate_slices(group_index.astype('i4'),
+                                       np.prod(shape))
 
     for i, (start, end) in enumerate(zip(starts, ends)):
         if start == end:
diff --git a/pandas/src/groupby.pyx b/pandas/src/groupby.pyx
index 065dc49a1..2d455bb7a 100644
--- a/pandas/src/groupby.pyx
+++ b/pandas/src/groupby.pyx
@@ -513,7 +513,7 @@ def duplicated(list values, take_last=False):
     return result.view(np.bool_)
 
 
-def generate_slices(ndarray[Py_ssize_t] labels, Py_ssize_t ngroups):
+def generate_slices(ndarray[int32_t] labels, Py_ssize_t ngroups):
     cdef:
         Py_ssize_t i, group_size, n, lab, start
         object slobj
