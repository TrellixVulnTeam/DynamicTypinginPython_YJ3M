commit a228d1e01b68e122247bbd8108a8bba8812a095e
Author: Phillip Cloud <cpcloud@gmail.com>
Date:   Sat Apr 5 15:41:33 2014 -0400

    BUG: check for dtype attr then check block types if no dtype attr

diff --git a/pandas/computation/expressions.py b/pandas/computation/expressions.py
index 5575d020f..128aa5bf2 100644
--- a/pandas/computation/expressions.py
+++ b/pandas/computation/expressions.py
@@ -154,9 +154,16 @@ def _where_numexpr(cond, a, b, raise_on_error=False):
 set_use_numexpr(True)
 
 
-def _bool_arith_check(op_str, a, b, not_allowed=('+', '*', '-', '/',
-                                                 '//', '**')):
-    if op_str in not_allowed and a.dtype == bool and b.dtype == bool:
+def _has_bool_dtype(x):
+    try:
+        return x.dtype == bool
+    except AttributeError:
+        return 'bool' in x.blocks
+
+
+def _bool_arith_check(op_str, a, b, not_allowed=frozenset(('+', '*', '-', '/',
+                                                           '//', '**'))):
+    if op_str in not_allowed and _has_bool_dtype(a) and _has_bool_dtype(b):
         raise NotImplementedError("operator %r not implemented for bool "
                                   "dtypes" % op_str)
 
