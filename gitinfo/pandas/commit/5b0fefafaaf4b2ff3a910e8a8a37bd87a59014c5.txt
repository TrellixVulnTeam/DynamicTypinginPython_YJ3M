commit 5b0fefafaaf4b2ff3a910e8a8a37bd87a59014c5
Author: Kaiqi Dong <kaiqi@kth.se>
Date:   Sun Feb 2 00:10:40 2020 +0100

    BUG&TST: df.replace fail after converting to new dtype (#31545)

diff --git a/pandas/tests/frame/methods/test_replace.py b/pandas/tests/frame/methods/test_replace.py
index aa91e7a48..92b74c440 100644
--- a/pandas/tests/frame/methods/test_replace.py
+++ b/pandas/tests/frame/methods/test_replace.py
@@ -1356,3 +1356,10 @@ class TestDataFrameReplace:
         result = df.replace({"a": replacer, "b": replacer})
         expected = pd.DataFrame([replacer])
         tm.assert_frame_equal(result, expected)
+
+    def test_replace_after_convert_dtypes(self):
+        # GH31517
+        df = pd.DataFrame({"grp": [1, 2, 3, 4, 5]}, dtype="Int64")
+        result = df.replace(1, 10)
+        expected = pd.DataFrame({"grp": [10, 2, 3, 4, 5]}, dtype="Int64")
+        tm.assert_frame_equal(result, expected)
