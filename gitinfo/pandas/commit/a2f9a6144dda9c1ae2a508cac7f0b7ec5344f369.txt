commit a2f9a6144dda9c1ae2a508cac7f0b7ec5344f369
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Fri Sep 16 11:34:47 2011 -0400

    BUG: pivot misaligns data with duplicates, raise Exception

diff --git a/pandas/core/common.py b/pandas/core/common.py
index 7206a2555..ed2afce19 100644
--- a/pandas/core/common.py
+++ b/pandas/core/common.py
@@ -217,7 +217,7 @@ def _format(s, nanRep=None, float_format=None):
         if nanRep is not None and isnull(s):
             if np.isnan(s):
                 s = nanRep
-            return (' %s' % s)
+            return (' %s' % str(s))
 
         if float_format:
             formatted = float_format(s)
@@ -232,7 +232,7 @@ def _format(s, nanRep=None, float_format=None):
 
         return formatted
     else:
-        return ' %s' % s
+        return ' %s' % str(s)
 
 #-------------------------------------------------------------------------------
 # miscellaneous python tools
diff --git a/pandas/core/reshape.py b/pandas/core/reshape.py
index 28944b4db..b2eed52b4 100644
--- a/pandas/core/reshape.py
+++ b/pandas/core/reshape.py
@@ -186,6 +186,10 @@ def pivot(self, index=None, columns=None, values=None):
     index_vals = self[index]
     column_vals = self[columns]
     mindex = MultiIndex.from_arrays([index_vals, column_vals])
+    try:
+        mindex._verify_integrity()
+    except Exception:
+        raise Exception('duplicate index/column pairs!')
 
     if values is None:
         items = self.columns - [index, columns]
