commit dab4d88a720e9d2332b4c48713364a144f3c6052
Author: Rohith295 <57575037+Rohith295@users.noreply.github.com>
Date:   Sat Jun 20 15:24:24 2020 -0700

    TST: groupby apply called multiple times (#34897)
    
    * :white_check_mark:
    
    * :white_check_mark:
    
    * reformatted accordingly, for linting issues
    
    * Fixed as per the review comments

diff --git a/pandas/tests/groupby/test_apply.py b/pandas/tests/groupby/test_apply.py
index d03b03b3f..1945647ce 100644
--- a/pandas/tests/groupby/test_apply.py
+++ b/pandas/tests/groupby/test_apply.py
@@ -190,6 +190,27 @@ def test_group_apply_once_per_group(df, group_names):
         assert names == group_names
 
 
+def test_group_apply_once_per_group2(capsys):
+    # GH: 31111
+    # groupby-apply need to execute len(set(group_by_columns)) times
+
+    expected = 2  # Number of times `apply` should call a function for the current test
+
+    df = pd.DataFrame(
+        {
+            "group_by_column": [0, 0, 0, 0, 1, 1, 1, 1],
+            "test_column": ["0", "2", "4", "6", "8", "10", "12", "14"],
+        },
+        index=["0", "2", "4", "6", "8", "10", "12", "14"],
+    )
+
+    df.groupby("group_by_column").apply(lambda df: print("function_called"))
+
+    result = capsys.readouterr().out.count("function_called")
+    # If `groupby` behaves unexpectedly, this test will break
+    assert result == expected
+
+
 def test_apply_fast_slow_identical():
     # GH 31613
 
