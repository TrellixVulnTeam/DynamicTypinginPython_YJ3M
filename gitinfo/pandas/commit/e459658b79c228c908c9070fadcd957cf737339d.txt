commit e459658b79c228c908c9070fadcd957cf737339d
Author: jbrockmendel <jbrockmendel@gmail.com>
Date:   Wed Nov 29 04:58:12 2017 -0800

    Make khash its own extension (#18472)

diff --git a/pandas/_libs/src/khash.pxd b/pandas/_libs/khash.pxd
similarity index 98%
rename from pandas/_libs/src/khash.pxd
rename to pandas/_libs/khash.pxd
index ba9a3c700..b1d965c36 100644
--- a/pandas/_libs/src/khash.pxd
+++ b/pandas/_libs/khash.pxd
@@ -1,3 +1,5 @@
+# -*- coding: utf-8 -*-
+# cython: profile=False
 from cpython cimport PyObject
 from numpy cimport int64_t, uint64_t, int32_t, uint32_t, float64_t
 
diff --git a/pandas/_libs/tslibs/resolution.pyx b/pandas/_libs/tslibs/resolution.pyx
index 0692d985b..1c20dbe7f 100644
--- a/pandas/_libs/tslibs/resolution.pyx
+++ b/pandas/_libs/tslibs/resolution.pyx
@@ -10,7 +10,7 @@ np.import_array()
 
 from util cimport is_string_object, get_nat
 
-from khash cimport (
+from pandas._libs.khash cimport (
     khiter_t,
     kh_destroy_int64, kh_put_int64,
     kh_init_int64, kh_int64_t,
diff --git a/setup.py b/setup.py
index 37be0b696..68e131945 100755
--- a/setup.py
+++ b/setup.py
@@ -497,7 +497,7 @@ ext_data = {
         'pyxfile': '_libs/hashing'},
     '_libs.hashtable': {
         'pyxfile': '_libs/hashtable',
-        'pxdfiles': ['_libs/hashtable', '_libs/missing'],
+        'pxdfiles': ['_libs/hashtable', '_libs/missing', '_libs/khash'],
         'depends': (['pandas/_libs/src/klib/khash_python.h'] +
                     _pxi_dep['hashtable'])},
     '_libs.index': {
@@ -554,7 +554,6 @@ ext_data = {
     '_libs.tslib': {
         'pyxfile': '_libs/tslib',
         'pxdfiles': ['_libs/src/util',
-                     '_libs/src/khash',
                      '_libs/tslibs/conversion',
                      '_libs/tslibs/timedeltas',
                      '_libs/tslibs/timestamps',
@@ -595,12 +594,11 @@ ext_data = {
         'sources': np_datetime_sources},
     '_libs.tslibs.parsing': {
         'pyxfile': '_libs/tslibs/parsing',
-        'pxdfiles': ['_libs/src/util',
-                     '_libs/src/khash']},
+        'pxdfiles': ['_libs/src/util']},
     '_libs.tslibs.resolution': {
         'pyxfile': '_libs/tslibs/resolution',
         'pxdfiles': ['_libs/src/util',
-                     '_libs/src/khash',
+                     '_libs/khash',
                      '_libs/tslibs/frequencies',
                      '_libs/tslibs/timezones'],
         'depends': tseries_depends,
