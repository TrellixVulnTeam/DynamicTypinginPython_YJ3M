commit fa3511b9b2d350dacd9e6cb29a1314409ccad5db
Author: Jan Rudolph <jan.daniel.rudolph@gmail.com>
Date:   Tue Jul 3 01:28:26 2018 +0200

    add unit test for writing to already open file (#21696)

diff --git a/pandas/tests/io/formats/test_to_csv.py b/pandas/tests/io/formats/test_to_csv.py
index 36c4ae547..20dfeb10d 100644
--- a/pandas/tests/io/formats/test_to_csv.py
+++ b/pandas/tests/io/formats/test_to_csv.py
@@ -300,3 +300,19 @@ $1$,$2$
         output = sys.stdout.getvalue()
         assert output == expected_ascii
         assert not sys.stdout.closed
+
+    def test_to_csv_write_to_open_file(self):
+        # GH 21696
+        df = pd.DataFrame({'a': ['x', 'y', 'z']})
+        expected = '''\
+manual header
+x
+y
+z
+'''
+        with tm.ensure_clean('test.txt') as path:
+            with open(path, 'w') as f:
+                f.write('manual header\n')
+                df.to_csv(f, header=None, index=None)
+            with open(path, 'r') as f:
+                assert f.read() == expected
