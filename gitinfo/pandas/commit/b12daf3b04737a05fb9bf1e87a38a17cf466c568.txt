commit b12daf3b04737a05fb9bf1e87a38a17cf466c568
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Fri Apr 9 18:19:43 2010 +0000

    grinding unit tests. groupby cleanup. cython code cleanup and testing. reindex function cleanup
    
    git-svn-id: http://pandas.googlecode.com/svn/trunk@153 d5231056-7de3-11de-ac95-d976489f1ece

diff --git a/pandas/core/daterange.py b/pandas/core/daterange.py
index 0bca109c3..63a3546ac 100644
--- a/pandas/core/daterange.py
+++ b/pandas/core/daterange.py
@@ -1,12 +1,10 @@
-# pylint: disable-msg=E1101
-# pylint: disable-msg=E1103
+# pylint: disable-msg=E1101,E1103
 
 from datetime import datetime
 
 import numpy as np
 
 from pandas.core.index import Index
-from pandas.lib.tseries import map_indices
 import pandas.core.datetools as datetools
 
 #-------------------------------------------------------------------------------
diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 065239478..9d372e811 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -71,17 +71,24 @@ class DataFrame(Picklable, Groupable):
             self._series, self.index = self._initDict(data, index,
                                                       columns, dtype)
 
-        elif isinstance(data, np.ndarray):
-            if columns is None:
-                raise Exception('Must pass column names with ndarray!')
-            if index is None:
-                raise Exception('Must pass index with ndarray!')
+        elif isinstance(data, (np.ndarray, list)):
+            if not isinstance(data, np.ndarray):
+                arr = np.array(data)
+                if issubclass(arr.dtype.type, basestring):
+                    arr = np.array(data, dtype=object, copy=True)
+
+                data = arr
 
             if data.ndim == 1:
                 data = data.reshape((len(data), 1))
             elif data.ndim != 2:
                 raise Exception('Must pass 2-d input!')
 
+            if columns is None:
+                raise Exception('Must pass column names with array!')
+            if index is None:
+                raise Exception('Must pass index with array!')
+
             self._series, self.index = self._initMatrix(data, index,
                                                         columns, dtype)
 
@@ -882,8 +889,6 @@ class DataFrame(Picklable, Groupable):
         """
         if fillMethod:
             fillMethod = fillMethod.upper()
-        else:
-            fillMethod = ''
 
         frame = self
 
diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index b346645a1..b0adb4c4d 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -1,43 +1,18 @@
 import numpy as np
 
-from cStringIO import StringIO
-
 from pandas.core.frame import DataFrame
 from pandas.core.matrix import DataMatrix
 from pandas.core.series import Series
-from pandas.lib.tseries import isnull
-
-def groupby_withnull(index, mapper):
-    index = np.asarray(index)
-    mapped_index = np.array([mapper(x) for x in index])
-
-    # A little hack here
-    if issubclass(mapped_index.dtype.type, basestring):
-        mapped_index = mapped_index.astype(object)
-
-    result = GroupDict()
-
-    mask = isnull(mapped_index)
-    nullkeys = index[mask]
-
-    if nullkeys is not None and len(nullkeys) > 0:
-        result[np.NaN] = nullkeys
-
-    notmask = -mask
-    index = index[notmask]
-    mapped_index = mapped_index[notmask]
-
-    for idx, key in zip(index, mapped_index):
-        result.setdefault(key, []).append(idx)
-
-    return result
+import pandas.lib.tseries as tseries
 
 class GroupDict(dict):
     def __repr__(self):
-        stringDict = dict((str(x), x) for x in self)
+        from cStringIO import StringIO
+
+        stringDict = dict([(str(x), x) for x in self])
         sortedKeys = sorted(stringDict)
 
-        maxLen = max(len(x) for x in stringDict)
+        maxLen = max([len(x) for x in stringDict])
 
         output = StringIO()
         output.write(str(self.__class__))
@@ -75,6 +50,7 @@ class GroupBy(object):
     DataFrame / DataMatrix (and derivatives thereof)
     """
     _groups = None
+    _group_indices = None
 
     def __init__(self, obj, grouper):
         self.obj = obj
@@ -85,10 +61,19 @@ class GroupBy(object):
     @property
     def groups(self):
         if self._groups is None:
-            self._groups = groupby_withnull(self.obj.index, self.grouper)
+            self._groups = tseries.groupby(self.obj.index, self.grouper,
+                                           output=GroupDict())
 
         return self._groups
 
+    @property
+    def group_indices(self):
+        if self._group_indices is None:
+            self._group_indices = tseries.groupby_indices(self.obj.index,
+                                                          self.grouper)
+
+        return self._group_indices
+
     def getGroup(self, groupList):
         return self.obj.reindex(groupList)
 
@@ -106,8 +91,7 @@ class GroupBy(object):
             groupNames = self.groups.keys()
 
         for groupName in groupNames:
-            groupList = self.groups[groupName]
-            yield groupName, self.getGroup(groupList)
+            yield groupName, self[groupName]
 
     def aggregate(self, func):
         raise NotImplementedError
@@ -142,46 +126,52 @@ class SeriesGroupBy(GroupBy):
         -------
         Series or DataFrame
         """
-        from pandas.lib.tseries import groupbyfunc
-
         if hasattr(applyfunc,'__iter__'):
+            retVal = self._aggregate_multiple(applyfunc)
+        else:
+            try:
+                result = self._aggregate_simple(applyfunc)
+            except Exception:
+                result = self._aggregate_named(applyfunc)
 
-            if not isinstance(applyfunc, dict):
-                applyfunc = dict((func.__name__, func) for func in applyfunc)
+            retVal = Series(result)
 
-            results = {}
+        return retVal
 
-            for name, func in applyfunc.iteritems():
-                result = self.aggregate(func)
-                results[name] = result
+    def _aggregate_multiple(self, applyfunc):
+        if not isinstance(applyfunc, dict):
+            applyfunc = dict((func.__name__, func) for func in applyfunc)
 
-            retVal = DataFrame(results)
-        else:
-            try:
-                result = groupbyfunc(self.obj.index, self.obj,
-                                     self.grouper, applyfunc)
-            except Exception:
-                result = {}
-                theUnion = set([])
-                for groupName, groupList in self.groups.iteritems():
-                    groupList = list(groupList)
-                    theUnion.update(groupList)
-                    grp = self.getGroup(groupList)
-                    grp.groupName = groupName
-                    output = applyfunc(grp)
+        results = {}
 
-                    if isinstance(output, Series):
-                        raise Exception('Given applyfunc did not return a '
-                                        'value from the subseries as expected!')
+        for name, func in applyfunc.iteritems():
+            result = self.aggregate(func)
+            results[name] = result
 
-                    result[groupName] = output
+        return DataFrame(results)
 
-                for missingIdx in (self.obj.index - list(theUnion)):
-                    result[missingIdx] = np.nan
+    def _aggregate_simple(self, applyfunc):
+        values = self.obj.values()
+        result = {}
+        for k, v in self.group_indices.iteritems():
+            result[k] = applyfunc(values.take(v))
 
-            retVal = Series(result)
+        return result
 
-        return retVal
+    def _aggregate_named(self, applyfunc):
+        result = {}
+        for groupName in self.groups:
+            grp = self[groupName]
+            grp.groupName = groupName
+            output = applyfunc(grp)
+
+            if isinstance(output, Series):
+                raise Exception('Given applyfunc did not return a '
+                                'value from the subseries as expected!')
+
+            result[groupName] = output
+
+        return result
 
     def transform(self, applyfunc):
         """
@@ -215,7 +205,7 @@ class SeriesGroupBy(GroupBy):
         """
 
         result = {}
-        for val, subseries in iter(self):
+        for val, subseries in self:
             subseries.groupName = val
             result[val] = applyfunc(subseries)
 
@@ -257,14 +247,9 @@ class DataFrameGroupBy(GroupBy):
         Optional: provide set mapping as dictionary
         """
         result = {}
-        theUnion = set([])
-        for val, group in self.groups.iteritems():
-            groupList = list(group)
-            theUnion.update(groupList)
-            result[val] = self.getGroup(groupList).apply(applyfunc)
-            assert(isinstance(result[val], Series))
-        for missingIdx in (set(self.obj.index) - theUnion):
-            result[missingIdx] = np.repeat(np.nan, len(self.obj.cols()))
+        for groupName in self.groups:
+            result[groupName] = self[groupName].apply(applyfunc)
+            assert(isinstance(result[groupName], Series))
 
         return DataFrame(data=result).T
 
@@ -330,15 +315,9 @@ class DataMatrixGroupBy(DataFrameGroupBy):
             Function to use to aggregate each group
         """
         result = {}
-        theUnion = set([])
-        for val, group in self.groups.iteritems():
-            groupList = list(group)
-            theUnion.update(groupList)
-            result[val] = self.getGroup(groupList).apply(applyfunc)
-            assert(isinstance(result[val], Series))
-        for missingIdx in (set(self.obj.index) - theUnion):
-            result[missingIdx] = np.repeat(np.nan, len(self.obj.cols()))
-
+        for groupName in self.groups:
+            result[groupName] = self[groupName].apply(applyfunc)
+            assert(isinstance(result[groupName], Series))
         return DataMatrix(data=result).T
 
     def transform(self, applyfunc):
diff --git a/pandas/core/index.py b/pandas/core/index.py
index e3f604b59..72d5468a4 100644
--- a/pandas/core/index.py
+++ b/pandas/core/index.py
@@ -129,7 +129,7 @@ class Index(np.ndarray):
         return date
 
     def sort(self, *args, **kwargs):
-        raise Exception('Tried to sort an Index object, too dangerous to be OK!')
+        raise Exception('Cannot sort an Index object')
 
     def argsort(self, *args, **kwargs):
         return self.view(np.ndarray).argsort(*args, **kwargs)
diff --git a/pandas/core/matrix.py b/pandas/core/matrix.py
index 4eecc2c27..4bb34e558 100644
--- a/pandas/core/matrix.py
+++ b/pandas/core/matrix.py
@@ -1162,19 +1162,22 @@ class DataMatrix(DataFrame):
             object_columns = columns.intersection(self.objects.columns)
             columns = columns - object_columns
 
+            objects = self.objects._reindex_columns(object_columns)
+        else:
+            objects = None
+
+        if len(columns) > 0 and len(self.columns) == 0:
+            return DataMatrix(index=self.index, columns=columns,
+                              objects=objects)
+
         indexer, mask = tseries.getFillVec(self.columns, columns,
                                            self.columns.indexMap,
-                                           columns.indexMap, '')
+                                           columns.indexMap, None)
 
         newValues = self.values.take(indexer, axis=1)
         if len(mask) > 0:
             newValues[:, -mask] = NaN
 
-        if self.objects is not None:
-            objects = self.objects._reindex_columns(object_columns)
-        else:
-            objects = None
-
         return DataMatrix(newValues, index=self.index, columns=columns,
                           objects=objects)
 
@@ -1337,7 +1340,7 @@ class DataMatrix(DataFrame):
 
 def _reorder_columns(mat, current, desired):
     fillVec, mask = tseries.getFillVec(current, desired, current.indexMap,
-                                       desired.indexMap, '')
+                                       desired.indexMap, None)
 
     fillVec = fillVec[mask]
 
diff --git a/pandas/core/panel.py b/pandas/core/panel.py
index d02ee73f1..d66efe986 100644
--- a/pandas/core/panel.py
+++ b/pandas/core/panel.py
@@ -195,7 +195,7 @@ class WidePanel(Panel):
                          self.minor_axis)
 
     @classmethod
-    def fromDict(cls, data, intersect=True, dtype=float):
+    def fromDict(cls, data, intersect=False, dtype=float):
         """
         Construct WidePanel from dict of DataFrame objects
 
@@ -676,6 +676,8 @@ class WidePanel(Panel):
         return self._wrap_result(result, axis=axis)
 
     def _values_aggregate(self, func, axis, fill_value):
+        axis = self._get_axis_number(axis)
+
         values = self.values
         mask = np.isfinite(values)
 
@@ -690,6 +692,23 @@ class WidePanel(Panel):
 
         return result
 
+    def _values_accum(self, func, axis, fill_value):
+        axis = self._get_axis_number(axis)
+
+        values = self.values
+        mask = np.isfinite(values)
+
+        if fill_value is not None:
+            values = values.copy()
+            values[-mask] = fill_value
+
+        result = func(values, axis=axis)
+
+        if fill_value is not None:
+            result[-mask] = np.NaN
+
+        return result
+
     def _array_method(self, func, axis='major', fill_value=None):
         """
         Parameters
@@ -704,11 +723,23 @@ class WidePanel(Panel):
         -------
         y : DataMatrix
         """
-        i = self._get_axis_number(axis)
-
-        result = self._values_aggregate(func, i, fill_value)
+        result = self._values_aggregate(func, axis, fill_value)
         return self._wrap_result(result, axis=axis)
 
+    def _wrap_result(self, result, axis):
+        axis = self._get_axis_name(axis)
+
+        if result.ndim == 2:
+            index, columns = self._get_plane_axes(axis)
+
+            if axis != 'items':
+                result = result.T
+
+            return DataMatrix(result, index=index, columns=columns)
+        else:
+            return WidePanel(result, self.items, self.major_axis,
+                             self.minor_axis)
+
     def count(self, axis='major'):
         """
         Return DataMatrix of observation counts along desired axis
@@ -741,7 +772,8 @@ class WidePanel(Panel):
         -------
         y : WidePanel
         """
-        return self._array_method(np.cumsum, axis=axis, fill_value=0)
+        result = self._values_accum(np.cumsum, axis=axis, fill_value=0)
+        return self._wrap_result(result, axis)
 
     def mean(self, axis='major'):
         """
@@ -859,20 +891,6 @@ class WidePanel(Panel):
 
         return self._wrap_result(result, axis)
 
-    def _wrap_result(self, result, axis):
-        axis = self._get_axis_name(axis)
-
-        if result.ndim == 2:
-            index, columns = self._get_plane_axes(axis)
-
-            if axis != 'items':
-                result = result.T
-
-            return DataMatrix(result, index=index, columns=columns)
-        else:
-            return WidePanel(result, self.items, self.major_axis,
-                             self.minor_axis)
-
     def shift(self, lags, axis='major'):
         """
 
@@ -1774,13 +1792,8 @@ class Factor(object):
             return Factor(new_labels, self.levels)
 
 def _get_indexer(source, target, fill_method):
-    if not fill_method:
-        fill_method = ''
-
-    fill_method = fill_method.upper()
-
-    if fill_method not in ['BACKFILL', 'PAD', '']:
-        raise Exception("Don't recognize fill_method: %s" % fill_method)
+    if fill_method:
+        fill_method = fill_method.upper()
 
     indexer, mask = tseries.getFillVec(source, target, source.indexMap,
                                        target.indexMap, fill_method)
diff --git a/pandas/core/series.py b/pandas/core/series.py
index e3e77b438..def5445c0 100644
--- a/pandas/core/series.py
+++ b/pandas/core/series.py
@@ -2,11 +2,11 @@
 Data structure for 1-dimensional cross-sectional and time series data
 """
 
-# pylint: disable-msg=E1101
-# pylint: disable-msg=E1103
+# pylint: disable-msg=E1101,E1103
 # pylint: disable-msg=W0703
 
 import itertools
+import sys
 
 from numpy import NaN, ndarray
 import numpy as np
@@ -314,6 +314,10 @@ class Series(np.ndarray, Picklable, Groupable):
         else:
             return '%s' % ndarray.__repr__(self)
 
+    def toString(self, buffer=sys.stdout, nanRep='NaN'):
+        print >> buffer, _seriesRepr(self.index, self.values(),
+                                     nanRep=nanRep)
+
     def __str__(self):
         return repr(self)
 
@@ -412,7 +416,7 @@ class Series(np.ndarray, Picklable, Groupable):
         y = np.array(self.values())
         mask = notnull(y)
         count = mask.sum()
-        y[-mask] = 0
+        np.putmask(y, -mask, 0)
 
         A = y.sum() / count
         B = (y**2).sum() / count  - A**2
@@ -817,8 +821,8 @@ class Series(np.ndarray, Picklable, Groupable):
         -------
         TimeSeries
         """
-        before = arg_before = datetools.to_datetime(before)
-        after = arg_after = datetools.to_datetime(after)
+        before = datetools.to_datetime(before)
+        after = datetools.to_datetime(after)
 
         if before is None:
             beg_slice = 0
@@ -993,7 +997,7 @@ class Series(np.ndarray, Picklable, Groupable):
         fillVec, mask = tseries.getMergeVec(self, other.index.indexMap)
 
         newValues = other.view(np.ndarray).take(fillVec)
-        newValues[-mask] = np.nan
+        np.putmask(newValues, -mask, np.nan)
 
         newSer = Series(newValues, index=self.index)
         return newSer
@@ -1022,40 +1026,31 @@ class Series(np.ndarray, Picklable, Groupable):
         if not isinstance(newIndex, Index):
             newIndex = Index(newIndex)
 
-        if fillMethod is None:
-            idxMap = self.index.indexMap
-
-            if self.dtype == float:
-                vals = tseries.reindex(newIndex, self, idxMap)
-            elif self.dtype == int:
-                # This could be unsafe, but NaN will not work in int arrays.
-                vals = tseries.reindex(newIndex, self.astype(float), idxMap)
-            else:
-                if self.dtype.type == np.object_:
-                    vals = tseries.reindexObj(newIndex, self, idxMap)
-                else:
-                    thisVals = self.values().astype(object)
-                    vals = tseries.reindexObj(newIndex, thisVals, idxMap)
-
-                    if not isnull(vals).any():
-                        vals = vals.astype(self.dtype)
-
-            return self.__class__(vals, index=newIndex)
-
         if len(self.index) == 0:
             return self.__class__.fromValue(NaN, index=newIndex)
 
-        oldMap = self.index.indexMap
-        newMap = newIndex.indexMap
-
-        fillMethod = fillMethod.upper()
+        if fillMethod is not None:
+            fillMethod = fillMethod.upper()
 
         # Cython for blazing speed
-        fillVec, mask = tseries.getFillVec(self.index, newIndex, oldMap,
-                                           newMap, kind=fillMethod)
+        fillVec, mask = tseries.getFillVec(self.index, newIndex,
+                                           self.index.indexMap,
+                                           newIndex.indexMap,
+                                           kind=fillMethod)
 
         newValues = self.values().take(fillVec)
-        newValues[-mask] = NaN
+
+        notmask = -mask
+        if issubclass(newValues.dtype.type, np.int_):
+            if notmask.any():
+                newValues = newValues.astype(float)
+                np.putmask(newValues, notmask, NaN)
+        elif issubclass(newValues.dtype.type, np.bool_):
+            if notmask.any():
+                newValues = newValues.astype(object)
+                np.putmask(newValues, notmask, NaN)
+        else:
+            np.putmask(newValues, notmask, NaN)
 
         return self.__class__(newValues, index=newIndex)
 
@@ -1097,9 +1092,9 @@ def remove_na(arr):
     """
     return arr[notnull(arr)]
 
-def _seriesRepr(index, vals):
+def _seriesRepr(index, vals, nanRep='NaN'):
     string_index = [str(x) for x in index]
-    maxlen = max(map(len, string_index))
+    maxlen = max(len(x) for x in string_index)
     padSpace = min(maxlen, 60)
 
     if vals.dtype == np.object_:
@@ -1108,7 +1103,7 @@ def _seriesRepr(index, vals):
     else:
         def _format(k, v):
             if isnull(v):
-                v = 'NaN'
+                v = nanRep
             else:
                 v = str(v)
 
diff --git a/pandas/core/tests/test_daterange.py b/pandas/core/tests/test_daterange.py
index 36172d857..68122ae90 100644
--- a/pandas/core/tests/test_daterange.py
+++ b/pandas/core/tests/test_daterange.py
@@ -1,3 +1,50 @@
-from pandas.core.daterange import DateRange
+from datetime import datetime
+import unittest
 
+import numpy as np
+
+from pandas.core.datetools import bday
+from pandas.core.daterange import DateRange, XDateRange
+from pandas.util.testing import assert_almost_equal
+
+####
+## XDateRange Tests
+####
+
+
+def eqXDateRange(kwargs, expected):
+    assert(np.array_equal(list(XDateRange(**kwargs)), expected))
+
+def testXDateRange1():
+    eqXDateRange(dict(fromDate = datetime(2009, 3, 25),
+                      nPeriods = 2),
+                 [datetime(2009, 3, 25), datetime(2009, 3, 26)])
+
+def testXDateRange2():
+    eqXDateRange(dict(fromDate = datetime(2008, 1, 1),
+                      toDate = datetime(2008, 1, 3)),
+                 [datetime(2008, 1, 1),
+                  datetime(2008, 1, 2),
+                  datetime(2008, 1, 3)])
+
+def testXDateRange3():
+    eqXDateRange(dict(fromDate = datetime(2008, 1, 5),
+                      toDate = datetime(2008, 1, 6)),
+                 [])
+
+
+class TestDateRange(unittest.TestCase):
+    pass
+
+
+# DateRange test
+
+def testDateRange1():
+    toDate = datetime(2009, 5, 13)
+    dr = DateRange(toDate=toDate, periods=20)
+    firstDate = toDate - 19 * bday
+
+    assert len(dr) == 20
+    assert dr[0] == firstDate
+    assert dr[-1] == toDate
 
diff --git a/pandas/core/tests/test_datetools.py b/pandas/core/tests/test_datetools.py
index ed10c21f2..f951addb4 100644
--- a/pandas/core/tests/test_datetools.py
+++ b/pandas/core/tests/test_datetools.py
@@ -3,10 +3,9 @@ import unittest
 
 from pandas.core.datetools import (
     bday, BDay, BQuarterEnd, BMonthEnd, BYearEnd, MonthEnd,
-    DateOffset, Week, YearBegin, YearEnd, Hour, Minute, Second)
-
-from pandas.core.daterange import XDateRange, DateRange
-import pandas.core.datetools as datetools
+    DateOffset, Week, YearBegin, YearEnd, Hour, Minute, Second,
+    format, ole2datetime, to_datetime, normalize_date,
+    getOffset, getOffsetName, inferTimeRule, hasOffsetName)
 
 from nose.tools import assert_raises
 
@@ -14,28 +13,28 @@ from nose.tools import assert_raises
 ## Misc function tests
 ####
 def test_format():
-    actual = datetools.format(datetime(2008, 1, 15))
+    actual = format(datetime(2008, 1, 15))
     assert actual == '20080115'
 
 def test_ole2datetime():
-    actual = datetools.ole2datetime(60000)
+    actual = ole2datetime(60000)
     assert actual == datetime(2064, 4, 8)
 
-    assert_raises(Exception, datetools.ole2datetime, 60)
+    assert_raises(Exception, ole2datetime, 60)
 
 def test_to_datetime1():
-    actual = datetools.to_datetime(datetime(2008, 1, 15))
+    actual = to_datetime(datetime(2008, 1, 15))
     assert actual == datetime(2008, 1, 15)
 
-    actual = datetools.to_datetime('20080115')
+    actual = to_datetime('20080115')
     assert actual == datetime(2008, 1, 15)
 
     # unparseable
     s = 'Month 1, 1999'
-    assert datetools.to_datetime(s) == s
+    assert to_datetime(s) == s
 
 def test_normalize_date():
-    actual = datetools.normalize_date(datetime(2007, 10, 1, 1, 12, 5, 10))
+    actual = normalize_date(datetime(2007, 10, 1, 1, 12, 5, 10))
     assert actual == datetime(2007, 10, 1)
 
 #####
@@ -210,7 +209,7 @@ class TestWeek(unittest.TestCase):
     def test_offset(self):
         tests = []
 
-        tests.append((datetools.week, # not business week
+        tests.append((Week(), # not business week
                       {datetime(2008, 1, 1): datetime(2008, 1, 8),
                        datetime(2008, 1, 4): datetime(2008, 1, 11),
                        datetime(2008, 1, 5): datetime(2008, 1, 12),
@@ -231,6 +230,11 @@ class TestWeek(unittest.TestCase):
                        datetime(2008, 1, 6): datetime(2008, 1, 7),
                        datetime(2008, 1, 7): datetime(2008, 1, 7)}))
 
+        tests.append((Week(-2, weekday=1), # n=0 -> roll forward. Mon
+                      {datetime(2010, 4, 6): datetime(2010, 3, 23),
+                       datetime(2010, 4, 8): datetime(2010, 3, 30),
+                       datetime(2010, 4, 5): datetime(2010, 3, 23)}))
+
         for dateOffset, cases in tests:
             for baseDate, expected in cases.iteritems():
                 assertEq(dateOffset, baseDate, expected)
@@ -507,14 +511,14 @@ class TestYearBegin(unittest.TestCase):
     def test_offset(self):
         tests = []
 
-        tests.append((datetools.YearBegin(),
+        tests.append((YearBegin(),
                       {datetime(2008, 1, 1): datetime(2009, 1, 1),
                        datetime(2008, 6, 30): datetime(2009, 1, 1),
                        datetime(2008, 12, 31): datetime(2009, 1, 1),
                        datetime(2005, 12, 30): datetime(2006, 1, 1),
                        datetime(2005, 12, 31): datetime(2006, 1, 1),}))
 
-        tests.append((datetools.YearBegin(0),
+        tests.append((YearBegin(0),
                       {datetime(2008, 1, 1): datetime(2008, 1, 1),
                        datetime(2008, 6, 30): datetime(2009, 1, 1),
                        datetime(2008, 12, 31): datetime(2009, 1, 1),
@@ -522,7 +526,7 @@ class TestYearBegin(unittest.TestCase):
                        datetime(2005, 12, 31): datetime(2006, 1, 1),}))
 
 
-        tests.append((datetools.YearBegin(-1),
+        tests.append((YearBegin(-1),
                       {datetime(2007, 1, 1): datetime(2006, 1, 1),
                        datetime(2008, 6, 30): datetime(2008, 1, 1),
                        datetime(2008, 12, 31): datetime(2008, 1, 1),
@@ -530,7 +534,7 @@ class TestYearBegin(unittest.TestCase):
                        datetime(2006, 12, 30): datetime(2006, 1, 1),
                        datetime(2007, 1, 1): datetime(2006, 1, 1),}))
 
-        tests.append((datetools.YearBegin(-2),
+        tests.append((YearBegin(-2),
                       {datetime(2007, 1, 1): datetime(2005, 1, 1),
                        datetime(2008, 6, 30): datetime(2007, 1, 1),
                        datetime(2008, 12, 31): datetime(2007, 1, 1),}))
@@ -718,72 +722,36 @@ def test_inferTimeRule():
               datetime(2010, 3, 27, 0, 0),
               datetime(2010, 3, 29, 0, 0)]
 
-    assert datetools.inferTimeRule(index1) == 'EOM'
-    assert datetools.inferTimeRule(index2) == 'WEEKDAY'
+    assert inferTimeRule(index1) == 'EOM'
+    assert inferTimeRule(index2) == 'WEEKDAY'
 
-    assert_raises(Exception, datetools.inferTimeRule, index1[:2])
-    assert_raises(Exception, datetools.inferTimeRule, index3)
+    assert_raises(Exception, inferTimeRule, index1[:2])
+    assert_raises(Exception, inferTimeRule, index3)
 
 def test_hasOffsetName():
-    assert datetools.hasOffsetName(BDay())
-    assert not datetools.hasOffsetName(BDay(2))
+    assert hasOffsetName(BDay())
+    assert not hasOffsetName(BDay(2))
 
 def test_getOffsetName():
-    assert_raises(Exception, datetools.getOffsetName, BDay(2))
+    assert_raises(Exception, getOffsetName, BDay(2))
 
-    assert datetools.getOffsetName(BDay()) == 'WEEKDAY'
-    assert datetools.getOffsetName(BMonthEnd()) == 'EOM'
-    assert datetools.getOffsetName(Week(weekday=0)) == 'W@MON'
-    assert datetools.getOffsetName(Week(weekday=1)) == 'W@TUE'
-    assert datetools.getOffsetName(Week(weekday=2)) == 'W@WED'
-    assert datetools.getOffsetName(Week(weekday=3)) == 'W@THU'
-    assert datetools.getOffsetName(Week(weekday=4)) == 'W@FRI'
+    assert getOffsetName(BDay()) == 'WEEKDAY'
+    assert getOffsetName(BMonthEnd()) == 'EOM'
+    assert getOffsetName(Week(weekday=0)) == 'W@MON'
+    assert getOffsetName(Week(weekday=1)) == 'W@TUE'
+    assert getOffsetName(Week(weekday=2)) == 'W@WED'
+    assert getOffsetName(Week(weekday=3)) == 'W@THU'
+    assert getOffsetName(Week(weekday=4)) == 'W@FRI'
 
 
 def test_getOffset():
-    assert_raises(Exception, datetools.getOffset, 'gibberish')
-
-    assert datetools.getOffset('WEEKDAY') == BDay()
-    assert datetools.getOffset('EOM') == BMonthEnd()
-    assert datetools.getOffset('W@MON') == Week(weekday=0)
-    assert datetools.getOffset('W@TUE') == Week(weekday=1)
-    assert datetools.getOffset('W@WED') == Week(weekday=2)
-    assert datetools.getOffset('W@THU') == Week(weekday=3)
-    assert datetools.getOffset('W@FRI') == Week(weekday=4)
-
-####
-## XDateRange Tests
-####
-def eqXDateRange(kwargs, expected):
-    actual = list(XDateRange(**kwargs))
-    assert actual == expected
-
-def testXDateRange1():
-    eqXDateRange(dict(fromDate = datetime(2009, 3, 25),
-                      nPeriods = 2),
-                 [datetime(2009, 3, 25), datetime(2009, 3, 26)])
-
-def testXDateRange2():
-    eqXDateRange(dict(fromDate = datetime(2008, 1, 1),
-                      toDate = datetime(2008, 1, 3)),
-                 [datetime(2008, 1, 1),
-                  datetime(2008, 1, 2),
-                  datetime(2008, 1, 3)])
-
-def testXDateRange3():
-    eqXDateRange(dict(fromDate = datetime(2008, 1, 5),
-                      toDate = datetime(2008, 1, 6)),
-                 [])
-
-
-
-# DateRange test
+    assert_raises(Exception, getOffset, 'gibberish')
 
-def testDateRange1():
-    toDate = datetime(2009, 5, 13)
-    dr = DateRange(toDate=toDate, periods=20)
-    firstDate = toDate - 19 * bday
+    assert getOffset('WEEKDAY') == BDay()
+    assert getOffset('EOM') == BMonthEnd()
+    assert getOffset('W@MON') == Week(weekday=0)
+    assert getOffset('W@TUE') == Week(weekday=1)
+    assert getOffset('W@WED') == Week(weekday=2)
+    assert getOffset('W@THU') == Week(weekday=3)
+    assert getOffset('W@FRI') == Week(weekday=4)
 
-    assert len(dr) == 20
-    assert dr[0] == firstDate
-    assert dr[-1] == toDate
diff --git a/pandas/core/tests/test_frame.py b/pandas/core/tests/test_frame.py
index 2887664fa..b8916b200 100644
--- a/pandas/core/tests/test_frame.py
+++ b/pandas/core/tests/test_frame.py
@@ -8,8 +8,8 @@ import unittest
 from numpy import random
 import numpy as np
 
-from pandas.core.api import DataFrame, Index, Series, notnull
 import pandas.core.datetools as datetools
+from pandas.core.api import DataFrame, Index, Series, notnull
 
 from pandas.util.testing import (assert_almost_equal,
                                  assert_series_equal,
@@ -174,6 +174,9 @@ class TestDataFrame(unittest.TestCase):
         self.assertRaises(Exception, self.klass, mat, index=[1])
         self.assertRaises(Exception, self.klass, mat, columns=['A', 'B', 'C'])
 
+        # weird case that used to succeed
+        self.assertRaises(Exception, self.klass, [], [])
+
     def test_pickle(self):
         import cPickle as pickle
 
@@ -893,6 +896,13 @@ class TestDataFrame(unittest.TestCase):
         self.assertEqual(len(aggregated), 5)
         self.assertEqual(len(aggregated.cols()), 4)
 
+        # by string
+        tscopy = self.tsframe.copy()
+        tscopy['weekday'] = [x.weekday() for x in tscopy.index]
+        stragged = tscopy.groupby('weekday').aggregate(np.mean)
+        del stragged['weekday']
+        assert_frame_equal(stragged, aggregated)
+
         # transform
         transformed = grouped.transform(lambda x: x - x.mean())
         self.assertEqual(len(aggregated), 5)
@@ -1105,7 +1115,10 @@ class TestDataFrame(unittest.TestCase):
         self._check_statistic(self.frame, 'sum', f)
 
     def test_sum_object(self):
-        deltas = self.frame.apply(lambda x: x.astype(int)) * timedelta(1)
+        values = self.frame.values.astype(int)
+        frame = self.klass(values, index=self.frame.index,
+                           columns=self.frame.cols())
+        deltas = frame * timedelta(1)
         deltas.sum()
 
     def test_product(self):
diff --git a/pandas/core/tests/test_matrix.py b/pandas/core/tests/test_matrix.py
index ff9491588..8f46cbe9d 100644
--- a/pandas/core/tests/test_matrix.py
+++ b/pandas/core/tests/test_matrix.py
@@ -6,7 +6,7 @@ import unittest
 from numpy.random import randn
 import numpy as np
 
-from pandas.core.api import Series, DataMatrix, DataFrame
+from pandas.core.api import Index, Series, DataMatrix, DataFrame
 
 import pandas.util.testing as common
 import test_frame
@@ -184,6 +184,12 @@ class TestDataMatrix(test_frame.TestDataFrame):
         reindexed = self.mixed_frame.reindex(columns=['A', 'B'])
         self.assert_('foo' not in reindexed)
 
+    def test_reindex_corner(self):
+        index = Index(['a', 'b', 'c'])
+        dm = self.empty.reindex(index=[1, 2, 3])
+        reindexed = dm.reindex(columns=index)
+        self.assert_(reindexed.columns.equals(index))
+
     def test_fill_corner(self):
         self.mixed_frame['foo'][5:20] = np.NaN
         self.mixed_frame['A'][-10:] = np.NaN
diff --git a/pandas/core/tests/test_series.py b/pandas/core/tests/test_series.py
index d21496522..57d2d1cf5 100644
--- a/pandas/core/tests/test_series.py
+++ b/pandas/core/tests/test_series.py
@@ -7,7 +7,7 @@ import unittest
 
 import numpy as np
 
-from pandas.core.api import (Index, Series, TimeSeries, DataFrame)
+from pandas.core.api import (Index, Series, TimeSeries, DataFrame, isnull)
 import pandas.core.datetools as datetools
 from pandas.util.testing import assert_series_equal
 import pandas.util.testing as common
@@ -603,6 +603,20 @@ class TestSeries(unittest.TestCase):
         reindexed = self.ts.reindex(list(self.ts.index))
         assert_series_equal(self.ts, reindexed)
 
+    def test_reindex_int(self):
+        ts = self.ts[::2]
+        int_ts = Series(np.zeros(len(ts), dtype=int), index=ts.index)
+
+        # this should work fine
+        reindexed_int = int_ts.reindex(self.ts.index)
+
+        # if NaNs introduced
+        self.assert_(reindexed_int.dtype == np.float_)
+
+        # NO NaNs introduced
+        reindexed_int = int_ts.reindex(int_ts.index[::2])
+        self.assert_(reindexed_int.dtype == np.int_)
+
     def test_reindex_bool(self):
 
         # A series other than float, int, string, or object
@@ -619,13 +633,12 @@ class TestSeries(unittest.TestCase):
         reindexed_bool = bool_ts.reindex(bool_ts.index[::2])
         self.assert_(reindexed_bool.dtype == np.bool_)
 
-    @np.testing.decorators.knownfailureif(True)
     def test_reindex_bool_pad(self):
         # fail
         ts = self.ts[5:]
         bool_ts = Series(np.zeros(len(ts), dtype=bool), index=ts.index)
         filled_bool = bool_ts.reindex(self.ts.index, fillMethod='pad')
-        self.assert_(filled_bool.dtype == np.object_)
+        self.assert_(isnull(filled_bool[:5]).all())
 
     def test_preserveRefs(self):
         sl = self.ts[5:10]
@@ -751,6 +764,33 @@ class TestSeries(unittest.TestCase):
         agged = grouped.aggregate({'one' : np.mean,
                                    'two' : np.std})
 
+        group_constants = {
+            0 : 10,
+            1 : 20,
+            2 : 30
+        }
+        agged = grouped.agg(lambda x: group_constants[x.groupName] + x.mean())
+        self.assertEqual(agged[1], 21)
+
+        # corner cases
+        self.assertRaises(Exception, grouped._aggregate_named,
+                          lambda x: x * 2)
+
+    def test_groupby_transform(self):
+        data = Series(np.arange(9) / 3, index=np.arange(9))
+
+        index = np.arange(9)
+        np.random.shuffle(index)
+        data = data.reindex(index)
+
+        grouped = data.groupby(lambda x: x // 3)
+
+        transformed = grouped.transform(lambda x: x * x.sum())
+        self.assertEqual(transformed[7], 12)
+
+        # corner cases
+        self.assertRaises(Exception, grouped.transform,
+                          lambda x: x.mean())
 
 if __name__ == '__main__':
     unittest.main()
diff --git a/pandas/lib/bench.py b/pandas/lib/bench.py
new file mode 100644
index 000000000..251da5cfa
--- /dev/null
+++ b/pandas/lib/bench.py
@@ -0,0 +1,176 @@
+import time
+
+import numpy as np
+
+from pandas import Series, Index, isnull
+import pandas.lib.tseries as tseries
+from pandas.util.testing import assert_almost_equal, assert_dict_equal
+
+def _timeit(f, n=10):
+    _s = time.clock()
+    for i in xrange(n):
+        f()
+
+    return (time.clock() - _s) / n
+
+def bench_reindex():
+    K = 100000
+    index = Index(np.arange(K))
+    values = np.arange(float(K))
+    obj_vals = values.astype(object)
+
+    new_index = np.arange(K)
+    np.random.shuffle(new_index)
+    new_index = Index(new_index)
+
+    f = lambda: tseries.reindex(new_index, values, index.indexMap)
+    print 'tseries.reindex: %.2f ms per iteration' % (_timeit(f, n=50) * 1000)
+
+    def _test():
+        filler, mask = tseries.getMergeVec(new_index, index.indexMap)
+        result = values.take(filler)
+        np.putmask(result, -mask, np.NaN)
+
+        return result
+
+    timing = _timeit(_test, n=50) * 1000
+    print 'getMergeVec method: %.2f ms per iteration' % timing
+
+    f2 = lambda: tseries.reindexObj(new_index, values, index.indexMap)
+    print ('tseries.reindexObj with floats: %.2f ms per iteration'
+           % (_timeit(f2, n=50) * 1000))
+
+    f3 = lambda: tseries.reindexObj(new_index, obj_vals, index.indexMap)
+    print ('tseries.reindexObj with objects: %.2f ms per iteration'
+           % (_timeit(f3, n=50) * 1000))
+
+    f4 = lambda: tseries.reindexObject(new_index, obj_vals, index.indexMap)
+    print ('tseries.reindexObject buffers: %.2f ms per iteration'
+           % (_timeit(f4, n=50) * 1000))
+
+    def _test2():
+        filler, mask = tseries.getMergeVec(new_index, index.indexMap)
+        result = obj_vals.take(filler)
+        np.putmask(result, -mask, np.NaN)
+
+        return result
+
+    timing = _timeit(_test2, n=50) * 1000
+    print 'getMergeVec method: %.2f ms per iteration' % timing
+
+    assert_almost_equal(_test(), f())
+    assert_almost_equal(f2(), f3())
+    assert_almost_equal(f3(), f4())
+    assert_almost_equal(f2(), f4())
+    assert_almost_equal(f2(), _test2())
+
+
+def _isnan(obj):
+    return obj != obj
+
+def test_groupby():
+    mapping = Series({
+        1 : 2.,
+        2 : 2.,
+        3 : np.NaN,
+        4 : np.NaN,
+        5 : 3.,
+        6 : 3.,
+        7 : np.NaN
+    })
+
+    index = Index([1, 2, 3, 4, 5, 6, 7])
+
+    expected = {
+        2 : [1, 2],
+        3 : [5, 6],
+        np.NaN : [3, 4, 7]
+    }
+
+    def compare_with_null(d1, d2):
+        d1_nulls = None
+        d2_nulls = None
+        for k, v in d1.iteritems():
+            if _isnan(k):
+                d1_nulls = v
+            else:
+                assert(k in d2)
+                assert(np.array_equal(v, d2[k]))
+
+        for k, v in d2.iteritems():
+            if _isnan(k):
+                d2_nulls = v
+            else:
+                assert(k in d1)
+
+        if d1_nulls is not None or d2_nulls is not None:
+            assert(np.array_equal(d1_nulls, d2_nulls))
+
+    grouped = tseries.groupby(index, mapping.get)
+    compare_with_null(grouped, expected)
+
+def groupby_nocython(index, mapper, output=None):
+    if output is None:
+        result = {}
+    else:
+        result = output
+
+    index = np.asarray(index)
+    mapped_index = np.array([mapper(x) for x in index])
+
+    # A little hack here
+    if issubclass(mapped_index.dtype.type, basestring):
+        mapped_index = mapped_index.astype(object)
+
+    mask = isnull(mapped_index)
+    nullkeys = index[mask]
+
+    if nullkeys is not None and len(nullkeys) > 0:
+        result[np.NaN] = nullkeys
+
+    notmask = -mask
+    index = index[notmask]
+    mapped_index = mapped_index[notmask]
+
+    for idx, key in zip(index, mapped_index):
+        result.setdefault(key, []).append(idx)
+
+    return result
+
+def bench_groupby():
+    N = 200
+
+    arr = np.arange(10000).astype(object)
+    values = np.random.randn(10000)
+    keys = arr // 10
+    d = dict(zip(arr, keys))
+
+    f = lambda: groupby_nocython(arr, d.get)
+    print 'no cython: %.2f ms per iteration' % (_timeit(f, n=N) * 1000)
+
+    f = lambda: tseries.arrmap(arr, d.get)
+    timing = _timeit(f, n=N) * 1000
+    print 'arrmap: %.2f ms per iteration' % timing
+
+    f = lambda: isnull(tseries.arrmap(arr, d.get))
+    print 'isnull: %.2f ms per iteration' % (_timeit(f, n=N) * 1000 - timing)
+
+    f = lambda: tseries.groupby(arr, d.get)
+    print 'groupby: %.2f ms per iteration' % (_timeit(f, n=N) * 1000)
+
+    f = lambda: tseries.groupby_indices(arr, d.get)
+    print 'groupby_inds: %.2f ms per iteration' % (_timeit(f, n=N) * 1000)
+
+    def _test():
+        groups = tseries.groupby_indices(arr, d.get)
+
+        result = {}
+        for k, v in groups.iteritems():
+            result[k] = np.mean(values.take(v))
+
+        return result
+
+    print 'test: %.2f ms per iteration' % (_timeit(_test, n=N) * 1000)
+
+def bench_map_indices():
+    pass
diff --git a/pandas/lib/src/groupby.pyx b/pandas/lib/src/groupby.pyx
index 8537cde26..595f3a731 100644
--- a/pandas/lib/src/groupby.pyx
+++ b/pandas/lib/src/groupby.pyx
@@ -2,6 +2,9 @@
 #-------------------------------------------------------------------------------
 # Groupby-related functions
 
+cdef inline _isnan(object o):
+    return o != o
+
 @cython.boundscheck(False)
 def arrmap(ndarray[object, ndim=1] index, object func):
     cdef int length = index.shape[0]
@@ -10,268 +13,77 @@ def arrmap(ndarray[object, ndim=1] index, object func):
     cdef ndarray[object, ndim=1] result = np.empty(length, dtype=np.object_)
 
     for i from 0 <= i < length:
-        result[i] = func(index[i])
+        result[i] = trycall(func, index[i])
 
     return result
 
 @cython.boundscheck(False)
-def groupby_withnull_old(ndarray[object, ndim = 1] index, object keyfunc):
-    cdef dict groups
-    cdef int length = index.shape[0]
-    cdef object idx
-    cdef object curKey, key
-    cdef list members
-
-    groups = PyDict_New()
-
-    if length != index.shape[0]:
-        raise Exception('Dates and values were not the same length!')
-
-    cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
-
-    cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
-
-    bool_mask = null_mask.astype(bool)
-
-    null_values = np.asarray(index)[bool_mask]
-
-    if null_values.any():
-        PyDict_SetItem(groups, np.NaN, null_values)
-
-    cdef int i = 0
-    idx = index[0]
-    key = mapped_index[0]
-
-    # Algorithm notes
-    #   - Tries to reduce the number of calls to PyDict_GetItem,
-    #   'lazily' evaluates
-
-    while i < length:
-        if not PyDict_Contains(groups, key):
-            members = [idx]
-            PyDict_SetItem(groups, key, members)
-            i += 1
-            curKey = key
-            while i < length:
-                if null_mask[i]:
-                    i += 1
-                    continue
-
-                idx = index[i]
-                key = mapped_index[i]
-                if key == curKey:
-                    members.append(idx)
-                    i += 1
-                else:
-                    break
-        else:
-            members = <list> PyDict_GetItem(groups, key)
-            members.append(idx)
-            i += 1
-            curKey = key
-            while null_mask[i] and i < length:
-                i += 1
-
-            while i < length:
-                if null_mask[i]:
-                    i += 1
-                    continue
-
-                idx = index[i]
-                key = mapped_index[i]
-                if key == curKey:
-                    members.append(idx)
-                    i += 1
-                else:
-                    break
-
-    return groups
-
-@cython.boundscheck(False)
-def groupby_withnull(ndarray[object, ndim = 1] index, object keyfunc):
-    cdef dict groups
-    cdef int length = index.shape[0]
-    cdef object idx
-    cdef object curKey, key
+def groupby(object index, object mapper, output=None):
+    cdef dict result
+    cdef ndarray[object, ndim=1] mapped_index
+    cdef ndarray[object, ndim=1] index_buf
+    cdef ndarray[int8_t, ndim=1] mask
+    cdef int i, length
     cdef list members
+    cdef object idx, key
 
-    groups = PyDict_New()
-
-    if length != index.shape[0]:
-        raise Exception('Dates and values were not the same length!')
-
-    cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
-
-    cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
+    length = len(index)
 
-    bool_mask = null_mask.astype(bool)
+    if output is None:
+        result = {}
+    else:
+        result = <dict> output
 
-    null_values = np.asarray(index)[bool_mask]
+    index_buf = np.asarray(index)
+    mapped_index = arrmap(index_buf, mapper)
 
-    if null_values.any():
-        PyDict_SetItem(groups, np.NaN, null_values)
+    mask = _isnullobj(mapped_index)
+    nullkeys = index_buf[mask.astype(bool)]
 
-    cdef int i = 0
-    idx = index[0]
-    key = mapped_index[0]
-
-    # Algorithm notes
-    #   - Tries to reduce the number of calls to PyDict_GetItem,
-    #   'lazily' evaluates
+    if nullkeys.any():
+        result[np.NaN] = nullkeys
 
-    while i < length:
-        if key not in groups:
-            members = [idx]
-            groups[key] = members
-            i += 1
-            curKey = key
-            while i < length:
-                if null_mask[i]:
-                    i += 1
-                    continue
-
-                idx = index[i]
-                key = mapped_index[i]
-                if key == curKey:
-                    members.append(idx)
-                    i += 1
-                else:
-                    break
-        else:
-            members = <list> groups[key]
+    for i from 0 <= i < length:
+        if mask[i]:
+            continue
+        key = mapped_index[i]
+        idx = index_buf[i]
+        if key in result:
+            members = result[key]
             members.append(idx)
-            i += 1
-            curKey = key
-            while null_mask[i] and i < length:
-                i += 1
-
-            while i < length:
-                if null_mask[i]:
-                    i += 1
-                    continue
-
-                idx = index[i]
-                key = mapped_index[i]
-                if key == curKey:
-                    members.append(idx)
-                    i += 1
-                else:
-                    break
-
-    return groups
-
-@cython.boundscheck(False)
-def groupby(ndarray[object, ndim = 1] index, object keyfunc):
-    cdef dict groups
-    cdef int length = index.shape[0]
-    cdef object idx
-    cdef object curKey, key
-    cdef list members
-
-    groups = PyDict_New()
-
-    if length != index.shape[0]:
-        raise Exception('Dates and values were not the same length!')
-
-    cdef int i = 0
-    idx = index[i]
-    key = keyfunc(idx)
-
-    # Algorithm notes
-    #   - Tries to reduce the number of calls to PyDict_GetItem, 'lazily' evaluates
-
-    while i < length:
-        if not PyDict_Contains(groups, key):
-            members = [idx]
-            PyDict_SetItem(groups, key, members)
-            i += 1
-            curKey = key
-            while i < length:
-                idx = index[i]
-                key = trycall(keyfunc, idx)
-                if key == curKey:
-                    members.append(idx)
-                    i += 1
-                else:
-                    break
         else:
-            members = <list> PyDict_GetItem(groups, key)
-            members.append(idx)
-            i += 1
-            curKey = key
-            while i < length:
-                idx = index[i]
-                key = trycall(keyfunc, idx)
-                if key == curKey:
-                    members.append(idx)
-                    i += 1
-                else:
-                    break
+            result[key] = [idx]
 
-    return groups
+    return result
 
 @cython.boundscheck(False)
-def groupbyfunc(ndarray[object, ndim = 1] index,
-                ndarray[npy_float64, ndim = 1] values,
-                object keyfunc, object applyfunc):
-    '''
-    Doing this proper in Cython
-    Not sure how much it will really speed things up
-    '''
-    cdef dict groups
-    cdef int length = values.shape[0]
-    cdef object idx
-    cdef object curKey, key
-    cdef list members, grouplist
+def groupby_indices(object index, object mapper):
+    cdef dict result
+    cdef ndarray[object, ndim=1] mapped_index
+    cdef ndarray[int8_t, ndim=1] mask
+    cdef int i, length
+    cdef list members, null_list
+    cdef object key
 
-    groups = PyDict_New()
+    length = len(index)
 
-    if length != index.shape[0]:
-        raise Exception('Dates and values were not the same length!')
+    result = {}
+    index = np.asarray(index)
+    mapped_index = arrmap(index, mapper)
 
-    cdef int i = 0
-    idx = index[i]
-    key = trycall(keyfunc, idx)
-
-    # Algorithm notes
-    #   - Tries to reduce the number of calls to PyDict_GetItem,
-    #   'lazily' evaluates
-
-    while i < length:
-        if not PyDict_Contains(groups, key):
-            members = [values[i]]
-            PyDict_SetItem(groups, key, members)
-            i += 1
-            curKey = key
-            while i < length:
-                idx = index[i]
-                key = trycall(keyfunc, idx)
-                if key == curKey:
-                    members.append(values[i])
-                    i += 1
-                else:
-                    break
-        else:
-            members = <list> PyDict_GetItem(groups, key)
-            members.append(values[i])
-            i += 1
-            curKey = key
-            while i < length:
-                idx = index[i]
-                key = trycall(keyfunc, idx)
-                if key == curKey:
-                    members.append(values[i])
-                    i += 1
-                else:
-                    break
+    mask = _isnullobj(mapped_index)
 
-    grouplist = PyDict_Keys(groups)
+    if mask.astype(bool).any():
+        null_list = []
+        result[np.NaN] = null_list
 
-    i = 0
-    length = len(grouplist)
     for i from 0 <= i < length:
-        key = grouplist[i]
-        members = <list> PyDict_GetItem(groups, key)
-        PyDict_SetItem(groups, key, applyfunc(np.asarray(members)))
+        if mask[i]:
+            null_list.append(i)
+        key = mapped_index[i]
+        if key in result:
+            (<list> result[key]).append(i)
+        else:
+            result[key] = [i]
 
-    return groups
+    return result
diff --git a/pandas/lib/src/reindex.pyx b/pandas/lib/src/reindex.pyx
index 5ee9eb033..87c52623a 100644
--- a/pandas/lib/src/reindex.pyx
+++ b/pandas/lib/src/reindex.pyx
@@ -1,113 +1,4 @@
 
-def reindex(ndarray index, ndarray arr, dict idxMap):
-    '''
-    Using the provided new index, a given array, and a mapping of index-value
-    correpondences in the value array, return a new ndarray conforming to
-    the new index.
-
-    This is significantly faster than doing it in pure Python.
-    '''
-    cdef ndarray result
-    cdef double *result_data
-    cdef int i, length
-    cdef flatiter itera, iteridx
-    cdef double nan
-    cdef object idx
-
-    nan = <double> np.NaN
-
-    length = PyArray_SIZE(index)
-
-    result = <ndarray> np.empty(length, np.float64)
-
-    result_data = <double *> result.data
-
-    itera = <flatiter> PyArray_IterNew(arr)
-    iteridx = <flatiter> PyArray_IterNew(index)
-
-    for i from 0 <= i < length:
-        idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
-        PyArray_ITER_NEXT(iteridx)
-        if idx not in idxMap:
-            result_data[i] = nan
-            continue
-        PyArray_ITER_GOTO1D(itera, idxMap[idx])
-        result_data[i] = (<double *>PyArray_ITER_DATA(itera))[0]
-
-    return result
-
-def reindexObj(ndarray index, ndarray arr, dict idxMap):
-    '''
-    Using the provided new index, a given array, and a mapping of index-value
-    correpondences in the value array, return a new ndarray conforming to
-    the new index.
-
-    This is significantly faster than doing it in pure Python.
-    '''
-    cdef ndarray result
-    cdef int i, length
-    cdef flatiter itera, iteridx, iterresult
-    cdef object idx, nan, obj
-
-    nan = np.NaN
-    length = PyArray_SIZE(index)
-
-    result = <ndarray> np.empty(length, dtype=np.object_)
-
-    itera = <flatiter> PyArray_IterNew(arr)
-    iteridx = <flatiter> PyArray_IterNew(index)
-    iterresult = <flatiter> PyArray_IterNew(result)
-
-    cdef int res
-
-    for i from 0 <= i < length:
-        idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
-        PyArray_ITER_NEXT(iteridx)
-
-        if idx not in idxMap:
-            PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), nan)
-            PyArray_ITER_NEXT(iterresult)
-            continue
-
-        PyArray_ITER_GOTO1D(itera, idxMap[idx])
-        obj = PyArray_GETITEM(arr, PyArray_ITER_DATA(itera))
-
-        res = PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), obj)
-        PyArray_ITER_NEXT(iterresult)
-
-    return result
-
-@cython.boundscheck(False)
-def reindexObject(ndarray[object, ndim=1] index,
-                  ndarray[object, ndim=1] arr,
-                  dict idxMap):
-    '''
-    Using the provided new index, a given array, and a mapping of index-value
-    correpondences in the value array, return a new ndarray conforming to
-    the new index.
-
-    Returns
-    -------
-    ndarray
-    '''
-    cdef ndarray[object, ndim = 1] result
-    cdef int i, loc, length
-    cdef object idx, value
-    cdef object nan = np.NaN
-
-    length = index.shape[0]
-    result = np.empty(length, dtype=object)
-
-    for i from 0 <= i < length:
-        idx = index[i]
-        if idx not in idxMap:
-            result[i] = nan
-            continue
-
-        result[i] = arr[idxMap[idx]]
-
-    return result
-
 cdef tuple _backfill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
     '''
     Backfilling logic for generating fill vector
@@ -340,7 +231,7 @@ cdef tuple _pad(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
 def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,
                object kind):
 
-    if kind == '':
+    if kind is None:
         fillVec, maskVec = getMergeVec(newIndex, oldMap)
     elif kind == 'PAD':
         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
diff --git a/pandas/lib/src/tseries.c b/pandas/lib/src/tseries.c
index 9599e66ec..80eb0070b 100644
--- a/pandas/lib/src/tseries.c
+++ b/pandas/lib/src/tseries.c
@@ -1,4 +1,4 @@
-/* Generated by Cython 0.12.1 on Sun Apr  4 23:21:28 2010 */
+/* Generated by Cython 0.12.1 on Tue Apr 06 13:59:48 2010 */
 
 #define PY_SSIZE_T_CLEAN
 #include "Python.h"
@@ -384,7 +384,7 @@ typedef npy_cdouble __pyx_t_5numpy_complex_t;
 
 typedef double (*__pyx_t_7tseries_double_func)(double, double);
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":43
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":43
  * NIL = Node(np.inf, [], np.array([])) # Singleton terminator node
  * 
  * cdef class IndexableSkiplist:             # <<<<<<<<<<<<<<
@@ -399,7 +399,7 @@ struct __pyx_obj_7tseries_IndexableSkiplist {
   struct __pyx_obj_7tseries_Node *head;
 };
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":25
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":25
  * import_array()
  * 
  * cdef class Node:             # <<<<<<<<<<<<<<
@@ -648,8 +648,6 @@ static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/
 
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/
 
-static CYTHON_INLINE npy_intp __Pyx_PyInt_from_py_npy_intp(PyObject *);
-
 static CYTHON_INLINE npy_int32 __Pyx_PyInt_from_py_npy_int32(PyObject *);
 
 #if CYTHON_CCOMPLEX
@@ -825,6 +823,7 @@ static __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *)
 static PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *, int __pyx_skip_dispatch); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *); /*proto*/
 static PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *); /*proto*/
+static CYTHON_INLINE PyObject *__pyx_f_7tseries__isnan(PyObject *); /*proto*/
 static PyObject *__pyx_f_7tseries__backfill(PyArrayObject *, PyArrayObject *, PyObject *, PyObject *); /*proto*/
 static PyObject *__pyx_f_7tseries__pad(PyArrayObject *, PyArrayObject *, PyObject *, PyObject *); /*proto*/
 static double __pyx_f_7tseries___add(double, double); /*proto*/
@@ -839,10 +838,9 @@ static double __pyx_f_7tseries___pow(double, double); /*proto*/
 static PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func, PyArrayObject *, PyObject *, PyObject *, PyObject *, PyObject *); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_object = { "Python object", NULL, sizeof(PyObject *), 'O' };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn_npy_int8 = { "numpy.npy_int8", NULL, sizeof(npy_int8), 'I' };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn_npy_float64 = { "numpy.npy_float64", NULL, sizeof(npy_float64), 'R' };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t = { "numpy.int8_t", NULL, sizeof(__pyx_t_5numpy_int8_t), 'I' };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_double_t = { "numpy.double_t", NULL, sizeof(__pyx_t_5numpy_double_t), 'R' };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t = { "numpy.int32_t", NULL, sizeof(__pyx_t_5numpy_int32_t), 'I' };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t = { "numpy.int8_t", NULL, sizeof(__pyx_t_5numpy_int8_t), 'I' };
 #define __Pyx_MODULE_NAME "tseries"
 int __pyx_module_is_main_tseries = 0;
 
@@ -853,21 +851,18 @@ static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_min;
 static PyObject *__pyx_builtin_KeyError;
 static PyObject *__pyx_builtin_max;
-static PyObject *__pyx_builtin_object;
 static PyObject *__pyx_builtin_RuntimeError;
 static char __pyx_k_1[] = "Error calling func on index %s";
 static char __pyx_k_2[] = "Tried to use data field on non-contiguous array!";
 static char __pyx_k_3[] = "Not Found";
-static char __pyx_k_4[] = "Dates and values were not the same length!";
-static char __pyx_k_5[] = "";
-static char __pyx_k_6[] = "Don't recognize fillMethod: %s";
-static char __pyx_k_7[] = "bad funcname requested of Cython code";
-static char __pyx_k_8[] = "ndarray is not C contiguous";
-static char __pyx_k_9[] = "ndarray is not Fortran contiguous";
-static char __pyx_k_10[] = "Non-native byte order not supported";
-static char __pyx_k_11[] = "unknown dtype code in numpy.pxd (%d)";
-static char __pyx_k_12[] = "Format string allocated too short, see comment in numpy.pxd";
-static char __pyx_k_13[] = "Format string allocated too short.";
+static char __pyx_k_4[] = "Don't recognize fillMethod: %s";
+static char __pyx_k_5[] = "bad funcname requested of Cython code";
+static char __pyx_k_6[] = "ndarray is not C contiguous";
+static char __pyx_k_7[] = "ndarray is not Fortran contiguous";
+static char __pyx_k_8[] = "Non-native byte order not supported";
+static char __pyx_k_9[] = "unknown dtype code in numpy.pxd (%d)";
+static char __pyx_k_10[] = "Format string allocated too short, see comment in numpy.pxd";
+static char __pyx_k_11[] = "Format string allocated too short.";
 static char __pyx_k__B[] = "B";
 static char __pyx_k__H[] = "H";
 static char __pyx_k__I[] = "I";
@@ -893,7 +888,6 @@ static char __pyx_k__NIL[] = "NIL";
 static char __pyx_k__NaN[] = "NaN";
 static char __pyx_k__PAD[] = "PAD";
 static char __pyx_k__any[] = "any";
-static char __pyx_k__arr[] = "arr";
 static char __pyx_k__buf[] = "buf";
 static char __pyx_k__com[] = "com";
 static char __pyx_k__get[] = "get";
@@ -943,12 +937,12 @@ static char __pyx_k__arrmap[] = "arrmap";
 static char __pyx_k__astype[] = "astype";
 static char __pyx_k__fields[] = "fields";
 static char __pyx_k__format[] = "format";
-static char __pyx_k__idxMap[] = "idxMap";
 static char __pyx_k__insert[] = "insert";
 static char __pyx_k__isnull[] = "isnull";
+static char __pyx_k__mapper[] = "mapper";
 static char __pyx_k__newMap[] = "newMap";
-static char __pyx_k__object[] = "object";
 static char __pyx_k__oldMap[] = "oldMap";
+static char __pyx_k__output[] = "output";
 static char __pyx_k__random[] = "random";
 static char __pyx_k__remove[] = "remove";
 static char __pyx_k__values[] = "values";
@@ -958,10 +952,8 @@ static char __pyx_k____div__[] = "__div__";
 static char __pyx_k____mul__[] = "__mul__";
 static char __pyx_k____pow__[] = "__pow__";
 static char __pyx_k____sub__[] = "__sub__";
-static char __pyx_k___nofill[] = "_nofill";
 static char __pyx_k__asarray[] = "asarray";
 static char __pyx_k__float64[] = "float64";
-static char __pyx_k__keyfunc[] = "keyfunc";
 static char __pyx_k__object_[] = "object_";
 static char __pyx_k__strides[] = "strides";
 static char __pyx_k__BACKFILL[] = "BACKFILL";
@@ -977,7 +969,6 @@ static char __pyx_k__type_num[] = "type_num";
 static char __pyx_k__Exception[] = "Exception";
 static char __pyx_k___roll_sum[] = "_roll_sum";
 static char __pyx_k___roll_var[] = "_roll_var";
-static char __pyx_k__applyfunc[] = "applyfunc";
 static char __pyx_k__byteorder[] = "byteorder";
 static char __pyx_k__maxlevels[] = "maxlevels";
 static char __pyx_k__width_arr[] = "width_arr";
@@ -995,14 +986,12 @@ static char __pyx_k__expected_size[] = "expected_size";
 static PyObject *__pyx_kp_s_1;
 static PyObject *__pyx_kp_u_10;
 static PyObject *__pyx_kp_u_11;
-static PyObject *__pyx_kp_u_12;
-static PyObject *__pyx_kp_u_13;
 static PyObject *__pyx_kp_s_2;
 static PyObject *__pyx_kp_s_3;
 static PyObject *__pyx_kp_s_4;
 static PyObject *__pyx_kp_s_5;
-static PyObject *__pyx_kp_s_6;
-static PyObject *__pyx_kp_s_7;
+static PyObject *__pyx_kp_u_6;
+static PyObject *__pyx_kp_u_7;
 static PyObject *__pyx_kp_u_8;
 static PyObject *__pyx_kp_u_9;
 static PyObject *__pyx_n_s__BACKFILL;
@@ -1026,7 +1015,6 @@ static PyObject *__pyx_n_s____ne__;
 static PyObject *__pyx_n_s____pow__;
 static PyObject *__pyx_n_s____sub__;
 static PyObject *__pyx_n_s___ewma;
-static PyObject *__pyx_n_s___nofill;
 static PyObject *__pyx_n_s___roll_kurt;
 static PyObject *__pyx_n_s___roll_mean;
 static PyObject *__pyx_n_s___roll_median;
@@ -1036,8 +1024,6 @@ static PyObject *__pyx_n_s___roll_var;
 static PyObject *__pyx_n_s__aMap;
 static PyObject *__pyx_n_s__any;
 static PyObject *__pyx_n_s__ao;
-static PyObject *__pyx_n_s__applyfunc;
-static PyObject *__pyx_n_s__arr;
 static PyObject *__pyx_n_s__array;
 static PyObject *__pyx_n_s__arrmap;
 static PyObject *__pyx_n_s__asarray;
@@ -1062,7 +1048,6 @@ static PyObject *__pyx_n_s__func;
 static PyObject *__pyx_n_s__get;
 static PyObject *__pyx_n_s__getMergeVec;
 static PyObject *__pyx_n_s__head;
-static PyObject *__pyx_n_s__idxMap;
 static PyObject *__pyx_n_s__index;
 static PyObject *__pyx_n_s__inf;
 static PyObject *__pyx_n_s__input;
@@ -1073,8 +1058,8 @@ static PyObject *__pyx_n_s__isfinite;
 static PyObject *__pyx_n_s__isnan;
 static PyObject *__pyx_n_s__isnull;
 static PyObject *__pyx_n_s__itemsize;
-static PyObject *__pyx_n_s__keyfunc;
 static PyObject *__pyx_n_s__kind;
+static PyObject *__pyx_n_s__mapper;
 static PyObject *__pyx_n_s__max;
 static PyObject *__pyx_n_s__maxlevels;
 static PyObject *__pyx_n_s__min;
@@ -1088,11 +1073,11 @@ static PyObject *__pyx_n_s__next;
 static PyObject *__pyx_n_s__np;
 static PyObject *__pyx_n_s__numpy;
 static PyObject *__pyx_n_s__obj;
-static PyObject *__pyx_n_s__object;
 static PyObject *__pyx_n_s__object_;
 static PyObject *__pyx_n_s__oldIndex;
 static PyObject *__pyx_n_s__oldMap;
 static PyObject *__pyx_n_s__ones;
+static PyObject *__pyx_n_s__output;
 static PyObject *__pyx_n_s__pydatetime;
 static PyObject *__pyx_n_s__random;
 static PyObject *__pyx_n_s__range;
@@ -1120,7 +1105,7 @@ static PyObject *__pyx_int_neg_1;
 static PyObject *__pyx_int_15;
 static PyObject *__pyx_int_100;
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":17
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":17
  * from datetime import datetime as pydatetime
  * 
  * cdef inline object trycall(object func, object arg):             # <<<<<<<<<<<<<<
@@ -1139,7 +1124,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
   __Pyx_INCREF(__pyx_v_func);
   __Pyx_INCREF(__pyx_v_arg);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":18
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":18
  * 
  * cdef inline object trycall(object func, object arg):
  *     try:             # <<<<<<<<<<<<<<
@@ -1154,7 +1139,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
     __Pyx_XGOTREF(__pyx_save_exc_tb);
     /*try:*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":19
+      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":19
  * cdef inline object trycall(object func, object arg):
  *     try:
  *         return func(arg)             # <<<<<<<<<<<<<<
@@ -1188,7 +1173,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":20
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":20
  *     try:
  *         return func(arg)
  *     except:             # <<<<<<<<<<<<<<
@@ -1202,7 +1187,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GOTREF(__pyx_t_3);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":21
+      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":21
  *         return func(arg)
  *     except:
  *         raise Exception('Error calling func on index %s' % arg)             # <<<<<<<<<<<<<<
@@ -1259,7 +1244,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries_trycall(PyObject *__pyx_v_func,
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":23
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":23
  *         raise Exception('Error calling func on index %s' % arg)
  * 
  * cdef inline int int_max(int a, int b): return a if a >= b else b             # <<<<<<<<<<<<<<
@@ -1285,7 +1270,7 @@ static CYTHON_INLINE int __pyx_f_7tseries_int_max(int __pyx_v_a, int __pyx_v_b)
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":24
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":24
  * 
  * cdef inline int int_max(int a, int b): return a if a >= b else b
  * cdef inline int int_min(int a, int b): return a if a >= b else b             # <<<<<<<<<<<<<<
@@ -1311,7 +1296,7 @@ static CYTHON_INLINE int __pyx_f_7tseries_int_min(int __pyx_v_a, int __pyx_v_b)
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":28
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":28
  * ctypedef unsigned char UChar
  * 
  * cdef int is_contiguous(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1323,7 +1308,7 @@ static  int __pyx_f_7tseries_is_contiguous(PyArrayObject *__pyx_v_arr) {
   int __pyx_r;
   __Pyx_RefNannySetupContext("is_contiguous");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":29
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":29
  * 
  * cdef int is_contiguous(ndarray arr):
  *     return np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS)             # <<<<<<<<<<<<<<
@@ -1339,7 +1324,7 @@ static  int __pyx_f_7tseries_is_contiguous(PyArrayObject *__pyx_v_arr) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":31
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":31
  *     return np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS)
  * 
  * cdef int _contiguous_check(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1355,7 +1340,7 @@ static  int __pyx_f_7tseries__contiguous_check(PyArrayObject *__pyx_v_arr) {
   __Pyx_RefNannySetupContext("_contiguous_check");
   __Pyx_INCREF((PyObject *)__pyx_v_arr);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":32
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":32
  * 
  * cdef int _contiguous_check(ndarray arr):
  *     if not is_contiguous(arr):             # <<<<<<<<<<<<<<
@@ -1365,7 +1350,7 @@ static  int __pyx_f_7tseries__contiguous_check(PyArrayObject *__pyx_v_arr) {
   __pyx_t_1 = (!__pyx_f_7tseries_is_contiguous(__pyx_v_arr));
   if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":33
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":33
  * cdef int _contiguous_check(ndarray arr):
  *     if not is_contiguous(arr):
  *         raise ValueError('Tried to use data field on non-contiguous array!')             # <<<<<<<<<<<<<<
@@ -1400,7 +1385,7 @@ static  int __pyx_f_7tseries__contiguous_check(PyArrayObject *__pyx_v_arr) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":35
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":35
  *         raise ValueError('Tried to use data field on non-contiguous array!')
  * 
  * cdef int16_t *get_int16_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1412,7 +1397,7 @@ static  __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *__
   __pyx_t_5numpy_int16_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_int16_ptr");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":36
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":36
  * 
  * cdef int16_t *get_int16_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1421,7 +1406,7 @@ static  __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *__
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":38
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":38
  *     _contiguous_check(arr)
  * 
  *     return <int16_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1437,7 +1422,7 @@ static  __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *__
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":40
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":40
  *     return <int16_t *> arr.data
  * 
  * cdef int32_t *get_int32_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1449,7 +1434,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
   __pyx_t_5numpy_int32_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_int32_ptr");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":41
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":41
  * 
  * cdef int32_t *get_int32_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1458,7 +1443,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":43
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":43
  *     _contiguous_check(arr)
  * 
  *     return <int32_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1474,7 +1459,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":45
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":45
  *     return <int32_t *> arr.data
  * 
  * cdef int64_t *get_int64_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1486,7 +1471,7 @@ static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__
   __pyx_t_5numpy_int64_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_int64_ptr");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":46
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":46
  * 
  * cdef int64_t *get_int64_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1495,7 +1480,7 @@ static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":48
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":48
  *     _contiguous_check(arr)
  * 
  *     return <int64_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1511,7 +1496,7 @@ static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":50
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":50
  *     return <int64_t *> arr.data
  * 
  * cdef double_t *get_double_ptr(ndarray arr):             # <<<<<<<<<<<<<<
@@ -1523,7 +1508,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
   __pyx_t_5numpy_double_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_double_ptr");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":51
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":51
  * 
  * cdef double_t *get_double_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1532,7 +1517,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":53
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":53
  *     _contiguous_check(arr)
  * 
  *     return <double_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1548,7 +1533,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":85
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":85
  * import_array()
  * 
  * cpdef map_indices(ndarray index):             # <<<<<<<<<<<<<<
@@ -1572,7 +1557,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_v_result = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":100
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":100
  *     cdef object idx
  * 
  *     result = {}             # <<<<<<<<<<<<<<
@@ -1585,7 +1570,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_v_result = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":102
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":102
  *     result = {}
  * 
  *     iter = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
@@ -1599,7 +1584,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_v_iter = ((PyArrayIterObject *)__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":103
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":103
  * 
  *     iter = <flatiter> PyArray_IterNew(index)
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -1608,7 +1593,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_index);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":105
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":105
  *     length = PyArray_SIZE(index)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -1618,7 +1603,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_t_2 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":106
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":106
  * 
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))             # <<<<<<<<<<<<<<
@@ -1631,7 +1616,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
     __pyx_v_idx = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":107
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":107
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  *         result[idx] = i             # <<<<<<<<<<<<<<
@@ -1643,7 +1628,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
     if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_v_idx, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":108
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":108
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  *         result[idx] = i
  *         PyArray_ITER_NEXT(iter)             # <<<<<<<<<<<<<<
@@ -1653,7 +1638,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
     PyArray_ITER_NEXT(__pyx_v_iter);
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":110
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":110
  *         PyArray_ITER_NEXT(iter)
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -1681,7 +1666,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":85
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":85
  * import_array()
  * 
  * cpdef map_indices(ndarray index):             # <<<<<<<<<<<<<<
@@ -1716,7 +1701,7 @@ static PyObject *__pyx_pf_7tseries_map_indices(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":112
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":112
  *     return result
  * 
  * def isAllDates(ndarray index):             # <<<<<<<<<<<<<<
@@ -1741,7 +1726,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   __pyx_v_date = Py_None; __Pyx_INCREF(Py_None);
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":117
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":117
  *     cdef object date
  * 
  *     iter = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
@@ -1755,7 +1740,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   __pyx_v_iter = ((PyArrayIterObject *)__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":118
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":118
  * 
  *     iter = <flatiter> PyArray_IterNew(index)
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -1764,7 +1749,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
  */
   __pyx_v_length = PyArray_SIZE(((PyArrayObject *)__pyx_v_index));
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":120
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":120
  *     length = PyArray_SIZE(index)
  * 
  *     if length == 0:             # <<<<<<<<<<<<<<
@@ -1774,7 +1759,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   __pyx_t_2 = (__pyx_v_length == 0);
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":121
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":121
  * 
  *     if length == 0:
  *         return False             # <<<<<<<<<<<<<<
@@ -1791,7 +1776,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   }
   __pyx_L5:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":123
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":123
  *         return False
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -1801,7 +1786,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   __pyx_t_3 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_3; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":124
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":124
  * 
  *     for i from 0 <= i < length:
  *         date = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))             # <<<<<<<<<<<<<<
@@ -1814,7 +1799,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
     __pyx_v_date = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":126
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":126
  *         date = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  * 
  *         if not PyDateTime_Check(date):             # <<<<<<<<<<<<<<
@@ -1824,7 +1809,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
     __pyx_t_2 = (!PyDateTime_Check(__pyx_v_date));
     if (__pyx_t_2) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":127
+      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":127
  * 
  *         if not PyDateTime_Check(date):
  *             return False             # <<<<<<<<<<<<<<
@@ -1841,7 +1826,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
     }
     __pyx_L8:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":128
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":128
  *         if not PyDateTime_Check(date):
  *             return False
  *         PyArray_ITER_NEXT(iter)             # <<<<<<<<<<<<<<
@@ -1851,7 +1836,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
     PyArray_ITER_NEXT(__pyx_v_iter);
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":130
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":130
  *         PyArray_ITER_NEXT(iter)
  * 
  *     return True             # <<<<<<<<<<<<<<
@@ -1880,7 +1865,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates(PyObject *__pyx_self, PyObject *__
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":132
+/* "H:\workspace\pandas\pandas\lib\src\common.pyx":132
  *     return True
  * 
  * def isAllDates2(ndarray[object, ndim=1] arr):             # <<<<<<<<<<<<<<
@@ -1917,7 +1902,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
   __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":137
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":137
  *     '''
  * 
  *     cdef int i, size = len(arr)             # <<<<<<<<<<<<<<
@@ -1927,7 +1912,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_size = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":140
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":140
  *     cdef object date
  * 
  *     if size == 0:             # <<<<<<<<<<<<<<
@@ -1937,7 +1922,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   __pyx_t_2 = (__pyx_v_size == 0);
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":141
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":141
  * 
  *     if size == 0:
  *         return False             # <<<<<<<<<<<<<<
@@ -1954,7 +1939,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L5:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":143
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":143
  *         return False
  * 
  *     for i from 0 <= i < size:             # <<<<<<<<<<<<<<
@@ -1964,7 +1949,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   __pyx_t_4 = __pyx_v_size;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_4; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":144
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":144
  * 
  *     for i from 0 <= i < size:
  *         date = arr[i]             # <<<<<<<<<<<<<<
@@ -1987,7 +1972,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
     __pyx_v_date = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":146
+    /* "H:\workspace\pandas\pandas\lib\src\common.pyx":146
  *         date = arr[i]
  * 
  *         if not PyDateTime_Check(date):             # <<<<<<<<<<<<<<
@@ -1997,7 +1982,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
     __pyx_t_2 = (!PyDateTime_Check(__pyx_v_date));
     if (__pyx_t_2) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":147
+      /* "H:\workspace\pandas\pandas\lib\src\common.pyx":147
  * 
  *         if not PyDateTime_Check(date):
  *             return False             # <<<<<<<<<<<<<<
@@ -2015,7 +2000,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
     __pyx_L8:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":149
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":149
  *             return False
  * 
  *     return True             # <<<<<<<<<<<<<<
@@ -2048,7 +2033,7 @@ static PyObject *__pyx_pf_7tseries_isAllDates2(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":29
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":29
  *     cdef public:
  *         double value
  *         list next             # <<<<<<<<<<<<<<
@@ -2093,7 +2078,7 @@ static int __pyx_pf_7tseries_4Node_4next___set__(PyObject *__pyx_v_self, PyObjec
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":30
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":30
  *         double value
  *         list next
  *         ndarray width_arr             # <<<<<<<<<<<<<<
@@ -2138,7 +2123,7 @@ static int __pyx_pf_7tseries_4Node_9width_arr___set__(PyObject *__pyx_v_self, Py
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":35
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":35
  *         int *width
  * 
  *     def __init__(self, double value, list next, ndarray width):             # <<<<<<<<<<<<<<
@@ -2205,7 +2190,7 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_next), &PyList_Type, 1, "next", 1))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_width), __pyx_ptype_5numpy_ndarray, 1, "width", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":36
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":36
  * 
  *     def __init__(self, double value, list next, ndarray width):
  *         self.value = value             # <<<<<<<<<<<<<<
@@ -2214,7 +2199,7 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
  */
   ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->value = __pyx_v_value;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":37
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":37
  *     def __init__(self, double value, list next, ndarray width):
  *         self.value = value
  *         self.next = next             # <<<<<<<<<<<<<<
@@ -2227,7 +2212,7 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
   __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next));
   ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->next = __pyx_v_next;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":38
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":38
  *         self.value = value
  *         self.next = next
  *         self.width_arr = width             # <<<<<<<<<<<<<<
@@ -2240,7 +2225,7 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
   __Pyx_DECREF(((PyObject *)((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr));
   ((struct __pyx_obj_7tseries_Node *)__pyx_v_self)->width_arr = __pyx_v_width;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":39
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":39
  *         self.next = next
  *         self.width_arr = width
  *         self.width = <int *> width.data             # <<<<<<<<<<<<<<
@@ -2259,7 +2244,7 @@ static int __pyx_pf_7tseries_4Node___init__(PyObject *__pyx_v_self, PyObject *__
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":51
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":51
  *         Node head
  * 
  *     def __init__(self, expected_size=100):             # <<<<<<<<<<<<<<
@@ -2316,7 +2301,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
   return -1;
   __pyx_L4_argument_unpacking_done:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":52
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":52
  * 
  *     def __init__(self, expected_size=100):
  *         self.size = 0             # <<<<<<<<<<<<<<
@@ -2325,7 +2310,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
  */
   ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->size = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":53
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":53
  *     def __init__(self, expected_size=100):
  *         self.size = 0
  *         self.maxlevels = int(1 + log2(expected_size))             # <<<<<<<<<<<<<<
@@ -2335,7 +2320,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
   __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_expected_size); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->maxlevels = ((int)(1 + log2(__pyx_t_1)));
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":55
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":55
  *         self.maxlevels = int(1 + log2(expected_size))
  * 
  *         self.head = Node(np.NaN, [NIL] * self.maxlevels,             # <<<<<<<<<<<<<<
@@ -2361,7 +2346,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
   __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":56
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":56
  * 
  *         self.head = Node(np.NaN, [NIL] * self.maxlevels,
  *                          np.ones(self.maxlevels, dtype=int))             # <<<<<<<<<<<<<<
@@ -2403,7 +2388,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":55
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":55
  *         self.maxlevels = int(1 + log2(expected_size))
  * 
  *         self.head = Node(np.NaN, [NIL] * self.maxlevels,             # <<<<<<<<<<<<<<
@@ -2432,7 +2417,7 @@ static int __pyx_pf_7tseries_17IndexableSkiplist___init__(PyObject *__pyx_v_self
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":58
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":58
  *                          np.ones(self.maxlevels, dtype=int))
  * 
  *     def __len__(self):             # <<<<<<<<<<<<<<
@@ -2445,7 +2430,7 @@ static Py_ssize_t __pyx_pf_7tseries_17IndexableSkiplist___len__(PyObject *__pyx_
   Py_ssize_t __pyx_r;
   __Pyx_RefNannySetupContext("__len__");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":59
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":59
  * 
  *     def __len__(self):
  *         return self.size             # <<<<<<<<<<<<<<
@@ -2461,7 +2446,7 @@ static Py_ssize_t __pyx_pf_7tseries_17IndexableSkiplist___len__(PyObject *__pyx_
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":61
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":61
  *         return self.size
  * 
  *     def __getitem__(self, i):             # <<<<<<<<<<<<<<
@@ -2477,7 +2462,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist___getitem__(PyObject *__p
   PyObject *__pyx_t_3 = NULL;
   __Pyx_RefNannySetupContext("__getitem__");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":62
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":62
  * 
  *     def __getitem__(self, i):
  *         return self.get(i)             # <<<<<<<<<<<<<<
@@ -2514,7 +2499,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist___getitem__(PyObject *__p
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":64
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":64
  *         return self.get(i)
  * 
  *     def get(self, int i):             # <<<<<<<<<<<<<<
@@ -2545,7 +2530,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
   __Pyx_INCREF((PyObject *)__pyx_v_self);
   __pyx_v_node = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":68
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":68
  *         cdef Node node
  * 
  *         node = self.head             # <<<<<<<<<<<<<<
@@ -2556,7 +2541,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
   __Pyx_DECREF(((PyObject *)__pyx_v_node));
   __pyx_v_node = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":69
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":69
  * 
  *         node = self.head
  *         i += 1             # <<<<<<<<<<<<<<
@@ -2565,7 +2550,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
  */
   __pyx_v_i += 1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":71
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":71
  *         i += 1
  * 
  *         for level in range(self.maxlevels - 1, -1, -1):             # <<<<<<<<<<<<<<
@@ -2614,7 +2599,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_level = __pyx_t_4;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":72
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":72
  * 
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             while node.width[level] <= i:             # <<<<<<<<<<<<<<
@@ -2625,7 +2610,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
       __pyx_t_5 = ((__pyx_v_node->width[__pyx_v_level]) <= __pyx_v_i);
       if (!__pyx_t_5) break;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":73
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":73
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             while node.width[level] <= i:
  *                 i -= node.width[level]             # <<<<<<<<<<<<<<
@@ -2634,7 +2619,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
  */
       __pyx_v_i -= (__pyx_v_node->width[__pyx_v_level]);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":74
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":74
  *             while node.width[level] <= i:
  *                 i -= node.width[level]
  *                 node = node.next[level]             # <<<<<<<<<<<<<<
@@ -2651,7 +2636,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":76
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":76
  *                 node = node.next[level]
  * 
  *         return node.value             # <<<<<<<<<<<<<<
@@ -2680,7 +2665,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_get(PyObject *__pyx_v_sel
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":78
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":78
  *         return node.value
  * 
  *     def insert(self, double value):             # <<<<<<<<<<<<<<
@@ -2730,7 +2715,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __pyx_v_chain = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_steps_at_level = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":84
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":84
  * 
  *         # find first node on each level where node.next[levels].value > value
  *         chain = [None] * self.maxlevels             # <<<<<<<<<<<<<<
@@ -2753,7 +2738,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __pyx_v_chain = ((PyObject *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":85
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":85
  *         # find first node on each level where node.next[levels].value > value
  *         chain = [None] * self.maxlevels
  *         steps_at_level = [0] * self.maxlevels             # <<<<<<<<<<<<<<
@@ -2776,7 +2761,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __pyx_v_steps_at_level = ((PyObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":87
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":87
  *         steps_at_level = [0] * self.maxlevels
  * 
  *         node = self.head             # <<<<<<<<<<<<<<
@@ -2787,7 +2772,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __Pyx_DECREF(((PyObject *)__pyx_v_node));
   __pyx_v_node = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":88
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":88
  * 
  *         node = self.head
  *         for level in range(self.maxlevels - 1, -1, -1):             # <<<<<<<<<<<<<<
@@ -2836,7 +2821,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_level = __pyx_t_5;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":89
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":89
  *         node = self.head
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             next_at_level = node.next[level]             # <<<<<<<<<<<<<<
@@ -2850,7 +2835,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
     __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":91
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":91
  *             next_at_level = node.next[level]
  * 
  *             while next_at_level.value <= value:             # <<<<<<<<<<<<<<
@@ -2861,7 +2846,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
       __pyx_t_6 = (__pyx_v_next_at_level->value <= __pyx_v_value);
       if (!__pyx_t_6) break;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":92
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":92
  * 
  *             while next_at_level.value <= value:
  *                 steps_at_level[level] = (steps_at_level[level] +             # <<<<<<<<<<<<<<
@@ -2871,7 +2856,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
       __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, sizeof(int), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_1);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":93
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":93
  *             while next_at_level.value <= value:
  *                 steps_at_level[level] = (steps_at_level[level] +
  *                                          node.width[level])             # <<<<<<<<<<<<<<
@@ -2885,7 +2870,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":92
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":92
  * 
  *             while next_at_level.value <= value:
  *                 steps_at_level[level] = (steps_at_level[level] +             # <<<<<<<<<<<<<<
@@ -2895,7 +2880,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
       if (__Pyx_SetItemInt(((PyObject *)__pyx_v_steps_at_level), __pyx_v_level, __pyx_t_7, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":94
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":94
  *                 steps_at_level[level] = (steps_at_level[level] +
  *                                          node.width[level])
  *                 node = next_at_level             # <<<<<<<<<<<<<<
@@ -2906,7 +2891,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
       __Pyx_DECREF(((PyObject *)__pyx_v_node));
       __pyx_v_node = __pyx_v_next_at_level;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":95
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":95
  *                                          node.width[level])
  *                 node = next_at_level
  *                 next_at_level = node.next[level]             # <<<<<<<<<<<<<<
@@ -2921,7 +2906,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
       __pyx_t_7 = 0;
     }
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":97
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":97
  *                 next_at_level = node.next[level]
  * 
  *             chain[level] = node             # <<<<<<<<<<<<<<
@@ -2932,7 +2917,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":100
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":100
  * 
  *         # insert a link to the newnode at each level
  *         d = min(self.maxlevels, 1 - int(log2(random())))             # <<<<<<<<<<<<<<
@@ -2976,7 +2961,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_d = __pyx_t_5;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":101
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":101
  *         # insert a link to the newnode at each level
  *         d = min(self.maxlevels, 1 - int(log2(random())))
  *         newnode = Node(value, [None] * d, np.empty(d, dtype=int))             # <<<<<<<<<<<<<<
@@ -3034,7 +3019,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   __pyx_v_newnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_10);
   __pyx_t_10 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":102
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":102
  *         d = min(self.maxlevels, 1 - int(log2(random())))
  *         newnode = Node(value, [None] * d, np.empty(d, dtype=int))
  *         steps = 0             # <<<<<<<<<<<<<<
@@ -3043,7 +3028,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  */
   __pyx_v_steps = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":104
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":104
  *         steps = 0
  * 
  *         for level in range(d):             # <<<<<<<<<<<<<<
@@ -3054,7 +3039,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_5; __pyx_t_11+=1) {
     __pyx_v_level = __pyx_t_11;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":105
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":105
  * 
  *         for level in range(d):
  *             prevnode = chain[level]             # <<<<<<<<<<<<<<
@@ -3068,7 +3053,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
     __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_10);
     __pyx_t_10 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":107
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":107
  *             prevnode = chain[level]
  * 
  *             newnode.next[level] = prevnode.next[level]             # <<<<<<<<<<<<<<
@@ -3080,7 +3065,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
     if (__Pyx_SetItemInt(((PyObject *)__pyx_v_newnode->next), __pyx_v_level, __pyx_t_10, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":108
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":108
  * 
  *             newnode.next[level] = prevnode.next[level]
  *             prevnode.next[level] = newnode             # <<<<<<<<<<<<<<
@@ -3089,7 +3074,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  */
     if (__Pyx_SetItemInt(((PyObject *)__pyx_v_prevnode->next), __pyx_v_level, ((PyObject *)__pyx_v_newnode), sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":110
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":110
  *             prevnode.next[level] = newnode
  * 
  *             newnode.width[level] = prevnode.width[level] - steps             # <<<<<<<<<<<<<<
@@ -3098,7 +3083,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  */
     (__pyx_v_newnode->width[__pyx_v_level]) = ((__pyx_v_prevnode->width[__pyx_v_level]) - __pyx_v_steps);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":111
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":111
  * 
  *             newnode.width[level] = prevnode.width[level] - steps
  *             prevnode.width[level] = steps + 1             # <<<<<<<<<<<<<<
@@ -3107,7 +3092,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
  */
     (__pyx_v_prevnode->width[__pyx_v_level]) = (__pyx_v_steps + 1);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":113
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":113
  *             prevnode.width[level] = steps + 1
  * 
  *             steps = steps + steps_at_level[level]             # <<<<<<<<<<<<<<
@@ -3127,7 +3112,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
     __pyx_v_steps = __pyx_t_12;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":115
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":115
  *             steps = steps + steps_at_level[level]
  * 
  *         for level in range(d, self.maxlevels):             # <<<<<<<<<<<<<<
@@ -3138,7 +3123,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   for (__pyx_t_11 = __pyx_v_d; __pyx_t_11 < __pyx_t_5; __pyx_t_11+=1) {
     __pyx_v_level = __pyx_t_11;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":116
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":116
  * 
  *         for level in range(d, self.maxlevels):
  *             (<Node> chain[level]).width[level] += 1             # <<<<<<<<<<<<<<
@@ -3150,7 +3135,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
     (((struct __pyx_obj_7tseries_Node *)__pyx_t_1)->width[__pyx_v_level]) += 1;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":118
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":118
  *             (<Node> chain[level]).width[level] += 1
  * 
  *         self.size += 1             # <<<<<<<<<<<<<<
@@ -3183,7 +3168,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_insert(PyObject *__pyx_v_
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":120
+/* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":120
  *         self.size += 1
  * 
  *     def remove(self, double value):             # <<<<<<<<<<<<<<
@@ -3225,7 +3210,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_chain = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":126
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":126
  * 
  *         # find first node on each level where node.next[levels].value >= value
  *         chain = [None] * self.maxlevels             # <<<<<<<<<<<<<<
@@ -3248,7 +3233,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   __pyx_v_chain = ((PyObject *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":127
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":127
  *         # find first node on each level where node.next[levels].value >= value
  *         chain = [None] * self.maxlevels
  *         node = self.head             # <<<<<<<<<<<<<<
@@ -3259,7 +3244,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   __Pyx_DECREF(((PyObject *)__pyx_v_node));
   __pyx_v_node = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_v_self)->head;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":129
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":129
  *         node = self.head
  * 
  *         for level in range(self.maxlevels - 1, -1, -1):             # <<<<<<<<<<<<<<
@@ -3308,7 +3293,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_level = __pyx_t_5;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":130
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":130
  * 
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             next_at_level = node.next[level]             # <<<<<<<<<<<<<<
@@ -3322,7 +3307,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
     __pyx_v_next_at_level = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":131
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":131
  *         for level in range(self.maxlevels - 1, -1, -1):
  *             next_at_level = node.next[level]
  *             while next_at_level.value < value:             # <<<<<<<<<<<<<<
@@ -3333,7 +3318,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
       __pyx_t_6 = (__pyx_v_next_at_level->value < __pyx_v_value);
       if (!__pyx_t_6) break;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":132
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":132
  *             next_at_level = node.next[level]
  *             while next_at_level.value < value:
  *                 node = next_at_level             # <<<<<<<<<<<<<<
@@ -3344,7 +3329,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
       __Pyx_DECREF(((PyObject *)__pyx_v_node));
       __pyx_v_node = __pyx_v_next_at_level;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":133
+      /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":133
  *             while next_at_level.value < value:
  *                 node = next_at_level
  *                 next_at_level = node.next[level]             # <<<<<<<<<<<<<<
@@ -3359,7 +3344,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
       __pyx_t_3 = 0;
     }
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":135
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":135
  *                 next_at_level = node.next[level]
  * 
  *             chain[level] = node             # <<<<<<<<<<<<<<
@@ -3370,7 +3355,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":137
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":137
  *             chain[level] = node
  * 
  *         if value != chain[0].next[0].value:             # <<<<<<<<<<<<<<
@@ -3398,7 +3383,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_6) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":138
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":138
  * 
  *         if value != chain[0].next[0].value:
  *             raise KeyError('Not Found')             # <<<<<<<<<<<<<<
@@ -3420,7 +3405,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   }
   __pyx_L9:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":141
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":141
  * 
  *         # remove one link at each level
  *         d = len(chain[0].next[0].next)             # <<<<<<<<<<<<<<
@@ -3442,7 +3427,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_d = __pyx_t_4;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":143
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":143
  *         d = len(chain[0].next[0].next)
  * 
  *         for level in range(d):             # <<<<<<<<<<<<<<
@@ -3453,7 +3438,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_5; __pyx_t_7+=1) {
     __pyx_v_level = __pyx_t_7;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":144
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":144
  * 
  *         for level in range(d):
  *             prevnode = chain[level]             # <<<<<<<<<<<<<<
@@ -3467,7 +3452,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
     __pyx_v_prevnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":145
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":145
  *         for level in range(d):
  *             prevnode = chain[level]
  *             tmpnode = prevnode.next[level]             # <<<<<<<<<<<<<<
@@ -3481,7 +3466,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
     __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":146
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":146
  *             prevnode = chain[level]
  *             tmpnode = prevnode.next[level]
  *             prevnode.width[level] += tmpnode.width[level] - 1             # <<<<<<<<<<<<<<
@@ -3490,7 +3475,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
  */
     (__pyx_v_prevnode->width[__pyx_v_level]) += ((__pyx_v_tmpnode->width[__pyx_v_level]) - 1);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":147
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":147
  *             tmpnode = prevnode.next[level]
  *             prevnode.width[level] += tmpnode.width[level] - 1
  *             prevnode.next[level] = tmpnode.next[level]             # <<<<<<<<<<<<<<
@@ -3503,7 +3488,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":149
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":149
  *             prevnode.next[level] = tmpnode.next[level]
  * 
  *         for level in range(d, self.maxlevels):             # <<<<<<<<<<<<<<
@@ -3514,7 +3499,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   for (__pyx_t_7 = __pyx_v_d; __pyx_t_7 < __pyx_t_5; __pyx_t_7+=1) {
     __pyx_v_level = __pyx_t_7;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":150
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":150
  * 
  *         for level in range(d, self.maxlevels):
  *             tmpnode = chain[level]             # <<<<<<<<<<<<<<
@@ -3528,7 +3513,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
     __pyx_v_tmpnode = ((struct __pyx_obj_7tseries_Node *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":151
+    /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":151
  *         for level in range(d, self.maxlevels):
  *             tmpnode = chain[level]
  *             tmpnode.width[level] -= 1             # <<<<<<<<<<<<<<
@@ -3538,7 +3523,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
     (__pyx_v_tmpnode->width[__pyx_v_level]) -= 1;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":153
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":153
  *             tmpnode.width[level] -= 1
  * 
  *         self.size -= 1             # <<<<<<<<<<<<<<
@@ -3565,7 +3550,7 @@ static PyObject *__pyx_pf_7tseries_17IndexableSkiplist_remove(PyObject *__pyx_v_
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":5
+/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":5
  * cdef double NEGINF = -INF
  * 
  * cdef inline _checknull(object val):             # <<<<<<<<<<<<<<
@@ -3583,7 +3568,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val
   __Pyx_RefNannySetupContext("_checknull");
   __Pyx_INCREF(__pyx_v_val);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":6
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":6
  * 
  * cdef inline _checknull(object val):
  *     if isinstance(val, float):             # <<<<<<<<<<<<<<
@@ -3593,7 +3578,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val
   __pyx_t_1 = PyObject_TypeCheck(__pyx_v_val, ((PyTypeObject *)((PyObject*)&PyFloat_Type))); 
   if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":7
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":7
  * cdef inline _checknull(object val):
  *     if isinstance(val, float):
  *         return val != val or val == INF or val == NEGINF             # <<<<<<<<<<<<<<
@@ -3601,22 +3586,22 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val
  *         return val is None
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = PyObject_RichCompare(__pyx_v_val, __pyx_v_val, Py_NE); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_RichCompare(__pyx_v_val, __pyx_v_val, Py_NE); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     if (!__pyx_t_1) {
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_7tseries_INF); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_7tseries_INF); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = PyObject_RichCompare(__pyx_v_val, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyObject_RichCompare(__pyx_v_val, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       if (!__pyx_t_1) {
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_3 = PyFloat_FromDouble(__pyx_v_7tseries_NEGINF); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyFloat_FromDouble(__pyx_v_7tseries_NEGINF); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_5 = PyObject_RichCompare(__pyx_v_val, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyObject_RichCompare(__pyx_v_val, __pyx_t_3, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_3 = __pyx_t_5;
@@ -3638,7 +3623,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val
   }
   /*else*/ {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":9
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":9
  *         return val != val or val == INF or val == NEGINF
  *     else:
  *         return val is None             # <<<<<<<<<<<<<<
@@ -3647,7 +3632,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_1 = (__pyx_v_val == Py_None);
-    __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_r = __pyx_t_4;
     __pyx_t_4 = 0;
@@ -3671,7 +3656,7 @@ static CYTHON_INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *__pyx_v_val
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":11
+/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":11
  *         return val is None
  * 
  * cdef ndarray _isnullobj(input):             # <<<<<<<<<<<<<<
@@ -3709,45 +3694,45 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
   __pyx_v_iter = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_result.buf = NULL;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":17
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":17
  *     cdef flatiter iter
  * 
  *     length = PyArray_SIZE(input)             # <<<<<<<<<<<<<<
  * 
  *     result = <ndarray> np.zeros(length, dtype=np.int8)
  */
-  if (!(likely(((__pyx_v_input) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_input, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_v_input) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_input, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_length = PyArray_SIZE(((PyArrayObject *)__pyx_v_input));
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":19
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":19
  *     length = PyArray_SIZE(input)
  * 
  *     result = <ndarray> np.zeros(length, dtype=np.int8)             # <<<<<<<<<<<<<<
  * 
  *     iter= PyArray_IterNew(input)
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -3768,7 +3753,7 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
     }
     __pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
     __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
-    if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_t_6 = 0;
   __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_5)));
@@ -3776,21 +3761,21 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":21
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":21
  *     result = <ndarray> np.zeros(length, dtype=np.int8)
  * 
  *     iter= PyArray_IterNew(input)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < length:
  */
-  __pyx_t_5 = PyArray_IterNew(__pyx_v_input); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(__pyx_v_input); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_flatiter))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_flatiter))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(((PyObject *)__pyx_v_iter));
   __pyx_v_iter = ((PyArrayIterObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":23
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":23
  *     iter= PyArray_IterNew(input)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -3800,34 +3785,34 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
   __pyx_t_7 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":24
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":24
  * 
  *     for i from 0 <= i < length:
  *         val = PyArray_GETITEM(input, PyArray_ITER_DATA(iter))             # <<<<<<<<<<<<<<
  * 
  *         if _checknull(val):
  */
-    if (!(likely(((__pyx_v_input) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_input, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_5 = PyArray_GETITEM(((PyArrayObject *)__pyx_v_input), PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_v_input) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_input, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(((PyArrayObject *)__pyx_v_input), PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_val);
     __pyx_v_val = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":26
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":26
  *         val = PyArray_GETITEM(input, PyArray_ITER_DATA(iter))
  * 
  *         if _checknull(val):             # <<<<<<<<<<<<<<
  *             result[i] = 1
  * 
  */
-    __pyx_t_5 = __pyx_f_7tseries__checknull(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = __pyx_f_7tseries__checknull(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_11 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_11 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_11) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":27
+      /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":27
  * 
  *         if _checknull(val):
  *             result[i] = 1             # <<<<<<<<<<<<<<
@@ -3842,14 +3827,14 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
       } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_result)) __pyx_t_13 = 0;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        {__pyx_filename = __pyx_f[4]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[3]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_result.buf, __pyx_t_12, __pyx_bstride_0_result) = 1;
       goto __pyx_L5;
     }
     __pyx_L5:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":29
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":29
  *             result[i] = 1
  * 
  *         PyArray_ITER_NEXT(iter)             # <<<<<<<<<<<<<<
@@ -3859,7 +3844,7 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
     PyArray_ITER_NEXT(__pyx_v_iter);
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":31
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":31
  *         PyArray_ITER_NEXT(iter)
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -3898,7 +3883,7 @@ static  PyArrayObject *__pyx_f_7tseries__isnullobj(PyObject *__pyx_v_input) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":33
+/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":33
  *     return result
  * 
  * def isnull(input):             # <<<<<<<<<<<<<<
@@ -3930,7 +3915,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_result.buf = NULL;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":48
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":48
  *     cdef ndarray[npy_int8, ndim=1] result
  * 
  *     if isinstance(input, np.ndarray):             # <<<<<<<<<<<<<<
@@ -3940,27 +3925,27 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_t_1 = PyObject_TypeCheck(__pyx_v_input, ((PyTypeObject *)((PyObject*)__pyx_ptype_5numpy_ndarray))); 
   if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":49
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":49
  * 
  *     if isinstance(input, np.ndarray):
  *         if input.dtype.kind in ('O', 'S'):             # <<<<<<<<<<<<<<
  *             result = _isnullobj(input)
  * 
  */
-    __pyx_t_2 = PyObject_GetAttr(__pyx_v_input, __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(__pyx_v_input, __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__kind); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__kind); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_n_s__O), Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_n_s__O), Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_1 == (int)-1))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_1 == (int)-1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_4 = ((int)__pyx_t_1);
     if (!__pyx_t_4) {
-      __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_n_s__S), Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_n_s__S), Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_1 == (int)-1))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_1 == (int)-1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_5 = ((int)__pyx_t_1);
       __pyx_t_1 = __pyx_t_5;
@@ -3971,14 +3956,14 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_4) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":50
+      /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":50
  *     if isinstance(input, np.ndarray):
  *         if input.dtype.kind in ('O', 'S'):
  *             result = _isnullobj(input)             # <<<<<<<<<<<<<<
  * 
  *             return result.astype(np.bool)
  */
-      __pyx_t_3 = ((PyObject *)__pyx_f_7tseries__isnullobj(__pyx_v_input)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = ((PyObject *)__pyx_f_7tseries__isnullobj(__pyx_v_input)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       {
         __Pyx_BufFmt_StackElem __pyx_stack[1];
@@ -3995,13 +3980,13 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
         }
         __pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
         __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
-        if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __Pyx_DECREF(((PyObject *)__pyx_v_result));
       __pyx_v_result = ((PyArrayObject *)__pyx_t_3);
       __pyx_t_3 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":52
+      /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":52
  *             result = _isnullobj(input)
  * 
  *             return result.astype(np.bool)             # <<<<<<<<<<<<<<
@@ -4009,19 +3994,19 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
  *             return -np.isfinite(input)
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_result), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_result), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_10 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__bool); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__bool); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_10);
       __Pyx_GIVEREF(__pyx_t_10);
       __pyx_t_10 = 0;
-      __pyx_t_10 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
@@ -4032,7 +4017,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
     }
     /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":54
+      /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":54
  *             return result.astype(np.bool)
  *         else:
  *             return -np.isfinite(input)             # <<<<<<<<<<<<<<
@@ -4040,21 +4025,21 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
  *         return _checknull(input)
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_10 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_2 = PyObject_GetAttr(__pyx_t_10, __pyx_n_s__isfinite); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = PyObject_GetAttr(__pyx_t_10, __pyx_n_s__isfinite); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_INCREF(__pyx_v_input);
       PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_input);
       __Pyx_GIVEREF(__pyx_v_input);
-      __pyx_t_3 = PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyNumber_Negative(__pyx_t_3); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = PyNumber_Negative(__pyx_t_3); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_r = __pyx_t_10;
@@ -4066,7 +4051,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
   }
   /*else*/ {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":56
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":56
  *             return -np.isfinite(input)
  *     else:
  *         return _checknull(input)             # <<<<<<<<<<<<<<
@@ -4074,7 +4059,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
  * def notnull(input):
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_10 = __pyx_f_7tseries__checknull(__pyx_v_input); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __pyx_f_7tseries__checknull(__pyx_v_input); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_r = __pyx_t_10;
     __pyx_t_10 = 0;
@@ -4105,7 +4090,7 @@ static PyObject *__pyx_pf_7tseries_isnull(PyObject *__pyx_self, PyObject *__pyx_
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":58
+/* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":58
  *         return _checknull(input)
  * 
  * def notnull(input):             # <<<<<<<<<<<<<<
@@ -4125,7 +4110,7 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
   __pyx_self = __pyx_self;
   __Pyx_INCREF(__pyx_v_input);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":71
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":71
  *     boolean ndarray or boolean
  *     '''
  *     if isinstance(input, np.ndarray):             # <<<<<<<<<<<<<<
@@ -4135,7 +4120,7 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
   __pyx_t_1 = PyObject_TypeCheck(__pyx_v_input, ((PyTypeObject *)((PyObject*)__pyx_ptype_5numpy_ndarray))); 
   if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":72
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":72
  *     '''
  *     if isinstance(input, np.ndarray):
  *         return -isnull(input)             # <<<<<<<<<<<<<<
@@ -4143,18 +4128,18 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
  *         return not bool(_checknull(input))
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__isnull); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__isnull); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_input);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_input);
     __Pyx_GIVEREF(__pyx_v_input);
-    __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Negative(__pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyNumber_Negative(__pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_r = __pyx_t_3;
@@ -4164,26 +4149,26 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
   }
   /*else*/ {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":74
+    /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":74
  *         return -isnull(input)
  *     else:
  *         return not bool(_checknull(input))             # <<<<<<<<<<<<<<
  * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __pyx_f_7tseries__checknull(__pyx_v_input); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __pyx_f_7tseries__checknull(__pyx_v_input); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)&PyBool_Type)), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)&PyBool_Type)), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyBool_FromLong((!__pyx_t_1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __Pyx_PyBool_FromLong((!__pyx_t_1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
@@ -4206,7 +4191,46 @@ static PyObject *__pyx_pf_7tseries_notnull(PyObject *__pyx_self, PyObject *__pyx
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":6
+/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":5
+ * # Groupby-related functions
+ * 
+ * cdef inline _isnan(object o):             # <<<<<<<<<<<<<<
+ *     return o != o
+ * 
+ */
+
+static CYTHON_INLINE PyObject *__pyx_f_7tseries__isnan(PyObject *__pyx_v_o) {
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  __Pyx_RefNannySetupContext("_isnan");
+
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":6
+ * 
+ * cdef inline _isnan(object o):
+ *     return o != o             # <<<<<<<<<<<<<<
+ * 
+ * @cython.boundscheck(False)
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_o, __pyx_v_o, Py_NE); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("tseries._isnan");
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":9
  * 
  * @cython.boundscheck(False)
  * def arrmap(ndarray[object, ndim=1] index, object func):             # <<<<<<<<<<<<<<
@@ -4259,11 +4283,11 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__func);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("arrmap", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("arrmap", 1, 2, 2, 1); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "arrmap") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "arrmap") < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_index = ((PyArrayObject *)values[0]);
     __pyx_v_func = values[1];
@@ -4275,7 +4299,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("arrmap", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("arrmap", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.arrmap");
   return NULL;
@@ -4284,15 +4308,15 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __Pyx_INCREF(__pyx_v_func);
   __pyx_bstruct_result.buf = NULL;
   __pyx_bstruct_index.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
   __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":7
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":10
  * @cython.boundscheck(False)
  * def arrmap(ndarray[object, ndim=1] index, object func):
  *     cdef int length = index.shape[0]             # <<<<<<<<<<<<<<
@@ -4301,7 +4325,7 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
  */
   __pyx_v_length = (__pyx_v_index->dimensions[0]);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":8
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":11
  * def arrmap(ndarray[object, ndim=1] index, object func):
  *     cdef int length = index.shape[0]
  *     cdef int i = 0             # <<<<<<<<<<<<<<
@@ -4310,46 +4334,46 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
  */
   __pyx_v_i = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":10
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":13
  *     cdef int i = 0
  * 
  *     cdef ndarray[object, ndim=1] result = np.empty(length, dtype=np.object_)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < length:
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__object_); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__object_); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_result.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[4]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
       __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
     }
@@ -4358,20 +4382,20 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":12
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":15
  *     cdef ndarray[object, ndim=1] result = np.empty(length, dtype=np.object_)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
- *         result[i] = func(index[i])
+ *         result[i] = trycall(func, index[i])
  * 
  */
   __pyx_t_7 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":13
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":16
  * 
  *     for i from 0 <= i < length:
- *         result[i] = func(index[i])             # <<<<<<<<<<<<<<
+ *         result[i] = trycall(func, index[i])             # <<<<<<<<<<<<<<
  * 
  *     return result
  */
@@ -4379,26 +4403,21 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
     if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_bshape_0_index;
     __pyx_t_5 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_8, __pyx_bstride_0_index);
     __Pyx_INCREF((PyObject*)__pyx_t_5);
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_func, __pyx_t_5); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
-    __Pyx_GIVEREF(__pyx_t_5);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = PyObject_Call(__pyx_v_func, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = __pyx_v_i;
     if (__pyx_t_9 < 0) __pyx_t_9 += __pyx_bshape_0_result;
     __pyx_t_10 = __Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_result.buf, __pyx_t_9, __pyx_bstride_0_result);
     __Pyx_GOTREF(*__pyx_t_10);
-    __Pyx_DECREF(*__pyx_t_10); __Pyx_INCREF(__pyx_t_5);
-    *__pyx_t_10 = __pyx_t_5;
+    __Pyx_DECREF(*__pyx_t_10); __Pyx_INCREF(__pyx_t_1);
+    *__pyx_t_10 = __pyx_t_1;
     __Pyx_GIVEREF(*__pyx_t_10);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":15
- *         result[i] = func(index[i])
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":18
+ *         result[i] = trycall(func, index[i])
  * 
  *     return result             # <<<<<<<<<<<<<<
  * 
@@ -4437,64 +4456,64 @@ static PyObject *__pyx_pf_7tseries_arrmap(PyObject *__pyx_self, PyObject *__pyx_
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":18
+/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":21
  * 
  * @cython.boundscheck(False)
- * def groupby_withnull_old(ndarray[object, ndim = 1] index, object keyfunc):             # <<<<<<<<<<<<<<
- *     cdef dict groups
- *     cdef int length = index.shape[0]
+ * def groupby(object index, object mapper, output=None):             # <<<<<<<<<<<<<<
+ *     cdef dict result
+ *     cdef ndarray[object, ndim=1] mapped_index
  */
 
-static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_index = 0;
-  PyObject *__pyx_v_keyfunc = 0;
-  PyObject *__pyx_v_groups;
+static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_index = 0;
+  PyObject *__pyx_v_mapper = 0;
+  PyObject *__pyx_v_output = 0;
+  PyObject *__pyx_v_result;
+  PyArrayObject *__pyx_v_mapped_index;
+  PyArrayObject *__pyx_v_index_buf;
+  PyArrayObject *__pyx_v_mask;
+  int __pyx_v_i;
   int __pyx_v_length;
+  PyObject *__pyx_v_members;
   PyObject *__pyx_v_idx;
-  PyObject *__pyx_v_curKey;
   PyObject *__pyx_v_key;
-  PyObject *__pyx_v_members;
-  PyArrayObject *__pyx_v_mapped_index = 0;
-  PyArrayObject *__pyx_v_null_mask = 0;
-  PyObject *__pyx_v_bool_mask;
-  PyObject *__pyx_v_null_values;
-  int __pyx_v_i;
-  Py_buffer __pyx_bstruct_index;
-  Py_ssize_t __pyx_bstride_0_index = 0;
-  Py_ssize_t __pyx_bshape_0_index = 0;
-  Py_buffer __pyx_bstruct_null_mask;
-  Py_ssize_t __pyx_bstride_0_null_mask = 0;
-  Py_ssize_t __pyx_bshape_0_null_mask = 0;
+  PyObject *__pyx_v_nullkeys;
+  Py_buffer __pyx_bstruct_index_buf;
+  Py_ssize_t __pyx_bstride_0_index_buf = 0;
+  Py_ssize_t __pyx_bshape_0_index_buf = 0;
+  Py_buffer __pyx_bstruct_mask;
+  Py_ssize_t __pyx_bstride_0_mask = 0;
+  Py_ssize_t __pyx_bshape_0_mask = 0;
   Py_buffer __pyx_bstruct_mapped_index;
   Py_ssize_t __pyx_bstride_0_mapped_index = 0;
   Py_ssize_t __pyx_bshape_0_mapped_index = 0;
   PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
+  Py_ssize_t __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
-  PyArrayObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
-  long __pyx_t_7;
-  long __pyx_t_8;
-  npy_int8 __pyx_t_9;
-  int __pyx_t_10;
-  int __pyx_t_11;
+  PyObject *__pyx_t_5 = NULL;
+  PyArrayObject *__pyx_t_6 = NULL;
+  int __pyx_t_7;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  PyArrayObject *__pyx_t_11 = NULL;
   int __pyx_t_12;
-  PyObject *__pyx_t_13;
+  __pyx_t_5numpy_int8_t __pyx_t_13;
   int __pyx_t_14;
   int __pyx_t_15;
   int __pyx_t_16;
-  int __pyx_t_17;
-  int __pyx_t_18;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__keyfunc,0};
-  __Pyx_RefNannySetupContext("groupby_withnull_old");
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__mapper,&__pyx_n_s__output,0};
+  __Pyx_RefNannySetupContext("groupby");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[2] = {0,0};
+    PyObject* values[3] = {0,0,0};
+    values[2] = ((PyObject *)Py_None);
     switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       case  0: break;
@@ -4506,781 +4525,501 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull_old(PyObject *__pyx_self, Py
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__keyfunc);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__mapper);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupby_withnull_old", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("groupby", 0, 2, 3, 1); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+      case  2:
+      if (kw_args > 0) {
+        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__output);
+        if (unlikely(value)) { values[2] = value; kw_args--; }
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby_withnull_old") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby") < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
-    __pyx_v_index = ((PyArrayObject *)values[0]);
-    __pyx_v_keyfunc = values[1];
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
-    goto __pyx_L5_argtuple_error;
+    __pyx_v_index = values[0];
+    __pyx_v_mapper = values[1];
+    __pyx_v_output = values[2];
   } else {
-    __pyx_v_index = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_keyfunc = PyTuple_GET_ITEM(__pyx_args, 1);
+    __pyx_v_output = ((PyObject *)Py_None);
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  3:
+      __pyx_v_output = PyTuple_GET_ITEM(__pyx_args, 2);
+      case  2:
+      __pyx_v_mapper = PyTuple_GET_ITEM(__pyx_args, 1);
+      __pyx_v_index = PyTuple_GET_ITEM(__pyx_args, 0);
+      break;
+      default: goto __pyx_L5_argtuple_error;
+    }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("groupby_withnull_old", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("groupby", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.groupby_withnull_old");
+  __Pyx_AddTraceback("tseries.groupby");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF(__pyx_v_keyfunc);
-  __pyx_v_groups = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
+  __Pyx_INCREF(__pyx_v_index);
+  __Pyx_INCREF(__pyx_v_mapper);
+  __Pyx_INCREF(__pyx_v_output);
+  __pyx_v_result = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_mapped_index = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_index_buf = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_members = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_curKey = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_key = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_members = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_bool_mask = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_null_values = Py_None; __Pyx_INCREF(Py_None);
+  __pyx_v_nullkeys = Py_None; __Pyx_INCREF(Py_None);
   __pyx_bstruct_mapped_index.buf = NULL;
-  __pyx_bstruct_null_mask.buf = NULL;
-  __pyx_bstruct_index.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
-  __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":20
- * def groupby_withnull_old(ndarray[object, ndim = 1] index, object keyfunc):
- *     cdef dict groups
- *     cdef int length = index.shape[0]             # <<<<<<<<<<<<<<
- *     cdef object idx
- *     cdef object curKey, key
- */
-  __pyx_v_length = (__pyx_v_index->dimensions[0]);
+  __pyx_bstruct_index_buf.buf = NULL;
+  __pyx_bstruct_mask.buf = NULL;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":25
- *     cdef list members
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":30
+ *     cdef object idx, key
  * 
- *     groups = PyDict_New()             # <<<<<<<<<<<<<<
+ *     length = len(index)             # <<<<<<<<<<<<<<
  * 
- *     if length != index.shape[0]:
+ *     if output is None:
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(((PyObject *)__pyx_v_groups));
-  __pyx_v_groups = ((PyObject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_Length(__pyx_v_index); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_length = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":27
- *     groups = PyDict_New()
- * 
- *     if length != index.shape[0]:             # <<<<<<<<<<<<<<
- *         raise Exception('Dates and values were not the same length!')
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":32
+ *     length = len(index)
  * 
+ *     if output is None:             # <<<<<<<<<<<<<<
+ *         result = {}
+ *     else:
  */
-  __pyx_t_2 = (__pyx_v_length != (__pyx_v_index->dimensions[0]));
+  __pyx_t_2 = (__pyx_v_output == Py_None);
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":28
- * 
- *     if length != index.shape[0]:
- *         raise Exception('Dates and values were not the same length!')             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":33
  * 
- *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
+ *     if output is None:
+ *         result = {}             # <<<<<<<<<<<<<<
+ *     else:
+ *         result = <dict> output
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_s_4));
-    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_4));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_4));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_Raise(__pyx_t_3, 0, 0);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
+    __Pyx_DECREF(((PyObject *)__pyx_v_result));
+    __pyx_v_result = __pyx_t_3;
+    __pyx_t_3 = 0;
     goto __pyx_L6;
   }
+  /*else*/ {
+
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":35
+ *         result = {}
+ *     else:
+ *         result = <dict> output             # <<<<<<<<<<<<<<
+ * 
+ *     index_buf = np.asarray(index)
+ */
+    __Pyx_INCREF(((PyObject *)((PyObject *)__pyx_v_output)));
+    __Pyx_DECREF(((PyObject *)__pyx_v_result));
+    __pyx_v_result = ((PyObject *)__pyx_v_output);
+  }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":30
- *         raise Exception('Dates and values were not the same length!')
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":37
+ *         result = <dict> output
  * 
- *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)             # <<<<<<<<<<<<<<
+ *     index_buf = np.asarray(index)             # <<<<<<<<<<<<<<
+ *     mapped_index = arrmap(index_buf, mapper)
  * 
- *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
  */
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__arrmap); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(((PyObject *)__pyx_v_index));
-  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_index));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_index));
-  __Pyx_INCREF(__pyx_v_keyfunc);
-  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_keyfunc);
-  __Pyx_GIVEREF(__pyx_v_keyfunc);
-  __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__asarray); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_INCREF(__pyx_v_index);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_index);
+  __Pyx_GIVEREF(__pyx_v_index);
+  __pyx_t_5 = PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_mapped_index, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
-      __pyx_v_mapped_index = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_mapped_index.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {__pyx_bstride_0_mapped_index = __pyx_bstruct_mapped_index.strides[0];
-      __pyx_bshape_0_mapped_index = __pyx_bstruct_mapped_index.shape[0];
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index_buf);
+    __pyx_t_7 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_index_buf, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_7 < 0)) {
+      PyErr_Fetch(&__pyx_t_8, &__pyx_t_9, &__pyx_t_10);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index_buf, (PyObject*)__pyx_v_index_buf, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_8, __pyx_t_9, __pyx_t_10);
+      }
     }
+    __pyx_bstride_0_index_buf = __pyx_bstruct_index_buf.strides[0];
+    __pyx_bshape_0_index_buf = __pyx_bstruct_index_buf.shape[0];
+    if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
+  __pyx_t_6 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_index_buf));
+  __pyx_v_index_buf = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_v_mapped_index = ((PyArrayObject *)__pyx_t_4);
-  __pyx_t_4 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":32
- *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":38
  * 
- *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)             # <<<<<<<<<<<<<<
+ *     index_buf = np.asarray(index)
+ *     mapped_index = arrmap(index_buf, mapper)             # <<<<<<<<<<<<<<
  * 
- *     bool_mask = null_mask.astype(bool)
+ *     mask = _isnullobj(mapped_index)
  */
-  __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__isnullobj(((PyObject *)__pyx_v_mapped_index))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__arrmap); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_INCREF(((PyObject *)__pyx_v_index_buf));
+  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_index_buf));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_index_buf));
+  __Pyx_INCREF(__pyx_v_mapper);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_mapper);
+  __Pyx_GIVEREF(__pyx_v_mapper);
+  __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_11 = ((PyArrayObject *)__pyx_t_4);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_null_mask, (PyObject*)((PyArrayObject *)__pyx_t_4), &__Pyx_TypeInfo_nn_npy_int8, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
-      __pyx_v_null_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_null_mask.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {__pyx_bstride_0_null_mask = __pyx_bstruct_null_mask.strides[0];
-      __pyx_bshape_0_null_mask = __pyx_bstruct_null_mask.shape[0];
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mapped_index);
+    __pyx_t_7 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_mapped_index, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_7 < 0)) {
+      PyErr_Fetch(&__pyx_t_10, &__pyx_t_9, &__pyx_t_8);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_mapped_index, (PyObject*)__pyx_v_mapped_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_10, __pyx_t_9, __pyx_t_8);
+      }
     }
+    __pyx_bstride_0_mapped_index = __pyx_bstruct_mapped_index.strides[0];
+    __pyx_bshape_0_mapped_index = __pyx_bstruct_mapped_index.shape[0];
+    if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __pyx_v_null_mask = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_11 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_mapped_index));
+  __pyx_v_mapped_index = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":34
- *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":40
+ *     mapped_index = arrmap(index_buf, mapper)
  * 
- *     bool_mask = null_mask.astype(bool)             # <<<<<<<<<<<<<<
+ *     mask = _isnullobj(mapped_index)             # <<<<<<<<<<<<<<
+ *     nullkeys = index_buf[mask.astype(bool)]
  * 
- *     null_values = np.asarray(index)[bool_mask]
  */
-  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_null_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__isnullobj(((PyObject *)__pyx_v_mapped_index))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
-  __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_v_bool_mask);
-  __pyx_v_bool_mask = __pyx_t_3;
-  __pyx_t_3 = 0;
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mask);
+    __pyx_t_7 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_mask, (PyObject*)((PyArrayObject *)__pyx_t_4), &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_7 < 0)) {
+      PyErr_Fetch(&__pyx_t_8, &__pyx_t_9, &__pyx_t_10);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_mask, (PyObject*)__pyx_v_mask, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_8, __pyx_t_9, __pyx_t_10);
+      }
+    }
+    __pyx_bstride_0_mask = __pyx_bstruct_mask.strides[0];
+    __pyx_bshape_0_mask = __pyx_bstruct_mask.shape[0];
+    if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __Pyx_DECREF(((PyObject *)__pyx_v_mask));
+  __pyx_v_mask = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_4 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":36
- *     bool_mask = null_mask.astype(bool)
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":41
  * 
- *     null_values = np.asarray(index)[bool_mask]             # <<<<<<<<<<<<<<
+ *     mask = _isnullobj(mapped_index)
+ *     nullkeys = index_buf[mask.astype(bool)]             # <<<<<<<<<<<<<<
  * 
- *     if null_values.any():
+ *     if nullkeys.any():
  */
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__asarray); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_INCREF(((PyObject *)__pyx_v_index));
-  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_index));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_index));
-  __pyx_t_4 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_GetItem(__pyx_t_4, __pyx_v_bool_mask); if (!__pyx_t_3) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
+  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
+  __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
+  __pyx_t_5 = PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_v_null_values);
-  __pyx_v_null_values = __pyx_t_3;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyObject_GetItem(((PyObject *)__pyx_v_index_buf), __pyx_t_5); if (!__pyx_t_3) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_v_nullkeys);
+  __pyx_v_nullkeys = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":38
- *     null_values = np.asarray(index)[bool_mask]
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":43
+ *     nullkeys = index_buf[mask.astype(bool)]
  * 
- *     if null_values.any():             # <<<<<<<<<<<<<<
- *         PyDict_SetItem(groups, np.NaN, null_values)
+ *     if nullkeys.any():             # <<<<<<<<<<<<<<
+ *         result[np.NaN] = nullkeys
  * 
  */
-  __pyx_t_3 = PyObject_GetAttr(__pyx_v_null_values, __pyx_n_s__any); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_v_nullkeys, __pyx_n_s__any); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":39
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":44
  * 
- *     if null_values.any():
- *         PyDict_SetItem(groups, np.NaN, null_values)             # <<<<<<<<<<<<<<
+ *     if nullkeys.any():
+ *         result[np.NaN] = nullkeys             # <<<<<<<<<<<<<<
  * 
- *     cdef int i = 0
+ *     for i from 0 <= i < length:
  */
-    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__NaN); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_3 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__NaN); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_t_3, __pyx_v_null_values); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_t_3, __pyx_v_nullkeys) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L7;
   }
   __pyx_L7:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":41
- *         PyDict_SetItem(groups, np.NaN, null_values)
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":46
+ *         result[np.NaN] = nullkeys
  * 
- *     cdef int i = 0             # <<<<<<<<<<<<<<
- *     idx = index[0]
- *     key = mapped_index[0]
+ *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
+ *         if mask[i]:
+ *             continue
  */
-  __pyx_v_i = 0;
+  __pyx_t_7 = __pyx_v_length;
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":42
- * 
- *     cdef int i = 0
- *     idx = index[0]             # <<<<<<<<<<<<<<
- *     key = mapped_index[0]
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":47
  * 
+ *     for i from 0 <= i < length:
+ *         if mask[i]:             # <<<<<<<<<<<<<<
+ *             continue
+ *         key = mapped_index[i]
  */
-  __pyx_t_7 = 0;
-  if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_bshape_0_index;
-  __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_7, __pyx_bstride_0_index);
-  __Pyx_INCREF((PyObject*)__pyx_t_3);
-  __Pyx_DECREF(__pyx_v_idx);
-  __pyx_v_idx = __pyx_t_3;
-  __pyx_t_3 = 0;
+    __pyx_t_12 = __pyx_v_i;
+    if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_bshape_0_mask;
+    __pyx_t_13 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_12, __pyx_bstride_0_mask));
+    if (__pyx_t_13) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":43
- *     cdef int i = 0
- *     idx = index[0]
- *     key = mapped_index[0]             # <<<<<<<<<<<<<<
- * 
- *     # Algorithm notes
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":48
+ *     for i from 0 <= i < length:
+ *         if mask[i]:
+ *             continue             # <<<<<<<<<<<<<<
+ *         key = mapped_index[i]
+ *         idx = index_buf[i]
  */
-  __pyx_t_8 = 0;
-  if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_bshape_0_mapped_index;
-  __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_mapped_index.buf, __pyx_t_8, __pyx_bstride_0_mapped_index);
-  __Pyx_INCREF((PyObject*)__pyx_t_3);
-  __Pyx_DECREF(__pyx_v_key);
-  __pyx_v_key = __pyx_t_3;
-  __pyx_t_3 = 0;
+      goto __pyx_L8_continue;
+      goto __pyx_L10;
+    }
+    __pyx_L10:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":49
- *     #   'lazily' evaluates
- * 
- *     while i < length:             # <<<<<<<<<<<<<<
- *         if not PyDict_Contains(groups, key):
- *             members = [idx]
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":49
+ *         if mask[i]:
+ *             continue
+ *         key = mapped_index[i]             # <<<<<<<<<<<<<<
+ *         idx = index_buf[i]
+ *         if key in result:
  */
-  while (1) {
-    __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-    if (!__pyx_t_2) break;
+    __pyx_t_14 = __pyx_v_i;
+    if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_bshape_0_mapped_index;
+    __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_mapped_index.buf, __pyx_t_14, __pyx_bstride_0_mapped_index);
+    __Pyx_INCREF((PyObject*)__pyx_t_3);
+    __Pyx_DECREF(__pyx_v_key);
+    __pyx_v_key = __pyx_t_3;
+    __pyx_t_3 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":50
- * 
- *     while i < length:
- *         if not PyDict_Contains(groups, key):             # <<<<<<<<<<<<<<
- *             members = [idx]
- *             PyDict_SetItem(groups, key, members)
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":50
+ *             continue
+ *         key = mapped_index[i]
+ *         idx = index_buf[i]             # <<<<<<<<<<<<<<
+ *         if key in result:
+ *             members = result[key]
+ */
+    __pyx_t_15 = __pyx_v_i;
+    if (__pyx_t_15 < 0) __pyx_t_15 += __pyx_bshape_0_index_buf;
+    __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index_buf.buf, __pyx_t_15, __pyx_bstride_0_index_buf);
+    __Pyx_INCREF((PyObject*)__pyx_t_3);
+    __Pyx_DECREF(__pyx_v_idx);
+    __pyx_v_idx = __pyx_t_3;
+    __pyx_t_3 = 0;
+
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":51
+ *         key = mapped_index[i]
+ *         idx = index_buf[i]
+ *         if key in result:             # <<<<<<<<<<<<<<
+ *             members = result[key]
+ *             members.append(idx)
  */
-    __pyx_t_6 = PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_2 = (!__pyx_t_6);
+    if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    } else {
+      __pyx_t_2 = ((PyDict_Contains(((PyObject *)__pyx_v_result), __pyx_v_key))); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
     if (__pyx_t_2) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":51
- *     while i < length:
- *         if not PyDict_Contains(groups, key):
- *             members = [idx]             # <<<<<<<<<<<<<<
- *             PyDict_SetItem(groups, key, members)
- *             i += 1
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":52
+ *         idx = index_buf[i]
+ *         if key in result:
+ *             members = result[key]             # <<<<<<<<<<<<<<
+ *             members.append(idx)
+ *         else:
  */
-      __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(((PyObject *)__pyx_t_3));
-      __Pyx_INCREF(__pyx_v_idx);
-      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_idx);
-      __Pyx_GIVEREF(__pyx_v_idx);
+      __pyx_t_3 = PyObject_GetItem(((PyObject *)__pyx_v_result), __pyx_v_key); if (!__pyx_t_3) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_3);
+      if (!(likely(PyList_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected list, got %.200s", Py_TYPE(__pyx_t_3)->tp_name), 0))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(((PyObject *)__pyx_v_members));
-      __pyx_v_members = __pyx_t_3;
+      __pyx_v_members = ((PyObject *)__pyx_t_3);
       __pyx_t_3 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":52
- *         if not PyDict_Contains(groups, key):
- *             members = [idx]
- *             PyDict_SetItem(groups, key, members)             # <<<<<<<<<<<<<<
- *             i += 1
- *             curKey = key
- */
-      __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":53
- *             members = [idx]
- *             PyDict_SetItem(groups, key, members)
- *             i += 1             # <<<<<<<<<<<<<<
- *             curKey = key
- *             while i < length:
- */
-      __pyx_v_i += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":54
- *             PyDict_SetItem(groups, key, members)
- *             i += 1
- *             curKey = key             # <<<<<<<<<<<<<<
- *             while i < length:
- *                 if null_mask[i]:
- */
-      __Pyx_INCREF(__pyx_v_key);
-      __Pyx_DECREF(__pyx_v_curKey);
-      __pyx_v_curKey = __pyx_v_key;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":55
- *             i += 1
- *             curKey = key
- *             while i < length:             # <<<<<<<<<<<<<<
- *                 if null_mask[i]:
- *                     i += 1
- */
-      while (1) {
-        __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-        if (!__pyx_t_2) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":56
- *             curKey = key
- *             while i < length:
- *                 if null_mask[i]:             # <<<<<<<<<<<<<<
- *                     i += 1
- *                     continue
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":53
+ *         if key in result:
+ *             members = result[key]
+ *             members.append(idx)             # <<<<<<<<<<<<<<
+ *         else:
+ *             result[key] = [idx]
  */
-        __pyx_t_6 = __pyx_v_i;
-        if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_bshape_0_null_mask;
-        __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_6, __pyx_bstride_0_null_mask));
-        if (__pyx_t_9) {
+      if (unlikely(__pyx_v_members == Py_None)) {
+        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+      }
+      __pyx_t_16 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      goto __pyx_L11;
+    }
+    /*else*/ {
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":57
- *             while i < length:
- *                 if null_mask[i]:
- *                     i += 1             # <<<<<<<<<<<<<<
- *                     continue
- * 
- */
-          __pyx_v_i += 1;
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":58
- *                 if null_mask[i]:
- *                     i += 1
- *                     continue             # <<<<<<<<<<<<<<
- * 
- *                 idx = index[i]
- */
-          goto __pyx_L11_continue;
-          goto __pyx_L13;
-        }
-        __pyx_L13:;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":60
- *                     continue
- * 
- *                 idx = index[i]             # <<<<<<<<<<<<<<
- *                 key = mapped_index[i]
- *                 if key == curKey:
- */
-        __pyx_t_10 = __pyx_v_i;
-        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_bshape_0_index;
-        __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_10, __pyx_bstride_0_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_3);
-        __Pyx_DECREF(__pyx_v_idx);
-        __pyx_v_idx = __pyx_t_3;
-        __pyx_t_3 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":61
- * 
- *                 idx = index[i]
- *                 key = mapped_index[i]             # <<<<<<<<<<<<<<
- *                 if key == curKey:
- *                     members.append(idx)
- */
-        __pyx_t_11 = __pyx_v_i;
-        if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_bshape_0_mapped_index;
-        __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_mapped_index.buf, __pyx_t_11, __pyx_bstride_0_mapped_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_3);
-        __Pyx_DECREF(__pyx_v_key);
-        __pyx_v_key = __pyx_t_3;
-        __pyx_t_3 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":62
- *                 idx = index[i]
- *                 key = mapped_index[i]
- *                 if key == curKey:             # <<<<<<<<<<<<<<
- *                     members.append(idx)
- *                     i += 1
- */
-        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (__pyx_t_2) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":63
- *                 key = mapped_index[i]
- *                 if key == curKey:
- *                     members.append(idx)             # <<<<<<<<<<<<<<
- *                     i += 1
- *                 else:
- */
-          if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-          }
-          __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":64
- *                 if key == curKey:
- *                     members.append(idx)
- *                     i += 1             # <<<<<<<<<<<<<<
- *                 else:
- *                     break
- */
-          __pyx_v_i += 1;
-          goto __pyx_L14;
-        }
-        /*else*/ {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":66
- *                     i += 1
- *                 else:
- *                     break             # <<<<<<<<<<<<<<
- *         else:
- *             members = <list> PyDict_GetItem(groups, key)
- */
-          goto __pyx_L12_break;
-        }
-        __pyx_L14:;
-        __pyx_L11_continue:;
-      }
-      __pyx_L12_break:;
-      goto __pyx_L10;
-    }
-    /*else*/ {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":68
- *                     break
- *         else:
- *             members = <list> PyDict_GetItem(groups, key)             # <<<<<<<<<<<<<<
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":55
  *             members.append(idx)
- *             i += 1
- */
-      __pyx_t_13 = PyDict_GetItem(((PyObject *)__pyx_v_groups), __pyx_v_key);
-      __Pyx_INCREF(((PyObject *)((PyObject *)__pyx_t_13)));
-      __Pyx_DECREF(((PyObject *)__pyx_v_members));
-      __pyx_v_members = ((PyObject *)__pyx_t_13);
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":69
  *         else:
- *             members = <list> PyDict_GetItem(groups, key)
- *             members.append(idx)             # <<<<<<<<<<<<<<
- *             i += 1
- *             curKey = key
- */
-      if (unlikely(__pyx_v_members == Py_None)) {
-        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-      }
-      __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":70
- *             members = <list> PyDict_GetItem(groups, key)
- *             members.append(idx)
- *             i += 1             # <<<<<<<<<<<<<<
- *             curKey = key
- *             while null_mask[i] and i < length:
- */
-      __pyx_v_i += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":71
- *             members.append(idx)
- *             i += 1
- *             curKey = key             # <<<<<<<<<<<<<<
- *             while null_mask[i] and i < length:
- *                 i += 1
- */
-      __Pyx_INCREF(__pyx_v_key);
-      __Pyx_DECREF(__pyx_v_curKey);
-      __pyx_v_curKey = __pyx_v_key;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":72
- *             i += 1
- *             curKey = key
- *             while null_mask[i] and i < length:             # <<<<<<<<<<<<<<
- *                 i += 1
- * 
- */
-      while (1) {
-        __pyx_t_12 = __pyx_v_i;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_bshape_0_null_mask;
-        __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_12, __pyx_bstride_0_null_mask));
-        if (__pyx_t_9) {
-          __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-          __pyx_t_14 = __pyx_t_2;
-        } else {
-          __pyx_t_14 = __pyx_t_9;
-        }
-        if (!__pyx_t_14) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":73
- *             curKey = key
- *             while null_mask[i] and i < length:
- *                 i += 1             # <<<<<<<<<<<<<<
- * 
- *             while i < length:
- */
-        __pyx_v_i += 1;
-      }
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":75
- *                 i += 1
- * 
- *             while i < length:             # <<<<<<<<<<<<<<
- *                 if null_mask[i]:
- *                     i += 1
- */
-      while (1) {
-        __pyx_t_14 = (__pyx_v_i < __pyx_v_length);
-        if (!__pyx_t_14) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":76
- * 
- *             while i < length:
- *                 if null_mask[i]:             # <<<<<<<<<<<<<<
- *                     i += 1
- *                     continue
- */
-        __pyx_t_15 = __pyx_v_i;
-        if (__pyx_t_15 < 0) __pyx_t_15 += __pyx_bshape_0_null_mask;
-        __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_15, __pyx_bstride_0_null_mask));
-        if (__pyx_t_9) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":77
- *             while i < length:
- *                 if null_mask[i]:
- *                     i += 1             # <<<<<<<<<<<<<<
- *                     continue
- * 
- */
-          __pyx_v_i += 1;
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":78
- *                 if null_mask[i]:
- *                     i += 1
- *                     continue             # <<<<<<<<<<<<<<
- * 
- *                 idx = index[i]
- */
-          goto __pyx_L17_continue;
-          goto __pyx_L19;
-        }
-        __pyx_L19:;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":80
- *                     continue
- * 
- *                 idx = index[i]             # <<<<<<<<<<<<<<
- *                 key = mapped_index[i]
- *                 if key == curKey:
- */
-        __pyx_t_16 = __pyx_v_i;
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_bshape_0_index;
-        __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_16, __pyx_bstride_0_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_3);
-        __Pyx_DECREF(__pyx_v_idx);
-        __pyx_v_idx = __pyx_t_3;
-        __pyx_t_3 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":81
- * 
- *                 idx = index[i]
- *                 key = mapped_index[i]             # <<<<<<<<<<<<<<
- *                 if key == curKey:
- *                     members.append(idx)
- */
-        __pyx_t_17 = __pyx_v_i;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_bshape_0_mapped_index;
-        __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_mapped_index.buf, __pyx_t_17, __pyx_bstride_0_mapped_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_3);
-        __Pyx_DECREF(__pyx_v_key);
-        __pyx_v_key = __pyx_t_3;
-        __pyx_t_3 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":82
- *                 idx = index[i]
- *                 key = mapped_index[i]
- *                 if key == curKey:             # <<<<<<<<<<<<<<
- *                     members.append(idx)
- *                     i += 1
- */
-        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_14 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (__pyx_t_14) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":83
- *                 key = mapped_index[i]
- *                 if key == curKey:
- *                     members.append(idx)             # <<<<<<<<<<<<<<
- *                     i += 1
- *                 else:
- */
-          if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-          }
-          __pyx_t_18 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":84
- *                 if key == curKey:
- *                     members.append(idx)
- *                     i += 1             # <<<<<<<<<<<<<<
- *                 else:
- *                     break
- */
-          __pyx_v_i += 1;
-          goto __pyx_L20;
-        }
-        /*else*/ {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":86
- *                     i += 1
- *                 else:
- *                     break             # <<<<<<<<<<<<<<
+ *             result[key] = [idx]             # <<<<<<<<<<<<<<
  * 
- *     return groups
+ *     return result
  */
-          goto __pyx_L18_break;
-        }
-        __pyx_L20:;
-        __pyx_L17_continue:;
-      }
-      __pyx_L18_break:;
+      __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(((PyObject *)__pyx_t_3));
+      __Pyx_INCREF(__pyx_v_idx);
+      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_idx);
+      __Pyx_GIVEREF(__pyx_v_idx);
+      if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_v_key, ((PyObject *)__pyx_t_3)) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
     }
-    __pyx_L10:;
+    __pyx_L11:;
+    __pyx_L8_continue:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":88
- *                     break
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":57
+ *             result[key] = [idx]
  * 
- *     return groups             # <<<<<<<<<<<<<<
+ *     return result             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False)
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_groups));
-  __pyx_r = ((PyObject *)__pyx_v_groups);
+  __Pyx_INCREF(((PyObject *)__pyx_v_result));
+  __pyx_r = ((PyObject *)__pyx_v_result);
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_null_mask);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index_buf);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mask);
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mapped_index);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries.groupby_withnull_old");
+  __Pyx_AddTraceback("tseries.groupby");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_null_mask);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index_buf);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mask);
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mapped_index);
   __pyx_L2:;
-  __Pyx_DECREF(__pyx_v_groups);
+  __Pyx_DECREF(__pyx_v_result);
+  __Pyx_DECREF((PyObject *)__pyx_v_mapped_index);
+  __Pyx_DECREF((PyObject *)__pyx_v_index_buf);
+  __Pyx_DECREF((PyObject *)__pyx_v_mask);
+  __Pyx_DECREF(__pyx_v_members);
   __Pyx_DECREF(__pyx_v_idx);
-  __Pyx_DECREF(__pyx_v_curKey);
   __Pyx_DECREF(__pyx_v_key);
-  __Pyx_DECREF(__pyx_v_members);
-  __Pyx_XDECREF((PyObject *)__pyx_v_mapped_index);
-  __Pyx_XDECREF((PyObject *)__pyx_v_null_mask);
-  __Pyx_DECREF(__pyx_v_bool_mask);
-  __Pyx_DECREF(__pyx_v_null_values);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF(__pyx_v_keyfunc);
+  __Pyx_DECREF(__pyx_v_nullkeys);
+  __Pyx_DECREF(__pyx_v_index);
+  __Pyx_DECREF(__pyx_v_mapper);
+  __Pyx_DECREF(__pyx_v_output);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":91
+/* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":60
  * 
  * @cython.boundscheck(False)
- * def groupby_withnull(ndarray[object, ndim = 1] index, object keyfunc):             # <<<<<<<<<<<<<<
- *     cdef dict groups
- *     cdef int length = index.shape[0]
+ * def groupby_indices(object index, object mapper):             # <<<<<<<<<<<<<<
+ *     cdef dict result
+ *     cdef ndarray[object, ndim=1] mapped_index
  */
 
-static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_index = 0;
-  PyObject *__pyx_v_keyfunc = 0;
-  PyObject *__pyx_v_groups;
+static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_groupby_indices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_index = 0;
+  PyObject *__pyx_v_mapper = 0;
+  PyObject *__pyx_v_result;
+  PyArrayObject *__pyx_v_mapped_index;
+  PyArrayObject *__pyx_v_mask;
+  int __pyx_v_i;
   int __pyx_v_length;
-  PyObject *__pyx_v_idx;
-  PyObject *__pyx_v_curKey;
+  PyObject *__pyx_v_null_list;
   PyObject *__pyx_v_key;
-  PyObject *__pyx_v_members;
-  PyArrayObject *__pyx_v_mapped_index = 0;
-  PyArrayObject *__pyx_v_null_mask = 0;
-  PyObject *__pyx_v_bool_mask;
-  PyObject *__pyx_v_null_values;
-  int __pyx_v_i;
-  Py_buffer __pyx_bstruct_index;
-  Py_ssize_t __pyx_bstride_0_index = 0;
-  Py_ssize_t __pyx_bshape_0_index = 0;
-  Py_buffer __pyx_bstruct_null_mask;
-  Py_ssize_t __pyx_bstride_0_null_mask = 0;
-  Py_ssize_t __pyx_bshape_0_null_mask = 0;
+  Py_buffer __pyx_bstruct_mask;
+  Py_ssize_t __pyx_bstride_0_mask = 0;
+  Py_ssize_t __pyx_bshape_0_mask = 0;
   Py_buffer __pyx_bstruct_mapped_index;
   Py_ssize_t __pyx_bstride_0_mapped_index = 0;
   Py_ssize_t __pyx_bshape_0_mapped_index = 0;
   PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_t_2;
+  Py_ssize_t __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyArrayObject *__pyx_t_5 = NULL;
   int __pyx_t_6;
-  long __pyx_t_7;
-  long __pyx_t_8;
-  npy_int8 __pyx_t_9;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
   int __pyx_t_10;
   int __pyx_t_11;
-  int __pyx_t_12;
+  __pyx_t_5numpy_int8_t __pyx_t_12;
   int __pyx_t_13;
   int __pyx_t_14;
-  int __pyx_t_15;
-  int __pyx_t_16;
-  int __pyx_t_17;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__keyfunc,0};
-  __Pyx_RefNannySetupContext("groupby_withnull");
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__mapper,0};
+  __Pyx_RefNannySetupContext("groupby_indices");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -5297,1308 +5036,602 @@ static PyObject *__pyx_pf_7tseries_groupby_withnull(PyObject *__pyx_self, PyObje
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__keyfunc);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__mapper);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupby_withnull", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("groupby_indices", 1, 2, 2, 1); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby_withnull") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby_indices") < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
-    __pyx_v_index = ((PyArrayObject *)values[0]);
-    __pyx_v_keyfunc = values[1];
+    __pyx_v_index = values[0];
+    __pyx_v_mapper = values[1];
   } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
     goto __pyx_L5_argtuple_error;
   } else {
-    __pyx_v_index = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_keyfunc = PyTuple_GET_ITEM(__pyx_args, 1);
+    __pyx_v_index = PyTuple_GET_ITEM(__pyx_args, 0);
+    __pyx_v_mapper = PyTuple_GET_ITEM(__pyx_args, 1);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("groupby_withnull", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("groupby_indices", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.groupby_withnull");
+  __Pyx_AddTraceback("tseries.groupby_indices");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF(__pyx_v_keyfunc);
-  __pyx_v_groups = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_curKey = Py_None; __Pyx_INCREF(Py_None);
+  __Pyx_INCREF(__pyx_v_index);
+  __Pyx_INCREF(__pyx_v_mapper);
+  __pyx_v_result = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_mapped_index = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
+  __pyx_v_null_list = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_key = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_members = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_bool_mask = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_null_values = Py_None; __Pyx_INCREF(Py_None);
   __pyx_bstruct_mapped_index.buf = NULL;
-  __pyx_bstruct_null_mask.buf = NULL;
-  __pyx_bstruct_index.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
-  __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":93
- * def groupby_withnull(ndarray[object, ndim = 1] index, object keyfunc):
- *     cdef dict groups
- *     cdef int length = index.shape[0]             # <<<<<<<<<<<<<<
- *     cdef object idx
- *     cdef object curKey, key
- */
-  __pyx_v_length = (__pyx_v_index->dimensions[0]);
+  __pyx_bstruct_mask.buf = NULL;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":98
- *     cdef list members
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":68
+ *     cdef object key
  * 
- *     groups = PyDict_New()             # <<<<<<<<<<<<<<
+ *     length = len(index)             # <<<<<<<<<<<<<<
  * 
- *     if length != index.shape[0]:
+ *     result = {}
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(((PyObject *)__pyx_v_groups));
-  __pyx_v_groups = ((PyObject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_Length(__pyx_v_index); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_length = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":100
- *     groups = PyDict_New()
- * 
- *     if length != index.shape[0]:             # <<<<<<<<<<<<<<
- *         raise Exception('Dates and values were not the same length!')
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":70
+ *     length = len(index)
  * 
+ *     result = {}             # <<<<<<<<<<<<<<
+ *     index = np.asarray(index)
+ *     mapped_index = arrmap(index, mapper)
  */
-  __pyx_t_2 = (__pyx_v_length != (__pyx_v_index->dimensions[0]));
-  if (__pyx_t_2) {
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  __Pyx_DECREF(((PyObject *)__pyx_v_result));
+  __pyx_v_result = __pyx_t_2;
+  __pyx_t_2 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":101
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":71
  * 
- *     if length != index.shape[0]:
- *         raise Exception('Dates and values were not the same length!')             # <<<<<<<<<<<<<<
+ *     result = {}
+ *     index = np.asarray(index)             # <<<<<<<<<<<<<<
+ *     mapped_index = arrmap(index, mapper)
  * 
- *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_s_4));
-    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_4));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_4));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_Raise(__pyx_t_3, 0, 0);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    goto __pyx_L6;
-  }
-  __pyx_L6:;
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__asarray); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_INCREF(__pyx_v_index);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_index);
+  __Pyx_GIVEREF(__pyx_v_index);
+  __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_v_index);
+  __pyx_v_index = __pyx_t_4;
+  __pyx_t_4 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":103
- *         raise Exception('Dates and values were not the same length!')
- * 
- *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":72
+ *     result = {}
+ *     index = np.asarray(index)
+ *     mapped_index = arrmap(index, mapper)             # <<<<<<<<<<<<<<
  * 
- *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
+ *     mask = _isnullobj(mapped_index)
  */
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__arrmap); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(((PyObject *)__pyx_v_index));
-  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_index));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_index));
-  __Pyx_INCREF(__pyx_v_keyfunc);
-  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_keyfunc);
-  __Pyx_GIVEREF(__pyx_v_keyfunc);
-  __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__arrmap); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_INCREF(__pyx_v_index);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_index);
+  __Pyx_GIVEREF(__pyx_v_index);
+  __Pyx_INCREF(__pyx_v_mapper);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_mapper);
+  __Pyx_GIVEREF(__pyx_v_mapper);
+  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = ((PyArrayObject *)__pyx_t_3);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_mapped_index, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
-      __pyx_v_mapped_index = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_mapped_index.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {__pyx_bstride_0_mapped_index = __pyx_bstruct_mapped_index.strides[0];
-      __pyx_bshape_0_mapped_index = __pyx_bstruct_mapped_index.shape[0];
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mapped_index);
+    __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_mapped_index, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_6 < 0)) {
+      PyErr_Fetch(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_mapped_index, (PyObject*)__pyx_v_mapped_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_7); Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_7, __pyx_t_8, __pyx_t_9);
+      }
     }
+    __pyx_bstride_0_mapped_index = __pyx_bstruct_mapped_index.strides[0];
+    __pyx_bshape_0_mapped_index = __pyx_bstruct_mapped_index.shape[0];
+    if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_t_5 = 0;
-  __pyx_v_mapped_index = ((PyArrayObject *)__pyx_t_4);
-  __pyx_t_4 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_mapped_index));
+  __pyx_v_mapped_index = ((PyArrayObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":105
- *     cdef ndarray[object, ndim=1] mapped_index = arrmap(index, keyfunc)
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":74
+ *     mapped_index = arrmap(index, mapper)
  * 
- *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)             # <<<<<<<<<<<<<<
+ *     mask = _isnullobj(mapped_index)             # <<<<<<<<<<<<<<
  * 
- *     bool_mask = null_mask.astype(bool)
+ *     if mask.astype(bool).any():
  */
-  __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__isnullobj(((PyObject *)__pyx_v_mapped_index))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = ((PyObject *)__pyx_f_7tseries__isnullobj(((PyObject *)__pyx_v_mapped_index))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_null_mask, (PyObject*)((PyArrayObject *)__pyx_t_4), &__Pyx_TypeInfo_nn_npy_int8, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
-      __pyx_v_null_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_null_mask.buf = NULL;
-      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {__pyx_bstride_0_null_mask = __pyx_bstruct_null_mask.strides[0];
-      __pyx_bshape_0_null_mask = __pyx_bstruct_null_mask.shape[0];
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mask);
+    __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_mask, (PyObject*)((PyArrayObject *)__pyx_t_3), &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+    if (unlikely(__pyx_t_6 < 0)) {
+      PyErr_Fetch(&__pyx_t_9, &__pyx_t_8, &__pyx_t_7);
+      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_mask, (PyObject*)__pyx_v_mask, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_7);
+        __Pyx_RaiseBufferFallbackError();
+      } else {
+        PyErr_Restore(__pyx_t_9, __pyx_t_8, __pyx_t_7);
+      }
     }
+    __pyx_bstride_0_mask = __pyx_bstruct_mask.strides[0];
+    __pyx_bshape_0_mask = __pyx_bstruct_mask.shape[0];
+    if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __pyx_v_null_mask = ((PyArrayObject *)__pyx_t_4);
-  __pyx_t_4 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_mask));
+  __pyx_v_mask = ((PyArrayObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":107
- *     cdef ndarray[npy_int8, ndim=1] null_mask = _isnullobj(mapped_index)
- * 
- *     bool_mask = null_mask.astype(bool)             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":76
+ *     mask = _isnullobj(mapped_index)
  * 
- *     null_values = np.asarray(index)[bool_mask]
+ *     if mask.astype(bool).any():             # <<<<<<<<<<<<<<
+ *         null_list = []
+ *         result[np.NaN] = null_list
  */
-  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_null_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
+  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
   __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__any); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_v_bool_mask);
-  __pyx_v_bool_mask = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_10 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__pyx_t_10) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":109
- *     bool_mask = null_mask.astype(bool)
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":77
  * 
- *     null_values = np.asarray(index)[bool_mask]             # <<<<<<<<<<<<<<
+ *     if mask.astype(bool).any():
+ *         null_list = []             # <<<<<<<<<<<<<<
+ *         result[np.NaN] = null_list
  * 
- *     if null_values.any():
  */
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__asarray); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_INCREF(((PyObject *)__pyx_v_index));
-  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_index));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_index));
-  __pyx_t_4 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_GetItem(__pyx_t_4, __pyx_v_bool_mask); if (!__pyx_t_3) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_v_null_values);
-  __pyx_v_null_values = __pyx_t_3;
-  __pyx_t_3 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":111
- *     null_values = np.asarray(index)[bool_mask]
- * 
- *     if null_values.any():             # <<<<<<<<<<<<<<
- *         PyDict_SetItem(groups, np.NaN, null_values)
- * 
- */
-  __pyx_t_3 = PyObject_GetAttr(__pyx_v_null_values, __pyx_n_s__any); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__pyx_t_2) {
+    __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
+    __Pyx_DECREF(((PyObject *)__pyx_v_null_list));
+    __pyx_v_null_list = __pyx_t_4;
+    __pyx_t_4 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":112
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":78
+ *     if mask.astype(bool).any():
+ *         null_list = []
+ *         result[np.NaN] = null_list             # <<<<<<<<<<<<<<
  * 
- *     if null_values.any():
- *         PyDict_SetItem(groups, np.NaN, null_values)             # <<<<<<<<<<<<<<
- * 
- *     cdef int i = 0
+ *     for i from 0 <= i < length:
  */
-    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__NaN); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_t_3, __pyx_v_null_values); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    goto __pyx_L7;
+    if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_t_2, ((PyObject *)__pyx_v_null_list)) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    goto __pyx_L6;
   }
-  __pyx_L7:;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":114
- *         PyDict_SetItem(groups, np.NaN, null_values)
- * 
- *     cdef int i = 0             # <<<<<<<<<<<<<<
- *     idx = index[0]
- *     key = mapped_index[0]
- */
-  __pyx_v_i = 0;
+  __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":115
- * 
- *     cdef int i = 0
- *     idx = index[0]             # <<<<<<<<<<<<<<
- *     key = mapped_index[0]
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":80
+ *         result[np.NaN] = null_list
  * 
+ *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
+ *         if mask[i]:
+ *             null_list.append(i)
  */
-  __pyx_t_7 = 0;
-  if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_bshape_0_index;
-  __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_7, __pyx_bstride_0_index);
-  __Pyx_INCREF((PyObject*)__pyx_t_3);
-  __Pyx_DECREF(__pyx_v_idx);
-  __pyx_v_idx = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __pyx_t_6 = __pyx_v_length;
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":116
- *     cdef int i = 0
- *     idx = index[0]
- *     key = mapped_index[0]             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":81
  * 
- *     # Algorithm notes
+ *     for i from 0 <= i < length:
+ *         if mask[i]:             # <<<<<<<<<<<<<<
+ *             null_list.append(i)
+ *         key = mapped_index[i]
  */
-  __pyx_t_8 = 0;
-  if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_bshape_0_mapped_index;
-  __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_mapped_index.buf, __pyx_t_8, __pyx_bstride_0_mapped_index);
-  __Pyx_INCREF((PyObject*)__pyx_t_3);
-  __Pyx_DECREF(__pyx_v_key);
-  __pyx_v_key = __pyx_t_3;
-  __pyx_t_3 = 0;
+    __pyx_t_11 = __pyx_v_i;
+    if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_bshape_0_mask;
+    __pyx_t_12 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_11, __pyx_bstride_0_mask));
+    if (__pyx_t_12) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":122
- *     #   'lazily' evaluates
- * 
- *     while i < length:             # <<<<<<<<<<<<<<
- *         if key not in groups:
- *             members = [idx]
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":82
+ *     for i from 0 <= i < length:
+ *         if mask[i]:
+ *             null_list.append(i)             # <<<<<<<<<<<<<<
+ *         key = mapped_index[i]
+ *         if key in result:
  */
-  while (1) {
-    __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-    if (!__pyx_t_2) break;
+      if (unlikely(__pyx_v_null_list == Py_None)) {
+        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
+      }
+      __pyx_t_2 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_13 = PyList_Append(((PyObject *)__pyx_v_null_list), __pyx_t_2); if (unlikely(__pyx_t_13 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      goto __pyx_L9;
+    }
+    __pyx_L9:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":123
- * 
- *     while i < length:
- *         if key not in groups:             # <<<<<<<<<<<<<<
- *             members = [idx]
- *             groups[key] = members
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":83
+ *         if mask[i]:
+ *             null_list.append(i)
+ *         key = mapped_index[i]             # <<<<<<<<<<<<<<
+ *         if key in result:
+ *             (<list> result[key]).append(i)
+ */
+    __pyx_t_13 = __pyx_v_i;
+    if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_bshape_0_mapped_index;
+    __pyx_t_2 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_mapped_index.buf, __pyx_t_13, __pyx_bstride_0_mapped_index);
+    __Pyx_INCREF((PyObject*)__pyx_t_2);
+    __Pyx_DECREF(__pyx_v_key);
+    __pyx_v_key = __pyx_t_2;
+    __pyx_t_2 = 0;
+
+    /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":84
+ *             null_list.append(i)
+ *         key = mapped_index[i]
+ *         if key in result:             # <<<<<<<<<<<<<<
+ *             (<list> result[key]).append(i)
+ *         else:
  */
-    if (unlikely(((PyObject *)__pyx_v_groups) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_2 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key))); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_10 = ((PyDict_Contains(((PyObject *)__pyx_v_result), __pyx_v_key))); if (unlikely(__pyx_t_10 < 0)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    if (__pyx_t_2) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":124
- *     while i < length:
- *         if key not in groups:
- *             members = [idx]             # <<<<<<<<<<<<<<
- *             groups[key] = members
- *             i += 1
- */
-      __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(((PyObject *)__pyx_t_3));
-      __Pyx_INCREF(__pyx_v_idx);
-      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_idx);
-      __Pyx_GIVEREF(__pyx_v_idx);
-      __Pyx_DECREF(((PyObject *)__pyx_v_members));
-      __pyx_v_members = __pyx_t_3;
-      __pyx_t_3 = 0;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":125
- *         if key not in groups:
- *             members = [idx]
- *             groups[key] = members             # <<<<<<<<<<<<<<
- *             i += 1
- *             curKey = key
- */
-      if (PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":126
- *             members = [idx]
- *             groups[key] = members
- *             i += 1             # <<<<<<<<<<<<<<
- *             curKey = key
- *             while i < length:
- */
-      __pyx_v_i += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":127
- *             groups[key] = members
- *             i += 1
- *             curKey = key             # <<<<<<<<<<<<<<
- *             while i < length:
- *                 if null_mask[i]:
- */
-      __Pyx_INCREF(__pyx_v_key);
-      __Pyx_DECREF(__pyx_v_curKey);
-      __pyx_v_curKey = __pyx_v_key;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":128
- *             i += 1
- *             curKey = key
- *             while i < length:             # <<<<<<<<<<<<<<
- *                 if null_mask[i]:
- *                     i += 1
- */
-      while (1) {
-        __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-        if (!__pyx_t_2) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":129
- *             curKey = key
- *             while i < length:
- *                 if null_mask[i]:             # <<<<<<<<<<<<<<
- *                     i += 1
- *                     continue
- */
-        __pyx_t_6 = __pyx_v_i;
-        if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_bshape_0_null_mask;
-        __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_6, __pyx_bstride_0_null_mask));
-        if (__pyx_t_9) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":130
- *             while i < length:
- *                 if null_mask[i]:
- *                     i += 1             # <<<<<<<<<<<<<<
- *                     continue
- * 
- */
-          __pyx_v_i += 1;
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":131
- *                 if null_mask[i]:
- *                     i += 1
- *                     continue             # <<<<<<<<<<<<<<
- * 
- *                 idx = index[i]
- */
-          goto __pyx_L11_continue;
-          goto __pyx_L13;
-        }
-        __pyx_L13:;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":133
- *                     continue
- * 
- *                 idx = index[i]             # <<<<<<<<<<<<<<
- *                 key = mapped_index[i]
- *                 if key == curKey:
- */
-        __pyx_t_10 = __pyx_v_i;
-        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_bshape_0_index;
-        __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_10, __pyx_bstride_0_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_3);
-        __Pyx_DECREF(__pyx_v_idx);
-        __pyx_v_idx = __pyx_t_3;
-        __pyx_t_3 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":134
- * 
- *                 idx = index[i]
- *                 key = mapped_index[i]             # <<<<<<<<<<<<<<
- *                 if key == curKey:
- *                     members.append(idx)
- */
-        __pyx_t_11 = __pyx_v_i;
-        if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_bshape_0_mapped_index;
-        __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_mapped_index.buf, __pyx_t_11, __pyx_bstride_0_mapped_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_3);
-        __Pyx_DECREF(__pyx_v_key);
-        __pyx_v_key = __pyx_t_3;
-        __pyx_t_3 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":135
- *                 idx = index[i]
- *                 key = mapped_index[i]
- *                 if key == curKey:             # <<<<<<<<<<<<<<
- *                     members.append(idx)
- *                     i += 1
- */
-        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (__pyx_t_2) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":136
- *                 key = mapped_index[i]
- *                 if key == curKey:
- *                     members.append(idx)             # <<<<<<<<<<<<<<
- *                     i += 1
- *                 else:
- */
-          if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-          }
-          __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":137
- *                 if key == curKey:
- *                     members.append(idx)
- *                     i += 1             # <<<<<<<<<<<<<<
- *                 else:
- *                     break
- */
-          __pyx_v_i += 1;
-          goto __pyx_L14;
-        }
-        /*else*/ {
+    if (__pyx_t_10) {
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":139
- *                     i += 1
- *                 else:
- *                     break             # <<<<<<<<<<<<<<
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":85
+ *         key = mapped_index[i]
+ *         if key in result:
+ *             (<list> result[key]).append(i)             # <<<<<<<<<<<<<<
  *         else:
- *             members = <list> groups[key]
+ *             result[key] = [i]
  */
-          goto __pyx_L12_break;
-        }
-        __pyx_L14:;
-        __pyx_L11_continue:;
+      __pyx_t_2 = PyObject_GetItem(((PyObject *)__pyx_v_result), __pyx_v_key); if (!__pyx_t_2) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely(((PyObject *)__pyx_t_2) == Py_None)) {
+        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[4]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
       }
-      __pyx_L12_break:;
+      __pyx_t_4 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_14 = PyList_Append(((PyObject *)((PyObject *)__pyx_t_2)), __pyx_t_4); if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       goto __pyx_L10;
     }
     /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":141
- *                     break
- *         else:
- *             members = <list> groups[key]             # <<<<<<<<<<<<<<
- *             members.append(idx)
- *             i += 1
- */
-      __pyx_t_3 = PyObject_GetItem(((PyObject *)__pyx_v_groups), __pyx_v_key); if (!__pyx_t_3) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_INCREF(((PyObject *)((PyObject *)__pyx_t_3)));
-      __Pyx_DECREF(((PyObject *)__pyx_v_members));
-      __pyx_v_members = ((PyObject *)__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":142
+      /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":87
+ *             (<list> result[key]).append(i)
  *         else:
- *             members = <list> groups[key]
- *             members.append(idx)             # <<<<<<<<<<<<<<
- *             i += 1
- *             curKey = key
- */
-      if (unlikely(__pyx_v_members == Py_None)) {
-        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-      }
-      __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":143
- *             members = <list> groups[key]
- *             members.append(idx)
- *             i += 1             # <<<<<<<<<<<<<<
- *             curKey = key
- *             while null_mask[i] and i < length:
- */
-      __pyx_v_i += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":144
- *             members.append(idx)
- *             i += 1
- *             curKey = key             # <<<<<<<<<<<<<<
- *             while null_mask[i] and i < length:
- *                 i += 1
- */
-      __Pyx_INCREF(__pyx_v_key);
-      __Pyx_DECREF(__pyx_v_curKey);
-      __pyx_v_curKey = __pyx_v_key;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":145
- *             i += 1
- *             curKey = key
- *             while null_mask[i] and i < length:             # <<<<<<<<<<<<<<
- *                 i += 1
- * 
- */
-      while (1) {
-        __pyx_t_12 = __pyx_v_i;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_bshape_0_null_mask;
-        __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_12, __pyx_bstride_0_null_mask));
-        if (__pyx_t_9) {
-          __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-          __pyx_t_13 = __pyx_t_2;
-        } else {
-          __pyx_t_13 = __pyx_t_9;
-        }
-        if (!__pyx_t_13) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":146
- *             curKey = key
- *             while null_mask[i] and i < length:
- *                 i += 1             # <<<<<<<<<<<<<<
- * 
- *             while i < length:
- */
-        __pyx_v_i += 1;
-      }
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":148
- *                 i += 1
- * 
- *             while i < length:             # <<<<<<<<<<<<<<
- *                 if null_mask[i]:
- *                     i += 1
- */
-      while (1) {
-        __pyx_t_13 = (__pyx_v_i < __pyx_v_length);
-        if (!__pyx_t_13) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":149
- * 
- *             while i < length:
- *                 if null_mask[i]:             # <<<<<<<<<<<<<<
- *                     i += 1
- *                     continue
- */
-        __pyx_t_14 = __pyx_v_i;
-        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_bshape_0_null_mask;
-        __pyx_t_9 = (*__Pyx_BufPtrStrided1d(npy_int8 *, __pyx_bstruct_null_mask.buf, __pyx_t_14, __pyx_bstride_0_null_mask));
-        if (__pyx_t_9) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":150
- *             while i < length:
- *                 if null_mask[i]:
- *                     i += 1             # <<<<<<<<<<<<<<
- *                     continue
- * 
- */
-          __pyx_v_i += 1;
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":151
- *                 if null_mask[i]:
- *                     i += 1
- *                     continue             # <<<<<<<<<<<<<<
- * 
- *                 idx = index[i]
- */
-          goto __pyx_L17_continue;
-          goto __pyx_L19;
-        }
-        __pyx_L19:;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":153
- *                     continue
- * 
- *                 idx = index[i]             # <<<<<<<<<<<<<<
- *                 key = mapped_index[i]
- *                 if key == curKey:
- */
-        __pyx_t_15 = __pyx_v_i;
-        if (__pyx_t_15 < 0) __pyx_t_15 += __pyx_bshape_0_index;
-        __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_15, __pyx_bstride_0_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_3);
-        __Pyx_DECREF(__pyx_v_idx);
-        __pyx_v_idx = __pyx_t_3;
-        __pyx_t_3 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":154
- * 
- *                 idx = index[i]
- *                 key = mapped_index[i]             # <<<<<<<<<<<<<<
- *                 if key == curKey:
- *                     members.append(idx)
- */
-        __pyx_t_16 = __pyx_v_i;
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_bshape_0_mapped_index;
-        __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_mapped_index.buf, __pyx_t_16, __pyx_bstride_0_mapped_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_3);
-        __Pyx_DECREF(__pyx_v_key);
-        __pyx_v_key = __pyx_t_3;
-        __pyx_t_3 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":155
- *                 idx = index[i]
- *                 key = mapped_index[i]
- *                 if key == curKey:             # <<<<<<<<<<<<<<
- *                     members.append(idx)
- *                     i += 1
- */
-        __pyx_t_3 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_13 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (__pyx_t_13) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":156
- *                 key = mapped_index[i]
- *                 if key == curKey:
- *                     members.append(idx)             # <<<<<<<<<<<<<<
- *                     i += 1
- *                 else:
- */
-          if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-          }
-          __pyx_t_17 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":157
- *                 if key == curKey:
- *                     members.append(idx)
- *                     i += 1             # <<<<<<<<<<<<<<
- *                 else:
- *                     break
- */
-          __pyx_v_i += 1;
-          goto __pyx_L20;
-        }
-        /*else*/ {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":159
- *                     i += 1
- *                 else:
- *                     break             # <<<<<<<<<<<<<<
+ *             result[key] = [i]             # <<<<<<<<<<<<<<
  * 
- *     return groups
+ *     return result
  */
-          goto __pyx_L18_break;
-        }
-        __pyx_L20:;
-        __pyx_L17_continue:;
-      }
-      __pyx_L18_break:;
+      __pyx_t_4 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+      PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
+      __Pyx_GIVEREF(__pyx_t_4);
+      __pyx_t_4 = 0;
+      if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_v_key, ((PyObject *)__pyx_t_2)) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
     }
     __pyx_L10:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":161
- *                     break
- * 
- *     return groups             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\groupby.pyx":89
+ *             result[key] = [i]
  * 
- * @cython.boundscheck(False)
+ *     return result             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_groups));
-  __pyx_r = ((PyObject *)__pyx_v_groups);
+  __Pyx_INCREF(((PyObject *)__pyx_v_result));
+  __pyx_r = ((PyObject *)__pyx_v_result);
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_null_mask);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mask);
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mapped_index);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries.groupby_withnull");
+  __Pyx_AddTraceback("tseries.groupby_indices");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_null_mask);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mask);
   __Pyx_SafeReleaseBuffer(&__pyx_bstruct_mapped_index);
   __pyx_L2:;
-  __Pyx_DECREF(__pyx_v_groups);
-  __Pyx_DECREF(__pyx_v_idx);
-  __Pyx_DECREF(__pyx_v_curKey);
+  __Pyx_DECREF(__pyx_v_result);
+  __Pyx_DECREF((PyObject *)__pyx_v_mapped_index);
+  __Pyx_DECREF((PyObject *)__pyx_v_mask);
+  __Pyx_DECREF(__pyx_v_null_list);
   __Pyx_DECREF(__pyx_v_key);
-  __Pyx_DECREF(__pyx_v_members);
-  __Pyx_XDECREF((PyObject *)__pyx_v_mapped_index);
-  __Pyx_XDECREF((PyObject *)__pyx_v_null_mask);
-  __Pyx_DECREF(__pyx_v_bool_mask);
-  __Pyx_DECREF(__pyx_v_null_values);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF(__pyx_v_keyfunc);
+  __Pyx_DECREF(__pyx_v_index);
+  __Pyx_DECREF(__pyx_v_mapper);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":164
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":7
+ *     double kth_smallest(double *a, int n, int k)
  * 
- * @cython.boundscheck(False)
- * def groupby(ndarray[object, ndim = 1] index, object keyfunc):             # <<<<<<<<<<<<<<
- *     cdef dict groups
- *     cdef int length = index.shape[0]
+ * def median(ndarray arr):             # <<<<<<<<<<<<<<
+ *     '''
+ *     A faster median
  */
 
-static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_groupby(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_index = 0;
-  PyObject *__pyx_v_keyfunc = 0;
-  PyObject *__pyx_v_groups;
-  int __pyx_v_length;
-  PyObject *__pyx_v_idx;
-  PyObject *__pyx_v_curKey;
-  PyObject *__pyx_v_key;
-  PyObject *__pyx_v_members;
-  int __pyx_v_i;
-  Py_buffer __pyx_bstruct_index;
-  Py_ssize_t __pyx_bstride_0_index = 0;
-  Py_ssize_t __pyx_bshape_0_index = 0;
+static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
+static char __pyx_doc_7tseries_median[] = "\n    A faster median\n    ";
+static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
+  double *__pyx_v_values;
+  int __pyx_v_n;
   PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
+  Py_ssize_t __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
-  int __pyx_t_4;
-  int __pyx_t_5;
-  int __pyx_t_6;
-  PyObject *__pyx_t_7;
-  int __pyx_t_8;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__keyfunc,0};
-  __Pyx_RefNannySetupContext("groupby");
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  long __pyx_t_6;
+  __Pyx_RefNannySetupContext("median");
   __pyx_self = __pyx_self;
-  if (unlikely(__pyx_kwds)) {
-    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[2] = {0,0};
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      case  0: break;
-      default: goto __pyx_L5_argtuple_error;
-    }
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__index);
-      if (likely(values[0])) kw_args--;
-      else goto __pyx_L5_argtuple_error;
-      case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__keyfunc);
-      if (likely(values[1])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("groupby", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-    }
-    if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupby") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    }
-    __pyx_v_index = ((PyArrayObject *)values[0]);
-    __pyx_v_keyfunc = values[1];
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
-    goto __pyx_L5_argtuple_error;
-  } else {
-    __pyx_v_index = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_keyfunc = PyTuple_GET_ITEM(__pyx_args, 1);
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("groupby", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.groupby");
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF(__pyx_v_keyfunc);
-  __pyx_v_groups = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_curKey = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_key = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_members = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_bstruct_index.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
-  __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":166
- * def groupby(ndarray[object, ndim = 1] index, object keyfunc):
- *     cdef dict groups
- *     cdef int length = index.shape[0]             # <<<<<<<<<<<<<<
- *     cdef object idx
- *     cdef object curKey, key
- */
-  __pyx_v_length = (__pyx_v_index->dimensions[0]);
+  __Pyx_INCREF((PyObject *)__pyx_v_arr);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":171
- *     cdef list members
- * 
- *     groups = PyDict_New()             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":12
+ *     '''
+ *     cdef double *values
+ *     cdef int n = len(arr)             # <<<<<<<<<<<<<<
  * 
- *     if length != index.shape[0]:
+ *     if len(arr) == 0:
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(((PyObject *)__pyx_v_groups));
-  __pyx_v_groups = ((PyObject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_n = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":173
- *     groups = PyDict_New()
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":14
+ *     cdef int n = len(arr)
  * 
- *     if length != index.shape[0]:             # <<<<<<<<<<<<<<
- *         raise Exception('Dates and values were not the same length!')
+ *     if len(arr) == 0:             # <<<<<<<<<<<<<<
+ *         return np.NaN
  * 
  */
-  __pyx_t_2 = (__pyx_v_length != (__pyx_v_index->dimensions[0]));
+  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = (__pyx_t_1 == 0);
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":174
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":15
  * 
- *     if length != index.shape[0]:
- *         raise Exception('Dates and values were not the same length!')             # <<<<<<<<<<<<<<
+ *     if len(arr) == 0:
+ *         return np.NaN             # <<<<<<<<<<<<<<
  * 
- *     cdef int i = 0
+ *     if not np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS):
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_s_4));
-    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_4));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_4));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_Raise(__pyx_t_3, 0, 0);
+    __pyx_t_4 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__NaN); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    goto __pyx_L6;
+    __pyx_r = __pyx_t_4;
+    __pyx_t_4 = 0;
+    goto __pyx_L0;
+    goto __pyx_L5;
   }
-  __pyx_L6:;
+  __pyx_L5:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":176
- *         raise Exception('Dates and values were not the same length!')
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":17
+ *         return np.NaN
+ * 
+ *     if not np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS):             # <<<<<<<<<<<<<<
+ *         arr = np.array(arr)
  * 
- *     cdef int i = 0             # <<<<<<<<<<<<<<
- *     idx = index[i]
- *     key = keyfunc(idx)
  */
-  __pyx_v_i = 0;
+  __pyx_t_2 = (!PyArray_CHKFLAGS(((PyArrayObject *)__pyx_v_arr), NPY_C_CONTIGUOUS));
+  if (__pyx_t_2) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":177
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":18
  * 
- *     cdef int i = 0
- *     idx = index[i]             # <<<<<<<<<<<<<<
- *     key = keyfunc(idx)
+ *     if not np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS):
+ *         arr = np.array(arr)             # <<<<<<<<<<<<<<
  * 
+ *     values = <double *> arr.data
  */
-  __pyx_t_4 = __pyx_v_i;
-  if (__pyx_t_4 < 0) __pyx_t_4 += __pyx_bshape_0_index;
-  __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_4, __pyx_bstride_0_index);
-  __Pyx_INCREF((PyObject*)__pyx_t_3);
-  __Pyx_DECREF(__pyx_v_idx);
-  __pyx_v_idx = __pyx_t_3;
-  __pyx_t_3 = 0;
+    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__array); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_INCREF(__pyx_v_arr);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_arr);
+    __Pyx_GIVEREF(__pyx_v_arr);
+    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_v_arr);
+    __pyx_v_arr = __pyx_t_5;
+    __pyx_t_5 = 0;
+    goto __pyx_L6;
+  }
+  __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":178
- *     cdef int i = 0
- *     idx = index[i]
- *     key = keyfunc(idx)             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":20
+ *         arr = np.array(arr)
  * 
- *     # Algorithm notes
- */
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_INCREF(__pyx_v_idx);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_idx);
-  __Pyx_GIVEREF(__pyx_v_idx);
-  __pyx_t_1 = PyObject_Call(__pyx_v_keyfunc, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_v_key);
-  __pyx_v_key = __pyx_t_1;
-  __pyx_t_1 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":183
- *     #   - Tries to reduce the number of calls to PyDict_GetItem, 'lazily' evaluates
+ *     values = <double *> arr.data             # <<<<<<<<<<<<<<
  * 
- *     while i < length:             # <<<<<<<<<<<<<<
- *         if not PyDict_Contains(groups, key):
- *             members = [idx]
+ *     if n % 2:
  */
-  while (1) {
-    __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-    if (!__pyx_t_2) break;
+  __pyx_v_values = ((double *)((PyArrayObject *)__pyx_v_arr)->data);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":184
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":22
+ *     values = <double *> arr.data
  * 
- *     while i < length:
- *         if not PyDict_Contains(groups, key):             # <<<<<<<<<<<<<<
- *             members = [idx]
- *             PyDict_SetItem(groups, key, members)
- */
-    __pyx_t_5 = PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key); if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_2 = (!__pyx_t_5);
-    if (__pyx_t_2) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":185
- *     while i < length:
- *         if not PyDict_Contains(groups, key):
- *             members = [idx]             # <<<<<<<<<<<<<<
- *             PyDict_SetItem(groups, key, members)
- *             i += 1
- */
-      __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-      __Pyx_INCREF(__pyx_v_idx);
-      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_v_idx);
-      __Pyx_GIVEREF(__pyx_v_idx);
-      __Pyx_DECREF(((PyObject *)__pyx_v_members));
-      __pyx_v_members = __pyx_t_1;
-      __pyx_t_1 = 0;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":186
- *         if not PyDict_Contains(groups, key):
- *             members = [idx]
- *             PyDict_SetItem(groups, key, members)             # <<<<<<<<<<<<<<
- *             i += 1
- *             curKey = key
- */
-      __pyx_t_5 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)); if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":187
- *             members = [idx]
- *             PyDict_SetItem(groups, key, members)
- *             i += 1             # <<<<<<<<<<<<<<
- *             curKey = key
- *             while i < length:
- */
-      __pyx_v_i += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":188
- *             PyDict_SetItem(groups, key, members)
- *             i += 1
- *             curKey = key             # <<<<<<<<<<<<<<
- *             while i < length:
- *                 idx = index[i]
- */
-      __Pyx_INCREF(__pyx_v_key);
-      __Pyx_DECREF(__pyx_v_curKey);
-      __pyx_v_curKey = __pyx_v_key;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":189
- *             i += 1
- *             curKey = key
- *             while i < length:             # <<<<<<<<<<<<<<
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)
- */
-      while (1) {
-        __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-        if (!__pyx_t_2) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":190
- *             curKey = key
- *             while i < length:
- *                 idx = index[i]             # <<<<<<<<<<<<<<
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:
- */
-        __pyx_t_5 = __pyx_v_i;
-        if (__pyx_t_5 < 0) __pyx_t_5 += __pyx_bshape_0_index;
-        __pyx_t_1 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_5, __pyx_bstride_0_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_1);
-        __Pyx_DECREF(__pyx_v_idx);
-        __pyx_v_idx = __pyx_t_1;
-        __pyx_t_1 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":191
- *             while i < length:
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
- *                 if key == curKey:
- *                     members.append(idx)
- */
-        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_DECREF(__pyx_v_key);
-        __pyx_v_key = __pyx_t_1;
-        __pyx_t_1 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":192
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:             # <<<<<<<<<<<<<<
- *                     members.append(idx)
- *                     i += 1
- */
-        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (__pyx_t_2) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":193
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:
- *                     members.append(idx)             # <<<<<<<<<<<<<<
- *                     i += 1
- *                 else:
- */
-          if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-          }
-          __pyx_t_6 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":194
- *                 if key == curKey:
- *                     members.append(idx)
- *                     i += 1             # <<<<<<<<<<<<<<
- *                 else:
- *                     break
- */
-          __pyx_v_i += 1;
-          goto __pyx_L12;
-        }
-        /*else*/ {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":196
- *                     i += 1
- *                 else:
- *                     break             # <<<<<<<<<<<<<<
- *         else:
- *             members = <list> PyDict_GetItem(groups, key)
- */
-          goto __pyx_L11_break;
-        }
-        __pyx_L12:;
-      }
-      __pyx_L11_break:;
-      goto __pyx_L9;
-    }
-    /*else*/ {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":198
- *                     break
- *         else:
- *             members = <list> PyDict_GetItem(groups, key)             # <<<<<<<<<<<<<<
- *             members.append(idx)
- *             i += 1
- */
-      __pyx_t_7 = PyDict_GetItem(((PyObject *)__pyx_v_groups), __pyx_v_key);
-      __Pyx_INCREF(((PyObject *)((PyObject *)__pyx_t_7)));
-      __Pyx_DECREF(((PyObject *)__pyx_v_members));
-      __pyx_v_members = ((PyObject *)__pyx_t_7);
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":199
- *         else:
- *             members = <list> PyDict_GetItem(groups, key)
- *             members.append(idx)             # <<<<<<<<<<<<<<
- *             i += 1
- *             curKey = key
- */
-      if (unlikely(__pyx_v_members == Py_None)) {
-        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-      }
-      __pyx_t_6 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":200
- *             members = <list> PyDict_GetItem(groups, key)
- *             members.append(idx)
- *             i += 1             # <<<<<<<<<<<<<<
- *             curKey = key
- *             while i < length:
- */
-      __pyx_v_i += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":201
- *             members.append(idx)
- *             i += 1
- *             curKey = key             # <<<<<<<<<<<<<<
- *             while i < length:
- *                 idx = index[i]
- */
-      __Pyx_INCREF(__pyx_v_key);
-      __Pyx_DECREF(__pyx_v_curKey);
-      __pyx_v_curKey = __pyx_v_key;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":202
- *             i += 1
- *             curKey = key
- *             while i < length:             # <<<<<<<<<<<<<<
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)
- */
-      while (1) {
-        __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-        if (!__pyx_t_2) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":203
- *             curKey = key
- *             while i < length:
- *                 idx = index[i]             # <<<<<<<<<<<<<<
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:
- */
-        __pyx_t_6 = __pyx_v_i;
-        if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_bshape_0_index;
-        __pyx_t_1 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_6, __pyx_bstride_0_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_1);
-        __Pyx_DECREF(__pyx_v_idx);
-        __pyx_v_idx = __pyx_t_1;
-        __pyx_t_1 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":204
- *             while i < length:
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
- *                 if key == curKey:
- *                     members.append(idx)
- */
-        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_DECREF(__pyx_v_key);
-        __pyx_v_key = __pyx_t_1;
-        __pyx_t_1 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":205
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:             # <<<<<<<<<<<<<<
- *                     members.append(idx)
- *                     i += 1
- */
-        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (__pyx_t_2) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":206
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:
- *                     members.append(idx)             # <<<<<<<<<<<<<<
- *                     i += 1
- *                 else:
- */
-          if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-          }
-          __pyx_t_8 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_v_idx); if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":207
- *                 if key == curKey:
- *                     members.append(idx)
- *                     i += 1             # <<<<<<<<<<<<<<
- *                 else:
- *                     break
+ *     if n % 2:             # <<<<<<<<<<<<<<
+ *         return kth_smallest(values, n, n / 2)
+ *     else:
  */
-          __pyx_v_i += 1;
-          goto __pyx_L15;
-        }
-        /*else*/ {
+  __pyx_t_6 = __Pyx_mod_long(__pyx_v_n, 2);
+  if (__pyx_t_6) {
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":209
- *                     i += 1
- *                 else:
- *                     break             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":23
  * 
- *     return groups
+ *     if n % 2:
+ *         return kth_smallest(values, n, n / 2)             # <<<<<<<<<<<<<<
+ *     else:
+ *         return (kth_smallest(values, n, n / 2) +
  */
-          goto __pyx_L14_break;
-        }
-        __pyx_L15:;
-      }
-      __pyx_L14_break:;
-    }
-    __pyx_L9:;
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_5 = PyFloat_FromDouble(kth_smallest(__pyx_v_values, __pyx_v_n, __Pyx_div_long(__pyx_v_n, 2))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_r = __pyx_t_5;
+    __pyx_t_5 = 0;
+    goto __pyx_L0;
+    goto __pyx_L7;
   }
+  /*else*/ {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":211
- *                     break
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":25
+ *         return kth_smallest(values, n, n / 2)
+ *     else:
+ *         return (kth_smallest(values, n, n / 2) +             # <<<<<<<<<<<<<<
+ *                 kth_smallest(values, n, n / 2 - 1)) / 2
  * 
- *     return groups             # <<<<<<<<<<<<<<
+ */
+    __Pyx_XDECREF(__pyx_r);
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":26
+ *     else:
+ *         return (kth_smallest(values, n, n / 2) +
+ *                 kth_smallest(values, n, n / 2 - 1)) / 2             # <<<<<<<<<<<<<<
  * 
- * @cython.boundscheck(False)
+ * #-------------------------------------------------------------------------------
  */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_groups));
-  __pyx_r = ((PyObject *)__pyx_v_groups);
-  goto __pyx_L0;
+    __pyx_t_5 = PyFloat_FromDouble(((kth_smallest(__pyx_v_values, __pyx_v_n, __Pyx_div_long(__pyx_v_n, 2)) + kth_smallest(__pyx_v_values, __pyx_v_n, (__Pyx_div_long(__pyx_v_n, 2) - 1))) / 2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_r = __pyx_t_5;
+    __pyx_t_5 = 0;
+    goto __pyx_L0;
+  }
+  __pyx_L7:;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_3);
-  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
-    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries.groupby");
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("tseries.median");
   __pyx_r = NULL;
-  goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-  __pyx_L2:;
-  __Pyx_DECREF(__pyx_v_groups);
-  __Pyx_DECREF(__pyx_v_idx);
-  __Pyx_DECREF(__pyx_v_curKey);
-  __Pyx_DECREF(__pyx_v_key);
-  __Pyx_DECREF(__pyx_v_members);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF(__pyx_v_keyfunc);
+  __Pyx_DECREF((PyObject *)__pyx_v_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":214
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":31
+ * # Rolling sum
  * 
- * @cython.boundscheck(False)
- * def groupbyfunc(ndarray[object, ndim = 1] index,             # <<<<<<<<<<<<<<
- *                 ndarray[npy_float64, ndim = 1] values,
- *                 object keyfunc, object applyfunc):
+ * def _roll_sum(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *               int win, int minp):
+ *     cdef double val, prev, sum_x = 0
  */
 
-static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7tseries_groupbyfunc[] = "\n    Doing this proper in Cython\n    Not sure how much it will really speed things up\n    ";
-static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_index = 0;
-  PyArrayObject *__pyx_v_values = 0;
-  PyObject *__pyx_v_keyfunc = 0;
-  PyObject *__pyx_v_applyfunc = 0;
-  PyObject *__pyx_v_groups;
-  int __pyx_v_length;
-  PyObject *__pyx_v_idx;
-  PyObject *__pyx_v_curKey;
-  PyObject *__pyx_v_key;
-  PyObject *__pyx_v_members;
-  PyObject *__pyx_v_grouplist;
+static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_input = 0;
+  int __pyx_v_win;
+  int __pyx_v_minp;
+  double __pyx_v_val;
+  double __pyx_v_prev;
+  double __pyx_v_sum_x;
+  int __pyx_v_nobs;
   int __pyx_v_i;
-  Py_buffer __pyx_bstruct_index;
-  Py_ssize_t __pyx_bstride_0_index = 0;
-  Py_ssize_t __pyx_bshape_0_index = 0;
-  Py_buffer __pyx_bstruct_values;
-  Py_ssize_t __pyx_bstride_0_values = 0;
-  Py_ssize_t __pyx_bshape_0_values = 0;
-  PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_t_2;
-  PyObject *__pyx_t_3 = NULL;
-  int __pyx_t_4;
-  int __pyx_t_5;
-  int __pyx_t_6;
+  int __pyx_v_N;
+  PyArrayObject *__pyx_v_output = 0;
+  Py_buffer __pyx_bstruct_output;
+  Py_ssize_t __pyx_bstride_0_output = 0;
+  Py_ssize_t __pyx_bshape_0_output = 0;
+  Py_buffer __pyx_bstruct_input;
+  Py_ssize_t __pyx_bstride_0_input = 0;
+  Py_ssize_t __pyx_bshape_0_input = 0;
+  PyObject *__pyx_r = NULL;
+  Py_ssize_t __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyArrayObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
-  int __pyx_t_8;
-  PyObject *__pyx_t_9;
+  long __pyx_t_8;
+  int __pyx_t_9;
   int __pyx_t_10;
   int __pyx_t_11;
   int __pyx_t_12;
-  Py_ssize_t __pyx_t_13;
-  PyObject *__pyx_t_14 = NULL;
+  int __pyx_t_13;
+  int __pyx_t_14;
   int __pyx_t_15;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__values,&__pyx_n_s__keyfunc,&__pyx_n_s__applyfunc,0};
-  __Pyx_RefNannySetupContext("groupbyfunc");
+  int __pyx_t_16;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,&__pyx_n_s__minp,0};
+  __Pyx_RefNannySetupContext("_roll_sum");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[4] = {0,0,0,0};
+    PyObject* values[3] = {0,0,0};
     switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -6607,852 +5640,485 @@ static PyObject *__pyx_pf_7tseries_groupbyfunc(PyObject *__pyx_self, PyObject *_
     }
     switch (PyTuple_GET_SIZE(__pyx_args)) {
       case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__index);
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__values);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_sum", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__keyfunc);
+      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  3:
-      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__applyfunc);
-      if (likely(values[3])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, 3); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_sum", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "groupbyfunc") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_sum") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
-    __pyx_v_index = ((PyArrayObject *)values[0]);
-    __pyx_v_values = ((PyArrayObject *)values[1]);
-    __pyx_v_keyfunc = values[2];
-    __pyx_v_applyfunc = values[3];
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
+    __pyx_v_input = ((PyArrayObject *)values[0]);
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
-    __pyx_v_index = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_values = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_keyfunc = PyTuple_GET_ITEM(__pyx_args, 2);
-    __pyx_v_applyfunc = PyTuple_GET_ITEM(__pyx_args, 3);
+    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("groupbyfunc", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_sum", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.groupbyfunc");
+  __Pyx_AddTraceback("tseries._roll_sum");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF((PyObject *)__pyx_v_values);
-  __Pyx_INCREF(__pyx_v_keyfunc);
-  __Pyx_INCREF(__pyx_v_applyfunc);
-  __pyx_v_groups = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_curKey = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_key = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_members = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_grouplist = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_bstruct_index.buf = NULL;
-  __pyx_bstruct_values.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
-  __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
+  __Pyx_INCREF((PyObject *)__pyx_v_input);
+  __pyx_bstruct_output.buf = NULL;
+  __pyx_bstruct_input.buf = NULL;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_values, (PyObject*)__pyx_v_values, &__Pyx_TypeInfo_nn_npy_float64, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
-  __pyx_bstride_0_values = __pyx_bstruct_values.strides[0];
-  __pyx_bshape_0_values = __pyx_bstruct_values.shape[0];
+  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
+  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":222
- *     '''
- *     cdef dict groups
- *     cdef int length = values.shape[0]             # <<<<<<<<<<<<<<
- *     cdef object idx
- *     cdef object curKey, key
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":33
+ * def _roll_sum(ndarray[double_t, ndim=1] input,
+ *               int win, int minp):
+ *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
+ *     cdef int nobs = 0, i
+ *     cdef int N = len(input)
  */
-  __pyx_v_length = (__pyx_v_values->dimensions[0]);
+  __pyx_v_sum_x = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":227
- *     cdef list members, grouplist
- * 
- *     groups = PyDict_New()             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":34
+ *               int win, int minp):
+ *     cdef double val, prev, sum_x = 0
+ *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
+ *     cdef int N = len(input)
  * 
- *     if length != index.shape[0]:
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyDict_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(((PyObject *)__pyx_v_groups));
-  __pyx_v_groups = ((PyObject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_v_nobs = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":229
- *     groups = PyDict_New()
- * 
- *     if length != index.shape[0]:             # <<<<<<<<<<<<<<
- *         raise Exception('Dates and values were not the same length!')
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":35
+ *     cdef double val, prev, sum_x = 0
+ *     cdef int nobs = 0, i
+ *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_2 = (__pyx_v_length != (__pyx_v_index->dimensions[0]));
-  if (__pyx_t_2) {
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_N = __pyx_t_1;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":230
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":37
+ *     cdef int N = len(input)
  * 
- *     if length != index.shape[0]:
- *         raise Exception('Dates and values were not the same length!')             # <<<<<<<<<<<<<<
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
- *     cdef int i = 0
+ *     if minp > N:
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_s_4));
-    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_4));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_4));
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_Raise(__pyx_t_3, 0, 0);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    goto __pyx_L6;
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
+      __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
+    }
   }
-  __pyx_L6:;
+  __pyx_t_6 = 0;
+  __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
+  __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":232
- *         raise Exception('Dates and values were not the same length!')
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":39
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
+ * 
+ *     if minp > N:             # <<<<<<<<<<<<<<
+ *         minp = N + 1
  * 
- *     cdef int i = 0             # <<<<<<<<<<<<<<
- *     idx = index[i]
- *     key = trycall(keyfunc, idx)
  */
-  __pyx_v_i = 0;
+  __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
+  if (__pyx_t_7) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":233
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":40
  * 
- *     cdef int i = 0
- *     idx = index[i]             # <<<<<<<<<<<<<<
- *     key = trycall(keyfunc, idx)
+ *     if minp > N:
+ *         minp = N + 1             # <<<<<<<<<<<<<<
  * 
+ *     for i from 0 <= i < minp - 1:
  */
-  __pyx_t_4 = __pyx_v_i;
-  if (__pyx_t_4 < 0) __pyx_t_4 += __pyx_bshape_0_index;
-  __pyx_t_3 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_4, __pyx_bstride_0_index);
-  __Pyx_INCREF((PyObject*)__pyx_t_3);
-  __Pyx_DECREF(__pyx_v_idx);
-  __pyx_v_idx = __pyx_t_3;
-  __pyx_t_3 = 0;
+    __pyx_v_minp = (__pyx_v_N + 1);
+    goto __pyx_L6;
+  }
+  __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":234
- *     cdef int i = 0
- *     idx = index[i]
- *     key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":42
+ *         minp = N + 1
  * 
- *     # Algorithm notes
- */
-  __pyx_t_3 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_v_key);
-  __pyx_v_key = __pyx_t_3;
-  __pyx_t_3 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":240
- *     #   'lazily' evaluates
+ *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
+ *         val = input[i]
  * 
- *     while i < length:             # <<<<<<<<<<<<<<
- *         if not PyDict_Contains(groups, key):
- *             members = [values[i]]
  */
-  while (1) {
-    __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-    if (!__pyx_t_2) break;
+  __pyx_t_8 = (__pyx_v_minp - 1);
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":241
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":43
  * 
- *     while i < length:
- *         if not PyDict_Contains(groups, key):             # <<<<<<<<<<<<<<
- *             members = [values[i]]
- *             PyDict_SetItem(groups, key, members)
- */
-    __pyx_t_5 = PyDict_Contains(((PyObject *)__pyx_v_groups), __pyx_v_key); if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_2 = (!__pyx_t_5);
-    if (__pyx_t_2) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":242
- *     while i < length:
- *         if not PyDict_Contains(groups, key):
- *             members = [values[i]]             # <<<<<<<<<<<<<<
- *             PyDict_SetItem(groups, key, members)
- *             i += 1
- */
-      __pyx_t_5 = __pyx_v_i;
-      if (__pyx_t_5 < 0) __pyx_t_5 += __pyx_bshape_0_values;
-      __pyx_t_3 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_5, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
-      __Pyx_GIVEREF(__pyx_t_3);
-      __pyx_t_3 = 0;
-      __Pyx_DECREF(((PyObject *)__pyx_v_members));
-      __pyx_v_members = __pyx_t_1;
-      __pyx_t_1 = 0;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":243
- *         if not PyDict_Contains(groups, key):
- *             members = [values[i]]
- *             PyDict_SetItem(groups, key, members)             # <<<<<<<<<<<<<<
- *             i += 1
- *             curKey = key
- */
-      __pyx_t_6 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, ((PyObject *)__pyx_v_members)); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":244
- *             members = [values[i]]
- *             PyDict_SetItem(groups, key, members)
- *             i += 1             # <<<<<<<<<<<<<<
- *             curKey = key
- *             while i < length:
- */
-      __pyx_v_i += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":245
- *             PyDict_SetItem(groups, key, members)
- *             i += 1
- *             curKey = key             # <<<<<<<<<<<<<<
- *             while i < length:
- *                 idx = index[i]
- */
-      __Pyx_INCREF(__pyx_v_key);
-      __Pyx_DECREF(__pyx_v_curKey);
-      __pyx_v_curKey = __pyx_v_key;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":246
- *             i += 1
- *             curKey = key
- *             while i < length:             # <<<<<<<<<<<<<<
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)
- */
-      while (1) {
-        __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-        if (!__pyx_t_2) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":247
- *             curKey = key
- *             while i < length:
- *                 idx = index[i]             # <<<<<<<<<<<<<<
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:
- */
-        __pyx_t_6 = __pyx_v_i;
-        if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_bshape_0_index;
-        __pyx_t_1 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_6, __pyx_bstride_0_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_1);
-        __Pyx_DECREF(__pyx_v_idx);
-        __pyx_v_idx = __pyx_t_1;
-        __pyx_t_1 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":248
- *             while i < length:
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
- *                 if key == curKey:
- *                     members.append(values[i])
- */
-        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_DECREF(__pyx_v_key);
-        __pyx_v_key = __pyx_t_1;
-        __pyx_t_1 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":249
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:             # <<<<<<<<<<<<<<
- *                     members.append(values[i])
- *                     i += 1
- */
-        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (__pyx_t_2) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":250
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:
- *                     members.append(values[i])             # <<<<<<<<<<<<<<
- *                     i += 1
- *                 else:
- */
-          if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-          }
-          __pyx_t_7 = __pyx_v_i;
-          if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_bshape_0_values;
-          __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_7, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-          __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_8 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_t_1); if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":251
- *                 if key == curKey:
- *                     members.append(values[i])
- *                     i += 1             # <<<<<<<<<<<<<<
- *                 else:
- *                     break
- */
-          __pyx_v_i += 1;
-          goto __pyx_L12;
-        }
-        /*else*/ {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":253
- *                     i += 1
- *                 else:
- *                     break             # <<<<<<<<<<<<<<
- *         else:
- *             members = <list> PyDict_GetItem(groups, key)
+ *     for i from 0 <= i < minp - 1:
+ *         val = input[i]             # <<<<<<<<<<<<<<
+ * 
+ *         # Not NaN
  */
-          goto __pyx_L11_break;
-        }
-        __pyx_L12:;
-      }
-      __pyx_L11_break:;
-      goto __pyx_L9;
+    __pyx_t_9 = __pyx_v_i;
+    __pyx_t_10 = -1;
+    if (__pyx_t_9 < 0) {
+      __pyx_t_9 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
+    } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
+    if (unlikely(__pyx_t_10 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_10);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    /*else*/ {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":255
- *                     break
- *         else:
- *             members = <list> PyDict_GetItem(groups, key)             # <<<<<<<<<<<<<<
- *             members.append(values[i])
- *             i += 1
- */
-      __pyx_t_9 = PyDict_GetItem(((PyObject *)__pyx_v_groups), __pyx_v_key);
-      __Pyx_INCREF(((PyObject *)((PyObject *)__pyx_t_9)));
-      __Pyx_DECREF(((PyObject *)__pyx_v_members));
-      __pyx_v_members = ((PyObject *)__pyx_t_9);
+    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":256
- *         else:
- *             members = <list> PyDict_GetItem(groups, key)
- *             members.append(values[i])             # <<<<<<<<<<<<<<
- *             i += 1
- *             curKey = key
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":46
+ * 
+ *         # Not NaN
+ *         if val == val:             # <<<<<<<<<<<<<<
+ *             nobs += 1
+ *             sum_x += val
  */
-      if (unlikely(__pyx_v_members == Py_None)) {
-        PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-      }
-      __pyx_t_8 = __pyx_v_i;
-      if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_bshape_0_values;
-      __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_8, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_10 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_t_1); if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
+    if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":257
- *             members = <list> PyDict_GetItem(groups, key)
- *             members.append(values[i])
- *             i += 1             # <<<<<<<<<<<<<<
- *             curKey = key
- *             while i < length:
- */
-      __pyx_v_i += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":258
- *             members.append(values[i])
- *             i += 1
- *             curKey = key             # <<<<<<<<<<<<<<
- *             while i < length:
- *                 idx = index[i]
- */
-      __Pyx_INCREF(__pyx_v_key);
-      __Pyx_DECREF(__pyx_v_curKey);
-      __pyx_v_curKey = __pyx_v_key;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":259
- *             i += 1
- *             curKey = key
- *             while i < length:             # <<<<<<<<<<<<<<
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)
- */
-      while (1) {
-        __pyx_t_2 = (__pyx_v_i < __pyx_v_length);
-        if (!__pyx_t_2) break;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":260
- *             curKey = key
- *             while i < length:
- *                 idx = index[i]             # <<<<<<<<<<<<<<
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:
- */
-        __pyx_t_10 = __pyx_v_i;
-        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_bshape_0_index;
-        __pyx_t_1 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_10, __pyx_bstride_0_index);
-        __Pyx_INCREF((PyObject*)__pyx_t_1);
-        __Pyx_DECREF(__pyx_v_idx);
-        __pyx_v_idx = __pyx_t_1;
-        __pyx_t_1 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":261
- *             while i < length:
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)             # <<<<<<<<<<<<<<
- *                 if key == curKey:
- *                     members.append(values[i])
- */
-        __pyx_t_1 = __pyx_f_7tseries_trycall(__pyx_v_keyfunc, __pyx_v_idx); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_DECREF(__pyx_v_key);
-        __pyx_v_key = __pyx_t_1;
-        __pyx_t_1 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":262
- *                 idx = index[i]
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:             # <<<<<<<<<<<<<<
- *                     members.append(values[i])
- *                     i += 1
- */
-        __pyx_t_1 = PyObject_RichCompare(__pyx_v_key, __pyx_v_curKey, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (__pyx_t_2) {
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":263
- *                 key = trycall(keyfunc, idx)
- *                 if key == curKey:
- *                     members.append(values[i])             # <<<<<<<<<<<<<<
- *                     i += 1
- *                 else:
- */
-          if (unlikely(__pyx_v_members == Py_None)) {
-            PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
-          }
-          __pyx_t_11 = __pyx_v_i;
-          if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_bshape_0_values;
-          __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(npy_float64 *, __pyx_bstruct_values.buf, __pyx_t_11, __pyx_bstride_0_values))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-          __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_12 = PyList_Append(((PyObject *)__pyx_v_members), __pyx_t_1); if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":264
- *                 if key == curKey:
- *                     members.append(values[i])
- *                     i += 1             # <<<<<<<<<<<<<<
- *                 else:
- *                     break
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":47
+ *         # Not NaN
+ *         if val == val:
+ *             nobs += 1             # <<<<<<<<<<<<<<
+ *             sum_x += val
+ * 
  */
-          __pyx_v_i += 1;
-          goto __pyx_L15;
-        }
-        /*else*/ {
+      __pyx_v_nobs += 1;
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":266
- *                     i += 1
- *                 else:
- *                     break             # <<<<<<<<<<<<<<
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":48
+ *         if val == val:
+ *             nobs += 1
+ *             sum_x += val             # <<<<<<<<<<<<<<
  * 
- *     grouplist = PyDict_Keys(groups)
+ *         output[i] = NaN
  */
-          goto __pyx_L14_break;
-        }
-        __pyx_L15:;
-      }
-      __pyx_L14_break:;
+      __pyx_v_sum_x += __pyx_v_val;
+      goto __pyx_L9;
     }
     __pyx_L9:;
-  }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":268
- *                     break
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":50
+ *             sum_x += val
  * 
- *     grouplist = PyDict_Keys(groups)             # <<<<<<<<<<<<<<
+ *         output[i] = NaN             # <<<<<<<<<<<<<<
  * 
- *     i = 0
+ *     for i from minp - 1 <= i < N:
  */
-  __pyx_t_1 = PyDict_Keys(((PyObject *)__pyx_v_groups)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyList_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected list, got %.200s", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(((PyObject *)__pyx_v_grouplist));
-  __pyx_v_grouplist = ((PyObject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+    __pyx_t_10 = __pyx_v_i;
+    __pyx_t_11 = -1;
+    if (__pyx_t_10 < 0) {
+      __pyx_t_10 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
+    } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
+    if (unlikely(__pyx_t_11 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_11);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
+  }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":270
- *     grouplist = PyDict_Keys(groups)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":52
+ *         output[i] = NaN
+ * 
+ *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         val = input[i]
  * 
- *     i = 0             # <<<<<<<<<<<<<<
- *     length = len(grouplist)
- *     for i from 0 <= i < length:
  */
-  __pyx_v_i = 0;
+  __pyx_t_11 = __pyx_v_N;
+  for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":271
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":53
  * 
- *     i = 0
- *     length = len(grouplist)             # <<<<<<<<<<<<<<
- *     for i from 0 <= i < length:
- *         key = grouplist[i]
+ *     for i from minp - 1 <= i < N:
+ *         val = input[i]             # <<<<<<<<<<<<<<
+ * 
+ *         if i > win - 1:
  */
-  __pyx_t_13 = PyObject_Length(((PyObject *)__pyx_v_grouplist)); if (unlikely(__pyx_t_13 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_v_length = __pyx_t_13;
+    __pyx_t_12 = __pyx_v_i;
+    __pyx_t_13 = -1;
+    if (__pyx_t_12 < 0) {
+      __pyx_t_12 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 0;
+    } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
+    if (unlikely(__pyx_t_13 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_13);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":272
- *     i = 0
- *     length = len(grouplist)
- *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
- *         key = grouplist[i]
- *         members = <list> PyDict_GetItem(groups, key)
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":55
+ *         val = input[i]
+ * 
+ *         if i > win - 1:             # <<<<<<<<<<<<<<
+ *             prev = input[i - win]
+ *             if prev == prev:
  */
-  __pyx_t_12 = __pyx_v_length;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_12; __pyx_v_i++) {
+    __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
+    if (__pyx_t_7) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":273
- *     length = len(grouplist)
- *     for i from 0 <= i < length:
- *         key = grouplist[i]             # <<<<<<<<<<<<<<
- *         members = <list> PyDict_GetItem(groups, key)
- *         PyDict_SetItem(groups, key, applyfunc(np.asarray(members)))
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":56
+ * 
+ *         if i > win - 1:
+ *             prev = input[i - win]             # <<<<<<<<<<<<<<
+ *             if prev == prev:
+ *                 sum_x -= prev
  */
-    __pyx_t_1 = __Pyx_GetItemInt_List(((PyObject *)__pyx_v_grouplist), __pyx_v_i, sizeof(int), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_v_key);
-    __pyx_v_key = __pyx_t_1;
-    __pyx_t_1 = 0;
+      __pyx_t_13 = (__pyx_v_i - __pyx_v_win);
+      __pyx_t_14 = -1;
+      if (__pyx_t_13 < 0) {
+        __pyx_t_13 += __pyx_bshape_0_input;
+        if (unlikely(__pyx_t_13 < 0)) __pyx_t_14 = 0;
+      } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
+      if (unlikely(__pyx_t_14 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_14);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":274
- *     for i from 0 <= i < length:
- *         key = grouplist[i]
- *         members = <list> PyDict_GetItem(groups, key)             # <<<<<<<<<<<<<<
- *         PyDict_SetItem(groups, key, applyfunc(np.asarray(members)))
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":57
+ *         if i > win - 1:
+ *             prev = input[i - win]
+ *             if prev == prev:             # <<<<<<<<<<<<<<
+ *                 sum_x -= prev
+ *                 nobs -= 1
+ */
+      __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
+      if (__pyx_t_7) {
+
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":58
+ *             prev = input[i - win]
+ *             if prev == prev:
+ *                 sum_x -= prev             # <<<<<<<<<<<<<<
+ *                 nobs -= 1
  * 
  */
-    __pyx_t_9 = PyDict_GetItem(((PyObject *)__pyx_v_groups), __pyx_v_key);
-    __Pyx_INCREF(((PyObject *)((PyObject *)__pyx_t_9)));
-    __Pyx_DECREF(((PyObject *)__pyx_v_members));
-    __pyx_v_members = ((PyObject *)__pyx_t_9);
+        __pyx_v_sum_x -= __pyx_v_prev;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":275
- *         key = grouplist[i]
- *         members = <list> PyDict_GetItem(groups, key)
- *         PyDict_SetItem(groups, key, applyfunc(np.asarray(members)))             # <<<<<<<<<<<<<<
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":59
+ *             if prev == prev:
+ *                 sum_x -= prev
+ *                 nobs -= 1             # <<<<<<<<<<<<<<
  * 
- *     return groups
+ *         if val == val:
  */
-    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__asarray); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(((PyObject *)__pyx_v_members));
-    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_members));
-    __Pyx_GIVEREF(((PyObject *)__pyx_v_members));
-    __pyx_t_14 = PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_14);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_14);
-    __Pyx_GIVEREF(__pyx_t_14);
-    __pyx_t_14 = 0;
-    __pyx_t_14 = PyObject_Call(__pyx_v_applyfunc, __pyx_t_1, NULL); if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_14);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_15 = PyDict_SetItem(((PyObject *)__pyx_v_groups), __pyx_v_key, __pyx_t_14); if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+        __pyx_v_nobs -= 1;
+        goto __pyx_L13;
+      }
+      __pyx_L13:;
+      goto __pyx_L12;
+    }
+    __pyx_L12:;
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":61
+ *                 nobs -= 1
+ * 
+ *         if val == val:             # <<<<<<<<<<<<<<
+ *             nobs += 1
+ *             sum_x += val
+ */
+    __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
+    if (__pyx_t_7) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":62
+ * 
+ *         if val == val:
+ *             nobs += 1             # <<<<<<<<<<<<<<
+ *             sum_x += val
+ * 
+ */
+      __pyx_v_nobs += 1;
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":63
+ *         if val == val:
+ *             nobs += 1
+ *             sum_x += val             # <<<<<<<<<<<<<<
+ * 
+ *         if nobs >= minp:
+ */
+      __pyx_v_sum_x += __pyx_v_val;
+      goto __pyx_L14;
+    }
+    __pyx_L14:;
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":65
+ *             sum_x += val
+ * 
+ *         if nobs >= minp:             # <<<<<<<<<<<<<<
+ *             output[i] = sum_x
+ *         else:
+ */
+    __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
+    if (__pyx_t_7) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":66
+ * 
+ *         if nobs >= minp:
+ *             output[i] = sum_x             # <<<<<<<<<<<<<<
+ *         else:
+ *             output[i] = NaN
+ */
+      __pyx_t_14 = __pyx_v_i;
+      __pyx_t_15 = -1;
+      if (__pyx_t_14 < 0) {
+        __pyx_t_14 += __pyx_bshape_0_output;
+        if (unlikely(__pyx_t_14 < 0)) __pyx_t_15 = 0;
+      } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
+      if (unlikely(__pyx_t_15 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_15);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_v_sum_x;
+      goto __pyx_L15;
+    }
+    /*else*/ {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":68
+ *             output[i] = sum_x
+ *         else:
+ *             output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ *     return output
+ */
+      __pyx_t_15 = __pyx_v_i;
+      __pyx_t_16 = -1;
+      if (__pyx_t_15 < 0) {
+        __pyx_t_15 += __pyx_bshape_0_output;
+        if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
+      } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
+      if (unlikely(__pyx_t_16 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_16);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_15, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
+    }
+    __pyx_L15:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/groupby.pyx":277
- *         PyDict_SetItem(groups, key, applyfunc(np.asarray(members)))
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":70
+ *             output[i] = NaN
+ * 
+ *     return output             # <<<<<<<<<<<<<<
  * 
- *     return groups             # <<<<<<<<<<<<<<
+ * #-------------------------------------------------------------------------------
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_groups));
-  __pyx_r = ((PyObject *)__pyx_v_groups);
+  __Pyx_INCREF(((PyObject *)__pyx_v_output));
+  __pyx_r = ((PyObject *)__pyx_v_output);
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_14);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_values);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries.groupbyfunc");
+  __Pyx_AddTraceback("tseries._roll_sum");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_values);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __pyx_L2:;
-  __Pyx_DECREF(__pyx_v_groups);
-  __Pyx_DECREF(__pyx_v_idx);
-  __Pyx_DECREF(__pyx_v_curKey);
-  __Pyx_DECREF(__pyx_v_key);
-  __Pyx_DECREF(__pyx_v_members);
-  __Pyx_DECREF(__pyx_v_grouplist);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF((PyObject *)__pyx_v_values);
-  __Pyx_DECREF(__pyx_v_keyfunc);
-  __Pyx_DECREF(__pyx_v_applyfunc);
+  __Pyx_XDECREF((PyObject *)__pyx_v_output);
+  __Pyx_DECREF((PyObject *)__pyx_v_input);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":7
- *     double kth_smallest(double *a, int n, int k)
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":75
+ * # Rolling mean
  * 
- * def median(ndarray arr):             # <<<<<<<<<<<<<<
- *     '''
- *     A faster median
+ * def _roll_mean(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *                int win, int minp):
+ *     cdef double val, prev, sum_x = 0
  */
 
-static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
-static char __pyx_doc_7tseries_median[] = "\n    A faster median\n    ";
-static PyObject *__pyx_pf_7tseries_median(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
-  double *__pyx_v_values;
-  int __pyx_v_n;
+static PyObject *__pyx_pf_7tseries__roll_mean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_mean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_input = 0;
+  int __pyx_v_win;
+  int __pyx_v_minp;
+  double __pyx_v_val;
+  double __pyx_v_prev;
+  double __pyx_v_sum_x;
+  int __pyx_v_nobs;
+  int __pyx_v_i;
+  int __pyx_v_N;
+  PyArrayObject *__pyx_v_output = 0;
+  Py_buffer __pyx_bstruct_output;
+  Py_ssize_t __pyx_bstride_0_output = 0;
+  Py_ssize_t __pyx_bshape_0_output = 0;
+  Py_buffer __pyx_bstruct_input;
+  Py_ssize_t __pyx_bstride_0_input = 0;
+  Py_ssize_t __pyx_bshape_0_input = 0;
   PyObject *__pyx_r = NULL;
   Py_ssize_t __pyx_t_1;
-  int __pyx_t_2;
+  PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  long __pyx_t_6;
-  __Pyx_RefNannySetupContext("median");
-  __pyx_self = __pyx_self;
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":12
- *     '''
- *     cdef double *values
- *     cdef int n = len(arr)             # <<<<<<<<<<<<<<
- * 
- *     if len(arr) == 0:
- */
-  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_v_n = __pyx_t_1;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":14
- *     cdef int n = len(arr)
- * 
- *     if len(arr) == 0:             # <<<<<<<<<<<<<<
- *         return np.NaN
- * 
- */
-  __pyx_t_1 = PyObject_Length(__pyx_v_arr); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = (__pyx_t_1 == 0);
-  if (__pyx_t_2) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":15
- * 
- *     if len(arr) == 0:
- *         return np.NaN             # <<<<<<<<<<<<<<
- * 
- *     if not np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS):
- */
-    __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__NaN); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_r = __pyx_t_4;
-    __pyx_t_4 = 0;
-    goto __pyx_L0;
-    goto __pyx_L5;
-  }
-  __pyx_L5:;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":17
- *         return np.NaN
- * 
- *     if not np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS):             # <<<<<<<<<<<<<<
- *         arr = np.array(arr)
- * 
- */
-  __pyx_t_2 = (!PyArray_CHKFLAGS(((PyArrayObject *)__pyx_v_arr), NPY_C_CONTIGUOUS));
-  if (__pyx_t_2) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":18
- * 
- *     if not np.PyArray_CHKFLAGS(arr, np.NPY_C_CONTIGUOUS):
- *         arr = np.array(arr)             # <<<<<<<<<<<<<<
- * 
- *     values = <double *> arr.data
- */
-    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__array); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_INCREF(__pyx_v_arr);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_arr);
-    __Pyx_GIVEREF(__pyx_v_arr);
-    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_v_arr);
-    __pyx_v_arr = __pyx_t_5;
-    __pyx_t_5 = 0;
-    goto __pyx_L6;
-  }
-  __pyx_L6:;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":20
- *         arr = np.array(arr)
- * 
- *     values = <double *> arr.data             # <<<<<<<<<<<<<<
- * 
- *     if n % 2:
- */
-  __pyx_v_values = ((double *)((PyArrayObject *)__pyx_v_arr)->data);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":22
- *     values = <double *> arr.data
- * 
- *     if n % 2:             # <<<<<<<<<<<<<<
- *         return kth_smallest(values, n, n / 2)
- *     else:
- */
-  __pyx_t_6 = __Pyx_mod_long(__pyx_v_n, 2);
-  if (__pyx_t_6) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":23
- * 
- *     if n % 2:
- *         return kth_smallest(values, n, n / 2)             # <<<<<<<<<<<<<<
- *     else:
- *         return (kth_smallest(values, n, n / 2) +
- */
-    __Pyx_XDECREF(__pyx_r);
-    __pyx_t_5 = PyFloat_FromDouble(kth_smallest(__pyx_v_values, __pyx_v_n, __Pyx_div_long(__pyx_v_n, 2))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_r = __pyx_t_5;
-    __pyx_t_5 = 0;
-    goto __pyx_L0;
-    goto __pyx_L7;
-  }
-  /*else*/ {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":25
- *         return kth_smallest(values, n, n / 2)
- *     else:
- *         return (kth_smallest(values, n, n / 2) +             # <<<<<<<<<<<<<<
- *                 kth_smallest(values, n, n / 2 - 1)) / 2
- * 
- */
-    __Pyx_XDECREF(__pyx_r);
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":26
- *     else:
- *         return (kth_smallest(values, n, n / 2) +
- *                 kth_smallest(values, n, n / 2 - 1)) / 2             # <<<<<<<<<<<<<<
- * 
- * #-------------------------------------------------------------------------------
- */
-    __pyx_t_5 = PyFloat_FromDouble(((kth_smallest(__pyx_v_values, __pyx_v_n, __Pyx_div_long(__pyx_v_n, 2)) + kth_smallest(__pyx_v_values, __pyx_v_n, (__Pyx_div_long(__pyx_v_n, 2) - 1))) / 2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_r = __pyx_t_5;
-    __pyx_t_5 = 0;
-    goto __pyx_L0;
-  }
-  __pyx_L7:;
-
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.median");
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":31
- * # Rolling sum
- * 
- * def _roll_sum(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *               int win, int minp):
- *     cdef double val, prev, sum_x = 0
- */
-
-static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_input = 0;
-  int __pyx_v_win;
-  int __pyx_v_minp;
-  double __pyx_v_val;
-  double __pyx_v_prev;
-  double __pyx_v_sum_x;
-  int __pyx_v_nobs;
-  int __pyx_v_i;
-  int __pyx_v_N;
-  PyArrayObject *__pyx_v_output = 0;
-  Py_buffer __pyx_bstruct_output;
-  Py_ssize_t __pyx_bstride_0_output = 0;
-  Py_ssize_t __pyx_bshape_0_output = 0;
-  Py_buffer __pyx_bstruct_input;
-  Py_ssize_t __pyx_bstride_0_input = 0;
-  Py_ssize_t __pyx_bshape_0_input = 0;
-  PyObject *__pyx_r = NULL;
-  Py_ssize_t __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyArrayObject *__pyx_t_6 = NULL;
-  int __pyx_t_7;
-  long __pyx_t_8;
-  int __pyx_t_9;
-  int __pyx_t_10;
-  int __pyx_t_11;
-  int __pyx_t_12;
-  int __pyx_t_13;
-  int __pyx_t_14;
-  int __pyx_t_15;
-  int __pyx_t_16;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("_roll_sum");
+  PyArrayObject *__pyx_t_6 = NULL;
+  int __pyx_t_7;
+  long __pyx_t_8;
+  int __pyx_t_9;
+  int __pyx_t_10;
+  int __pyx_t_11;
+  int __pyx_t_12;
+  int __pyx_t_13;
+  int __pyx_t_14;
+  int __pyx_t_15;
+  int __pyx_t_16;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,&__pyx_n_s__minp,0};
+  __Pyx_RefNannySetupContext("_roll_mean");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -7473,57 +6139,57 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_sum", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_mean", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_sum", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_mean", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_sum") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_mean") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_sum", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_mean", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_sum");
+  __Pyx_AddTraceback("tseries._roll_mean");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":33
- * def _roll_sum(ndarray[double_t, ndim=1] input,
- *               int win, int minp):
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":77
+ * def _roll_mean(ndarray[double_t, ndim=1] input,
+ *                int win, int minp):
  *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)
  */
   __pyx_v_sum_x = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":34
- *               int win, int minp):
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":78
+ *                int win, int minp):
  *     cdef double val, prev, sum_x = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
  *     cdef int N = len(input)
@@ -7531,50 +6197,50 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
  */
   __pyx_v_nobs = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":35
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":79
  *     cdef double val, prev, sum_x = 0
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":37
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":81
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if minp > N:
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -7583,7 +6249,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":39
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":83
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
@@ -7593,7 +6259,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":40
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":84
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -7605,7 +6271,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
   }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":42
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":86
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -7615,7 +6281,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":43
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":87
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -7630,11 +6296,11 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":46
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":90
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -7644,7 +6310,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":47
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":91
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -7653,7 +6319,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_nobs += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":48
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":92
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -7665,7 +6331,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L9:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":50
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":94
  *             sum_x += val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
@@ -7680,12 +6346,12 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":52
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":96
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -7695,7 +6361,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":53
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":97
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -7710,11 +6376,11 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":55
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":99
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -7724,7 +6390,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":56
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":100
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -7739,11 +6405,11 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":57
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":101
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -7753,7 +6419,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":58
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":102
  *             prev = input[i - win]
  *             if prev == prev:
  *                 sum_x -= prev             # <<<<<<<<<<<<<<
@@ -7762,7 +6428,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
  */
         __pyx_v_sum_x -= __pyx_v_prev;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":59
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":103
  *             if prev == prev:
  *                 sum_x -= prev
  *                 nobs -= 1             # <<<<<<<<<<<<<<
@@ -7777,7 +6443,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L12:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":61
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":105
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -7787,7 +6453,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":62
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":106
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -7796,7 +6462,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
  */
       __pyx_v_nobs += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":63
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":107
  *         if val == val:
  *             nobs += 1
  *             sum_x += val             # <<<<<<<<<<<<<<
@@ -7808,23 +6474,27 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L14:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":65
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":109
  *             sum_x += val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
- *             output[i] = sum_x
+ *             output[i] = sum_x / nobs
  *         else:
  */
     __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":66
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":110
  * 
  *         if nobs >= minp:
- *             output[i] = sum_x             # <<<<<<<<<<<<<<
+ *             output[i] = sum_x / nobs             # <<<<<<<<<<<<<<
  *         else:
  *             output[i] = NaN
  */
+      if (unlikely(__pyx_v_nobs == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
       __pyx_t_14 = __pyx_v_i;
       __pyx_t_15 = -1;
       if (__pyx_t_14 < 0) {
@@ -7833,15 +6503,15 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
       if (unlikely(__pyx_t_15 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_15);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_v_sum_x;
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = (__pyx_v_sum_x / __pyx_v_nobs);
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":68
- *             output[i] = sum_x
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":112
+ *             output[i] = sum_x / nobs
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
  * 
@@ -7855,14 +6525,14 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_15, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
     __pyx_L15:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":70
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":114
  *             output[i] = NaN
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -7886,7 +6556,7 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_sum");
+  __Pyx_AddTraceback("tseries._roll_mean");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
@@ -7900,23 +6570,23 @@ static PyObject *__pyx_pf_7tseries__roll_sum(PyObject *__pyx_self, PyObject *__p
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":75
- * # Rolling mean
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":119
+ * # Exponentially weighted moving average
  * 
- * def _roll_mean(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *                int win, int minp):
- *     cdef double val, prev, sum_x = 0
+ * def _ewma(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *           int com):
+ *     cdef double cur, prev, neww, oldw, adj
  */
 
-static PyObject *__pyx_pf_7tseries__roll_mean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_mean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
-  int __pyx_v_win;
-  int __pyx_v_minp;
-  double __pyx_v_val;
+  int __pyx_v_com;
+  double __pyx_v_cur;
   double __pyx_v_prev;
-  double __pyx_v_sum_x;
-  int __pyx_v_nobs;
+  double __pyx_v_neww;
+  double __pyx_v_oldw;
+  double __pyx_v_adj;
   int __pyx_v_i;
   int __pyx_v_N;
   PyArrayObject *__pyx_v_output = 0;
@@ -7933,24 +6603,28 @@ static PyObject *__pyx_pf_7tseries__roll_mean(PyObject *__pyx_self, PyObject *__
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyArrayObject *__pyx_t_6 = NULL;
-  int __pyx_t_7;
+  double __pyx_t_7;
   long __pyx_t_8;
   int __pyx_t_9;
-  int __pyx_t_10;
+  long __pyx_t_10;
   int __pyx_t_11;
   int __pyx_t_12;
-  int __pyx_t_13;
+  long __pyx_t_13;
   int __pyx_t_14;
   int __pyx_t_15;
   int __pyx_t_16;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("_roll_mean");
+  int __pyx_t_17;
+  int __pyx_t_18;
+  int __pyx_t_19;
+  __pyx_t_5numpy_double_t __pyx_t_20;
+  int __pyx_t_21;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__com,0};
+  __Pyx_RefNannySetupContext("_ewma");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[3] = {0,0,0};
+    PyObject* values[2] = {0,0};
     switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       case  0: break;
@@ -7962,111 +6636,85 @@ static PyObject *__pyx_pf_7tseries__roll_mean(PyObject *__pyx_self, PyObject *__
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__com);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_mean", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
-      if (likely(values[2])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_mean", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_ewma", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_mean") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_ewma") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
+    __pyx_v_com = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_com = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_mean", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_ewma", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_mean");
+  __Pyx_AddTraceback("tseries._ewma");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":77
- * def _roll_mean(ndarray[double_t, ndim=1] input,
- *                int win, int minp):
- *     cdef double val, prev, sum_x = 0             # <<<<<<<<<<<<<<
- *     cdef int nobs = 0, i
- *     cdef int N = len(input)
- */
-  __pyx_v_sum_x = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":78
- *                int win, int minp):
- *     cdef double val, prev, sum_x = 0
- *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
- *     cdef int N = len(input)
- * 
- */
-  __pyx_v_nobs = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":79
- *     cdef double val, prev, sum_x = 0
- *     cdef int nobs = 0, i
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":123
+ *     cdef double cur, prev, neww, oldw, adj
+ *     cdef int i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":81
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":125
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
- *     if minp > N:
+ * 
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -8075,291 +6723,292 @@ static PyObject *__pyx_pf_7tseries__roll_mean(PyObject *__pyx_self, PyObject *__
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":83
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":128
  * 
- *     if minp > N:             # <<<<<<<<<<<<<<
- *         minp = N + 1
  * 
+ *     neww = 1. / (1. + com)             # <<<<<<<<<<<<<<
+ *     oldw = 1. - neww
+ *     adj = oldw
  */
-  __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
-  if (__pyx_t_7) {
+  __pyx_t_7 = (1.0 + __pyx_v_com);
+  if (unlikely(__pyx_t_7 == 0)) {
+    PyErr_Format(PyExc_ZeroDivisionError, "float division");
+    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_v_neww = (1.0 / __pyx_t_7);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":84
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":129
  * 
- *     if minp > N:
- *         minp = N + 1             # <<<<<<<<<<<<<<
+ *     neww = 1. / (1. + com)
+ *     oldw = 1. - neww             # <<<<<<<<<<<<<<
+ *     adj = oldw
  * 
- *     for i from 0 <= i < minp - 1:
  */
-    __pyx_v_minp = (__pyx_v_N + 1);
-    goto __pyx_L6;
-  }
-  __pyx_L6:;
+  __pyx_v_oldw = (1.0 - __pyx_v_neww);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":86
- *         minp = N + 1
- * 
- *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
- *         val = input[i]
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":130
+ *     neww = 1. / (1. + com)
+ *     oldw = 1. - neww
+ *     adj = oldw             # <<<<<<<<<<<<<<
  * 
+ *     output[0] = neww * input[0]
  */
-  __pyx_t_8 = (__pyx_v_minp - 1);
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
+  __pyx_v_adj = __pyx_v_oldw;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":87
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":132
+ *     adj = oldw
  * 
- *     for i from 0 <= i < minp - 1:
- *         val = input[i]             # <<<<<<<<<<<<<<
+ *     output[0] = neww * input[0]             # <<<<<<<<<<<<<<
  * 
- *         # Not NaN
+ *     for i from 1 <= i < N:
  */
-    __pyx_t_9 = __pyx_v_i;
-    __pyx_t_10 = -1;
-    if (__pyx_t_9 < 0) {
-      __pyx_t_9 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
-    } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
-    if (unlikely(__pyx_t_10 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
+  __pyx_t_8 = 0;
+  __pyx_t_9 = -1;
+  if (__pyx_t_8 < 0) {
+    __pyx_t_8 += __pyx_bshape_0_input;
+    if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+  } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_input)) __pyx_t_9 = 0;
+  if (unlikely(__pyx_t_9 != -1)) {
+    __Pyx_RaiseBufferIndexError(__pyx_t_9);
+    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_t_10 = 0;
+  __pyx_t_9 = -1;
+  if (__pyx_t_10 < 0) {
+    __pyx_t_10 += __pyx_bshape_0_output;
+    if (unlikely(__pyx_t_10 < 0)) __pyx_t_9 = 0;
+  } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
+  if (unlikely(__pyx_t_9 != -1)) {
+    __Pyx_RaiseBufferIndexError(__pyx_t_9);
+    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = (__pyx_v_neww * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_8, __pyx_bstride_0_input)));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":90
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":134
+ *     output[0] = neww * input[0]
  * 
- *         # Not NaN
- *         if val == val:             # <<<<<<<<<<<<<<
- *             nobs += 1
- *             sum_x += val
+ *     for i from 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         cur = input[i]
+ *         prev = output[i - 1]
  */
-    __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
-    if (__pyx_t_7) {
+  __pyx_t_9 = __pyx_v_N;
+  for (__pyx_v_i = 1; __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":91
- *         # Not NaN
- *         if val == val:
- *             nobs += 1             # <<<<<<<<<<<<<<
- *             sum_x += val
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":135
+ * 
+ *     for i from 1 <= i < N:
+ *         cur = input[i]             # <<<<<<<<<<<<<<
+ *         prev = output[i - 1]
  * 
  */
-      __pyx_v_nobs += 1;
+    __pyx_t_11 = __pyx_v_i;
+    __pyx_t_12 = -1;
+    if (__pyx_t_11 < 0) {
+      __pyx_t_11 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
+    } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_input)) __pyx_t_12 = 0;
+    if (unlikely(__pyx_t_12 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_12);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_cur = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_11, __pyx_bstride_0_input));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":92
- *         if val == val:
- *             nobs += 1
- *             sum_x += val             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":136
+ *     for i from 1 <= i < N:
+ *         cur = input[i]
+ *         prev = output[i - 1]             # <<<<<<<<<<<<<<
  * 
- *         output[i] = NaN
+ *         if cur == cur:
  */
-      __pyx_v_sum_x += __pyx_v_val;
-      goto __pyx_L9;
+    __pyx_t_13 = (__pyx_v_i - 1);
+    __pyx_t_12 = -1;
+    if (__pyx_t_13 < 0) {
+      __pyx_t_13 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_13 < 0)) __pyx_t_12 = 0;
+    } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_output)) __pyx_t_12 = 0;
+    if (unlikely(__pyx_t_12 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_12);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    __pyx_L9:;
+    __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_13, __pyx_bstride_0_output));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":94
- *             sum_x += val
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":138
+ *         prev = output[i - 1]
  * 
- *         output[i] = NaN             # <<<<<<<<<<<<<<
+ *         if cur == cur:             # <<<<<<<<<<<<<<
+ *             if prev == prev:
+ *                 output[i] = oldw * prev + neww * cur
+ */
+    __pyx_t_14 = (__pyx_v_cur == __pyx_v_cur);
+    if (__pyx_t_14) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":139
  * 
- *     for i from minp - 1 <= i < N:
+ *         if cur == cur:
+ *             if prev == prev:             # <<<<<<<<<<<<<<
+ *                 output[i] = oldw * prev + neww * cur
+ *             else:
  */
-    __pyx_t_10 = __pyx_v_i;
-    __pyx_t_11 = -1;
-    if (__pyx_t_10 < 0) {
-      __pyx_t_10 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
-    } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
-    if (unlikely(__pyx_t_11 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":96
- *         output[i] = NaN
- * 
- *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
- *         val = input[i]
- * 
- */
-  __pyx_t_11 = __pyx_v_N;
-  for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":97
- * 
- *     for i from minp - 1 <= i < N:
- *         val = input[i]             # <<<<<<<<<<<<<<
- * 
- *         if i > win - 1:
- */
-    __pyx_t_12 = __pyx_v_i;
-    __pyx_t_13 = -1;
-    if (__pyx_t_12 < 0) {
-      __pyx_t_12 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 0;
-    } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
-    if (unlikely(__pyx_t_13 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":99
- *         val = input[i]
- * 
- *         if i > win - 1:             # <<<<<<<<<<<<<<
- *             prev = input[i - win]
- *             if prev == prev:
- */
-    __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
-    if (__pyx_t_7) {
+      __pyx_t_14 = (__pyx_v_prev == __pyx_v_prev);
+      if (__pyx_t_14) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":100
- * 
- *         if i > win - 1:
- *             prev = input[i - win]             # <<<<<<<<<<<<<<
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":140
+ *         if cur == cur:
  *             if prev == prev:
- *                 sum_x -= prev
+ *                 output[i] = oldw * prev + neww * cur             # <<<<<<<<<<<<<<
+ *             else:
+ *                 output[i] = neww * cur
  */
-      __pyx_t_13 = (__pyx_v_i - __pyx_v_win);
-      __pyx_t_14 = -1;
-      if (__pyx_t_13 < 0) {
-        __pyx_t_13 += __pyx_bshape_0_input;
-        if (unlikely(__pyx_t_13 < 0)) __pyx_t_14 = 0;
-      } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
-      if (unlikely(__pyx_t_14 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_12 = __pyx_v_i;
+        __pyx_t_15 = -1;
+        if (__pyx_t_12 < 0) {
+          __pyx_t_12 += __pyx_bshape_0_output;
+          if (unlikely(__pyx_t_12 < 0)) __pyx_t_15 = 0;
+        } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
+        if (unlikely(__pyx_t_15 != -1)) {
+          __Pyx_RaiseBufferIndexError(__pyx_t_15);
+          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        }
+        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_12, __pyx_bstride_0_output) = ((__pyx_v_oldw * __pyx_v_prev) + (__pyx_v_neww * __pyx_v_cur));
+        goto __pyx_L9;
       }
-      __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":101
- *         if i > win - 1:
- *             prev = input[i - win]
- *             if prev == prev:             # <<<<<<<<<<<<<<
- *                 sum_x -= prev
- *                 nobs -= 1
- */
-      __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
-      if (__pyx_t_7) {
+      /*else*/ {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":102
- *             prev = input[i - win]
- *             if prev == prev:
- *                 sum_x -= prev             # <<<<<<<<<<<<<<
- *                 nobs -= 1
- * 
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":142
+ *                 output[i] = oldw * prev + neww * cur
+ *             else:
+ *                 output[i] = neww * cur             # <<<<<<<<<<<<<<
+ *         else:
+ *             output[i] = prev
  */
-        __pyx_v_sum_x -= __pyx_v_prev;
+        __pyx_t_15 = __pyx_v_i;
+        __pyx_t_16 = -1;
+        if (__pyx_t_15 < 0) {
+          __pyx_t_15 += __pyx_bshape_0_output;
+          if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
+        } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
+        if (unlikely(__pyx_t_16 != -1)) {
+          __Pyx_RaiseBufferIndexError(__pyx_t_16);
+          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        }
+        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_15, __pyx_bstride_0_output) = (__pyx_v_neww * __pyx_v_cur);
+      }
+      __pyx_L9:;
+      goto __pyx_L8;
+    }
+    /*else*/ {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":103
- *             if prev == prev:
- *                 sum_x -= prev
- *                 nobs -= 1             # <<<<<<<<<<<<<<
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":144
+ *                 output[i] = neww * cur
+ *         else:
+ *             output[i] = prev             # <<<<<<<<<<<<<<
  * 
- *         if val == val:
+ *     for i from 0 <= i < N:
  */
-        __pyx_v_nobs -= 1;
-        goto __pyx_L13;
+      __pyx_t_16 = __pyx_v_i;
+      __pyx_t_17 = -1;
+      if (__pyx_t_16 < 0) {
+        __pyx_t_16 += __pyx_bshape_0_output;
+        if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
+      } else if (unlikely(__pyx_t_16 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
+      if (unlikely(__pyx_t_17 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_17);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      __pyx_L13:;
-      goto __pyx_L12;
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_16, __pyx_bstride_0_output) = __pyx_v_prev;
     }
-    __pyx_L12:;
+    __pyx_L8:;
+  }
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":105
- *                 nobs -= 1
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":146
+ *             output[i] = prev
  * 
- *         if val == val:             # <<<<<<<<<<<<<<
- *             nobs += 1
- *             sum_x += val
+ *     for i from 0 <= i < N:             # <<<<<<<<<<<<<<
+ *         cur = input[i]
+ *         output[i] = output[i] / (1. - adj)
  */
-    __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
-    if (__pyx_t_7) {
+  __pyx_t_9 = __pyx_v_N;
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":106
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":147
  * 
- *         if val == val:
- *             nobs += 1             # <<<<<<<<<<<<<<
- *             sum_x += val
+ *     for i from 0 <= i < N:
+ *         cur = input[i]             # <<<<<<<<<<<<<<
+ *         output[i] = output[i] / (1. - adj)
  * 
  */
-      __pyx_v_nobs += 1;
+    __pyx_t_17 = __pyx_v_i;
+    __pyx_t_18 = -1;
+    if (__pyx_t_17 < 0) {
+      __pyx_t_17 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_17 < 0)) __pyx_t_18 = 0;
+    } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_input)) __pyx_t_18 = 0;
+    if (unlikely(__pyx_t_18 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_18);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_cur = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_17, __pyx_bstride_0_input));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":107
- *         if val == val:
- *             nobs += 1
- *             sum_x += val             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":148
+ *     for i from 0 <= i < N:
+ *         cur = input[i]
+ *         output[i] = output[i] / (1. - adj)             # <<<<<<<<<<<<<<
  * 
- *         if nobs >= minp:
+ *         if cur == cur:
  */
-      __pyx_v_sum_x += __pyx_v_val;
-      goto __pyx_L14;
+    __pyx_t_18 = __pyx_v_i;
+    __pyx_t_19 = -1;
+    if (__pyx_t_18 < 0) {
+      __pyx_t_18 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_18 < 0)) __pyx_t_19 = 0;
+    } else if (unlikely(__pyx_t_18 >= __pyx_bshape_0_output)) __pyx_t_19 = 0;
+    if (unlikely(__pyx_t_19 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_19);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    __pyx_L14:;
+    __pyx_t_20 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_18, __pyx_bstride_0_output));
+    __pyx_t_7 = (1.0 - __pyx_v_adj);
+    if (unlikely(__pyx_t_7 == 0)) {
+      PyErr_Format(PyExc_ZeroDivisionError, "float division");
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_t_19 = __pyx_v_i;
+    __pyx_t_21 = -1;
+    if (__pyx_t_19 < 0) {
+      __pyx_t_19 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_19 < 0)) __pyx_t_21 = 0;
+    } else if (unlikely(__pyx_t_19 >= __pyx_bshape_0_output)) __pyx_t_21 = 0;
+    if (unlikely(__pyx_t_21 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_21);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_19, __pyx_bstride_0_output) = (__pyx_t_20 / __pyx_t_7);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":109
- *             sum_x += val
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":150
+ *         output[i] = output[i] / (1. - adj)
+ * 
+ *         if cur == cur:             # <<<<<<<<<<<<<<
+ *             adj *= oldw
  * 
- *         if nobs >= minp:             # <<<<<<<<<<<<<<
- *             output[i] = sum_x / nobs
- *         else:
  */
-    __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
-    if (__pyx_t_7) {
+    __pyx_t_14 = (__pyx_v_cur == __pyx_v_cur);
+    if (__pyx_t_14) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":110
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":151
  * 
- *         if nobs >= minp:
- *             output[i] = sum_x / nobs             # <<<<<<<<<<<<<<
- *         else:
- *             output[i] = NaN
+ *         if cur == cur:
+ *             adj *= oldw             # <<<<<<<<<<<<<<
+ * 
+ *     return output
  */
-      if (unlikely(__pyx_v_nobs == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_t_14 = __pyx_v_i;
-      __pyx_t_15 = -1;
-      if (__pyx_t_14 < 0) {
-        __pyx_t_14 += __pyx_bshape_0_output;
-        if (unlikely(__pyx_t_14 < 0)) __pyx_t_15 = 0;
-      } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
-      if (unlikely(__pyx_t_15 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_15);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = (__pyx_v_sum_x / __pyx_v_nobs);
-      goto __pyx_L15;
+      __pyx_v_adj *= __pyx_v_oldw;
+      goto __pyx_L12;
     }
-    /*else*/ {
+    __pyx_L12:;
+  }
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":112
- *             output[i] = sum_x / nobs
- *         else:
- *             output[i] = NaN             # <<<<<<<<<<<<<<
- * 
- *     return output
- */
-      __pyx_t_15 = __pyx_v_i;
-      __pyx_t_16 = -1;
-      if (__pyx_t_15 < 0) {
-        __pyx_t_15 += __pyx_bshape_0_output;
-        if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
-      } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
-      if (unlikely(__pyx_t_16 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_15, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
-    }
-    __pyx_L15:;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":114
- *             output[i] = NaN
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":153
+ *             adj *= oldw
  * 
  *     return output             # <<<<<<<<<<<<<<
  * 
@@ -8382,7 +7031,7 @@ static PyObject *__pyx_pf_7tseries__roll_mean(PyObject *__pyx_self, PyObject *__
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_mean");
+  __Pyx_AddTraceback("tseries._ewma");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
@@ -8396,23 +7045,24 @@ static PyObject *__pyx_pf_7tseries__roll_mean(PyObject *__pyx_self, PyObject *__
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":119
- * # Exponentially weighted moving average
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":158
+ * # Rolling variance
  * 
- * def _ewma(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *           int com):
- *     cdef double cur, prev, neww, oldw, adj
+ * def _roll_var(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *               int win, int minp):
+ *     cdef double val, prev, sum_x = 0, sum_xx = 0, nobs = 0
  */
 
-static PyObject *__pyx_pf_7tseries__ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
-  int __pyx_v_com;
-  double __pyx_v_cur;
+  int __pyx_v_win;
+  int __pyx_v_minp;
+  double __pyx_v_val;
   double __pyx_v_prev;
-  double __pyx_v_neww;
-  double __pyx_v_oldw;
-  double __pyx_v_adj;
+  double __pyx_v_sum_x;
+  double __pyx_v_sum_xx;
+  double __pyx_v_nobs;
   int __pyx_v_i;
   int __pyx_v_N;
   PyArrayObject *__pyx_v_output = 0;
@@ -8429,28 +7079,26 @@ static PyObject *__pyx_pf_7tseries__ewma(PyObject *__pyx_self, PyObject *__pyx_a
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyArrayObject *__pyx_t_6 = NULL;
-  double __pyx_t_7;
+  int __pyx_t_7;
   long __pyx_t_8;
   int __pyx_t_9;
-  long __pyx_t_10;
+  int __pyx_t_10;
   int __pyx_t_11;
   int __pyx_t_12;
-  long __pyx_t_13;
+  int __pyx_t_13;
   int __pyx_t_14;
-  int __pyx_t_15;
-  int __pyx_t_16;
+  double __pyx_t_15;
+  double __pyx_t_16;
   int __pyx_t_17;
   int __pyx_t_18;
-  int __pyx_t_19;
-  __pyx_t_5numpy_double_t __pyx_t_20;
-  int __pyx_t_21;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__com,0};
-  __Pyx_RefNannySetupContext("_ewma");
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,&__pyx_n_s__minp,0};
+  __Pyx_RefNannySetupContext("_roll_var");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[2] = {0,0};
+    PyObject* values[3] = {0,0,0};
     switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       case  0: break;
@@ -8462,85 +7110,104 @@ static PyObject *__pyx_pf_7tseries__ewma(PyObject *__pyx_self, PyObject *__pyx_a
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__com);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_ewma", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_var", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+      case  2:
+      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
+      if (likely(values[2])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("_roll_var", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_ewma") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_var") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_com = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_com = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_com == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_ewma", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_var", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._ewma");
+  __Pyx_AddTraceback("tseries._roll_var");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":123
- *     cdef double cur, prev, neww, oldw, adj
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":160
+ * def _roll_var(ndarray[double_t, ndim=1] input,
+ *               int win, int minp):
+ *     cdef double val, prev, sum_x = 0, sum_xx = 0, nobs = 0             # <<<<<<<<<<<<<<
+ *     cdef int i
+ *     cdef int N = len(input)
+ */
+  __pyx_v_sum_x = 0;
+  __pyx_v_sum_xx = 0;
+  __pyx_v_nobs = 0;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":162
+ *     cdef double val, prev, sum_x = 0, sum_xx = 0, nobs = 0
  *     cdef int i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":125
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":164
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
- * 
+ *     if minp > N:
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -8549,296 +7216,324 @@ static PyObject *__pyx_pf_7tseries__ewma(PyObject *__pyx_self, PyObject *__pyx_a
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":128
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":166
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  * 
+ *     if minp > N:             # <<<<<<<<<<<<<<
+ *         minp = N + 1
  * 
- *     neww = 1. / (1. + com)             # <<<<<<<<<<<<<<
- *     oldw = 1. - neww
- *     adj = oldw
  */
-  __pyx_t_7 = (1.0 + __pyx_v_com);
-  if (unlikely(__pyx_t_7 == 0)) {
-    PyErr_Format(PyExc_ZeroDivisionError, "float division");
-    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_v_neww = (1.0 / __pyx_t_7);
+  __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
+  if (__pyx_t_7) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":129
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":167
  * 
- *     neww = 1. / (1. + com)
- *     oldw = 1. - neww             # <<<<<<<<<<<<<<
- *     adj = oldw
+ *     if minp > N:
+ *         minp = N + 1             # <<<<<<<<<<<<<<
  * 
+ *     for i from 0 <= i < minp - 1:
  */
-  __pyx_v_oldw = (1.0 - __pyx_v_neww);
+    __pyx_v_minp = (__pyx_v_N + 1);
+    goto __pyx_L6;
+  }
+  __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":130
- *     neww = 1. / (1. + com)
- *     oldw = 1. - neww
- *     adj = oldw             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":169
+ *         minp = N + 1
+ * 
+ *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
+ *         val = input[i]
  * 
- *     output[0] = neww * input[0]
  */
-  __pyx_v_adj = __pyx_v_oldw;
+  __pyx_t_8 = (__pyx_v_minp - 1);
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":132
- *     adj = oldw
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":170
  * 
- *     output[0] = neww * input[0]             # <<<<<<<<<<<<<<
+ *     for i from 0 <= i < minp - 1:
+ *         val = input[i]             # <<<<<<<<<<<<<<
  * 
- *     for i from 1 <= i < N:
+ *         # Not NaN
  */
-  __pyx_t_8 = 0;
-  __pyx_t_9 = -1;
-  if (__pyx_t_8 < 0) {
-    __pyx_t_8 += __pyx_bshape_0_input;
-    if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
-  } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_input)) __pyx_t_9 = 0;
-  if (unlikely(__pyx_t_9 != -1)) {
-    __Pyx_RaiseBufferIndexError(__pyx_t_9);
-    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_t_10 = 0;
-  __pyx_t_9 = -1;
-  if (__pyx_t_10 < 0) {
-    __pyx_t_10 += __pyx_bshape_0_output;
-    if (unlikely(__pyx_t_10 < 0)) __pyx_t_9 = 0;
-  } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
-  if (unlikely(__pyx_t_9 != -1)) {
-    __Pyx_RaiseBufferIndexError(__pyx_t_9);
-    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = (__pyx_v_neww * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_8, __pyx_bstride_0_input)));
+    __pyx_t_9 = __pyx_v_i;
+    __pyx_t_10 = -1;
+    if (__pyx_t_9 < 0) {
+      __pyx_t_9 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
+    } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
+    if (unlikely(__pyx_t_10 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_10);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":134
- *     output[0] = neww * input[0]
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":173
  * 
- *     for i from 1 <= i < N:             # <<<<<<<<<<<<<<
- *         cur = input[i]
- *         prev = output[i - 1]
+ *         # Not NaN
+ *         if val == val:             # <<<<<<<<<<<<<<
+ *             nobs += 1
+ *             sum_x += val
  */
-  __pyx_t_9 = __pyx_v_N;
-  for (__pyx_v_i = 1; __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
+    __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
+    if (__pyx_t_7) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":174
+ *         # Not NaN
+ *         if val == val:
+ *             nobs += 1             # <<<<<<<<<<<<<<
+ *             sum_x += val
+ *             sum_xx += val * val
+ */
+      __pyx_v_nobs += 1;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":135
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":175
+ *         if val == val:
+ *             nobs += 1
+ *             sum_x += val             # <<<<<<<<<<<<<<
+ *             sum_xx += val * val
  * 
- *     for i from 1 <= i < N:
- *         cur = input[i]             # <<<<<<<<<<<<<<
- *         prev = output[i - 1]
+ */
+      __pyx_v_sum_x += __pyx_v_val;
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":176
+ *             nobs += 1
+ *             sum_x += val
+ *             sum_xx += val * val             # <<<<<<<<<<<<<<
  * 
+ *         output[i] = NaN
  */
-    __pyx_t_11 = __pyx_v_i;
-    __pyx_t_12 = -1;
-    if (__pyx_t_11 < 0) {
-      __pyx_t_11 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
-    } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_input)) __pyx_t_12 = 0;
-    if (unlikely(__pyx_t_12 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_12);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_v_sum_xx += (__pyx_v_val * __pyx_v_val);
+      goto __pyx_L9;
     }
-    __pyx_v_cur = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_11, __pyx_bstride_0_input));
+    __pyx_L9:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":136
- *     for i from 1 <= i < N:
- *         cur = input[i]
- *         prev = output[i - 1]             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":178
+ *             sum_xx += val * val
  * 
- *         if cur == cur:
+ *         output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ *     for i from minp - 1 <= i < N:
  */
-    __pyx_t_13 = (__pyx_v_i - 1);
-    __pyx_t_12 = -1;
-    if (__pyx_t_13 < 0) {
-      __pyx_t_13 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_13 < 0)) __pyx_t_12 = 0;
-    } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_output)) __pyx_t_12 = 0;
-    if (unlikely(__pyx_t_12 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_12);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __pyx_v_i;
+    __pyx_t_11 = -1;
+    if (__pyx_t_10 < 0) {
+      __pyx_t_10 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
+    } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
+    if (unlikely(__pyx_t_11 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_11);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
-    __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_13, __pyx_bstride_0_output));
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
+  }
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":138
- *         prev = output[i - 1]
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":180
+ *         output[i] = NaN
+ * 
+ *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         val = input[i]
  * 
- *         if cur == cur:             # <<<<<<<<<<<<<<
- *             if prev == prev:
- *                 output[i] = oldw * prev + neww * cur
  */
-    __pyx_t_14 = (__pyx_v_cur == __pyx_v_cur);
-    if (__pyx_t_14) {
+  __pyx_t_11 = __pyx_v_N;
+  for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":139
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":181
  * 
- *         if cur == cur:
- *             if prev == prev:             # <<<<<<<<<<<<<<
- *                 output[i] = oldw * prev + neww * cur
- *             else:
+ *     for i from minp - 1 <= i < N:
+ *         val = input[i]             # <<<<<<<<<<<<<<
+ * 
+ *         if i > win - 1:
  */
-      __pyx_t_14 = (__pyx_v_prev == __pyx_v_prev);
-      if (__pyx_t_14) {
+    __pyx_t_12 = __pyx_v_i;
+    __pyx_t_13 = -1;
+    if (__pyx_t_12 < 0) {
+      __pyx_t_12 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 0;
+    } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
+    if (unlikely(__pyx_t_13 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_13);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":140
- *         if cur == cur:
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":183
+ *         val = input[i]
+ * 
+ *         if i > win - 1:             # <<<<<<<<<<<<<<
+ *             prev = input[i - win]
  *             if prev == prev:
- *                 output[i] = oldw * prev + neww * cur             # <<<<<<<<<<<<<<
- *             else:
- *                 output[i] = neww * cur
  */
-        __pyx_t_12 = __pyx_v_i;
-        __pyx_t_15 = -1;
-        if (__pyx_t_12 < 0) {
-          __pyx_t_12 += __pyx_bshape_0_output;
-          if (unlikely(__pyx_t_12 < 0)) __pyx_t_15 = 0;
-        } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_output)) __pyx_t_15 = 0;
-        if (unlikely(__pyx_t_15 != -1)) {
-          __Pyx_RaiseBufferIndexError(__pyx_t_15);
-          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        }
-        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_12, __pyx_bstride_0_output) = ((__pyx_v_oldw * __pyx_v_prev) + (__pyx_v_neww * __pyx_v_cur));
-        goto __pyx_L9;
-      }
-      /*else*/ {
+    __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
+    if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":142
- *                 output[i] = oldw * prev + neww * cur
- *             else:
- *                 output[i] = neww * cur             # <<<<<<<<<<<<<<
- *         else:
- *             output[i] = prev
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":184
+ * 
+ *         if i > win - 1:
+ *             prev = input[i - win]             # <<<<<<<<<<<<<<
+ *             if prev == prev:
+ *                 sum_x -= prev
  */
-        __pyx_t_15 = __pyx_v_i;
-        __pyx_t_16 = -1;
-        if (__pyx_t_15 < 0) {
-          __pyx_t_15 += __pyx_bshape_0_output;
-          if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
-        } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
-        if (unlikely(__pyx_t_16 != -1)) {
-          __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        }
-        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_15, __pyx_bstride_0_output) = (__pyx_v_neww * __pyx_v_cur);
+      __pyx_t_13 = (__pyx_v_i - __pyx_v_win);
+      __pyx_t_14 = -1;
+      if (__pyx_t_13 < 0) {
+        __pyx_t_13 += __pyx_bshape_0_input;
+        if (unlikely(__pyx_t_13 < 0)) __pyx_t_14 = 0;
+      } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
+      if (unlikely(__pyx_t_14 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_14);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      __pyx_L9:;
-      goto __pyx_L8;
-    }
-    /*else*/ {
+      __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":144
- *                 output[i] = neww * cur
- *         else:
- *             output[i] = prev             # <<<<<<<<<<<<<<
- * 
- *     for i from 0 <= i < N:
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":185
+ *         if i > win - 1:
+ *             prev = input[i - win]
+ *             if prev == prev:             # <<<<<<<<<<<<<<
+ *                 sum_x -= prev
+ *                 sum_xx -= prev * prev
  */
-      __pyx_t_16 = __pyx_v_i;
-      __pyx_t_17 = -1;
-      if (__pyx_t_16 < 0) {
-        __pyx_t_16 += __pyx_bshape_0_output;
-        if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
-      } else if (unlikely(__pyx_t_16 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
-      if (unlikely(__pyx_t_17 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_17);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_16, __pyx_bstride_0_output) = __pyx_v_prev;
-    }
-    __pyx_L8:;
-  }
+      __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
+      if (__pyx_t_7) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":146
- *             output[i] = prev
- * 
- *     for i from 0 <= i < N:             # <<<<<<<<<<<<<<
- *         cur = input[i]
- *         output[i] = output[i] / (1. - adj)
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":186
+ *             prev = input[i - win]
+ *             if prev == prev:
+ *                 sum_x -= prev             # <<<<<<<<<<<<<<
+ *                 sum_xx -= prev * prev
+ *                 nobs -= 1
  */
-  __pyx_t_9 = __pyx_v_N;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
+        __pyx_v_sum_x -= __pyx_v_prev;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":147
- * 
- *     for i from 0 <= i < N:
- *         cur = input[i]             # <<<<<<<<<<<<<<
- *         output[i] = output[i] / (1. - adj)
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":187
+ *             if prev == prev:
+ *                 sum_x -= prev
+ *                 sum_xx -= prev * prev             # <<<<<<<<<<<<<<
+ *                 nobs -= 1
  * 
  */
-    __pyx_t_17 = __pyx_v_i;
-    __pyx_t_18 = -1;
-    if (__pyx_t_17 < 0) {
-      __pyx_t_17 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_17 < 0)) __pyx_t_18 = 0;
-    } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_input)) __pyx_t_18 = 0;
-    if (unlikely(__pyx_t_18 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_18);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_v_cur = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_17, __pyx_bstride_0_input));
+        __pyx_v_sum_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":148
- *     for i from 0 <= i < N:
- *         cur = input[i]
- *         output[i] = output[i] / (1. - adj)             # <<<<<<<<<<<<<<
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":188
+ *                 sum_x -= prev
+ *                 sum_xx -= prev * prev
+ *                 nobs -= 1             # <<<<<<<<<<<<<<
  * 
- *         if cur == cur:
+ *         if val == val:
  */
-    __pyx_t_18 = __pyx_v_i;
-    __pyx_t_19 = -1;
-    if (__pyx_t_18 < 0) {
-      __pyx_t_18 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_18 < 0)) __pyx_t_19 = 0;
-    } else if (unlikely(__pyx_t_18 >= __pyx_bshape_0_output)) __pyx_t_19 = 0;
-    if (unlikely(__pyx_t_19 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_t_20 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_18, __pyx_bstride_0_output));
-    __pyx_t_7 = (1.0 - __pyx_v_adj);
-    if (unlikely(__pyx_t_7 == 0)) {
-      PyErr_Format(PyExc_ZeroDivisionError, "float division");
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_t_19 = __pyx_v_i;
-    __pyx_t_21 = -1;
-    if (__pyx_t_19 < 0) {
-      __pyx_t_19 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_19 < 0)) __pyx_t_21 = 0;
-    } else if (unlikely(__pyx_t_19 >= __pyx_bshape_0_output)) __pyx_t_21 = 0;
-    if (unlikely(__pyx_t_21 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_21);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_v_nobs -= 1;
+        goto __pyx_L13;
+      }
+      __pyx_L13:;
+      goto __pyx_L12;
     }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_19, __pyx_bstride_0_output) = (__pyx_t_20 / __pyx_t_7);
+    __pyx_L12:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":150
- *         output[i] = output[i] / (1. - adj)
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":190
+ *                 nobs -= 1
  * 
- *         if cur == cur:             # <<<<<<<<<<<<<<
- *             adj *= oldw
+ *         if val == val:             # <<<<<<<<<<<<<<
+ *             nobs += 1
+ *             sum_x += val
+ */
+    __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
+    if (__pyx_t_7) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":191
  * 
+ *         if val == val:
+ *             nobs += 1             # <<<<<<<<<<<<<<
+ *             sum_x += val
+ *             sum_xx += val * val
  */
-    __pyx_t_14 = (__pyx_v_cur == __pyx_v_cur);
-    if (__pyx_t_14) {
+      __pyx_v_nobs += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":151
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":192
+ *         if val == val:
+ *             nobs += 1
+ *             sum_x += val             # <<<<<<<<<<<<<<
+ *             sum_xx += val * val
  * 
- *         if cur == cur:
- *             adj *= oldw             # <<<<<<<<<<<<<<
+ */
+      __pyx_v_sum_x += __pyx_v_val;
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":193
+ *             nobs += 1
+ *             sum_x += val
+ *             sum_xx += val * val             # <<<<<<<<<<<<<<
  * 
- *     return output
+ *         if nobs >= minp:
  */
-      __pyx_v_adj *= __pyx_v_oldw;
-      goto __pyx_L12;
+      __pyx_v_sum_xx += (__pyx_v_val * __pyx_v_val);
+      goto __pyx_L14;
     }
-    __pyx_L12:;
-  }
+    __pyx_L14:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":153
- *             adj *= oldw
- * 
- *     return output             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":195
+ *             sum_xx += val * val
  * 
- * #-------------------------------------------------------------------------------
+ *         if nobs >= minp:             # <<<<<<<<<<<<<<
+ *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)
+ *         else:
+ */
+    __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
+    if (__pyx_t_7) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":196
+ * 
+ *         if nobs >= minp:
+ *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)             # <<<<<<<<<<<<<<
+ *         else:
+ *             output[i] = NaN
+ */
+      __pyx_t_15 = ((__pyx_v_nobs * __pyx_v_sum_xx) - (__pyx_v_sum_x * __pyx_v_sum_x));
+      __pyx_t_16 = ((__pyx_v_nobs * __pyx_v_nobs) - __pyx_v_nobs);
+      if (unlikely(__pyx_t_16 == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_t_14 = __pyx_v_i;
+      __pyx_t_17 = -1;
+      if (__pyx_t_14 < 0) {
+        __pyx_t_14 += __pyx_bshape_0_output;
+        if (unlikely(__pyx_t_14 < 0)) __pyx_t_17 = 0;
+      } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
+      if (unlikely(__pyx_t_17 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_17);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = (__pyx_t_15 / __pyx_t_16);
+      goto __pyx_L15;
+    }
+    /*else*/ {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":198
+ *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)
+ *         else:
+ *             output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ *     return output
+ */
+      __pyx_t_17 = __pyx_v_i;
+      __pyx_t_18 = -1;
+      if (__pyx_t_17 < 0) {
+        __pyx_t_17 += __pyx_bshape_0_output;
+        if (unlikely(__pyx_t_17 < 0)) __pyx_t_18 = 0;
+      } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_output)) __pyx_t_18 = 0;
+      if (unlikely(__pyx_t_18 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_18);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_17, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
+    }
+    __pyx_L15:;
+  }
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":200
+ *             output[i] = NaN
+ * 
+ *     return output             # <<<<<<<<<<<<<<
+ * 
+ * #-------------------------------------------------------------------------------
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_output));
@@ -8857,7 +7552,7 @@ static PyObject *__pyx_pf_7tseries__ewma(PyObject *__pyx_self, PyObject *__pyx_a
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._ewma");
+  __Pyx_AddTraceback("tseries._roll_var");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
@@ -8871,27 +7566,32 @@ static PyObject *__pyx_pf_7tseries__ewma(PyObject *__pyx_self, PyObject *__pyx_a
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":158
- * # Rolling variance
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":205
+ * # Rolling skewness
  * 
- * def _roll_var(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *               int win, int minp):
- *     cdef double val, prev, sum_x = 0, sum_xx = 0, nobs = 0
+ * def _roll_skew(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *                int win, int minp):
+ *     cdef double val, prev
  */
 
-static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   int __pyx_v_win;
   int __pyx_v_minp;
   double __pyx_v_val;
   double __pyx_v_prev;
-  double __pyx_v_sum_x;
-  double __pyx_v_sum_xx;
-  double __pyx_v_nobs;
+  double __pyx_v_x;
+  double __pyx_v_xx;
+  double __pyx_v_xxx;
+  int __pyx_v_nobs;
   int __pyx_v_i;
   int __pyx_v_N;
   PyArrayObject *__pyx_v_output = 0;
+  double __pyx_v_A;
+  double __pyx_v_B;
+  double __pyx_v_C;
+  double __pyx_v_R;
   Py_buffer __pyx_bstruct_output;
   Py_ssize_t __pyx_bstride_0_output = 0;
   Py_ssize_t __pyx_bshape_0_output = 0;
@@ -8918,7 +7618,7 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
   int __pyx_t_17;
   int __pyx_t_18;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("_roll_var");
+  __Pyx_RefNannySetupContext("_roll_skew");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -8939,101 +7639,110 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_var", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_skew", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_var", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_skew", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_var") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_skew") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_var", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_skew", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_var");
+  __Pyx_AddTraceback("tseries._roll_skew");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":160
- * def _roll_var(ndarray[double_t, ndim=1] input,
- *               int win, int minp):
- *     cdef double val, prev, sum_x = 0, sum_xx = 0, nobs = 0             # <<<<<<<<<<<<<<
- *     cdef int i
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":208
+ *                int win, int minp):
+ *     cdef double val, prev
+ *     cdef double x = 0, xx = 0, xxx = 0             # <<<<<<<<<<<<<<
+ *     cdef int nobs = 0, i
  *     cdef int N = len(input)
  */
-  __pyx_v_sum_x = 0;
-  __pyx_v_sum_xx = 0;
+  __pyx_v_x = 0;
+  __pyx_v_xx = 0;
+  __pyx_v_xxx = 0;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":209
+ *     cdef double val, prev
+ *     cdef double x = 0, xx = 0, xxx = 0
+ *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
+ *     cdef int N = len(input)
+ * 
+ */
   __pyx_v_nobs = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":162
- *     cdef double val, prev, sum_x = 0, sum_xx = 0, nobs = 0
- *     cdef int i
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":210
+ *     cdef double x = 0, xx = 0, xxx = 0
+ *     cdef int nobs = 0, i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":164
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":212
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
- *     if minp > N:
+ *     # 3 components of the skewness equation
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -9042,8 +7751,8 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":166
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":217
+ *     cdef double A, B, C, R
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
  *         minp = N + 1
@@ -9052,7 +7761,7 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":167
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":218
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -9064,7 +7773,7 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
   }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":169
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":220
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -9074,7 +7783,7 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":170
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":221
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9089,52 +7798,61 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":173
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":224
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
  *             nobs += 1
- *             sum_x += val
+ *             x += val
  */
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":174
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":225
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
- *             sum_x += val
- *             sum_xx += val * val
+ *             x += val
+ *             xx += val * val
  */
       __pyx_v_nobs += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":175
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":226
  *         if val == val:
  *             nobs += 1
- *             sum_x += val             # <<<<<<<<<<<<<<
- *             sum_xx += val * val
- * 
+ *             x += val             # <<<<<<<<<<<<<<
+ *             xx += val * val
+ *             xxx += val * val * val
  */
-      __pyx_v_sum_x += __pyx_v_val;
+      __pyx_v_x += __pyx_v_val;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":176
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":227
  *             nobs += 1
- *             sum_x += val
- *             sum_xx += val * val             # <<<<<<<<<<<<<<
+ *             x += val
+ *             xx += val * val             # <<<<<<<<<<<<<<
+ *             xxx += val * val * val
+ * 
+ */
+      __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":228
+ *             x += val
+ *             xx += val * val
+ *             xxx += val * val * val             # <<<<<<<<<<<<<<
  * 
  *         output[i] = NaN
  */
-      __pyx_v_sum_xx += (__pyx_v_val * __pyx_v_val);
+      __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
       goto __pyx_L9;
     }
     __pyx_L9:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":178
- *             sum_xx += val * val
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":230
+ *             xxx += val * val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
  * 
@@ -9148,12 +7866,12 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":180
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":232
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -9163,7 +7881,7 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":181
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":233
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9178,11 +7896,11 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":183
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":235
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -9192,12 +7910,12 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":184
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":236
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
  *             if prev == prev:
- *                 sum_x -= prev
+ *                 x -= prev
  */
       __pyx_t_13 = (__pyx_v_i - __pyx_v_win);
       __pyx_t_14 = -1;
@@ -9207,41 +7925,50 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":185
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":237
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
- *                 sum_x -= prev
- *                 sum_xx -= prev * prev
+ *                 x -= prev
+ *                 xx -= prev * prev
  */
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":186
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":238
  *             prev = input[i - win]
  *             if prev == prev:
- *                 sum_x -= prev             # <<<<<<<<<<<<<<
- *                 sum_xx -= prev * prev
- *                 nobs -= 1
+ *                 x -= prev             # <<<<<<<<<<<<<<
+ *                 xx -= prev * prev
+ *                 xxx -= prev * prev * prev
  */
-        __pyx_v_sum_x -= __pyx_v_prev;
+        __pyx_v_x -= __pyx_v_prev;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":187
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":239
  *             if prev == prev:
- *                 sum_x -= prev
- *                 sum_xx -= prev * prev             # <<<<<<<<<<<<<<
- *                 nobs -= 1
+ *                 x -= prev
+ *                 xx -= prev * prev             # <<<<<<<<<<<<<<
+ *                 xxx -= prev * prev * prev
  * 
  */
-        __pyx_v_sum_xx -= (__pyx_v_prev * __pyx_v_prev);
+        __pyx_v_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":188
- *                 sum_x -= prev
- *                 sum_xx -= prev * prev
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":240
+ *                 x -= prev
+ *                 xx -= prev * prev
+ *                 xxx -= prev * prev * prev             # <<<<<<<<<<<<<<
+ * 
+ *                 nobs -= 1
+ */
+        __pyx_v_xxx -= ((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev);
+
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":242
+ *                 xxx -= prev * prev * prev
+ * 
  *                 nobs -= 1             # <<<<<<<<<<<<<<
  * 
  *         if val == val:
@@ -9254,69 +7981,142 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
     }
     __pyx_L12:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":190
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":244
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
  *             nobs += 1
- *             sum_x += val
+ *             x += val
  */
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":191
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":245
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
- *             sum_x += val
- *             sum_xx += val * val
+ *             x += val
+ *             xx += val * val
  */
       __pyx_v_nobs += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":192
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":246
  *         if val == val:
  *             nobs += 1
- *             sum_x += val             # <<<<<<<<<<<<<<
- *             sum_xx += val * val
- * 
+ *             x += val             # <<<<<<<<<<<<<<
+ *             xx += val * val
+ *             xxx += val * val * val
  */
-      __pyx_v_sum_x += __pyx_v_val;
+      __pyx_v_x += __pyx_v_val;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":193
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":247
  *             nobs += 1
- *             sum_x += val
- *             sum_xx += val * val             # <<<<<<<<<<<<<<
+ *             x += val
+ *             xx += val * val             # <<<<<<<<<<<<<<
+ *             xxx += val * val * val
+ * 
+ */
+      __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":248
+ *             x += val
+ *             xx += val * val
+ *             xxx += val * val * val             # <<<<<<<<<<<<<<
  * 
  *         if nobs >= minp:
  */
-      __pyx_v_sum_xx += (__pyx_v_val * __pyx_v_val);
+      __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
       goto __pyx_L14;
     }
     __pyx_L14:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":195
- *             sum_xx += val * val
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":250
+ *             xxx += val * val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
- *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)
- *         else:
+ *             A = x / nobs
+ *             B = xx / nobs - A * A
  */
     __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":196
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":251
  * 
  *         if nobs >= minp:
- *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)             # <<<<<<<<<<<<<<
+ *             A = x / nobs             # <<<<<<<<<<<<<<
+ *             B = xx / nobs - A * A
+ *             C = xxx / nobs - A * A * A - 3 * A * B
+ */
+      if (unlikely(__pyx_v_nobs == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_v_A = (__pyx_v_x / __pyx_v_nobs);
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":252
+ *         if nobs >= minp:
+ *             A = x / nobs
+ *             B = xx / nobs - A * A             # <<<<<<<<<<<<<<
+ *             C = xxx / nobs - A * A * A - 3 * A * B
+ * 
+ */
+      if (unlikely(__pyx_v_nobs == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - (__pyx_v_A * __pyx_v_A));
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":253
+ *             A = x / nobs
+ *             B = xx / nobs - A * A
+ *             C = xxx / nobs - A * A * A - 3 * A * B             # <<<<<<<<<<<<<<
+ * 
+ *             R = sqrt(B)
+ */
+      if (unlikely(__pyx_v_nobs == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - ((__pyx_v_A * __pyx_v_A) * __pyx_v_A)) - ((3 * __pyx_v_A) * __pyx_v_B));
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":255
+ *             C = xxx / nobs - A * A * A - 3 * A * B
+ * 
+ *             R = sqrt(B)             # <<<<<<<<<<<<<<
+ * 
+ *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /
+ */
+      __pyx_v_R = sqrt(__pyx_v_B);
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":257
+ *             R = sqrt(B)
+ * 
+ *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
+ *                          ((nobs-2) * R * R * R))
+ *         else:
+ */
+      __pyx_t_15 = (sqrt((__pyx_v_nobs * (__pyx_v_nobs - 1.0))) * __pyx_v_C);
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":258
+ * 
+ *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /
+ *                          ((nobs-2) * R * R * R))             # <<<<<<<<<<<<<<
  *         else:
  *             output[i] = NaN
  */
-      __pyx_t_15 = ((__pyx_v_nobs * __pyx_v_sum_xx) - (__pyx_v_sum_x * __pyx_v_sum_x));
-      __pyx_t_16 = ((__pyx_v_nobs * __pyx_v_nobs) - __pyx_v_nobs);
+      __pyx_t_16 = ((((__pyx_v_nobs - 2) * __pyx_v_R) * __pyx_v_R) * __pyx_v_R);
       if (unlikely(__pyx_t_16 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":257
+ *             R = sqrt(B)
+ * 
+ *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
+ *                          ((nobs-2) * R * R * R))
+ *         else:
+ */
       __pyx_t_14 = __pyx_v_i;
       __pyx_t_17 = -1;
       if (__pyx_t_14 < 0) {
@@ -9325,15 +8125,15 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
       if (unlikely(__pyx_t_17 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_17);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = (__pyx_t_15 / __pyx_t_16);
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":198
- *             output[i] = (nobs * sum_xx - sum_x * sum_x) / (nobs * nobs - nobs)
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":260
+ *                          ((nobs-2) * R * R * R))
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
  * 
@@ -9347,14 +8147,14 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
       } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_output)) __pyx_t_18 = 0;
       if (unlikely(__pyx_t_18 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_18);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_17, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
     __pyx_L15:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":200
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":262
  *             output[i] = NaN
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -9378,7 +8178,7 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_var");
+  __Pyx_AddTraceback("tseries._roll_skew");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
@@ -9392,16 +8192,16 @@ static PyObject *__pyx_pf_7tseries__roll_var(PyObject *__pyx_self, PyObject *__p
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":205
- * # Rolling skewness
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":268
  * 
- * def _roll_skew(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ * 
+ * def _roll_kurt(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
  *                int win, int minp):
  *     cdef double val, prev
  */
 
-static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   int __pyx_v_win;
   int __pyx_v_minp;
@@ -9410,6 +8210,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
   double __pyx_v_x;
   double __pyx_v_xx;
   double __pyx_v_xxx;
+  double __pyx_v_xxxx;
   int __pyx_v_nobs;
   int __pyx_v_i;
   int __pyx_v_N;
@@ -9417,7 +8218,9 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
   double __pyx_v_A;
   double __pyx_v_B;
   double __pyx_v_C;
+  double __pyx_v_D;
   double __pyx_v_R;
+  double __pyx_v_K;
   Py_buffer __pyx_bstruct_output;
   Py_ssize_t __pyx_bstride_0_output = 0;
   Py_ssize_t __pyx_bshape_0_output = 0;
@@ -9444,7 +8247,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
   int __pyx_t_17;
   int __pyx_t_18;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("_roll_skew");
+  __Pyx_RefNannySetupContext("_roll_kurt");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -9465,110 +8268,111 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_skew", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_kurt", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_skew", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_kurt", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_skew") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_kurt") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_skew", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_kurt", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_skew");
+  __Pyx_AddTraceback("tseries._roll_kurt");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":208
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":271
  *                int win, int minp):
  *     cdef double val, prev
- *     cdef double x = 0, xx = 0, xxx = 0             # <<<<<<<<<<<<<<
+ *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0             # <<<<<<<<<<<<<<
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)
  */
   __pyx_v_x = 0;
   __pyx_v_xx = 0;
   __pyx_v_xxx = 0;
+  __pyx_v_xxxx = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":209
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":272
  *     cdef double val, prev
- *     cdef double x = 0, xx = 0, xxx = 0
+ *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
  *     cdef int N = len(input)
  * 
  */
   __pyx_v_nobs = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":210
- *     cdef double x = 0, xx = 0, xxx = 0
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":273
+ *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":212
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":275
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
- *     # 3 components of the skewness equation
+ *     # 5 components of the kurtosis equation
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -9577,8 +8381,8 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":217
- *     cdef double A, B, C, R
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":280
+ *     cdef double A, B, C, D, R, K
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
  *         minp = N + 1
@@ -9587,7 +8391,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":218
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":281
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -9599,7 +8403,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
   }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":220
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":283
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -9609,7 +8413,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":221
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":284
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9624,61 +8428,70 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":224
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":287
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
  *             nobs += 1
- *             x += val
+ * 
  */
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":225
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":288
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
- *             x += val
- *             xx += val * val
+ * 
+ *             # seriously don't ask me why this is faster
  */
       __pyx_v_nobs += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":226
- *         if val == val:
- *             nobs += 1
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":291
+ * 
+ *             # seriously don't ask me why this is faster
  *             x += val             # <<<<<<<<<<<<<<
  *             xx += val * val
  *             xxx += val * val * val
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":227
- *             nobs += 1
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":292
+ *             # seriously don't ask me why this is faster
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
  *             xxx += val * val * val
- * 
+ *             xxxx += val * val * val * val
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":228
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":293
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
+ *             xxxx += val * val * val * val
  * 
- *         output[i] = NaN
  */
       __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":294
+ *             xx += val * val
+ *             xxx += val * val * val
+ *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
+ * 
+ *         output[i] = NaN
+ */
+      __pyx_v_xxxx += (((__pyx_v_val * __pyx_v_val) * __pyx_v_val) * __pyx_v_val);
       goto __pyx_L9;
     }
     __pyx_L9:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":230
- *             xxx += val * val * val
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":296
+ *             xxxx += val * val * val * val
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
  * 
@@ -9692,12 +8505,12 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":232
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":298
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -9707,7 +8520,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":233
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":299
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -9722,11 +8535,11 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":235
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":301
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
@@ -9736,7 +8549,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":236
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":302
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
@@ -9751,11 +8564,11 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":237
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":303
  *         if i > win - 1:
  *             prev = input[i - win]
  *             if prev == prev:             # <<<<<<<<<<<<<<
@@ -9765,7 +8578,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":238
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":304
  *             prev = input[i - win]
  *             if prev == prev:
  *                 x -= prev             # <<<<<<<<<<<<<<
@@ -9774,26 +8587,35 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
  */
         __pyx_v_x -= __pyx_v_prev;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":239
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":305
  *             if prev == prev:
  *                 x -= prev
  *                 xx -= prev * prev             # <<<<<<<<<<<<<<
  *                 xxx -= prev * prev * prev
- * 
+ *                 xxxx -= prev * prev * prev * prev
  */
         __pyx_v_xx -= (__pyx_v_prev * __pyx_v_prev);
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":240
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":306
  *                 x -= prev
  *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev             # <<<<<<<<<<<<<<
+ *                 xxxx -= prev * prev * prev * prev
  * 
- *                 nobs -= 1
  */
         __pyx_v_xxx -= ((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev);
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":242
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":307
+ *                 xx -= prev * prev
  *                 xxx -= prev * prev * prev
+ *                 xxxx -= prev * prev * prev * prev             # <<<<<<<<<<<<<<
+ * 
+ *                 nobs -= 1
+ */
+        __pyx_v_xxxx -= (((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev) * __pyx_v_prev);
+
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":309
+ *                 xxxx -= prev * prev * prev * prev
  * 
  *                 nobs -= 1             # <<<<<<<<<<<<<<
  * 
@@ -9807,7 +8629,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
     }
     __pyx_L12:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":244
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":311
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
@@ -9817,7 +8639,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":245
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":312
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
@@ -9826,7 +8648,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
  */
       __pyx_v_nobs += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":246
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":313
  *         if val == val:
  *             nobs += 1
  *             x += val             # <<<<<<<<<<<<<<
@@ -9835,113 +8657,160 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
  */
       __pyx_v_x += __pyx_v_val;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":247
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":314
  *             nobs += 1
  *             x += val
  *             xx += val * val             # <<<<<<<<<<<<<<
  *             xxx += val * val * val
- * 
+ *             xxxx += val * val * val * val
  */
       __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":248
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":315
  *             x += val
  *             xx += val * val
  *             xxx += val * val * val             # <<<<<<<<<<<<<<
+ *             xxxx += val * val * val * val
  * 
- *         if nobs >= minp:
  */
       __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":316
+ *             xx += val * val
+ *             xxx += val * val * val
+ *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
+ * 
+ *         if nobs >= minp:
+ */
+      __pyx_v_xxxx += (((__pyx_v_val * __pyx_v_val) * __pyx_v_val) * __pyx_v_val);
       goto __pyx_L14;
     }
     __pyx_L14:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":250
- *             xxx += val * val * val
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":318
+ *             xxxx += val * val * val * val
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
  *             A = x / nobs
- *             B = xx / nobs - A * A
+ *             R = A * A
  */
     __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":251
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":319
  * 
  *         if nobs >= minp:
  *             A = x / nobs             # <<<<<<<<<<<<<<
- *             B = xx / nobs - A * A
- *             C = xxx / nobs - A * A * A - 3 * A * B
+ *             R = A * A
+ *             B = xx / nobs - R
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_A = (__pyx_v_x / __pyx_v_nobs);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":252
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":320
  *         if nobs >= minp:
  *             A = x / nobs
- *             B = xx / nobs - A * A             # <<<<<<<<<<<<<<
- *             C = xxx / nobs - A * A * A - 3 * A * B
- * 
+ *             R = A * A             # <<<<<<<<<<<<<<
+ *             B = xx / nobs - R
+ *             R = R * A
  */
-      if (unlikely(__pyx_v_nobs == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - (__pyx_v_A * __pyx_v_A));
+      __pyx_v_R = (__pyx_v_A * __pyx_v_A);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":253
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":321
  *             A = x / nobs
- *             B = xx / nobs - A * A
- *             C = xxx / nobs - A * A * A - 3 * A * B             # <<<<<<<<<<<<<<
- * 
- *             R = sqrt(B)
+ *             R = A * A
+ *             B = xx / nobs - R             # <<<<<<<<<<<<<<
+ *             R = R * A
+ *             C = xxx / nobs - R - 3 * A * B
  */
       if (unlikely(__pyx_v_nobs == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - ((__pyx_v_A * __pyx_v_A) * __pyx_v_A)) - ((3 * __pyx_v_A) * __pyx_v_B));
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":255
- *             C = xxx / nobs - A * A * A - 3 * A * B
- * 
- *             R = sqrt(B)             # <<<<<<<<<<<<<<
- * 
- *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /
- */
-      __pyx_v_R = sqrt(__pyx_v_B);
+      __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - __pyx_v_R);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":257
- *             R = sqrt(B)
- * 
- *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
- *                          ((nobs-2) * R * R * R))
- *         else:
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":322
+ *             R = A * A
+ *             B = xx / nobs - R
+ *             R = R * A             # <<<<<<<<<<<<<<
+ *             C = xxx / nobs - R - 3 * A * B
+ *             R = R * A
  */
-      __pyx_t_15 = (sqrt((__pyx_v_nobs * (__pyx_v_nobs - 1.0))) * __pyx_v_C);
+      __pyx_v_R = (__pyx_v_R * __pyx_v_A);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":258
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":323
+ *             B = xx / nobs - R
+ *             R = R * A
+ *             C = xxx / nobs - R - 3 * A * B             # <<<<<<<<<<<<<<
+ *             R = R * A
+ *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A
+ */
+      if (unlikely(__pyx_v_nobs == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - __pyx_v_R) - ((3 * __pyx_v_A) * __pyx_v_B));
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":324
+ *             R = R * A
+ *             C = xxx / nobs - R - 3 * A * B
+ *             R = R * A             # <<<<<<<<<<<<<<
+ *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A
  * 
- *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /
- *                          ((nobs-2) * R * R * R))             # <<<<<<<<<<<<<<
- *         else:
- *             output[i] = NaN
  */
-      __pyx_t_16 = ((((__pyx_v_nobs - 2) * __pyx_v_R) * __pyx_v_R) * __pyx_v_R);
+      __pyx_v_R = (__pyx_v_R * __pyx_v_A);
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":325
+ *             C = xxx / nobs - R - 3 * A * B
+ *             R = R * A
+ *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A             # <<<<<<<<<<<<<<
+ * 
+ *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)
+ */
+      if (unlikely(__pyx_v_nobs == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_v_D = ((((__pyx_v_xxxx / __pyx_v_nobs) - __pyx_v_R) - (((6 * __pyx_v_B) * __pyx_v_A) * __pyx_v_A)) - ((4 * __pyx_v_C) * __pyx_v_A));
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":327
+ *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A
+ * 
+ *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)             # <<<<<<<<<<<<<<
+ *             K = K / ((nobs - 2.)*(nobs-3.))
+ * 
+ */
+      __pyx_t_15 = (((__pyx_v_nobs * __pyx_v_nobs) - 1.0) * __pyx_v_D);
+      __pyx_t_16 = (__pyx_v_B * __pyx_v_B);
       if (unlikely(__pyx_t_16 == 0)) {
         PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
+      __pyx_v_K = ((__pyx_t_15 / __pyx_t_16) - (3 * pow((__pyx_v_nobs - 1.0), 2)));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":257
- *             R = sqrt(B)
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":328
  * 
- *             output[i] = ((sqrt(nobs * (nobs - 1.)) * C) /             # <<<<<<<<<<<<<<
- *                          ((nobs-2) * R * R * R))
+ *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)
+ *             K = K / ((nobs - 2.)*(nobs-3.))             # <<<<<<<<<<<<<<
+ * 
+ *             output[i] = K
+ */
+      __pyx_t_16 = ((__pyx_v_nobs - 2.0) * (__pyx_v_nobs - 3.0));
+      if (unlikely(__pyx_t_16 == 0)) {
+        PyErr_Format(PyExc_ZeroDivisionError, "float division");
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_v_K = (__pyx_v_K / __pyx_t_16);
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":330
+ *             K = K / ((nobs - 2.)*(nobs-3.))
+ * 
+ *             output[i] = K             # <<<<<<<<<<<<<<
  *         else:
+ *             output[i] = NaN
  */
       __pyx_t_14 = __pyx_v_i;
       __pyx_t_17 = -1;
@@ -9951,15 +8820,15 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
       } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
       if (unlikely(__pyx_t_17 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_17);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = (__pyx_t_15 / __pyx_t_16);
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_v_K;
       goto __pyx_L15;
     }
     /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":260
- *                          ((nobs-2) * R * R * R))
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":332
+ *             output[i] = K
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
  * 
@@ -9973,14 +8842,14 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
       } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_output)) __pyx_t_18 = 0;
       if (unlikely(__pyx_t_18 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_18);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_17, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
     __pyx_L15:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":262
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":334
  *             output[i] = NaN
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -10004,7 +8873,7 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
     __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_skew");
+  __Pyx_AddTraceback("tseries._roll_kurt");
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
@@ -10018,35 +8887,27 @@ static PyObject *__pyx_pf_7tseries__roll_skew(PyObject *__pyx_self, PyObject *__
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":268
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":339
+ * # Rolling median
  * 
+ * def _roll_median(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *                  int win, int minp):
  * 
- * def _roll_kurt(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *                int win, int minp):
- *     cdef double val, prev
  */
 
-static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   int __pyx_v_win;
   int __pyx_v_minp;
   double __pyx_v_val;
   double __pyx_v_prev;
-  double __pyx_v_x;
-  double __pyx_v_xx;
-  double __pyx_v_xxx;
-  double __pyx_v_xxxx;
+  double __pyx_v_midpoint;
+  struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_skiplist;
   int __pyx_v_nobs;
   int __pyx_v_i;
   int __pyx_v_N;
   PyArrayObject *__pyx_v_output = 0;
-  double __pyx_v_A;
-  double __pyx_v_B;
-  double __pyx_v_C;
-  double __pyx_v_D;
-  double __pyx_v_R;
-  double __pyx_v_K;
   Py_buffer __pyx_bstruct_output;
   Py_ssize_t __pyx_bstride_0_output = 0;
   Py_ssize_t __pyx_bshape_0_output = 0;
@@ -10068,12 +8929,12 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
   int __pyx_t_12;
   int __pyx_t_13;
   int __pyx_t_14;
-  double __pyx_t_15;
-  double __pyx_t_16;
+  __pyx_t_5numpy_double_t __pyx_t_15;
+  int __pyx_t_16;
   int __pyx_t_17;
   int __pyx_t_18;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("_roll_kurt");
+  __Pyx_RefNannySetupContext("_roll_median");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -10094,111 +8955,100 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_kurt", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_median", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("_roll_kurt", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("_roll_median", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_kurt") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_median") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
     goto __pyx_L5_argtuple_error;
   } else {
     __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_kurt", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_median", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_kurt");
+  __Pyx_AddTraceback("tseries._roll_median");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
+  __pyx_v_skiplist = ((struct __pyx_obj_7tseries_IndexableSkiplist *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_output.buf = NULL;
   __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
   __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":271
- *                int win, int minp):
- *     cdef double val, prev
- *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0             # <<<<<<<<<<<<<<
- *     cdef int nobs = 0, i
- *     cdef int N = len(input)
- */
-  __pyx_v_x = 0;
-  __pyx_v_xx = 0;
-  __pyx_v_xxx = 0;
-  __pyx_v_xxxx = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":272
- *     cdef double val, prev
- *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":344
+ *     cdef double val, prev, midpoint
+ *     cdef IndexableSkiplist skiplist
  *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
  *     cdef int N = len(input)
  * 
  */
   __pyx_v_nobs = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":273
- *     cdef double x = 0, xx = 0, xxx = 0, xxxx = 0
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":345
+ *     cdef IndexableSkiplist skiplist
  *     cdef int nobs = 0, i
  *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_N = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":275
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":347
  *     cdef int N = len(input)
  * 
  *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
- *     # 5 components of the kurtosis equation
+ *     skiplist = IndexableSkiplist(win)
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
       __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
     }
@@ -10207,8 +9057,29 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
   __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":280
- *     cdef double A, B, C, D, R, K
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":349
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
+ * 
+ *     skiplist = IndexableSkiplist(win)             # <<<<<<<<<<<<<<
+ * 
+ *     if minp > N:
+ */
+  __pyx_t_5 = PyInt_FromLong(__pyx_v_win); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_5);
+  __pyx_t_5 = 0;
+  __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_IndexableSkiplist)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_v_skiplist));
+  __pyx_v_skiplist = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":351
+ *     skiplist = IndexableSkiplist(win)
  * 
  *     if minp > N:             # <<<<<<<<<<<<<<
  *         minp = N + 1
@@ -10217,7 +9088,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
   __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
   if (__pyx_t_7) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":281
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":352
  * 
  *     if minp > N:
  *         minp = N + 1             # <<<<<<<<<<<<<<
@@ -10229,7 +9100,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
   }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":283
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":354
  *         minp = N + 1
  * 
  *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
@@ -10239,7 +9110,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
   __pyx_t_8 = (__pyx_v_minp - 1);
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":284
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":355
  * 
  *     for i from 0 <= i < minp - 1:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -10254,70 +9125,56 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
     } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":287
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":358
  * 
  *         # Not NaN
  *         if val == val:             # <<<<<<<<<<<<<<
  *             nobs += 1
- * 
+ *             skiplist.insert(val)
  */
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":288
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":359
  *         # Not NaN
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
+ *             skiplist.insert(val)
  * 
- *             # seriously don't ask me why this is faster
  */
       __pyx_v_nobs += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":291
- * 
- *             # seriously don't ask me why this is faster
- *             x += val             # <<<<<<<<<<<<<<
- *             xx += val * val
- *             xxx += val * val * val
- */
-      __pyx_v_x += __pyx_v_val;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":292
- *             # seriously don't ask me why this is faster
- *             x += val
- *             xx += val * val             # <<<<<<<<<<<<<<
- *             xxx += val * val * val
- *             xxxx += val * val * val * val
- */
-      __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":293
- *             x += val
- *             xx += val * val
- *             xxx += val * val * val             # <<<<<<<<<<<<<<
- *             xxxx += val * val * val * val
- * 
- */
-      __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":294
- *             xx += val * val
- *             xxx += val * val * val
- *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":360
+ *         if val == val:
+ *             nobs += 1
+ *             skiplist.insert(val)             # <<<<<<<<<<<<<<
  * 
  *         output[i] = NaN
  */
-      __pyx_v_xxxx += (((__pyx_v_val * __pyx_v_val) * __pyx_v_val) * __pyx_v_val);
+      __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__insert); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+      __Pyx_GIVEREF(__pyx_t_2);
+      __pyx_t_2 = 0;
+      __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       goto __pyx_L9;
     }
     __pyx_L9:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":296
- *             xxxx += val * val * val * val
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":362
+ *             skiplist.insert(val)
  * 
  *         output[i] = NaN             # <<<<<<<<<<<<<<
  * 
@@ -10331,12 +9188,12 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
     } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
     if (unlikely(__pyx_t_11 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":298
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":364
  *         output[i] = NaN
  * 
  *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
@@ -10346,7 +9203,7 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
   __pyx_t_11 = __pyx_v_N;
   for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":299
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":365
  * 
  *     for i from minp - 1 <= i < N:
  *         val = input[i]             # <<<<<<<<<<<<<<
@@ -10361,26 +9218,26 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
     } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
     if (unlikely(__pyx_t_13 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":301
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":367
  *         val = input[i]
  * 
  *         if i > win - 1:             # <<<<<<<<<<<<<<
  *             prev = input[i - win]
- *             if prev == prev:
+ * 
  */
     __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":302
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":368
  * 
  *         if i > win - 1:
  *             prev = input[i - win]             # <<<<<<<<<<<<<<
+ * 
  *             if prev == prev:
- *                 x -= prev
  */
       __pyx_t_13 = (__pyx_v_i - __pyx_v_win);
       __pyx_t_14 = -1;
@@ -10390,59 +9247,45 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
       } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
       if (unlikely(__pyx_t_14 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":303
- *         if i > win - 1:
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":370
  *             prev = input[i - win]
+ * 
  *             if prev == prev:             # <<<<<<<<<<<<<<
- *                 x -= prev
- *                 xx -= prev * prev
+ *                 skiplist.remove(prev)
+ *                 nobs -= 1
  */
       __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":304
- *             prev = input[i - win]
- *             if prev == prev:
- *                 x -= prev             # <<<<<<<<<<<<<<
- *                 xx -= prev * prev
- *                 xxx -= prev * prev * prev
- */
-        __pyx_v_x -= __pyx_v_prev;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":305
- *             if prev == prev:
- *                 x -= prev
- *                 xx -= prev * prev             # <<<<<<<<<<<<<<
- *                 xxx -= prev * prev * prev
- *                 xxxx -= prev * prev * prev * prev
- */
-        __pyx_v_xx -= (__pyx_v_prev * __pyx_v_prev);
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":306
- *                 x -= prev
- *                 xx -= prev * prev
- *                 xxx -= prev * prev * prev             # <<<<<<<<<<<<<<
- *                 xxxx -= prev * prev * prev * prev
- * 
- */
-        __pyx_v_xxx -= ((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev);
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":307
- *                 xx -= prev * prev
- *                 xxx -= prev * prev * prev
- *                 xxxx -= prev * prev * prev * prev             # <<<<<<<<<<<<<<
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":371
  * 
+ *             if prev == prev:
+ *                 skiplist.remove(prev)             # <<<<<<<<<<<<<<
  *                 nobs -= 1
+ * 
  */
-        __pyx_v_xxxx -= (((__pyx_v_prev * __pyx_v_prev) * __pyx_v_prev) * __pyx_v_prev);
+        __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__remove); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_4 = PyFloat_FromDouble(__pyx_v_prev); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
+        __Pyx_GIVEREF(__pyx_t_4);
+        __pyx_t_4 = 0;
+        __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":309
- *                 xxxx -= prev * prev * prev * prev
- * 
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":372
+ *             if prev == prev:
+ *                 skiplist.remove(prev)
  *                 nobs -= 1             # <<<<<<<<<<<<<<
  * 
  *         if val == val:
@@ -10455,206 +9298,193 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
     }
     __pyx_L12:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":311
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":374
  *                 nobs -= 1
  * 
  *         if val == val:             # <<<<<<<<<<<<<<
  *             nobs += 1
- *             x += val
+ *             skiplist.insert(val)
  */
     __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":312
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":375
  * 
  *         if val == val:
  *             nobs += 1             # <<<<<<<<<<<<<<
- *             x += val
- *             xx += val * val
+ *             skiplist.insert(val)
+ * 
  */
       __pyx_v_nobs += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":313
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":376
  *         if val == val:
  *             nobs += 1
- *             x += val             # <<<<<<<<<<<<<<
- *             xx += val * val
- *             xxx += val * val * val
- */
-      __pyx_v_x += __pyx_v_val;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":314
- *             nobs += 1
- *             x += val
- *             xx += val * val             # <<<<<<<<<<<<<<
- *             xxx += val * val * val
- *             xxxx += val * val * val * val
- */
-      __pyx_v_xx += (__pyx_v_val * __pyx_v_val);
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":315
- *             x += val
- *             xx += val * val
- *             xxx += val * val * val             # <<<<<<<<<<<<<<
- *             xxxx += val * val * val * val
- * 
- */
-      __pyx_v_xxx += ((__pyx_v_val * __pyx_v_val) * __pyx_v_val);
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":316
- *             xx += val * val
- *             xxx += val * val * val
- *             xxxx += val * val * val * val             # <<<<<<<<<<<<<<
+ *             skiplist.insert(val)             # <<<<<<<<<<<<<<
  * 
  *         if nobs >= minp:
  */
-      __pyx_v_xxxx += (((__pyx_v_val * __pyx_v_val) * __pyx_v_val) * __pyx_v_val);
+      __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__insert); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_5);
+      __pyx_t_5 = 0;
+      __pyx_t_5 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       goto __pyx_L14;
     }
     __pyx_L14:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":318
- *             xxxx += val * val * val * val
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":378
+ *             skiplist.insert(val)
  * 
  *         if nobs >= minp:             # <<<<<<<<<<<<<<
- *             A = x / nobs
- *             R = A * A
+ *             midpoint = nobs / 2
+ *             if nobs % 2:
  */
     __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":319
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":379
  * 
  *         if nobs >= minp:
- *             A = x / nobs             # <<<<<<<<<<<<<<
- *             R = A * A
- *             B = xx / nobs - R
+ *             midpoint = nobs / 2             # <<<<<<<<<<<<<<
+ *             if nobs % 2:
+ *                 output[i] = skiplist.get(midpoint)
  */
-      if (unlikely(__pyx_v_nobs == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_v_A = (__pyx_v_x / __pyx_v_nobs);
+      __pyx_v_midpoint = __Pyx_div_long(__pyx_v_nobs, 2);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":320
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":380
  *         if nobs >= minp:
- *             A = x / nobs
- *             R = A * A             # <<<<<<<<<<<<<<
- *             B = xx / nobs - R
- *             R = R * A
+ *             midpoint = nobs / 2
+ *             if nobs % 2:             # <<<<<<<<<<<<<<
+ *                 output[i] = skiplist.get(midpoint)
+ *             else:
  */
-      __pyx_v_R = (__pyx_v_A * __pyx_v_A);
+      __pyx_t_8 = __Pyx_mod_long(__pyx_v_nobs, 2);
+      if (__pyx_t_8) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":321
- *             A = x / nobs
- *             R = A * A
- *             B = xx / nobs - R             # <<<<<<<<<<<<<<
- *             R = R * A
- *             C = xxx / nobs - R - 3 * A * B
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":381
+ *             midpoint = nobs / 2
+ *             if nobs % 2:
+ *                 output[i] = skiplist.get(midpoint)             # <<<<<<<<<<<<<<
+ *             else:
+ *                 output[i] = (skiplist.get(midpoint) +
  */
-      if (unlikely(__pyx_v_nobs == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_2 = PyFloat_FromDouble(__pyx_v_midpoint); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_4);
+        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_2);
+        __pyx_t_2 = 0;
+        __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_15 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_t_14 = __pyx_v_i;
+        __pyx_t_16 = -1;
+        if (__pyx_t_14 < 0) {
+          __pyx_t_14 += __pyx_bshape_0_output;
+          if (unlikely(__pyx_t_14 < 0)) __pyx_t_16 = 0;
+        } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
+        if (unlikely(__pyx_t_16 != -1)) {
+          __Pyx_RaiseBufferIndexError(__pyx_t_16);
+          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        }
+        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_t_15;
+        goto __pyx_L16;
       }
-      __pyx_v_B = ((__pyx_v_xx / __pyx_v_nobs) - __pyx_v_R);
+      /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":322
- *             R = A * A
- *             B = xx / nobs - R
- *             R = R * A             # <<<<<<<<<<<<<<
- *             C = xxx / nobs - R - 3 * A * B
- *             R = R * A
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":383
+ *                 output[i] = skiplist.get(midpoint)
+ *             else:
+ *                 output[i] = (skiplist.get(midpoint) +             # <<<<<<<<<<<<<<
+ *                              skiplist.get(midpoint - 1)) / 2
+ *         else:
  */
-      __pyx_v_R = (__pyx_v_R * __pyx_v_A);
+        __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_4 = PyFloat_FromDouble(__pyx_v_midpoint); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
+        __Pyx_GIVEREF(__pyx_t_4);
+        __pyx_t_4 = 0;
+        __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":323
- *             B = xx / nobs - R
- *             R = R * A
- *             C = xxx / nobs - R - 3 * A * B             # <<<<<<<<<<<<<<
- *             R = R * A
- *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":384
+ *             else:
+ *                 output[i] = (skiplist.get(midpoint) +
+ *                              skiplist.get(midpoint - 1)) / 2             # <<<<<<<<<<<<<<
+ *         else:
+ *             output[i] = NaN
  */
-      if (unlikely(__pyx_v_nobs == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_v_C = (((__pyx_v_xxx / __pyx_v_nobs) - __pyx_v_R) - ((3 * __pyx_v_A) * __pyx_v_B));
+        __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_2 = PyFloat_FromDouble((__pyx_v_midpoint - 1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_2);
+        __pyx_t_2 = 0;
+        __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_int_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_15 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":324
- *             R = R * A
- *             C = xxx / nobs - R - 3 * A * B
- *             R = R * A             # <<<<<<<<<<<<<<
- *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A
- * 
+        /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":383
+ *                 output[i] = skiplist.get(midpoint)
+ *             else:
+ *                 output[i] = (skiplist.get(midpoint) +             # <<<<<<<<<<<<<<
+ *                              skiplist.get(midpoint - 1)) / 2
+ *         else:
  */
-      __pyx_v_R = (__pyx_v_R * __pyx_v_A);
+        __pyx_t_16 = __pyx_v_i;
+        __pyx_t_17 = -1;
+        if (__pyx_t_16 < 0) {
+          __pyx_t_16 += __pyx_bshape_0_output;
+          if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
+        } else if (unlikely(__pyx_t_16 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
+        if (unlikely(__pyx_t_17 != -1)) {
+          __Pyx_RaiseBufferIndexError(__pyx_t_17);
+          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        }
+        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_16, __pyx_bstride_0_output) = __pyx_t_15;
+      }
+      __pyx_L16:;
+      goto __pyx_L15;
+    }
+    /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":325
- *             C = xxx / nobs - R - 3 * A * B
- *             R = R * A
- *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A             # <<<<<<<<<<<<<<
- * 
- *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)
- */
-      if (unlikely(__pyx_v_nobs == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_v_D = ((((__pyx_v_xxxx / __pyx_v_nobs) - __pyx_v_R) - (((6 * __pyx_v_B) * __pyx_v_A) * __pyx_v_A)) - ((4 * __pyx_v_C) * __pyx_v_A));
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":327
- *             D = xxxx / nobs - R - 6*B*A*A - 4*C*A
- * 
- *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)             # <<<<<<<<<<<<<<
- *             K = K / ((nobs - 2.)*(nobs-3.))
- * 
- */
-      __pyx_t_15 = (((__pyx_v_nobs * __pyx_v_nobs) - 1.0) * __pyx_v_D);
-      __pyx_t_16 = (__pyx_v_B * __pyx_v_B);
-      if (unlikely(__pyx_t_16 == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_v_K = ((__pyx_t_15 / __pyx_t_16) - (3 * pow((__pyx_v_nobs - 1.0), 2)));
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":328
- * 
- *             K = (nobs * nobs - 1.)*D/(B*B) - 3*((nobs-1.)**2)
- *             K = K / ((nobs - 2.)*(nobs-3.))             # <<<<<<<<<<<<<<
- * 
- *             output[i] = K
- */
-      __pyx_t_16 = ((__pyx_v_nobs - 2.0) * (__pyx_v_nobs - 3.0));
-      if (unlikely(__pyx_t_16 == 0)) {
-        PyErr_Format(PyExc_ZeroDivisionError, "float division");
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_v_K = (__pyx_v_K / __pyx_t_16);
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":330
- *             K = K / ((nobs - 2.)*(nobs-3.))
- * 
- *             output[i] = K             # <<<<<<<<<<<<<<
- *         else:
- *             output[i] = NaN
- */
-      __pyx_t_14 = __pyx_v_i;
-      __pyx_t_17 = -1;
-      if (__pyx_t_14 < 0) {
-        __pyx_t_14 += __pyx_bshape_0_output;
-        if (unlikely(__pyx_t_14 < 0)) __pyx_t_17 = 0;
-      } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
-      if (unlikely(__pyx_t_17 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_17);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_v_K;
-      goto __pyx_L15;
-    }
-    /*else*/ {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":332
- *             output[i] = K
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":386
+ *                              skiplist.get(midpoint - 1)) / 2
  *         else:
  *             output[i] = NaN             # <<<<<<<<<<<<<<
  * 
@@ -10668,14 +9498,14 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
       } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_output)) __pyx_t_18 = 0;
       if (unlikely(__pyx_t_18 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_18);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_17, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
     }
     __pyx_L15:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":334
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":388
  *             output[i] = NaN
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -10694,1516 +9524,70 @@ static PyObject *__pyx_pf_7tseries__roll_kurt(PyObject *__pyx_self, PyObject *__
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
-    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_kurt");
-  __pyx_r = NULL;
-  goto __pyx_L2;
-  __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __pyx_L2:;
-  __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":339
- * # Rolling median
- * 
- * def _roll_median(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *                  int win, int minp):
- * 
- */
-
-static PyObject *__pyx_pf_7tseries__roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_input = 0;
-  int __pyx_v_win;
-  int __pyx_v_minp;
-  double __pyx_v_val;
-  double __pyx_v_prev;
-  double __pyx_v_midpoint;
-  struct __pyx_obj_7tseries_IndexableSkiplist *__pyx_v_skiplist;
-  int __pyx_v_nobs;
-  int __pyx_v_i;
-  int __pyx_v_N;
-  PyArrayObject *__pyx_v_output = 0;
-  Py_buffer __pyx_bstruct_output;
-  Py_ssize_t __pyx_bstride_0_output = 0;
-  Py_ssize_t __pyx_bshape_0_output = 0;
-  Py_buffer __pyx_bstruct_input;
-  Py_ssize_t __pyx_bstride_0_input = 0;
-  Py_ssize_t __pyx_bshape_0_input = 0;
-  PyObject *__pyx_r = NULL;
-  Py_ssize_t __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyArrayObject *__pyx_t_6 = NULL;
-  int __pyx_t_7;
-  long __pyx_t_8;
-  int __pyx_t_9;
-  int __pyx_t_10;
-  int __pyx_t_11;
-  int __pyx_t_12;
-  int __pyx_t_13;
-  int __pyx_t_14;
-  __pyx_t_5numpy_double_t __pyx_t_15;
-  int __pyx_t_16;
-  int __pyx_t_17;
-  int __pyx_t_18;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("_roll_median");
-  __pyx_self = __pyx_self;
-  if (unlikely(__pyx_kwds)) {
-    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[3] = {0,0,0};
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      case  0: break;
-      default: goto __pyx_L5_argtuple_error;
-    }
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
-      if (likely(values[0])) kw_args--;
-      else goto __pyx_L5_argtuple_error;
-      case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
-      if (likely(values[1])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_median", 1, 3, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
-      if (likely(values[2])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_median", 1, 3, 3, 2); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-    }
-    if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_median") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    }
-    __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(values[2]); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
-    goto __pyx_L5_argtuple_error;
-  } else {
-    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    __pyx_v_minp = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_minp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_median", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_median");
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
-  __pyx_v_skiplist = ((struct __pyx_obj_7tseries_IndexableSkiplist *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_bstruct_output.buf = NULL;
-  __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
-  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":344
- *     cdef double val, prev, midpoint
- *     cdef IndexableSkiplist skiplist
- *     cdef int nobs = 0, i             # <<<<<<<<<<<<<<
- *     cdef int N = len(input)
- * 
- */
-  __pyx_v_nobs = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":345
- *     cdef IndexableSkiplist skiplist
- *     cdef int nobs = 0, i
- *     cdef int N = len(input)             # <<<<<<<<<<<<<<
- * 
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
- */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_v_N = __pyx_t_1;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":347
- *     cdef int N = len(input)
- * 
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
- * 
- *     skiplist = IndexableSkiplist(win)
- */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
-      __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
-      __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
-    }
-  }
-  __pyx_t_6 = 0;
-  __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":349
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
- * 
- *     skiplist = IndexableSkiplist(win)             # <<<<<<<<<<<<<<
- * 
- *     if minp > N:
- */
-  __pyx_t_5 = PyInt_FromLong(__pyx_v_win); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
-  __Pyx_GIVEREF(__pyx_t_5);
-  __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7tseries_IndexableSkiplist)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_v_skiplist));
-  __pyx_v_skiplist = ((struct __pyx_obj_7tseries_IndexableSkiplist *)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":351
- *     skiplist = IndexableSkiplist(win)
- * 
- *     if minp > N:             # <<<<<<<<<<<<<<
- *         minp = N + 1
- * 
- */
-  __pyx_t_7 = (__pyx_v_minp > __pyx_v_N);
-  if (__pyx_t_7) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":352
- * 
- *     if minp > N:
- *         minp = N + 1             # <<<<<<<<<<<<<<
- * 
- *     for i from 0 <= i < minp - 1:
- */
-    __pyx_v_minp = (__pyx_v_N + 1);
-    goto __pyx_L6;
-  }
-  __pyx_L6:;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":354
- *         minp = N + 1
- * 
- *     for i from 0 <= i < minp - 1:             # <<<<<<<<<<<<<<
- *         val = input[i]
- * 
- */
-  __pyx_t_8 = (__pyx_v_minp - 1);
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":355
- * 
- *     for i from 0 <= i < minp - 1:
- *         val = input[i]             # <<<<<<<<<<<<<<
- * 
- *         # Not NaN
- */
-    __pyx_t_9 = __pyx_v_i;
-    __pyx_t_10 = -1;
-    if (__pyx_t_9 < 0) {
-      __pyx_t_9 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
-    } else if (unlikely(__pyx_t_9 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
-    if (unlikely(__pyx_t_10 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_9, __pyx_bstride_0_input));
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":358
- * 
- *         # Not NaN
- *         if val == val:             # <<<<<<<<<<<<<<
- *             nobs += 1
- *             skiplist.insert(val)
- */
-    __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
-    if (__pyx_t_7) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":359
- *         # Not NaN
- *         if val == val:
- *             nobs += 1             # <<<<<<<<<<<<<<
- *             skiplist.insert(val)
- * 
- */
-      __pyx_v_nobs += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":360
- *         if val == val:
- *             nobs += 1
- *             skiplist.insert(val)             # <<<<<<<<<<<<<<
- * 
- *         output[i] = NaN
- */
-      __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__insert); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_2 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-      __Pyx_GIVEREF(__pyx_t_2);
-      __pyx_t_2 = 0;
-      __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      goto __pyx_L9;
-    }
-    __pyx_L9:;
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":362
- *             skiplist.insert(val)
- * 
- *         output[i] = NaN             # <<<<<<<<<<<<<<
- * 
- *     for i from minp - 1 <= i < N:
- */
-    __pyx_t_10 = __pyx_v_i;
-    __pyx_t_11 = -1;
-    if (__pyx_t_10 < 0) {
-      __pyx_t_10 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
-    } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_11 = 0;
-    if (unlikely(__pyx_t_11 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_11);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":364
- *         output[i] = NaN
- * 
- *     for i from minp - 1 <= i < N:             # <<<<<<<<<<<<<<
- *         val = input[i]
- * 
- */
-  __pyx_t_11 = __pyx_v_N;
-  for (__pyx_v_i = (__pyx_v_minp - 1); __pyx_v_i < __pyx_t_11; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":365
- * 
- *     for i from minp - 1 <= i < N:
- *         val = input[i]             # <<<<<<<<<<<<<<
- * 
- *         if i > win - 1:
- */
-    __pyx_t_12 = __pyx_v_i;
-    __pyx_t_13 = -1;
-    if (__pyx_t_12 < 0) {
-      __pyx_t_12 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 0;
-    } else if (unlikely(__pyx_t_12 >= __pyx_bshape_0_input)) __pyx_t_13 = 0;
-    if (unlikely(__pyx_t_13 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_13);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_12, __pyx_bstride_0_input));
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":367
- *         val = input[i]
- * 
- *         if i > win - 1:             # <<<<<<<<<<<<<<
- *             prev = input[i - win]
- * 
- */
-    __pyx_t_7 = (__pyx_v_i > (__pyx_v_win - 1));
-    if (__pyx_t_7) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":368
- * 
- *         if i > win - 1:
- *             prev = input[i - win]             # <<<<<<<<<<<<<<
- * 
- *             if prev == prev:
- */
-      __pyx_t_13 = (__pyx_v_i - __pyx_v_win);
-      __pyx_t_14 = -1;
-      if (__pyx_t_13 < 0) {
-        __pyx_t_13 += __pyx_bshape_0_input;
-        if (unlikely(__pyx_t_13 < 0)) __pyx_t_14 = 0;
-      } else if (unlikely(__pyx_t_13 >= __pyx_bshape_0_input)) __pyx_t_14 = 0;
-      if (unlikely(__pyx_t_14 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_14);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_v_prev = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_13, __pyx_bstride_0_input));
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":370
- *             prev = input[i - win]
- * 
- *             if prev == prev:             # <<<<<<<<<<<<<<
- *                 skiplist.remove(prev)
- *                 nobs -= 1
- */
-      __pyx_t_7 = (__pyx_v_prev == __pyx_v_prev);
-      if (__pyx_t_7) {
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":371
- * 
- *             if prev == prev:
- *                 skiplist.remove(prev)             # <<<<<<<<<<<<<<
- *                 nobs -= 1
- * 
- */
-        __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__remove); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_4 = PyFloat_FromDouble(__pyx_v_prev); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_5);
-        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
-        __Pyx_GIVEREF(__pyx_t_4);
-        __pyx_t_4 = 0;
-        __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_4);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":372
- *             if prev == prev:
- *                 skiplist.remove(prev)
- *                 nobs -= 1             # <<<<<<<<<<<<<<
- * 
- *         if val == val:
- */
-        __pyx_v_nobs -= 1;
-        goto __pyx_L13;
-      }
-      __pyx_L13:;
-      goto __pyx_L12;
-    }
-    __pyx_L12:;
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":374
- *                 nobs -= 1
- * 
- *         if val == val:             # <<<<<<<<<<<<<<
- *             nobs += 1
- *             skiplist.insert(val)
- */
-    __pyx_t_7 = (__pyx_v_val == __pyx_v_val);
-    if (__pyx_t_7) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":375
- * 
- *         if val == val:
- *             nobs += 1             # <<<<<<<<<<<<<<
- *             skiplist.insert(val)
- * 
- */
-      __pyx_v_nobs += 1;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":376
- *         if val == val:
- *             nobs += 1
- *             skiplist.insert(val)             # <<<<<<<<<<<<<<
- * 
- *         if nobs >= minp:
- */
-      __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__insert); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
-      __Pyx_GIVEREF(__pyx_t_5);
-      __pyx_t_5 = 0;
-      __pyx_t_5 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      goto __pyx_L14;
-    }
-    __pyx_L14:;
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":378
- *             skiplist.insert(val)
- * 
- *         if nobs >= minp:             # <<<<<<<<<<<<<<
- *             midpoint = nobs / 2
- *             if nobs % 2:
- */
-    __pyx_t_7 = (__pyx_v_nobs >= __pyx_v_minp);
-    if (__pyx_t_7) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":379
- * 
- *         if nobs >= minp:
- *             midpoint = nobs / 2             # <<<<<<<<<<<<<<
- *             if nobs % 2:
- *                 output[i] = skiplist.get(midpoint)
- */
-      __pyx_v_midpoint = __Pyx_div_long(__pyx_v_nobs, 2);
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":380
- *         if nobs >= minp:
- *             midpoint = nobs / 2
- *             if nobs % 2:             # <<<<<<<<<<<<<<
- *                 output[i] = skiplist.get(midpoint)
- *             else:
- */
-      __pyx_t_8 = __Pyx_mod_long(__pyx_v_nobs, 2);
-      if (__pyx_t_8) {
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":381
- *             midpoint = nobs / 2
- *             if nobs % 2:
- *                 output[i] = skiplist.get(midpoint)             # <<<<<<<<<<<<<<
- *             else:
- *                 output[i] = (skiplist.get(midpoint) +
- */
-        __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_2 = PyFloat_FromDouble(__pyx_v_midpoint); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_4);
-        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-        __Pyx_GIVEREF(__pyx_t_2);
-        __pyx_t_2 = 0;
-        __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_15 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_14 = __pyx_v_i;
-        __pyx_t_16 = -1;
-        if (__pyx_t_14 < 0) {
-          __pyx_t_14 += __pyx_bshape_0_output;
-          if (unlikely(__pyx_t_14 < 0)) __pyx_t_16 = 0;
-        } else if (unlikely(__pyx_t_14 >= __pyx_bshape_0_output)) __pyx_t_16 = 0;
-        if (unlikely(__pyx_t_16 != -1)) {
-          __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        }
-        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_14, __pyx_bstride_0_output) = __pyx_t_15;
-        goto __pyx_L16;
-      }
-      /*else*/ {
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":383
- *                 output[i] = skiplist.get(midpoint)
- *             else:
- *                 output[i] = (skiplist.get(midpoint) +             # <<<<<<<<<<<<<<
- *                              skiplist.get(midpoint - 1)) / 2
- *         else:
- */
-        __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_4 = PyFloat_FromDouble(__pyx_v_midpoint); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_5);
-        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
-        __Pyx_GIVEREF(__pyx_t_4);
-        __pyx_t_4 = 0;
-        __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_4);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":384
- *             else:
- *                 output[i] = (skiplist.get(midpoint) +
- *                              skiplist.get(midpoint - 1)) / 2             # <<<<<<<<<<<<<<
- *         else:
- *             output[i] = NaN
- */
-        __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_skiplist), __pyx_n_s__get); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_2 = PyFloat_FromDouble((__pyx_v_midpoint - 1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_3);
-        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-        __Pyx_GIVEREF(__pyx_t_2);
-        __pyx_t_2 = 0;
-        __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_int_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_15 == (npy_double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-        /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":383
- *                 output[i] = skiplist.get(midpoint)
- *             else:
- *                 output[i] = (skiplist.get(midpoint) +             # <<<<<<<<<<<<<<
- *                              skiplist.get(midpoint - 1)) / 2
- *         else:
- */
-        __pyx_t_16 = __pyx_v_i;
-        __pyx_t_17 = -1;
-        if (__pyx_t_16 < 0) {
-          __pyx_t_16 += __pyx_bshape_0_output;
-          if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
-        } else if (unlikely(__pyx_t_16 >= __pyx_bshape_0_output)) __pyx_t_17 = 0;
-        if (unlikely(__pyx_t_17 != -1)) {
-          __Pyx_RaiseBufferIndexError(__pyx_t_17);
-          {__pyx_filename = __pyx_f[2]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-        }
-        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_16, __pyx_bstride_0_output) = __pyx_t_15;
-      }
-      __pyx_L16:;
-      goto __pyx_L15;
-    }
-    /*else*/ {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":386
- *                              skiplist.get(midpoint - 1)) / 2
- *         else:
- *             output[i] = NaN             # <<<<<<<<<<<<<<
- * 
- *     return output
- */
-      __pyx_t_17 = __pyx_v_i;
-      __pyx_t_18 = -1;
-      if (__pyx_t_17 < 0) {
-        __pyx_t_17 += __pyx_bshape_0_output;
-        if (unlikely(__pyx_t_17 < 0)) __pyx_t_18 = 0;
-      } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_output)) __pyx_t_18 = 0;
-      if (unlikely(__pyx_t_18 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_18);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_17, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
-    }
-    __pyx_L15:;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":388
- *             output[i] = NaN
- * 
- *     return output             # <<<<<<<<<<<<<<
- * 
- * #-------------------------------------------------------------------------------
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_output));
-  __pyx_r = ((PyObject *)__pyx_v_output);
-  goto __pyx_L0;
-
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
-    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_median");
-  __pyx_r = NULL;
-  goto __pyx_L2;
-  __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __pyx_L2:;
-  __Pyx_DECREF((PyObject *)__pyx_v_skiplist);
-  __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":393
- * # Rolling min / max
- * 
- * def _roll_max(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *               int win):
- *     cdef double val
- */
-
-static PyObject *__pyx_pf_7tseries__roll_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_input = 0;
-  int __pyx_v_win;
-  double __pyx_v_val;
-  int __pyx_v_i;
-  int __pyx_v_j;
-  int __pyx_v_N;
-  PyArrayObject *__pyx_v_output = 0;
-  Py_buffer __pyx_bstruct_output;
-  Py_ssize_t __pyx_bstride_0_output = 0;
-  Py_ssize_t __pyx_bshape_0_output = 0;
-  Py_buffer __pyx_bstruct_input;
-  Py_ssize_t __pyx_bstride_0_input = 0;
-  Py_ssize_t __pyx_bshape_0_input = 0;
-  PyObject *__pyx_r = NULL;
-  Py_ssize_t __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyArrayObject *__pyx_t_6 = NULL;
-  long __pyx_t_7;
-  int __pyx_t_8;
-  int __pyx_t_9;
-  int __pyx_t_10;
-  int __pyx_t_11;
-  int __pyx_t_12;
-  double __pyx_t_13;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,0};
-  __Pyx_RefNannySetupContext("_roll_max");
-  __pyx_self = __pyx_self;
-  if (unlikely(__pyx_kwds)) {
-    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[2] = {0,0};
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      case  0: break;
-      default: goto __pyx_L5_argtuple_error;
-    }
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
-      if (likely(values[0])) kw_args--;
-      else goto __pyx_L5_argtuple_error;
-      case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
-      if (likely(values[1])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_max", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-    }
-    if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_max") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    }
-    __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
-    goto __pyx_L5_argtuple_error;
-  } else {
-    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_max", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_max");
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
-  __pyx_bstruct_output.buf = NULL;
-  __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
-  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":397
- *     cdef double val
- *     cdef int i, j
- *     cdef int N = len(input)             # <<<<<<<<<<<<<<
- * 
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
- */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_v_N = __pyx_t_1;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":399
- *     cdef int N = len(input)
- * 
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
- * 
- *     for i from 0 <= i < win - 1:
- */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
-      __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
-      __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
-    }
-  }
-  __pyx_t_6 = 0;
-  __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":401
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
- * 
- *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
- *         output[i] = NaN
- * 
- */
-  __pyx_t_7 = (__pyx_v_win - 1);
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":402
- * 
- *     for i from 0 <= i < win - 1:
- *         output[i] = NaN             # <<<<<<<<<<<<<<
- * 
- *     for i from win - 1 <= i < N:
- */
-    __pyx_t_8 = __pyx_v_i;
-    __pyx_t_9 = -1;
-    if (__pyx_t_8 < 0) {
-      __pyx_t_8 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
-    } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
-    if (unlikely(__pyx_t_9 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_9);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":404
- *         output[i] = NaN
- * 
- *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
- *         val = input[i - win + 1]
- * 
- */
-  __pyx_t_9 = __pyx_v_N;
-  for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":405
- * 
- *     for i from win - 1 <= i < N:
- *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
- * 
- *         for j from (i - win + 1) <= j <= i:
- */
-    __pyx_t_7 = ((__pyx_v_i - __pyx_v_win) + 1);
-    __pyx_t_10 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_10 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
-    if (unlikely(__pyx_t_10 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":407
- *         val = input[i - win + 1]
- * 
- *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
- *             val = max(val, input[j])
- * 
- */
-    __pyx_t_10 = __pyx_v_i;
-    for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_10; __pyx_v_j++) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":408
- * 
- *         for j from (i - win + 1) <= j <= i:
- *             val = max(val, input[j])             # <<<<<<<<<<<<<<
- * 
- *         output[j] = val
- */
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_11 = __pyx_v_j;
-      __pyx_t_12 = -1;
-      if (__pyx_t_11 < 0) {
-        __pyx_t_11 += __pyx_bshape_0_input;
-        if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
-      } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_input)) __pyx_t_12 = 0;
-      if (unlikely(__pyx_t_12 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_t_2 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_11, __pyx_bstride_0_input))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
-      __Pyx_GIVEREF(__pyx_t_5);
-      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
-      __Pyx_GIVEREF(__pyx_t_2);
-      __pyx_t_5 = 0;
-      __pyx_t_2 = 0;
-      __pyx_t_2 = PyObject_Call(__pyx_builtin_max, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_v_val = __pyx_t_13;
-    }
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":410
- *             val = max(val, input[j])
- * 
- *         output[j] = val             # <<<<<<<<<<<<<<
- * 
- *     return output
- */
-    __pyx_t_10 = __pyx_v_j;
-    __pyx_t_12 = -1;
-    if (__pyx_t_10 < 0) {
-      __pyx_t_10 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_10 < 0)) __pyx_t_12 = 0;
-    } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_12 = 0;
-    if (unlikely(__pyx_t_12 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_12);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_val;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":412
- *         output[j] = val
- * 
- *     return output             # <<<<<<<<<<<<<<
- * 
- * def _roll_min(ndarray[double_t, ndim=1] input,
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_output));
-  __pyx_r = ((PyObject *)__pyx_v_output);
-  goto __pyx_L0;
-
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
-    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_max");
-  __pyx_r = NULL;
-  goto __pyx_L2;
-  __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __pyx_L2:;
-  __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":414
- *     return output
- * 
- * def _roll_min(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
- *               int win):
- *     cdef double val
- */
-
-static PyObject *__pyx_pf_7tseries__roll_min(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries__roll_min(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_input = 0;
-  int __pyx_v_win;
-  double __pyx_v_val;
-  int __pyx_v_i;
-  int __pyx_v_j;
-  int __pyx_v_N;
-  PyArrayObject *__pyx_v_output = 0;
-  Py_buffer __pyx_bstruct_output;
-  Py_ssize_t __pyx_bstride_0_output = 0;
-  Py_ssize_t __pyx_bshape_0_output = 0;
-  Py_buffer __pyx_bstruct_input;
-  Py_ssize_t __pyx_bstride_0_input = 0;
-  Py_ssize_t __pyx_bshape_0_input = 0;
-  PyObject *__pyx_r = NULL;
-  Py_ssize_t __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyArrayObject *__pyx_t_6 = NULL;
-  long __pyx_t_7;
-  int __pyx_t_8;
-  int __pyx_t_9;
-  int __pyx_t_10;
-  int __pyx_t_11;
-  int __pyx_t_12;
-  double __pyx_t_13;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,0};
-  __Pyx_RefNannySetupContext("_roll_min");
-  __pyx_self = __pyx_self;
-  if (unlikely(__pyx_kwds)) {
-    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[2] = {0,0};
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      case  0: break;
-      default: goto __pyx_L5_argtuple_error;
-    }
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
-      if (likely(values[0])) kw_args--;
-      else goto __pyx_L5_argtuple_error;
-      case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
-      if (likely(values[1])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("_roll_min", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-    }
-    if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_min") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    }
-    __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
-    goto __pyx_L5_argtuple_error;
-  } else {
-    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_roll_min", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries._roll_min");
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
-  __pyx_bstruct_output.buf = NULL;
-  __pyx_bstruct_input.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
-  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":418
- *     cdef double val
- *     cdef int i, j
- *     cdef int N = len(input)             # <<<<<<<<<<<<<<
- * 
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
- */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_v_N = __pyx_t_1;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":420
- *     cdef int N = len(input)
- * 
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
- * 
- *     for i from 0 <= i < win - 1:
- */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
-      __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
-      __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
-    }
-  }
-  __pyx_t_6 = 0;
-  __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":422
- *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
- * 
- *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
- *         output[i] = NaN
- * 
- */
-  __pyx_t_7 = (__pyx_v_win - 1);
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":423
- * 
- *     for i from 0 <= i < win - 1:
- *         output[i] = NaN             # <<<<<<<<<<<<<<
- * 
- *     for i from win - 1 <= i < N:
- */
-    __pyx_t_8 = __pyx_v_i;
-    __pyx_t_9 = -1;
-    if (__pyx_t_8 < 0) {
-      __pyx_t_8 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
-    } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
-    if (unlikely(__pyx_t_9 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_9);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":425
- *         output[i] = NaN
- * 
- *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
- *         val = input[i - win + 1]
- * 
- */
-  __pyx_t_9 = __pyx_v_N;
-  for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":426
- * 
- *     for i from win - 1 <= i < N:
- *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
- * 
- *         for j from (i - win + 1) <= j <= i:
- */
-    __pyx_t_7 = ((__pyx_v_i - __pyx_v_win) + 1);
-    __pyx_t_10 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_bshape_0_input;
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_10 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
-    if (unlikely(__pyx_t_10 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":428
- *         val = input[i - win + 1]
- * 
- *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
- *             val = min(val, input[j])
- * 
- */
-    __pyx_t_10 = __pyx_v_i;
-    for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_10; __pyx_v_j++) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":429
- * 
- *         for j from (i - win + 1) <= j <= i:
- *             val = min(val, input[j])             # <<<<<<<<<<<<<<
- * 
- *         output[j] = val
- */
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_11 = __pyx_v_j;
-      __pyx_t_12 = -1;
-      if (__pyx_t_11 < 0) {
-        __pyx_t_11 += __pyx_bshape_0_input;
-        if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
-      } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_input)) __pyx_t_12 = 0;
-      if (unlikely(__pyx_t_12 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
-      __pyx_t_2 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_11, __pyx_bstride_0_input))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_4);
-      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
-      __Pyx_GIVEREF(__pyx_t_5);
-      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
-      __Pyx_GIVEREF(__pyx_t_2);
-      __pyx_t_5 = 0;
-      __pyx_t_2 = 0;
-      __pyx_t_2 = PyObject_Call(__pyx_builtin_min, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_v_val = __pyx_t_13;
-    }
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":431
- *             val = min(val, input[j])
- * 
- *         output[j] = val             # <<<<<<<<<<<<<<
- * 
- *     return output
- */
-    __pyx_t_10 = __pyx_v_j;
-    __pyx_t_12 = -1;
-    if (__pyx_t_10 < 0) {
-      __pyx_t_10 += __pyx_bshape_0_output;
-      if (unlikely(__pyx_t_10 < 0)) __pyx_t_12 = 0;
-    } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_12 = 0;
-    if (unlikely(__pyx_t_12 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_12);
-      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_val;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":433
- *         output[j] = val
- * 
- *     return output             # <<<<<<<<<<<<<<
- * 
- * #-------------------------------------------------------------------------------
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_output));
-  __pyx_r = ((PyObject *)__pyx_v_output);
-  goto __pyx_L0;
-
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
-    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries._roll_min");
-  __pyx_r = NULL;
-  goto __pyx_L2;
-  __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
-  __pyx_L2:;
-  __Pyx_XDECREF((PyObject *)__pyx_v_output);
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":438
- * # Python interface
- * 
- * def rolling_sum(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
- *     '''
- *     Compute rolling sum of input array
- */
-
-static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7tseries_rolling_sum[] = "\n    Compute rolling sum of input array\n\n    Parameters\n    ----------\n    input: ndarray\n    window: int\n    minp: int\n\n    Returns\n    -------\n    ndarray with length of input\n    ";
-static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_input = 0;
-  PyObject *__pyx_v_window = 0;
-  PyObject *__pyx_v_minp = 0;
-  PyObject *__pyx_r = NULL;
-  int __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  int __pyx_t_4;
-  PyObject *__pyx_t_5 = NULL;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("rolling_sum");
-  __pyx_self = __pyx_self;
-  if (unlikely(__pyx_kwds)) {
-    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[3] = {0,0,0};
-    values[2] = ((PyObject *)Py_None);
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      case  0: break;
-      default: goto __pyx_L5_argtuple_error;
-    }
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
-      if (likely(values[0])) kw_args--;
-      else goto __pyx_L5_argtuple_error;
-      case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
-      if (likely(values[1])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("rolling_sum", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  2:
-      if (kw_args > 0) {
-        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
-        if (unlikely(value)) { values[2] = value; kw_args--; }
-      }
-    }
-    if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_sum") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    }
-    __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_window = values[1];
-    __pyx_v_minp = values[2];
-  } else {
-    __pyx_v_minp = ((PyObject *)Py_None);
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  3:
-      __pyx_v_minp = PyTuple_GET_ITEM(__pyx_args, 2);
-      case  2:
-      __pyx_v_window = PyTuple_GET_ITEM(__pyx_args, 1);
-      __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-      break;
-      default: goto __pyx_L5_argtuple_error;
-    }
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_sum", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.rolling_sum");
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
-  __Pyx_INCREF(__pyx_v_window);
-  __Pyx_INCREF(__pyx_v_minp);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":452
- *     ndarray with length of input
- *     '''
- *     if minp is None:             # <<<<<<<<<<<<<<
- *         minp = window
- * 
- */
-  __pyx_t_1 = (__pyx_v_minp == Py_None);
-  if (__pyx_t_1) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":453
- *     '''
- *     if minp is None:
- *         minp = window             # <<<<<<<<<<<<<<
- * 
- *     if not issubclass(input.dtype.type, float):
- */
-    __Pyx_INCREF(__pyx_v_window);
-    __Pyx_DECREF(__pyx_v_minp);
-    __pyx_v_minp = __pyx_v_window;
-    goto __pyx_L6;
-  }
-  __pyx_L6:;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":455
- *         minp = window
- * 
- *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
- *         input = input.astype(float)
- * 
- */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = (!__pyx_t_1);
-  if (__pyx_t_4) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":456
- * 
- *     if not issubclass(input.dtype.type, float):
- *         input = input.astype(float)             # <<<<<<<<<<<<<<
- * 
- *     return _roll_sum(input, window, minp)
- */
-    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
-    __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(((PyObject *)__pyx_v_input));
-    __pyx_v_input = ((PyArrayObject *)__pyx_t_5);
-    __pyx_t_5 = 0;
-    goto __pyx_L7;
-  }
-  __pyx_L7:;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":458
- *         input = input.astype(float)
- * 
- *     return _roll_sum(input, window, minp)             # <<<<<<<<<<<<<<
- * 
- * def rolling_mean(ndarray input, window, minp=None):
- */
-  __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_sum); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(((PyObject *)__pyx_v_input));
-  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
-  __Pyx_INCREF(__pyx_v_window);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_window);
-  __Pyx_GIVEREF(__pyx_v_window);
-  __Pyx_INCREF(__pyx_v_minp);
-  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_minp);
-  __Pyx_GIVEREF(__pyx_v_minp);
-  __pyx_t_3 = PyObject_Call(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
-  goto __pyx_L0;
-
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.rolling_sum");
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
+  __Pyx_AddTraceback("tseries._roll_median");
   __pyx_r = NULL;
+  goto __pyx_L2;
   __pyx_L0:;
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __pyx_L2:;
+  __Pyx_DECREF((PyObject *)__pyx_v_skiplist);
+  __Pyx_XDECREF((PyObject *)__pyx_v_output);
   __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_DECREF(__pyx_v_window);
-  __Pyx_DECREF(__pyx_v_minp);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":460
- *     return _roll_sum(input, window, minp)
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":393
+ * # Rolling min / max
  * 
- * def rolling_mean(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
- *     if minp is None:
- *         minp = window
+ * def _roll_max(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *               int win):
+ *     cdef double val
  */
 
-static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__roll_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
-  PyObject *__pyx_v_window = 0;
-  PyObject *__pyx_v_minp = 0;
+  int __pyx_v_win;
+  double __pyx_v_val;
+  int __pyx_v_i;
+  int __pyx_v_j;
+  int __pyx_v_N;
+  PyArrayObject *__pyx_v_output = 0;
+  Py_buffer __pyx_bstruct_output;
+  Py_ssize_t __pyx_bstride_0_output = 0;
+  Py_ssize_t __pyx_bshape_0_output = 0;
+  Py_buffer __pyx_bstruct_input;
+  Py_ssize_t __pyx_bstride_0_input = 0;
+  Py_ssize_t __pyx_bshape_0_input = 0;
   PyObject *__pyx_r = NULL;
-  int __pyx_t_1;
+  Py_ssize_t __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  int __pyx_t_4;
+  PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("rolling_mean");
+  PyArrayObject *__pyx_t_6 = NULL;
+  long __pyx_t_7;
+  int __pyx_t_8;
+  int __pyx_t_9;
+  int __pyx_t_10;
+  int __pyx_t_11;
+  int __pyx_t_12;
+  double __pyx_t_13;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,0};
+  __Pyx_RefNannySetupContext("_roll_max");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[3] = {0,0,0};
-    values[2] = ((PyObject *)Py_None);
+    PyObject* values[2] = {0,0};
     switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       case  0: break;
@@ -12215,141 +9599,229 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_mean", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  2:
-      if (kw_args > 0) {
-        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
-        if (unlikely(value)) { values[2] = value; kw_args--; }
+        __Pyx_RaiseArgtupleInvalid("_roll_max", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_mean") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_max") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_window = values[1];
-    __pyx_v_minp = values[2];
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+    goto __pyx_L5_argtuple_error;
   } else {
-    __pyx_v_minp = ((PyObject *)Py_None);
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  3:
-      __pyx_v_minp = PyTuple_GET_ITEM(__pyx_args, 2);
-      case  2:
-      __pyx_v_window = PyTuple_GET_ITEM(__pyx_args, 1);
-      __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-      break;
-      default: goto __pyx_L5_argtuple_error;
-    }
+    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_mean", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_max", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.rolling_mean");
+  __Pyx_AddTraceback("tseries._roll_max");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
-  __Pyx_INCREF(__pyx_v_window);
-  __Pyx_INCREF(__pyx_v_minp);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_bstruct_output.buf = NULL;
+  __pyx_bstruct_input.buf = NULL;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
+  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":461
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":397
+ *     cdef double val
+ *     cdef int i, j
+ *     cdef int N = len(input)             # <<<<<<<<<<<<<<
  * 
- * def rolling_mean(ndarray input, window, minp=None):
- *     if minp is None:             # <<<<<<<<<<<<<<
- *         minp = window
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
+ */
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_N = __pyx_t_1;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":399
+ *     cdef int N = len(input)
  * 
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
+ * 
+ *     for i from 0 <= i < win - 1:
  */
-  __pyx_t_1 = (__pyx_v_minp == Py_None);
-  if (__pyx_t_1) {
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
+      __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
+    }
+  }
+  __pyx_t_6 = 0;
+  __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
+  __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":462
- * def rolling_mean(ndarray input, window, minp=None):
- *     if minp is None:
- *         minp = window             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":401
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
+ * 
+ *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
+ *         output[i] = NaN
  * 
- *     if not issubclass(input.dtype.type, float):
  */
-    __Pyx_INCREF(__pyx_v_window);
-    __Pyx_DECREF(__pyx_v_minp);
-    __pyx_v_minp = __pyx_v_window;
-    goto __pyx_L6;
+  __pyx_t_7 = (__pyx_v_win - 1);
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":402
+ * 
+ *     for i from 0 <= i < win - 1:
+ *         output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ *     for i from win - 1 <= i < N:
+ */
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
   }
-  __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":464
- *         minp = window
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":404
+ *         output[i] = NaN
  * 
- *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
- *         input = input.astype(float)
+ *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         val = input[i - win + 1]
  * 
  */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = (!__pyx_t_1);
-  if (__pyx_t_4) {
+  __pyx_t_9 = __pyx_v_N;
+  for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":405
+ * 
+ *     for i from win - 1 <= i < N:
+ *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
+ * 
+ *         for j from (i - win + 1) <= j <= i:
+ */
+    __pyx_t_7 = ((__pyx_v_i - __pyx_v_win) + 1);
+    __pyx_t_10 = -1;
+    if (__pyx_t_7 < 0) {
+      __pyx_t_7 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_7 < 0)) __pyx_t_10 = 0;
+    } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
+    if (unlikely(__pyx_t_10 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_10);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":407
+ *         val = input[i - win + 1]
+ * 
+ *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
+ *             val = max(val, input[j])
+ * 
+ */
+    __pyx_t_10 = __pyx_v_i;
+    for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_10; __pyx_v_j++) {
+
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":408
+ * 
+ *         for j from (i - win + 1) <= j <= i:
+ *             val = max(val, input[j])             # <<<<<<<<<<<<<<
+ * 
+ *         output[j] = val
+ */
+      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_11 = __pyx_v_j;
+      __pyx_t_12 = -1;
+      if (__pyx_t_11 < 0) {
+        __pyx_t_11 += __pyx_bshape_0_input;
+        if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
+      } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_input)) __pyx_t_12 = 0;
+      if (unlikely(__pyx_t_12 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_12);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_t_2 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_11, __pyx_bstride_0_input))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_5);
+      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
+      __Pyx_GIVEREF(__pyx_t_2);
+      __pyx_t_5 = 0;
+      __pyx_t_2 = 0;
+      __pyx_t_2 = PyObject_Call(__pyx_builtin_max, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_v_val = __pyx_t_13;
+    }
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":465
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":410
+ *             val = max(val, input[j])
  * 
- *     if not issubclass(input.dtype.type, float):
- *         input = input.astype(float)             # <<<<<<<<<<<<<<
+ *         output[j] = val             # <<<<<<<<<<<<<<
  * 
- *     return _roll_mean(input, window, minp)
+ *     return output
  */
-    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
-    __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(((PyObject *)__pyx_v_input));
-    __pyx_v_input = ((PyArrayObject *)__pyx_t_5);
-    __pyx_t_5 = 0;
-    goto __pyx_L7;
+    __pyx_t_10 = __pyx_v_j;
+    __pyx_t_12 = -1;
+    if (__pyx_t_10 < 0) {
+      __pyx_t_10 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_10 < 0)) __pyx_t_12 = 0;
+    } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_12 = 0;
+    if (unlikely(__pyx_t_12 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_12);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_val;
   }
-  __pyx_L7:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":467
- *         input = input.astype(float)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":412
+ *         output[j] = val
  * 
- *     return _roll_mean(input, window, minp)             # <<<<<<<<<<<<<<
+ *     return output             # <<<<<<<<<<<<<<
  * 
- * def rolling_median(ndarray input, window, minp=None):
+ * def _roll_min(ndarray[double_t, ndim=1] input,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_mean); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(((PyObject *)__pyx_v_input));
-  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
-  __Pyx_INCREF(__pyx_v_window);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_window);
-  __Pyx_GIVEREF(__pyx_v_window);
-  __Pyx_INCREF(__pyx_v_minp);
-  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_minp);
-  __Pyx_GIVEREF(__pyx_v_minp);
-  __pyx_t_3 = PyObject_Call(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_INCREF(((PyObject *)__pyx_v_output));
+  __pyx_r = ((PyObject *)__pyx_v_output);
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
@@ -12357,46 +9829,71 @@ static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.rolling_mean");
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
+  __Pyx_AddTraceback("tseries._roll_max");
   __pyx_r = NULL;
+  goto __pyx_L2;
   __pyx_L0:;
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __pyx_L2:;
+  __Pyx_XDECREF((PyObject *)__pyx_v_output);
   __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_DECREF(__pyx_v_window);
-  __Pyx_DECREF(__pyx_v_minp);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":469
- *     return _roll_mean(input, window, minp)
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":414
+ *     return output
  * 
- * def rolling_median(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
- *     if minp is None:
- *         minp = window
+ * def _roll_min(ndarray[double_t, ndim=1] input,             # <<<<<<<<<<<<<<
+ *               int win):
+ *     cdef double val
  */
 
-static PyObject *__pyx_pf_7tseries_rolling_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_rolling_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries__roll_min(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries__roll_min(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
-  PyObject *__pyx_v_window = 0;
-  PyObject *__pyx_v_minp = 0;
+  int __pyx_v_win;
+  double __pyx_v_val;
+  int __pyx_v_i;
+  int __pyx_v_j;
+  int __pyx_v_N;
+  PyArrayObject *__pyx_v_output = 0;
+  Py_buffer __pyx_bstruct_output;
+  Py_ssize_t __pyx_bstride_0_output = 0;
+  Py_ssize_t __pyx_bshape_0_output = 0;
+  Py_buffer __pyx_bstruct_input;
+  Py_ssize_t __pyx_bstride_0_input = 0;
+  Py_ssize_t __pyx_bshape_0_input = 0;
   PyObject *__pyx_r = NULL;
-  int __pyx_t_1;
+  Py_ssize_t __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  int __pyx_t_4;
+  PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("rolling_median");
+  PyArrayObject *__pyx_t_6 = NULL;
+  long __pyx_t_7;
+  int __pyx_t_8;
+  int __pyx_t_9;
+  int __pyx_t_10;
+  int __pyx_t_11;
+  int __pyx_t_12;
+  double __pyx_t_13;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__win,0};
+  __Pyx_RefNannySetupContext("_roll_min");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[3] = {0,0,0};
-    values[2] = ((PyObject *)Py_None);
+    PyObject* values[2] = {0,0};
     switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       case  0: break;
@@ -12408,141 +9905,229 @@ static PyObject *__pyx_pf_7tseries_rolling_median(PyObject *__pyx_self, PyObject
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__win);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_median", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  2:
-      if (kw_args > 0) {
-        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
-        if (unlikely(value)) { values[2] = value; kw_args--; }
+        __Pyx_RaiseArgtupleInvalid("_roll_min", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_median") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_roll_min") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_window = values[1];
-    __pyx_v_minp = values[2];
+    __pyx_v_win = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+    goto __pyx_L5_argtuple_error;
   } else {
-    __pyx_v_minp = ((PyObject *)Py_None);
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  3:
-      __pyx_v_minp = PyTuple_GET_ITEM(__pyx_args, 2);
-      case  2:
-      __pyx_v_window = PyTuple_GET_ITEM(__pyx_args, 1);
-      __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-      break;
-      default: goto __pyx_L5_argtuple_error;
-    }
+    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+    __pyx_v_win = __Pyx_PyInt_AsInt(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_win == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_median", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("_roll_min", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.rolling_median");
+  __Pyx_AddTraceback("tseries._roll_min");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
-  __Pyx_INCREF(__pyx_v_window);
-  __Pyx_INCREF(__pyx_v_minp);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_bstruct_output.buf = NULL;
+  __pyx_bstruct_input.buf = NULL;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_input, (PyObject*)__pyx_v_input, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  }
+  __pyx_bstride_0_input = __pyx_bstruct_input.strides[0];
+  __pyx_bshape_0_input = __pyx_bstruct_input.shape[0];
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":418
+ *     cdef double val
+ *     cdef int i, j
+ *     cdef int N = len(input)             # <<<<<<<<<<<<<<
+ * 
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
+ */
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_N = __pyx_t_1;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":420
+ *     cdef int N = len(input)
+ * 
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
+ * 
+ *     for i from 0 <= i < win - 1:
+ */
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_N); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_output, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_output = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_bstruct_output.buf = NULL;
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    } else {__pyx_bstride_0_output = __pyx_bstruct_output.strides[0];
+      __pyx_bshape_0_output = __pyx_bstruct_output.shape[0];
+    }
+  }
+  __pyx_t_6 = 0;
+  __pyx_v_output = ((PyArrayObject *)__pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":422
+ *     cdef ndarray[double_t, ndim=1] output = np.empty(N, dtype=float)
+ * 
+ *     for i from 0 <= i < win - 1:             # <<<<<<<<<<<<<<
+ *         output[i] = NaN
+ * 
+ */
+  __pyx_t_7 = (__pyx_v_win - 1);
+  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_7; __pyx_v_i++) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":423
+ * 
+ *     for i from 0 <= i < win - 1:
+ *         output[i] = NaN             # <<<<<<<<<<<<<<
+ * 
+ *     for i from win - 1 <= i < N:
+ */
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_bshape_0_output)) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_8, __pyx_bstride_0_output) = __pyx_v_7tseries_NaN;
+  }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":470
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":425
+ *         output[i] = NaN
  * 
- * def rolling_median(ndarray input, window, minp=None):
- *     if minp is None:             # <<<<<<<<<<<<<<
- *         minp = window
+ *     for i from win - 1 <= i < N:             # <<<<<<<<<<<<<<
+ *         val = input[i - win + 1]
  * 
  */
-  __pyx_t_1 = (__pyx_v_minp == Py_None);
-  if (__pyx_t_1) {
+  __pyx_t_9 = __pyx_v_N;
+  for (__pyx_v_i = (__pyx_v_win - 1); __pyx_v_i < __pyx_t_9; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":471
- * def rolling_median(ndarray input, window, minp=None):
- *     if minp is None:
- *         minp = window             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":426
  * 
- *     if not issubclass(input.dtype.type, float):
+ *     for i from win - 1 <= i < N:
+ *         val = input[i - win + 1]             # <<<<<<<<<<<<<<
+ * 
+ *         for j from (i - win + 1) <= j <= i:
  */
-    __Pyx_INCREF(__pyx_v_window);
-    __Pyx_DECREF(__pyx_v_minp);
-    __pyx_v_minp = __pyx_v_window;
-    goto __pyx_L6;
-  }
-  __pyx_L6:;
+    __pyx_t_7 = ((__pyx_v_i - __pyx_v_win) + 1);
+    __pyx_t_10 = -1;
+    if (__pyx_t_7 < 0) {
+      __pyx_t_7 += __pyx_bshape_0_input;
+      if (unlikely(__pyx_t_7 < 0)) __pyx_t_10 = 0;
+    } else if (unlikely(__pyx_t_7 >= __pyx_bshape_0_input)) __pyx_t_10 = 0;
+    if (unlikely(__pyx_t_10 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_10);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    __pyx_v_val = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_7, __pyx_bstride_0_input));
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":473
- *         minp = window
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":428
+ *         val = input[i - win + 1]
  * 
- *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
- *         input = input.astype(float)
+ *         for j from (i - win + 1) <= j <= i:             # <<<<<<<<<<<<<<
+ *             val = min(val, input[j])
  * 
  */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = (!__pyx_t_1);
-  if (__pyx_t_4) {
+    __pyx_t_10 = __pyx_v_i;
+    for (__pyx_v_j = ((__pyx_v_i - __pyx_v_win) + 1); __pyx_v_j <= __pyx_t_10; __pyx_v_j++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":474
+      /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":429
  * 
- *     if not issubclass(input.dtype.type, float):
- *         input = input.astype(float)             # <<<<<<<<<<<<<<
+ *         for j from (i - win + 1) <= j <= i:
+ *             val = min(val, input[j])             # <<<<<<<<<<<<<<
  * 
- *     return _roll_median(input, window, minp)
+ *         output[j] = val
  */
-    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
-    __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(((PyObject *)__pyx_v_input));
-    __pyx_v_input = ((PyArrayObject *)__pyx_t_5);
-    __pyx_t_5 = 0;
-    goto __pyx_L7;
+      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_val); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_11 = __pyx_v_j;
+      __pyx_t_12 = -1;
+      if (__pyx_t_11 < 0) {
+        __pyx_t_11 += __pyx_bshape_0_input;
+        if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
+      } else if (unlikely(__pyx_t_11 >= __pyx_bshape_0_input)) __pyx_t_12 = 0;
+      if (unlikely(__pyx_t_12 != -1)) {
+        __Pyx_RaiseBufferIndexError(__pyx_t_12);
+        {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      }
+      __pyx_t_2 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_input.buf, __pyx_t_11, __pyx_bstride_0_input))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_5);
+      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
+      __Pyx_GIVEREF(__pyx_t_2);
+      __pyx_t_5 = 0;
+      __pyx_t_2 = 0;
+      __pyx_t_2 = PyObject_Call(__pyx_builtin_min, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_v_val = __pyx_t_13;
+    }
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":431
+ *             val = min(val, input[j])
+ * 
+ *         output[j] = val             # <<<<<<<<<<<<<<
+ * 
+ *     return output
+ */
+    __pyx_t_10 = __pyx_v_j;
+    __pyx_t_12 = -1;
+    if (__pyx_t_10 < 0) {
+      __pyx_t_10 += __pyx_bshape_0_output;
+      if (unlikely(__pyx_t_10 < 0)) __pyx_t_12 = 0;
+    } else if (unlikely(__pyx_t_10 >= __pyx_bshape_0_output)) __pyx_t_12 = 0;
+    if (unlikely(__pyx_t_12 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_12);
+      {__pyx_filename = __pyx_f[2]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    }
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_double_t *, __pyx_bstruct_output.buf, __pyx_t_10, __pyx_bstride_0_output) = __pyx_v_val;
   }
-  __pyx_L7:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":476
- *         input = input.astype(float)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":433
+ *         output[j] = val
  * 
- *     return _roll_median(input, window, minp)             # <<<<<<<<<<<<<<
+ *     return output             # <<<<<<<<<<<<<<
  * 
- * def rolling_var(ndarray input, window, minp=None):
+ * #-------------------------------------------------------------------------------
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_median); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(((PyObject *)__pyx_v_input));
-  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
-  __Pyx_INCREF(__pyx_v_window);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_window);
-  __Pyx_GIVEREF(__pyx_v_window);
-  __Pyx_INCREF(__pyx_v_minp);
-  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_minp);
-  __Pyx_GIVEREF(__pyx_v_minp);
-  __pyx_t_3 = PyObject_Call(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_INCREF(((PyObject *)__pyx_v_output));
+  __pyx_r = ((PyObject *)__pyx_v_output);
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
@@ -12550,28 +10135,38 @@ static PyObject *__pyx_pf_7tseries_rolling_median(PyObject *__pyx_self, PyObject
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.rolling_median");
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
+  __Pyx_AddTraceback("tseries._roll_min");
   __pyx_r = NULL;
+  goto __pyx_L2;
   __pyx_L0:;
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_output);
+  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_input);
+  __pyx_L2:;
+  __Pyx_XDECREF((PyObject *)__pyx_v_output);
   __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_DECREF(__pyx_v_window);
-  __Pyx_DECREF(__pyx_v_minp);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":478
- *     return _roll_median(input, window, minp)
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":438
+ * # Python interface
  * 
- * def rolling_var(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
- *     if minp is None:
- *         minp = window
+ * def rolling_sum(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
+ *     '''
+ *     Compute rolling sum of input array
  */
 
-static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7tseries_rolling_sum[] = "\n    Compute rolling sum of input array\n\n    Parameters\n    ----------\n    input: ndarray\n    window: int\n    minp: int\n\n    Returns\n    -------\n    ndarray with length of input\n    ";
+static PyObject *__pyx_pf_7tseries_rolling_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   PyObject *__pyx_v_window = 0;
   PyObject *__pyx_v_minp = 0;
@@ -12582,7 +10177,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("rolling_var");
+  __Pyx_RefNannySetupContext("rolling_sum");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -12604,7 +10199,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_var", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_sum", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -12613,7 +10208,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_var") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_sum") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -12632,100 +10227,76 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_var", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_sum", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.rolling_var");
+  __Pyx_AddTraceback("tseries.rolling_sum");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":479
- * 
- * def rolling_var(ndarray input, window, minp=None):
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":452
+ *     ndarray with length of input
+ *     '''
  *     if minp is None:             # <<<<<<<<<<<<<<
  *         minp = window
- *     else:
+ * 
  */
   __pyx_t_1 = (__pyx_v_minp == Py_None);
   if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":480
- * def rolling_var(ndarray input, window, minp=None):
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":453
+ *     '''
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
- *     else:
- *         minp = max(2, minp)
+ * 
+ *     if not issubclass(input.dtype.type, float):
  */
     __Pyx_INCREF(__pyx_v_window);
     __Pyx_DECREF(__pyx_v_minp);
     __pyx_v_minp = __pyx_v_window;
     goto __pyx_L6;
   }
-  /*else*/ {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":482
- *         minp = window
- *     else:
- *         minp = max(2, minp)             # <<<<<<<<<<<<<<
- * 
- *     if not issubclass(input.dtype.type, float):
- */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 482; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_int_2);
-    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
-    __Pyx_GIVEREF(__pyx_int_2);
-    __Pyx_INCREF(__pyx_v_minp);
-    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
-    __Pyx_GIVEREF(__pyx_v_minp);
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 482; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_v_minp);
-    __pyx_v_minp = __pyx_t_3;
-    __pyx_t_3 = 0;
-  }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":484
- *         minp = max(2, minp)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":455
+ *         minp = window
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_4 = (!__pyx_t_1);
   if (__pyx_t_4) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":485
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":456
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
- *     return _roll_var(input, window, minp)
+ *     return _roll_sum(input, window, minp)
  */
-    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
+    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_5 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_5);
     __pyx_t_5 = 0;
@@ -12733,33 +10304,33 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L7:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":487
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":458
  *         input = input.astype(float)
  * 
- *     return _roll_var(input, window, minp)             # <<<<<<<<<<<<<<
+ *     return _roll_sum(input, window, minp)             # <<<<<<<<<<<<<<
  * 
- * def rolling_std(ndarray input, window, minp=None):
+ * def rolling_mean(ndarray input, window, minp=None):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_var); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_sum); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_input));
-  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_input));
+  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
   __Pyx_INCREF(__pyx_v_window);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_window);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_window);
   __Pyx_GIVEREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
-  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_v_minp);
+  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_minp);
   __Pyx_GIVEREF(__pyx_v_minp);
-  __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_Call(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_r = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
@@ -12768,7 +10339,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.rolling_var");
+  __Pyx_AddTraceback("tseries.rolling_sum");
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_DECREF((PyObject *)__pyx_v_input);
@@ -12779,27 +10350,27 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":489
- *     return _roll_var(input, window, minp)
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":460
+ *     return _roll_sum(input, window, minp)
  * 
- * def rolling_std(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
- *     output = rolling_var(input, window, minp=minp)
- *     return np.sqrt(output)
+ * def rolling_mean(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
+ *     if minp is None:
+ *         minp = window
  */
 
-static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_rolling_mean(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   PyObject *__pyx_v_window = 0;
   PyObject *__pyx_v_minp = 0;
-  PyObject *__pyx_v_output;
   PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
+  int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("rolling_std");
+  __Pyx_RefNannySetupContext("rolling_mean");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -12821,7 +10392,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_mean", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -12830,7 +10401,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_std") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_mean") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -12849,24 +10420,94 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_mean", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.rolling_std");
+  __Pyx_AddTraceback("tseries.rolling_mean");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_v_output = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_INCREF((PyObject *)__pyx_v_input);
+  __Pyx_INCREF(__pyx_v_window);
+  __Pyx_INCREF(__pyx_v_minp);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":490
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":461
  * 
- * def rolling_std(ndarray input, window, minp=None):
- *     output = rolling_var(input, window, minp=minp)             # <<<<<<<<<<<<<<
- *     return np.sqrt(output)
+ * def rolling_mean(ndarray input, window, minp=None):
+ *     if minp is None:             # <<<<<<<<<<<<<<
+ *         minp = window
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__rolling_var); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = (__pyx_v_minp == Py_None);
+  if (__pyx_t_1) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":462
+ * def rolling_mean(ndarray input, window, minp=None):
+ *     if minp is None:
+ *         minp = window             # <<<<<<<<<<<<<<
+ * 
+ *     if not issubclass(input.dtype.type, float):
+ */
+    __Pyx_INCREF(__pyx_v_window);
+    __Pyx_DECREF(__pyx_v_minp);
+    __pyx_v_minp = __pyx_v_window;
+    goto __pyx_L6;
+  }
+  __pyx_L6:;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":464
+ *         minp = window
+ * 
+ *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
+ *         input = input.astype(float)
+ * 
+ */
+  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = (!__pyx_t_1);
+  if (__pyx_t_4) {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":465
+ * 
+ *     if not issubclass(input.dtype.type, float):
+ *         input = input.astype(float)             # <<<<<<<<<<<<<<
+ * 
+ *     return _roll_mean(input, window, minp)
+ */
+    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
+    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
+    __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
+    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_input));
+    __pyx_v_input = ((PyArrayObject *)__pyx_t_5);
+    __pyx_t_5 = 0;
+    goto __pyx_L7;
+  }
+  __pyx_L7:;
+
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":467
+ *         input = input.astype(float)
+ * 
+ *     return _roll_mean(input, window, minp)             # <<<<<<<<<<<<<<
+ * 
+ * def rolling_median(ndarray input, window, minp=None):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_mean); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_input));
   PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
@@ -12874,70 +10515,44 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   __Pyx_INCREF(__pyx_v_window);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_window);
   __Pyx_GIVEREF(__pyx_v_window);
-  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
-  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__minp), __pyx_v_minp) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_2, ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_v_output);
-  __pyx_v_output = __pyx_t_4;
-  __pyx_t_4 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":491
- * def rolling_std(ndarray input, window, minp=None):
- *     output = rolling_var(input, window, minp=minp)
- *     return np.sqrt(output)             # <<<<<<<<<<<<<<
- * 
- * def rolling_skew(ndarray input, window, minp=None):
- */
-  __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__sqrt); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_INCREF(__pyx_v_minp);
+  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_minp);
+  __Pyx_GIVEREF(__pyx_v_minp);
+  __pyx_t_3 = PyObject_Call(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_INCREF(__pyx_v_output);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_output);
-  __Pyx_GIVEREF(__pyx_v_output);
-  __pyx_t_2 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_r = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_AddTraceback("tseries.rolling_std");
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("tseries.rolling_mean");
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_DECREF(__pyx_v_output);
+  __Pyx_DECREF((PyObject *)__pyx_v_input);
+  __Pyx_DECREF(__pyx_v_window);
+  __Pyx_DECREF(__pyx_v_minp);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":493
- *     return np.sqrt(output)
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":469
+ *     return _roll_mean(input, window, minp)
  * 
- * def rolling_skew(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
+ * def rolling_median(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
  *     if minp is None:
  *         minp = window
  */
 
-static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries_rolling_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_rolling_median(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   PyObject *__pyx_v_window = 0;
   PyObject *__pyx_v_minp = 0;
@@ -12948,7 +10563,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("rolling_skew");
+  __Pyx_RefNannySetupContext("rolling_median");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -12970,7 +10585,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_median", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -12979,7 +10594,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_skew") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_median") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -12998,100 +10613,76 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_median", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.rolling_skew");
+  __Pyx_AddTraceback("tseries.rolling_median");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":494
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":470
  * 
- * def rolling_skew(ndarray input, window, minp=None):
+ * def rolling_median(ndarray input, window, minp=None):
  *     if minp is None:             # <<<<<<<<<<<<<<
  *         minp = window
- *     else:
+ * 
  */
   __pyx_t_1 = (__pyx_v_minp == Py_None);
   if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":495
- * def rolling_skew(ndarray input, window, minp=None):
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":471
+ * def rolling_median(ndarray input, window, minp=None):
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
- *     else:
- *         minp = max(2, minp)
+ * 
+ *     if not issubclass(input.dtype.type, float):
  */
     __Pyx_INCREF(__pyx_v_window);
     __Pyx_DECREF(__pyx_v_minp);
     __pyx_v_minp = __pyx_v_window;
     goto __pyx_L6;
   }
-  /*else*/ {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":497
- *         minp = window
- *     else:
- *         minp = max(2, minp)             # <<<<<<<<<<<<<<
- * 
- *     if not issubclass(input.dtype.type, float):
- */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_int_2);
-    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
-    __Pyx_GIVEREF(__pyx_int_2);
-    __Pyx_INCREF(__pyx_v_minp);
-    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
-    __Pyx_GIVEREF(__pyx_v_minp);
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_v_minp);
-    __pyx_v_minp = __pyx_t_3;
-    __pyx_t_3 = 0;
-  }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":499
- *         minp = max(2, minp)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":473
+ *         minp = window
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_4 = (!__pyx_t_1);
   if (__pyx_t_4) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":500
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":474
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
- *     return _roll_skew(input, window, minp)
- */
-    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+ *     return _roll_median(input, window, minp)
+ */
+    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
+    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_5 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_5);
     __pyx_t_5 = 0;
@@ -13099,33 +10690,33 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   }
   __pyx_L7:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":502
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":476
  *         input = input.astype(float)
  * 
- *     return _roll_skew(input, window, minp)             # <<<<<<<<<<<<<<
+ *     return _roll_median(input, window, minp)             # <<<<<<<<<<<<<<
  * 
- * def rolling_kurt(ndarray input, window, minp=None):
+ * def rolling_var(ndarray input, window, minp=None):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_skew); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_median); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_input));
-  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_input));
+  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
   __Pyx_INCREF(__pyx_v_window);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_window);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_window);
   __Pyx_GIVEREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
-  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_v_minp);
+  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_minp);
   __Pyx_GIVEREF(__pyx_v_minp);
-  __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_Call(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_r = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
@@ -13134,7 +10725,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.rolling_skew");
+  __Pyx_AddTraceback("tseries.rolling_median");
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_DECREF((PyObject *)__pyx_v_input);
@@ -13145,16 +10736,16 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":504
- *     return _roll_skew(input, window, minp)
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":478
+ *     return _roll_median(input, window, minp)
  * 
- * def rolling_kurt(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
+ * def rolling_var(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
  *     if minp is None:
  *         minp = window
  */
 
-static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_input = 0;
   PyObject *__pyx_v_window = 0;
   PyObject *__pyx_v_minp = 0;
@@ -13165,7 +10756,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
-  __Pyx_RefNannySetupContext("rolling_kurt");
+  __Pyx_RefNannySetupContext("rolling_var");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
@@ -13187,7 +10778,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_var", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -13196,7 +10787,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_kurt") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_var") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -13215,19 +10806,19 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_var", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.rolling_kurt");
+  __Pyx_AddTraceback("tseries.rolling_var");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __Pyx_INCREF((PyObject *)__pyx_v_input);
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":505
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":479
  * 
- * def rolling_kurt(ndarray input, window, minp=None):
+ * def rolling_var(ndarray input, window, minp=None):
  *     if minp is None:             # <<<<<<<<<<<<<<
  *         minp = window
  *     else:
@@ -13235,8 +10826,8 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   __pyx_t_1 = (__pyx_v_minp == Py_None);
   if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":506
- * def rolling_kurt(ndarray input, window, minp=None):
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":480
+ * def rolling_var(ndarray input, window, minp=None):
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
  *     else:
@@ -13249,14 +10840,14 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   /*else*/ {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":508
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":482
  *         minp = window
  *     else:
  *         minp = max(2, minp)             # <<<<<<<<<<<<<<
  * 
  *     if not issubclass(input.dtype.type, float):
  */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 482; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_int_2);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
@@ -13264,7 +10855,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
     __Pyx_INCREF(__pyx_v_minp);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
     __Pyx_GIVEREF(__pyx_v_minp);
-    __pyx_t_3 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 482; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_v_minp);
@@ -13273,42 +10864,42 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":510
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":484
  *         minp = max(2, minp)
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = (!__pyx_t_1);
   if (__pyx_t_4) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":511
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":485
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
- *     return _roll_kurt(input, window, minp)
+ *     return _roll_var(input, window, minp)
  */
-    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
     PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_5 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_5);
     __pyx_t_5 = 0;
@@ -13316,17 +10907,17 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   __pyx_L7:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":513
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":487
  *         input = input.astype(float)
  * 
- *     return _roll_kurt(input, window, minp)             # <<<<<<<<<<<<<<
+ *     return _roll_var(input, window, minp)             # <<<<<<<<<<<<<<
  * 
- * def ewma(ndarray input, com):
+ * def rolling_std(ndarray input, window, minp=None):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_kurt); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_var); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_input));
   PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_input));
@@ -13337,7 +10928,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   __Pyx_INCREF(__pyx_v_minp);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_v_minp);
   __Pyx_GIVEREF(__pyx_v_minp);
-  __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -13351,218 +10942,43 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.rolling_kurt");
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_DECREF(__pyx_v_window);
-  __Pyx_DECREF(__pyx_v_minp);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":515
- *     return _roll_kurt(input, window, minp)
- * 
- * def ewma(ndarray input, com):             # <<<<<<<<<<<<<<
- *     N = len(input)
- * 
- */
-
-static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_input = 0;
-  PyObject *__pyx_v_com = 0;
-  PyObject *__pyx_v_N;
-  PyObject *__pyx_r = NULL;
-  Py_ssize_t __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  int __pyx_t_4;
-  int __pyx_t_5;
-  PyObject *__pyx_t_6 = NULL;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__com,0};
-  __Pyx_RefNannySetupContext("ewma");
-  __pyx_self = __pyx_self;
-  if (unlikely(__pyx_kwds)) {
-    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[2] = {0,0};
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      case  0: break;
-      default: goto __pyx_L5_argtuple_error;
-    }
-    switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
-      if (likely(values[0])) kw_args--;
-      else goto __pyx_L5_argtuple_error;
-      case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__com);
-      if (likely(values[1])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-    }
-    if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "ewma") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-    }
-    __pyx_v_input = ((PyArrayObject *)values[0]);
-    __pyx_v_com = values[1];
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
-    goto __pyx_L5_argtuple_error;
-  } else {
-    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_com = PyTuple_GET_ITEM(__pyx_args, 1);
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.ewma");
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_input);
-  __Pyx_INCREF(__pyx_v_com);
-  __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":516
- * 
- * def ewma(ndarray input, com):
- *     N = len(input)             # <<<<<<<<<<<<<<
- * 
- *     if not issubclass(input.dtype.type, float):
- */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_v_N);
-  __pyx_v_N = __pyx_t_2;
-  __pyx_t_2 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":518
- *     N = len(input)
- * 
- *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
- *         input = input.astype(float)
- * 
- */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = (!__pyx_t_4);
-  if (__pyx_t_5) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":519
- * 
- *     if not issubclass(input.dtype.type, float):
- *         input = input.astype(float)             # <<<<<<<<<<<<<<
- * 
- *     return _ewma(input, com)
- */
-    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
-    __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(((PyObject *)__pyx_v_input));
-    __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
-    __pyx_t_6 = 0;
-    goto __pyx_L6;
-  }
-  __pyx_L6:;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/moments.pyx":521
- *         input = input.astype(float)
- * 
- *     return _ewma(input, com)             # <<<<<<<<<<<<<<
- */
-  __Pyx_XDECREF(__pyx_r);
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s___ewma); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(((PyObject *)__pyx_v_input));
-  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
-  __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
-  __Pyx_INCREF(__pyx_v_com);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_com);
-  __Pyx_GIVEREF(__pyx_v_com);
-  __pyx_t_3 = PyObject_Call(__pyx_t_6, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
-  goto __pyx_L0;
-
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_AddTraceback("tseries.ewma");
+  __Pyx_AddTraceback("tseries.rolling_var");
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_DECREF(__pyx_v_N);
   __Pyx_DECREF((PyObject *)__pyx_v_input);
-  __Pyx_DECREF(__pyx_v_com);
+  __Pyx_DECREF(__pyx_v_window);
+  __Pyx_DECREF(__pyx_v_minp);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":2
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":489
+ *     return _roll_var(input, window, minp)
  * 
- * def reindex(ndarray index, ndarray arr, dict idxMap):             # <<<<<<<<<<<<<<
- *     '''
- *     Using the provided new index, a given array, and a mapping of index-value
+ * def rolling_std(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
+ *     output = rolling_var(input, window, minp=minp)
+ *     return np.sqrt(output)
  */
 
-static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7tseries_reindex[] = "\n    Using the provided new index, a given array, and a mapping of index-value\n    correpondences in the value array, return a new ndarray conforming to\n    the new index.\n\n    This is significantly faster than doing it in pure Python.\n    ";
-static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_index = 0;
-  PyArrayObject *__pyx_v_arr = 0;
-  PyObject *__pyx_v_idxMap = 0;
-  PyArrayObject *__pyx_v_result;
-  double *__pyx_v_result_data;
-  int __pyx_v_i;
-  int __pyx_v_length;
-  PyArrayIterObject *__pyx_v_itera;
-  PyArrayIterObject *__pyx_v_iteridx;
-  double __pyx_v_nan;
-  PyObject *__pyx_v_idx;
+static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_input = 0;
+  PyObject *__pyx_v_window = 0;
+  PyObject *__pyx_v_minp = 0;
+  PyObject *__pyx_v_output;
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  double __pyx_t_3;
+  PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
-  int __pyx_t_7;
-  npy_intp __pyx_t_8;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__arr,&__pyx_n_s__idxMap,0};
-  __Pyx_RefNannySetupContext("reindex");
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
+  __Pyx_RefNannySetupContext("rolling_std");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
     PyObject* values[3] = {0,0,0};
+    values[2] = ((PyObject *)Py_None);
     switch (PyTuple_GET_SIZE(__pyx_args)) {
       case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
@@ -13572,252 +10988,102 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
     }
     switch (PyTuple_GET_SIZE(__pyx_args)) {
       case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__index);
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__arr);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("reindex", 1, 3, 3, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__idxMap);
-      if (likely(values[2])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("reindex", 1, 3, 3, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (kw_args > 0) {
+        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
+        if (unlikely(value)) { values[2] = value; kw_args--; }
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "reindex") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_std") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
-    __pyx_v_index = ((PyArrayObject *)values[0]);
-    __pyx_v_arr = ((PyArrayObject *)values[1]);
-    __pyx_v_idxMap = ((PyObject *)values[2]);
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
-    goto __pyx_L5_argtuple_error;
+    __pyx_v_input = ((PyArrayObject *)values[0]);
+    __pyx_v_window = values[1];
+    __pyx_v_minp = values[2];
   } else {
-    __pyx_v_index = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_arr = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_idxMap = ((PyObject *)PyTuple_GET_ITEM(__pyx_args, 2));
+    __pyx_v_minp = ((PyObject *)Py_None);
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  3:
+      __pyx_v_minp = PyTuple_GET_ITEM(__pyx_args, 2);
+      case  2:
+      __pyx_v_window = PyTuple_GET_ITEM(__pyx_args, 1);
+      __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+      break;
+      default: goto __pyx_L5_argtuple_error;
+    }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("reindex", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.reindex");
+  __Pyx_AddTraceback("tseries.rolling_std");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
-  __Pyx_INCREF(__pyx_v_idxMap);
-  __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_itera = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_iteridx = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_idxMap), &PyDict_Type, 1, "idxMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_v_output = Py_None; __Pyx_INCREF(Py_None);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":17
- *     cdef object idx
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":490
  * 
- *     nan = <double> np.NaN             # <<<<<<<<<<<<<<
+ * def rolling_std(ndarray input, window, minp=None):
+ *     output = rolling_var(input, window, minp=minp)             # <<<<<<<<<<<<<<
+ *     return np.sqrt(output)
  * 
- *     length = PyArray_SIZE(index)
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__rolling_var); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_INCREF(((PyObject *)__pyx_v_input));
+  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
+  __Pyx_INCREF(__pyx_v_window);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_window);
+  __Pyx_GIVEREF(__pyx_v_window);
+  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
+  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__minp), __pyx_v_minp) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_2, ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_nan = ((double)__pyx_t_3);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":19
- *     nan = <double> np.NaN
- * 
- *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
- * 
- *     result = <ndarray> np.empty(length, np.float64)
- */
-  __pyx_v_length = PyArray_SIZE(__pyx_v_index);
+  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_v_output);
+  __pyx_v_output = __pyx_t_4;
+  __pyx_t_4 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":21
- *     length = PyArray_SIZE(index)
- * 
- *     result = <ndarray> np.empty(length, np.float64)             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":491
+ * def rolling_std(ndarray input, window, minp=None):
+ *     output = rolling_var(input, window, minp=minp)
+ *     return np.sqrt(output)             # <<<<<<<<<<<<<<
  * 
- *     result_data = <double *> result.data
+ * def rolling_skew(ndarray input, window, minp=None):
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__float64); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__sqrt); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5);
-  __Pyx_GIVEREF(__pyx_t_5);
-  __pyx_t_2 = 0;
-  __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_INCREF(__pyx_v_output);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_output);
+  __Pyx_GIVEREF(__pyx_v_output);
+  __pyx_t_2 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_result));
-  __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":23
- *     result = <ndarray> np.empty(length, np.float64)
- * 
- *     result_data = <double *> result.data             # <<<<<<<<<<<<<<
- * 
- *     itera = <flatiter> PyArray_IterNew(arr)
- */
-  __pyx_v_result_data = ((double *)__pyx_v_result->data);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":25
- *     result_data = <double *> result.data
- * 
- *     itera = <flatiter> PyArray_IterNew(arr)             # <<<<<<<<<<<<<<
- *     iteridx = <flatiter> PyArray_IterNew(index)
- * 
- */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_arr)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_itera));
-  __pyx_v_itera = ((PyArrayIterObject *)__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":26
- * 
- *     itera = <flatiter> PyArray_IterNew(arr)
- *     iteridx = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
- * 
- *     for i from 0 <= i < length:
- */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_iteridx));
-  __pyx_v_iteridx = ((PyArrayIterObject *)__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":28
- *     iteridx = <flatiter> PyArray_IterNew(index)
- * 
- *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
- *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
- *         PyArray_ITER_NEXT(iteridx)
- */
-  __pyx_t_6 = __pyx_v_length;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":29
- * 
- *     for i from 0 <= i < length:
- *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))             # <<<<<<<<<<<<<<
- *         PyArray_ITER_NEXT(iteridx)
- *         if idx not in idxMap:
- */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iteridx)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_v_idx);
-    __pyx_v_idx = __pyx_t_5;
-    __pyx_t_5 = 0;
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":30
- *     for i from 0 <= i < length:
- *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
- *         PyArray_ITER_NEXT(iteridx)             # <<<<<<<<<<<<<<
- *         if idx not in idxMap:
- *             result_data[i] = nan
- */
-    PyArray_ITER_NEXT(__pyx_v_iteridx);
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":31
- *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
- *         PyArray_ITER_NEXT(iteridx)
- *         if idx not in idxMap:             # <<<<<<<<<<<<<<
- *             result_data[i] = nan
- *             continue
- */
-    if (unlikely(((PyObject *)__pyx_v_idxMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {
-      __pyx_t_7 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_idxMap), __pyx_v_idx))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    if (__pyx_t_7) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":32
- *         PyArray_ITER_NEXT(iteridx)
- *         if idx not in idxMap:
- *             result_data[i] = nan             # <<<<<<<<<<<<<<
- *             continue
- *         PyArray_ITER_GOTO1D(itera, idxMap[idx])
- */
-      (__pyx_v_result_data[__pyx_v_i]) = __pyx_v_nan;
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":33
- *         if idx not in idxMap:
- *             result_data[i] = nan
- *             continue             # <<<<<<<<<<<<<<
- *         PyArray_ITER_GOTO1D(itera, idxMap[idx])
- *         result_data[i] = (<double *>PyArray_ITER_DATA(itera))[0]
- */
-      goto __pyx_L6_continue;
-      goto __pyx_L8;
-    }
-    __pyx_L8:;
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":34
- *             result_data[i] = nan
- *             continue
- *         PyArray_ITER_GOTO1D(itera, idxMap[idx])             # <<<<<<<<<<<<<<
- *         result_data[i] = (<double *>PyArray_ITER_DATA(itera))[0]
- * 
- */
-    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_idxMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = __Pyx_PyInt_from_py_npy_intp(__pyx_t_5); if (unlikely((__pyx_t_8 == (npy_intp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    PyArray_ITER_GOTO1D(__pyx_v_itera, __pyx_t_8);
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":35
- *             continue
- *         PyArray_ITER_GOTO1D(itera, idxMap[idx])
- *         result_data[i] = (<double *>PyArray_ITER_DATA(itera))[0]             # <<<<<<<<<<<<<<
- * 
- *     return result
- */
-    (__pyx_v_result_data[__pyx_v_i]) = (((double *)PyArray_ITER_DATA(__pyx_v_itera))[0]);
-    __pyx_L6_continue:;
-  }
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":37
- *         result_data[i] = (<double *>PyArray_ITER_DATA(itera))[0]
- * 
- *     return result             # <<<<<<<<<<<<<<
- * 
- * def reindexObj(ndarray index, ndarray arr, dict idxMap):
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_result));
-  __pyx_r = ((PyObject *)__pyx_v_result);
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
@@ -13825,62 +11091,43 @@ static PyObject *__pyx_pf_7tseries_reindex(PyObject *__pyx_self, PyObject *__pyx
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.reindex");
+  __Pyx_AddTraceback("tseries.rolling_std");
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_result);
-  __Pyx_DECREF((PyObject *)__pyx_v_itera);
-  __Pyx_DECREF((PyObject *)__pyx_v_iteridx);
-  __Pyx_DECREF(__pyx_v_idx);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
-  __Pyx_DECREF(__pyx_v_idxMap);
+  __Pyx_DECREF(__pyx_v_output);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":39
- *     return result
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":493
+ *     return np.sqrt(output)
  * 
- * def reindexObj(ndarray index, ndarray arr, dict idxMap):             # <<<<<<<<<<<<<<
- *     '''
- *     Using the provided new index, a given array, and a mapping of index-value
- */
-
-static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7tseries_reindexObj[] = "\n    Using the provided new index, a given array, and a mapping of index-value\n    correpondences in the value array, return a new ndarray conforming to\n    the new index.\n\n    This is significantly faster than doing it in pure Python.\n    ";
-static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_index = 0;
-  PyArrayObject *__pyx_v_arr = 0;
-  PyObject *__pyx_v_idxMap = 0;
-  PyArrayObject *__pyx_v_result;
-  int __pyx_v_i;
-  int __pyx_v_length;
-  PyArrayIterObject *__pyx_v_itera;
-  PyArrayIterObject *__pyx_v_iteridx;
-  PyArrayIterObject *__pyx_v_iterresult;
-  PyObject *__pyx_v_idx;
-  PyObject *__pyx_v_nan;
-  PyObject *__pyx_v_obj;
-  int __pyx_v_res;
+ * def rolling_skew(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
+ *     if minp is None:
+ *         minp = window
+ */
+
+static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_input = 0;
+  PyObject *__pyx_v_window = 0;
+  PyObject *__pyx_v_minp = 0;
   PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
+  int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
+  int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
-  int __pyx_t_7;
-  npy_intp __pyx_t_8;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__arr,&__pyx_n_s__idxMap,0};
-  __Pyx_RefNannySetupContext("reindexObj");
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
+  __Pyx_RefNannySetupContext("rolling_skew");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
     PyObject* values[3] = {0,0,0};
+    values[2] = ((PyObject *)Py_None);
     switch (PyTuple_GET_SIZE(__pyx_args)) {
       case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
@@ -13890,372 +11137,432 @@ static PyObject *__pyx_pf_7tseries_reindexObj(PyObject *__pyx_self, PyObject *__
     }
     switch (PyTuple_GET_SIZE(__pyx_args)) {
       case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__index);
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__arr);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("reindexObj", 1, 3, 3, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__idxMap);
-      if (likely(values[2])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("reindexObj", 1, 3, 3, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (kw_args > 0) {
+        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
+        if (unlikely(value)) { values[2] = value; kw_args--; }
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "reindexObj") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_skew") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
-    __pyx_v_index = ((PyArrayObject *)values[0]);
-    __pyx_v_arr = ((PyArrayObject *)values[1]);
-    __pyx_v_idxMap = ((PyObject *)values[2]);
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
-    goto __pyx_L5_argtuple_error;
+    __pyx_v_input = ((PyArrayObject *)values[0]);
+    __pyx_v_window = values[1];
+    __pyx_v_minp = values[2];
   } else {
-    __pyx_v_index = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_arr = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_idxMap = ((PyObject *)PyTuple_GET_ITEM(__pyx_args, 2));
+    __pyx_v_minp = ((PyObject *)Py_None);
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  3:
+      __pyx_v_minp = PyTuple_GET_ITEM(__pyx_args, 2);
+      case  2:
+      __pyx_v_window = PyTuple_GET_ITEM(__pyx_args, 1);
+      __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+      break;
+      default: goto __pyx_L5_argtuple_error;
+    }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("reindexObj", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.reindexObj");
+  __Pyx_AddTraceback("tseries.rolling_skew");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
-  __Pyx_INCREF(__pyx_v_idxMap);
-  __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_itera = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_iteridx = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_iterresult = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_nan = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_v_obj = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_idxMap), &PyDict_Type, 1, "idxMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_INCREF((PyObject *)__pyx_v_input);
+  __Pyx_INCREF(__pyx_v_window);
+  __Pyx_INCREF(__pyx_v_minp);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":52
- *     cdef object idx, nan, obj
- * 
- *     nan = np.NaN             # <<<<<<<<<<<<<<
- *     length = PyArray_SIZE(index)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":494
  * 
+ * def rolling_skew(ndarray input, window, minp=None):
+ *     if minp is None:             # <<<<<<<<<<<<<<
+ *         minp = window
+ *     else:
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_v_nan);
-  __pyx_v_nan = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __pyx_t_1 = (__pyx_v_minp == Py_None);
+  if (__pyx_t_1) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":53
- * 
- *     nan = np.NaN
- *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":495
+ * def rolling_skew(ndarray input, window, minp=None):
+ *     if minp is None:
+ *         minp = window             # <<<<<<<<<<<<<<
+ *     else:
+ *         minp = max(2, minp)
+ */
+    __Pyx_INCREF(__pyx_v_window);
+    __Pyx_DECREF(__pyx_v_minp);
+    __pyx_v_minp = __pyx_v_window;
+    goto __pyx_L6;
+  }
+  /*else*/ {
+
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":497
+ *         minp = window
+ *     else:
+ *         minp = max(2, minp)             # <<<<<<<<<<<<<<
  * 
- *     result = <ndarray> np.empty(length, dtype=np.object_)
+ *     if not issubclass(input.dtype.type, float):
  */
-  __pyx_v_length = PyArray_SIZE(__pyx_v_index);
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_INCREF(__pyx_int_2);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
+    __Pyx_GIVEREF(__pyx_int_2);
+    __Pyx_INCREF(__pyx_v_minp);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
+    __Pyx_GIVEREF(__pyx_v_minp);
+    __pyx_t_3 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_v_minp);
+    __pyx_v_minp = __pyx_t_3;
+    __pyx_t_3 = 0;
+  }
+  __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":55
- *     length = PyArray_SIZE(index)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":499
+ *         minp = max(2, minp)
  * 
- *     result = <ndarray> np.empty(length, dtype=np.object_)             # <<<<<<<<<<<<<<
+ *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
+ *         input = input.astype(float)
  * 
- *     itera = <flatiter> PyArray_IterNew(arr)
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__object_); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_3, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_result));
-  __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":57
- *     result = <ndarray> np.empty(length, dtype=np.object_)
- * 
- *     itera = <flatiter> PyArray_IterNew(arr)             # <<<<<<<<<<<<<<
- *     iteridx = <flatiter> PyArray_IterNew(index)
- *     iterresult = <flatiter> PyArray_IterNew(result)
- */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_arr)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_itera));
-  __pyx_v_itera = ((PyArrayIterObject *)__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_4 = (!__pyx_t_1);
+  if (__pyx_t_4) {
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":58
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":500
  * 
- *     itera = <flatiter> PyArray_IterNew(arr)
- *     iteridx = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
- *     iterresult = <flatiter> PyArray_IterNew(result)
+ *     if not issubclass(input.dtype.type, float):
+ *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
+ *     return _roll_skew(input, window, minp)
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_iteridx));
-  __pyx_v_iteridx = ((PyArrayIterObject *)__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
+    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
+    __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
+    __pyx_t_5 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_input));
+    __pyx_v_input = ((PyArrayObject *)__pyx_t_5);
+    __pyx_t_5 = 0;
+    goto __pyx_L7;
+  }
+  __pyx_L7:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":59
- *     itera = <flatiter> PyArray_IterNew(arr)
- *     iteridx = <flatiter> PyArray_IterNew(index)
- *     iterresult = <flatiter> PyArray_IterNew(result)             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":502
+ *         input = input.astype(float)
  * 
- *     cdef int res
+ *     return _roll_skew(input, window, minp)             # <<<<<<<<<<<<<<
+ * 
+ * def rolling_kurt(ndarray input, window, minp=None):
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_result)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_skew); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
-  __Pyx_DECREF(((PyObject *)__pyx_v_iterresult));
-  __pyx_v_iterresult = ((PyArrayIterObject *)__pyx_t_5);
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_INCREF(((PyObject *)__pyx_v_input));
+  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_input));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
+  __Pyx_INCREF(__pyx_v_window);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_window);
+  __Pyx_GIVEREF(__pyx_v_window);
+  __Pyx_INCREF(__pyx_v_minp);
+  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_v_minp);
+  __Pyx_GIVEREF(__pyx_v_minp);
+  __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
+  goto __pyx_L0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":63
- *     cdef int res
- * 
- *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
- *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
- *         PyArray_ITER_NEXT(iteridx)
- */
-  __pyx_t_6 = __pyx_v_length;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":64
- * 
- *     for i from 0 <= i < length:
- *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))             # <<<<<<<<<<<<<<
- *         PyArray_ITER_NEXT(iteridx)
- * 
- */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iteridx)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_v_idx);
-    __pyx_v_idx = __pyx_t_5;
-    __pyx_t_5 = 0;
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("tseries.rolling_skew");
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_DECREF((PyObject *)__pyx_v_input);
+  __Pyx_DECREF(__pyx_v_window);
+  __Pyx_DECREF(__pyx_v_minp);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":65
- *     for i from 0 <= i < length:
- *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
- *         PyArray_ITER_NEXT(iteridx)             # <<<<<<<<<<<<<<
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":504
+ *     return _roll_skew(input, window, minp)
  * 
- *         if idx not in idxMap:
+ * def rolling_kurt(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
+ *     if minp is None:
+ *         minp = window
  */
-    PyArray_ITER_NEXT(__pyx_v_iteridx);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":67
- *         PyArray_ITER_NEXT(iteridx)
- * 
- *         if idx not in idxMap:             # <<<<<<<<<<<<<<
- *             PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), nan)
- *             PyArray_ITER_NEXT(iterresult)
- */
-    if (unlikely(((PyObject *)__pyx_v_idxMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {
-      __pyx_t_7 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_idxMap), __pyx_v_idx))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_input = 0;
+  PyObject *__pyx_v_window = 0;
+  PyObject *__pyx_v_minp = 0;
+  PyObject *__pyx_r = NULL;
+  int __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__window,&__pyx_n_s__minp,0};
+  __Pyx_RefNannySetupContext("rolling_kurt");
+  __pyx_self = __pyx_self;
+  if (unlikely(__pyx_kwds)) {
+    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
+    PyObject* values[3] = {0,0,0};
+    values[2] = ((PyObject *)Py_None);
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      case  0: break;
+      default: goto __pyx_L5_argtuple_error;
     }
-    if (__pyx_t_7) {
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  0:
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
+      if (likely(values[0])) kw_args--;
+      else goto __pyx_L5_argtuple_error;
+      case  1:
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
+      if (likely(values[1])) kw_args--;
+      else {
+        __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      }
+      case  2:
+      if (kw_args > 0) {
+        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__minp);
+        if (unlikely(value)) { values[2] = value; kw_args--; }
+      }
+    }
+    if (unlikely(kw_args > 0)) {
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_kurt") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    }
+    __pyx_v_input = ((PyArrayObject *)values[0]);
+    __pyx_v_window = values[1];
+    __pyx_v_minp = values[2];
+  } else {
+    __pyx_v_minp = ((PyObject *)Py_None);
+    switch (PyTuple_GET_SIZE(__pyx_args)) {
+      case  3:
+      __pyx_v_minp = PyTuple_GET_ITEM(__pyx_args, 2);
+      case  2:
+      __pyx_v_window = PyTuple_GET_ITEM(__pyx_args, 1);
+      __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+      break;
+      default: goto __pyx_L5_argtuple_error;
+    }
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("tseries.rolling_kurt");
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __Pyx_INCREF((PyObject *)__pyx_v_input);
+  __Pyx_INCREF(__pyx_v_window);
+  __Pyx_INCREF(__pyx_v_minp);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":68
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":505
  * 
- *         if idx not in idxMap:
- *             PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), nan)             # <<<<<<<<<<<<<<
- *             PyArray_ITER_NEXT(iterresult)
- *             continue
+ * def rolling_kurt(ndarray input, window, minp=None):
+ *     if minp is None:             # <<<<<<<<<<<<<<
+ *         minp = window
+ *     else:
  */
-      PyArray_SETITEM(__pyx_v_result, PyArray_ITER_DATA(__pyx_v_iterresult), __pyx_v_nan);
+  __pyx_t_1 = (__pyx_v_minp == Py_None);
+  if (__pyx_t_1) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":69
- *         if idx not in idxMap:
- *             PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), nan)
- *             PyArray_ITER_NEXT(iterresult)             # <<<<<<<<<<<<<<
- *             continue
- * 
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":506
+ * def rolling_kurt(ndarray input, window, minp=None):
+ *     if minp is None:
+ *         minp = window             # <<<<<<<<<<<<<<
+ *     else:
+ *         minp = max(2, minp)
  */
-      PyArray_ITER_NEXT(__pyx_v_iterresult);
+    __Pyx_INCREF(__pyx_v_window);
+    __Pyx_DECREF(__pyx_v_minp);
+    __pyx_v_minp = __pyx_v_window;
+    goto __pyx_L6;
+  }
+  /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":70
- *             PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), nan)
- *             PyArray_ITER_NEXT(iterresult)
- *             continue             # <<<<<<<<<<<<<<
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":508
+ *         minp = window
+ *     else:
+ *         minp = max(2, minp)             # <<<<<<<<<<<<<<
  * 
- *         PyArray_ITER_GOTO1D(itera, idxMap[idx])
+ *     if not issubclass(input.dtype.type, float):
  */
-      goto __pyx_L6_continue;
-      goto __pyx_L8;
-    }
-    __pyx_L8:;
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_INCREF(__pyx_int_2);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
+    __Pyx_GIVEREF(__pyx_int_2);
+    __Pyx_INCREF(__pyx_v_minp);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
+    __Pyx_GIVEREF(__pyx_v_minp);
+    __pyx_t_3 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_v_minp);
+    __pyx_v_minp = __pyx_t_3;
+    __pyx_t_3 = 0;
+  }
+  __pyx_L6:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":72
- *             continue
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":510
+ *         minp = max(2, minp)
  * 
- *         PyArray_ITER_GOTO1D(itera, idxMap[idx])             # <<<<<<<<<<<<<<
- *         obj = PyArray_GETITEM(arr, PyArray_ITER_DATA(itera))
+ *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
+ *         input = input.astype(float)
  * 
  */
-    __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_idxMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = __Pyx_PyInt_from_py_npy_intp(__pyx_t_5); if (unlikely((__pyx_t_8 == (npy_intp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    PyArray_ITER_GOTO1D(__pyx_v_itera, __pyx_t_8);
+  __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_1 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_4 = (!__pyx_t_1);
+  if (__pyx_t_4) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":73
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":511
  * 
- *         PyArray_ITER_GOTO1D(itera, idxMap[idx])
- *         obj = PyArray_GETITEM(arr, PyArray_ITER_DATA(itera))             # <<<<<<<<<<<<<<
+ *     if not issubclass(input.dtype.type, float):
+ *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
- *         res = PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), obj)
+ *     return _roll_kurt(input, window, minp)
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_arr, PyArray_ITER_DATA(__pyx_v_itera)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
+    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
+    __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
+    __pyx_t_5 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_v_obj);
-    __pyx_v_obj = __pyx_t_5;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_input));
+    __pyx_v_input = ((PyArrayObject *)__pyx_t_5);
     __pyx_t_5 = 0;
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":75
- *         obj = PyArray_GETITEM(arr, PyArray_ITER_DATA(itera))
- * 
- *         res = PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), obj)             # <<<<<<<<<<<<<<
- *         PyArray_ITER_NEXT(iterresult)
- * 
- */
-    __pyx_v_res = PyArray_SETITEM(__pyx_v_result, PyArray_ITER_DATA(__pyx_v_iterresult), __pyx_v_obj);
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":76
- * 
- *         res = PyArray_SETITEM(result, PyArray_ITER_DATA(iterresult), obj)
- *         PyArray_ITER_NEXT(iterresult)             # <<<<<<<<<<<<<<
- * 
- *     return result
- */
-    PyArray_ITER_NEXT(__pyx_v_iterresult);
-    __pyx_L6_continue:;
+    goto __pyx_L7;
   }
+  __pyx_L7:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":78
- *         PyArray_ITER_NEXT(iterresult)
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":513
+ *         input = input.astype(float)
  * 
- *     return result             # <<<<<<<<<<<<<<
+ *     return _roll_kurt(input, window, minp)             # <<<<<<<<<<<<<<
  * 
- * @cython.boundscheck(False)
+ * def ewma(ndarray input, com):
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_result));
-  __pyx_r = ((PyObject *)__pyx_v_result);
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_kurt); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_INCREF(((PyObject *)__pyx_v_input));
+  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_input));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
+  __Pyx_INCREF(__pyx_v_window);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_window);
+  __Pyx_GIVEREF(__pyx_v_window);
+  __Pyx_INCREF(__pyx_v_minp);
+  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_v_minp);
+  __Pyx_GIVEREF(__pyx_v_minp);
+  __pyx_t_2 = PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("tseries.reindexObj");
+  __Pyx_AddTraceback("tseries.rolling_kurt");
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_DECREF((PyObject *)__pyx_v_result);
-  __Pyx_DECREF((PyObject *)__pyx_v_itera);
-  __Pyx_DECREF((PyObject *)__pyx_v_iteridx);
-  __Pyx_DECREF((PyObject *)__pyx_v_iterresult);
-  __Pyx_DECREF(__pyx_v_idx);
-  __Pyx_DECREF(__pyx_v_nan);
-  __Pyx_DECREF(__pyx_v_obj);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
-  __Pyx_DECREF(__pyx_v_idxMap);
+  __Pyx_DECREF((PyObject *)__pyx_v_input);
+  __Pyx_DECREF(__pyx_v_window);
+  __Pyx_DECREF(__pyx_v_minp);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":81
+/* "H:\workspace\pandas\pandas\lib\src\moments.pyx":515
+ *     return _roll_kurt(input, window, minp)
+ * 
+ * def ewma(ndarray input, com):             # <<<<<<<<<<<<<<
+ *     N = len(input)
  * 
- * @cython.boundscheck(False)
- * def reindexObject(ndarray[object, ndim=1] index,             # <<<<<<<<<<<<<<
- *                   ndarray[object, ndim=1] arr,
- *                   dict idxMap):
  */
 
-static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7tseries_reindexObject[] = "\n    Using the provided new index, a given array, and a mapping of index-value\n    correpondences in the value array, return a new ndarray conforming to\n    the new index.\n\n    Returns\n    -------\n    ndarray\n    ";
-static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyArrayObject *__pyx_v_index = 0;
-  PyArrayObject *__pyx_v_arr = 0;
-  PyObject *__pyx_v_idxMap = 0;
-  PyArrayObject *__pyx_v_result;
-  int __pyx_v_i;
-  int __pyx_v_length;
-  PyObject *__pyx_v_idx;
-  PyObject *__pyx_v_nan = 0;
-  Py_buffer __pyx_bstruct_index;
-  Py_ssize_t __pyx_bstride_0_index = 0;
-  Py_ssize_t __pyx_bshape_0_index = 0;
-  Py_buffer __pyx_bstruct_arr;
-  Py_ssize_t __pyx_bstride_0_arr = 0;
-  Py_ssize_t __pyx_bshape_0_arr = 0;
-  Py_buffer __pyx_bstruct_result;
-  Py_ssize_t __pyx_bstride_0_result = 0;
-  Py_ssize_t __pyx_bshape_0_result = 0;
+static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pf_7tseries_ewma(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_input = 0;
+  PyObject *__pyx_v_com = 0;
+  PyObject *__pyx_v_N;
   PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
+  Py_ssize_t __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyArrayObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
-  PyObject *__pyx_t_7 = NULL;
-  PyObject *__pyx_t_8 = NULL;
-  PyObject *__pyx_t_9 = NULL;
-  int __pyx_t_10;
-  int __pyx_t_11;
-  int __pyx_t_12;
-  PyObject **__pyx_t_13;
-  int __pyx_t_14;
-  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__arr,&__pyx_n_s__idxMap,0};
-  __Pyx_RefNannySetupContext("reindexObject");
+  int __pyx_t_4;
+  int __pyx_t_5;
+  PyObject *__pyx_t_6 = NULL;
+  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__input,&__pyx_n_s__com,0};
+  __Pyx_RefNannySetupContext("ewma");
   __pyx_self = __pyx_self;
   if (unlikely(__pyx_kwds)) {
     Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
-    PyObject* values[3] = {0,0,0};
+    PyObject* values[2] = {0,0};
     switch (PyTuple_GET_SIZE(__pyx_args)) {
-      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       case  0: break;
@@ -14263,276 +11570,138 @@ static PyObject *__pyx_pf_7tseries_reindexObject(PyObject *__pyx_self, PyObject
     }
     switch (PyTuple_GET_SIZE(__pyx_args)) {
       case  0:
-      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__index);
+      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__input);
       if (likely(values[0])) kw_args--;
       else goto __pyx_L5_argtuple_error;
       case  1:
-      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__arr);
+      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__com);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("reindexObject", 1, 3, 3, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
-      }
-      case  2:
-      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__idxMap);
-      if (likely(values[2])) kw_args--;
-      else {
-        __Pyx_RaiseArgtupleInvalid("reindexObject", 1, 3, 3, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, 1); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "reindexObject") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "ewma") < 0)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
-    __pyx_v_index = ((PyArrayObject *)values[0]);
-    __pyx_v_arr = ((PyArrayObject *)values[1]);
-    __pyx_v_idxMap = ((PyObject *)values[2]);
-  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
+    __pyx_v_input = ((PyArrayObject *)values[0]);
+    __pyx_v_com = values[1];
+  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
     goto __pyx_L5_argtuple_error;
   } else {
-    __pyx_v_index = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
-    __pyx_v_arr = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 1));
-    __pyx_v_idxMap = ((PyObject *)PyTuple_GET_ITEM(__pyx_args, 2));
+    __pyx_v_input = ((PyArrayObject *)PyTuple_GET_ITEM(__pyx_args, 0));
+    __pyx_v_com = PyTuple_GET_ITEM(__pyx_args, 1);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("reindexObject", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("ewma", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[2]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
-  __Pyx_AddTraceback("tseries.reindexObject");
+  __Pyx_AddTraceback("tseries.ewma");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __Pyx_INCREF((PyObject *)__pyx_v_index);
-  __Pyx_INCREF((PyObject *)__pyx_v_arr);
-  __Pyx_INCREF(__pyx_v_idxMap);
-  __pyx_v_result = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
-  __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
-  __pyx_bstruct_result.buf = NULL;
-  __pyx_bstruct_index.buf = NULL;
-  __pyx_bstruct_arr.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_idxMap), &PyDict_Type, 1, "idxMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_index, (PyObject*)__pyx_v_index, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_index = __pyx_bstruct_index.strides[0];
-  __pyx_bshape_0_index = __pyx_bstruct_index.shape[0];
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_arr, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_bstride_0_arr = __pyx_bstruct_arr.strides[0];
-  __pyx_bshape_0_arr = __pyx_bstruct_arr.shape[0];
+  __Pyx_INCREF((PyObject *)__pyx_v_input);
+  __Pyx_INCREF(__pyx_v_com);
+  __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":96
- *     cdef int i, loc, length
- *     cdef object idx, value
- *     cdef object nan = np.NaN             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":516
  * 
- *     length = index.shape[0]
+ * def ewma(ndarray input, com):
+ *     N = len(input)             # <<<<<<<<<<<<<<
+ * 
+ *     if not issubclass(input.dtype.type, float):
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__NaN); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_nan = __pyx_t_2;
+  __Pyx_DECREF(__pyx_v_N);
+  __pyx_v_N = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":98
- *     cdef object nan = np.NaN
- * 
- *     length = index.shape[0]             # <<<<<<<<<<<<<<
- *     result = np.empty(length, dtype=object)
- * 
- */
-  __pyx_v_length = (__pyx_v_index->dimensions[0]);
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":99
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":518
+ *     N = len(input)
  * 
- *     length = index.shape[0]
- *     result = np.empty(length, dtype=object)             # <<<<<<<<<<<<<<
+ *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
+ *         input = input.astype(float)
  * 
- *     for i from 0 <= i < length:
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_length); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_builtin_object) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_3, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_4 = PyObject_IsSubclass(__pyx_t_3, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
-    __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
-    if (unlikely(__pyx_t_6 < 0)) {
-      PyErr_Fetch(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
-      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_bstruct_result, (PyObject*)__pyx_v_result, &__Pyx_TypeInfo_object, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
-        Py_XDECREF(__pyx_t_7); Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9);
-        __Pyx_RaiseBufferFallbackError();
-      } else {
-        PyErr_Restore(__pyx_t_7, __pyx_t_8, __pyx_t_9);
-      }
-    }
-    __pyx_bstride_0_result = __pyx_bstruct_result.strides[0];
-    __pyx_bshape_0_result = __pyx_bstruct_result.shape[0];
-    if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  }
-  __pyx_t_5 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_v_result));
-  __pyx_v_result = ((PyArrayObject *)__pyx_t_4);
-  __pyx_t_4 = 0;
-
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":101
- *     result = np.empty(length, dtype=object)
- * 
- *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
- *         idx = index[i]
- *         if idx not in idxMap:
- */
-  __pyx_t_6 = __pyx_v_length;
-  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":102
- * 
- *     for i from 0 <= i < length:
- *         idx = index[i]             # <<<<<<<<<<<<<<
- *         if idx not in idxMap:
- *             result[i] = nan
- */
-    __pyx_t_10 = __pyx_v_i;
-    if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_bshape_0_index;
-    __pyx_t_4 = *__Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_index.buf, __pyx_t_10, __pyx_bstride_0_index);
-    __Pyx_INCREF((PyObject*)__pyx_t_4);
-    __Pyx_DECREF(__pyx_v_idx);
-    __pyx_v_idx = __pyx_t_4;
-    __pyx_t_4 = 0;
-
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":103
- *     for i from 0 <= i < length:
- *         idx = index[i]
- *         if idx not in idxMap:             # <<<<<<<<<<<<<<
- *             result[i] = nan
- *             continue
- */
-    if (unlikely(((PyObject *)__pyx_v_idxMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    } else {
-      __pyx_t_11 = (__Pyx_NegateNonNeg(PyDict_Contains(((PyObject *)__pyx_v_idxMap), __pyx_v_idx))); if (unlikely(__pyx_t_11 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
-    if (__pyx_t_11) {
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":104
- *         idx = index[i]
- *         if idx not in idxMap:
- *             result[i] = nan             # <<<<<<<<<<<<<<
- *             continue
- * 
- */
-      __pyx_t_12 = __pyx_v_i;
-      if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_bshape_0_result;
-      __pyx_t_13 = __Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_result.buf, __pyx_t_12, __pyx_bstride_0_result);
-      __Pyx_GOTREF(*__pyx_t_13);
-      __Pyx_DECREF(*__pyx_t_13); __Pyx_INCREF(__pyx_v_nan);
-      *__pyx_t_13 = __pyx_v_nan;
-      __Pyx_GIVEREF(*__pyx_t_13);
-
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":105
- *         if idx not in idxMap:
- *             result[i] = nan
- *             continue             # <<<<<<<<<<<<<<
- * 
- *         result[i] = arr[idxMap[idx]]
- */
-      goto __pyx_L6_continue;
-      goto __pyx_L8;
-    }
-    __pyx_L8:;
+  __pyx_t_5 = (!__pyx_t_4);
+  if (__pyx_t_5) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":107
- *             continue
+    /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":519
  * 
- *         result[i] = arr[idxMap[idx]]             # <<<<<<<<<<<<<<
+ *     if not issubclass(input.dtype.type, float):
+ *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
- *     return result
+ *     return _ewma(input, com)
  */
-    __pyx_t_4 = PyObject_GetItem(((PyObject *)__pyx_v_idxMap), __pyx_v_idx); if (!__pyx_t_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyObject_GetItem(((PyObject *)__pyx_v_arr), __pyx_t_4); if (!__pyx_t_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_14 = __pyx_v_i;
-    if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_bshape_0_result;
-    __pyx_t_13 = __Pyx_BufPtrStrided1d(PyObject **, __pyx_bstruct_result.buf, __pyx_t_14, __pyx_bstride_0_result);
-    __Pyx_GOTREF(*__pyx_t_13);
-    __Pyx_DECREF(*__pyx_t_13); __Pyx_INCREF(__pyx_t_2);
-    *__pyx_t_13 = __pyx_t_2;
-    __Pyx_GIVEREF(*__pyx_t_13);
+    __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
+    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
+    __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
+    __pyx_t_6 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_L6_continue:;
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(((PyObject *)__pyx_v_input));
+    __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
+    __pyx_t_6 = 0;
+    goto __pyx_L6;
   }
+  __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":109
- *         result[i] = arr[idxMap[idx]]
- * 
- *     return result             # <<<<<<<<<<<<<<
+  /* "H:\workspace\pandas\pandas\lib\src\moments.pyx":521
+ *         input = input.astype(float)
  * 
- * cdef tuple _backfill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
+ *     return _ewma(input, com)             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_result));
-  __pyx_r = ((PyObject *)__pyx_v_result);
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s___ewma); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_INCREF(((PyObject *)__pyx_v_input));
+  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
+  __Pyx_INCREF(__pyx_v_com);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_com);
+  __Pyx_GIVEREF(__pyx_v_com);
+  __pyx_t_3 = PyObject_Call(__pyx_t_6, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
-    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
-    __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
-  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("tseries.reindexObject");
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_AddTraceback("tseries.ewma");
   __pyx_r = NULL;
-  goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_index);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_arr);
-  __Pyx_SafeReleaseBuffer(&__pyx_bstruct_result);
-  __pyx_L2:;
-  __Pyx_DECREF((PyObject *)__pyx_v_result);
-  __Pyx_DECREF(__pyx_v_idx);
-  __Pyx_XDECREF(__pyx_v_nan);
-  __Pyx_DECREF((PyObject *)__pyx_v_index);
-  __Pyx_DECREF((PyObject *)__pyx_v_arr);
-  __Pyx_DECREF(__pyx_v_idxMap);
+  __Pyx_DECREF(__pyx_v_N);
+  __Pyx_DECREF((PyObject *)__pyx_v_input);
+  __Pyx_DECREF(__pyx_v_com);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":111
- *     return result
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":2
  * 
  * cdef tuple _backfill(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):             # <<<<<<<<<<<<<<
  *     '''
@@ -14575,36 +11744,36 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_v_prevOld = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_curOld = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":140
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":31
  *     cdef ndarray fillVec
  *     cdef ndarray maskVec
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -14614,36 +11783,36 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":141
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":32
  *     cdef ndarray maskVec
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
  * 
  *     # Get references
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -14653,7 +11822,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":146
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":37
  *     cdef int *fillLocs
  *     cdef char *mask
  *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
@@ -14662,7 +11831,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":147
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":38
  *     cdef char *mask
  *     fillLocs = <int *> fillVec.data
  *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
@@ -14671,35 +11840,35 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":151
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":42
  *     # Create the iterators
  *     cdef flatiter iterold, iternew
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)             # <<<<<<<<<<<<<<
  *     iternew = <flatiter> PyArray_IterNew(newIndex)
  * 
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iterold));
   __pyx_v_iterold = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":152
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":43
  *     cdef flatiter iterold, iternew
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)
  *     iternew = <flatiter> PyArray_IterNew(newIndex)             # <<<<<<<<<<<<<<
  * 
  *     # Get the size
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iternew));
   __pyx_v_iternew = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":155
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":46
  * 
  *     # Get the size
  *     oldLength = PyArray_SIZE(oldIndex)             # <<<<<<<<<<<<<<
@@ -14708,7 +11877,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_oldLength = PyArray_SIZE(__pyx_v_oldIndex);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":156
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":47
  *     # Get the size
  *     oldLength = PyArray_SIZE(oldIndex)
  *     newLength = PyArray_SIZE(newIndex)             # <<<<<<<<<<<<<<
@@ -14717,7 +11886,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_newLength = PyArray_SIZE(__pyx_v_newIndex);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":160
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":51
  *     # Current positions
  *     cdef int newPos, oldPos
  *     oldPos = oldLength - 1             # <<<<<<<<<<<<<<
@@ -14726,7 +11895,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_oldPos = (__pyx_v_oldLength - 1);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":161
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":52
  *     cdef int newPos, oldPos
  *     oldPos = oldLength - 1
  *     newPos = newLength - 1             # <<<<<<<<<<<<<<
@@ -14735,7 +11904,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
   __pyx_v_newPos = (__pyx_v_newLength - 1);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":166
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":57
  *     cdef object prevOld, curOld
  * 
  *     while newPos >= 0:             # <<<<<<<<<<<<<<
@@ -14746,7 +11915,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_t_7 = (__pyx_v_newPos >= 0);
     if (!__pyx_t_7) break;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":168
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":59
  *     while newPos >= 0:
  *         # Move to the current position
  *         PyArray_ITER_GOTO1D(iternew, newPos)             # <<<<<<<<<<<<<<
@@ -14755,7 +11924,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
     PyArray_ITER_GOTO1D(__pyx_v_iternew, __pyx_v_newPos);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":169
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":60
  *         # Move to the current position
  *         PyArray_ITER_GOTO1D(iternew, newPos)
  *         PyArray_ITER_GOTO1D(iterold, oldPos)             # <<<<<<<<<<<<<<
@@ -14764,20 +11933,20 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
     PyArray_ITER_GOTO1D(__pyx_v_iterold, __pyx_v_oldPos);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":172
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":63
  * 
  *         # Get the current index
  *         curOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *         # Until we reach a point where we are before the curOld point
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_curOld);
     __pyx_v_curOld = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":175
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":66
  * 
  *         # Until we reach a point where we are before the curOld point
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > curOld:             # <<<<<<<<<<<<<<
@@ -14785,16 +11954,16 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  *             if newPos < 0:
  */
     while (1) {
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (!__pyx_t_7) break;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":176
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":67
  *         # Until we reach a point where we are before the curOld point
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > curOld:
  *             newPos -= 1             # <<<<<<<<<<<<<<
@@ -14803,7 +11972,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
       __pyx_v_newPos -= 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":177
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":68
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > curOld:
  *             newPos -= 1
  *             if newPos < 0:             # <<<<<<<<<<<<<<
@@ -14813,7 +11982,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
       __pyx_t_7 = (__pyx_v_newPos < 0);
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":178
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":69
  *             newPos -= 1
  *             if newPos < 0:
  *                 break             # <<<<<<<<<<<<<<
@@ -14825,7 +11994,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
       }
       __pyx_L7:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":179
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":70
  *             if newPos < 0:
  *                 break
  *             PyArray_ITER_GOTO1D(iternew, newPos)             # <<<<<<<<<<<<<<
@@ -14836,20 +12005,20 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     }
     __pyx_L6_break:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":182
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":73
  * 
  *         # Get the location in the old index
  *         curLoc = oldMap[curOld]             # <<<<<<<<<<<<<<
  * 
  *         # At the beginning of the old index
  */
-    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_curLoc = __pyx_t_8;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":185
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":76
  * 
  *         # At the beginning of the old index
  *         if oldPos == 0:             # <<<<<<<<<<<<<<
@@ -14859,47 +12028,47 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_t_7 = (__pyx_v_oldPos == 0);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":188
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":79
  * 
  *             # Make sure we are before the curOld index
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) <= curOld:             # <<<<<<<<<<<<<<
  *                 fillVec[:newPos + 1] = curLoc
  *                 maskVec[:newPos + 1] = 1
  */
-      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_LE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_LE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":189
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":80
  *             # Make sure we are before the curOld index
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) <= curOld:
  *                 fillVec[:newPos + 1] = curLoc             # <<<<<<<<<<<<<<
  *                 maskVec[:newPos + 1] = 1
  * 
  */
-        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), 0, (__pyx_v_newPos + 1), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), 0, (__pyx_v_newPos + 1), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":190
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":81
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) <= curOld:
  *                 fillVec[:newPos + 1] = curLoc
  *                 maskVec[:newPos + 1] = 1             # <<<<<<<<<<<<<<
  * 
  *             # Exit the main loop
  */
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), 0, (__pyx_v_newPos + 1), __pyx_int_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), 0, (__pyx_v_newPos + 1), __pyx_int_1) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         goto __pyx_L9;
       }
       __pyx_L9:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":193
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":84
  * 
  *             # Exit the main loop
  *             break             # <<<<<<<<<<<<<<
@@ -14911,7 +12080,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     }
     /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":197
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":88
  *         else:
  *             # Move one position back
  *             PyArray_ITER_GOTO1D(iterold, oldPos - 1)             # <<<<<<<<<<<<<<
@@ -14920,20 +12089,20 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
       PyArray_ITER_GOTO1D(__pyx_v_iterold, (__pyx_v_oldPos - 1));
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":200
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":91
  * 
  *             # Get the index there
  *             prevOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *             # Until we reach the previous index
  */
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_v_prevOld);
       __pyx_v_prevOld = __pyx_t_5;
       __pyx_t_5 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":203
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":94
  * 
  *             # Until we reach the previous index
  *             while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) > prevOld:             # <<<<<<<<<<<<<<
@@ -14941,16 +12110,16 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  *                 # Set the current fill location
  */
       while (1) {
-        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_prevOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_prevOld, Py_GT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         if (!__pyx_t_7) break;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":206
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":97
  * 
  *                 # Set the current fill location
  *                 fillLocs[newPos] = curLoc             # <<<<<<<<<<<<<<
@@ -14959,7 +12128,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
         (__pyx_v_fillLocs[__pyx_v_newPos]) = __pyx_v_curLoc;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":207
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":98
  *                 # Set the current fill location
  *                 fillLocs[newPos] = curLoc
  *                 mask[newPos] = 1             # <<<<<<<<<<<<<<
@@ -14968,7 +12137,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
         (__pyx_v_mask[__pyx_v_newPos]) = 1;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":209
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":100
  *                 mask[newPos] = 1
  * 
  *                 newPos -= 1             # <<<<<<<<<<<<<<
@@ -14977,7 +12146,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  */
         __pyx_v_newPos -= 1;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":210
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":101
  * 
  *                 newPos -= 1
  *                 if newPos < 0:             # <<<<<<<<<<<<<<
@@ -14987,7 +12156,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
         __pyx_t_7 = (__pyx_v_newPos < 0);
         if (__pyx_t_7) {
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":211
+          /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":102
  *                 newPos -= 1
  *                 if newPos < 0:
  *                     break             # <<<<<<<<<<<<<<
@@ -14999,7 +12168,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
         }
         __pyx_L12:;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":214
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":105
  * 
  *                 # Move the iterator back
  *                 PyArray_ITER_GOTO1D(iternew, newPos)             # <<<<<<<<<<<<<<
@@ -15012,7 +12181,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     }
     __pyx_L8:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":217
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":108
  * 
  *         # Move one period back
  *         oldPos -= 1             # <<<<<<<<<<<<<<
@@ -15023,7 +12192,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   }
   __pyx_L4_break:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":219
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":110
  *         oldPos -= 1
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -15033,7 +12202,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":220
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":111
  * 
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -15043,7 +12212,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_t_7 = ((__pyx_v_mask[__pyx_v_i]) == 0);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":222
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":113
  *         if mask[i] == 0:
  *             # Fill from some generic location
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
@@ -15056,7 +12225,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
     __pyx_L15:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":224
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":115
  *             fillLocs[i] = -1
  * 
  *     return (fillVec, maskVec)             # <<<<<<<<<<<<<<
@@ -15064,7 +12233,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
  * cdef tuple _pad(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):
  */
   __Pyx_XDECREF(((PyObject *)__pyx_r));
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
   PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillVec));
@@ -15072,7 +12241,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   __Pyx_INCREF(((PyObject *)__pyx_v_maskVec));
   PyTuple_SET_ITEM(__pyx_t_6, 1, ((PyObject *)__pyx_v_maskVec));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_maskVec));
-  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_r = ((PyObject *)__pyx_t_6);
   __pyx_t_6 = 0;
   goto __pyx_L0;
@@ -15103,7 +12272,7 @@ static  PyObject *__pyx_f_7tseries__backfill(PyArrayObject *__pyx_v_oldIndex, Py
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":226
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":117
  *     return (fillVec, maskVec)
  * 
  * cdef tuple _pad(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap):             # <<<<<<<<<<<<<<
@@ -15149,36 +12318,36 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_v_nextOld = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_curOld = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":260
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":151
  * 
  *     # Make empty fill vector and mask vector, cast to ndarray
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)             # <<<<<<<<<<<<<<
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)
  * 
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -15188,36 +12357,36 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_v_fillVec = ((PyArrayObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":261
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":152
  *     # Make empty fill vector and mask vector, cast to ndarray
  *     fillVec = <ndarray> np.empty(len(newIndex), dtype = np.int32)
  *     maskVec = <ndarray> np.zeros(len(newIndex), dtype = np.int8)             # <<<<<<<<<<<<<<
  * 
  *     # Get reference to the arrays inside
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Length(((PyObject *)__pyx_v_newIndex)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -15227,7 +12396,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_v_maskVec = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":264
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":155
  * 
  *     # Get reference to the arrays inside
  *     fillLocs = <int *> fillVec.data             # <<<<<<<<<<<<<<
@@ -15236,7 +12405,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_fillLocs = ((int *)__pyx_v_fillVec->data);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":265
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":156
  *     # Get reference to the arrays inside
  *     fillLocs = <int *> fillVec.data
  *     mask = <char *> maskVec.data             # <<<<<<<<<<<<<<
@@ -15245,35 +12414,35 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_mask = ((char *)__pyx_v_maskVec->data);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":268
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":159
  * 
  *     # Create simple ndarray iterators using C API
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)             # <<<<<<<<<<<<<<
  *     iternew = <flatiter> PyArray_IterNew(newIndex)
  * 
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_oldIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iterold));
   __pyx_v_iterold = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":269
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":160
  *     # Create simple ndarray iterators using C API
  *     iterold = <flatiter> PyArray_IterNew(oldIndex)
  *     iternew = <flatiter> PyArray_IterNew(newIndex)             # <<<<<<<<<<<<<<
  * 
  *     # Length of each index
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_newIndex)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iternew));
   __pyx_v_iternew = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":272
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":163
  * 
  *     # Length of each index
  *     oldLength = PyArray_SIZE(oldIndex)             # <<<<<<<<<<<<<<
@@ -15282,7 +12451,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_oldLength = PyArray_SIZE(__pyx_v_oldIndex);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":273
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":164
  *     # Length of each index
  *     oldLength = PyArray_SIZE(oldIndex)
  *     newLength = PyArray_SIZE(newIndex)             # <<<<<<<<<<<<<<
@@ -15291,7 +12460,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_newLength = PyArray_SIZE(__pyx_v_newIndex);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":275
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":166
  *     newLength = PyArray_SIZE(newIndex)
  * 
  *     oldPos = 0             # <<<<<<<<<<<<<<
@@ -15300,7 +12469,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_oldPos = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":276
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":167
  * 
  *     oldPos = 0
  *     newPos = 0             # <<<<<<<<<<<<<<
@@ -15309,7 +12478,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
   __pyx_v_newPos = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":277
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":168
  *     oldPos = 0
  *     newPos = 0
  *     while newPos < newLength:             # <<<<<<<<<<<<<<
@@ -15320,20 +12489,20 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_t_7 = (__pyx_v_newPos < __pyx_v_newLength);
     if (!__pyx_t_7) break;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":278
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":169
  *     newPos = 0
  *     while newPos < newLength:
  *         curOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *         # At beginning, keep going until we go exceed the
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_curOld);
     __pyx_v_curOld = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":282
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":173
  *         # At beginning, keep going until we go exceed the
  *         # first OLD index in the NEW index
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < curOld:             # <<<<<<<<<<<<<<
@@ -15341,16 +12510,16 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  *             if newPos > newLength - 1:
  */
     while (1) {
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_curOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (!__pyx_t_7) break;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":283
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":174
  *         # first OLD index in the NEW index
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < curOld:
  *             newPos += 1             # <<<<<<<<<<<<<<
@@ -15359,7 +12528,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
       __pyx_v_newPos += 1;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":284
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":175
  *         while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < curOld:
  *             newPos += 1
  *             if newPos > newLength - 1:             # <<<<<<<<<<<<<<
@@ -15369,7 +12538,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       __pyx_t_7 = (__pyx_v_newPos > (__pyx_v_newLength - 1));
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":285
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":176
  *             newPos += 1
  *             if newPos > newLength - 1:
  *                 break             # <<<<<<<<<<<<<<
@@ -15381,7 +12550,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       }
       __pyx_L7:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":286
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":177
  *             if newPos > newLength - 1:
  *                 break
  *             PyArray_ITER_NEXT(iternew)             # <<<<<<<<<<<<<<
@@ -15392,20 +12561,20 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     }
     __pyx_L6_break:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":289
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":180
  * 
  *         # We got there, get the current location in the old index
  *         curLoc = oldMap[curOld]             # <<<<<<<<<<<<<<
  * 
  *         # We're at the end of the road, need to propagate this value to the end
  */
-    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_curOld); if (!__pyx_t_6) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_curLoc = __pyx_t_8;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":292
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":183
  * 
  *         # We're at the end of the road, need to propagate this value to the end
  *         if oldPos == oldLength - 1:             # <<<<<<<<<<<<<<
@@ -15415,47 +12584,47 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_t_7 = (__pyx_v_oldPos == (__pyx_v_oldLength - 1));
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":293
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":184
  *         # We're at the end of the road, need to propagate this value to the end
  *         if oldPos == oldLength - 1:
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) >= curOld:             # <<<<<<<<<<<<<<
  *                 fillVec[newPos:] = curLoc
  *                 maskVec[newPos:] = 1
  */
-      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_GE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_v_curOld, Py_GE); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_7) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":294
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":185
  *         if oldPos == oldLength - 1:
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) >= curOld:
  *                 fillVec[newPos:] = curLoc             # <<<<<<<<<<<<<<
  *                 maskVec[newPos:] = 1
  *             break
  */
-        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyInt_FromLong(__pyx_v_curLoc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_fillVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":295
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":186
  *             if PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) >= curOld:
  *                 fillVec[newPos:] = curLoc
  *                 maskVec[newPos:] = 1             # <<<<<<<<<<<<<<
  *             break
  *         else:
  */
-        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_int_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        if (PySequence_SetSlice(((PyObject *)__pyx_v_maskVec), __pyx_v_newPos, PY_SSIZE_T_MAX, __pyx_int_1) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         goto __pyx_L9;
       }
       __pyx_L9:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":296
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":187
  *                 fillVec[newPos:] = curLoc
  *                 maskVec[newPos:] = 1
  *             break             # <<<<<<<<<<<<<<
@@ -15467,7 +12636,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     }
     /*else*/ {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":301
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":192
  * 
  *             # Get the next index so we know when to stop propagating this value
  *             PyArray_ITER_NEXT(iterold)             # <<<<<<<<<<<<<<
@@ -15476,20 +12645,20 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
       PyArray_ITER_NEXT(__pyx_v_iterold);
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":302
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":193
  *             # Get the next index so we know when to stop propagating this value
  *             PyArray_ITER_NEXT(iterold)
  *             nextOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))             # <<<<<<<<<<<<<<
  * 
  *             done = 0
  */
-      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyArray_GETITEM(__pyx_v_oldIndex, PyArray_ITER_DATA(__pyx_v_iterold)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_v_nextOld);
       __pyx_v_nextOld = __pyx_t_5;
       __pyx_t_5 = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":304
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":195
  *             nextOld = PyArray_GETITEM(oldIndex, PyArray_ITER_DATA(iterold))
  * 
  *             done = 0             # <<<<<<<<<<<<<<
@@ -15498,7 +12667,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
       __pyx_v_done = 0;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":307
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":198
  * 
  *             # Until we reach the next OLD value in the NEW index
  *             while PyArray_GETITEM(newIndex, PyArray_ITER_DATA(iternew)) < nextOld:             # <<<<<<<<<<<<<<
@@ -15506,16 +12675,16 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  *                 # Use this location to fill
  */
       while (1) {
-        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_5 = PyArray_GETITEM(__pyx_v_newIndex, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_nextOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_v_nextOld, Py_LT); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         if (!__pyx_t_7) break;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":310
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":201
  * 
  *                 # Use this location to fill
  *                 fillLocs[newPos] = curLoc             # <<<<<<<<<<<<<<
@@ -15524,7 +12693,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
         (__pyx_v_fillLocs[__pyx_v_newPos]) = __pyx_v_curLoc;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":313
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":204
  * 
  *                 # Set mask to be 1 so will not be NaN'd
  *                 mask[newPos] = 1             # <<<<<<<<<<<<<<
@@ -15533,7 +12702,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
         (__pyx_v_mask[__pyx_v_newPos]) = 1;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":314
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":205
  *                 # Set mask to be 1 so will not be NaN'd
  *                 mask[newPos] = 1
  *                 newPos += 1             # <<<<<<<<<<<<<<
@@ -15542,7 +12711,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
         __pyx_v_newPos += 1;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":317
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":208
  * 
  *                 # We got to the end of the new index
  *                 if newPos > newLength - 1:             # <<<<<<<<<<<<<<
@@ -15552,7 +12721,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
         __pyx_t_7 = (__pyx_v_newPos > (__pyx_v_newLength - 1));
         if (__pyx_t_7) {
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":318
+          /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":209
  *                 # We got to the end of the new index
  *                 if newPos > newLength - 1:
  *                     done = 1             # <<<<<<<<<<<<<<
@@ -15561,7 +12730,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  */
           __pyx_v_done = 1;
 
-          /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":319
+          /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":210
  *                 if newPos > newLength - 1:
  *                     done = 1
  *                     break             # <<<<<<<<<<<<<<
@@ -15573,7 +12742,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
         }
         __pyx_L12:;
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":322
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":213
  * 
  *                 # Advance the pointer
  *                 PyArray_ITER_NEXT(iternew)             # <<<<<<<<<<<<<<
@@ -15584,7 +12753,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       }
       __pyx_L11_break:;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":325
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":216
  * 
  *             # We got to the end of the new index
  *             if done:             # <<<<<<<<<<<<<<
@@ -15594,7 +12763,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
       __pyx_t_9 = __pyx_v_done;
       if (__pyx_t_9) {
 
-        /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":326
+        /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":217
  *             # We got to the end of the new index
  *             if done:
  *                 break             # <<<<<<<<<<<<<<
@@ -15608,7 +12777,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     }
     __pyx_L8:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":330
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":221
  *         # We already advanced the iterold pointer to the next value,
  *         # inc the count
  *         oldPos += 1             # <<<<<<<<<<<<<<
@@ -15619,7 +12788,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   }
   __pyx_L4_break:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":334
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":225
  *     # Places where the mask is 0, fill with an arbitrary value
  *     # (will be NA'd out)
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -15629,7 +12798,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":335
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":226
  *     # (will be NA'd out)
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -15639,7 +12808,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_t_7 = ((__pyx_v_mask[__pyx_v_i]) == 0);
     if (__pyx_t_7) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":336
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":227
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
@@ -15652,7 +12821,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
     __pyx_L16:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":338
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":229
  *             fillLocs[i] = -1
  * 
  *     return fillVec, maskVec             # <<<<<<<<<<<<<<
@@ -15660,7 +12829,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
  * def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,
  */
   __Pyx_XDECREF(((PyObject *)__pyx_r));
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(((PyObject *)__pyx_v_fillVec));
   PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillVec));
@@ -15668,7 +12837,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   __Pyx_INCREF(((PyObject *)__pyx_v_maskVec));
   PyTuple_SET_ITEM(__pyx_t_6, 1, ((PyObject *)__pyx_v_maskVec));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_maskVec));
-  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(PyTuple_CheckExact(__pyx_t_6))||((__pyx_t_6) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected tuple, got %.200s", Py_TYPE(__pyx_t_6)->tp_name), 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_r = ((PyObject *)__pyx_t_6);
   __pyx_t_6 = 0;
   goto __pyx_L0;
@@ -15699,7 +12868,7 @@ static  PyObject *__pyx_f_7tseries__pad(PyArrayObject *__pyx_v_oldIndex, PyArray
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":340
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":231
  *     return fillVec, maskVec
  * 
  * def getFillVec(ndarray oldIndex, ndarray newIndex, dict oldMap, dict newMap,             # <<<<<<<<<<<<<<
@@ -15717,8 +12886,8 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   PyObject *__pyx_v_fillVec;
   PyObject *__pyx_v_maskVec;
   PyObject *__pyx_r = NULL;
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_t_2;
+  int __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -15746,29 +12915,29 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__newIndex);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__oldMap);
       if (likely(values[2])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 2); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  3:
       values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__newMap);
       if (likely(values[3])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 3); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 3); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  4:
       values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__kind);
       if (likely(values[4])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 4); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, 4); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getFillVec") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getFillVec") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_oldIndex = ((PyArrayObject *)values[0]);
     __pyx_v_newIndex = ((PyArrayObject *)values[1]);
@@ -15786,7 +12955,7 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("getFillVec", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.getFillVec");
   return NULL;
@@ -15798,34 +12967,31 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   __Pyx_INCREF(__pyx_v_kind);
   __pyx_v_fillVec = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_maskVec = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldIndex), __pyx_ptype_5numpy_ndarray, 1, "oldIndex", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newIndex), __pyx_ptype_5numpy_ndarray, 1, "newIndex", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newMap), &PyDict_Type, 1, "newMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldIndex), __pyx_ptype_5numpy_ndarray, 1, "oldIndex", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newIndex), __pyx_ptype_5numpy_ndarray, 1, "newIndex", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_newMap), &PyDict_Type, 1, "newMap", 1))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":343
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":234
  *                object kind):
  * 
- *     if kind == '':             # <<<<<<<<<<<<<<
- *         fillVec, maskVec = _nofill(newIndex, oldMap)
+ *     if kind is None:             # <<<<<<<<<<<<<<
+ *         fillVec, maskVec = getMergeVec(newIndex, oldMap)
  *     elif kind == 'PAD':
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_kp_s_5), Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__pyx_t_2) {
+  __pyx_t_1 = (__pyx_v_kind == Py_None);
+  if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":344
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":235
  * 
- *     if kind == '':
- *         fillVec, maskVec = _nofill(newIndex, oldMap)             # <<<<<<<<<<<<<<
+ *     if kind is None:
+ *         fillVec, maskVec = getMergeVec(newIndex, oldMap)             # <<<<<<<<<<<<<<
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  */
-    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s___nofill); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__getMergeVec); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(((PyObject *)__pyx_v_newIndex));
     PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_newIndex));
@@ -15833,185 +12999,185 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
     __Pyx_INCREF(((PyObject *)__pyx_v_oldMap));
     PyTuple_SET_ITEM(__pyx_t_3, 1, ((PyObject *)__pyx_v_oldMap));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_oldMap));
-    __pyx_t_4 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (PyTuple_CheckExact(__pyx_t_4) && likely(PyTuple_GET_SIZE(__pyx_t_4) == 2)) {
       PyObject* tuple = __pyx_t_4;
       __pyx_t_3 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_3);
-      __pyx_t_1 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_1);
+      __pyx_t_2 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
       __pyx_v_fillVec = __pyx_t_3;
       __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_v_maskVec);
-      __pyx_v_maskVec = __pyx_t_1;
-      __pyx_t_1 = 0;
+      __pyx_v_maskVec = __pyx_t_2;
+      __pyx_t_2 = 0;
     } else {
-      __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_3 = __Pyx_UnpackItem(__pyx_t_5, 0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_3 = __Pyx_UnpackItem(__pyx_t_5, 0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_UnpackItem(__pyx_t_5, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      __Pyx_GOTREF(__pyx_t_1);
-      if (__Pyx_EndUnpack(__pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_2 = __Pyx_UnpackItem(__pyx_t_5, 1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_GOTREF(__pyx_t_2);
+      if (__Pyx_EndUnpack(__pyx_t_5) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
       __pyx_v_fillVec = __pyx_t_3;
       __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_v_maskVec);
-      __pyx_v_maskVec = __pyx_t_1;
-      __pyx_t_1 = 0;
+      __pyx_v_maskVec = __pyx_t_2;
+      __pyx_t_2 = 0;
     }
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":345
- *     if kind == '':
- *         fillVec, maskVec = _nofill(newIndex, oldMap)
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":236
+ *     if kind is None:
+ *         fillVec, maskVec = getMergeVec(newIndex, oldMap)
  *     elif kind == 'PAD':             # <<<<<<<<<<<<<<
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':
  */
-  __pyx_t_4 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__PAD), Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__PAD), Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__pyx_t_2) {
+  if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":346
- *         fillVec, maskVec = _nofill(newIndex, oldMap)
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":237
+ *         fillVec, maskVec = getMergeVec(newIndex, oldMap)
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
  *     elif kind == 'BACKFILL':
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  */
-    __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__pad(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__pad(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     if (likely(__pyx_t_4 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_4) == 2)) {
       PyObject* tuple = __pyx_t_4;
-      __pyx_t_1 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_1);
+      __pyx_t_2 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_2);
       __pyx_t_3 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
-      __pyx_v_fillVec = __pyx_t_1;
-      __pyx_t_1 = 0;
+      __pyx_v_fillVec = __pyx_t_2;
+      __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_v_maskVec);
       __pyx_v_maskVec = __pyx_t_3;
       __pyx_t_3 = 0;
     } else {
       __Pyx_UnpackTupleError(__pyx_t_4, 2);
-      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":347
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":238
  *     elif kind == 'PAD':
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':             # <<<<<<<<<<<<<<
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  *     else:
  */
-  __pyx_t_4 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__BACKFILL), Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_RichCompare(__pyx_v_kind, ((PyObject *)__pyx_n_s__BACKFILL), Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__pyx_t_2) {
+  if (__pyx_t_1) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":348
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":239
  *         fillVec, maskVec = _pad(oldIndex, newIndex, oldMap, newMap)
  *     elif kind == 'BACKFILL':
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)             # <<<<<<<<<<<<<<
  *     else:
  *         raise Exception("Don't recognize fillMethod: %s" % kind)
  */
-    __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__backfill(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = ((PyObject *)__pyx_f_7tseries__backfill(__pyx_v_oldIndex, __pyx_v_newIndex, __pyx_v_oldMap, __pyx_v_newMap)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     if (likely(__pyx_t_4 != Py_None) && likely(PyTuple_GET_SIZE(__pyx_t_4) == 2)) {
       PyObject* tuple = __pyx_t_4;
       __pyx_t_3 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_3);
-      __pyx_t_1 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_1);
+      __pyx_t_2 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_v_fillVec);
       __pyx_v_fillVec = __pyx_t_3;
       __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_v_maskVec);
-      __pyx_v_maskVec = __pyx_t_1;
-      __pyx_t_1 = 0;
+      __pyx_v_maskVec = __pyx_t_2;
+      __pyx_t_2 = 0;
     } else {
       __Pyx_UnpackTupleError(__pyx_t_4, 2);
-      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[5]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     goto __pyx_L6;
   }
   /*else*/ {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":350
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":241
  *         fillVec, maskVec = _backfill(oldIndex, newIndex, oldMap, newMap)
  *     else:
  *         raise Exception("Don't recognize fillMethod: %s" % kind)             # <<<<<<<<<<<<<<
  * 
  *     return fillVec, maskVec.astype(np.bool)
  */
-    __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_6), __pyx_v_kind); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_4), __pyx_v_kind); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_4 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[5]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_L6:;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":352
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":243
  *         raise Exception("Don't recognize fillMethod: %s" % kind)
  * 
  *     return fillVec, maskVec.astype(np.bool)             # <<<<<<<<<<<<<<
  * 
- * def getMergeVec(ndarray values, dict oldMap):
+ * @cython.boundscheck(False)
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_v_maskVec, __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(__pyx_v_maskVec, __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__bool); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__bool); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_fillVec);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_fillVec);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_fillVec);
   __Pyx_GIVEREF(__pyx_v_fillVec);
-  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
@@ -16030,9 +13196,9 @@ static PyObject *__pyx_pf_7tseries_getFillVec(PyObject *__pyx_self, PyObject *__
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":354
- *     return fillVec, maskVec.astype(np.bool)
+/* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":246
  * 
+ * @cython.boundscheck(False)
  * def getMergeVec(ndarray values, dict oldMap):             # <<<<<<<<<<<<<<
  *     cdef int i, j, length, newLength
  * 
@@ -16073,7 +13239,6 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   int __pyx_t_16;
   int __pyx_t_17;
   int __pyx_t_18;
-  int __pyx_t_19;
   static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__values,&__pyx_n_s__oldMap,0};
   __Pyx_RefNannySetupContext("getMergeVec");
   __pyx_self = __pyx_self;
@@ -16095,11 +13260,11 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__oldMap);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, 1); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getMergeVec") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "getMergeVec") < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_values = ((PyArrayObject *)values[0]);
     __pyx_v_oldMap = ((PyObject *)values[1]);
@@ -16111,7 +13276,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("getMergeVec", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.getMergeVec");
   return NULL;
@@ -16124,53 +13289,53 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_v_mask = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_bstruct_fillLocs.buf = NULL;
   __pyx_bstruct_mask.buf = NULL;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_values), __pyx_ptype_5numpy_ndarray, 1, "values", 0))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_oldMap), &PyDict_Type, 1, "oldMap", 1))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":362
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":254
  *     cdef ndarray[int8_t, ndim=1] mask
  * 
  *     newLength = len(values)             # <<<<<<<<<<<<<<
  *     fillLocs = np.empty(newLength, dtype=np.int32)
  *     mask = np.zeros(newLength, dtype=np.int8)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_values)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_values)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_newLength = __pyx_t_1;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":363
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":255
  * 
  *     newLength = len(values)
  *     fillLocs = np.empty(newLength, dtype=np.int32)             # <<<<<<<<<<<<<<
  *     mask = np.zeros(newLength, dtype=np.int8)
  * 
  */
-  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__empty); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_2));
-  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_5, __pyx_n_s__int32); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
@@ -16187,47 +13352,47 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     }
     __pyx_bstride_0_fillLocs = __pyx_bstruct_fillLocs.strides[0];
     __pyx_bshape_0_fillLocs = __pyx_bstruct_fillLocs.shape[0];
-    if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_t_7 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_v_fillLocs));
   __pyx_v_fillLocs = ((PyArrayObject *)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":364
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":256
  *     newLength = len(values)
  *     fillLocs = np.empty(newLength, dtype=np.int32)
  *     mask = np.zeros(newLength, dtype=np.int8)             # <<<<<<<<<<<<<<
  * 
  *     iternew = <flatiter> PyArray_IterNew(values)
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__zeros); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromLong(__pyx_v_newLength); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
-  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__int8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_t_12 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
@@ -16244,28 +13409,28 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     }
     __pyx_bstride_0_mask = __pyx_bstruct_mask.strides[0];
     __pyx_bshape_0_mask = __pyx_bstruct_mask.shape[0];
-    if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (unlikely(__pyx_t_8 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   }
   __pyx_t_12 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_v_mask));
   __pyx_v_mask = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":366
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":258
  *     mask = np.zeros(newLength, dtype=np.int8)
  * 
  *     iternew = <flatiter> PyArray_IterNew(values)             # <<<<<<<<<<<<<<
  * 
  *     for i from 0 <= i < newLength:
  */
-  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_values)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyArray_IterNew(((PyObject *)__pyx_v_values)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_5)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iternew));
   __pyx_v_iternew = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":368
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":260
  *     iternew = <flatiter> PyArray_IterNew(values)
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -16275,20 +13440,20 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":369
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":261
  * 
  *     for i from 0 <= i < newLength:
  *         idx = PyArray_GETITEM(values, PyArray_ITER_DATA(iternew))             # <<<<<<<<<<<<<<
  * 
  *         if idx in oldMap:
  */
-    __pyx_t_5 = PyArray_GETITEM(__pyx_v_values, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_5 = PyArray_GETITEM(__pyx_v_values, PyArray_ITER_DATA(__pyx_v_iternew)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_v_idx);
     __pyx_v_idx = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":371
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":263
  *         idx = PyArray_GETITEM(values, PyArray_ITER_DATA(iternew))
  * 
  *         if idx in oldMap:             # <<<<<<<<<<<<<<
@@ -16296,36 +13461,28 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
  *             mask[i] = 1
  */
     if (unlikely(((PyObject *)__pyx_v_oldMap) == Py_None)) {
-      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[5]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     } else {
-      __pyx_t_13 = ((PyDict_Contains(((PyObject *)__pyx_v_oldMap), __pyx_v_idx))); if (unlikely(__pyx_t_13 < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_13 = ((PyDict_Contains(((PyObject *)__pyx_v_oldMap), __pyx_v_idx))); if (unlikely(__pyx_t_13 < 0)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     if (__pyx_t_13) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":372
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":264
  * 
  *         if idx in oldMap:
  *             fillLocs[i] = oldMap[idx]             # <<<<<<<<<<<<<<
  *             mask[i] = 1
  * 
  */
-      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_oldMap), __pyx_v_idx); if (!__pyx_t_5) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyInt_from_py_npy_int32(__pyx_t_5); if (unlikely((__pyx_t_14 == (npy_int32)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_14 = __Pyx_PyInt_from_py_npy_int32(__pyx_t_5); if (unlikely((__pyx_t_14 == (npy_int32)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_15 = __pyx_v_i;
-      __pyx_t_16 = -1;
-      if (__pyx_t_15 < 0) {
-        __pyx_t_15 += __pyx_bshape_0_fillLocs;
-        if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
-      } else if (unlikely(__pyx_t_15 >= __pyx_bshape_0_fillLocs)) __pyx_t_16 = 0;
-      if (unlikely(__pyx_t_16 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        {__pyx_filename = __pyx_f[3]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
+      if (__pyx_t_15 < 0) __pyx_t_15 += __pyx_bshape_0_fillLocs;
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_bstruct_fillLocs.buf, __pyx_t_15, __pyx_bstride_0_fillLocs) = __pyx_t_14;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":373
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":265
  *         if idx in oldMap:
  *             fillLocs[i] = oldMap[idx]
  *             mask[i] = 1             # <<<<<<<<<<<<<<
@@ -16333,21 +13490,13 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
  *         PyArray_ITER_NEXT(iternew)
  */
       __pyx_t_16 = __pyx_v_i;
-      __pyx_t_17 = -1;
-      if (__pyx_t_16 < 0) {
-        __pyx_t_16 += __pyx_bshape_0_mask;
-        if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
-      } else if (unlikely(__pyx_t_16 >= __pyx_bshape_0_mask)) __pyx_t_17 = 0;
-      if (unlikely(__pyx_t_17 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_17);
-        {__pyx_filename = __pyx_f[3]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
+      if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_bshape_0_mask;
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_16, __pyx_bstride_0_mask) = 1;
       goto __pyx_L8;
     }
     __pyx_L8:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":375
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":267
  *             mask[i] = 1
  * 
  *         PyArray_ITER_NEXT(iternew)             # <<<<<<<<<<<<<<
@@ -16357,7 +13506,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
     PyArray_ITER_NEXT(__pyx_v_iternew);
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":377
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":269
  *         PyArray_ITER_NEXT(iternew)
  * 
  *     for i from 0 <= i < newLength:             # <<<<<<<<<<<<<<
@@ -16367,7 +13516,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   __pyx_t_8 = __pyx_v_newLength;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_8; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":378
+    /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":270
  * 
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:             # <<<<<<<<<<<<<<
@@ -16375,19 +13524,11 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
  * 
  */
     __pyx_t_17 = __pyx_v_i;
-    __pyx_t_18 = -1;
-    if (__pyx_t_17 < 0) {
-      __pyx_t_17 += __pyx_bshape_0_mask;
-      if (unlikely(__pyx_t_17 < 0)) __pyx_t_18 = 0;
-    } else if (unlikely(__pyx_t_17 >= __pyx_bshape_0_mask)) __pyx_t_18 = 0;
-    if (unlikely(__pyx_t_18 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_18);
-      {__pyx_filename = __pyx_f[3]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    }
+    if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_bshape_0_mask;
     __pyx_t_13 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_bstruct_mask.buf, __pyx_t_17, __pyx_bstride_0_mask)) == 0);
     if (__pyx_t_13) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":379
+      /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":271
  *     for i from 0 <= i < newLength:
  *         if mask[i] == 0:
  *             fillLocs[i] = -1             # <<<<<<<<<<<<<<
@@ -16395,41 +13536,32 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
  *     return fillLocs, mask.astype(bool)
  */
       __pyx_t_18 = __pyx_v_i;
-      __pyx_t_19 = -1;
-      if (__pyx_t_18 < 0) {
-        __pyx_t_18 += __pyx_bshape_0_fillLocs;
-        if (unlikely(__pyx_t_18 < 0)) __pyx_t_19 = 0;
-      } else if (unlikely(__pyx_t_18 >= __pyx_bshape_0_fillLocs)) __pyx_t_19 = 0;
-      if (unlikely(__pyx_t_19 != -1)) {
-        __Pyx_RaiseBufferIndexError(__pyx_t_19);
-        {__pyx_filename = __pyx_f[3]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-      }
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_bshape_0_fillLocs;
       *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_bstruct_fillLocs.buf, __pyx_t_18, __pyx_bstride_0_fillLocs) = -1;
       goto __pyx_L11;
     }
     __pyx_L11:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":381
+  /* "H:\workspace\pandas\pandas\lib\src\reindex.pyx":273
  *             fillLocs[i] = -1
  * 
  *     return fillLocs, mask.astype(bool)             # <<<<<<<<<<<<<<
  * 
- * # def _nofill(ndarray newIndex, dict oldMap):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_mask), __pyx_n_s__astype); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(((PyObject *)((PyObject*)&PyBool_Type)));
   PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)((PyObject*)&PyBool_Type)));
   __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyBool_Type)));
-  __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[5]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(((PyObject *)__pyx_v_fillLocs));
   PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_fillLocs));
@@ -16472,7 +13604,7 @@ static PyObject *__pyx_pf_7tseries_getMergeVec(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":1
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":1
  * cdef double __add(double a, double b):             # <<<<<<<<<<<<<<
  *     return a + b
  * cdef double __sub(double a, double b):
@@ -16482,7 +13614,7 @@ static  double __pyx_f_7tseries___add(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__add");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":2
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":2
  * cdef double __add(double a, double b):
  *     return a + b             # <<<<<<<<<<<<<<
  * cdef double __sub(double a, double b):
@@ -16497,7 +13629,7 @@ static  double __pyx_f_7tseries___add(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":3
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":3
  * cdef double __add(double a, double b):
  *     return a + b
  * cdef double __sub(double a, double b):             # <<<<<<<<<<<<<<
@@ -16509,7 +13641,7 @@ static  double __pyx_f_7tseries___sub(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__sub");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":4
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":4
  *     return a + b
  * cdef double __sub(double a, double b):
  *     return a - b             # <<<<<<<<<<<<<<
@@ -16525,7 +13657,7 @@ static  double __pyx_f_7tseries___sub(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":5
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":5
  * cdef double __sub(double a, double b):
  *     return a - b
  * cdef double __div(double a, double b):             # <<<<<<<<<<<<<<
@@ -16537,7 +13669,7 @@ static  double __pyx_f_7tseries___div(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__div");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":6
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":6
  *     return a - b
  * cdef double __div(double a, double b):
  *     return a / b             # <<<<<<<<<<<<<<
@@ -16561,7 +13693,7 @@ static  double __pyx_f_7tseries___div(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":7
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":7
  * cdef double __div(double a, double b):
  *     return a / b
  * cdef double __mul(double a, double b):             # <<<<<<<<<<<<<<
@@ -16573,7 +13705,7 @@ static  double __pyx_f_7tseries___mul(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__mul");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":8
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":8
  *     return a / b
  * cdef double __mul(double a, double b):
  *     return a * b             # <<<<<<<<<<<<<<
@@ -16589,7 +13721,7 @@ static  double __pyx_f_7tseries___mul(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":9
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":9
  * cdef double __mul(double a, double b):
  *     return a * b
  * cdef double __eq(double a, double b):             # <<<<<<<<<<<<<<
@@ -16601,7 +13733,7 @@ static  double __pyx_f_7tseries___eq(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__eq");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":10
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":10
  *     return a * b
  * cdef double __eq(double a, double b):
  *     return a == b             # <<<<<<<<<<<<<<
@@ -16617,7 +13749,7 @@ static  double __pyx_f_7tseries___eq(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":11
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":11
  * cdef double __eq(double a, double b):
  *     return a == b
  * cdef double __ne(double a, double b):             # <<<<<<<<<<<<<<
@@ -16629,7 +13761,7 @@ static  double __pyx_f_7tseries___ne(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__ne");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":12
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":12
  *     return a == b
  * cdef double __ne(double a, double b):
  *     return a != b             # <<<<<<<<<<<<<<
@@ -16645,7 +13777,7 @@ static  double __pyx_f_7tseries___ne(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":13
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":13
  * cdef double __ne(double a, double b):
  *     return a != b
  * cdef double __lt(double a, double b):             # <<<<<<<<<<<<<<
@@ -16657,7 +13789,7 @@ static  double __pyx_f_7tseries___lt(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__lt");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":14
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":14
  *     return a != b
  * cdef double __lt(double a, double b):
  *     return a < b             # <<<<<<<<<<<<<<
@@ -16673,7 +13805,7 @@ static  double __pyx_f_7tseries___lt(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":15
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":15
  * cdef double __lt(double a, double b):
  *     return a < b
  * cdef double __gt(double a, double b):             # <<<<<<<<<<<<<<
@@ -16685,7 +13817,7 @@ static  double __pyx_f_7tseries___gt(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__gt");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":16
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":16
  *     return a < b
  * cdef double __gt(double a, double b):
  *     return a > b             # <<<<<<<<<<<<<<
@@ -16701,7 +13833,7 @@ static  double __pyx_f_7tseries___gt(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":17
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":17
  * cdef double __gt(double a, double b):
  *     return a > b
  * cdef double __pow(double a, double b):             # <<<<<<<<<<<<<<
@@ -16713,7 +13845,7 @@ static  double __pyx_f_7tseries___pow(double __pyx_v_a, double __pyx_v_b) {
   double __pyx_r;
   __Pyx_RefNannySetupContext("__pow");
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":18
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":18
  *     return a > b
  * cdef double __pow(double a, double b):
  *     return a ** b             # <<<<<<<<<<<<<<
@@ -16729,7 +13861,7 @@ static  double __pyx_f_7tseries___pow(double __pyx_v_a, double __pyx_v_b) {
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":22
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":22
  * ctypedef double (* double_func)(double a, double b)
  * 
  * cdef ndarray _applyFunc(double_func func, ndarray index, object ao,             # <<<<<<<<<<<<<<
@@ -16773,7 +13905,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_v_iteridx = ((PyArrayIterObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":36
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":36
  *     # This is EXTREMELY important, otherwise you will get very
  *     # undesired results
  *     A = PyArray_ContiguousFromAny(ao, NPY_DOUBLE, 1, 1)             # <<<<<<<<<<<<<<
@@ -16787,7 +13919,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_v_A = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":37
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":37
  *     # undesired results
  *     A = PyArray_ContiguousFromAny(ao, NPY_DOUBLE, 1, 1)
  *     B = PyArray_ContiguousFromAny(bo, NPY_DOUBLE, 1, 1)             # <<<<<<<<<<<<<<
@@ -16801,7 +13933,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_v_B = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":39
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":39
  *     B = PyArray_ContiguousFromAny(bo, NPY_DOUBLE, 1, 1)
  * 
  *     nan = <double> np.NaN             # <<<<<<<<<<<<<<
@@ -16817,7 +13949,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_nan = ((double)__pyx_t_3);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":40
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":40
  * 
  *     nan = <double> np.NaN
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -16826,7 +13958,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_index);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":42
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":42
  *     length = PyArray_SIZE(index)
  * 
  *     result = <ndarray> np.empty(length, np.float64)             # <<<<<<<<<<<<<<
@@ -16862,7 +13994,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_v_result = ((PyArrayObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":43
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":43
  * 
  *     result = <ndarray> np.empty(length, np.float64)
  *     result_data = <double *>result.data             # <<<<<<<<<<<<<<
@@ -16871,7 +14003,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
   __pyx_v_result_data = ((double *)__pyx_v_result->data);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":45
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":45
  *     result_data = <double *>result.data
  * 
  *     itera = <flatiter> PyArray_IterNew(A)             # <<<<<<<<<<<<<<
@@ -16885,7 +14017,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_v_itera = ((PyArrayIterObject *)__pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":46
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":46
  * 
  *     itera = <flatiter> PyArray_IterNew(A)
  *     iteridx = PyArray_IterNew(index)             # <<<<<<<<<<<<<<
@@ -16899,7 +14031,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_v_iteridx = ((PyArrayIterObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":48
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":48
  *     iteridx = PyArray_IterNew(index)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -16909,7 +14041,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   __pyx_t_6 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":49
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":49
  * 
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))             # <<<<<<<<<<<<<<
@@ -16922,7 +14054,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     __pyx_v_idx = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":50
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":50
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iteridx))
  *         PyArray_ITER_NEXT(iteridx)             # <<<<<<<<<<<<<<
@@ -16931,7 +14063,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
     PyArray_ITER_NEXT(__pyx_v_iteridx);
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":52
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":52
  *         PyArray_ITER_NEXT(iteridx)
  * 
  *         if idx not in aMap or idx not in bMap:             # <<<<<<<<<<<<<<
@@ -16955,7 +14087,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     }
     if (__pyx_t_9) {
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":53
+      /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":53
  * 
  *         if idx not in aMap or idx not in bMap:
  *             result_data[i] = nan             # <<<<<<<<<<<<<<
@@ -16964,7 +14096,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
  */
       (__pyx_v_result_data[__pyx_v_i]) = __pyx_v_nan;
 
-      /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":54
+      /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":54
  *         if idx not in aMap or idx not in bMap:
  *             result_data[i] = nan
  *             continue             # <<<<<<<<<<<<<<
@@ -16976,7 +14108,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     }
     __pyx_L5:;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":56
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":56
  *             continue
  * 
  *         result_data[i] = func((<double *>A.data)[aMap[idx]],             # <<<<<<<<<<<<<<
@@ -16988,7 +14120,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     __pyx_t_10 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":57
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":57
  * 
  *         result_data[i] = func((<double *>A.data)[aMap[idx]],
  *                             (<double *>B.data)[bMap[idx]])             # <<<<<<<<<<<<<<
@@ -17000,7 +14132,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":56
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":56
  *             continue
  * 
  *         result_data[i] = func((<double *>A.data)[aMap[idx]],             # <<<<<<<<<<<<<<
@@ -17011,7 +14143,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
     __pyx_L3_continue:;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":59
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":59
  *                             (<double *>B.data)[bMap[idx]])
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -17049,7 +14181,7 @@ static  PyArrayObject *__pyx_f_7tseries__applyFunc(__pyx_t_7tseries_double_func
   return __pyx_r;
 }
 
-/* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":61
+/* "H:\workspace\pandas\pandas\lib\src\operators.pyx":61
  *     return result
  * 
  * def combineFunc(object name, ndarray index, object ao,             # <<<<<<<<<<<<<<
@@ -17158,7 +14290,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_aMap), &PyDict_Type, 1, "aMap", 1))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_bMap), &PyDict_Type, 1, "bMap", 1))) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":67
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":67
  *     indicated function.
  *     '''
  *     if name == "__add__":             # <<<<<<<<<<<<<<
@@ -17171,7 +14303,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":68
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":68
  *     '''
  *     if name == "__add__":
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17187,7 +14319,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":69
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":69
  *     if name == "__add__":
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)
  *     elif name == "__sub__":             # <<<<<<<<<<<<<<
@@ -17200,7 +14332,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":70
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":70
  *         return _applyFunc(__add, index, ao, bo, aMap, bMap)
  *     elif name == "__sub__":
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17216,7 +14348,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":71
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":71
  *     elif name == "__sub__":
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)
  *     elif name == "__div__":             # <<<<<<<<<<<<<<
@@ -17229,7 +14361,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":72
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":72
  *         return _applyFunc(__sub, index, ao, bo, aMap, bMap)
  *     elif name == "__div__":
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17245,7 +14377,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":73
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":73
  *     elif name == "__div__":
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)
  *     elif name == "__mul__":             # <<<<<<<<<<<<<<
@@ -17258,7 +14390,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":74
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":74
  *         return _applyFunc(__div, index, ao, bo, aMap, bMap)
  *     elif name == "__mul__":
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17274,7 +14406,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":75
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":75
  *     elif name == "__mul__":
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)
  *     elif name == "__eq__":             # <<<<<<<<<<<<<<
@@ -17287,7 +14419,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":76
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":76
  *         return _applyFunc(__mul, index, ao, bo, aMap, bMap)
  *     elif name == "__eq__":
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17303,7 +14435,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":77
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":77
  *     elif name == "__eq__":
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)
  *     elif name == "__ne__":             # <<<<<<<<<<<<<<
@@ -17316,7 +14448,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":78
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":78
  *         return _applyFunc(__eq, index, ao, bo, aMap, bMap)
  *     elif name == "__ne__":
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17332,7 +14464,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":79
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":79
  *     elif name == "__ne__":
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)
  *     elif name == "__lt__":             # <<<<<<<<<<<<<<
@@ -17345,7 +14477,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":80
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":80
  *         return _applyFunc(__ne, index, ao, bo, aMap, bMap)
  *     elif name == "__lt__":
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17361,7 +14493,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":81
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":81
  *     elif name == "__lt__":
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)
  *     elif name == "__gt__":             # <<<<<<<<<<<<<<
@@ -17374,7 +14506,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":82
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":82
  *         return _applyFunc(__lt, index, ao, bo, aMap, bMap)
  *     elif name == "__gt__":
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17390,7 +14522,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
     goto __pyx_L6;
   }
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":83
+  /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":83
  *     elif name == "__gt__":
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)
  *     elif name == "__pow__":             # <<<<<<<<<<<<<<
@@ -17403,7 +14535,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":84
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":84
  *         return _applyFunc(__gt, index, ao, bo, aMap, bMap)
  *     elif name == "__pow__":
  *         return _applyFunc(__pow, index, ao, bo, aMap, bMap)             # <<<<<<<<<<<<<<
@@ -17420,16 +14552,16 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   }
   /*else*/ {
 
-    /* "/Users/wesm/code/pandas/pandas/lib/src/operators.pyx":86
+    /* "H:\workspace\pandas\pandas\lib\src\operators.pyx":86
  *         return _applyFunc(__pow, index, ao, bo, aMap, bMap)
  *     else:
  *         raise Exception('bad funcname requested of Cython code')             # <<<<<<<<<<<<<<
  */
     __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_s_7));
-    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_7));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_7));
+    __Pyx_INCREF(((PyObject *)__pyx_kp_s_5));
+    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_5));
+    __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_5));
     __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[6]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -17458,7 +14590,7 @@ static PyObject *__pyx_pf_7tseries_combineFunc(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":187
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":187
  *         # experimental exception made for __getbuffer__ and __releasebuffer__
  *         # -- the details of this may change.
  *         def __getbuffer__(ndarray self, Py_buffer* info, int flags):             # <<<<<<<<<<<<<<
@@ -17494,7 +14626,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __Pyx_GIVEREF(__pyx_v_info->obj);
   __Pyx_INCREF((PyObject *)__pyx_v_self);
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":193
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":193
  *             # of flags
  *             cdef int copy_shape, i, ndim
  *             cdef int endian_detector = 1             # <<<<<<<<<<<<<<
@@ -17503,7 +14635,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_endian_detector = 1;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":194
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":194
  *             cdef int copy_shape, i, ndim
  *             cdef int endian_detector = 1
  *             cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)             # <<<<<<<<<<<<<<
@@ -17512,7 +14644,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_little_endian = ((((char *)(&__pyx_v_endian_detector))[0]) != 0);
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":196
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":196
  *             cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)
  * 
  *             ndim = PyArray_NDIM(self)             # <<<<<<<<<<<<<<
@@ -17521,7 +14653,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_ndim = PyArray_NDIM(((PyArrayObject *)__pyx_v_self));
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":198
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":198
  *             ndim = PyArray_NDIM(self)
  * 
  *             if sizeof(npy_intp) != sizeof(Py_ssize_t):             # <<<<<<<<<<<<<<
@@ -17531,7 +14663,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __pyx_t_1 = ((sizeof(npy_intp)) != (sizeof(Py_ssize_t)));
   if (__pyx_t_1) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":199
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":199
  * 
  *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
  *                 copy_shape = 1             # <<<<<<<<<<<<<<
@@ -17543,7 +14675,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   /*else*/ {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":201
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":201
  *                 copy_shape = 1
  *             else:
  *                 copy_shape = 0             # <<<<<<<<<<<<<<
@@ -17554,7 +14686,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   __pyx_L5:;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":203
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":203
  *                 copy_shape = 0
  * 
  *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)             # <<<<<<<<<<<<<<
@@ -17564,7 +14696,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_C_CONTIGUOUS) == PyBUF_C_CONTIGUOUS);
   if (__pyx_t_1) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":204
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":204
  * 
  *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)
  *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):             # <<<<<<<<<<<<<<
@@ -17578,7 +14710,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   if (__pyx_t_3) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":205
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":205
  *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)
  *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):
  *                 raise ValueError(u"ndarray is not C contiguous")             # <<<<<<<<<<<<<<
@@ -17587,9 +14719,9 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_u_8));
-    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_8));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_8));
+    __Pyx_INCREF(((PyObject *)__pyx_kp_u_6));
+    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_6));
+    __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_6));
     __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -17600,7 +14732,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   __pyx_L6:;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":207
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":207
  *                 raise ValueError(u"ndarray is not C contiguous")
  * 
  *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)             # <<<<<<<<<<<<<<
@@ -17610,7 +14742,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __pyx_t_3 = ((__pyx_v_flags & PyBUF_F_CONTIGUOUS) == PyBUF_F_CONTIGUOUS);
   if (__pyx_t_3) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":208
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":208
  * 
  *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
  *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):             # <<<<<<<<<<<<<<
@@ -17624,7 +14756,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   if (__pyx_t_2) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":209
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":209
  *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
  *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):
  *                 raise ValueError(u"ndarray is not Fortran contiguous")             # <<<<<<<<<<<<<<
@@ -17633,9 +14765,9 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_INCREF(((PyObject *)__pyx_kp_u_9));
-    PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_9));
-    __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_9));
+    __Pyx_INCREF(((PyObject *)__pyx_kp_u_7));
+    PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_7));
+    __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_7));
     __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
@@ -17646,7 +14778,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   __pyx_L7:;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":211
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":211
  *                 raise ValueError(u"ndarray is not Fortran contiguous")
  * 
  *             info.buf = PyArray_DATA(self)             # <<<<<<<<<<<<<<
@@ -17655,7 +14787,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->buf = PyArray_DATA(((PyArrayObject *)__pyx_v_self));
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":212
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":212
  * 
  *             info.buf = PyArray_DATA(self)
  *             info.ndim = ndim             # <<<<<<<<<<<<<<
@@ -17664,7 +14796,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->ndim = __pyx_v_ndim;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":213
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":213
  *             info.buf = PyArray_DATA(self)
  *             info.ndim = ndim
  *             if copy_shape:             # <<<<<<<<<<<<<<
@@ -17674,7 +14806,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __pyx_t_6 = __pyx_v_copy_shape;
   if (__pyx_t_6) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":216
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":216
  *                 # Allocate new buffer for strides and shape info. This is allocated
  *                 # as one block, strides first.
  *                 info.strides = <Py_ssize_t*>stdlib.malloc(sizeof(Py_ssize_t) * ndim * 2)             # <<<<<<<<<<<<<<
@@ -17683,7 +14815,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->strides = ((Py_ssize_t *)malloc((((sizeof(Py_ssize_t)) * __pyx_v_ndim) * 2)));
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":217
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":217
  *                 # as one block, strides first.
  *                 info.strides = <Py_ssize_t*>stdlib.malloc(sizeof(Py_ssize_t) * ndim * 2)
  *                 info.shape = info.strides + ndim             # <<<<<<<<<<<<<<
@@ -17692,7 +14824,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->shape = (__pyx_v_info->strides + __pyx_v_ndim);
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":218
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":218
  *                 info.strides = <Py_ssize_t*>stdlib.malloc(sizeof(Py_ssize_t) * ndim * 2)
  *                 info.shape = info.strides + ndim
  *                 for i in range(ndim):             # <<<<<<<<<<<<<<
@@ -17703,7 +14835,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
       __pyx_v_i = __pyx_t_7;
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":219
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":219
  *                 info.shape = info.strides + ndim
  *                 for i in range(ndim):
  *                     info.strides[i] = PyArray_STRIDES(self)[i]             # <<<<<<<<<<<<<<
@@ -17712,7 +14844,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
       (__pyx_v_info->strides[__pyx_v_i]) = (PyArray_STRIDES(((PyArrayObject *)__pyx_v_self))[__pyx_v_i]);
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":220
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":220
  *                 for i in range(ndim):
  *                     info.strides[i] = PyArray_STRIDES(self)[i]
  *                     info.shape[i] = PyArray_DIMS(self)[i]             # <<<<<<<<<<<<<<
@@ -17725,7 +14857,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   /*else*/ {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":222
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":222
  *                     info.shape[i] = PyArray_DIMS(self)[i]
  *             else:
  *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
@@ -17734,7 +14866,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->strides = ((Py_ssize_t *)PyArray_STRIDES(((PyArrayObject *)__pyx_v_self)));
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":223
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":223
  *             else:
  *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)
  *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)             # <<<<<<<<<<<<<<
@@ -17745,7 +14877,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   __pyx_L8:;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":224
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":224
  *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)
  *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)
  *             info.suboffsets = NULL             # <<<<<<<<<<<<<<
@@ -17754,7 +14886,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->suboffsets = NULL;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":225
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":225
  *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)
  *             info.suboffsets = NULL
  *             info.itemsize = PyArray_ITEMSIZE(self)             # <<<<<<<<<<<<<<
@@ -17763,7 +14895,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->itemsize = PyArray_ITEMSIZE(((PyArrayObject *)__pyx_v_self));
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":226
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":226
  *             info.suboffsets = NULL
  *             info.itemsize = PyArray_ITEMSIZE(self)
  *             info.readonly = not PyArray_ISWRITEABLE(self)             # <<<<<<<<<<<<<<
@@ -17772,7 +14904,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_info->readonly = (!PyArray_ISWRITEABLE(((PyArrayObject *)__pyx_v_self)));
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":229
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":229
  * 
  *             cdef int t
  *             cdef char* f = NULL             # <<<<<<<<<<<<<<
@@ -17781,7 +14913,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_f = NULL;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":230
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":230
  *             cdef int t
  *             cdef char* f = NULL
  *             cdef dtype descr = self.descr             # <<<<<<<<<<<<<<
@@ -17791,7 +14923,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __Pyx_INCREF(((PyObject *)((PyArrayObject *)__pyx_v_self)->descr));
   __pyx_v_descr = ((PyArrayObject *)__pyx_v_self)->descr;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":234
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":234
  *             cdef int offset
  * 
  *             cdef bint hasfields = PyDataType_HASFIELDS(descr)             # <<<<<<<<<<<<<<
@@ -17800,7 +14932,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
   __pyx_v_hasfields = PyDataType_HASFIELDS(__pyx_v_descr);
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":236
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":236
  *             cdef bint hasfields = PyDataType_HASFIELDS(descr)
  * 
  *             if not hasfields and not copy_shape:             # <<<<<<<<<<<<<<
@@ -17816,7 +14948,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   if (__pyx_t_1) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":238
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":238
  *             if not hasfields and not copy_shape:
  *                 # do not call releasebuffer
  *                 info.obj = None             # <<<<<<<<<<<<<<
@@ -17832,7 +14964,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   /*else*/ {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":241
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":241
  *             else:
  *                 # need to call releasebuffer
  *                 info.obj = self             # <<<<<<<<<<<<<<
@@ -17847,7 +14979,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   __pyx_L11:;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":243
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":243
  *                 info.obj = self
  * 
  *             if not hasfields:             # <<<<<<<<<<<<<<
@@ -17857,7 +14989,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   __pyx_t_1 = (!__pyx_v_hasfields);
   if (__pyx_t_1) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":244
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":244
  * 
  *             if not hasfields:
  *                 t = descr.type_num             # <<<<<<<<<<<<<<
@@ -17866,7 +14998,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_t = __pyx_v_descr->type_num;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":245
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":245
  *             if not hasfields:
  *                 t = descr.type_num
  *                 if ((descr.byteorder == '>' and little_endian) or             # <<<<<<<<<<<<<<
@@ -17881,7 +15013,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     }
     if (!__pyx_t_2) {
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":246
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":246
  *                 t = descr.type_num
  *                 if ((descr.byteorder == '>' and little_endian) or
  *                     (descr.byteorder == '<' and not little_endian)):             # <<<<<<<<<<<<<<
@@ -17901,7 +15033,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     }
     if (__pyx_t_1) {
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":247
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":247
  *                 if ((descr.byteorder == '>' and little_endian) or
  *                     (descr.byteorder == '<' and not little_endian)):
  *                     raise ValueError(u"Non-native byte order not supported")             # <<<<<<<<<<<<<<
@@ -17910,9 +15042,9 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
       __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_INCREF(((PyObject *)__pyx_kp_u_10));
-      PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_10));
-      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_10));
+      __Pyx_INCREF(((PyObject *)__pyx_kp_u_8));
+      PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_kp_u_8));
+      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_8));
       __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -17923,7 +15055,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     }
     __pyx_L13:;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":248
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":248
  *                     (descr.byteorder == '<' and not little_endian)):
  *                     raise ValueError(u"Non-native byte order not supported")
  *                 if   t == NPY_BYTE:        f = "b"             # <<<<<<<<<<<<<<
@@ -17936,7 +15068,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":249
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":249
  *                     raise ValueError(u"Non-native byte order not supported")
  *                 if   t == NPY_BYTE:        f = "b"
  *                 elif t == NPY_UBYTE:       f = "B"             # <<<<<<<<<<<<<<
@@ -17949,7 +15081,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":250
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":250
  *                 if   t == NPY_BYTE:        f = "b"
  *                 elif t == NPY_UBYTE:       f = "B"
  *                 elif t == NPY_SHORT:       f = "h"             # <<<<<<<<<<<<<<
@@ -17962,7 +15094,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":251
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":251
  *                 elif t == NPY_UBYTE:       f = "B"
  *                 elif t == NPY_SHORT:       f = "h"
  *                 elif t == NPY_USHORT:      f = "H"             # <<<<<<<<<<<<<<
@@ -17975,7 +15107,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":252
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":252
  *                 elif t == NPY_SHORT:       f = "h"
  *                 elif t == NPY_USHORT:      f = "H"
  *                 elif t == NPY_INT:         f = "i"             # <<<<<<<<<<<<<<
@@ -17988,7 +15120,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":253
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":253
  *                 elif t == NPY_USHORT:      f = "H"
  *                 elif t == NPY_INT:         f = "i"
  *                 elif t == NPY_UINT:        f = "I"             # <<<<<<<<<<<<<<
@@ -18001,7 +15133,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":254
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":254
  *                 elif t == NPY_INT:         f = "i"
  *                 elif t == NPY_UINT:        f = "I"
  *                 elif t == NPY_LONG:        f = "l"             # <<<<<<<<<<<<<<
@@ -18014,7 +15146,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":255
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":255
  *                 elif t == NPY_UINT:        f = "I"
  *                 elif t == NPY_LONG:        f = "l"
  *                 elif t == NPY_ULONG:       f = "L"             # <<<<<<<<<<<<<<
@@ -18027,7 +15159,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":256
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":256
  *                 elif t == NPY_LONG:        f = "l"
  *                 elif t == NPY_ULONG:       f = "L"
  *                 elif t == NPY_LONGLONG:    f = "q"             # <<<<<<<<<<<<<<
@@ -18040,7 +15172,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":257
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":257
  *                 elif t == NPY_ULONG:       f = "L"
  *                 elif t == NPY_LONGLONG:    f = "q"
  *                 elif t == NPY_ULONGLONG:   f = "Q"             # <<<<<<<<<<<<<<
@@ -18053,7 +15185,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":258
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":258
  *                 elif t == NPY_LONGLONG:    f = "q"
  *                 elif t == NPY_ULONGLONG:   f = "Q"
  *                 elif t == NPY_FLOAT:       f = "f"             # <<<<<<<<<<<<<<
@@ -18066,7 +15198,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":259
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":259
  *                 elif t == NPY_ULONGLONG:   f = "Q"
  *                 elif t == NPY_FLOAT:       f = "f"
  *                 elif t == NPY_DOUBLE:      f = "d"             # <<<<<<<<<<<<<<
@@ -18079,7 +15211,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":260
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":260
  *                 elif t == NPY_FLOAT:       f = "f"
  *                 elif t == NPY_DOUBLE:      f = "d"
  *                 elif t == NPY_LONGDOUBLE:  f = "g"             # <<<<<<<<<<<<<<
@@ -18092,7 +15224,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":261
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":261
  *                 elif t == NPY_DOUBLE:      f = "d"
  *                 elif t == NPY_LONGDOUBLE:  f = "g"
  *                 elif t == NPY_CFLOAT:      f = "Zf"             # <<<<<<<<<<<<<<
@@ -18105,7 +15237,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":262
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":262
  *                 elif t == NPY_LONGDOUBLE:  f = "g"
  *                 elif t == NPY_CFLOAT:      f = "Zf"
  *                 elif t == NPY_CDOUBLE:     f = "Zd"             # <<<<<<<<<<<<<<
@@ -18118,7 +15250,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":263
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":263
  *                 elif t == NPY_CFLOAT:      f = "Zf"
  *                 elif t == NPY_CDOUBLE:     f = "Zd"
  *                 elif t == NPY_CLONGDOUBLE: f = "Zg"             # <<<<<<<<<<<<<<
@@ -18131,7 +15263,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
       goto __pyx_L14;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":264
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":264
  *                 elif t == NPY_CDOUBLE:     f = "Zd"
  *                 elif t == NPY_CLONGDOUBLE: f = "Zg"
  *                 elif t == NPY_OBJECT:      f = "O"             # <<<<<<<<<<<<<<
@@ -18145,7 +15277,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     }
     /*else*/ {
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":266
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":266
  *                 elif t == NPY_OBJECT:      f = "O"
  *                 else:
  *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)             # <<<<<<<<<<<<<<
@@ -18154,7 +15286,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
       __pyx_t_5 = PyInt_FromLong(__pyx_v_t); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_11), __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_9), __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
@@ -18171,7 +15303,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     }
     __pyx_L14:;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":267
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":267
  *                 else:
  *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
  *                 info.format = f             # <<<<<<<<<<<<<<
@@ -18180,7 +15312,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->format = __pyx_v_f;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":268
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":268
  *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
  *                 info.format = f
  *                 return             # <<<<<<<<<<<<<<
@@ -18193,7 +15325,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   }
   /*else*/ {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":270
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":270
  *                 return
  *             else:
  *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)             # <<<<<<<<<<<<<<
@@ -18202,7 +15334,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_info->format = ((char *)malloc(255));
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":271
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":271
  *             else:
  *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)
  *                 info.format[0] = '^' # Native data types, manual alignment             # <<<<<<<<<<<<<<
@@ -18211,7 +15343,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     (__pyx_v_info->format[0]) = '^';
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":272
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":272
  *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)
  *                 info.format[0] = '^' # Native data types, manual alignment
  *                 offset = 0             # <<<<<<<<<<<<<<
@@ -18220,7 +15352,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
  */
     __pyx_v_offset = 0;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":275
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":275
  *                 f = _util_dtypestring(descr, info.format + 1,
  *                                       info.format + _buffer_format_string_len,
  *                                       &offset)             # <<<<<<<<<<<<<<
@@ -18230,7 +15362,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
     __pyx_t_9 = __pyx_f_5numpy__util_dtypestring(__pyx_v_descr, (__pyx_v_info->format + 1), (__pyx_v_info->format + 255), (&__pyx_v_offset)); if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_v_f = __pyx_t_9;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":276
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":276
  *                                       info.format + _buffer_format_string_len,
  *                                       &offset)
  *                 f[0] = 0 # Terminate format string             # <<<<<<<<<<<<<<
@@ -18263,7 +15395,7 @@ static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyObject *__pyx_v_self, Py_buf
   return __pyx_r;
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":278
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":278
  *                 f[0] = 0 # Terminate format string
  * 
  *         def __releasebuffer__(ndarray self, Py_buffer* info):             # <<<<<<<<<<<<<<
@@ -18277,7 +15409,7 @@ static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, P
   __Pyx_RefNannySetupContext("__releasebuffer__");
   __Pyx_INCREF((PyObject *)__pyx_v_self);
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":279
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":279
  * 
  *         def __releasebuffer__(ndarray self, Py_buffer* info):
  *             if PyArray_HASFIELDS(self):             # <<<<<<<<<<<<<<
@@ -18287,7 +15419,7 @@ static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, P
   __pyx_t_1 = PyArray_HASFIELDS(((PyArrayObject *)__pyx_v_self));
   if (__pyx_t_1) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":280
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":280
  *         def __releasebuffer__(ndarray self, Py_buffer* info):
  *             if PyArray_HASFIELDS(self):
  *                 stdlib.free(info.format)             # <<<<<<<<<<<<<<
@@ -18299,7 +15431,7 @@ static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, P
   }
   __pyx_L5:;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":281
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":281
  *             if PyArray_HASFIELDS(self):
  *                 stdlib.free(info.format)
  *             if sizeof(npy_intp) != sizeof(Py_ssize_t):             # <<<<<<<<<<<<<<
@@ -18309,7 +15441,7 @@ static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, P
   __pyx_t_1 = ((sizeof(npy_intp)) != (sizeof(Py_ssize_t)));
   if (__pyx_t_1) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":282
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":282
  *                 stdlib.free(info.format)
  *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
  *                 stdlib.free(info.strides)             # <<<<<<<<<<<<<<
@@ -18325,7 +15457,7 @@ static void __pyx_pf_5numpy_7ndarray___releasebuffer__(PyObject *__pyx_v_self, P
   __Pyx_RefNannyFinishContext();
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":755
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":755
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
@@ -18338,7 +15470,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew1(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1");
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":756
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":756
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
@@ -18364,7 +15496,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew1(PyObject *__
   return __pyx_r;
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":758
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":758
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
@@ -18377,7 +15509,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew2(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2");
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":759
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":759
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
@@ -18403,7 +15535,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew2(PyObject *__
   return __pyx_r;
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":761
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":761
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
@@ -18416,7 +15548,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew3(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3");
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":762
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":762
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
@@ -18442,7 +15574,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew3(PyObject *__
   return __pyx_r;
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":764
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":764
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
@@ -18455,7 +15587,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew4(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4");
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":765
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":765
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
@@ -18481,7 +15613,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew4(PyObject *__
   return __pyx_r;
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":767
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":767
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
@@ -18494,7 +15626,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew5(PyObject *__
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5");
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":768
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":768
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
@@ -18520,7 +15652,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew5(PyObject *__
   return __pyx_r;
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":770
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":770
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline char* _util_dtypestring(dtype descr, char* f, char* end, int* offset) except NULL:             # <<<<<<<<<<<<<<
@@ -18555,7 +15687,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
   __pyx_v_new_offset = Py_None; __Pyx_INCREF(Py_None);
   __pyx_v_t = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":777
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":777
  *     cdef int delta_offset
  *     cdef tuple i
  *     cdef int endian_detector = 1             # <<<<<<<<<<<<<<
@@ -18564,7 +15696,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
   __pyx_v_endian_detector = 1;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":778
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":778
  *     cdef tuple i
  *     cdef int endian_detector = 1
  *     cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)             # <<<<<<<<<<<<<<
@@ -18573,7 +15705,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
   __pyx_v_little_endian = ((((char *)(&__pyx_v_endian_detector))[0]) != 0);
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":781
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":781
  *     cdef tuple fields
  * 
  *     for childname in descr.names:             # <<<<<<<<<<<<<<
@@ -18592,7 +15724,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     __pyx_v_childname = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":782
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":782
  * 
  *     for childname in descr.names:
  *         fields = descr.fields[childname]             # <<<<<<<<<<<<<<
@@ -18606,7 +15738,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     __pyx_v_fields = ((PyObject *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":783
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":783
  *     for childname in descr.names:
  *         fields = descr.fields[childname]
  *         child, new_offset = fields             # <<<<<<<<<<<<<<
@@ -18629,7 +15761,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       {__pyx_filename = __pyx_f[7]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":785
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":785
  *         child, new_offset = fields
  * 
  *         if (end - f) - (new_offset - offset[0]) < 15:             # <<<<<<<<<<<<<<
@@ -18654,7 +15786,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_6) {
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":786
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":786
  * 
  *         if (end - f) - (new_offset - offset[0]) < 15:
  *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")             # <<<<<<<<<<<<<<
@@ -18663,9 +15795,9 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
       __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_INCREF(((PyObject *)__pyx_kp_u_12));
-      PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_12));
-      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_12));
+      __Pyx_INCREF(((PyObject *)__pyx_kp_u_10));
+      PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_kp_u_10));
+      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_10));
       __pyx_t_3 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
@@ -18676,7 +15808,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     }
     __pyx_L5:;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":788
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":788
  *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")
  * 
  *         if ((child.byteorder == '>' and little_endian) or             # <<<<<<<<<<<<<<
@@ -18691,7 +15823,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     }
     if (!__pyx_t_7) {
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":789
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":789
  * 
  *         if ((child.byteorder == '>' and little_endian) or
  *             (child.byteorder == '<' and not little_endian)):             # <<<<<<<<<<<<<<
@@ -18711,7 +15843,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     }
     if (__pyx_t_6) {
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":790
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":790
  *         if ((child.byteorder == '>' and little_endian) or
  *             (child.byteorder == '<' and not little_endian)):
  *             raise ValueError(u"Non-native byte order not supported")             # <<<<<<<<<<<<<<
@@ -18720,9 +15852,9 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
       __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_INCREF(((PyObject *)__pyx_kp_u_10));
-      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_10));
-      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_10));
+      __Pyx_INCREF(((PyObject *)__pyx_kp_u_8));
+      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_8));
+      __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_8));
       __pyx_t_5 = PyObject_Call(__pyx_builtin_ValueError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -18733,7 +15865,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     }
     __pyx_L6:;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":800
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":800
  * 
  *         # Output padding bytes
  *         while offset[0] < new_offset:             # <<<<<<<<<<<<<<
@@ -18750,7 +15882,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (!__pyx_t_6) break;
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":801
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":801
  *         # Output padding bytes
  *         while offset[0] < new_offset:
  *             f[0] = 120 # "x"; pad byte             # <<<<<<<<<<<<<<
@@ -18759,7 +15891,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
       (__pyx_v_f[0]) = 120;
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":802
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":802
  *         while offset[0] < new_offset:
  *             f[0] = 120 # "x"; pad byte
  *             f += 1             # <<<<<<<<<<<<<<
@@ -18768,7 +15900,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
       __pyx_v_f += 1;
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":803
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":803
  *             f[0] = 120 # "x"; pad byte
  *             f += 1
  *             offset[0] += 1             # <<<<<<<<<<<<<<
@@ -18778,7 +15910,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       (__pyx_v_offset[0]) += 1;
     }
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":805
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":805
  *             offset[0] += 1
  * 
  *         offset[0] += child.itemsize             # <<<<<<<<<<<<<<
@@ -18787,7 +15919,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
     (__pyx_v_offset[0]) += __pyx_v_child->elsize;
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":807
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":807
  *         offset[0] += child.itemsize
  * 
  *         if not PyDataType_HASFIELDS(child):             # <<<<<<<<<<<<<<
@@ -18797,7 +15929,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     __pyx_t_6 = (!PyDataType_HASFIELDS(__pyx_v_child));
     if (__pyx_t_6) {
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":808
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":808
  * 
  *         if not PyDataType_HASFIELDS(child):
  *             t = child.type_num             # <<<<<<<<<<<<<<
@@ -18810,7 +15942,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       __pyx_v_t = __pyx_t_3;
       __pyx_t_3 = 0;
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":809
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":809
  *         if not PyDataType_HASFIELDS(child):
  *             t = child.type_num
  *             if end - f < 5:             # <<<<<<<<<<<<<<
@@ -18820,7 +15952,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       __pyx_t_6 = ((__pyx_v_end - __pyx_v_f) < 5);
       if (__pyx_t_6) {
 
-        /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":810
+        /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":810
  *             t = child.type_num
  *             if end - f < 5:
  *                 raise RuntimeError(u"Format string allocated too short.")             # <<<<<<<<<<<<<<
@@ -18829,9 +15961,9 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
  */
         __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_INCREF(((PyObject *)__pyx_kp_u_13));
-        PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_13));
-        __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_13));
+        __Pyx_INCREF(((PyObject *)__pyx_kp_u_11));
+        PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_kp_u_11));
+        __Pyx_GIVEREF(((PyObject *)__pyx_kp_u_11));
         __pyx_t_5 = PyObject_Call(__pyx_builtin_RuntimeError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -18842,7 +15974,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       }
       __pyx_L10:;
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":813
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":813
  * 
  *             # Until ticket #99 is fixed, use integers to avoid warnings
  *             if   t == NPY_BYTE:        f[0] =  98 #"b"             # <<<<<<<<<<<<<<
@@ -18861,7 +15993,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":814
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":814
  *             # Until ticket #99 is fixed, use integers to avoid warnings
  *             if   t == NPY_BYTE:        f[0] =  98 #"b"
  *             elif t == NPY_UBYTE:       f[0] =  66 #"B"             # <<<<<<<<<<<<<<
@@ -18880,7 +16012,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":815
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":815
  *             if   t == NPY_BYTE:        f[0] =  98 #"b"
  *             elif t == NPY_UBYTE:       f[0] =  66 #"B"
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"             # <<<<<<<<<<<<<<
@@ -18899,7 +16031,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":816
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":816
  *             elif t == NPY_UBYTE:       f[0] =  66 #"B"
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"             # <<<<<<<<<<<<<<
@@ -18918,7 +16050,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":817
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":817
  *             elif t == NPY_SHORT:       f[0] = 104 #"h"
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"
  *             elif t == NPY_INT:         f[0] = 105 #"i"             # <<<<<<<<<<<<<<
@@ -18937,7 +16069,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":818
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":818
  *             elif t == NPY_USHORT:      f[0] =  72 #"H"
  *             elif t == NPY_INT:         f[0] = 105 #"i"
  *             elif t == NPY_UINT:        f[0] =  73 #"I"             # <<<<<<<<<<<<<<
@@ -18956,7 +16088,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":819
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":819
  *             elif t == NPY_INT:         f[0] = 105 #"i"
  *             elif t == NPY_UINT:        f[0] =  73 #"I"
  *             elif t == NPY_LONG:        f[0] = 108 #"l"             # <<<<<<<<<<<<<<
@@ -18975,7 +16107,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":820
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":820
  *             elif t == NPY_UINT:        f[0] =  73 #"I"
  *             elif t == NPY_LONG:        f[0] = 108 #"l"
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"             # <<<<<<<<<<<<<<
@@ -18994,7 +16126,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":821
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":821
  *             elif t == NPY_LONG:        f[0] = 108 #"l"
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"             # <<<<<<<<<<<<<<
@@ -19013,7 +16145,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":822
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":822
  *             elif t == NPY_ULONG:       f[0] = 76  #"L"
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"             # <<<<<<<<<<<<<<
@@ -19032,7 +16164,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":823
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":823
  *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"             # <<<<<<<<<<<<<<
@@ -19051,7 +16183,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":824
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":824
  *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"             # <<<<<<<<<<<<<<
@@ -19070,7 +16202,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":825
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":825
  *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"             # <<<<<<<<<<<<<<
@@ -19089,7 +16221,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":826
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":826
  *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf             # <<<<<<<<<<<<<<
@@ -19110,7 +16242,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":827
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":827
  *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd             # <<<<<<<<<<<<<<
@@ -19131,7 +16263,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":828
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":828
  *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
  *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg             # <<<<<<<<<<<<<<
@@ -19152,7 +16284,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
         goto __pyx_L11;
       }
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":829
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":829
  *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
  *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg
  *             elif t == NPY_OBJECT:      f[0] = 79 #"O"             # <<<<<<<<<<<<<<
@@ -19172,14 +16304,14 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       }
       /*else*/ {
 
-        /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":831
+        /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":831
  *             elif t == NPY_OBJECT:      f[0] = 79 #"O"
  *             else:
  *                 raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)             # <<<<<<<<<<<<<<
  *             f += 1
  *         else:
  */
-        __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_11), __pyx_v_t); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_u_9), __pyx_v_t); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_3);
         __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         __Pyx_GOTREF(__pyx_t_5);
@@ -19195,7 +16327,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
       }
       __pyx_L11:;
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":832
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":832
  *             else:
  *                 raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
  *             f += 1             # <<<<<<<<<<<<<<
@@ -19207,7 +16339,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
     }
     /*else*/ {
 
-      /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":836
+      /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":836
  *             # Cython ignores struct boundary information ("T{...}"),
  *             # so don't output it
  *             f = _util_dtypestring(child, f, end, offset)             # <<<<<<<<<<<<<<
@@ -19221,7 +16353,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":837
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":837
  *             # so don't output it
  *             f = _util_dtypestring(child, f, end, offset)
  *     return f             # <<<<<<<<<<<<<<
@@ -19251,7 +16383,7 @@ static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx
   return __pyx_r;
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":952
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":952
  * 
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
@@ -19266,7 +16398,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
   __Pyx_INCREF((PyObject *)__pyx_v_arr);
   __Pyx_INCREF(__pyx_v_base);
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":954
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":954
  * cdef inline void set_array_base(ndarray arr, object base):
  *      cdef PyObject* baseptr
  *      if base is None:             # <<<<<<<<<<<<<<
@@ -19276,7 +16408,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
   __pyx_t_1 = (__pyx_v_base == Py_None);
   if (__pyx_t_1) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":955
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":955
  *      cdef PyObject* baseptr
  *      if base is None:
  *          baseptr = NULL             # <<<<<<<<<<<<<<
@@ -19288,7 +16420,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
   }
   /*else*/ {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":957
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":957
  *          baseptr = NULL
  *      else:
  *          Py_INCREF(base) # important to do this before decref below!             # <<<<<<<<<<<<<<
@@ -19297,7 +16429,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
  */
     Py_INCREF(__pyx_v_base);
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":958
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":958
  *      else:
  *          Py_INCREF(base) # important to do this before decref below!
  *          baseptr = <PyObject*>base             # <<<<<<<<<<<<<<
@@ -19308,7 +16440,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
   }
   __pyx_L3:;
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":959
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":959
  *          Py_INCREF(base) # important to do this before decref below!
  *          baseptr = <PyObject*>base
  *      Py_XDECREF(arr.base)             # <<<<<<<<<<<<<<
@@ -19317,7 +16449,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
  */
   Py_XDECREF(__pyx_v_arr->base);
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":960
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":960
  *          baseptr = <PyObject*>base
  *      Py_XDECREF(arr.base)
  *      arr.base = baseptr             # <<<<<<<<<<<<<<
@@ -19331,7 +16463,7 @@ static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_a
   __Pyx_RefNannyFinishContext();
 }
 
-/* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":962
+/* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":962
  *      arr.base = baseptr
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
@@ -19345,7 +16477,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__py
   __Pyx_RefNannySetupContext("get_array_base");
   __Pyx_INCREF((PyObject *)__pyx_v_arr);
 
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":963
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":963
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     if arr.base is NULL:             # <<<<<<<<<<<<<<
@@ -19355,7 +16487,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__py
   __pyx_t_1 = (__pyx_v_arr->base == NULL);
   if (__pyx_t_1) {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":964
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":964
  * cdef inline object get_array_base(ndarray arr):
  *     if arr.base is NULL:
  *         return None             # <<<<<<<<<<<<<<
@@ -19370,7 +16502,7 @@ static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__py
   }
   /*else*/ {
 
-    /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/numpy.pxd":966
+    /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\numpy.pxd":966
  *         return None
  *     else:
  *         return <object>arr.base             # <<<<<<<<<<<<<<
@@ -19829,10 +16961,8 @@ static struct PyMethodDef __pyx_methods[] = {
   {__Pyx_NAMESTR("isnull"), (PyCFunction)__pyx_pf_7tseries_isnull, METH_O, __Pyx_DOCSTR(__pyx_doc_7tseries_isnull)},
   {__Pyx_NAMESTR("notnull"), (PyCFunction)__pyx_pf_7tseries_notnull, METH_O, __Pyx_DOCSTR(__pyx_doc_7tseries_notnull)},
   {__Pyx_NAMESTR("arrmap"), (PyCFunction)__pyx_pf_7tseries_arrmap, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
-  {__Pyx_NAMESTR("groupby_withnull_old"), (PyCFunction)__pyx_pf_7tseries_groupby_withnull_old, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
-  {__Pyx_NAMESTR("groupby_withnull"), (PyCFunction)__pyx_pf_7tseries_groupby_withnull, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("groupby"), (PyCFunction)__pyx_pf_7tseries_groupby, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
-  {__Pyx_NAMESTR("groupbyfunc"), (PyCFunction)__pyx_pf_7tseries_groupbyfunc, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_groupbyfunc)},
+  {__Pyx_NAMESTR("groupby_indices"), (PyCFunction)__pyx_pf_7tseries_groupby_indices, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("median"), (PyCFunction)__pyx_pf_7tseries_median, METH_O, __Pyx_DOCSTR(__pyx_doc_7tseries_median)},
   {__Pyx_NAMESTR("_roll_sum"), (PyCFunction)__pyx_pf_7tseries__roll_sum, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("_roll_mean"), (PyCFunction)__pyx_pf_7tseries__roll_mean, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
@@ -19851,9 +16981,6 @@ static struct PyMethodDef __pyx_methods[] = {
   {__Pyx_NAMESTR("rolling_skew"), (PyCFunction)__pyx_pf_7tseries_rolling_skew, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("rolling_kurt"), (PyCFunction)__pyx_pf_7tseries_rolling_kurt, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("ewma"), (PyCFunction)__pyx_pf_7tseries_ewma, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
-  {__Pyx_NAMESTR("reindex"), (PyCFunction)__pyx_pf_7tseries_reindex, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_reindex)},
-  {__Pyx_NAMESTR("reindexObj"), (PyCFunction)__pyx_pf_7tseries_reindexObj, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_reindexObj)},
-  {__Pyx_NAMESTR("reindexObject"), (PyCFunction)__pyx_pf_7tseries_reindexObject, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_reindexObject)},
   {__Pyx_NAMESTR("getFillVec"), (PyCFunction)__pyx_pf_7tseries_getFillVec, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("getMergeVec"), (PyCFunction)__pyx_pf_7tseries_getMergeVec, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
   {__Pyx_NAMESTR("combineFunc"), (PyCFunction)__pyx_pf_7tseries_combineFunc, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7tseries_combineFunc)},
@@ -19880,14 +17007,12 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_kp_s_1, __pyx_k_1, sizeof(__pyx_k_1), 0, 0, 1, 0},
   {&__pyx_kp_u_10, __pyx_k_10, sizeof(__pyx_k_10), 0, 1, 0, 0},
   {&__pyx_kp_u_11, __pyx_k_11, sizeof(__pyx_k_11), 0, 1, 0, 0},
-  {&__pyx_kp_u_12, __pyx_k_12, sizeof(__pyx_k_12), 0, 1, 0, 0},
-  {&__pyx_kp_u_13, __pyx_k_13, sizeof(__pyx_k_13), 0, 1, 0, 0},
   {&__pyx_kp_s_2, __pyx_k_2, sizeof(__pyx_k_2), 0, 0, 1, 0},
   {&__pyx_kp_s_3, __pyx_k_3, sizeof(__pyx_k_3), 0, 0, 1, 0},
   {&__pyx_kp_s_4, __pyx_k_4, sizeof(__pyx_k_4), 0, 0, 1, 0},
   {&__pyx_kp_s_5, __pyx_k_5, sizeof(__pyx_k_5), 0, 0, 1, 0},
-  {&__pyx_kp_s_6, __pyx_k_6, sizeof(__pyx_k_6), 0, 0, 1, 0},
-  {&__pyx_kp_s_7, __pyx_k_7, sizeof(__pyx_k_7), 0, 0, 1, 0},
+  {&__pyx_kp_u_6, __pyx_k_6, sizeof(__pyx_k_6), 0, 1, 0, 0},
+  {&__pyx_kp_u_7, __pyx_k_7, sizeof(__pyx_k_7), 0, 1, 0, 0},
   {&__pyx_kp_u_8, __pyx_k_8, sizeof(__pyx_k_8), 0, 1, 0, 0},
   {&__pyx_kp_u_9, __pyx_k_9, sizeof(__pyx_k_9), 0, 1, 0, 0},
   {&__pyx_n_s__BACKFILL, __pyx_k__BACKFILL, sizeof(__pyx_k__BACKFILL), 0, 0, 1, 1},
@@ -19911,7 +17036,6 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s____pow__, __pyx_k____pow__, sizeof(__pyx_k____pow__), 0, 0, 1, 1},
   {&__pyx_n_s____sub__, __pyx_k____sub__, sizeof(__pyx_k____sub__), 0, 0, 1, 1},
   {&__pyx_n_s___ewma, __pyx_k___ewma, sizeof(__pyx_k___ewma), 0, 0, 1, 1},
-  {&__pyx_n_s___nofill, __pyx_k___nofill, sizeof(__pyx_k___nofill), 0, 0, 1, 1},
   {&__pyx_n_s___roll_kurt, __pyx_k___roll_kurt, sizeof(__pyx_k___roll_kurt), 0, 0, 1, 1},
   {&__pyx_n_s___roll_mean, __pyx_k___roll_mean, sizeof(__pyx_k___roll_mean), 0, 0, 1, 1},
   {&__pyx_n_s___roll_median, __pyx_k___roll_median, sizeof(__pyx_k___roll_median), 0, 0, 1, 1},
@@ -19921,8 +17045,6 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__aMap, __pyx_k__aMap, sizeof(__pyx_k__aMap), 0, 0, 1, 1},
   {&__pyx_n_s__any, __pyx_k__any, sizeof(__pyx_k__any), 0, 0, 1, 1},
   {&__pyx_n_s__ao, __pyx_k__ao, sizeof(__pyx_k__ao), 0, 0, 1, 1},
-  {&__pyx_n_s__applyfunc, __pyx_k__applyfunc, sizeof(__pyx_k__applyfunc), 0, 0, 1, 1},
-  {&__pyx_n_s__arr, __pyx_k__arr, sizeof(__pyx_k__arr), 0, 0, 1, 1},
   {&__pyx_n_s__array, __pyx_k__array, sizeof(__pyx_k__array), 0, 0, 1, 1},
   {&__pyx_n_s__arrmap, __pyx_k__arrmap, sizeof(__pyx_k__arrmap), 0, 0, 1, 1},
   {&__pyx_n_s__asarray, __pyx_k__asarray, sizeof(__pyx_k__asarray), 0, 0, 1, 1},
@@ -19947,7 +17069,6 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__get, __pyx_k__get, sizeof(__pyx_k__get), 0, 0, 1, 1},
   {&__pyx_n_s__getMergeVec, __pyx_k__getMergeVec, sizeof(__pyx_k__getMergeVec), 0, 0, 1, 1},
   {&__pyx_n_s__head, __pyx_k__head, sizeof(__pyx_k__head), 0, 0, 1, 1},
-  {&__pyx_n_s__idxMap, __pyx_k__idxMap, sizeof(__pyx_k__idxMap), 0, 0, 1, 1},
   {&__pyx_n_s__index, __pyx_k__index, sizeof(__pyx_k__index), 0, 0, 1, 1},
   {&__pyx_n_s__inf, __pyx_k__inf, sizeof(__pyx_k__inf), 0, 0, 1, 1},
   {&__pyx_n_s__input, __pyx_k__input, sizeof(__pyx_k__input), 0, 0, 1, 1},
@@ -19958,8 +17079,8 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__isnan, __pyx_k__isnan, sizeof(__pyx_k__isnan), 0, 0, 1, 1},
   {&__pyx_n_s__isnull, __pyx_k__isnull, sizeof(__pyx_k__isnull), 0, 0, 1, 1},
   {&__pyx_n_s__itemsize, __pyx_k__itemsize, sizeof(__pyx_k__itemsize), 0, 0, 1, 1},
-  {&__pyx_n_s__keyfunc, __pyx_k__keyfunc, sizeof(__pyx_k__keyfunc), 0, 0, 1, 1},
   {&__pyx_n_s__kind, __pyx_k__kind, sizeof(__pyx_k__kind), 0, 0, 1, 1},
+  {&__pyx_n_s__mapper, __pyx_k__mapper, sizeof(__pyx_k__mapper), 0, 0, 1, 1},
   {&__pyx_n_s__max, __pyx_k__max, sizeof(__pyx_k__max), 0, 0, 1, 1},
   {&__pyx_n_s__maxlevels, __pyx_k__maxlevels, sizeof(__pyx_k__maxlevels), 0, 0, 1, 1},
   {&__pyx_n_s__min, __pyx_k__min, sizeof(__pyx_k__min), 0, 0, 1, 1},
@@ -19973,11 +17094,11 @@ static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s__np, __pyx_k__np, sizeof(__pyx_k__np), 0, 0, 1, 1},
   {&__pyx_n_s__numpy, __pyx_k__numpy, sizeof(__pyx_k__numpy), 0, 0, 1, 1},
   {&__pyx_n_s__obj, __pyx_k__obj, sizeof(__pyx_k__obj), 0, 0, 1, 1},
-  {&__pyx_n_s__object, __pyx_k__object, sizeof(__pyx_k__object), 0, 0, 1, 1},
   {&__pyx_n_s__object_, __pyx_k__object_, sizeof(__pyx_k__object_), 0, 0, 1, 1},
   {&__pyx_n_s__oldIndex, __pyx_k__oldIndex, sizeof(__pyx_k__oldIndex), 0, 0, 1, 1},
   {&__pyx_n_s__oldMap, __pyx_k__oldMap, sizeof(__pyx_k__oldMap), 0, 0, 1, 1},
   {&__pyx_n_s__ones, __pyx_k__ones, sizeof(__pyx_k__ones), 0, 0, 1, 1},
+  {&__pyx_n_s__output, __pyx_k__output, sizeof(__pyx_k__output), 0, 0, 1, 1},
   {&__pyx_n_s__pydatetime, __pyx_k__pydatetime, sizeof(__pyx_k__pydatetime), 0, 0, 1, 1},
   {&__pyx_n_s__random, __pyx_k__random, sizeof(__pyx_k__random), 0, 0, 1, 1},
   {&__pyx_n_s__range, __pyx_k__range, sizeof(__pyx_k__range), 0, 0, 1, 1},
@@ -20007,7 +17128,6 @@ static int __Pyx_InitCachedBuiltins(void) {
   __pyx_builtin_min = __Pyx_GetName(__pyx_b, __pyx_n_s__min); if (!__pyx_builtin_min) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_builtin_KeyError = __Pyx_GetName(__pyx_b, __pyx_n_s__KeyError); if (!__pyx_builtin_KeyError) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_builtin_max = __Pyx_GetName(__pyx_b, __pyx_n_s__max); if (!__pyx_builtin_max) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_builtin_object = __Pyx_GetName(__pyx_b, __pyx_n_s__object); if (!__pyx_builtin_object) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_builtin_RuntimeError = __Pyx_GetName(__pyx_b, __pyx_n_s__RuntimeError); if (!__pyx_builtin_RuntimeError) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   return 0;
   __pyx_L1_error:;
@@ -20105,7 +17225,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   /*--- Function import code ---*/
   /*--- Execution code ---*/
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":11
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":11
  * from python_float cimport PyFloat_Check
  * 
  * import numpy as np             # <<<<<<<<<<<<<<
@@ -20117,7 +17237,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__np, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":12
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":12
  * 
  * import numpy as np
  * isnan = np.isnan             # <<<<<<<<<<<<<<
@@ -20132,7 +17252,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__isnan, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":13
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":13
  * import numpy as np
  * isnan = np.isnan
  * cdef double NaN = <double> np.NaN             # <<<<<<<<<<<<<<
@@ -20148,7 +17268,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_7tseries_NaN = ((double)__pyx_t_3);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":15
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":15
  * cdef double NaN = <double> np.NaN
  * 
  * from datetime import datetime as pydatetime             # <<<<<<<<<<<<<<
@@ -20169,7 +17289,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":80
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":80
  * 
  * # import datetime C API
  * PyDateTime_IMPORT             # <<<<<<<<<<<<<<
@@ -20178,7 +17298,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   PyDateTime_IMPORT;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/common.pyx":83
+  /* "H:\workspace\pandas\pandas\lib\src\common.pyx":83
  * 
  * # initialize numpy
  * import_array()             # <<<<<<<<<<<<<<
@@ -20187,7 +17307,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   import_array();
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":18
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":18
  * cimport numpy as np
  * from numpy cimport *
  * import numpy as np             # <<<<<<<<<<<<<<
@@ -20199,7 +17319,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__np, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":20
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":20
  * import numpy as np
  * 
  * from random import random             # <<<<<<<<<<<<<<
@@ -20220,7 +17340,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":23
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":23
  * 
  * # initialize numpy
  * import_array()             # <<<<<<<<<<<<<<
@@ -20229,7 +17349,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   import_array();
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/skiplist.pyx":41
+  /* "H:\workspace\pandas\pandas\lib\src\skiplist.pyx":41
  *         self.width = <int *> width.data
  * 
  * NIL = Node(np.inf, [], np.array([])) # Singleton terminator node             # <<<<<<<<<<<<<<
@@ -20276,22 +17396,22 @@ PyMODINIT_FUNC PyInit_tseries(void)
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__NIL, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":2
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":2
  * 
  * cdef double INF = <double> np.inf             # <<<<<<<<<<<<<<
  * cdef double NEGINF = -INF
  * 
  */
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__inf); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__inf); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_7tseries_INF = ((double)__pyx_t_3);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/isnull.pyx":3
+  /* "H:\workspace\pandas\pandas\lib\src\isnull.pyx":3
  * 
  * cdef double INF = <double> np.inf
  * cdef double NEGINF = -INF             # <<<<<<<<<<<<<<
@@ -20300,17 +17420,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
  */
   __pyx_v_7tseries_NEGINF = (-__pyx_v_7tseries_INF);
 
-  /* "/Users/wesm/code/pandas/pandas/lib/src/reindex.pyx":410
- * 
- * #     return fillLocs, mask.astype(bool)
- * _nofill = getMergeVec             # <<<<<<<<<<<<<<
- */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__getMergeVec); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_6);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s___nofill, __pyx_t_6) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-
-  /* "/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-packages/Cython-0.12.1-py2.5-macosx-10.3-i386.egg/Cython/Includes/python_dict.pxd":1
+  /* "C:\Python25\lib\site-packages\cython-0.12.1-py2.5.egg\Cython\Includes\python_dict.pxd":1
  * from python_ref cimport PyObject             # <<<<<<<<<<<<<<
  * 
  * cdef extern from "Python.h":
@@ -20341,9 +17451,9 @@ static const char *__pyx_filenames[] = {
   "common.pyx",
   "skiplist.pyx",
   "moments.pyx",
-  "reindex.pyx",
   "isnull.pyx",
   "groupby.pyx",
+  "reindex.pyx",
   "operators.pyx",
   "numpy.pxd",
   "tseries.pyx",
@@ -21302,47 +18412,6 @@ bad:
 }
 #endif
 
-static CYTHON_INLINE npy_intp __Pyx_PyInt_from_py_npy_intp(PyObject* x) {
-    const npy_intp neg_one = (npy_intp)-1, const_zero = 0;
-    const int is_unsigned = neg_one > const_zero;
-    if (sizeof(npy_intp) == sizeof(char)) {
-        if (is_unsigned)
-            return (npy_intp)__Pyx_PyInt_AsUnsignedChar(x);
-        else
-            return (npy_intp)__Pyx_PyInt_AsSignedChar(x);
-    } else if (sizeof(npy_intp) == sizeof(short)) {
-        if (is_unsigned)
-            return (npy_intp)__Pyx_PyInt_AsUnsignedShort(x);
-        else
-            return (npy_intp)__Pyx_PyInt_AsSignedShort(x);
-    } else if (sizeof(npy_intp) == sizeof(int)) {
-        if (is_unsigned)
-            return (npy_intp)__Pyx_PyInt_AsUnsignedInt(x);
-        else
-            return (npy_intp)__Pyx_PyInt_AsSignedInt(x);
-    } else if (sizeof(npy_intp) == sizeof(long)) {
-        if (is_unsigned)
-            return (npy_intp)__Pyx_PyInt_AsUnsignedLong(x);
-        else
-            return (npy_intp)__Pyx_PyInt_AsSignedLong(x);
-    } else if (sizeof(npy_intp) == sizeof(PY_LONG_LONG)) {
-        if (is_unsigned)
-            return (npy_intp)__Pyx_PyInt_AsUnsignedLongLong(x);
-        else
-            return (npy_intp)__Pyx_PyInt_AsSignedLongLong(x);
-#if 0
-    } else if (sizeof(npy_intp) > sizeof(short) &&
-               sizeof(npy_intp) < sizeof(int)) { /*  __int32 ILP64 ? */
-        if (is_unsigned)
-            return (npy_intp)__Pyx_PyInt_AsUnsignedInt(x);
-        else
-            return (npy_intp)__Pyx_PyInt_AsSignedInt(x);
-#endif
-    }
-    PyErr_SetString(PyExc_TypeError, "npy_intp");
-    return (npy_intp)-1;
-}
-
 static CYTHON_INLINE npy_int32 __Pyx_PyInt_from_py_npy_int32(PyObject* x) {
     const npy_int32 neg_one = (npy_int32)-1, const_zero = 0;
     const int is_unsigned = neg_one > const_zero;
diff --git a/pandas/stats/plm.py b/pandas/stats/plm.py
index cc3e3664b..d8651eeef 100644
--- a/pandas/stats/plm.py
+++ b/pandas/stats/plm.py
@@ -60,8 +60,8 @@ class PanelOLS(OLS):
         For example, if you have a panel data with countries over time and you suspect that:
 
         1. Countries are correlated - use 'time'
-        2. There is autocorrelation - use 'entity' 
-        
+        2. There is autocorrelation - use 'entity'
+
     """
     def __init__(self, y, x, weights=None,
                  intercept=True, nw_lags=None, entity_effects=False,
@@ -156,7 +156,7 @@ class PanelOLS(OLS):
             data, cat_mapping = self._convert_x(data)
 
             if not isinstance(data, WidePanel):
-                data = WidePanel.fromDict(data)
+                data = WidePanel.fromDict(data, intersect=True)
 
         x_names = data.items
 
@@ -596,7 +596,7 @@ class MovingPanelOLS(MovingOLS, PanelOLS):
         For example, if you have a panel data with countries over time and you suspect that:
 
         1. Countries are correlated - use 'time'
-        2. There is autocorrelation - use 'entity' 
+        2. There is autocorrelation - use 'entity'
     """
     def __init__(self, y, x, weights=None,
                  window_type='expanding', window=None,
diff --git a/pandas/stats/tests/__init__.py b/pandas/stats/tests/__init__.py
deleted file mode 100644
index e69de29bb..000000000
diff --git a/pandas/util/testing.py b/pandas/util/testing.py
index d8faa1abc..f85333c28 100644
--- a/pandas/util/testing.py
+++ b/pandas/util/testing.py
@@ -13,6 +13,11 @@ from pandas.core.api import (DateRange, Index, Series, DataFrame,
 N = 30
 K = 4
 
+def debug(f, *args, **kwargs):
+    from IPython.Debugger import Pdb
+    Pdb(color_scheme='Linux').set_trace()
+    return f(*args, **kwargs)
+
 def rands(n):
     choices = string.letters + string.digits
     return ''.join([random.choice(choices) for _ in xrange(n)])
