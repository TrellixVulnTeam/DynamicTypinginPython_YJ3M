commit a903e97fc148c9d869e1979a97655cf247ccffd4
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Fri Aug 19 13:46:53 2011 -0400

    BUG: tests pass now

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index 7928b538e..88a69a93c 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -323,10 +323,17 @@ class GroupBy(object):
 
 def _is_indexed_like(obj, other):
     if isinstance(obj, Series):
+        if not isinstance(other, Series):
+            return False
         return obj.index.equals(other.index)
     elif isinstance(obj, DataFrame):
+        if not isinstance(other, DataFrame):
+            return False
+
         return obj._indexed_same(other)
 
+    return False
+
 class Grouping(object):
 
     def __init__(self, index, grouper=None, name=None, level=None):
@@ -780,7 +787,7 @@ class DataFrameGroupBy(GroupBy):
                 columns = values[0].index
                 index = keys
             else:
-                stacked_values = np.vstack(values)
+                stacked_values = np.vstack(values).T
                 index = values[0].index
                 columns = keys
 
diff --git a/pandas/tests/test_sparse.py b/pandas/tests/test_sparse.py
index a56278dd5..8bcfcb3b0 100644
--- a/pandas/tests/test_sparse.py
+++ b/pandas/tests/test_sparse.py
@@ -310,7 +310,7 @@ class TestSparseSeries(TestCase):
             dense = sp.to_dense()
 
             def _compare(idx):
-                dense_result = dense.take(idx)
+                dense_result = dense.take(idx).values
                 sparse_result = sp.take(idx)
                 assert_almost_equal(dense_result, sparse_result)
 
