commit b3f21339ad8cb4775153d70577067a0b73ce07b0
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Apr 16 00:48:46 2012 -0400

    BUG: fixes to bugs raised by moving to Cython 0.16rc2

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index 2d1b95f32..e14193b65 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -640,7 +640,7 @@ class Grouper(object):
     }
 
     _name_functions = {
-        'ohlc' : lambda *args: ['open', 'low', 'high', 'close']
+        'ohlc' : lambda *args: ['open', 'high', 'low', 'close']
     }
 
     def aggregate(self, values, how):
diff --git a/pandas/src/groupby.pyx b/pandas/src/groupby.pyx
index aacf82466..c10adae3d 100644
--- a/pandas/src/groupby.pyx
+++ b/pandas/src/groupby.pyx
@@ -892,8 +892,8 @@ def group_ohlc(ndarray[float64_t, ndim=2] out,
                     out[b, 3] = NA
                 else:
                     out[b, 0] = vopen
-                    out[b, 1] = vlow
-                    out[b, 2] = vhigh
+                    out[b, 1] = vhigh
+                    out[b, 2] = vlow
                     out[b, 3] = vclose
                 b += 1
                 got_first = 0
@@ -922,8 +922,8 @@ def group_ohlc(ndarray[float64_t, ndim=2] out,
             out[b, 3] = NA
         else:
             out[b, 0] = vopen
-            out[b, 1] = vlow
-            out[b, 2] = vhigh
+            out[b, 1] = vhigh
+            out[b, 2] = vlow
             out[b, 3] = vclose
 
 
diff --git a/pandas/src/tseries.pyx b/pandas/src/tseries.pyx
index cc7b0cf18..609f0686d 100644
--- a/pandas/src/tseries.pyx
+++ b/pandas/src/tseries.pyx
@@ -451,7 +451,12 @@ def maybe_booleans_to_slice(ndarray[uint8_t, cast=True] mask):
                 end = i
                 finished = 1
 
-    return slice(start, end)
+    if not started:
+        return slice(0, 0)
+    if not finished:
+        return slice(start, None)
+    else:
+        return slice(start, end)
 
 
 @cython.wraparound(False)
diff --git a/pandas/tests/test_timeseries.py b/pandas/tests/test_timeseries.py
index 744db83f5..6539419bc 100644
--- a/pandas/tests/test_timeseries.py
+++ b/pandas/tests/test_timeseries.py
@@ -239,7 +239,7 @@ class TestTimeSeries(unittest.TestCase):
         def _ohlc(group):
             if isnull(group).all():
                 return np.repeat(np.nan, 4)
-            return [group[0], group.min(), group.max(), group[-1]]
+            return [group[0], group.max(), group.min(), group[-1]]
 
         rng = date_range('1/1/2000 00:00:00', '1/1/2000 5:59:50',
                          freq='10s')
@@ -807,7 +807,7 @@ class TestDatetime64(unittest.TestCase):
         self.assertEquals(result[0], s[0])
         self.assertEquals(result[-1], s[-1])
 
-    def test_convert_olhc(self):
+    def test_convert_ohlc(self):
         s = self.series
 
         grouper = TimeGrouper(Minute(5), closed='right', label='right')
diff --git a/pandas/tests/test_tseries.py b/pandas/tests/test_tseries.py
index ece54ed02..cdeada769 100644
--- a/pandas/tests/test_tseries.py
+++ b/pandas/tests/test_tseries.py
@@ -420,7 +420,7 @@ def test_group_ohlc():
     def _ohlc(group):
         if isnull(group).all():
             return np.repeat(np.nan, 4)
-        return [group[0], group.min(), group.max(), group[-1]]
+        return [group[0], group.max(), group.min(), group[-1]]
 
     expected = np.array([_ohlc(obj[:6]), _ohlc(obj[6:12]),
                          _ohlc(obj[12:])])
