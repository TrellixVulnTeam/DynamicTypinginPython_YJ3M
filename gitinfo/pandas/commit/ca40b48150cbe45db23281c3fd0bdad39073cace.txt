commit ca40b48150cbe45db23281c3fd0bdad39073cace
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sat Nov 3 12:19:34 2012 -0400

    BUG/ENH: week-of-month time rule inference. close #2140

diff --git a/RELEASE.rst b/RELEASE.rst
index a2bc0fa9b..273c7d663 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -36,6 +36,7 @@ pandas 0.9.1
 
 **Improvements to existing features**
 
+  - Time rule inference for week-of-month (e.g. WOM-2FRI) rules (#2140)
   - Improve performance of datetime + business day offset with large number of
     offset periods
   - Improve HTML display of DataFrame objects with hierarchical columns
diff --git a/pandas/tseries/frequencies.py b/pandas/tseries/frequencies.py
index b9b2d28e1..82b3a0fa7 100644
--- a/pandas/tseries/frequencies.py
+++ b/pandas/tseries/frequencies.py
@@ -3,6 +3,7 @@ import re
 
 import numpy as np
 
+from pandas.core.algorithms import unique
 from pandas.tseries.offsets import DateOffset
 from pandas.util.decorators import cache_readonly
 import pandas.tseries.offsets as offsets
@@ -890,6 +891,10 @@ class _FrequencyInferer(object):
         if self.day_deltas == [1, 3]:
             return 'B'
 
+        wom_rule = self._get_wom_rule()
+        if wom_rule:
+            return wom_rule
+
     def _get_annual_rule(self):
         if len(self.ydiffs) > 1:
             return None
@@ -919,6 +924,20 @@ class _FrequencyInferer(object):
         return {'cs': 'MS', 'bs': 'BMS',
                 'ce': 'M', 'be': 'BM'}.get(pos_check)
 
+    def _get_wom_rule(self):
+        wdiffs = unique(np.diff(self.index.week))
+        if not lib.ismember(wdiffs, set([4, 5])).all():
+            return None
+
+        weekdays = unique(self.index.weekday)
+        if len(weekdays) > 1:
+            return None
+
+        # get which week
+        week = (self.index[0].day - 1) // 7 + 1
+        wd = _weekday_rule_aliases[weekdays[0]]
+
+        return 'WOM-%d%s' % (week, wd)
 
 import pandas.core.algorithms as algos
 
diff --git a/pandas/tseries/tests/test_frequencies.py b/pandas/tseries/tests/test_frequencies.py
index 2b1a87d72..3a96d59d3 100644
--- a/pandas/tseries/tests/test_frequencies.py
+++ b/pandas/tseries/tests/test_frequencies.py
@@ -142,6 +142,13 @@ class TestFrequencyInference(unittest.TestCase):
         for day in days:
             self._check_generated_range('1/1/2000', 'W-%s' % day)
 
+    def test_week_of_month(self):
+        days = ['MON', 'TUE', 'WED', 'THU', 'FRI']
+
+        for day in days:
+            for i in range(1, 5):
+                self._check_generated_range('1/1/2000', 'WOM-%d%s' % (i, day))
+
     def test_monthly(self):
         self._check_generated_range('1/1/2000', 'M')
 
