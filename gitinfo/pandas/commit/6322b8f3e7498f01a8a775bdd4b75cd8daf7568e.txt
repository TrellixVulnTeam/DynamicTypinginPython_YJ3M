commit 6322b8f3e7498f01a8a775bdd4b75cd8daf7568e
Author: alimcmaster1 <alimcmaster1@gmail.com>
Date:   Tue Dec 31 17:22:05 2019 +0000

    TST: XFAIL Travis read_html tests (#30544)
    
    * XFAIL Tests
    
    * XFAIL Tests
    
    * Update as per brock suggestion
    
    * unpin beautiful soup version
    
    * Dont xfail for bs4 < 4.8.0
    
    * Remove slow tests from allowed failures
    
    * black pandas

diff --git a/.travis.yml b/.travis.yml
index 0a5af6d43..a11cd469e 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -48,17 +48,12 @@ matrix:
         - mysql
         - postgresql
 
-    # In allow_failures
     - env:
         - JOB="3.6, slow" ENV_FILE="ci/deps/travis-36-slow.yaml" PATTERN="slow" SQL="1"
       services:
         - mysql
         - postgresql
 
-    allow_failures:
-      - env:
-          - JOB="3.6, slow" ENV_FILE="ci/deps/travis-36-slow.yaml" PATTERN="slow" SQL="1"
-
 before_install:
   - echo "before_install"
   # set non-blocking IO on travis
diff --git a/ci/deps/azure-36-locale_slow.yaml b/ci/deps/azure-36-locale_slow.yaml
index 2bb2b0031..48ac50c00 100644
--- a/ci/deps/azure-36-locale_slow.yaml
+++ b/ci/deps/azure-36-locale_slow.yaml
@@ -13,7 +13,7 @@ dependencies:
   - pytest-azurepipelines
 
   # pandas dependencies
-  - beautifulsoup4==4.6.0
+  - beautifulsoup4=4.6.0
   - bottleneck=1.2.*
   - lxml
   - matplotlib=2.2.2
diff --git a/pandas/tests/io/test_html.py b/pandas/tests/io/test_html.py
index bc26615d1..2bb412cf6 100644
--- a/pandas/tests/io/test_html.py
+++ b/pandas/tests/io/test_html.py
@@ -383,7 +383,15 @@ class TestReadHtml:
         assert not any(s.isna().any() for _, s in df.items())
 
     @pytest.mark.slow
-    def test_thousands_macau_index_col(self, datapath):
+    def test_thousands_macau_index_col(self, datapath, request):
+        # https://github.com/pandas-dev/pandas/issues/29622
+        # This tests fails for bs4 >= 4.8.0 - so handle xfail accordingly
+        if self.read_html.keywords.get("flavor") == "bs4" and td.safe_import(
+            "bs4", "4.8.0"
+        ):
+            reason = "fails for bs4 version >= 4.8.0"
+            request.node.add_marker(pytest.mark.xfail(reason=reason))
+
         all_non_nan_table_index = -2
         macau_data = datapath("io", "data", "html", "macau.html")
         dfs = self.read_html(macau_data, index_col=0, header=0)
