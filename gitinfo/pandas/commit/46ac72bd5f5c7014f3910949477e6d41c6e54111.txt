commit 46ac72bd5f5c7014f3910949477e6d41c6e54111
Author: Chang She <changshe@gmail.com>
Date:   Mon Sep 10 22:28:40 2012 -0400

    BUG: unicode sheet name in to_excel #1828

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 164a9f4e7..4d7fa0575 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -1197,7 +1197,7 @@ class DataFrame(NDFrame):
         """
         from pandas.io.parsers import ExcelWriter
         need_save = False
-        if isinstance(excel_writer, str):
+        if isinstance(excel_writer, basestring):
             excel_writer = ExcelWriter(excel_writer)
             need_save = True
         excel_writer.cur_sheet = sheet_name
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 1ae31d4c1..63b5ed97b 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -3524,6 +3524,28 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
             assert_frame_equal(rs, xp)
             os.remove(filename)
 
+    def test_000to_excel_unicode_filename(self):
+        try:
+            import xlwt
+            import openpyxl
+        except ImportError:
+            raise nose.SkipTest
+
+        for ext in ['xls', 'xlsx']:
+            filename = u'\u0192u.' + ext
+            df = DataFrame([[0.123456, 0.234567, 0.567567],
+                            [12.32112, 123123.2, 321321.2]],
+                           index=['A', 'B'], columns=['X', 'Y', 'Z'])
+            df.to_excel(filename, 'test1', float_format='%.2f')
+
+            reader = ExcelFile(filename)
+            rs = reader.parse('test1', index_col=None)
+            xp = DataFrame([[0.12, 0.23, 0.57],
+                            [12.32, 123123.20, 321321.20]],
+                           index=['A', 'B'], columns=['X', 'Y', 'Z'])
+            assert_frame_equal(rs, xp)
+            os.remove(filename)
+
     def test_info(self):
         io = StringIO()
         self.frame.info(buf=io)
