commit 31ab2925310ced2b51404cfd3b30e0f50a62015e
Author: Dieter Vandenbussche <dvandenbussche@axioma.com>
Date:   Mon Mar 19 08:38:47 2012 -0700

    BUG: partial handling of booleans in to_excel, fixes #940

diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index b51459c05..a3da3cb91 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -777,6 +777,8 @@ class ExcelWriter(object):
                     sheetrow.write(i,val, self.fm_date)
             elif isinstance(val, np.int64):
                 sheetrow.write(i,int(val))
+            elif isinstance(val, np.bool8):
+                sheetrow.write(i,bool(val))
             else:
                 sheetrow.write(i,val)
         row_idx += 1
@@ -791,8 +793,14 @@ class ExcelWriter(object):
             sheet = self.book.create_sheet()
             sheet.title = sheet_name
             row_idx = 0
-
-        sheet.append([int(val) if isinstance(val, np.int64) else val
-                      for val in row])
+        
+        conv_row = []
+        for val in row:
+            if isinstance(val, np.int64):
+                val = int(val)
+            elif isinstance(val, np.bool8):
+                val = bool(val)
+            conv_row.append(val)
+        sheet.append(conv_row)
         row_idx += 1
         self.sheets[sheet_name] = (sheet, row_idx)
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 74382309c..cc91cb972 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -2518,6 +2518,13 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
             reader = ExcelFile(path)
             recons = reader.parse('test1')
             assert_frame_equal(frame, recons)
+            
+            #Test reading/writing np.bool8, roundtrip only works for xlsx
+            frame = (DataFrame(np.random.randn(10,2)) >= 0)
+            frame.to_excel(path,'test1')
+            reader = ExcelFile(path)
+            recons = reader.parse('test1').astype(np.bool8)
+            assert_frame_equal(frame, recons)
 
             # Test writing to separate sheets
             writer = ExcelWriter(path)
@@ -2545,6 +2552,16 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         recons = reader.parse('test1')
         assert_frame_equal(self.tsframe, recons)
         os.remove(path)
+            
+        #Test roundtrip np.bool8, does not seem to work for xls
+        path = '__tmp__.xlsx'
+        frame = (DataFrame(np.random.randn(10,2)) >= 0)
+        frame.to_excel(path,'test1')
+        reader = ExcelFile(path)
+        recons = reader.parse('test1')
+        assert_frame_equal(frame, recons)
+        os.remove(path)
+
 
     def test_to_excel_multiindex(self):
         try:
