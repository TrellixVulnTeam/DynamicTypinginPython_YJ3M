commit 556245e2ce744ff75b2de2dd5b865bacecdafa6d
Author: Christopher Whelan <topherwhelan@gmail.com>
Date:   Sat Jul 20 09:41:01 2019 -0700

    PERF: speed up IntervalIndex._intersection_non_unique by ~50x (#27489)

diff --git a/pandas/core/indexes/interval.py b/pandas/core/indexes/interval.py
index 561cf436c..7372dada3 100644
--- a/pandas/core/indexes/interval.py
+++ b/pandas/core/indexes/interval.py
@@ -1250,15 +1250,9 @@ class IntervalIndex(IntervalMixin, Index):
             first_nan_loc = np.arange(len(self))[self.isna()][0]
             mask[first_nan_loc] = True
 
-        lmiss = other.left.get_indexer_non_unique(self.left)[1]
-        lmatch = np.setdiff1d(np.arange(len(self)), lmiss)
-
-        for i in lmatch:
-            potential = other.left.get_loc(self.left[i])
-            if is_scalar(potential):
-                if self.right[i] == other.right[potential]:
-                    mask[i] = True
-            elif self.right[i] in other.right[potential]:
+        other_tups = set(zip(other.left, other.right))
+        for i, tup in enumerate(zip(self.left, self.right)):
+            if tup in other_tups:
                 mask[i] = True
 
         return self[mask]
