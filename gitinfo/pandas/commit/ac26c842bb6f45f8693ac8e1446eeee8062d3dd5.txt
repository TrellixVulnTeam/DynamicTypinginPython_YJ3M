commit ac26c842bb6f45f8693ac8e1446eeee8062d3dd5
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sat Jan 14 20:27:53 2012 -0500

    BUG: check for non-contiguous memory in SeriesGrouper, causing segfault

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 651b1ace7..0425cd7bb 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -2856,7 +2856,7 @@ class DataFrame(NDFrame):
             other = other.reindex(self.columns, copy=False)
             other = DataFrame(other.values.reshape((1, len(other))),
                               index=index, columns=self.columns)
-        elif isinstance(other, list):
+        elif isinstance(other, list) and not isinstance(other[0], DataFrame):
             other = DataFrame(other)
             if (self.columns.get_indexer(other.columns) >= 0).all():
                 other = other.ix[:, self.columns]
diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index 89de475fc..cfa643241 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -1331,7 +1331,7 @@ def _aggregate_series_fast(obj, func, group_index, ngroups):
         raise TypeError('Incompatible index for Cython grouper')
 
     # avoids object / Series creation overhead
-    dummy = obj[:0]
+    dummy = obj[:0].copy()
     indexer = lib.groupsort_indexer(group_index, ngroups)[0]
     obj = obj.take(indexer)
     group_index = group_index.take(indexer)
diff --git a/pandas/src/reduce.pyx b/pandas/src/reduce.pyx
index 1f4bc3731..6f595adf9 100644
--- a/pandas/src/reduce.pyx
+++ b/pandas/src/reduce.pyx
@@ -106,6 +106,8 @@ cdef class SeriesGrouper:
 
         self.labels = labels
         self.f = f
+        if not series.flags.c_contiguous:
+            series = series.copy('C')
         self.arr = series
         self.index = series.index
 
@@ -119,6 +121,9 @@ cdef class SeriesGrouper:
         else:
             if dummy.dtype != self.arr.dtype:
                 raise ValueError('Dummy array must be same dtype')
+            if not dummy.flags.contiguous:
+                dummy = dummy.copy()
+
         return dummy
 
     def get_result(self):
diff --git a/pandas/tests/test_groupby.py b/pandas/tests/test_groupby.py
index 6ebd9e739..32f489b71 100644
--- a/pandas/tests/test_groupby.py
+++ b/pandas/tests/test_groupby.py
@@ -1230,6 +1230,15 @@ class TestGroupBy(unittest.TestCase):
         del expected[0]
         assert_frame_equal(result, expected)
 
+    def test_cython_grouper_series_bug_noncontig(self):
+        arr = np.empty((100, 100))
+        arr.fill(np.nan)
+        obj = Series(arr[:, 0], index=range(100))
+        inds = np.tile(range(10), 10)
+
+        result = obj.groupby(inds).agg(Series.median)
+        self.assert_(result.isnull().all())
+
 class TestPanelGroupBy(unittest.TestCase):
 
     def setUp(self):
