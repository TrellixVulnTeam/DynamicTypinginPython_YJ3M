commit 6c31cab6cab2dfe5b8e6b9c3f3960c860540f99c
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Fri Feb 3 19:56:59 2012 -0500

    ENH: memoize objects when reading from file to reduce memory footprint

diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index 541db483a..9834bde0c 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -219,7 +219,7 @@ class TextParser(object):
         self.chunksize = chunksize
         self.passed_names = names is not None
         self.encoding = encoding
-        
+
 
         if com.is_integer(skiprows):
             skiprows = range(skiprows)
@@ -281,7 +281,7 @@ class TextParser(object):
                                                     dialect=dia)))
 
             if self.encoding is not None:
-                reader = com.UnicodeReader(f, dialect=dia, 
+                reader = com.UnicodeReader(f, dialect=dia,
                                            encoding=self.encoding)
             else:
                 reader = csv.reader(f, dialect=dia)
diff --git a/pandas/src/inference.pyx b/pandas/src/inference.pyx
index 88bb3314c..7a20d196b 100644
--- a/pandas/src/inference.pyx
+++ b/pandas/src/inference.pyx
@@ -341,6 +341,7 @@ def sanitize_objects(ndarray[object] values, set na_values):
         Py_ssize_t i, n
         object val, onan
         Py_ssize_t na_count = 0
+        dict memo = {}
 
     n = len(values)
     onan = np.nan
@@ -350,6 +351,11 @@ def sanitize_objects(ndarray[object] values, set na_values):
         if val == '' or val in na_values:
             values[i] = onan
             na_count += 1
+        elif val in memo:
+            values[i] = memo[val]
+        else:
+            memo[val] = val
+
     return na_count
 
 def maybe_convert_bool(ndarray[object] arr):
