commit 362db19249babd7b2169884bb7e3d43844776c13
Author: jreback <jeff@reback.net>
Date:   Fri Sep 19 15:02:30 2014 -0400

    PERF: perf fixes

diff --git a/pandas/core/common.py b/pandas/core/common.py
index 8f880cebe..e138668b3 100644
--- a/pandas/core/common.py
+++ b/pandas/core/common.py
@@ -952,7 +952,8 @@ def diff(arr, n, axis=0):
             out_arr[res_indexer] = arr[res_indexer] - arr[lag_indexer]
 
     if is_timedelta:
-        out_arr = lib.map_infer(out_arr.ravel(),lib.Timedelta).reshape(out_arr.shape)
+        from pandas import TimedeltaIndex
+        out_arr = TimedeltaIndex(out_arr.ravel().astype('int64')).asi8.reshape(out_arr.shape).astype('timedelta64[ns]')
 
     return out_arr
 
diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index 350f81069..fb538e7cb 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -2993,8 +2993,9 @@ class NDFrameGroupBy(GroupBy):
              type(result.index) != type(obj.index)) or
             len(result.index) != len(obj.index)):
             results = obj.values.copy()
+            indices = self.indices
             for (name, group), (i, row) in zip(self, result.iterrows()):
-                indexer = self._get_index(name)
+                indexer = indices[name]
                 results[indexer] = np.tile(row.values,len(indexer)).reshape(len(indexer),-1)
             return DataFrame(results,columns=result.columns,index=obj.index).convert_objects()
 
