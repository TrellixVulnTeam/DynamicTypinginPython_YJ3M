commit 4dd1ce086770c2bbea58650408d360916223664b
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Apr 23 13:46:17 2012 -0400

    BUG: squeezing aggregated cython result incorrect logic when ngroups == 1, close #1065

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index df80899f9..b4af5d158 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -652,12 +652,13 @@ class Grouper(object):
 
         comp_ids, _, ngroups = self.group_info
         agg_func = self._cython_functions[how]
-        if values.ndim == 1:
-            squeeze = True
+
+        vdim = values.ndim
+
+        if vdim == 1:
             values = values[:, None]
             out_shape = (ngroups, 1)
         else:
-            squeeze = False
             out_shape = (ngroups, values.shape[1])
 
         trans_func = self._cython_transforms.get(how, lambda x: x)
@@ -672,8 +673,8 @@ class Grouper(object):
         if self._filter_empty_groups:
             result = lib.row_bool_subset(result, counts > 0)
 
-        if squeeze:
-            result = result.squeeze()
+        if vdim == 1:
+            result = result[:, 0]
 
         if how in self._name_functions:
             # TODO
@@ -851,12 +852,11 @@ class BinGrouper(Grouper):
         agg_func = self._cython_functions[how]
         arity = self._cython_arity.get(how, 1)
 
-        if values.ndim == 1:
-            squeeze = True
+        vdim = values.ndim
+        if vdim == 1:
             values = values[:, None]
             out_shape = (self.ngroups, arity)
         else:
-            squeeze = False
             out_shape = (self.ngroups, values.shape[1] * arity)
 
         trans_func = self._cython_transforms.get(how, lambda x: x)
@@ -871,8 +871,8 @@ class BinGrouper(Grouper):
         if self._filter_empty_groups:
             result = lib.row_bool_subset(result, counts > 0)
 
-        if squeeze:
-            result = result.squeeze()
+        if vdim == 1 and arity == 1:
+            result = result[:, 0]
 
         if how in self._name_functions:
             # TODO
diff --git a/pandas/tests/test_groupby.py b/pandas/tests/test_groupby.py
index cc8236ada..de80c7d49 100644
--- a/pandas/tests/test_groupby.py
+++ b/pandas/tests/test_groupby.py
@@ -1667,6 +1667,15 @@ class TestGroupBy(unittest.TestCase):
         expected = exp_grouped.groupby(['A', 'B']).aggregate(func)
         assert_frame_equal(result, expected)
 
+    def test_multifunc_sum_bug(self):
+        # GH #1065
+        x = DataFrame(np.arange(9).reshape(3,3))
+        x['test']=0
+        x['fl']= [1.3,1.5,1.6]
+
+        grouped = x.groupby('test')
+        result = grouped.agg({'fl':'sum',2:'size'})
+        self.assert_(result['fl'].dtype == np.float64)
 
 def _check_groupby(df, result, keys, field, f=lambda x: x.sum()):
     tups = map(tuple, df[keys].values)
