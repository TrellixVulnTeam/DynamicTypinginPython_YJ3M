commit 187de26cf44c5286ab28e65c15fc07e90db686b9
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed Apr 11 12:39:17 2012 -0400

    TST: python 3 fixes

diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index 171b8ffa8..819fbeca7 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -116,6 +116,7 @@ def _is_url(url):
 
 def _read(cls, filepath_or_buffer, kwds):
     "Generic reader of line files."
+    encoding = kwds.get('encoding', None)
 
     if isinstance(filepath_or_buffer, str) and _is_url(filepath_or_buffer):
         from urllib2 import urlopen
@@ -132,7 +133,6 @@ def _read(cls, filepath_or_buffer, kwds):
     if hasattr(filepath_or_buffer, 'read'):
         f = filepath_or_buffer
     else:
-        encoding = kwds.get('encoding', None)
         try:
             # universal newline mode
             f = com._get_handle(filepath_or_buffer, 'U', encoding=encoding)
diff --git a/pandas/io/sql.py b/pandas/io/sql.py
index 82b734e61..9e30ef10f 100644
--- a/pandas/io/sql.py
+++ b/pandas/io/sql.py
@@ -87,7 +87,8 @@ def tquery(sql, con=None, cur=None, retry=True):
                 return tquery(sql, con=con, retry=False)
 
     if result and len(result[0]) == 1:
-        result = list(zip(*result)[0])
+        # python 3 compat
+        result = list(list(zip(*result))[0])
     elif result is None:  # pragma: no cover
         result = []
 
diff --git a/pandas/stats/tests/test_math.py b/pandas/stats/tests/test_math.py
index 6b050129a..90d459ec4 100644
--- a/pandas/stats/tests/test_math.py
+++ b/pandas/stats/tests/test_math.py
@@ -16,6 +16,14 @@ from pandas import ols
 
 N, K = 100, 10
 
+_have_statsmodels = True
+try:
+    import statsmodels.api as sm
+except ImportError:
+    try:
+        import scikits.statsmodels.api as sm
+    except ImportError:
+        _have_statsmodels = False
 
 class TestMath(unittest.TestCase):
 
@@ -39,6 +47,9 @@ class TestMath(unittest.TestCase):
         self.assertEqual(0, pmath.rank(Series(0, self.series.index)))
 
     def test_solve_rect(self):
+        if not _have_statsmodels:
+            raise nose.SkipTest
+
         b = Series(np.random.randn(N), self.frame.index)
         result = pmath.solve(self.frame, b)
         expected = ols(y=b, x=self.frame, intercept=False).beta
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index b3d7216e5..19c610841 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -2140,7 +2140,7 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         df = DataFrame({"col1": [2,5.0,123,None],
                         "col2": [1,2,3,4]})
 
-        ops = [operator.add, operator.sub, operator.mul, operator.div]
+        ops = [operator.add, operator.sub, operator.mul, operator.truediv]
 
         for op in ops:
             filled = df.fillna(np.nan)
