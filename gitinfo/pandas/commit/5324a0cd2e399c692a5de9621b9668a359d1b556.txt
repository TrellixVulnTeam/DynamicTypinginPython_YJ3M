commit 5324a0cd2e399c692a5de9621b9668a359d1b556
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Tue May 31 13:22:09 2011 +0100

    fixed inference of window_type='rolling' in ols when passing window

diff --git a/pandas/stats/common.py b/pandas/stats/common.py
index 25b39e2bb..ef5031120 100644
--- a/pandas/stats/common.py
+++ b/pandas/stats/common.py
@@ -34,6 +34,14 @@ def _get_window_type(window_type):
 
     raise Exception('Unrecognized window type: %s' % window_type)
 
+def _get_window_type_name(window_type):
+    names = {
+        0 : 'full sample',
+        1 : 'rolling',
+        2 : 'expanding'
+    }
+    return names[window_type]
+
 def banner(text, width=80):
     """
 
diff --git a/pandas/stats/interface.py b/pandas/stats/interface.py
index 898d43ade..30bf47b8e 100644
--- a/pandas/stats/interface.py
+++ b/pandas/stats/interface.py
@@ -88,8 +88,12 @@ def ols(**kwargs):
     else:
         window_type = common._get_window_type(window_type)
 
+    if window_type != common.FULL_SAMPLE:
+        kwargs['window_type'] = common._get_window_type_name(window_type)
+
     y = kwargs.get('y')
     if window_type == common.FULL_SAMPLE:
+        # HACK (!)
         for rolling_field in ('window_type', 'window', 'min_periods'):
             if rolling_field in kwargs:
                 del kwargs[rolling_field]
diff --git a/pandas/stats/tests/test_ols.py b/pandas/stats/tests/test_ols.py
index 400b491a1..3833854eb 100644
--- a/pandas/stats/tests/test_ols.py
+++ b/pandas/stats/tests/test_ols.py
@@ -14,7 +14,8 @@ from pandas.core.panel import LongPanel
 from pandas.core.api import DataMatrix, Index, Series
 from pandas.stats.api import ols
 from pandas.stats.plm import NonPooledPanelOLS
-from pandas.util.testing import assert_almost_equal
+from pandas.util.testing import (assert_almost_equal, assert_frame_equal)
+import pandas.util.testing as testing
 
 from common import BaseTest
 
@@ -460,6 +461,16 @@ class TestPanelOLS(BaseTest):
 
             assert_almost_equal(ref, res)
 
+    def test_auto_rolling_window_type(self):
+        data = testing.makeTimeDataFrame()
+        y = data.pop('A')
+
+        window_model = ols(y=y, x=data, window=20, min_periods=10)
+        rolling_model = ols(y=y, x=data, window=20, min_periods=10,
+                            window_type='rolling')
+
+        assert_frame_equal(window_model.beta, rolling_model.beta)
+
 def _check_non_raw_results(model):
     _check_repr(model)
     _check_repr(model.resid)
@@ -476,4 +487,6 @@ def _period_slice(panelModel, i):
     return slice(L, R)
 
 if __name__ == '__main__':
-    unittest.main()
+    import nose
+    nose.runmodule(argv=[__file__,'-vvs','-x','--pdb', '--pdb-failure'],
+                   exit=False)
