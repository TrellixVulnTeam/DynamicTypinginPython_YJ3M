commit fa42a6a8219d2fd6505e33adc96295a40a75e8fd
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sat Jul 16 19:06:04 2011 -0400

    FIX: critical bug fix in block formation

diff --git a/pandas/core/common.py b/pandas/core/common.py
index 666e7abcd..c734d950e 100644
--- a/pandas/core/common.py
+++ b/pandas/core/common.py
@@ -161,6 +161,11 @@ def set_printoptions(precision=None, column_space=None):
     if column_space is not None:
         _column_space = column_space
 
+def _get_float_formatter():
+    options = np.get_printoptions()
+
+
+
 def _pfixed(s, space, nanRep=None, float_format=None):
     if isinstance(s, float):
         if nanRep is not None and isnull(s):
diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 2a6f1f49a..58aa1c8a5 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -22,7 +22,8 @@ from numpy import nan
 import numpy as np
 
 from pandas.core.common import (isnull, notnull, PandasError, _ensure_index,
-                                _try_sort, _pfixed, _default_index, _infer_dtype)
+                                _try_sort, _pfixed, _default_index,
+                                _infer_dtype)
 from pandas.core.daterange import DateRange
 from pandas.core.generic import AxisProperty, PandasGeneric
 from pandas.core.index import Index, NULL_INDEX
diff --git a/pandas/core/internals.py b/pandas/core/internals.py
index 377ed8d61..5cdbac9a5 100644
--- a/pandas/core/internals.py
+++ b/pandas/core/internals.py
@@ -720,15 +720,15 @@ def form_blocks(data, index, items):
     return blocks, items
 
 def _simple_blockify(dct, ref_items, dtype):
-    block_items, values = _stack_dict(dct)
+    block_items, values = _stack_dict(dct, ref_items)
     # CHECK DTYPE?
     if values.dtype != dtype: # pragma: no cover
         values = values.astype(dtype)
 
     return make_block(values, block_items, ref_items)
 
-def _stack_dict(dct):
-    items = Index(_try_sort(dct))
+def _stack_dict(dct, ref_items):
+    items = [x for x in ref_items if x in dct]
     stacked = np.vstack([dct[k].values for k in items])
     return items, stacked
 
diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index 59402023e..06f39f2cc 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -210,10 +210,14 @@ def _convert_to_ndarrays(dct):
     for c, values in dct.iteritems():
         try:
             values = np.array(values, dtype=float)
-            values = _maybe_convert_int(values)
         except Exception:
             values = np.array(values, dtype=object)
 
+        try:
+            values = _maybe_convert_int(values)
+        except ValueError:
+            pass
+
         result[c] = values
 
     return result
