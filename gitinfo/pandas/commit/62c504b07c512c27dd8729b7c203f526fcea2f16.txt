commit 62c504b07c512c27dd8729b7c203f526fcea2f16
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Jan 2 16:29:46 2012 -0500

    BUG: fix C skiplist memory leak, use in rolling median, GH #374

diff --git a/RELEASE.rst b/RELEASE.rst
index ac43ae7ab..6cb8bccf9 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -86,6 +86,8 @@ pandas 0.7.0
     regular (non-hierarchical) index (GH #476)
   - Use Cythonized groupers when possible in Series/DataFrame stat ops with
     ``level`` parameter passed (GH #545)
+  - Ported skiplist data structure to C to speed up ``rolling_median`` by about
+    5-10x in most typical use cases (GH #374)
 
 **Bug fixes**
 
diff --git a/pandas/src/skiplist.h b/pandas/src/skiplist.h
index 3fe1fc70c..9f26d8416 100644
--- a/pandas/src/skiplist.h
+++ b/pandas/src/skiplist.h
@@ -90,12 +90,12 @@ static void node_destroy(node_t *node) {
       free(node->next);
       free(node->width);
       // printf("Reference count was 1, freeing\n");
+      free(node);
     }
     else {
       node_decref(node);
     }
     // pretty sure that freeing the struct above will be enough
-    // free(node);
   }
 }
 
diff --git a/pandas/stats/moments.py b/pandas/stats/moments.py
index 93b99474e..7d626d447 100644
--- a/pandas/stats/moments.py
+++ b/pandas/stats/moments.py
@@ -391,7 +391,7 @@ rolling_max = _rolling_func(_tseries.roll_max, 'Moving maximum')
 rolling_min = _rolling_func(_tseries.roll_min, 'Moving minimum')
 rolling_sum = _rolling_func(_tseries.roll_sum, 'Moving sum')
 rolling_mean = _rolling_func(_tseries.roll_mean, 'Moving mean')
-rolling_median = _rolling_func(_tseries.roll_median_cython, 'Moving median')
+rolling_median = _rolling_func(_tseries.roll_median_c, 'Moving median')
 
 _ts_std = lambda *a, **kw: np.sqrt(_tseries.roll_var(*a, **kw))
 rolling_std = _rolling_func(_ts_std, 'Unbiased moving standard deviation',
