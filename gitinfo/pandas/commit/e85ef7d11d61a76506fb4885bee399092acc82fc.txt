commit e85ef7d11d61a76506fb4885bee399092acc82fc
Author: Andy Hayden <andyhayden1@gmail.com>
Date:   Wed Sep 4 01:13:30 2013 +0100

    CLN refactor with _apply_to_column_groupbys

diff --git a/pandas/core/groupby.py b/pandas/core/groupby.py
index 5e86d0816..0a39b83d3 100644
--- a/pandas/core/groupby.py
+++ b/pandas/core/groupby.py
@@ -430,13 +430,6 @@ class GroupBy(PandasObject):
 
         For multiple groupings, the result index will be a MultiIndex
         """
-        if isinstance(self.obj, com.ABCDataFrame):
-            from pandas.tools.merge import concat
-            return concat((col_groupby._cython_agg_general('ohlc')
-                                for _, col_groupby in self._iterate_column_groupbys()),
-                            keys=self.obj.columns,
-                            axis=1)
-
         return self._cython_agg_general('ohlc')
 
     def nth(self, n):
@@ -2245,6 +2238,20 @@ class DataFrameGroupBy(NDFrameGroupBy):
                                          grouper=self.grouper,
                                          exclusions=self.exclusions)
 
+    def _apply_to_column_groupbys(self, func):
+        from pandas.tools.merge import concat
+        return concat((func(col_groupby)
+                            for _, col_groupby in self._iterate_column_groupbys()),
+                        keys=self.obj.columns,
+                        axis=1)
+
+    def ohlc(self):
+        """
+        Compute sum of values, excluding missing values
+
+        For multiple groupings, the result index will be a MultiIndex
+        """
+        return self._apply_to_column_groupbys(lambda x: x._cython_agg_general('ohlc'))
 
 from pandas.tools.plotting import boxplot_frame_groupby
 DataFrameGroupBy.boxplot = boxplot_frame_groupby
