commit c6c0b8e59d524e275ededa2d03c95d5d3a7bb681
Author: jreback <jeff@reback.net>
Date:   Wed May 15 20:56:48 2013 -0400

    BUG: (GH3617) Fix indexing issue with ndim >= 3 with iloc

diff --git a/RELEASE.rst b/RELEASE.rst
index 503ae0e6b..75d46dd98 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -120,6 +120,7 @@ pandas 0.11.1
   - Fix incorrect dtype on groupby with ``as_index=False`` (GH3610_)
   - Fix ``read_csv`` to correctly encode identical na_values, e.g. ``na_values=[-999.0,-999]``
     was failing (GH3611_)
+  - Fix indexing issue in ndim >= 3 with ``iloc`` (GH3617_)
 
 .. _GH3164: https://github.com/pydata/pandas/issues/3164
 .. _GH2786: https://github.com/pydata/pandas/issues/2786
@@ -167,6 +168,7 @@ pandas 0.11.1
 .. _GH3590: https://github.com/pydata/pandas/issues/3590
 .. _GH3610: https://github.com/pydata/pandas/issues/3610
 .. _GH3596: https://github.com/pydata/pandas/issues/3596
+.. _GH3617: https://github.com/pydata/pandas/issues/3617
 .. _GH3435: https://github.com/pydata/pandas/issues/3435
 .. _GH3611: https://github.com/pydata/pandas/issues/3611
 
diff --git a/pandas/core/indexing.py b/pandas/core/indexing.py
index 29adce4e0..8b684b621 100644
--- a/pandas/core/indexing.py
+++ b/pandas/core/indexing.py
@@ -778,8 +778,16 @@ class _iLocIndexer(_LocationIndexer):
     def _getitem_tuple(self, tup):
 
         self._has_valid_tuple(tup)
+        try:
+            return self._getitem_lowerdim(tup)
+        except:
+            pass
+
         retval = self.obj
         for i, key in enumerate(tup):
+            if i >= self.obj.ndim:
+                raise IndexingError('Too many indexers')
+
             if _is_null_slice(key):
                 continue
 
diff --git a/pandas/core/panel.py b/pandas/core/panel.py
index 44b62991c..3f090b273 100644
--- a/pandas/core/panel.py
+++ b/pandas/core/panel.py
@@ -326,7 +326,7 @@ class Panel(NDFrame):
 
     @property
     def shape(self):
-        return [len(getattr(self, a)) for a in self._AXIS_ORDERS]
+        return tuple([len(getattr(self, a)) for a in self._AXIS_ORDERS])
 
     @classmethod
     def from_dict(cls, data, intersect=False, orient='items', dtype=None):
diff --git a/pandas/tests/test_indexing.py b/pandas/tests/test_indexing.py
index 46fd98fc1..65e7516d4 100644
--- a/pandas/tests/test_indexing.py
+++ b/pandas/tests/test_indexing.py
@@ -840,6 +840,19 @@ class TestIndexing(unittest.TestCase):
         result = df.set_index(['year','PRuid','QC']).reset_index().reindex(columns=df.columns)
         assert_frame_equal(result,df)
 
+    def test_iloc_panel_issue(self):
+
+        # GH 3617
+        p = Panel(randn(4, 4, 4))
+
+        self.assert_(p.iloc[:3, :3, :3].shape == (3,3,3))
+        self.assert_(p.iloc[1, :3, :3].shape == (3,3))
+        self.assert_(p.iloc[:3, 1, :3].shape == (3,3))
+        self.assert_(p.iloc[:3, :3, 1].shape == (3,3))
+        self.assert_(p.iloc[1, 1, :3].shape == (3,))
+        self.assert_(p.iloc[1, :3, 1].shape == (3,))
+        self.assert_(p.iloc[:3, 1, 1].shape == (3,))
+      
 
 if __name__ == '__main__':
     import nose
