commit c8229c4264bddf08a0dc2a467c8ba38ee879972f
Author: Jeff Reback <jeff@reback.net>
Date:   Sat Jan 16 22:26:37 2016 -0500

    CI: remove pydata 2.7 test build
    change 2.7 numpy_dev build to use wheels
    remove need for BUILD_TYPE, all builds are now conda

diff --git a/.travis.yml b/.travis.yml
index 959a1f7e1..049a5c056 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -42,7 +42,6 @@ matrix:
       - NOSE_ARGS="not slow and not disabled"
       - FULL_DEPS=true
       - CLIPBOARD_GUI=gtk2
-      - BUILD_TYPE=conda
       - DOC_BUILD=true # if rst files were changed, build docs in parallel with tests
     - python: 3.4
       env:
@@ -57,14 +56,12 @@ matrix:
       - NOSE_ARGS="not slow and not network and not disabled"
       - FULL_DEPS=true
       - CLIPBOARD=xsel
-      - BUILD_TYPE=conda
     - python: 2.7
       env:
       - JOB_NAME: "27_slow"
       - JOB_TAG=_SLOW
       - NOSE_ARGS="slow and not network and not disabled"
       - FULL_DEPS=true
-      - BUILD_TYPE=conda
     - python: 3.4
       env:
       - JOB_NAME: "34_slow"
@@ -72,37 +69,24 @@ matrix:
       - NOSE_ARGS="slow and not network and not disabled"
       - FULL_DEPS=true
       - CLIPBOARD=xsel
-      - BUILD_TYPE=conda
     - python: 2.7
       env:
       - JOB_NAME: "27_build_test_conda"
       - JOB_TAG=_BUILD_TEST
       - NOSE_ARGS="not slow and not disabled"
       - FULL_DEPS=true
-      - BUILD_TYPE=conda
-      - BUILD_TEST=true
-    - python: 2.7
-      env:
-      - JOB_NAME: "27_build_test_pydata"
-      - JOB_TAG=_BUILD_TEST
-      - NOSE_ARGS="not slow and not disabled"
-      - FULL_DEPS=true
-      - BUILD_TYPE=pydata
       - BUILD_TEST=true
     - python: 2.7
       env:
-      - JOB_NAME: "27_numpy_master"
-      - JOB_TAG=_NUMPY_DEV_master
+      - JOB_NAME: "27_numpy_dev"
+      - JOB_TAG=_NUMPY_DEV
       - NOSE_ARGS="not slow and not network and not disabled"
-      - NUMPY_BUILD=master
-      - BUILD_TYPE=pydata
       - PANDAS_TESTING_MODE="deprecate"
     - python: 3.5
       env:
       - JOB_NAME: "35_numpy_dev"
       - JOB_TAG=_NUMPY_DEV
       - NOSE_ARGS="not slow and not network and not disabled"
-      - BUILD_TYPE=conda
       - PANDAS_TESTING_MODE="deprecate"
     allow_failures:
       - python: 2.7
@@ -111,7 +95,6 @@ matrix:
         - JOB_TAG=_SLOW
         - NOSE_ARGS="slow and not network and not disabled"
         - FULL_DEPS=true
-        - BUILD_TYPE=conda
       - python: 3.4
         env:
         - JOB_NAME: "34_slow"
@@ -119,14 +102,11 @@ matrix:
         - NOSE_ARGS="slow and not network and not disabled"
         - FULL_DEPS=true
         - CLIPBOARD=xsel
-        - BUILD_TYPE=conda
       - python: 2.7
         env:
-        - JOB_NAME: "27_numpy_master"
-        - JOB_TAG=_NUMPY_DEV_master
+        - JOB_NAME: "27_numpy_dev"
+        - JOB_TAG=_NUMPY_DEV
         - NOSE_ARGS="not slow and not network and not disabled"
-        - NUMPY_BUILD=master
-        - BUILD_TYPE=pydata
         - PANDAS_TESTING_MODE="deprecate"
       - python: 2.7
         env:
@@ -134,22 +114,12 @@ matrix:
         - JOB_TAG=_BUILD_TEST
         - NOSE_ARGS="not slow and not disabled"
         - FULL_DEPS=true
-        - BUILD_TYPE=conda
-        - BUILD_TEST=true
-      - python: 2.7
-        env:
-        - JOB_NAME: "27_build_test_pydata"
-        - JOB_TAG=_BUILD_TEST
-        - NOSE_ARGS="not slow and not disabled"
-        - FULL_DEPS=true
-        - BUILD_TYPE=pydata
         - BUILD_TEST=true
       - python: 3.5
         env:
         - JOB_NAME: "35_numpy_dev"
         - JOB_TAG=_NUMPY_DEV
         - NOSE_ARGS="not slow and not network and not disabled"
-        - BUILD_TYPE=conda
         - PANDAS_TESTING_MODE="deprecate"
 
 before_install:
@@ -162,7 +132,7 @@ before_install:
   - pwd
   - uname -a
   - python -V
-  - ci/before_install.sh
+  - ci/before_install_travis.sh
   # Xvfb stuff for clipboard functionality; see the travis-ci documentation
   - export DISPLAY=:99.0
   - sh -e /etc/init.d/xvfb start
@@ -170,7 +140,7 @@ before_install:
 install:
   - echo "install"
   - ci/prep_ccache.sh
-  - ci/install_${BUILD_TYPE}.sh
+  - ci/install_travis.sh
   - ci/submit_ccache.sh
 
 before_script:
diff --git a/ci/before_install.sh b/ci/before_install_travis.sh
similarity index 100%
rename from ci/before_install.sh
rename to ci/before_install_travis.sh
diff --git a/ci/install-2.7_NUMPY_DEV.sh b/ci/install-2.7_NUMPY_DEV.sh
new file mode 100644
index 000000000..00b6255da
--- /dev/null
+++ b/ci/install-2.7_NUMPY_DEV.sh
@@ -0,0 +1,20 @@
+#!/bin/bash
+
+source activate pandas
+
+echo "install numpy master wheel"
+
+# remove the system installed numpy
+pip uninstall numpy -y
+
+# we need these for numpy
+
+# these wheels don't play nice with the conda libgfortran / openblas
+# time conda install -n pandas libgfortran openblas || exit 1
+
+time sudo apt-get $APT_ARGS install libatlas-base-dev gfortran
+
+# install numpy wheel from master
+pip install --pre --upgrade --no-index --timeout=60 --trusted-host travis-dev-wheels.scipy.org -f http://travis-dev-wheels.scipy.org/ numpy
+
+true
diff --git a/ci/install_pydata.sh b/ci/install_pydata.sh
deleted file mode 100755
index 667b57897..000000000
--- a/ci/install_pydata.sh
+++ /dev/null
@@ -1,159 +0,0 @@
-#!/bin/bash
-
-# There are 2 distinct pieces that get zipped and cached
-# - The venv site-packages dir including the installed dependencies
-# - The pandas build artifacts, using the build cache support via
-#   scripts/use_build_cache.py
-#
-# if the user opted in to use the cache and we're on a whitelisted fork
-# - if the server doesn't hold a cached version of venv/pandas build,
-#   do things the slow way, and put the results on the cache server
-#   for the next time.
-# -  if the cache files are available, instal some necessaries via apt
-#    (no compiling needed), then directly goto script and collect 200$.
-#
-
-function edit_init()
-{
-    if [ -n "$LOCALE_OVERRIDE" ]; then
-        echo "Adding locale to the first line of pandas/__init__.py"
-        rm -f pandas/__init__.pyc
-        sedc="3iimport locale\nlocale.setlocale(locale.LC_ALL, '$LOCALE_OVERRIDE')\n"
-        sed -i "$sedc" pandas/__init__.py
-        echo "head -4 pandas/__init__.py"
-        head -4 pandas/__init__.py
-        echo
-    fi
-}
-
-edit_init
-
-python_major_version="${TRAVIS_PYTHON_VERSION:0:1}"
-[ "$python_major_version" == "2" ] && python_major_version=""
-
-home_dir=$(pwd)
-echo "home_dir: [$home_dir]"
-
-# known working
-# pip==1.5.1
-# setuptools==2.2
-# wheel==0.22
-# nose==1.3.3
-
-pip install -I -U pip
-pip install -I -U setuptools
-pip install wheel==0.22
-#pip install nose==1.3.3
-pip install nose==1.3.4
-
-# comment this line to disable the fetching of wheel files
-base_url=http://pandas.pydata.org/pandas-build/dev/wheels
-
-wheel_box=${TRAVIS_PYTHON_VERSION}${JOB_TAG}
-PIP_ARGS+=" -I --use-wheel --find-links=$base_url/$wheel_box/ --allow-external --allow-insecure"
-
-if [ -n "$LOCALE_OVERRIDE" ]; then
-    # make sure the locale is available
-    # probably useless, since you would need to relogin
-    time sudo locale-gen "$LOCALE_OVERRIDE"
-fi
-
-# we need these for numpy
-time sudo apt-get $APT_ARGS install libatlas-base-dev gfortran
-
-if [ -n "$NUMPY_BUILD" ]; then
-    # building numpy
-
-    cd $home_dir
-    echo "cloning numpy"
-
-    rm -Rf /tmp/numpy
-    cd /tmp
-
-    # remove the system installed numpy
-    pip uninstall numpy -y
-
-    # install cython
-    pip install --find-links http://wheels.astropy.org/ --find-links http://wheels2.astropy.org/ --use-wheel Cython
-
-    # clone & install
-    git clone --branch $NUMPY_BUILD https://github.com/numpy/numpy.git numpy
-    cd numpy
-    time pip install .
-    pip uninstall cython -y
-
-    cd $home_dir
-    numpy_version=$(python -c 'import numpy; print(numpy.__version__)')
-    echo "[$home_dir] numpy current: $numpy_version"
-fi
-
-# Force virtualenv to accept system_site_packages
-rm -f $VIRTUAL_ENV/lib/python$TRAVIS_PYTHON_VERSION/no-global-site-packages.txt
-
-# build deps
-time pip install $PIP_ARGS -r ci/requirements-${wheel_box}.build
-
-# Need to enable for locale testing. The location of the locale file(s) is
-# distro specific. For example, on Arch Linux all of the locales are in a
-# commented file--/etc/locale.gen--that must be commented in to be used
-# whereas Ubuntu looks in /var/lib/locales/supported.d/* and generates locales
-# based on what's in the files in that folder
-time echo 'it_CH.UTF-8 UTF-8' | sudo tee -a /var/lib/locales/supported.d/it
-time sudo locale-gen
-
-
-# install gui for clipboard testing
-if [ -n "$CLIPBOARD_GUI" ]; then
-    echo "Using CLIPBOARD_GUI: $CLIPBOARD_GUI"
-    [ -n "$python_major_version" ] && py="py"
-    python_cb_gui_pkg=python${python_major_version}-${py}${CLIPBOARD_GUI}
-    time sudo apt-get $APT_ARGS install $python_cb_gui_pkg
-fi
-
-
-# install a clipboard if $CLIPBOARD is not empty
-if [ -n "$CLIPBOARD" ]; then
-    echo "Using clipboard: $CLIPBOARD"
-    time sudo apt-get $APT_ARGS install $CLIPBOARD
-fi
-
-
-# Optional Deps
-if [ -n "$FULL_DEPS" ]; then
-    echo "Installing FULL_DEPS"
-
-    # need libhdf5 for PyTables
-    time sudo apt-get $APT_ARGS install libhdf5-serial-dev
-fi
-
-
-# set the compiler cache to work
-if [ "$IRON_TOKEN" ]; then
-    export PATH=/usr/lib/ccache:/usr/lib64/ccache:$PATH
-    gcc=$(which gcc)
-    echo "gcc: $gcc"
-    ccache=$(which ccache)
-    echo "ccache: $ccache"
-    export CC='ccache gcc'
-fi
-
-# build pandas
-if [ "$BUILD_TEST" ]; then
-    pip uninstall --yes cython
-    pip install cython==0.15.1
-    ( python setup.py build_ext --inplace ) || true
-    ( python setup.py develop ) || true
-else
-    python setup.py build_ext --inplace
-    python setup.py develop
-fi
-
-# install the run libs
-time pip install $PIP_ARGS -r ci/requirements-${wheel_box}.run
-
-# restore cython (if not numpy building)
-if [ -z "$NUMPY_BUILD" ]; then
-    time pip install $PIP_ARGS  $(cat ci/requirements-${wheel_box}.txt | grep -i cython)
-fi
-
-true
diff --git a/ci/install_conda.sh b/ci/install_travis.sh
similarity index 100%
rename from ci/install_conda.sh
rename to ci/install_travis.sh
diff --git a/ci/requirements-2.7_NUMPY_DEV_master.build b/ci/requirements-2.7_NUMPY_DEV.build
similarity index 58%
rename from ci/requirements-2.7_NUMPY_DEV_master.build
rename to ci/requirements-2.7_NUMPY_DEV.build
index 7d1d11daf..d15edbfa3 100644
--- a/ci/requirements-2.7_NUMPY_DEV_master.build
+++ b/ci/requirements-2.7_NUMPY_DEV.build
@@ -1,3 +1,3 @@
 python-dateutil
 pytz
-cython==0.19.1
+cython
diff --git a/ci/requirements-2.7_NUMPY_DEV.run b/ci/requirements-2.7_NUMPY_DEV.run
new file mode 100644
index 000000000..0aa987bae
--- /dev/null
+++ b/ci/requirements-2.7_NUMPY_DEV.run
@@ -0,0 +1,2 @@
+python-dateutil
+pytz
diff --git a/ci/requirements-2.7_NUMPY_DEV_master.run b/ci/requirements-2.7_NUMPY_DEV_master.run
deleted file mode 100644
index e69de29bb..000000000
