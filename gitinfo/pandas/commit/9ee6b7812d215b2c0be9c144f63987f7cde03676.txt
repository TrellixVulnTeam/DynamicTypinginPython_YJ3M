commit 9ee6b7812d215b2c0be9c144f63987f7cde03676
Author: Chang She <chang@lambdafoundry.com>
Date:   Fri May 25 15:54:31 2012 -0400

    TST: non-unique monotonic index join

diff --git a/pandas/tests/test_index.py b/pandas/tests/test_index.py
index 48750b3f3..4fa40a047 100644
--- a/pandas/tests/test_index.py
+++ b/pandas/tests/test_index.py
@@ -640,6 +640,17 @@ class TestInt64Index(unittest.TestCase):
         self.assert_(lidx is None)
         self.assert_(np.array_equal(ridx, eridx))
 
+        # non-unique
+        idx = Index([1,1,2,5])
+        idx2 = Index([1,2,5,7,9])
+        res, lidx, ridx = idx2.join(idx, how='left', return_indexers=True)
+        eres = idx2
+        eridx = np.array([0, 2, 3, -1, -1])
+        elidx = np.array([0, 1, 2, 3, 4])
+        self.assert_(res.equals(eres))
+        self.assert_(np.array_equal(lidx, elidx))
+        self.assert_(np.array_equal(ridx, eridx))
+
     def test_join_right(self):
         other = Int64Index([7, 12, 25, 1, 2, 5])
         other_mono = Int64Index([1, 2, 5, 7, 12, 25])
@@ -667,6 +678,17 @@ class TestInt64Index(unittest.TestCase):
         self.assert_(np.array_equal(lidx, elidx))
         self.assert_(ridx is None)
 
+        # non-unique
+        idx = Index([1,1,2,5])
+        idx2 = Index([1,2,5,7,9])
+        res, lidx, ridx = idx.join(idx2, how='right', return_indexers=True)
+        eres = idx2
+        elidx = np.array([0, 2, 3, -1, -1])
+        eridx = np.array([0, 1, 2, 3, 4])
+        self.assert_(res.equals(eres))
+        self.assert_(np.array_equal(lidx, elidx))
+        self.assert_(np.array_equal(ridx, eridx))
+
     def test_join_non_int_index(self):
         other = Index([3, 6, 7, 8, 10], dtype=object)
 
