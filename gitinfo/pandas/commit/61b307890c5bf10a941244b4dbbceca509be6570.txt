commit 61b307890c5bf10a941244b4dbbceca509be6570
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Tue Dec 27 17:07:58 2011 -0500

    TST: vb for Index.intersection/union

diff --git a/pandas/src/internals.pyx b/pandas/src/internals.pyx
new file mode 100644
index 000000000..d8a262398
--- /dev/null
+++ b/pandas/src/internals.pyx
@@ -0,0 +1,13 @@
+def get_reverse_indexer(ndarray[int32_t] indexer, Py_ssize_t length):
+    cdef:
+        Py_ssize_t i
+        ndarray[int32_t] rev_indexer
+        int32_t idx
+
+    rev_indexer = np.empty(length, dtype='i4')
+    for i in range(len(indexer)):
+        idx = indexer[i]
+        if idx != -1:
+            rev_indexer[idx] = i
+
+    return rev_indexer
diff --git a/vb_suite/index_object.py b/vb_suite/index_object.py
index 9e481d5a5..3df763133 100644
--- a/vb_suite/index_object.py
+++ b/vb_suite/index_object.py
@@ -3,3 +3,20 @@ from datetime import datetime
 
 SECTION = "Index / MultiIndex objects"
 
+
+common_setup = """from pandas_vb_common import *
+"""
+
+#----------------------------------------------------------------------
+# intersection, union
+
+setup = common_setup + """
+rng = DateRange('1/1/2000', periods=10000, offset=datetools.Minute())
+rng = rng.view(Index)
+rng2 = rng[:-1]
+"""
+
+index_datetime_intersection = Benchmark("rng.intersection(rng2)", setup,
+                                        name='index_datetime_intersection')
+index_datetime_union = Benchmark("rng.union(rng2)", setup,
+                                 name='index_datetime_union')
