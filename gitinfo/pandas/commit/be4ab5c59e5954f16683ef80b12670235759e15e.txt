commit be4ab5c59e5954f16683ef80b12670235759e15e
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Fri Oct 7 15:17:48 2011 -0400

    BUG: raise more helpful exception when trying to write empty object to HDFStore, address GH #204

diff --git a/RELEASE.rst b/RELEASE.rst
index 07214a206..b2adbba5e 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -23,6 +23,10 @@ pandas 0.4.3
   - `MultiIndex.sortlevel` discarded the level names (GH #202)
   - Fix bugs in groupby, join, and append due to improper concatenation of
     `MultiIndex` objets (GH #201)
+  - Fix regression from 0.4.1, `isnull` and `notnull` ceased to work on other
+    kinds of Python scalar objects like `datetime.datetime`
+  - Raise more helpful exception when attempting to write empty DataFrame or
+    LongPanel to `HDFStore`
 
 pandas 0.4.2
 ============
diff --git a/pandas/io/pytables.py b/pandas/io/pytables.py
index 4f9a433ed..436e61d70 100644
--- a/pandas/io/pytables.py
+++ b/pandas/io/pytables.py
@@ -403,6 +403,9 @@ class HDFStore(object):
         return self._read_panel_table(group, where)
 
     def _write_long(self, group, panel, append=False):
+        if len(panel.values) == 0:
+            raise ValueError('Can not write empty structure, data length was 0')
+
         self._write_index(group, 'major_axis', panel.major_axis)
         self._write_index(group, 'minor_axis', panel.minor_axis)
         self._write_index(group, 'items', panel.items)
@@ -425,6 +428,9 @@ class HDFStore(object):
         return LongPanel(values, index=index, columns=items)
 
     def _write_index(self, group, key, index):
+        if len(index) == 0:
+            raise ValueError('Can not write empty structure, axis length was 0')
+
         if isinstance(index, MultiIndex):
             setattr(group._v_attrs, '%s_variety' % key, 'multi')
             self._write_multi_index(group, key, index)
diff --git a/pandas/io/tests/test_pytables.py b/pandas/io/tests/test_pytables.py
index 564f71f95..ee470d593 100644
--- a/pandas/io/tests/test_pytables.py
+++ b/pandas/io/tests/test_pytables.py
@@ -210,6 +210,10 @@ class TesttHDFStore(unittest.TestCase):
         recons = self.store['df']
         self.assert_(recons._data.is_consolidated())
 
+        # empty
+        self.assertRaises(ValueError, self._check_roundtrip, df[:0],
+                          tm.assert_frame_equal)
+
     def test_store_hierarchical(self):
         index = MultiIndex(levels=[['foo', 'bar', 'baz', 'qux'],
                                    ['one', 'two', 'three']],
@@ -303,6 +307,10 @@ class TesttHDFStore(unittest.TestCase):
         wp = tm.makePanel()
         self._check_roundtrip(wp.to_long(), _check)
 
+        # empty
+        self.assertRaises(ValueError, self._check_roundtrip, wp.to_long()[:0],
+                          _check)
+
     def test_longpanel(self):
         pass
 
