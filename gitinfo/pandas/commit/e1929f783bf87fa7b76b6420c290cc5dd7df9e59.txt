commit e1929f783bf87fa7b76b6420c290cc5dd7df9e59
Author: y-p <yoval@gmx.com>
Date:   Thu Jan 10 20:15:09 2013 +0200

    BLD: add a travis build with non utf8 locale, catch encoding issues
    
    zh_CN.GB18030 (simplified chinese, superceding cp936) should
    be exotic enough to bring out issues of this sort. #2666

diff --git a/.travis.yml b/.travis.yml
index e7ace279f..13c9ee226 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -15,6 +15,8 @@ matrix:
   include:
     - python: 2.7
       env: VBENCH=true
+    - python: 2.7
+      env: LOCALE_OVERRIDE="zh_CN.GB18030"  # simplified chinese
     - python: 2.7
       env: FULL_DEPS=true
     - python: 3.2
diff --git a/ci/install.sh b/ci/install.sh
index 6874da698..3e90e5f65 100755
--- a/ci/install.sh
+++ b/ci/install.sh
@@ -67,3 +67,8 @@ if [ x"$FULL_DEPS" == x"true" ]; then
     # pick recent 0.5dev dec/2012
     pip install git+git://github.com/statsmodels/statsmodels@c9062e43b8a5f7385537ca95#egg=statsmodels
 fi;
+
+# make sure the desired locale is generated
+if [ x"$LOCALE_OVERRIDE" != x"" ]; then
+    sudo locale-gen "$LOCALE_OVERRIDE"
+fi
diff --git a/ci/script.sh b/ci/script.sh
index 28be485de..c405299b1 100755
--- a/ci/script.sh
+++ b/ci/script.sh
@@ -2,10 +2,17 @@
 
 echo "inside $0"
 
+if [ x"$LOCALE_OVERRIDE" != x"" ]; then
+    export LC_ALL="$LOCALE_OVERRIDE";
+    echo "Setting LC_ALL to $LOCALE_OVERRIDE"
+    (cd /; python -c 'import pandas; print("pandas detected console encoding: %s" % pandas.get_option("display.encoding"))')
+fi
+
 if [ x"$VBENCH" != x"true" ]; then
     nosetests --exe -w /tmp -A "not slow" pandas;
     exit
 fi
+
 if [ x"$VBENCH" == x"true" ]; then
     python vb_suite/perf_HEAD.py;
     exit
