commit e5c3907bd68b2817660f6e3bf3b3386ff640d1cf
Author: ganevgv <ganevgv@users.noreply.github.com>
Date:   Wed Nov 13 01:48:01 2019 +0000

    TST: add test for .loc indexing Index type preservation (#29533)

diff --git a/pandas/tests/frame/test_indexing.py b/pandas/tests/frame/test_indexing.py
index e215c90d2..61bf91d30 100644
--- a/pandas/tests/frame/test_indexing.py
+++ b/pandas/tests/frame/test_indexing.py
@@ -3856,3 +3856,28 @@ class TestDataFrameIndexingCategorical:
             df["group"] = pd.cut(
                 df.value, range(0, 105, 10), right=False, labels=labels
             )
+
+    def test_loc_indexing_preserves_index_category_dtype(self):
+        # GH 15166
+        df = DataFrame(
+            data=np.arange(2, 22, 2),
+            index=pd.MultiIndex(
+                levels=[pd.CategoricalIndex(["a", "b"]), range(10)],
+                codes=[[0] * 5 + [1] * 5, range(10)],
+                names=["Index1", "Index2"],
+            ),
+        )
+
+        expected = pd.CategoricalIndex(
+            ["a", "b"],
+            categories=["a", "b"],
+            ordered=False,
+            name="Index1",
+            dtype="category",
+        )
+
+        result = df.index.levels[0]
+        tm.assert_index_equal(result, expected)
+
+        result = df.loc[["a"]].index.levels[0]
+        tm.assert_index_equal(result, expected)
