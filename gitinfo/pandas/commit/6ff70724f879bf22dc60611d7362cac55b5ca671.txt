commit 6ff70724f879bf22dc60611d7362cac55b5ca671
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed Dec 2 19:06:38 2009 +0000

    reverted map_indices from buffer version, for now
    
    git-svn-id: http://pandas.googlecode.com/svn/trunk@64 d5231056-7de3-11de-ac95-d976489f1ece

diff --git a/pandas/lib/include/numpy.pxi b/pandas/lib/include/numpy.pxi
deleted file mode 100644
index 6fcb9d2da..000000000
--- a/pandas/lib/include/numpy.pxi
+++ /dev/null
@@ -1,150 +0,0 @@
-# :Author:    Travis Oliphant
-
-cdef extern from "numpy/arrayobject.h":
-
-	cdef enum NPY_TYPES:
-		NPY_BOOL
-		NPY_BYTE
-		NPY_UBYTE
-		NPY_SHORT
-		NPY_USHORT
-		NPY_INT
-		NPY_UINT
-		NPY_LONG
-		NPY_ULONG
-		NPY_LONGLONG
-		NPY_ULONGLONG
-		NPY_FLOAT
-		NPY_DOUBLE
-		NPY_LONGDOUBLE
-		NPY_CFLOAT
-		NPY_CDOUBLE
-		NPY_CLONGDOUBLE
-		NPY_OBJECT
-		NPY_STRING
-		NPY_UNICODE
-		NPY_VOID
-		NPY_NTYPES
-		NPY_NOTYPE
-
-	cdef enum requirements:
-		NPY_CONTIGUOUS
-		NPY_FORTRAN
-		NPY_OWNDATA
-		NPY_FORCECAST
-		NPY_ENSURECOPY
-		NPY_ENSUREARRAY
-		NPY_ELEMENTSTRIDES
-		NPY_ALIGNED
-		NPY_NOTSWAPPED
-		NPY_WRITEABLE
-		NPY_UPDATEIFCOPY
-		NPY_ARR_HAS_DESCR
-
-		NPY_BEHAVED
-		NPY_BEHAVED_NS
-		NPY_CARRAY
-		NPY_CARRAY_RO
-		NPY_FARRAY
-		NPY_FARRAY_RO
-		NPY_DEFAULT
-
-		NPY_IN_ARRAY
-		NPY_OUT_ARRAY
-		NPY_INOUT_ARRAY
-		NPY_IN_FARRAY
-		NPY_OUT_FARRAY
-		NPY_INOUT_FARRAY
-
-		NPY_UPDATE_ALL
-
-	cdef enum NPY_SORTKIND:
-		NPY_QUICKSORT
-		NPY_HEAPSORT
-		NPY_MERGESORT
-
-	cdef enum defines:
-		NPY_MAXDIMS
-
-	ctypedef struct npy_cdouble:
-		double real
-		double imag
-
-	ctypedef struct npy_cfloat:
-		double real
-		double imag
-
-	ctypedef int npy_intp
-
-	ctypedef extern class numpy.dtype [object PyArray_Descr]:
-		cdef int type_num, elsize, alignment
-		cdef char type, kind, byteorder, hasobject
-		cdef object fields, typeobj
-		cdef object f
-
-	ctypedef extern class numpy.ndarray [object PyArrayObject]:
-		cdef char *data
-		cdef int nd
-		cdef npy_intp *dimensions
-		cdef npy_intp *strides
-		cdef object base
-		cdef dtype descr
-		cdef int flags
-
-	ctypedef extern class numpy.flatiter [object PyArrayIterObject]:
-		cdef int  nd_m1
-		cdef npy_intp index, size
-		cdef ndarray ao
-		cdef char *dataptr
-
-	ctypedef extern class numpy.broadcast [object PyArrayMultiIterObject]:
-		cdef int numiter
-		cdef npy_intp size, index
-		cdef int nd
-		cdef npy_intp *dimensions
-		cdef void **iters
-
-	object PyArray_ZEROS(int ndims, npy_intp* dims, int type_num, int fortran)
-	object PyArray_EMPTY(int ndims, npy_intp* dims, int type_num, int fortran)
-	dtype PyArray_DescrFromTypeNum(NPY_TYPES type_num)
-	object PyArray_SimpleNew(int ndims, npy_intp* dims, NPY_TYPES type_num)
-	int PyArray_Check(object obj)
-	object PyArray_ContiguousFromAny(object obj, int type,
-		int mindim, int maxdim)
-	object PyArray_ContiguousFromObject(object obj, NPY_TYPES type,
-		int mindim, int maxdim)
-	npy_intp PyArray_SIZE(ndarray arr)
-	npy_intp PyArray_NBYTES(ndarray arr)
-	npy_intp *PyArray_DIMS(object arr)
-	void *PyArray_DATA(ndarray arr)
-	int PyArray_ITEMSIZE(object arr)
-
-	int PyArray_ISBEHAVED(ndarray arr)
-
-	int PyArray_TYPE(object arr)
-
-	object PyArray_GETITEM(object obj, void* itemptr)
-	int PyArray_SETITEM(object obj, void* itemptr, object item)
-	object PyArray_FromAny(object obj, dtype newtype, int mindim, int maxdim,
-						   int requirements, object context)
-	object PyArray_FROMANY(object obj, NPY_TYPES type_num, int min,
-						   int max, int requirements)
-	object PyArray_NewFromDescr(object subtype, dtype newtype, int nd,
-								npy_intp* dims, npy_intp* strides, void* data,
-								int flags, object parent)
-
-	object PyArray_FROM_OTF(object obj, NPY_TYPES type, int flags)
-	object PyArray_EnsureArray(object)
-
-	object PyArray_MultiIterNew(int n, ...)
-
-	char *PyArray_MultiIter_DATA(broadcast multi, int i)
-	void PyArray_MultiIter_NEXTi(broadcast multi, int i)
-	void PyArray_MultiIter_NEXT(broadcast multi)
-
-	object PyArray_IterNew(object arr)
-	void PyArray_ITER_NEXT(flatiter it)
-	void PyArray_ITER_GOTO(flatiter it, npy_intp* i)
-	void PyArray_ITER_GOTO1D(flatiter it, npy_intp i)
-
-	void import_array()
diff --git a/pandas/lib/src/common.pyx b/pandas/lib/src/common.pyx
index debf0c03f..40f121643 100644
--- a/pandas/lib/src/common.pyx
+++ b/pandas/lib/src/common.pyx
@@ -53,7 +53,7 @@ cdef double_t *get_double_ptr(ndarray arr):
 
     return <double_t *> arr.data
 
-def map_indices(ndarray[object, ndim=1] index):
+cpdef map_indices(ndarray index):
     '''
     Produce a dict mapping the values of the input array to their respective
     locations.
@@ -63,12 +63,20 @@ def map_indices(ndarray[object, ndim=1] index):
 
     Better to do this with Cython because of the enormous speed boost.
     '''
-    cdef int i
+    cdef int i, length
+    cdef flatiter iter
     cdef dict result
+    cdef object idx
 
     result = {}
-    for i from 0 <= i < PyArray_SIZE(index):
-        result[index[i]] = i
+
+    iter = <flatiter> PyArray_IterNew(index)
+    length = PyArray_SIZE(index)
+
+    for i from 0 <= i < length:
+        idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
+        result[idx] = i
+        PyArray_ITER_NEXT(iter)
 
     return result
 
diff --git a/pandas/lib/src/moments.pyx b/pandas/lib/src/moments.pyx
index a8542771a..04cc07337 100644
--- a/pandas/lib/src/moments.pyx
+++ b/pandas/lib/src/moments.pyx
@@ -731,6 +731,8 @@ def rolling_var(ndarray input, window, minp=None):
 
     if minp is None:
         minp = window
+    else:
+        minp = max(2, minp)
 
     if not issubclass(input.dtype.type, float):
         input = input.astype(float)
@@ -755,6 +757,8 @@ def rolling_skew(ndarray input, window, minp=None):
 
     if minp is None:
         minp = window
+    else:
+        minp = max(2, minp)
 
     if not issubclass(input.dtype.type, float):
         input = input.astype(float)
@@ -774,6 +778,8 @@ def rolling_kurt(ndarray input, window, minp=None):
 
     if minp is None:
         minp = window
+    else:
+        minp = max(2, minp)
 
     if not issubclass(input.dtype.type, float):
         input = input.astype(float)
diff --git a/pandas/lib/src/tseries.c b/pandas/lib/src/tseries.c
index 10ad8e3a0..13fbb0dbc 100644
--- a/pandas/lib/src/tseries.c
+++ b/pandas/lib/src/tseries.c
@@ -1,4 +1,4 @@
-/* Generated by Cython 0.12.rc1 on Tue Nov 24 10:14:38 2009 */
+/* Generated by Cython 0.12.rc1 on Mon Nov 30 14:33:16 2009 */
 
 #define PY_SSIZE_T_CLEAN
 #include "Python.h"
@@ -752,6 +752,7 @@ static int __pyx_f_7tseries_is_contiguous(PyArrayObject *); /*proto*/
 static int __pyx_f_7tseries__contiguous_check(PyArrayObject *); /*proto*/
 static __pyx_t_5numpy_int16_t *__pyx_f_7tseries_get_int16_ptr(PyArrayObject *); /*proto*/
 static __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *); /*proto*/
+static __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *); /*proto*/
 static __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *); /*proto*/
 static PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *, int __pyx_skip_dispatch); /*proto*/
 static INLINE PyObject *__pyx_f_7tseries__checknull(PyObject *); /*proto*/
@@ -1019,6 +1020,7 @@ static PyObject *__pyx_n_s__win;
 static PyObject *__pyx_n_s__window;
 static PyObject *__pyx_n_s__zeros;
 static PyObject *__pyx_int_1;
+static PyObject *__pyx_int_2;
 static PyObject *__pyx_int_15;
 
 /* "H:\pandas\pandas\lib\src\common.pyx":18
@@ -1364,7 +1366,7 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
  * 
  *     return <int32_t *> arr.data             # <<<<<<<<<<<<<<
  * 
- * cdef double_t *get_double_ptr(ndarray arr):
+ * cdef int64_t *get_int64_ptr(ndarray arr):
  */
   __pyx_r = ((__pyx_t_5numpy_int32_t *)__pyx_v_arr->data);
   goto __pyx_L0;
@@ -1378,6 +1380,43 @@ static  __pyx_t_5numpy_int32_t *__pyx_f_7tseries_get_int32_ptr(PyArrayObject *__
 /* "H:\pandas\pandas\lib\src\common.pyx":46
  *     return <int32_t *> arr.data
  * 
+ * cdef int64_t *get_int64_ptr(ndarray arr):             # <<<<<<<<<<<<<<
+ *     _contiguous_check(arr)
+ * 
+ */
+
+static  __pyx_t_5numpy_int64_t *__pyx_f_7tseries_get_int64_ptr(PyArrayObject *__pyx_v_arr) {
+  __pyx_t_5numpy_int64_t *__pyx_r;
+  __Pyx_RefNannySetupContext("get_int64_ptr");
+
+  /* "H:\pandas\pandas\lib\src\common.pyx":47
+ * 
+ * cdef int64_t *get_int64_ptr(ndarray arr):
+ *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
+ * 
+ *     return <int64_t *> arr.data
+ */
+  __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
+
+  /* "H:\pandas\pandas\lib\src\common.pyx":49
+ *     _contiguous_check(arr)
+ * 
+ *     return <int64_t *> arr.data             # <<<<<<<<<<<<<<
+ * 
+ * cdef double_t *get_double_ptr(ndarray arr):
+ */
+  __pyx_r = ((__pyx_t_5numpy_int64_t *)__pyx_v_arr->data);
+  goto __pyx_L0;
+
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "H:\pandas\pandas\lib\src\common.pyx":51
+ *     return <int64_t *> arr.data
+ * 
  * cdef double_t *get_double_ptr(ndarray arr):             # <<<<<<<<<<<<<<
  *     _contiguous_check(arr)
  * 
@@ -1387,7 +1426,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
   __pyx_t_5numpy_double_t *__pyx_r;
   __Pyx_RefNannySetupContext("get_double_ptr");
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":47
+  /* "H:\pandas\pandas\lib\src\common.pyx":52
  * 
  * cdef double_t *get_double_ptr(ndarray arr):
  *     _contiguous_check(arr)             # <<<<<<<<<<<<<<
@@ -1396,7 +1435,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
  */
   __pyx_f_7tseries__contiguous_check(__pyx_v_arr);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":49
+  /* "H:\pandas\pandas\lib\src\common.pyx":54
  *     _contiguous_check(arr)
  * 
  *     return <double_t *> arr.data             # <<<<<<<<<<<<<<
@@ -1412,7 +1451,7 @@ static  __pyx_t_5numpy_double_t *__pyx_f_7tseries_get_double_ptr(PyArrayObject *
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":51
+/* "H:\pandas\pandas\lib\src\common.pyx":56
  *     return <double_t *> arr.data
  * 
  * cpdef map_indices(ndarray index):             # <<<<<<<<<<<<<<
@@ -1436,34 +1475,34 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_v_result = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
   __pyx_v_idx = Py_None; __Pyx_INCREF(Py_None);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":66
+  /* "H:\pandas\pandas\lib\src\common.pyx":71
  *     cdef object idx
  * 
  *     result = {}             # <<<<<<<<<<<<<<
  * 
  *     iter = <flatiter> PyArray_IterNew(index)
  */
-  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_1));
   __Pyx_DECREF(((PyObject *)__pyx_v_result));
   __pyx_v_result = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":68
+  /* "H:\pandas\pandas\lib\src\common.pyx":73
  *     result = {}
  * 
  *     iter = <flatiter> PyArray_IterNew(index)             # <<<<<<<<<<<<<<
  *     length = PyArray_SIZE(index)
  * 
  */
-  __pyx_t_1 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyArray_IterNew(((PyObject *)__pyx_v_index)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)((PyArrayIterObject *)__pyx_t_1)));
   __Pyx_DECREF(((PyObject *)__pyx_v_iter));
   __pyx_v_iter = ((PyArrayIterObject *)__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":69
+  /* "H:\pandas\pandas\lib\src\common.pyx":74
  * 
  *     iter = <flatiter> PyArray_IterNew(index)
  *     length = PyArray_SIZE(index)             # <<<<<<<<<<<<<<
@@ -1472,7 +1511,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
  */
   __pyx_v_length = PyArray_SIZE(__pyx_v_index);
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":71
+  /* "H:\pandas\pandas\lib\src\common.pyx":76
  *     length = PyArray_SIZE(index)
  * 
  *     for i from 0 <= i < length:             # <<<<<<<<<<<<<<
@@ -1482,32 +1521,32 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   __pyx_t_2 = __pyx_v_length;
   for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_2; __pyx_v_i++) {
 
-    /* "H:\pandas\pandas\lib\src\common.pyx":72
+    /* "H:\pandas\pandas\lib\src\common.pyx":77
  * 
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))             # <<<<<<<<<<<<<<
  *         result[idx] = i
  *         PyArray_ITER_NEXT(iter)
  */
-    __pyx_t_1 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyArray_GETITEM(__pyx_v_index, PyArray_ITER_DATA(__pyx_v_iter)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_v_idx);
     __pyx_v_idx = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "H:\pandas\pandas\lib\src\common.pyx":73
+    /* "H:\pandas\pandas\lib\src\common.pyx":78
  *     for i from 0 <= i < length:
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  *         result[idx] = i             # <<<<<<<<<<<<<<
  *         PyArray_ITER_NEXT(iter)
  * 
  */
-    __pyx_t_1 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_v_idx, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (PyDict_SetItem(((PyObject *)__pyx_v_result), __pyx_v_idx, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "H:\pandas\pandas\lib\src\common.pyx":74
+    /* "H:\pandas\pandas\lib\src\common.pyx":79
  *         idx = PyArray_GETITEM(index, PyArray_ITER_DATA(iter))
  *         result[idx] = i
  *         PyArray_ITER_NEXT(iter)             # <<<<<<<<<<<<<<
@@ -1517,7 +1556,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
     PyArray_ITER_NEXT(__pyx_v_iter);
   }
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":76
+  /* "H:\pandas\pandas\lib\src\common.pyx":81
  *         PyArray_ITER_NEXT(iter)
  * 
  *     return result             # <<<<<<<<<<<<<<
@@ -1545,7 +1584,7 @@ static  PyObject *__pyx_f_7tseries_map_indices(PyArrayObject *__pyx_v_index, int
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\common.pyx":51
+/* "H:\pandas\pandas\lib\src\common.pyx":56
  *     return <double_t *> arr.data
  * 
  * cpdef map_indices(ndarray index):             # <<<<<<<<<<<<<<
@@ -1560,9 +1599,9 @@ static PyObject *__pyx_pf_7tseries_map_indices(PyObject *__pyx_self, PyObject *_
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("map_indices");
   __pyx_self = __pyx_self;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_index), __pyx_ptype_5numpy_ndarray, 1, "index", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7tseries_map_indices(((PyArrayObject *)__pyx_v_index), 0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __pyx_f_7tseries_map_indices(((PyArrayObject *)__pyx_v_index), 0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -12291,7 +12330,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
  * 
  *     if minp is None:             # <<<<<<<<<<<<<<
  *         minp = window
- * 
+ *     else:
  */
   __pyx_t_3 = (__pyx_v_minp == Py_None);
   if (__pyx_t_3) {
@@ -12300,52 +12339,76 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
  * 
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
- * 
- *     if not issubclass(input.dtype.type, float):
+ *     else:
+ *         minp = max(2, minp)
  */
     __Pyx_INCREF(__pyx_v_window);
     __Pyx_DECREF(__pyx_v_minp);
     __pyx_v_minp = __pyx_v_window;
     goto __pyx_L6;
   }
-  __pyx_L6:;
+  /*else*/ {
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":735
+    /* "H:\pandas\pandas\lib\src\moments.pyx":735
  *         minp = window
+ *     else:
+ *         minp = max(2, minp)             # <<<<<<<<<<<<<<
+ * 
+ *     if not issubclass(input.dtype.type, float):
+ */
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_INCREF(__pyx_int_2);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
+    __Pyx_GIVEREF(__pyx_int_2);
+    __Pyx_INCREF(__pyx_v_minp);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
+    __Pyx_GIVEREF(__pyx_v_minp);
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_v_minp);
+    __pyx_v_minp = __pyx_t_4;
+    __pyx_t_4 = 0;
+  }
+  __pyx_L6:;
+
+  /* "H:\pandas\pandas\lib\src\moments.pyx":737
+ *         minp = max(2, minp)
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_4, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_5 = (!__pyx_t_3);
   if (__pyx_t_5) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":736
+    /* "H:\pandas\pandas\lib\src\moments.pyx":738
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)
  */
-    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
+    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
     __pyx_t_6 = 0;
@@ -12353,36 +12416,36 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":738
+  /* "H:\pandas\pandas\lib\src\moments.pyx":740
  *         input = input.astype(float)
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if is_contiguous(input):
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_N);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_N);
   __Pyx_GIVEREF(__pyx_v_N);
-  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
-  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_6, ((PyObject *)__pyx_t_4)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_output = ((PyArrayObject *)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":740
+  /* "H:\pandas\pandas\lib\src\moments.pyx":742
  *     cdef ndarray output = np.empty(N, dtype=float)
  * 
  *     if is_contiguous(input):             # <<<<<<<<<<<<<<
@@ -12392,56 +12455,56 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   __pyx_t_8 = __pyx_f_7tseries_is_contiguous(__pyx_v_input);
   if (__pyx_t_8) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":742
+    /* "H:\pandas\pandas\lib\src\moments.pyx":744
  *     if is_contiguous(input):
  *         _roll_var(get_double_ptr(input), get_double_ptr(output),
  *                    window, minp, N)             # <<<<<<<<<<<<<<
  *     else:
  *         _roll_var_noncontig(input, output, window, minp, N)
  */
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_f_7tseries__roll_var(__pyx_f_7tseries_get_double_ptr(__pyx_v_input), __pyx_f_7tseries_get_double_ptr(__pyx_v_output), __pyx_t_8, __pyx_t_9, __pyx_t_10);
     goto __pyx_L8;
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":744
+    /* "H:\pandas\pandas\lib\src\moments.pyx":746
  *                    window, minp, N)
  *     else:
  *         _roll_var_noncontig(input, output, window, minp, N)             # <<<<<<<<<<<<<<
  * 
  *     return output
  */
-    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_var_noncontig); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s___roll_var_noncontig); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_v_input));
-    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_input));
+    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
     __Pyx_INCREF(((PyObject *)__pyx_v_output));
-    PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_output));
+    PyTuple_SET_ITEM(__pyx_t_2, 1, ((PyObject *)__pyx_v_output));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_output));
     __Pyx_INCREF(__pyx_v_window);
-    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_window);
+    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_window);
     __Pyx_GIVEREF(__pyx_v_window);
     __Pyx_INCREF(__pyx_v_minp);
-    PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_v_minp);
+    PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_minp);
     __Pyx_GIVEREF(__pyx_v_minp);
     __Pyx_INCREF(__pyx_v_N);
-    PyTuple_SET_ITEM(__pyx_t_4, 4, __pyx_v_N);
+    PyTuple_SET_ITEM(__pyx_t_2, 4, __pyx_v_N);
     __Pyx_GIVEREF(__pyx_v_N);
-    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __pyx_L8:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":746
+  /* "H:\pandas\pandas\lib\src\moments.pyx":748
  *         _roll_var_noncontig(input, output, window, minp, N)
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -12473,7 +12536,7 @@ static PyObject *__pyx_pf_7tseries_rolling_var(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":748
+/* "H:\pandas\pandas\lib\src\moments.pyx":750
  *     return output
  * 
  * def rolling_std(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
@@ -12515,7 +12578,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -12524,7 +12587,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_std") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_std") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -12543,24 +12606,24 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_std", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.rolling_std");
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_v_output = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":749
+  /* "H:\pandas\pandas\lib\src\moments.pyx":751
  * 
  * def rolling_std(ndarray input, window, minp=None):
  *     output = rolling_var(input, window, minp=minp)             # <<<<<<<<<<<<<<
  * 
  *     return np.sqrt(output)
  */
-  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__rolling_var); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__rolling_var); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_input));
   PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
@@ -12568,10 +12631,10 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   __Pyx_INCREF(__pyx_v_window);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_window);
   __Pyx_GIVEREF(__pyx_v_window);
-  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_3));
-  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__minp), __pyx_v_minp) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_2, ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__minp), __pyx_v_minp) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyEval_CallObjectWithKeywords(__pyx_t_1, __pyx_t_2, ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
@@ -12580,7 +12643,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   __pyx_v_output = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":751
+  /* "H:\pandas\pandas\lib\src\moments.pyx":753
  *     output = rolling_var(input, window, minp=minp)
  * 
  *     return np.sqrt(output)             # <<<<<<<<<<<<<<
@@ -12588,17 +12651,17 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
  * def rolling_skew(ndarray input, window, minp=None):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__sqrt); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__sqrt); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_output);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_output);
   __Pyx_GIVEREF(__pyx_v_output);
-  __pyx_t_2 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -12622,7 +12685,7 @@ static PyObject *__pyx_pf_7tseries_rolling_std(PyObject *__pyx_self, PyObject *_
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":753
+/* "H:\pandas\pandas\lib\src\moments.pyx":755
  *     return np.sqrt(output)
  * 
  * def rolling_skew(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
@@ -12671,7 +12734,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -12680,7 +12743,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_skew") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_skew") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -12699,7 +12762,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_skew", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.rolling_skew");
   return NULL;
@@ -12708,82 +12771,106 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
   __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":754
+  /* "H:\pandas\pandas\lib\src\moments.pyx":756
  * 
  * def rolling_skew(ndarray input, window, minp=None):
  *     N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     if minp is None:
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_v_N);
   __pyx_v_N = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":756
+  /* "H:\pandas\pandas\lib\src\moments.pyx":758
  *     N = len(input)
  * 
  *     if minp is None:             # <<<<<<<<<<<<<<
  *         minp = window
- * 
+ *     else:
  */
   __pyx_t_3 = (__pyx_v_minp == Py_None);
   if (__pyx_t_3) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":757
+    /* "H:\pandas\pandas\lib\src\moments.pyx":759
  * 
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
- * 
- *     if not issubclass(input.dtype.type, float):
+ *     else:
+ *         minp = max(2, minp)
  */
     __Pyx_INCREF(__pyx_v_window);
     __Pyx_DECREF(__pyx_v_minp);
     __pyx_v_minp = __pyx_v_window;
     goto __pyx_L6;
   }
-  __pyx_L6:;
+  /*else*/ {
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":759
+    /* "H:\pandas\pandas\lib\src\moments.pyx":761
  *         minp = window
+ *     else:
+ *         minp = max(2, minp)             # <<<<<<<<<<<<<<
+ * 
+ *     if not issubclass(input.dtype.type, float):
+ */
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_INCREF(__pyx_int_2);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
+    __Pyx_GIVEREF(__pyx_int_2);
+    __Pyx_INCREF(__pyx_v_minp);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
+    __Pyx_GIVEREF(__pyx_v_minp);
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_v_minp);
+    __pyx_v_minp = __pyx_t_4;
+    __pyx_t_4 = 0;
+  }
+  __pyx_L6:;
+
+  /* "H:\pandas\pandas\lib\src\moments.pyx":763
+ *         minp = max(2, minp)
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_4, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_5 = (!__pyx_t_3);
   if (__pyx_t_5) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":760
+    /* "H:\pandas\pandas\lib\src\moments.pyx":764
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)
  */
-    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
+    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
     __pyx_t_6 = 0;
@@ -12791,36 +12878,36 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":762
+  /* "H:\pandas\pandas\lib\src\moments.pyx":766
  *         input = input.astype(float)
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if is_contiguous(input):
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_N);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_N);
   __Pyx_GIVEREF(__pyx_v_N);
-  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
-  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_6, ((PyObject *)__pyx_t_4)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_output = ((PyArrayObject *)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":764
+  /* "H:\pandas\pandas\lib\src\moments.pyx":768
  *     cdef ndarray output = np.empty(N, dtype=float)
  * 
  *     if is_contiguous(input):             # <<<<<<<<<<<<<<
@@ -12830,56 +12917,56 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   __pyx_t_8 = __pyx_f_7tseries_is_contiguous(__pyx_v_input);
   if (__pyx_t_8) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":766
+    /* "H:\pandas\pandas\lib\src\moments.pyx":770
  *     if is_contiguous(input):
  *         _roll_skew(get_double_ptr(input), get_double_ptr(output),
  *                    window, minp, N)             # <<<<<<<<<<<<<<
  *     else:
  *         _roll_skew_noncontig(input, output, window, minp, N)
  */
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_f_7tseries__roll_skew(__pyx_f_7tseries_get_double_ptr(__pyx_v_input), __pyx_f_7tseries_get_double_ptr(__pyx_v_output), __pyx_t_8, __pyx_t_9, __pyx_t_10);
     goto __pyx_L8;
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":768
+    /* "H:\pandas\pandas\lib\src\moments.pyx":772
  *                    window, minp, N)
  *     else:
  *         _roll_skew_noncontig(input, output, window, minp, N)             # <<<<<<<<<<<<<<
  * 
  *     return output
  */
-    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_5); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_5); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_v_input));
-    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_input));
+    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
     __Pyx_INCREF(((PyObject *)__pyx_v_output));
-    PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_output));
+    PyTuple_SET_ITEM(__pyx_t_2, 1, ((PyObject *)__pyx_v_output));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_output));
     __Pyx_INCREF(__pyx_v_window);
-    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_window);
+    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_window);
     __Pyx_GIVEREF(__pyx_v_window);
     __Pyx_INCREF(__pyx_v_minp);
-    PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_v_minp);
+    PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_minp);
     __Pyx_GIVEREF(__pyx_v_minp);
     __Pyx_INCREF(__pyx_v_N);
-    PyTuple_SET_ITEM(__pyx_t_4, 4, __pyx_v_N);
+    PyTuple_SET_ITEM(__pyx_t_2, 4, __pyx_v_N);
     __Pyx_GIVEREF(__pyx_v_N);
-    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __pyx_L8:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":770
+  /* "H:\pandas\pandas\lib\src\moments.pyx":774
  *         _roll_skew_noncontig(input, output, window, minp, N)
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -12911,7 +12998,7 @@ static PyObject *__pyx_pf_7tseries_rolling_skew(PyObject *__pyx_self, PyObject *
   return __pyx_r;
 }
 
-/* "H:\pandas\pandas\lib\src\moments.pyx":772
+/* "H:\pandas\pandas\lib\src\moments.pyx":776
  *     return output
  * 
  * def rolling_kurt(ndarray input, window, minp=None):             # <<<<<<<<<<<<<<
@@ -12960,7 +13047,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
       values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__window);
       if (likely(values[1])) kw_args--;
       else {
-        __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
       case  2:
       if (kw_args > 0) {
@@ -12969,7 +13056,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
       }
     }
     if (unlikely(kw_args > 0)) {
-      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_kurt") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "rolling_kurt") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     }
     __pyx_v_input = ((PyArrayObject *)values[0]);
     __pyx_v_window = values[1];
@@ -12988,7 +13075,7 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("rolling_kurt", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("tseries.rolling_kurt");
   return NULL;
@@ -12997,82 +13084,106 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   __Pyx_INCREF(__pyx_v_window);
   __Pyx_INCREF(__pyx_v_minp);
   __pyx_v_N = Py_None; __Pyx_INCREF(Py_None);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_input), __pyx_ptype_5numpy_ndarray, 1, "input", 0))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":773
+  /* "H:\pandas\pandas\lib\src\moments.pyx":777
  * 
  * def rolling_kurt(ndarray input, window, minp=None):
  *     N = len(input)             # <<<<<<<<<<<<<<
  * 
  *     if minp is None:
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_input)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_v_N);
   __pyx_v_N = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":775
+  /* "H:\pandas\pandas\lib\src\moments.pyx":779
  *     N = len(input)
  * 
  *     if minp is None:             # <<<<<<<<<<<<<<
  *         minp = window
- * 
+ *     else:
  */
   __pyx_t_3 = (__pyx_v_minp == Py_None);
   if (__pyx_t_3) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":776
+    /* "H:\pandas\pandas\lib\src\moments.pyx":780
  * 
  *     if minp is None:
  *         minp = window             # <<<<<<<<<<<<<<
- * 
- *     if not issubclass(input.dtype.type, float):
+ *     else:
+ *         minp = max(2, minp)
  */
     __Pyx_INCREF(__pyx_v_window);
     __Pyx_DECREF(__pyx_v_minp);
     __pyx_v_minp = __pyx_v_window;
     goto __pyx_L6;
   }
-  __pyx_L6:;
+  /*else*/ {
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":778
+    /* "H:\pandas\pandas\lib\src\moments.pyx":782
  *         minp = window
+ *     else:
+ *         minp = max(2, minp)             # <<<<<<<<<<<<<<
+ * 
+ *     if not issubclass(input.dtype.type, float):
+ */
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_INCREF(__pyx_int_2);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
+    __Pyx_GIVEREF(__pyx_int_2);
+    __Pyx_INCREF(__pyx_v_minp);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_minp);
+    __Pyx_GIVEREF(__pyx_v_minp);
+    __pyx_t_4 = PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_v_minp);
+    __pyx_v_minp = __pyx_t_4;
+    __pyx_t_4 = 0;
+  }
+  __pyx_L6:;
+
+  /* "H:\pandas\pandas\lib\src\moments.pyx":784
+ *         minp = max(2, minp)
  * 
  *     if not issubclass(input.dtype.type, float):             # <<<<<<<<<<<<<<
  *         input = input.astype(float)
  * 
  */
-  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__type); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__dtype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_4, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_3 = PyObject_IsSubclass(__pyx_t_2, ((PyObject *)((PyObject*)&PyFloat_Type))); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_5 = (!__pyx_t_3);
   if (__pyx_t_5) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":779
+    /* "H:\pandas\pandas\lib\src\moments.pyx":785
  * 
  *     if not issubclass(input.dtype.type, float):
  *         input = input.astype(float)             # <<<<<<<<<<<<<<
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)
  */
-    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_input), __pyx_n_s__astype); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
+    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)((PyObject*)&PyFloat_Type)));
     __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
-    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(((PyObject *)__pyx_v_input));
     __pyx_v_input = ((PyArrayObject *)__pyx_t_6);
     __pyx_t_6 = 0;
@@ -13080,36 +13191,36 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   }
   __pyx_L7:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":781
+  /* "H:\pandas\pandas\lib\src\moments.pyx":787
  *         input = input.astype(float)
  * 
  *     cdef ndarray output = np.empty(N, dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     if is_contiguous(input):
  */
-  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__np); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyObject_GetAttr(__pyx_t_6, __pyx_n_s__empty); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_N);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_N);
   __Pyx_GIVEREF(__pyx_v_N);
-  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
-  if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_2, __pyx_t_6, ((PyObject *)__pyx_t_4)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
+  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), ((PyObject *)((PyObject*)&PyFloat_Type))) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_7 = PyEval_CallObjectWithKeywords(__pyx_t_4, __pyx_t_6, ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_output = ((PyArrayObject *)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":783
+  /* "H:\pandas\pandas\lib\src\moments.pyx":789
  *     cdef ndarray output = np.empty(N, dtype=float)
  * 
  *     if is_contiguous(input):             # <<<<<<<<<<<<<<
@@ -13119,56 +13230,56 @@ static PyObject *__pyx_pf_7tseries_rolling_kurt(PyObject *__pyx_self, PyObject *
   __pyx_t_8 = __pyx_f_7tseries_is_contiguous(__pyx_v_input);
   if (__pyx_t_8) {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":785
+    /* "H:\pandas\pandas\lib\src\moments.pyx":791
  *     if is_contiguous(input):
  *         _roll_kurt(get_double_ptr(input), get_double_ptr(output),
  *                    window, minp, N)             # <<<<<<<<<<<<<<
  *     else:
  *         _roll_kurt_noncontig(input, output, window, minp, N)
  */
-    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_window); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_v_minp); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_v_N); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_f_7tseries__roll_kurt(__pyx_f_7tseries_get_double_ptr(__pyx_v_input), __pyx_f_7tseries_get_double_ptr(__pyx_v_output), __pyx_t_8, __pyx_t_9, __pyx_t_10);
     goto __pyx_L8;
   }
   /*else*/ {
 
-    /* "H:\pandas\pandas\lib\src\moments.pyx":787
+    /* "H:\pandas\pandas\lib\src\moments.pyx":793
  *                    window, minp, N)
  *     else:
  *         _roll_kurt_noncontig(input, output, window, minp, N)             # <<<<<<<<<<<<<<
  * 
  *     return output
  */
-    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_6); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s_6); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_v_input));
-    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_input));
+    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_input));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_input));
     __Pyx_INCREF(((PyObject *)__pyx_v_output));
-    PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_output));
+    PyTuple_SET_ITEM(__pyx_t_2, 1, ((PyObject *)__pyx_v_output));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_output));
     __Pyx_INCREF(__pyx_v_window);
-    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_window);
+    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_window);
     __Pyx_GIVEREF(__pyx_v_window);
     __Pyx_INCREF(__pyx_v_minp);
-    PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_v_minp);
+    PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_minp);
     __Pyx_GIVEREF(__pyx_v_minp);
     __Pyx_INCREF(__pyx_v_N);
-    PyTuple_SET_ITEM(__pyx_t_4, 4, __pyx_v_N);
+    PyTuple_SET_ITEM(__pyx_t_2, 4, __pyx_v_N);
     __Pyx_GIVEREF(__pyx_v_N);
-    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_6 = PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __pyx_L8:;
 
-  /* "H:\pandas\pandas\lib\src\moments.pyx":789
+  /* "H:\pandas\pandas\lib\src\moments.pyx":795
  *         _roll_kurt_noncontig(input, output, window, minp, N)
  * 
  *     return output             # <<<<<<<<<<<<<<
@@ -19480,6 +19591,7 @@ static int __Pyx_InitCachedBuiltins(void) {
 static int __Pyx_InitGlobals(void) {
   if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
   __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
+  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
   __pyx_int_15 = PyInt_FromLong(15); if (unlikely(!__pyx_int_15)) {__pyx_filename = __pyx_f[7]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
   return 0;
   __pyx_L1_error:;
@@ -19619,7 +19731,7 @@ PyMODINIT_FUNC PyInit_tseries(void)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "H:\pandas\pandas\lib\src\common.pyx":83
+  /* "H:\pandas\pandas\lib\src\common.pyx":88
  * 
  * # initialize numpy
  * import_array()             # <<<<<<<<<<<<<<
