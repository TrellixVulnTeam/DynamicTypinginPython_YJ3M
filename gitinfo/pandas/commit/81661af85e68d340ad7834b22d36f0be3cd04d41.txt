commit 81661af85e68d340ad7834b22d36f0be3cd04d41
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Nov 4 20:09:46 2012 -0500

    BUG: MultiIndex.__getitem__ failure with NA values causing downstream problems. close #2008

diff --git a/RELEASE.rst b/RELEASE.rst
index a1131aabd..d7994adff 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -81,6 +81,7 @@ pandas 0.9.1
   - Better floating point error robustness in some rolling_* functions (#2114)
   - Fix ewma NA handling in the middle of Series (#2128)
   - Fix numerical precision issues in diff with integer data (#2087)
+  - Fix bug in MultiIndex.__getitem__ with NA values (#2008)
 
 pandas 0.9.0
 ============
diff --git a/pandas/core/index.py b/pandas/core/index.py
index 5c85d4853..1ba78c698 100644
--- a/pandas/core/index.py
+++ b/pandas/core/index.py
@@ -1633,8 +1633,14 @@ class MultiIndex(Index):
 
     def __getitem__(self, key):
         if np.isscalar(key):
-            return tuple(lev[lab[key]]
-                         for lev, lab in zip(self.levels, self.labels))
+            retval = []
+            for lev, lab in zip(self.levels, self.labels):
+                if lab[key] == -1:
+                    retval.append(np.nan)
+                else:
+                    retval.append(lev[lab[key]])
+
+            return tuple(retval)
         else:
             if com._is_bool_indexer(key):
                 key = np.asarray(key)
diff --git a/pandas/tests/test_multilevel.py b/pandas/tests/test_multilevel.py
index d98ecb26f..9a279990e 100644
--- a/pandas/tests/test_multilevel.py
+++ b/pandas/tests/test_multilevel.py
@@ -1562,6 +1562,22 @@ Thur,Lunch,Yes,51.51,17"""
 
         self.assertRaises(Exception, data.xs, 2, level=1, copy=False)
 
+    def test_multiindex_na_repr(self):
+        # only an issue with long columns
+
+        from numpy import nan
+        df3 = DataFrame({
+            'A' * 30: {('A', 'A0006000', 'nuit'): 'A0006000'},
+            'B' * 30: {('A', 'A0006000', 'nuit'): nan},
+            'C' * 30: {('A', 'A0006000', 'nuit'): nan},
+            'D' * 30: {('A', 'A0006000', 'nuit'): nan},
+            'E' * 30: {('A', 'A0006000', 'nuit'): 'A'},
+            'F' * 30: {('A', 'A0006000', 'nuit'): nan},
+        })
+
+        idf = df3.set_index(['A' * 30, 'C' * 30])
+        repr(idf)
+
 if __name__ == '__main__':
 
     # unittest.main()
diff --git a/pandas/tests/test_panel.py b/pandas/tests/test_panel.py
index 3007ae643..2cb6547a0 100755
--- a/pandas/tests/test_panel.py
+++ b/pandas/tests/test_panel.py
@@ -1081,7 +1081,7 @@ class TestPanel(unittest.TestCase, PanelTests, CheckIndexing,
         # negative numbers, #2164
         result = self.panel.shift(-1)
         expected = Panel(dict((i, f.shift(-1)[:-1])
-                              for i, f in self.panel.iteritems()))
+                              for i, f in self.panel.iterkv()))
         assert_panel_equal(result, expected)
 
     def test_multiindex_get(self):
@@ -1175,7 +1175,7 @@ class TestPanel(unittest.TestCase, PanelTests, CheckIndexing,
             path = '__tmp__.' + ext
             self.panel.to_excel(path)
             reader = ExcelFile(path)
-            for item, df in self.panel.iteritems():
+            for item, df in self.panel.iterkv():
                 recdf = reader.parse(str(item),index_col=0)
                 assert_frame_equal(df, recdf)
             os.remove(path)
