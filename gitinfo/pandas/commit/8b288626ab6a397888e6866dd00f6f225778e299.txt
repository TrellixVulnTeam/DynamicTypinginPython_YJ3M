commit 8b288626ab6a397888e6866dd00f6f225778e299
Author: jreback <jeff@reback.net>
Date:   Tue Jan 15 20:54:08 2013 -0500

    BUG: hopefully fixed factor_indexer in reshape.py; failed on 32-bit platformsx

diff --git a/pandas/core/reshape.py b/pandas/core/reshape.py
index e16fdffd1..40c4dc6e5 100644
--- a/pandas/core/reshape.py
+++ b/pandas/core/reshape.py
@@ -835,4 +835,4 @@ def block2d_to_blocknd(values, items, shape, labels, ref_items=None):
 def factor_indexer(shape, labels):
     """ given a tuple of shape and a list of Factor lables, return the expanded label indexer """
     mult = np.array(shape)[::-1].cumprod()[::-1]
-    return (np.sum(np.array(labels).T * np.append(mult, [1]), axis=1).T).astype('i8')
+    return com._ensure_platform_int(np.sum(np.array(labels).T * np.append(mult, [1]), axis=1).T)
