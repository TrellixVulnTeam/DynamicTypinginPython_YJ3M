commit e246c3b05924ac1fe083565a765ce847fcad3d91
Author: jbrockmendel <jbrockmendel@gmail.com>
Date:   Mon Nov 18 11:44:46 2019 -0800

    TST: fix DecimalArray._reduce kludges (#29630)
    
    * TST: fix DecimalArray._reduce kludges

diff --git a/pandas/core/groupby/generic.py b/pandas/core/groupby/generic.py
index 6376dbefc..06fd3c1ea 100644
--- a/pandas/core/groupby/generic.py
+++ b/pandas/core/groupby/generic.py
@@ -885,13 +885,6 @@ class DataFrameGroupBy(GroupBy):
                         # raised directly by _aggregate_multiple_funcs
                         raise
                     result = self._aggregate_frame(func)
-                except NotImplementedError as err:
-                    if "decimal does not support skipna=True" in str(err):
-                        # FIXME: kludge for DecimalArray tests
-                        pass
-                    else:
-                        raise
-                    result = self._aggregate_frame(func)
                 else:
                     result.columns = Index(
                         result.columns.levels[0], name=self._selected_obj.columns.name
diff --git a/pandas/core/groupby/groupby.py b/pandas/core/groupby/groupby.py
index 236df4b38..99a4942df 100644
--- a/pandas/core/groupby/groupby.py
+++ b/pandas/core/groupby/groupby.py
@@ -1342,9 +1342,6 @@ class GroupBy(_GroupBy):
                         # raised in _get_cython_function, in some cases can
                         #  be trimmed by implementing cython funcs for more dtypes
                         pass
-                    elif "decimal does not support skipna=True" in str(err):
-                        # FIXME: kludge for test_decimal:test_in_numeric_groupby
-                        pass
                     else:
                         raise
 
diff --git a/pandas/tests/extension/decimal/array.py b/pandas/tests/extension/decimal/array.py
index 93816e3a8..f9ba4b7a8 100644
--- a/pandas/tests/extension/decimal/array.py
+++ b/pandas/tests/extension/decimal/array.py
@@ -166,7 +166,14 @@ class DecimalArray(ExtensionArray, ExtensionScalarOpsMixin):
     def _reduce(self, name, skipna=True, **kwargs):
 
         if skipna:
-            raise NotImplementedError("decimal does not support skipna=True")
+            # If we don't have any NAs, we can ignore skipna
+            if self.isna().any():
+                other = self[~self.isna()]
+                return other._reduce(name, **kwargs)
+
+        if name == "sum" and len(self) == 0:
+            # GH#29630 avoid returning int 0 or np.bool_(False) on old numpy
+            return decimal.Decimal(0)
 
         try:
             op = getattr(self.data, name)
diff --git a/pandas/tests/extension/decimal/test_decimal.py b/pandas/tests/extension/decimal/test_decimal.py
index 86724d4d0..ce819c13c 100644
--- a/pandas/tests/extension/decimal/test_decimal.py
+++ b/pandas/tests/extension/decimal/test_decimal.py
@@ -145,7 +145,7 @@ class TestMissing(BaseDecimal, base.BaseMissingTests):
 class Reduce:
     def check_reduce(self, s, op_name, skipna):
 
-        if skipna or op_name in ["median", "skew", "kurt"]:
+        if op_name in ["median", "skew", "kurt"]:
             with pytest.raises(NotImplementedError):
                 getattr(s, op_name)(skipna=skipna)
 
