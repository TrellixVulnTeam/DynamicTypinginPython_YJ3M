commit f500d5e5e0ff0786b6de814b5f5063a3d75cb54c
Author: Dieter Vandenbussche <dvandenbussche@axioma.com>
Date:   Tue Mar 5 20:56:48 2013 -0500

    BUG: handle single column frame in DataFrame.cov

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index c0449faf4..b7675163a 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -4559,6 +4559,7 @@ class DataFrame(NDFrame):
                 baseCov.fill(np.nan)
             else:
                 baseCov = np.cov(mat.T)
+            baseCov = baseCov.reshape((len(cols),len(cols)))
         else:
             baseCov = _algos.nancorr(com._ensure_float64(mat), cov=True,
                                      minp=min_periods)
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 9329bb1da..2d4c8d740 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -5049,6 +5049,18 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         expected = self.mixed_frame.ix[:, ['A', 'B', 'C', 'D']].cov()
         assert_frame_equal(result, expected)
 
+        # Single column frame
+        df = DataFrame(np.linspace(0.0,1.0,10))
+        result = df.cov()
+        expected = DataFrame(np.cov(df.values.T).reshape((1,1)),
+                             index=df.columns,columns=df.columns)
+        assert_frame_equal(result, expected)
+        df.ix[0] = np.nan
+        result = df.cov()
+        expected = DataFrame(np.cov(df.values[1:].T).reshape((1,1)),
+                             index=df.columns,columns=df.columns)
+        assert_frame_equal(result, expected)
+
     def test_corrwith(self):
         a = self.tsframe
         noise = Series(randn(len(a)), index=a.index)
