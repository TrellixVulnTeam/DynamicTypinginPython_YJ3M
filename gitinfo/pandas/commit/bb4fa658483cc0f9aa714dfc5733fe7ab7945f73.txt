commit bb4fa658483cc0f9aa714dfc5733fe7ab7945f73
Author: topper-123 <Terji@fastmail.com>
Date:   Thu Nov 2 11:26:50 2017 +0000

    improve test output for Categoricals (#18069)

diff --git a/doc/source/whatsnew/v0.21.1.txt b/doc/source/whatsnew/v0.21.1.txt
index 25a891eab..4adafe7c0 100644
--- a/doc/source/whatsnew/v0.21.1.txt
+++ b/doc/source/whatsnew/v0.21.1.txt
@@ -117,7 +117,8 @@ Categorical
 ^^^^^^^^^^^
 
 - Bug in :meth:`DataFrame.astype` where casting to 'category' on an empty ``DataFrame`` causes a segmentation fault (:issue:`18004`)
--
+- Error messages in the testing module have been improved when items have
+  different ``CategoricalDtype`` (:issue:`18069`)
 -
 
 Other
diff --git a/pandas/util/testing.py b/pandas/util/testing.py
index 730d2782e..dec67bbea 100644
--- a/pandas/util/testing.py
+++ b/pandas/util/testing.py
@@ -1074,8 +1074,12 @@ def assert_categorical_equal(left, right, check_dtype=True,
 def raise_assert_detail(obj, message, left, right, diff=None):
     if isinstance(left, np.ndarray):
         left = pprint_thing(left)
+    elif is_categorical_dtype(left):
+        left = repr(left)
     if isinstance(right, np.ndarray):
         right = pprint_thing(right)
+    elif is_categorical_dtype(right):
+        right = repr(right)
 
     msg = """{obj} are different
 
