commit d96a8c2a4407b5c58e4fb0cf9bf1baf80e919c57
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Dec 12 15:33:00 2011 -0500

    BUG: Index.get_loc should always raise exception with duplicates

diff --git a/RELEASE.rst b/RELEASE.rst
index 1d9ded79f..ce879b1f3 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -104,7 +104,7 @@ pandas 0.6.1
   - Handle floating point index values in HDFStore (GH #454)
   - Fixed stale column reference bug (cached Series object) caused by type
     change / item deletion in DataFrame (GH #473)
-
+  - Index.get_loc should always raise Exception when there are duplicates
 
 Thanks
 ------
diff --git a/pandas/src/engines.pyx b/pandas/src/engines.pyx
index 25ddc6a00..ccff76570 100644
--- a/pandas/src/engines.pyx
+++ b/pandas/src/engines.pyx
@@ -81,7 +81,7 @@ cdef class DictIndexEngine(IndexEngine):
         self._ensure_initialized()
         return val in self.mapping
 
-    def get_mapping(self, bint check_integrity):
+    cpdef get_mapping(self, bint check_integrity):
         self._ensure_initialized()
         if check_integrity and self.integrity == 0:
             raise Exception('Index cannot contain duplicate values!')
@@ -118,6 +118,8 @@ cdef class DictIndexEngine(IndexEngine):
 
     cpdef get_loc(self, object val):
         self._ensure_initialized()
+        if not self.integrity:
+            raise Exception('Index cannot contain duplicate values!')
         return self.mapping[val]
 
 
diff --git a/pandas/tests/test_index.py b/pandas/tests/test_index.py
index 0f88fe345..68c568b9a 100644
--- a/pandas/tests/test_index.py
+++ b/pandas/tests/test_index.py
@@ -722,6 +722,10 @@ class TestMultiIndex(unittest.TestCase):
         self.assertRaises(KeyError, index.get_loc, (1, 1))
         self.assert_(index.get_loc((2, 0)) == slice(3, 5))
 
+    def test_get_loc_duplicates(self):
+        index = Index([2, 2, 2, 2])
+        self.assertRaises(Exception, index.get_loc, 2)
+
     def test_slice_locs(self):
         df = tm.makeTimeDataFrame()
         stacked = df.stack()
