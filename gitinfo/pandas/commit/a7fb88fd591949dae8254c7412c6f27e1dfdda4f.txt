commit a7fb88fd591949dae8254c7412c6f27e1dfdda4f
Author: Tobias Pitters <31857876+CloseChoice@users.noreply.github.com>
Date:   Mon May 11 02:33:38 2020 +0200

    add test for setitem from duplicate axis (#34071)
    
    * add test for setitem from duplicate axis
    
    * move test to tests/indexing/test_loc.py

diff --git a/pandas/tests/indexing/test_loc.py b/pandas/tests/indexing/test_loc.py
index d1f67981b..30416985f 100644
--- a/pandas/tests/indexing/test_loc.py
+++ b/pandas/tests/indexing/test_loc.py
@@ -107,6 +107,19 @@ class TestLoc(Base):
             "loc", slice(2, 4, 2), typs=["mixed"], axes=0, fails=TypeError,
         )
 
+    def test_setitem_from_duplicate_axis(self):
+        # GH#34034
+        df = DataFrame(
+            [[20, "a"], [200, "a"], [200, "a"]],
+            columns=["col1", "col2"],
+            index=[10, 1, 1],
+        )
+        df.loc[1, "col1"] = np.arange(2)
+        expected = DataFrame(
+            [[20, "a"], [0, "a"], [1, "a"]], columns=["col1", "col2"], index=[10, 1, 1]
+        )
+        tm.assert_frame_equal(df, expected)
+
 
 class TestLoc2:
     # TODO: better name, just separating out things that rely on base class
