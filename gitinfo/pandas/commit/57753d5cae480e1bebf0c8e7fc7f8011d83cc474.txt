commit 57753d5cae480e1bebf0c8e7fc7f8011d83cc474
Author: Chang She <chang@lambdafoundry.com>
Date:   Mon Nov 19 15:45:11 2012 -0500

    BUG: reversed assert condition on a check in frame

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 8e12d1f8e..cd6541a32 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -5037,12 +5037,8 @@ def group_agg(values, bounds, f):
         result = np.empty((len(bounds), K), dtype=float)
 
     testagg = f(values[:min(1, len(values))])
-    if isinstance(testagg, np.ndarray):
-        raise AssertionError('Results must be an ndarray, not %s'
-                             % type(testagg))
-    if testagg.ndim == 2:
-        raise AssertionError('Results must be 2-D, not %d-D'
-                             % testagg.ndim)
+    if isinstance(testagg, np.ndarray) and testagg.ndim == 2:
+        raise AssertionError('Function must reduce')
 
     for i, left_bound in enumerate(bounds):
         if i == len(bounds) - 1:
