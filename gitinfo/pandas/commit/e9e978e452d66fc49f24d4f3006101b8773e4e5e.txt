commit e9e978e452d66fc49f24d4f3006101b8773e4e5e
Author: Chang She <chang@lambdafoundry.com>
Date:   Thu May 24 10:57:23 2012 -0400

    BUG: raise exception when merging with insufficient info #1307

diff --git a/pandas/tools/merge.py b/pandas/tools/merge.py
index 16a337d47..5c6ddcc70 100644
--- a/pandas/tools/merge.py
+++ b/pandas/tools/merge.py
@@ -366,6 +366,8 @@ class _MergeOperation(object):
             else:
                 # use the common columns
                 common_cols = self.left.columns.intersection(self.right.columns)
+                if len(common_cols) == 0:
+                    raise Exception('No common columns to perform merge on')
                 self.left_on = self.right_on = common_cols
         elif self.on is not None:
             if self.left_on is not None or self.right_on is not None:
