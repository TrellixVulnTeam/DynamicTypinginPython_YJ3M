commit 2866a925b3209cd30ead2d7324592b1346f240ee
Author: jreback <jeff@reback.net>
Date:   Fri Jun 28 11:58:13 2013 -0400

    PERF: optimize insert_columns

diff --git a/pandas/core/internals.py b/pandas/core/internals.py
index c2af6e395..c1379dcc6 100644
--- a/pandas/core/internals.py
+++ b/pandas/core/internals.py
@@ -87,7 +87,7 @@ class Block(object):
             raise AssertionError('block ref_items must be an Index')
         if maybe_rename == 'clear':
             self._ref_locs = None
-        if maybe_rename:
+        elif maybe_rename:
             self.items = ref_items.take(self.ref_locs)
         self.ref_items = ref_items
 
@@ -1788,9 +1788,6 @@ class BlockManager(object):
             # new block
             self._add_new_block(item, value, loc=loc)
 
-            if loc != len(self.items)-1 and new_items.is_unique:
-                self.set_items_clear(new_items)
-
         except:
 
             # so our insertion operation failed, so back out of the new items
@@ -1806,6 +1803,10 @@ class BlockManager(object):
 
         self._known_consolidated = False
 
+        # clear the internal ref_loc mappings if necessary
+        if loc != len(self.items)-1 and new_items.is_unique:
+            self.set_items_clear(new_items)
+
     def set_items_norename(self, value):
         self.set_axis(0, value, maybe_rename=False, check_axis=False)
 
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 7dacacd8a..02b772b68 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -10034,6 +10034,7 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         assert_frame_equal(rs, xp)
 
     def test_insert_column_bug_4032(self):
+
         # GH4032, inserting a column and renaming causing errors
         df = DataFrame({'b': [1.1, 2.2]})
         df = df.rename(columns={})
