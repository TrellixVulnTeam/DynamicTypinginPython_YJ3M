commit e4024cdb9e6b8e12cfde9e326c5643fdf18f39f4
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Tue Jun 5 22:25:12 2012 -0400

    BUG: handle smallest value in qcut

diff --git a/pandas/tools/tests/test_tile.py b/pandas/tools/tests/test_tile.py
index c281d214c..e63d6f57d 100644
--- a/pandas/tools/tests/test_tile.py
+++ b/pandas/tools/tests/test_tile.py
@@ -95,15 +95,19 @@ class TestCut(unittest.TestCase):
         arr = np.random.randn(1000)
 
         labels, bins = qcut(arr, 4, retbins=True)
-
         ex_bins = quantile(arr, [0, .25, .5, .75, 1.])
-
+        ex_bins[0] -= (arr.max() - arr.min()) * 0.001
         assert_almost_equal(bins, ex_bins)
 
         ex_levels = cut(arr, ex_bins)
-
         self.assert_(np.array_equal(labels, ex_levels))
 
+    def test_qcut_bounds(self):
+        np.random.seed(12345)
+        arr = np.random.randn(1000)
+
+        factor = qcut(arr, 10, labels=False)
+        self.assert_(len(np.unique(factor)) == 10)
 
 if __name__ == '__main__':
     nose.runmodule(argv=[__file__,'-vvs','-x','--pdb', '--pdb-failure'],
diff --git a/pandas/tools/tile.py b/pandas/tools/tile.py
index 1b8d7a097..975c02d26 100644
--- a/pandas/tools/tile.py
+++ b/pandas/tools/tile.py
@@ -130,6 +130,7 @@ def qcut(x, q=4, labels=None, retbins=False, precision=3):
     if com.is_integer(q):
         quantiles = np.linspace(0, 1, q + 1)
         bins = algos.quantile(x, quantiles)
+        bins[0] -= 0.001 * (x.max() - x.min())
         return _bins_to_cuts(x, bins, labels=labels, retbins=retbins,
                              precision=precision)
     else:
@@ -170,7 +171,7 @@ def _bins_to_cuts(x, bins, right=True, labels=None, retbins=False,
 
         fac = Factor(ids - 1, levels, name=name)
     else:
-        fac = ids
+        fac = ids - 1
         if has_nas:
             fac = ids.astype(np.float64)
             np.putmask(fac, mask, np.nan)
