commit 5a7c28d80dc37531a9ee9e474472d5349c174f63
Author: y-p <yoval@gmx.com>
Date:   Sat Mar 16 10:05:40 2013 +0200

    CLN: make guard more defensive

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index a52609821..7c65b105c 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -1345,20 +1345,20 @@ class DataFrame(NDFrame):
         if not index:
             nlevels = 0
 
-        rows = len(data_index)
+        nrows = len(data_index)
 
         # write in chunksize bites
         if chunksize is None:
             chunksize = 100000
-        chunks = int(rows / chunksize)+1
+        chunks = int(nrows / chunksize)+1
 
         cols = list(cols)
 
         for i in xrange(chunks):
             start_i = i * chunksize
-            end_i = min((i + 1) * chunksize, rows)
-            if start_i == end_i:
-                continue
+            end_i = min((i + 1) * chunksize, nrows)
+            if start_i >= end_i:
+                break
 
             # create the data for a chunk
             chunk = self.iloc[start_i:end_i]
