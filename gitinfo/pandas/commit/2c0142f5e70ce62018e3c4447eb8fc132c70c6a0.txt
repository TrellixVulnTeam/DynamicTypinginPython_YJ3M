commit 2c0142f5e70ce62018e3c4447eb8fc132c70c6a0
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Fri Jan 21 10:20:02 2011 -0500

    unit tests, coverage

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 08cb715fe..2beb32d94 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -1170,8 +1170,9 @@ class DataFrame(Picklable, Groupable):
         -------
         y : same type as calling instance
         """
-        import warnings
-        if fillMethod is not None:
+        # TODO: remove this on next release
+        if fillMethod is not None: # pragma: no cover
+            import warnings
             warnings.warn("'fillMethod' is deprecated. Use 'method' instead",
                           DeprecationWarning)
 
diff --git a/pandas/core/tests/test_frame.py b/pandas/core/tests/test_frame.py
index 46196c318..b177c0dc1 100644
--- a/pandas/core/tests/test_frame.py
+++ b/pandas/core/tests/test_frame.py
@@ -639,6 +639,8 @@ class TestDataFrame(unittest.TestCase):
             self.assert_(np.array_equal(result3.values,
                                         func(self.frame.values, 0)))
 
+            self.assertRaises(Exception, func, self.simple, self.simple[:2])
+
         test_comp(operator.eq)
         test_comp(operator.lt)
         test_comp(operator.gt)
@@ -1404,6 +1406,16 @@ class TestDataFrame(unittest.TestCase):
         self.assert_(np.array_equal(merged['MergedD'], target['D']))
 
         # Test when some are missing
+        df_a = DataFrame([[1], [2], [3]], index=['a', 'b', 'c'],
+                         columns=['one'])
+        df_b = DataFrame([['foo'], ['bar']], index=[1, 2],
+                         columns=['two'])
+        df_c = DataFrame([[1], [2]], index=[1, 2],
+                         columns=['three'])
+        joined = df_a.join(df_b, on='one')
+        joined = joined.join(df_c, on='one')
+        self.assert_(np.isnan(joined['two']['c']))
+        self.assert_(np.isnan(joined['three']['c']))
 
         # merge column not p resent
         self.assertRaises(Exception, target.join, source, on='E')
