commit c10fce142d5d19ba2d05e56483195cee591764e3
Author: Phillip Cloud <cpcloud@gmail.com>
Date:   Sat Jul 27 16:19:27 2013 -0400

    TST/BUG: fix NameError in network decorator

diff --git a/pandas/util/testing.py b/pandas/util/testing.py
index d900c86ed..f28dfac25 100644
--- a/pandas/util/testing.py
+++ b/pandas/util/testing.py
@@ -12,7 +12,7 @@ import os
 
 from datetime import datetime
 from functools import wraps
-from contextlib import contextmanager, closing
+from contextlib import contextmanager
 from httplib import HTTPException
 from urllib2 import urlopen
 from distutils.version import LooseVersion
@@ -31,8 +31,6 @@ from pandas import bdate_range
 from pandas.tseries.index import DatetimeIndex
 from pandas.tseries.period import PeriodIndex
 
-from pandas.io.common import urlopen
-
 Index = index.Index
 MultiIndex = index.MultiIndex
 Series = series.Series
@@ -767,7 +765,10 @@ def network(t, raise_on_error=_RAISE_NETWORK_ERROR_DEFAULT,
         if raise_on_error:
             return t(*args, **kwargs)
         else:
+            runs = 0
+
             for _ in range(num_runs):
+
                 try:
                     try:
                         return t(*args, **kwargs)
@@ -781,6 +782,8 @@ def network(t, raise_on_error=_RAISE_NETWORK_ERROR_DEFAULT,
                     else:
                        raise
 
+                runs += 1
+
     return network_wrapper
 
 
