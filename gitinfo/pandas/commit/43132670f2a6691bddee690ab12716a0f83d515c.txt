commit 43132670f2a6691bddee690ab12716a0f83d515c
Author: Tom Augspurger <TomAugspurger@users.noreply.github.com>
Date:   Fri Nov 15 09:25:56 2019 -0600

    CI: Bump s3fs (#29573)

diff --git a/ci/deps/travis-36-cov.yaml b/ci/deps/travis-36-cov.yaml
index e4e917d13..b2a74fcea 100644
--- a/ci/deps/travis-36-cov.yaml
+++ b/ci/deps/travis-36-cov.yaml
@@ -29,7 +29,7 @@ dependencies:
   - python-snappy
   - python=3.6.*
   - pytz
-  - s3fs<0.3
+  - s3fs
   - scikit-learn
   - scipy
   - sqlalchemy
diff --git a/ci/deps/travis-36-locale.yaml b/ci/deps/travis-36-locale.yaml
index 44795766d..09f72e650 100644
--- a/ci/deps/travis-36-locale.yaml
+++ b/ci/deps/travis-36-locale.yaml
@@ -26,7 +26,7 @@ dependencies:
   - python-dateutil
   - python=3.6.*
   - pytz
-  - s3fs=0.0.8
+  - s3fs=0.3.0
   - scipy
   - sqlalchemy=1.1.4
   - xarray=0.10
diff --git a/ci/deps/travis-36-slow.yaml b/ci/deps/travis-36-slow.yaml
index d54708d48..e9c5dadbc 100644
--- a/ci/deps/travis-36-slow.yaml
+++ b/ci/deps/travis-36-slow.yaml
@@ -18,7 +18,7 @@ dependencies:
   - python-dateutil
   - python=3.6.*
   - pytz
-  - s3fs<0.3
+  - s3fs
   - scipy
   - sqlalchemy
   - xlrd
diff --git a/ci/deps/travis-37.yaml b/ci/deps/travis-37.yaml
index 440ca6c48..903636f2f 100644
--- a/ci/deps/travis-37.yaml
+++ b/ci/deps/travis-37.yaml
@@ -17,7 +17,7 @@ dependencies:
   - pytest-xdist>=1.29.0
   - pytest-mock
   - hypothesis>=3.58.0
-  - s3fs<0.3
+  - s3fs
   - pip
   - pyreadstat
   - pip:
diff --git a/doc/source/getting_started/install.rst b/doc/source/getting_started/install.rst
index 1ca1640f9..663948fd4 100644
--- a/doc/source/getting_started/install.rst
+++ b/doc/source/getting_started/install.rst
@@ -263,7 +263,7 @@ pymysql                   0.7.11             MySQL engine for sqlalchemy
 pyreadstat                                   SPSS files (.sav) reading
 pytables                  3.4.2              HDF5 reading / writing
 qtpy                                         Clipboard I/O
-s3fs                      0.0.8              Amazon S3 access
+s3fs                      0.3.0              Amazon S3 access
 xarray                    0.8.2              pandas-like API for N-dimensional data
 xclip                                        Clipboard I/O on linux
 xlrd                      1.1.0              Excel reading
diff --git a/doc/source/whatsnew/v1.0.0.rst b/doc/source/whatsnew/v1.0.0.rst
index 3b7756256..896ae91c6 100644
--- a/doc/source/whatsnew/v1.0.0.rst
+++ b/doc/source/whatsnew/v1.0.0.rst
@@ -183,6 +183,7 @@ Backwards incompatible API changes
 Other API changes
 ^^^^^^^^^^^^^^^^^
 
+- Bumpded the minimum supported version of ``s3fs`` from 0.0.8 to 0.3.0 (:issue:`28616`)
 - :class:`pandas.core.groupby.GroupBy.transform` now raises on invalid operation names (:issue:`27489`)
 - :meth:`pandas.api.types.infer_dtype` will now return "integer-na" for integer and ``np.nan`` mix (:issue:`27283`)
 - :meth:`MultiIndex.from_arrays` will no longer infer names from arrays if ``names=None`` is explicitly provided (:issue:`27292`)
diff --git a/pandas/compat/_optional.py b/pandas/compat/_optional.py
index cd4e1b7e8..144255787 100644
--- a/pandas/compat/_optional.py
+++ b/pandas/compat/_optional.py
@@ -18,7 +18,7 @@ VERSIONS = {
     "pandas_gbq": "0.8.0",
     "pyarrow": "0.9.0",
     "pytables": "3.4.2",
-    "s3fs": "0.0.8",
+    "s3fs": "0.3.0",
     "scipy": "0.19.0",
     "sqlalchemy": "1.1.4",
     "tables": "3.4.2",
diff --git a/pandas/tests/io/conftest.py b/pandas/tests/io/conftest.py
index 7b6b9b638..3f034107e 100644
--- a/pandas/tests/io/conftest.py
+++ b/pandas/tests/io/conftest.py
@@ -40,7 +40,7 @@ def s3_resource(tips_file, jsonl_file):
     A private bucket "cant_get_it" is also created. The boto3 s3 resource
     is yielded by the fixture.
     """
-    pytest.importorskip("s3fs")
+    s3fs = pytest.importorskip("s3fs")
     boto3 = pytest.importorskip("boto3")
 
     with tm.ensure_safe_environment_variables():
@@ -77,6 +77,7 @@ def s3_resource(tips_file, jsonl_file):
 
             conn.create_bucket(Bucket="cant_get_it", ACL="private")
             add_tips_files("cant_get_it")
+            s3fs.S3FileSystem.clear_instance_cache()
             yield conn
         finally:
             s3.stop()
diff --git a/pandas/tests/io/parser/test_network.py b/pandas/tests/io/parser/test_network.py
index dbe721b10..57e2950b0 100644
--- a/pandas/tests/io/parser/test_network.py
+++ b/pandas/tests/io/parser/test_network.py
@@ -166,7 +166,7 @@ class TestS3:
         # Receive a permission error when trying to read a private bucket.
         # It's irrelevant here that this isn't actually a table.
         with pytest.raises(IOError):
-            read_csv("s3://cant_get_it/")
+            read_csv("s3://cant_get_it/file.csv")
 
     def test_read_csv_handles_boto_s3_object(self, s3_resource, tips_file):
         # see gh-16135
@@ -184,6 +184,8 @@ class TestS3:
 
     def test_read_csv_chunked_download(self, s3_resource, caplog):
         # 8 MB, S3FS usees 5MB chunks
+        import s3fs
+
         df = DataFrame(np.random.randn(100000, 4), columns=list("abcd"))
         buf = BytesIO()
         str_buf = StringIO()
@@ -194,7 +196,13 @@ class TestS3:
 
         s3_resource.Bucket("pandas-test").put_object(Key="large-file.csv", Body=buf)
 
-        with caplog.at_level(logging.DEBUG, logger="s3fs.core"):
+        # Possibly some state leaking in between tests.
+        # If we don't clear this cache, we saw `GetObject operation: Forbidden`.
+        # Presumably the s3fs instance is being cached, with the directory listing
+        # from *before* we add the large-file.csv in the pandas-test bucket.
+        s3fs.S3FileSystem.clear_instance_cache()
+
+        with caplog.at_level(logging.DEBUG, logger="s3fs"):
             read_csv("s3://pandas-test/large-file.csv", nrows=5)
             # log of fetch_range (start, stop)
             assert (0, 5505024) in {x.args[-2:] for x in caplog.records}
