commit 01bc3e00b117ec81990edc7cdb913ab85774c9c2
Author: y-p <yoval@gmx.com>
Date:   Sat Nov 24 04:36:28 2012 +0200

    TST: df.pop() of non-unique column

diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 955cfedd7..5e77bfa6c 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -2978,6 +2978,18 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
         foo = self.frame.pop('foo')
         self.assert_('foo' not in self.frame)
 
+    def test_pop_non_unique_cols(self):
+        df=DataFrame({0:[0,1],1:[0,1],2:[4,5]})
+        df.columns=["a","b","a"]
+
+        res=df.pop("a")
+        self.assertEqual(type(res),DataFrame)
+        self.assertEqual(len(res),2)
+        self.assertEqual(len(df.columns),1)
+        self.assertTrue("b" in df.columns)
+        self.assertFalse("a" in df.columns)
+        self.assertEqual(len(df.index),2)
+
     def test_iter(self):
         self.assert_(tm.equalContents(list(self.frame), self.frame.columns))
 
