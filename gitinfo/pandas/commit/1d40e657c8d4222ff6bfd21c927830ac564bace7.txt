commit 1d40e657c8d4222ff6bfd21c927830ac564bace7
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sat Jun 11 21:52:42 2011 -0400

    rolling moments will return SparseDataFrame now

diff --git a/pandas/stats/moments.py b/pandas/stats/moments.py
index bf9790bfd..7ec7ae036 100644
--- a/pandas/stats/moments.py
+++ b/pandas/stats/moments.py
@@ -84,13 +84,8 @@ def _rolling_moment(arg, window, func, minp, axis=0, time_rule=None):
 
 def _process_data_structure(arg, kill_inf=True):
     if isinstance(arg, DataFrame):
-        if isinstance(arg, DataMatrix):
-            return_hook = lambda v: DataMatrix(v, index=arg.index,
-                                               columns=arg.columns,
-                                               objects=arg.objects)
-        else:
-            return_hook = lambda v: DataFrame(v, index=arg.index,
-                                              columns=arg.columns)
+        return_hook = lambda v: type(arg)(v, index=arg.index,
+                                          columns=arg.columns)
         values = arg.values
     elif isinstance(arg, Series):
         values = arg.values
