commit 36a15ef6fb6b30bc8f67b904f2dd6767eb08a60a
Author: y-p <yoval@gmx.com>
Date:   Tue Mar 12 21:39:16 2013 +0200

    ENH: add bounds-checking preamble to groupby_X cython code

diff --git a/pandas/src/generate_code.py b/pandas/src/generate_code.py
index c94ed8730..098a63069 100644
--- a/pandas/src/generate_code.py
+++ b/pandas/src/generate_code.py
@@ -593,6 +593,9 @@ def groupby_%(name)s(ndarray[%(c_type)s] index, ndarray labels):
 
     length = len(index)
 
+    if not length == len(labels):
+       raise AssertionError("len(index) != len(labels)")
+
     for i in range(length):
         key = util.get_value_1d(labels, i)
 
diff --git a/pandas/src/generated.pyx b/pandas/src/generated.pyx
index ce83e0878..40e917bc7 100644
--- a/pandas/src/generated.pyx
+++ b/pandas/src/generated.pyx
@@ -1967,6 +1967,9 @@ def groupby_float64(ndarray[float64_t] index, ndarray labels):
 
     length = len(index)
 
+    if not length == len(labels):
+       raise AssertionError("len(index) != len(labels)")
+
     for i in range(length):
         key = util.get_value_1d(labels, i)
 
@@ -1992,6 +1995,9 @@ def groupby_float32(ndarray[float32_t] index, ndarray labels):
 
     length = len(index)
 
+    if not length == len(labels):
+       raise AssertionError("len(index) != len(labels)")
+
     for i in range(length):
         key = util.get_value_1d(labels, i)
 
@@ -2017,6 +2023,9 @@ def groupby_object(ndarray[object] index, ndarray labels):
 
     length = len(index)
 
+    if not length == len(labels):
+       raise AssertionError("len(index) != len(labels)")
+
     for i in range(length):
         key = util.get_value_1d(labels, i)
 
@@ -2042,6 +2051,9 @@ def groupby_int32(ndarray[int32_t] index, ndarray labels):
 
     length = len(index)
 
+    if not length == len(labels):
+       raise AssertionError("len(index) != len(labels)")
+
     for i in range(length):
         key = util.get_value_1d(labels, i)
 
@@ -2067,6 +2079,9 @@ def groupby_int64(ndarray[int64_t] index, ndarray labels):
 
     length = len(index)
 
+    if not length == len(labels):
+       raise AssertionError("len(index) != len(labels)")
+
     for i in range(length):
         key = util.get_value_1d(labels, i)
 
@@ -2092,6 +2107,9 @@ def groupby_bool(ndarray[uint8_t] index, ndarray labels):
 
     length = len(index)
 
+    if not length == len(labels):
+       raise AssertionError("len(index) != len(labels)")
+
     for i in range(length):
         key = util.get_value_1d(labels, i)
 
