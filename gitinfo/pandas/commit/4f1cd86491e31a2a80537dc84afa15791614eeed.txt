commit 4f1cd86491e31a2a80537dc84afa15791614eeed
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Jun 17 13:50:09 2012 -0400

    BUG: handling of NA in algorithms.quantile

diff --git a/pandas/core/algorithms.py b/pandas/core/algorithms.py
index f43b8464b..2df8b4040 100644
--- a/pandas/core/algorithms.py
+++ b/pandas/core/algorithms.py
@@ -231,9 +231,17 @@ def quantile(x, q, interpolation_method='fraction'):
     49.5
 
     """
-    values = np.sort(np.asarray(x))
+    x = np.asarray(x)
+    mask = com.isnull(x)
+
+    x = x[-mask]
+
+    values = np.sort(x)
 
     def _get_score(at):
+        if len(values) == 0:
+            return np.nan
+
         idx = at * (len(values) - 1)
         if (idx % 1 == 0):
             score = values[idx]
diff --git a/pandas/tools/tests/test_tile.py b/pandas/tools/tests/test_tile.py
index 095a278b6..51e905588 100644
--- a/pandas/tools/tests/test_tile.py
+++ b/pandas/tools/tests/test_tile.py
@@ -146,6 +146,13 @@ class TestCut(unittest.TestCase):
         ex_levels = ['[0, 2.25]', '(2.25, 4.5]', '(4.5, 6.75]', '(6.75, 9]']
         self.assert_((cats.levels == ex_levels).all())
 
+    def test_qcut_nas(self):
+        arr = np.random.randn(100)
+        arr[:20] = np.nan
+
+        result = qcut(arr, 4)
+        self.assert_(com.isnull(result[:20]).all())
+
 if __name__ == '__main__':
     nose.runmodule(argv=[__file__,'-vvs','-x','--pdb', '--pdb-failure'],
                    exit=False)
