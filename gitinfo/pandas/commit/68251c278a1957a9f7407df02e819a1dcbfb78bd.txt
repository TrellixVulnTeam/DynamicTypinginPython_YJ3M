commit 68251c278a1957a9f7407df02e819a1dcbfb78bd
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Sep 17 15:14:10 2012 -0400

    BUG: handling of 0-length arrays in ewm* functions close #1900

diff --git a/RELEASE.rst b/RELEASE.rst
index e8f019698..38e154aae 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -168,6 +168,7 @@ pandas 0.9.0
   - Support datetime.date again in DateOffset.rollback/rollforward
   - Raise Exception if set passed to Series constructor (#1913)
   - Add TypeError when appending HDFStore table w/ wrong index type (#1881)
+  - Don't raise exception on empty inputs in EW functions (e.g. ewma) (#1900)
 
 pandas 0.8.1
 ============
diff --git a/pandas/src/moments.pyx b/pandas/src/moments.pyx
index 05d71311d..503a63c9d 100644
--- a/pandas/src/moments.pyx
+++ b/pandas/src/moments.pyx
@@ -258,6 +258,8 @@ def ewma(ndarray[double_t] input, double_t com, int adjust):
 
     cdef ndarray[double_t] output = np.empty(N, dtype=float)
 
+    if N == 0:
+        return output
 
     neww = 1. / (1. + com)
     oldw = 1. - neww
diff --git a/pandas/stats/moments.py b/pandas/stats/moments.py
index 5e7552d61..cfdc4aa8a 100644
--- a/pandas/stats/moments.py
+++ b/pandas/stats/moments.py
@@ -311,7 +311,7 @@ def ewma(arg, com=None, span=None, min_periods=0, freq=None, time_rule=None,
 
 def _first_valid_index(arr):
     # argmax scans from left
-    return notnull(arr).argmax()
+    return notnull(arr).argmax() if len(arr) else 0
 
 @Substitution("Exponentially-weighted moving variance", _unary_arg, _bias_doc)
 @Appender(_ewm_doc)
diff --git a/pandas/stats/tests/test_moments.py b/pandas/stats/tests/test_moments.py
index ff5fd621e..05cd3227a 100644
--- a/pandas/stats/tests/test_moments.py
+++ b/pandas/stats/tests/test_moments.py
@@ -293,6 +293,14 @@ class TestMoments(unittest.TestCase):
         self.assertRaises(Exception, mom.ewma, self.arr, com=9.5, span=20)
         self.assertRaises(Exception, mom.ewma, self.arr)
 
+    def test_ew_empty_arrays(self):
+        arr = np.array([], dtype=np.float64)
+
+        funcs = [mom.ewma, mom.ewmvol, mom.ewmvar]
+        for f in funcs:
+            result = f(arr, 3)
+            assert_almost_equal(result, arr)
+
     def _check_ew(self, func):
         self._check_ew_ndarray(func)
         self._check_ew_structures(func)
