commit daf0c67da7449ba3fc7efe7b8d8230e26c1ad50c
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Thu Jan 26 11:58:03 2012 -0500

    BUG: raise exception in DateRange with MonthEnd(0) instead of infinite loop, GH #683

diff --git a/pandas/core/daterange.py b/pandas/core/daterange.py
index 408ec43c1..152510c2a 100644
--- a/pandas/core/daterange.py
+++ b/pandas/core/daterange.py
@@ -502,11 +502,15 @@ def generate_range(start=None, end=None, periods=None,
     if offset._normalizeFirst:
         cur = datetools.normalize_date(cur)
 
+    next_date = cur
     while cur <= end:
         yield cur
 
         # faster than cur + offset
-        cur = offset.apply(cur)
+        next_date = offset.apply(cur)
+        if next_date <= cur:
+            raise ValueError('Offset %s did not increment date' % offset)
+        cur = next_date
 
 # Do I want to cache UTC dates? Can't decide...
 
diff --git a/pandas/tests/test_daterange.py b/pandas/tests/test_daterange.py
index 9b94b6fc3..41728ce66 100644
--- a/pandas/tests/test_daterange.py
+++ b/pandas/tests/test_daterange.py
@@ -350,6 +350,10 @@ class TestDateRange(unittest.TestCase):
         result = rng1.union(rng2)
         self.assert_(type(result) == DateRange)
 
+    def test_error_with_zero_monthends(self):
+        self.assertRaises(ValueError, DateRange, '1/1/2000', '1/1/2001',
+                          offset=datetools.MonthEnd(0))
+
 def _skip_if_no_pytz():
     try:
         import pytz
