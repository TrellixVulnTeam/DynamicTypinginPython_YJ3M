commit ba93669de22314038fca16788fc5a318e2a217c5
Author: Wouter Overmeire <lodagro@gmail.com>
Date:   Thu Sep 20 11:02:04 2012 +0200

    TST: when xlrd is not installed skip tests needing it, close #1941

diff --git a/pandas/io/tests/test_parsers.py b/pandas/io/tests/test_parsers.py
index 1f0ac436c..d74969c58 100644
--- a/pandas/io/tests/test_parsers.py
+++ b/pandas/io/tests/test_parsers.py
@@ -787,6 +787,7 @@ baz,7,8,9
 
     def test_parse_cols_int(self):
         _skip_if_no_openpyxl()
+        _skip_if_no_xlrd()
 
         suffix = ['', 'x']
 
@@ -804,11 +805,11 @@ baz,7,8,9
 
     def test_parse_cols_list(self):
         _skip_if_no_openpyxl()
+        _skip_if_no_xlrd()
 
         suffix = ['', 'x']
 
         for s in suffix:
-
             pth = os.path.join(self.dirpath, 'test.xls%s' % s)
             xlsx = ExcelFile(pth)
             df = xlsx.parse('Sheet1', index_col=0, parse_dates=True,
diff --git a/pandas/tests/test_frame.py b/pandas/tests/test_frame.py
index 4a25a84a4..40f589600 100644
--- a/pandas/tests/test_frame.py
+++ b/pandas/tests/test_frame.py
@@ -3648,6 +3648,7 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
 
     def test_to_excel_float_format(self):
         try:
+            import xlrd
             import xlwt
             import openpyxl
         except ImportError:
@@ -3671,6 +3672,7 @@ class TestDataFrame(unittest.TestCase, CheckIndexing,
     def test_to_excel_unicode_filename(self):
         try:
             import xlwt
+            import xlrd
             import openpyxl
         except ImportError:
             raise nose.SkipTest
