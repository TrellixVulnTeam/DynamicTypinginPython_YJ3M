commit 491e636cde8ed08bb0c26d80cd608ca8679407b3
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Sun Apr 22 11:27:58 2012 -0400

    BUG: raise exception with partial indexing on unordered time series, close #1080

diff --git a/pandas/tseries/index.py b/pandas/tseries/index.py
index e307bfa80..dd7d8ec94 100644
--- a/pandas/tseries/index.py
+++ b/pandas/tseries/index.py
@@ -93,6 +93,10 @@ def _dt_index_op(opname):
     return wrapper
 
 
+class TimeSeriesError(Exception):
+    pass
+
+
 _midnight = time(0, 0)
 
 class DatetimeIndex(Int64Index):
@@ -666,6 +670,10 @@ class DatetimeIndex(Int64Index):
             return self._view_like(left_chunk)
 
     def _partial_date_slice(self, reso, parsed):
+        if not self.is_monotonic:
+            raise TimeSeriesError('Partial indexing only valid for ordered time'
+                                  ' series')
+
         if reso == 'year':
             t1 = Timestamp(datetime(parsed.year, 1, 1))
             t2 = Timestamp(datetime(parsed.year, 12, 31))
diff --git a/pandas/tseries/tests/test_timeseries.py b/pandas/tseries/tests/test_timeseries.py
index 25a8c6b04..6429459a3 100644
--- a/pandas/tseries/tests/test_timeseries.py
+++ b/pandas/tseries/tests/test_timeseries.py
@@ -641,6 +641,13 @@ class TestLegacySupport(unittest.TestCase):
         expected = s[:'20060228']
         assert_series_equal(result, expected)
 
+    def test_partial_not_monotonic(self):
+        rng = date_range(datetime(2005,1,1), periods=20, freq='M')
+        ts = Series(np.arange(len(rng)), index=rng)
+        ts = ts.take(np.random.permutation(20))
+
+        self.assertRaises(Exception, ts.__getitem__, '2005')
+
     def test_date_range_normalize(self):
         snap = datetime.today()
         n = 50
