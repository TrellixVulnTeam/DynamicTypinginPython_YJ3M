commit 288040778e2c406a321ebb0cc71859c54d916986
Author: Brenda Moon <brenda@moon.net.au>
Date:   Mon Oct 8 17:05:19 2012 +1100

    refactor plotting.py to only have _maybe_add_color defined once

diff --git a/pandas/tools/plotting.py b/pandas/tools/plotting.py
index 4a85fb590..419522781 100644
--- a/pandas/tools/plotting.py
+++ b/pandas/tools/plotting.py
@@ -876,6 +876,13 @@ class LinePlot(MPLPlot):
         colors = self.kwds.pop('colors', cycle)
         return has_colors, colors
 
+    def _maybe_add_color(self, kwds, style, i):
+        has_colors, colors = self._get_colors()
+        if (not has_colors and
+           (style is None or re.match('[a-z]+', style) is None)
+            and 'color' not in kwds):
+            kwds['color'] = colors[i % len(colors)]
+
     def _make_plot(self):
         # this is slightly deceptive
         if self.use_index and self._use_dynamic_x():
@@ -886,13 +893,6 @@ class LinePlot(MPLPlot):
             labels = []
             x = self._get_xticks(convert_period=True)
 
-            has_colors, colors = self._get_colors()
-            def _maybe_add_color(kwargs, style, i):
-                if (not has_colors and
-                    (style is None or re.match('[a-z]+', style) is None)
-                    and 'color' not in kwargs):
-                    kwargs['color'] = colors[i % len(colors)]
-
             plotf = self._get_plot_function()
 
             for i, (label, y) in enumerate(self._iter_data()):
@@ -900,7 +900,8 @@ class LinePlot(MPLPlot):
                 style = self._get_style(i, label)
                 kwds = self.kwds.copy()
 
-                _maybe_add_color(kwds, style, i)
+# not sure if I need to return kwargs & set to kwds or is it pass by reference?
+                self._maybe_add_color(kwds, style, i)
 
                 label = _stringify(label)
 
@@ -934,12 +935,6 @@ class LinePlot(MPLPlot):
         lines = []
         labels = []
 
-        def _maybe_add_color(kwargs, style, i):
-            if (not has_colors and
-                (style is None or re.match('[a-z]+', style) is None)
-                   and 'color' not in kwargs):
-                kwargs['color'] = colors[i % len(colors)]
-
         def to_leg_label(label, i):
             if self.mark_right and self.on_right(i):
                 return label + ' (right)'
@@ -950,7 +945,7 @@ class LinePlot(MPLPlot):
             style = self.style or ''
             label = com._stringify(self.label)
             kwds = kwargs.copy()
-            _maybe_add_color(kwds, style, 0)
+            self._maybe_add_color(kwds, style, 0)
 
             newlines = tsplot(data, plotf, ax=ax, label=label, style=self.style,
                              **kwds)
@@ -965,7 +960,7 @@ class LinePlot(MPLPlot):
                 style = self._get_style(i, col)
                 kwds = kwargs.copy()
 
-                _maybe_add_color(kwds, style, i)
+                self._maybe_add_color(kwds, style, i)
 
                 newlines = tsplot(data[col], plotf, ax=ax, label=label,
                                   style=style, **kwds)
