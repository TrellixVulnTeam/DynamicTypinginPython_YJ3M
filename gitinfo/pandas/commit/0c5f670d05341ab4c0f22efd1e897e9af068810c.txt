commit 0c5f670d05341ab4c0f22efd1e897e9af068810c
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed May 9 10:23:46 2012 -0400

    BLD: store labels as platform int in MultiIndex

diff --git a/pandas/core/index.py b/pandas/core/index.py
index a74805242..80a08ec55 100644
--- a/pandas/core/index.py
+++ b/pandas/core/index.py
@@ -1169,7 +1169,7 @@ class MultiIndex(Index):
             return Index(levels[0], name=name).take(labels[0])
 
         levels = [_ensure_index(lev) for lev in levels]
-        labels = [np.asarray(labs, dtype=np.int64) for labs in labels]
+        labels = [np.asarray(labs, dtype=np.int_) for labs in labels]
 
         values = [ndtake(np.asarray(lev), lab)
                   for lev, lab in zip(levels, labels)]
diff --git a/pandas/src/datetime.pyx b/pandas/src/datetime.pyx
index bcbc080fc..cbfe41474 100644
--- a/pandas/src/datetime.pyx
+++ b/pandas/src/datetime.pyx
@@ -1394,40 +1394,40 @@ cdef int apply_accessor(accessor func, int64_t value, int freq,
     return func(value, freq)
 
 cpdef int get_period_year(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pyear, value, freq, mult)
+    return apply_accessor(&pyear, value, freq, mult)
 
 cpdef int get_period_qyear(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pqyear, value, freq, mult)
+    return apply_accessor(&pqyear, value, freq, mult)
 
 cpdef int get_period_quarter(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pquarter, value, freq, mult)
+    return apply_accessor(&pquarter, value, freq, mult)
 
 cpdef int get_period_month(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pmonth, value, freq, mult)
+    return apply_accessor(&pmonth, value, freq, mult)
 
 cpdef int get_period_day(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pday, value, freq, mult)
+    return apply_accessor(&pday, value, freq, mult)
 
 cpdef int get_period_hour(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(phour, value, freq, mult)
+    return apply_accessor(&phour, value, freq, mult)
 
 cpdef int get_period_minute(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pminute, value, freq, mult)
+    return apply_accessor(&pminute, value, freq, mult)
 
 cpdef int get_period_second(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(psecond, value, freq, mult)
+    return apply_accessor(&psecond, value, freq, mult)
 
 cpdef int get_period_dow(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pday_of_week, value, freq, mult)
+    return apply_accessor(&pday_of_week, value, freq, mult)
 
 cpdef int get_period_week(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pweek, value, freq, mult)
+    return apply_accessor(&pweek, value, freq, mult)
 
 cpdef int get_period_weekday(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pweekday, value, freq, mult)
+    return apply_accessor(&pweekday, value, freq, mult)
 
 cpdef int get_period_doy(int64_t value, int freq, int64_t mult) except -1:
-    return apply_accessor(pday_of_year, value, freq, mult)
+    return apply_accessor(&pday_of_year, value, freq, mult)
 
 # same but for arrays
 
@@ -1448,40 +1448,40 @@ cdef ndarray[int64_t] apply_accessor_arr(accessor func,
     return out
 
 def get_period_year_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pyear, arr, freq, mult)
+    return apply_accessor_arr(&pyear, arr, freq, mult)
 
 def get_period_qyear_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pqyear, arr, freq, mult)
+    return apply_accessor_arr(&pqyear, arr, freq, mult)
 
 def get_period_quarter_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pquarter, arr, freq, mult)
+    return apply_accessor_arr(&pquarter, arr, freq, mult)
 
 def get_period_month_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pmonth, arr, freq, mult)
+    return apply_accessor_arr(&pmonth, arr, freq, mult)
 
 def get_period_day_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pday, arr, freq, mult)
+    return apply_accessor_arr(&pday, arr, freq, mult)
 
 def get_period_hour_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(phour, arr, freq, mult)
+    return apply_accessor_arr(&phour, arr, freq, mult)
 
 def get_period_minute_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pminute, arr, freq, mult)
+    return apply_accessor_arr(&pminute, arr, freq, mult)
 
 def get_period_second_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(psecond, arr, freq, mult)
+    return apply_accessor_arr(&psecond, arr, freq, mult)
 
 def get_period_dow_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pday_of_week, arr, freq, mult)
+    return apply_accessor_arr(&pday_of_week, arr, freq, mult)
 
 def get_period_week_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pweek, arr, freq, mult)
+    return apply_accessor_arr(&pweek, arr, freq, mult)
 
 def get_period_weekday_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pweekday, arr, freq, mult)
+    return apply_accessor_arr(&pweekday, arr, freq, mult)
 
 def get_period_doy_arr(ndarray[int64_t] arr, int freq, int64_t mult):
-    return apply_accessor_arr(pday_of_year, arr, freq, mult)
+    return apply_accessor_arr(&pday_of_year, arr, freq, mult)
 
 def get_abs_time(freq, dailyDate, originalDate):
     return getAbsTime(freq, dailyDate, originalDate)
