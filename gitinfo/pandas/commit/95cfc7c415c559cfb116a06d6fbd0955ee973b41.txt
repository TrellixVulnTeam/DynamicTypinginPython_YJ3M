commit 95cfc7c415c559cfb116a06d6fbd0955ee973b41
Author: Adam Klein <adamklein@gmail.com>
Date:   Tue Feb 28 13:21:35 2012 -0500

    BUG: close #837, excelfile throws an exception for two-line file

diff --git a/RELEASE.rst b/RELEASE.rst
index 5033ff07a..71305b294 100644
--- a/RELEASE.rst
+++ b/RELEASE.rst
@@ -50,6 +50,7 @@ pandas 0.7.1
   - Fix exception thrown on np.diff (#816)
   - Fix to_records where columns are non-strings (#822)
   - Fix Index.intersection where indices have incomparable types (#811)
+  - Fix ExcelFile throwing an exception for two-line file (#837)
 
 pandas 0.7.0
 ============
diff --git a/pandas/io/parsers.py b/pandas/io/parsers.py
index 5e0e9a908..0c2f4274b 100644
--- a/pandas/io/parsers.py
+++ b/pandas/io/parsers.py
@@ -350,7 +350,10 @@ class TextParser(object):
             while self.pos in self.skiprows:
                 self.pos += 1
 
-            line = self.data[self.pos]
+            try:
+                line = self.data[self.pos]
+            except IndexError:
+                raise StopIteration
         else:
             while self.pos in self.skiprows:
                 self.data.next()
diff --git a/pandas/io/tests/test2.xls b/pandas/io/tests/test2.xls
new file mode 100644
index 000000000..dadeb7c24
Binary files /dev/null and b/pandas/io/tests/test2.xls differ
diff --git a/pandas/io/tests/test_parsers.py b/pandas/io/tests/test_parsers.py
index ed3871d1c..d4d9172b6 100644
--- a/pandas/io/tests/test_parsers.py
+++ b/pandas/io/tests/test_parsers.py
@@ -219,6 +219,12 @@ baz,7,8,9
         self.assert_(df.ix[:, ['A', 'B', 'C', 'D']].values.dtype == np.float64)
         assert_frame_equal(df, df2)
 
+    def test_excel_stop_iterator(self):
+        excel_data = ExcelFile(os.path.join(self.dirpath, 'test2.xls'))
+        parsed = excel_data.parse('Sheet1')
+        expected = DataFrame([['aaaa','bbbbb']], columns=['Test', 'Test1'])
+        assert_frame_equal(parsed, expected)
+
     def test_excel_table(self):
         try:
             import xlrd
