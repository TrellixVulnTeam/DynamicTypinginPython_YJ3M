commit e5193c0a726b4497e3f7e3e58d67827319b0d9c4
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Mon Oct 24 13:58:17 2011 -0400

    ENH: check for duplicate level names, GH #280

diff --git a/pandas/core/index.py b/pandas/core/index.py
index 62a141378..0ce3f33bf 100644
--- a/pandas/core/index.py
+++ b/pandas/core/index.py
@@ -889,6 +889,11 @@ class MultiIndex(Index):
 
     def _get_level_number(self, level):
         if not isinstance(level, int):
+            count = self.names.count(level)
+            if count > 1:
+                raise Exception('The name %s occurs multiple times, use a '
+                                'level number' % level)
+
             level = self.names.index(level)
         elif level < 0:
             level += self.nlevels
diff --git a/pandas/tests/test_index.py b/pandas/tests/test_index.py
index edd477e38..f4c8764b8 100644
--- a/pandas/tests/test_index.py
+++ b/pandas/tests/test_index.py
@@ -601,6 +601,10 @@ class TestMultiIndex(unittest.TestCase):
     def test_constructor_no_levels(self):
         self.assertRaises(Exception, MultiIndex, levels=[], labels=[])
 
+    def test_duplicate_names(self):
+        self.index.names = ['foo', 'foo']
+        self.assertRaises(Exception, self.index._get_level_number, 'foo')
+
     def test_from_arrays(self):
         arrays = []
         for lev, lab in zip(self.index.levels, self.index.labels):
