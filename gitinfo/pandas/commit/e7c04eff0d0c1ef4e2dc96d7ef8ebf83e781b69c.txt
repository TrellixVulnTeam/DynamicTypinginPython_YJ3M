commit e7c04eff0d0c1ef4e2dc96d7ef8ebf83e781b69c
Author: Wes McKinney <wesmckinn@gmail.com>
Date:   Wed Sep 7 17:10:56 2011 -0400

    ENH: more flexible boolean setting with DataFrame

diff --git a/pandas/core/frame.py b/pandas/core/frame.py
index 3db69760d..133ad9314 100644
--- a/pandas/core/frame.py
+++ b/pandas/core/frame.py
@@ -855,7 +855,11 @@ class DataFrame(NDFrame):
         if self._data.is_mixed_dtype():
             raise ValueError('Cannot do boolean setting on mixed-type frame')
 
-        self.values[mask] = value
+        if isinstance(value, DataFrame):
+            assert(value._indexed_same(self))
+            np.putmask(self.values, mask, value.values)
+        else:
+            self.values[mask] = value
 
     def insert(self, loc, column, value):
         """
