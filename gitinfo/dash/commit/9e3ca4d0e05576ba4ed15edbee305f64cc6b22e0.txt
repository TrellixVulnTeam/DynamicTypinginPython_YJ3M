commit 9e3ca4d0e05576ba4ed15edbee305f64cc6b22e0
Author: Philippe Duval <philippe@plot.ly>
Date:   Mon Oct 29 13:50:40 2018 -0400

    Fix tests with WebDriverWait.

diff --git a/tests/IntegrationTests.py b/tests/IntegrationTests.py
index 73f21162..09ee32d1 100644
--- a/tests/IntegrationTests.py
+++ b/tests/IntegrationTests.py
@@ -5,6 +5,12 @@ import unittest
 from selenium import webdriver
 import percy
 
+from selenium.webdriver.common.by import By
+from selenium.webdriver.support.ui import WebDriverWait
+from selenium.webdriver.support import expected_conditions as EC
+
+TIMEOUT = 20
+
 
 class IntegrationTests(unittest.TestCase):
 
@@ -15,6 +21,17 @@ class IntegrationTests(unittest.TestCase):
             name=snapshot_name
         )
 
+    def wait_for_element_by_css_selector(self, selector):
+        return WebDriverWait(self.driver, TIMEOUT).until(
+            EC.presence_of_element_located((By.CSS_SELECTOR, selector))
+        )
+
+    def wait_for_text_to_equal(self, selector, assertion_text):
+        return WebDriverWait(self.driver, TIMEOUT).until(
+            EC.text_to_be_present_in_element((By.CSS_SELECTOR, selector),
+                                             assertion_text)
+        )
+
     @classmethod
     def setUpClass(cls):
         super(IntegrationTests, cls).setUpClass()
diff --git a/tests/test_integration.py b/tests/test_integration.py
index 3fcce93c..c507b80a 100644
--- a/tests/test_integration.py
+++ b/tests/test_integration.py
@@ -11,7 +11,7 @@ import dash_dangerously_set_inner_html
 import dash
 import time
 
-from dash.dependencies import Input, Output
+from dash.dependencies import Input, Output, State
 from dash.exceptions import PreventUpdate
 from .IntegrationTests import IntegrationTests
 from .utils import assert_clean_console, invincible, wait_for
@@ -61,8 +61,7 @@ class Tests(IntegrationTests):
 
         input1.send_keys('hello world')
 
-        output1 = lambda: self.wait_for_element_by_id('output-1')
-        wait_for(lambda: output1().text == 'hello world')
+        output1 = self.wait_for_text_to_equal('#output-1', 'hello world')
         self.percy_snapshot(name='simple-callback-2')
 
         self.assertEqual(
@@ -106,8 +105,7 @@ class Tests(IntegrationTests):
             return data
 
         self.startServer(app)
-        output1 = self.wait_for_element_by_id('output-1')
-        wait_for(lambda: output1.text == 'initial value')
+        output1 = self.wait_for_text_to_equal('#output-1', 'initial value')
         self.percy_snapshot(name='wildcard-callback-1')
 
         input1 = self.wait_for_element_by_id('input')
@@ -115,8 +113,7 @@ class Tests(IntegrationTests):
 
         input1.send_keys('hello world')
 
-        output1 = lambda: self.wait_for_element_by_id('output-1')
-        wait_for(lambda: output1().text == 'hello world')
+        output1 = self.wait_for_text_to_equal('#output-1', 'hello world')
         self.percy_snapshot(name='wildcard-callback-2')
 
         self.assertEqual(
