commit 0ee047e85bb14cb3dfcb3ff86b7f262df0004fa8
Author: alexcjohnson <alex@plot.ly>
Date:   Mon Apr 8 14:00:22 2019 -0400

    more test fixing - including @chriddyp's updates to wait_for_*

diff --git a/tests/IntegrationTests.py b/tests/IntegrationTests.py
index c213135e..31dec9da 100644
--- a/tests/IntegrationTests.py
+++ b/tests/IntegrationTests.py
@@ -21,15 +21,25 @@ class IntegrationTests(unittest.TestCase):
             name=snapshot_name
         )
 
-    def wait_for_element_by_css_selector(self, selector):
-        return WebDriverWait(self.driver, TIMEOUT).until(
-            EC.presence_of_element_located((By.CSS_SELECTOR, selector))
+    def wait_for_element_by_css_selector(self, selector, timeout=TIMEOUT):
+        return WebDriverWait(self.driver, timeout).until(
+            EC.presence_of_element_located((By.CSS_SELECTOR, selector)),
+            'Could not find element with selector "{}"'.format(selector)
         )
 
-    def wait_for_text_to_equal(self, selector, assertion_text):
-        return WebDriverWait(self.driver, TIMEOUT).until(
-            EC.text_to_be_present_in_element((By.CSS_SELECTOR, selector),
-                                             assertion_text)
+    def wait_for_text_to_equal(self, selector, assertion_text, timeout=TIMEOUT):
+        self.wait_for_element_by_css_selector(selector)
+        WebDriverWait(self.driver, timeout).until(
+            lambda *args: (
+                (str(self.wait_for_element_by_css_selector(selector).text)
+                 == assertion_text) or
+                 (str(self.wait_for_element_by_css_selector(selector).get_attribute('value'))
+                  == assertion_text)
+            ),
+            "Element '{}' text was supposed to equal '{}' but it didn't".format(
+                selector,
+                assertion_text
+            )
         )
 
     @classmethod
diff --git a/tests/test_integration.py b/tests/test_integration.py
index 0c245b5f..ab66dd02 100644
--- a/tests/test_integration.py
+++ b/tests/test_integration.py
@@ -679,8 +679,8 @@ class Tests(IntegrationTests):
         def show_clicks(n):
             # partial or complete cancelation of updates via no_update
             return [
-                no_update if n > 4 else n,
-                no_update if n > 2 else n,
+                no_update if n and n > 4 else n,
+                no_update if n and n > 2 else n,
                 no_update
             ]
 
