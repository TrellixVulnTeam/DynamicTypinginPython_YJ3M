commit e0b699436abca3f4be0d14424159337e75f9a4b2
Author: Chris P <christopher.parmer@gmail.com>
Date:   Fri Apr 10 12:11:14 2015 -0400

    fix clicks

diff --git a/gapminder/DataBackend.py b/gapminder/DataBackend.py
index c6c23e8d..1a107e0b 100644
--- a/gapminder/DataBackend.py
+++ b/gapminder/DataBackend.py
@@ -56,17 +56,17 @@ class Graph():
                 'xaxis': {
                     'title': labels[self.xaxis],
                     'type': 'log',
-                    'autorange': False,
-                    'range': np.log10([(
-                        min(self.df[self.xaxis])*0.5),
-                        max(self.df[self.xaxis])*1.1])
+                    #'autorange': False,
+                    #'range': np.log10([(
+                    #    min(self.df[self.xaxis])*0.5),
+                    #    max(self.df[self.xaxis])*1.1])
                 },
                 'yaxis': {
                     'title': labels[self.yaxis],
-                    'autorange': False,
-                    'range': [
-                        min(self.df[self.yaxis])*0.8,
-                        max(self.df[self.yaxis])*1.2]
+                    # 'autorange': False,
+                    # 'range': [
+                    #    min(self.df[self.yaxis])*0.8,
+                    #    max(self.df[self.yaxis])*1.2]
                 },
                 'hovermode': 'closest',
                 'annotations': [
@@ -99,7 +99,7 @@ class Graph():
         if 'click' in app_state:
             curveNumber = app_state['click']['points'][0]['curveNumber']
             pointNumber = app_state['click']['points'][0]['pointNumber']
-            text = self.on_slide(app_state)[0]['data'][curveNumber]['text']
+            text = messages[0]['data'][curveNumber]['text']
             self.country = text.get_value(text.index[pointNumber])
 
 
diff --git a/gapminder/templates/index.html b/gapminder/templates/index.html
index 29b3c2c2..cbe6d013 100644
--- a/gapminder/templates/index.html
+++ b/gapminder/templates/index.html
@@ -190,7 +190,7 @@
                         'task': 'listen',
                         'events': ['click']
                     }, 'https://plot.ly');
-                    var payload = getState();
+                    var payload = getState({});
                     payload[id] = id;
                     socket.emit('pong', payload);
                 } else if (message.type==='hover' ||
@@ -209,8 +209,7 @@
             //
             // JQuery UI
             //
-            function getState() {
-                var payload = payload || {};
+            function getState(payload) {
 
                 payload.slider = $('#slider').slider("value");
                 payload.xaxis = $('#xaxis option:selected').val();
@@ -220,9 +219,11 @@
             }
 
             function sendState(that, payload){
-                payload = getState();
-                socket.emit('replot', payload)
+                var payload = payload || {};
+                payload = getState(payload);
+                socket.emit('replot', payload);
             }
+
             $('#slider').on('slide', function(){console.log('change'); sendState({},{'slide': true});});
             $('#xaxis').change(function(){
                 sendState({}, {'select': true})
