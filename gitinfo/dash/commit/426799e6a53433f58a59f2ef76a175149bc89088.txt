commit 426799e6a53433f58a59f2ef76a175149bc89088
Author: Marc-Andr√© Rivet <Marc-Andre-Rivet@users.noreply.github.com>
Date:   Thu Jun 18 17:32:48 2020 -0400

    Issue 1305 - Flask Env & Test Regression (#1306)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 706568be..bc5a7a1a 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -2,6 +2,12 @@
 All notable changes to `dash` will be documented in this file.
 This project adheres to [Semantic Versioning](http://semver.org/).
 
+## [Unreleased] - 2020-06-18
+### Fixed
+- [#1305](https://github.com/plotly/dash/issues/1305)
+    - Fix regression that causes crash when `FLASK_ENV` is modified during app execution
+    - Fix regression that caused tests using `_wait_for_callbacks` to fail
+
 ## [1.13.1] - 2020-06-17
 
 ## [1.13.0] - 2020-06-17
diff --git a/dash/dash.py b/dash/dash.py
index 75c7ba64..0d90d880 100644
--- a/dash/dash.py
+++ b/dash/dash.py
@@ -1612,7 +1612,4 @@ class Dash(object):
                 " in production, use a production WSGI server like gunicorn instead.\n"
             )
 
-        if not os.environ.get("FLASK_ENV"):
-            os.environ["FLASK_ENV"] = "development"
-
         self.server.run(host=host, port=port, debug=debug, **flask_run_options)
diff --git a/dash/testing/dash_page.py b/dash/testing/dash_page.py
index caedb9b5..b4bf4ce5 100644
--- a/dash/testing/dash_page.py
+++ b/dash/testing/dash_page.py
@@ -71,7 +71,7 @@ class DashPageMixin(object):
         return self.driver.execute_script("return window.store")
 
     def _wait_for_callbacks(self):
-        return not self.window_store or self.redux_state_rqs
+        return (not self.window_store) or self.redux_state_rqs == []
 
     def get_local_storage(self, store_id="local"):
         return self.driver.execute_script(
