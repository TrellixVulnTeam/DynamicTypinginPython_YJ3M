commit a281550bc9a5a51a21cdb1f138ec698c2f56c03c
Author: byron <byron@plot.ly>
Date:   Thu May 9 22:28:56 2019 -0400

    :wrench: polish and fix ci config

diff --git a/.circleci/config.yml b/.circleci/config.yml
index cc30bb42..4aefa24d 100644
--- a/.circleci/config.yml
+++ b/.circleci/config.yml
@@ -25,19 +25,23 @@ jobs:
             echo $CIRCLE_JOB > circlejob.txt
 
       - restore_cache:
-          key: py-{{ checksum "reqs.txt" }}
+          key: py-{{ .Branch }}-{{ checksum "circlejob.txt" }}-{{ checksum "reqs.txt" }}-{{ checksum ".circleci/config.yml" }}
       - run:
           name: üöß pip dev requirements
           command: |
+            sudo pip install --upgrade virtualenv
+            python -m venv venv || virtualenv venv
+            . venv/bin/activate
             pip install -r $REQUIREMENTS_FILE --quiet
       - save_cache:
-          key: py-{{ checksum "reqs.txt" }}
+          key: py-{{ .Branch }}-{{ checksum "circlejob.txt" }}-{{ checksum "reqs.txt" }}-{{ checksum ".circleci/config.yml" }}
           paths:
-              - "pyenv"
+              - "venv"
 
       - run:
           name: üå∏ linting
           command: |
+            . venv/bin/activate
             pip install -e . --quiet
             pip list | grep dash
             flake8 dash setup.py
@@ -49,6 +53,7 @@ jobs:
       - run:
           name: ‚õë Run unit tests
           command: |
+            . venv/bin/activate
             mkdir test-reports
             pytest --junitxml=test-reports/junit.xml tests/unit
       - store_test_results:
@@ -59,6 +64,7 @@ jobs:
       - run:
           name: üöß build renderer
           command: |
+              . venv/bin/activate
               cd dash-renderer
               npm install --ignore-scripts && npm run build:dev && npm run build
               pip install -e . --quiet
@@ -70,6 +76,7 @@ jobs:
               git clone --depth 1 https://github.com/plotly/dash-html-components.git
               git clone --depth 1 https://github.com/plotly/dash-table.git
               git clone --depth 1 https://github.com/plotly/dash-renderer-test-components
+              . venv/bin/activate
               cd dash-core-components && npm install --ignore-scripts && npm run build && pip install -e . && cd ..
               cd dash-html-components && npm install --ignore-scripts && npm run build && pip install -e . && cd ..
               cd dash-table && npm install --ignore-scripts && npm run build && pip install -e . && cd ..
@@ -78,7 +85,13 @@ jobs:
       - run:
           name: ‚öôÔ∏è run integration test
           command: |
-            pytest tests/integration/test_integration.py
+            . venv/bin/activate
+            pytest --junitxml=test-reports/junit_intg.xml tests/integration
+      - store_test_results:
+          path: test-reports
+      - store_artifacts:
+          path: test-reports
+
 
   "python-3.6":
     <<: *test-template
