commit 9a98038e464c0d3f8c979d2e8796d0f661c507dc
Author: alexcjohnson <alex@plot.ly>
Date:   Sat Jul 13 09:45:57 2019 -0400

    fix #791: don't try to use Component.keys()

diff --git a/dash/dash.py b/dash/dash.py
index deb28d76..51bdbf36 100644
--- a/dash/dash.py
+++ b/dash/dash.py
@@ -849,6 +849,9 @@ class Dash(object):
                     arg_id = arg.component_id
                     arg_prop = getattr(arg, 'component_property', None)
                     if (arg_id not in layout and arg_id != layout_id):
+                        all_ids = [k for k in layout]
+                        if layout_id:
+                            all_ids.append(layout_id)
                         raise exceptions.NonExistentIdException('''
                             Attempting to assign a callback to the
                             component with the id "{0}" but no
@@ -860,12 +863,7 @@ class Dash(object):
                             (and therefore not in the initial layout), then
                             you can suppress this exception by setting
                             `suppress_callback_exceptions=True`.
-                        '''.format(
-                            arg_id,
-                            list(layout.keys()) + (
-                                [layout_id] if layout_id else []
-                            )
-                        ).replace('    ', ''))
+                        '''.format(arg_id, all_ids).replace('    ', ''))
 
                     component = (
                         layout if layout_id == arg_id else layout[arg_id]
diff --git a/tests/integration/test_integration.py b/tests/integration/test_integration.py
index b17825fa..0e00633d 100644
--- a/tests/integration/test_integration.py
+++ b/tests/integration/test_integration.py
@@ -1,7 +1,5 @@
 from multiprocessing import Value
 import datetime
-import itertools
-import re
 import time
 import pytest
 
@@ -20,7 +18,7 @@ from dash.dependencies import Input, Output, State
 from dash.exceptions import (
     PreventUpdate, DuplicateCallbackOutput, CallbackException,
     MissingCallbackContextException, InvalidCallbackReturnValue,
-    IncorrectTypeException
+    IncorrectTypeException, NonExistentIdException
 )
 from dash.testing.wait import until
 
@@ -898,3 +896,48 @@ def test_inin022_no_callback_context():
     for attr in ['inputs', 'states', 'triggered', 'response']:
         with pytest.raises(MissingCallbackContextException):
             getattr(callback_context, attr)
+
+
+def test_inin023_wrong_callback_id():
+    app = Dash(__name__)
+    app.layout = html.Div([
+        html.Div([
+            html.Div(id='inner-div'),
+            dcc.Input(id='inner-input')
+        ], id='outer-div'),
+        dcc.Input(id='outer-input')
+    ], id='main')
+
+    ids = ['main', 'inner-div', 'inner-input', 'outer-div', 'outer-input']
+
+    with pytest.raises(NonExistentIdException) as err:
+        @app.callback(
+            Output('nuh-uh', 'children'),
+            [Input('inner-input', 'value')]
+        )
+        def f(a):
+            return a
+
+    assert '"nuh-uh"' in err.value.args[0]
+    for component_id in ids:
+        assert component_id in err.value.args[0]
+
+    with pytest.raises(NonExistentIdException) as err:
+        @app.callback(
+            Output('inner-div', 'children'),
+            [Input('yeah-no', 'value')]
+        )
+        def g(a):
+            return a
+
+    assert '"yeah-no"' in err.value.args[0]
+    for component_id in ids:
+        assert component_id in err.value.args[0]
+
+    # the right way
+    @app.callback(
+        Output('inner-div', 'children'),
+        [Input('inner-input', 'value')]
+    )
+    def h(a):
+        return a
