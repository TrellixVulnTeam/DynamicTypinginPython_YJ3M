commit 4e776a6b174a6c1b5f468704f955591bcdf71db8
Author: chriddyp <chris@plot.ly>
Date:   Tue Apr 18 17:51:22 2017 -0400

    :lock: CSRF protection

diff --git a/src/actions/api.js b/src/actions/api.js
index de2b76d1..16a961bb 100644
--- a/src/actions/api.js
+++ b/src/actions/api.js
@@ -1,14 +1,15 @@
-/* global fetch: true */
-
-const request = {GET, POST};
+/* global fetch: true, document: true */
+import cookie from 'cookie';
+import {merge} from 'ramda';
 
 function GET(path) {
     return fetch(`${path}`, {
         method: 'GET',
-        credentials: 'include',
+        credentials: 'same-origin',
         headers: {
             'Accept': 'application/json',
-            'Content-Type': 'application/json'
+            'Content-Type': 'application/json',
+            'X-CSRFToken': cookie.parse(document.cookie)._csrf_token
         }
     });
 }
@@ -16,11 +17,12 @@ function GET(path) {
 function POST(path, body = {}) {
     return fetch(`${path}`, {
         method: 'POST',
-        credentials: 'include',
         headers: {
+        credentials: 'same-origin',
             'Accept': 'application/json',
-            'Content-Type': 'application/json'
         },
+            'Content-Type': 'application/json',
+            'X-CSRFToken': cookie.parse(document.cookie)._csrf_token
         body: body ? JSON.stringify(body) : null
     });
 }
diff --git a/src/actions/index.js b/src/actions/index.js
index cbdf1604..2d4463f3 100644
--- a/src/actions/index.js
+++ b/src/actions/index.js
@@ -1,4 +1,4 @@
-/* global fetch:true, window:true, Promise:true */
+/* global fetch:true, window:true, Promise:true, document:true */
 import {
     concat,
     contains,
@@ -18,6 +18,7 @@ import {createAction} from 'redux-actions';
 import {crawlLayout, hasId} from '../reducers/utils';
 import {APP_STATES} from '../reducers/constants';
 import {ACTIONS} from './constants';
+import cookie from 'cookie';
 
 export const updateProps = createAction(ACTIONS('ON_PROP_CHANGE'));
 export const setRequestQueue = createAction(ACTIONS('SET_REQUEST_QUEUE'));
@@ -446,7 +447,11 @@ export const notifyObservers = function(payload) {
 
             promises.push(fetch('/update-component', {
                 method: 'POST',
-                headers: {'Content-Type': 'application/json'},
+                headers: {
+                    'Content-Type': 'application/json',
+                    'X-CSRFToken': cookie.parse(document.cookie)._csrf_token
+                },
+                credentials: 'same-origin',
                 body: JSON.stringify(payload)
             }).then(response => response.json().then(function handleResponse(data) {
                 // clear this item from the request queue
