commit 1060b7c3d6a34c4f1c895c56827fa0254ae05f0d
Author: chriddyp <chris@plot.ly>
Date:   Mon Apr 17 20:49:09 2017 -0400

    csrf protection

diff --git a/dash/dash.py b/dash/dash.py
index f8819d7d..627f55af 100644
--- a/dash/dash.py
+++ b/dash/dash.py
@@ -3,6 +3,7 @@ import json
 import plotly
 from flask import Flask, url_for, send_from_directory, Response
 from flask_compress import Compress
+from flask_seasurf import SeaSurf
 import os
 import importlib
 from resources import Scripts, Css
@@ -27,9 +28,19 @@ class Dash(object):
         else:
             self.server = Flask(name)
 
+        if self.server.secret_key is None:
+            # If user supplied their own server, they might've supplied a
+            # secret_key with it
+            secret_key_name = 'dash_{}_secret_key'.format(name)
+            secret_key = os.environ.get(secret_key_name, os.urandom(24))
+            self.server.secret_key = secret_key
+
         # gzip
         Compress(self.server)
 
+        # csrf protect
+        self._csrf = SeaSurf(self.server)
+
         # static files from the packages
         self.css = Css()
         self.scripts = Scripts()
diff --git a/setup.py b/setup.py
index 0d45802b..dbe57638 100644
--- a/setup.py
+++ b/setup.py
@@ -14,6 +14,7 @@ setup(
     install_requires=[
         'Flask',
         'flask-compress',
+        'flask-seasurf',
         'plotly'
     ]
 )
