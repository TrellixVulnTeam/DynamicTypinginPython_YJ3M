commit 564ed68718a29790e5fec12b433cefe192c6a8a1
Author: frostming <frostming@tencent.com>
Date:   Mon Jun 1 21:47:06 2020 +0800

    Update pythonfinder from 1.2.2 to 1.2.4

diff --git a/pipenv/vendor/pythonfinder/__init__.py b/pipenv/vendor/pythonfinder/__init__.py
index 6ba8a67d..249cfd91 100644
--- a/pipenv/vendor/pythonfinder/__init__.py
+++ b/pipenv/vendor/pythonfinder/__init__.py
@@ -10,7 +10,7 @@ from .exceptions import InvalidPythonVersion
 from .models import SystemPath, WindowsFinder
 from .pythonfinder import Finder
 
-__version__ = "1.2.2"
+__version__ = "1.2.4"
 
 
 logger = logging.getLogger(__name__)
diff --git a/pipenv/vendor/pythonfinder/models/path.py b/pipenv/vendor/pythonfinder/models/path.py
index a8070c91..5c672715 100644
--- a/pipenv/vendor/pythonfinder/models/path.py
+++ b/pipenv/vendor/pythonfinder/models/path.py
@@ -27,7 +27,6 @@ from ..utils import (
     Sequence,
     dedup,
     ensure_path,
-    expand_paths,
     filter_pythons,
     is_in_path,
     normalize_path,
diff --git a/pipenv/vendor/pythonfinder/models/python.py b/pipenv/vendor/pythonfinder/models/python.py
index ff249be2..4f7e5563 100644
--- a/pipenv/vendor/pythonfinder/models/python.py
+++ b/pipenv/vendor/pythonfinder/models/python.py
@@ -18,6 +18,7 @@ from ..utils import (
     RE_MATCHER,
     _filter_none,
     ensure_path,
+    expand_paths,
     get_python_version,
     guess_company,
     is_in_path,
@@ -286,12 +287,10 @@ class PythonFinder(BaseFinder, BasePath):
             ]
         else:
             pythons = [sub_finder(path) for path in self.paths]
-        pythons = [p for p in pythons if p and p.is_python and p.as_python is not None]
+        pythons = expand_paths(pythons, True)
         version_sort = operator.attrgetter("as_python.version_sort")
         paths = [
-            p
-            for p in sorted(list(pythons), key=version_sort, reverse=True)
-            if p is not None
+            p for p in sorted(pythons, key=version_sort, reverse=True) if p is not None
         ]
         return paths
 
diff --git a/pipenv/vendor/pythonfinder/models/windows.py b/pipenv/vendor/pythonfinder/models/windows.py
index 39353cdb..928f0ff2 100644
--- a/pipenv/vendor/pythonfinder/models/windows.py
+++ b/pipenv/vendor/pythonfinder/models/windows.py
@@ -42,7 +42,10 @@ class WindowsFinder(BaseFinder):
         )
         pythons = [py for py in self.version_list if version_matcher(py)]
         version_sort = operator.attrgetter("version_sort")
-        return [c.comes_from for c in sorted(pythons, key=version_sort, reverse=True)]
+        return [
+            c.comes_from for c in sorted(pythons, key=version_sort, reverse=True)
+            if c.comes_from
+        ]
 
     def find_python_version(
         self,
diff --git a/pipenv/vendor/pythonfinder/pep514tools.LICENSE b/pipenv/vendor/pythonfinder/pep514tools.LICENSE
deleted file mode 100644
index c7ac395f..00000000
--- a/pipenv/vendor/pythonfinder/pep514tools.LICENSE
+++ /dev/null
@@ -1,21 +0,0 @@
-MIT License
-
-Copyright (c) 2016 Steve Dower
-
-Permission is hereby granted, free of charge, to any person obtaining a copy
-of this software and associated documentation files (the "Software"), to deal
-in the Software without restriction, including without limitation the rights
-to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
-copies of the Software, and to permit persons to whom the Software is
-furnished to do so, subject to the following conditions:
-
-The above copyright notice and this permission notice shall be included in all
-copies or substantial portions of the Software.
-
-THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
-IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
-FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
-AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
-LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
-OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
-SOFTWARE.
diff --git a/pipenv/vendor/pythonfinder/utils.py b/pipenv/vendor/pythonfinder/utils.py
index ef48e628..bcea7f3e 100644
--- a/pipenv/vendor/pythonfinder/utils.py
+++ b/pipenv/vendor/pythonfinder/utils.py
@@ -422,7 +422,7 @@ def expand_paths(path, only_python=True):
         isinstance(path, Sequence)
         and not getattr(path.__class__, "__name__", "") == "PathEntry"
     ):
-        for p in unnest(path):
+        for p in path:
             if p is None:
                 continue
             for expanded in itertools.chain.from_iterable(
@@ -437,7 +437,9 @@ def expand_paths(path, only_python=True):
                 ):
                     yield sub_path
     else:
-        if path is not None and path.is_python and path.as_python is not None:
+        if path is not None and (
+            not only_python or (path.is_python and path.as_python is not None)
+        ):
             yield path
 
 
diff --git a/pipenv/vendor/vendor.txt b/pipenv/vendor/vendor.txt
index ac5daf56..19da8533 100644
--- a/pipenv/vendor/vendor.txt
+++ b/pipenv/vendor/vendor.txt
@@ -20,7 +20,7 @@ pipdeptree==0.13.2
 pipreqs==0.4.10
     docopt==0.6.2
     yarg==0.1.9
-pythonfinder==1.2.3
+pythonfinder==1.2.4
 requests==2.23.0
     chardet==3.0.4
     idna==2.9
diff --git a/tasks/vendoring/patches/vendor/pythonfinder-import.patch b/tasks/vendoring/patches/vendor/pythonfinder-import.patch
new file mode 100644
index 00000000..6b9756ad
--- /dev/null
+++ b/tasks/vendoring/patches/vendor/pythonfinder-import.patch
@@ -0,0 +1,78 @@
+diff --git a/pipenv/vendor/pythonfinder/compat.py b/pipenv/vendor/pythonfinder/compat.py
+index 6fb4542f..d76c4efc 100644
+--- a/pipenv/vendor/pythonfinder/compat.py
++++ b/pipenv/vendor/pythonfinder/compat.py
+@@ -4,7 +4,7 @@ import sys
+ import six
+ 
+ if sys.version_info[:2] <= (3, 4):
+-    from pathlib2 import Path  # type: ignore  # noqa
++    from pipenv.vendor.pathlib2 import Path  # type: ignore  # noqa
+ else:
+     from pathlib import Path
+ 
+diff --git a/pipenv/vendor/pythonfinder/models/mixins.py b/pipenv/vendor/pythonfinder/models/mixins.py
+index 76327115..aeba0443 100644
+--- a/pipenv/vendor/pythonfinder/models/mixins.py
++++ b/pipenv/vendor/pythonfinder/models/mixins.py
+@@ -5,7 +5,7 @@ import abc
+ import operator
+ from collections import defaultdict
+ 
+-import attr
++from pipenv.vendor import attr
+ import six
+ 
+ from ..compat import fs_str
+diff --git a/pipenv/vendor/pythonfinder/models/path.py b/pipenv/vendor/pythonfinder/models/path.py
+index b855a05d..a8070c91 100644
+--- a/pipenv/vendor/pythonfinder/models/path.py
++++ b/pipenv/vendor/pythonfinder/models/path.py
+@@ -7,7 +7,7 @@ import sys
+ from collections import defaultdict
+ from itertools import chain
+ 
+-import attr
++from pipenv.vendor import attr
+ import six
+ from cached_property import cached_property
+ from ..compat import Path, fs_str
+diff --git a/pipenv/vendor/pythonfinder/models/python.py b/pipenv/vendor/pythonfinder/models/python.py
+index 619e7761..ff249be2 100644
+--- a/pipenv/vendor/pythonfinder/models/python.py
++++ b/pipenv/vendor/pythonfinder/models/python.py
+@@ -7,7 +7,7 @@ import platform
+ import sys
+ from collections import defaultdict
+ 
+-import attr
++from pipenv.vendor import attr
+ import six
+ from packaging.version import Version
+ 
+diff --git a/pipenv/vendor/pythonfinder/models/windows.py b/pipenv/vendor/pythonfinder/models/windows.py
+index a0e69b03..39353cdb 100644
+--- a/pipenv/vendor/pythonfinder/models/windows.py
++++ b/pipenv/vendor/pythonfinder/models/windows.py
+@@ -4,7 +4,7 @@ from __future__ import absolute_import, print_function
+ import operator
+ from collections import defaultdict
+ 
+-import attr
++from pipenv.vendor import attr
+ 
+ from ..environment import MYPY_RUNNING
+ from ..exceptions import InvalidPythonVersion
+diff --git a/pipenv/vendor/pythonfinder/utils.py b/pipenv/vendor/pythonfinder/utils.py
+index 8150545c..ef48e628 100644
+--- a/pipenv/vendor/pythonfinder/utils.py
++++ b/pipenv/vendor/pythonfinder/utils.py
+@@ -10,7 +10,7 @@ from collections import OrderedDict
+ from fnmatch import fnmatch
+ from threading import Timer
+ 
+-import attr
++from pipenv.vendor import attr
+ import six
+ from packaging.version import LegacyVersion, Version
+ 
diff --git a/tasks/vendoring/patches/vendor/pythonfinder-pathlib-import.patch b/tasks/vendoring/patches/vendor/pythonfinder-pathlib-import.patch
deleted file mode 100644
index 89cad037..00000000
--- a/tasks/vendoring/patches/vendor/pythonfinder-pathlib-import.patch
+++ /dev/null
@@ -1,13 +0,0 @@
-diff --git a/pipenv/vendor/pythonfinder/compat.py b/pipenv/vendor/pythonfinder/compat.py
-index 6fb4542f..d76c4efc 100644
---- a/pipenv/vendor/pythonfinder/compat.py
-+++ b/pipenv/vendor/pythonfinder/compat.py
-@@ -4,7 +4,7 @@ import sys
- import six
- 
- if sys.version_info[:2] <= (3, 4):
--    from pathlib2 import Path  # type: ignore  # noqa
-+    from pipenv.vendor.pathlib2 import Path  # type: ignore  # noqa
- else:
-     from pathlib import Path
- 
diff --git a/tasks/vendoring/patches/vendor/update-attrs-import-path.patch b/tasks/vendoring/patches/vendor/update-attrs-import-path.patch
index de662e17..d8133715 100644
--- a/tasks/vendoring/patches/vendor/update-attrs-import-path.patch
+++ b/tasks/vendoring/patches/vendor/update-attrs-import-path.patch
@@ -11,71 +11,6 @@ index f6e037d6..c7807c05 100644
  import packaging.markers
  import packaging.utils
  import plette
-diff --git a/pipenv/vendor/pythonfinder/models/mixins.py b/pipenv/vendor/pythonfinder/models/mixins.py
-index 76327115..aeba0443 100644
---- a/pipenv/vendor/pythonfinder/models/mixins.py
-+++ b/pipenv/vendor/pythonfinder/models/mixins.py
-@@ -5,7 +5,7 @@ import abc
- import operator
- from collections import defaultdict
- 
--import attr
-+from pipenv.vendor import attr
- import six
- 
- from ..compat import fs_str
-diff --git a/pipenv/vendor/pythonfinder/models/path.py b/pipenv/vendor/pythonfinder/models/path.py
-index b855a05d..a8070c91 100644
---- a/pipenv/vendor/pythonfinder/models/path.py
-+++ b/pipenv/vendor/pythonfinder/models/path.py
-@@ -7,7 +7,7 @@ import sys
- from collections import defaultdict
- from itertools import chain
- 
--import attr
-+from pipenv.vendor import attr
- import six
- from cached_property import cached_property
- from ..compat import Path, fs_str
-diff --git a/pipenv/vendor/pythonfinder/models/python.py b/pipenv/vendor/pythonfinder/models/python.py
-index 619e7761..ff249be2 100644
---- a/pipenv/vendor/pythonfinder/models/python.py
-+++ b/pipenv/vendor/pythonfinder/models/python.py
-@@ -7,7 +7,7 @@ import platform
- import sys
- from collections import defaultdict
- 
--import attr
-+from pipenv.vendor import attr
- import six
- from packaging.version import Version
- 
-diff --git a/pipenv/vendor/pythonfinder/models/windows.py b/pipenv/vendor/pythonfinder/models/windows.py
-index a0e69b03..39353cdb 100644
---- a/pipenv/vendor/pythonfinder/models/windows.py
-+++ b/pipenv/vendor/pythonfinder/models/windows.py
-@@ -4,7 +4,7 @@ from __future__ import absolute_import, print_function
- import operator
- from collections import defaultdict
- 
--import attr
-+from pipenv.vendor import attr
- 
- from ..environment import MYPY_RUNNING
- from ..exceptions import InvalidPythonVersion
-diff --git a/pipenv/vendor/pythonfinder/utils.py b/pipenv/vendor/pythonfinder/utils.py
-index 8150545c..ef48e628 100644
---- a/pipenv/vendor/pythonfinder/utils.py
-+++ b/pipenv/vendor/pythonfinder/utils.py
-@@ -10,7 +10,7 @@ from collections import OrderedDict
- from fnmatch import fnmatch
- from threading import Timer
- 
--import attr
-+from pipenv.vendor import attr
- import six
- from packaging.version import LegacyVersion, Version
- 
 diff --git a/pipenv/vendor/requirementslib/models/dependencies.py b/pipenv/vendor/requirementslib/models/dependencies.py
 index 2608479a..1a610ce7 100644
 --- a/pipenv/vendor/requirementslib/models/dependencies.py
