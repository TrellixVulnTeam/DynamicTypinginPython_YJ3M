commit 66e3f556fc9509e89ad2812b02e7d33ed8f03155
Author: Dan Ryan <dan@danryan.co>
Date:   Wed Mar 28 21:42:22 2018 -0400

    Exclude markers from top level dependencies

diff --git a/pipenv/core.py b/pipenv/core.py
index b083ed9d..bb7993e2 100644
--- a/pipenv/core.py
+++ b/pipenv/core.py
@@ -1064,8 +1064,8 @@ def do_lock(
         # Add index metadata to lockfile.
         if 'index' in dep:
             lockfile['develop'][dep['name']]['index'] = dep['index']
-        # Add PEP 508 specifier metadata to lockfile.
-        if 'markers' in dep:
+        # Add PEP 508 specifier metadata to lockfile if dep isnt top level.
+        if 'markers' in dep and not any(dep['name'] in section for section in [dev_packages, project.packages]):
             lockfile['develop'][dep['name']]['markers'] = dep['markers']
     # Add refs for VCS installs.
     # TODO: be smarter about this.
@@ -1120,8 +1120,8 @@ def do_lock(
         # Add index metadata to lockfile.
         if 'index' in dep:
             lockfile['default'][dep['name']]['index'] = dep['index']
-        # Add PEP 508 specifier metadata to lockfile.
-        if 'markers' in dep:
+        # Add PEP 508 specifier metadata to lockfile if dep isn't top level.
+        if 'markers' in dep and dep['name'] not in project.packages:
             lockfile['default'][dep['name']]['markers'] = dep['markers']
     # Add refs for VCS installs.
     # TODO: be smarter about this.
