commit 76eee5fff7304453b61ec95cf34a4f15fff23bd7
Author: Dan Ryan <dan.ryan@canonical.com>
Date:   Tue Apr 28 23:13:40 2020 -0400

    Update makefile rules and manifest
    
    Signed-off-by: Dan Ryan <dan.ryan@canonical.com>

diff --git a/MANIFEST.in b/MANIFEST.in
index aa49ce6e..c97d9615 100644
--- a/MANIFEST.in
+++ b/MANIFEST.in
@@ -33,9 +33,7 @@ recursive-exclue tests/test_artifacts *.pyd *.so *.pyc *.egg-info PKG-INFO
 
 prune peeps
 prune .azure-pipelines
-prune .buildkite
 prune .github
-prune .vsts-ci
 prune docs/build
 prune news
 prune tasks
diff --git a/Makefile b/Makefile
index cefc7fea..16964d5c 100644
--- a/Makefile
+++ b/Makefile
@@ -19,9 +19,10 @@ test:
 
 .PHONY: install
 install:
-	pip install -e .
+	pip install -e . && pipenv install --dev
 
-install.stamp: install
+install.stamp:
+	[ ! -e install.stamp ] && $(MAKE) install
 	@touch install.stamp
 
 .PHONY: install-py%
@@ -74,8 +75,12 @@ retest: virtualenv submodules test-install
 	. $(get_venv_path)/bin/activate && pipenv run pytest -ra -k 'test_check_unused or test_install_editable_git_tag or test_get_vcs_refs or test_skip_requirements_when_pipfile or test_editable_vcs_install or test_basic_vcs_install or test_git_vcs_install or test_ssh_vcs_install or test_vcs_can_use_markers' -vvv --full-trace --tb=long
 
 .PHONY: build
-build: install-virtualenvs.stamp install.stamp
-	PIPENV_PYTHON=3.7 pipenv run python setup.py sdist bdist_wheel
+build: install.stamp
+	pipenv run python setup.py sdist bdist_wheel
+
+build.stamp:
+	[ ! -e build.stamp ] && $(MAKE) build
+	@touch build.stamp
 
 .PHONY: update-version
 update-version:
@@ -113,5 +118,5 @@ cleanbuild:
 	@rm -rf build.stamp
 
 .PHONY: clean
-clean:
+clean: cleanbuild
 	rm -rf install.stamp build.stamp install-virtualenvs.stamp
