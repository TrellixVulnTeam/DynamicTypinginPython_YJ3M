commit 319c0b3d65c5b3ec7cccfe1389ab94a312e8a897
Author: Dan Ryan <dan@danryan.co>
Date:   Wed Mar 28 21:38:14 2018 -0400

    Always include markers when resolving

diff --git a/pipenv/patched/piptools/resolver.py b/pipenv/patched/piptools/resolver.py
index d8f6b890..acea5d9f 100755
--- a/pipenv/patched/piptools/resolver.py
+++ b/pipenv/patched/piptools/resolver.py
@@ -297,9 +297,9 @@ class Resolver(object):
             dependencies = self.repository.get_dependencies(ireq)
             import sys
             if sys.version_info[0] == 2:
-                self.dependency_cache[ireq] = sorted(str(ireq.req) for ireq in dependencies)
+                self.dependency_cache[ireq] = sorted(format_requirement(ireq) for ireq in dependencies)
             else:
-                self.dependency_cache[ireq] = sorted('{0}; {1}'.format(str(ireq.req), str(ireq.markers)) if ireq.markers else str(ireq.req) for ireq in dependencies)
+                self.dependency_cache[ireq] = sorted(format_requirement(ireq) for ireq in dependencies)
 
         # Example: ['Werkzeug>=0.9', 'Jinja2>=2.4']
         dependency_strings = self.dependency_cache[ireq]
diff --git a/pipenv/patched/piptools/utils.py b/pipenv/patched/piptools/utils.py
index 44d2d336..26d418eb 100755
--- a/pipenv/patched/piptools/utils.py
+++ b/pipenv/patched/piptools/utils.py
@@ -87,7 +87,7 @@ def format_requirement(ireq, marker=None):
         line = str(ireq.req).lower()
 
     if marker:
-        line = '{} ; {}'.format(line, marker)
+        line = '{}; {}'.format(line, marker)
 
     return line
 
