commit e559b00a90080cf1d95d28c6620cca3981288467
Author: Dan Ryan <dan@danryan.co>
Date:   Sat Jul 6 02:01:48 2019 -0400

    Fix xmlrpc implementation
    
    Signed-off-by: Dan Ryan <dan@danryan.co>
    
    fix xmlrpc implementation
    
    Signed-off-by: Dan Ryan <dan@danryan.co>

diff --git a/tests/pytest-pypi/pytest_pypi/app.py b/tests/pytest-pypi/pytest_pypi/app.py
index fd7b64a1..95dbd076 100644
--- a/tests/pytest-pypi/pytest_pypi/app.py
+++ b/tests/pytest-pypi/pytest_pypi/app.py
@@ -10,13 +10,10 @@ from tarfile import is_tarfile
 from zipfile import is_zipfile
 
 import requests
+from six.moves import xmlrpc_client
 
 from flask import Flask, redirect, abort, render_template, send_file, jsonify
 
-if sys.version_info[:2] >= (3, 0):
-    from xmlrpc.client import ServerProxy
-else:
-    from xmlrpclib import ServerProxy
 
 app = Flask(__name__)
 session = requests.Session()
@@ -27,12 +24,12 @@ ARTIFACTS = {}
 
 @contextlib.contextmanager
 def xml_pypi_server(server):
-    session = requests.Session()
-    client = ServerProxy(server, session)
+    transport = xmlrpc_client.Transport()
+    client = xmlrpc_client.ServerProxy(server, transport)
     try:
         yield client
     finally:
-        session.close()
+        transport.close()
 
 
 def get_pypi_package_names():
