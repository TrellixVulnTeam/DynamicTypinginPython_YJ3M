commit 96ea8a3ea6d7426db75c64836aa26e111c3b55db
Author: Tzu-ping Chung <uranusjr@gmail.com>
Date:   Wed Mar 14 00:54:14 2018 +0800

    Support Powershell Core (pwsh.exe) on Windows
    
    Basically add pwsh to wherever powershell appears.

diff --git a/pipenv/patched/pew/_win_utils.py b/pipenv/patched/pew/_win_utils.py
index 9f7b18b9..ee39b535 100644
--- a/pipenv/patched/pew/_win_utils.py
+++ b/pipenv/patched/pew/_win_utils.py
@@ -14,7 +14,7 @@ from ctypes.wintypes import DWORD, LONG
 
 ERROR_NO_MORE_FILES = 18
 INVALID_HANDLE_VALUE = c_void_p(-1).value
-SHELL_NAMES = ['cmd', 'powershell', 'cmder']
+SHELL_NAMES = ['cmd', 'powershell', 'pwsh', 'cmder']
 
 class PROCESSENTRY32(Structure):
     _fields_ = [
diff --git a/pipenv/patched/pew/pew.py b/pipenv/patched/pew/pew.py
index 2a1fc927..b12915b5 100644
--- a/pipenv/patched/pew/pew.py
+++ b/pipenv/patched/pew/pew.py
@@ -195,7 +195,7 @@ def shell(env, cwd=None):
     env = str(env)
     shell = _detect_shell()
     shell_name = Path(shell).stem
-    if shell_name not in ('Cmder', 'bash', 'elvish', 'powershell', 'klingon', 'cmd'):
+    if shell_name not in ('Cmder', 'bash', 'elvish', 'powershell', 'pwsh', 'klingon', 'cmd'):
         # On Windows the PATH is usually set with System Utility
         # so we won't worry about trying to check mistakes there
         shell_check = (sys.executable + ' -c "from pipenv.patched.pew.pew import '
