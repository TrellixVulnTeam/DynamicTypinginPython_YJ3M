commit c17a202cb5660e94ffbad960b3b06b23246c0379
Author: Josh Holland <anowlcalledjosh@gmail.com>
Date:   Wed Mar 7 21:47:48 2018 +0000

    Move handling of --completion earlier to make it way faster
    
    See #1247.

diff --git a/pipenv/cli.py b/pipenv/cli.py
index 409f9bc1..0759f4f1 100644
--- a/pipenv/cli.py
+++ b/pipenv/cli.py
@@ -46,6 +46,19 @@ def cli(
     python=False, help=False, update=False, py=False,
     site_packages=False, envs=False, man=False, completion=False
 ):
+    if completion:  # Handle this ASAP to make shell startup fast.
+        if PIPENV_SHELL:
+            os.environ['_PIPENV_COMPLETE'] = 'source-{0}'.format(PIPENV_SHELL.split(os.sep)[-1])
+        else:
+            click.echo(
+                'Please ensure that the {0} environment variable '
+                'is set.'.format(crayons.normal('SHELL', bold=True)), err=True)
+            sys.exit(1)
+
+        c = delegator.run('pipenv')
+        click.echo(c.out)
+        sys.exit(0)
+
     from . import core
 
     if not update:
@@ -61,19 +74,6 @@ def cli(
 
         sys.exit()
 
-    if completion:
-        if PIPENV_SHELL:
-            os.environ['_PIPENV_COMPLETE'] = 'source-{0}'.format(PIPENV_SHELL.split(os.sep)[-1])
-        else:
-            click.echo(
-                'Please ensure that the {0} environment variable '
-                'is set.'.format(crayons.normal('SHELL', bold=True)), err=True)
-            sys.exit(1)
-
-        c = delegator.run('pipenv')
-        click.echo(c.out)
-        sys.exit(0)
-
     if man:
         if core.system_which('man'):
             path = os.sep.join([os.path.dirname(__file__), 'pipenv.1'])
