commit b06ba8b3b28d78753211608aef385e63b907d0bd
Author: Dan Ryan <dan@danryan.co>
Date:   Tue Oct 9 17:34:40 2018 -0400

    Fix virtualenv installation
    
    Signed-off-by: Dan Ryan <dan@danryan.co>

diff --git a/pipenv/core.py b/pipenv/core.py
index d2ac5db4..cc4ba51f 100644
--- a/pipenv/core.py
+++ b/pipenv/core.py
@@ -105,9 +105,12 @@ if PIPENV_NOSPIN:
 
 def which(command, location=None, allow_global=False):
     if not allow_global and location is None:
-        location = project.virtualenv_location or os.environ.get("VIRTUAL_ENV", "")
-    if not (location and os.path.exists(location)):
-        raise RuntimeError("virtualenv not created nor specified")
+        if project.virtualenv_exists:
+            location = project.virtualenv_location
+        else:
+            location = os.environ.get("VIRTUAL_ENV", None)
+    if not (location and os.path.exists(location)) and not allow_global:
+        raise RuntimeError("location not created nor specified")
     if not allow_global:
         if os.name == "nt":
             p = find_windows_executable(os.path.join(location, "Scripts"), command)
@@ -2325,6 +2328,7 @@ def do_check(
 def do_graph(bare=False, json=False, json_tree=False, reverse=False):
     import pipdeptree
 
+
     try:
         python_path = which("python")
     except AttributeError:
