commit 7050b4c2c6dca82186a380261606947712ce57b8
Author: Tzu-ping Chung <uranusjr@gmail.com>
Date:   Sun Jul 1 20:03:00 2018 +0800

    Global shouldn't be needed

diff --git a/pipenv/core.py b/pipenv/core.py
index d6db68b3..01586f8c 100644
--- a/pipenv/core.py
+++ b/pipenv/core.py
@@ -66,6 +66,7 @@ from .environments import (
     PIPENV_DOTENV_LOCATION,
     PIPENV_PYTHON,
     PIPENV_CACHE_DIR,
+    PIPENV_VIRTUALENV,
 )
 
 # Packages that should be ignored later.
@@ -241,7 +242,6 @@ def import_from_code(path='.'):
 
 def ensure_pipfile(validate=True, skip_requirements=False, system=False):
     """Creates a Pipfile for the project, if it doesn't exist."""
-    global USING_DEFAULT_PYTHON, PIPENV_VIRTUALENV
     # Assert Pipfile exists.
     python = which('python') if not (USING_DEFAULT_PYTHON or system) else None
     if project.pipfile_is_empty:
@@ -1223,7 +1223,6 @@ def do_init(
 ):
     """Executes the init functionality."""
     cleanup_reqdir = False
-    global PIPENV_VIRTUALENV
     if not system:
         if not project.virtualenv_exists:
             try:
@@ -1762,8 +1761,7 @@ def do_install(
         keep_outdated = project.settings.get('keep_outdated')
     remote = requirements and is_valid_url(requirements)
     # Warn and exit if --system is used without a pipfile.
-    global PIPENV_VIRTUALENV
-    if system and package_name and not PIPENV_VIRTUALENV:
+    if (system and package_name) and not (PIPENV_VIRTUALENV):
         click.echo(
             '{0}: --system is intended to be used for Pipfile installation, '
             'not installation of specific packages. Aborting.'.format(
