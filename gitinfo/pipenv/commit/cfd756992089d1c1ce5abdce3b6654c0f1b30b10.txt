commit cfd756992089d1c1ce5abdce3b6654c0f1b30b10
Author: Kenneth Reitz <me@kennethreitz.org>
Date:   Sun Sep 17 18:12:04 2017 -0400

    fix for #586
    
    Signed-off-by: Kenneth Reitz <me@kennethreitz.org>

diff --git a/pipenv/cli.py b/pipenv/cli.py
index 4e6b3b00..65656320 100644
--- a/pipenv/cli.py
+++ b/pipenv/cli.py
@@ -854,9 +854,7 @@ def do_lock(verbose=False, system=False):
         deps,
         sources=project.sources,
         verbose=verbose,
-        python=python_version(
-            which('python') if project.required_python_version else None
-        )
+        python=python_version(which('python', allow_global=system))
     )
 
     # Add develop dependencies to lockfile.
@@ -896,9 +894,7 @@ def do_lock(verbose=False, system=False):
         deps,
         sources=project.sources,
         verbose=verbose,
-        python=python_version(
-            which('python') if project.required_python_version else None
-        )
+        python=python_version(which('python', allow_global=system))
     )
 
     # Add default dependencies to lockfile.
diff --git a/pipenv/utils.py b/pipenv/utils.py
index d56ad2c3..63d7b2ee 100644
--- a/pipenv/utils.py
+++ b/pipenv/utils.py
@@ -105,7 +105,7 @@ def resolve_deps(deps, sources=None, verbose=False, python=False):
         if verbose:
             logging.log.verbose = True
 
-        resolver = Resolver(constraints=constraints, repository=pypi)
+        resolver = Resolver(constraints=constraints, repository=pypi, allow_unsafe=True, prereleases=True)
         results = []
 
         # pre-resolve instead of iterating to avoid asking pypi for hashes of editable packages
