commit aff907898596f04d77fad67dca5816206d695030
Author: Frost Ming <mianghong@gmail.com>
Date:   Wed Mar 28 22:20:39 2018 +0800

    pass pre flag to lock

diff --git a/pipenv/core.py b/pipenv/core.py
index f7297ecc..16a45301 100644
--- a/pipenv/core.py
+++ b/pipenv/core.py
@@ -1011,6 +1011,8 @@ def do_lock(
     from notpip._vendor.distlib.markers import Evaluator
     allowed_marker_keys = ['markers'] + [k for k in Evaluator.allowed_values.keys()]
     cached_lockfile = {}
+    if not pre:
+        pre = project.settings.get('allow_prereleases')
     if keep_outdated:
         if not project.lockfile_exists:
             click.echo(
diff --git a/tests/pypi/sqlalchemy/SQLAlchemy-1.2.0b3.tar.gz b/tests/pypi/sqlalchemy/SQLAlchemy-1.2.0b3.tar.gz
new file mode 100644
index 00000000..40eafa66
Binary files /dev/null and b/tests/pypi/sqlalchemy/SQLAlchemy-1.2.0b3.tar.gz differ
diff --git a/tests/test_pipenv.py b/tests/test_pipenv.py
index 42865df2..13978589 100644
--- a/tests/test_pipenv.py
+++ b/tests/test_pipenv.py
@@ -953,6 +953,25 @@ requests = {git = "https://github.com/requests/requests", egg = "requests"}
             assert 'python_dateutil' not in lock['default']
             assert 'python_dateutil' not in lock['develop']
 
+    @pytest.mark.lock
+    @pytest.mark.requirements
+    def test_lock_with_prereleases(self, pypi):
+
+        with PipenvInstance(pypi=pypi) as p:
+            with open(p.pipfile_path, 'w') as f:
+                contents = """
+[packages]
+sqlalchemy = "==1.2.0b3"
+
+[pipenv]
+allow_prereleases = true
+                """.strip()
+                f.write(contents)
+
+            c = p.pipenv('lock')
+            assert c.return_code == 0
+            assert p.lockfile['default']['sqlalchemy']['version'] == '==1.2.0b3'
+
     @pytest.mark.lock
     @pytest.mark.requirements
     @pytest.mark.complex
