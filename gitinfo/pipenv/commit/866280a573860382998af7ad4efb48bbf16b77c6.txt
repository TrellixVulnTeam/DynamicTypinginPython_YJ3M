commit 866280a573860382998af7ad4efb48bbf16b77c6
Author: Kenneth Reitz <me@kennethreitz.org>
Date:   Sat Mar 10 10:41:01 2018 -0500

    more import fixes
    
    Signed-off-by: Kenneth Reitz <me@kennethreitz.org>

diff --git a/pipenv/patched/piptools/repositories/pypi.py b/pipenv/patched/piptools/repositories/pypi.py
index fd0f4b48..a3b7f0e1 100755
--- a/pipenv/patched/piptools/repositories/pypi.py
+++ b/pipenv/patched/piptools/repositories/pypi.py
@@ -11,6 +11,7 @@ from pipenv.patched.pip.download import is_file_url, url_to_path
 from pipenv.patched.pip.index import PackageFinder
 from pipenv.patched.pip.req.req_set import RequirementSet
 from pipenv.patched.pip.wheel import Wheel
+from pipenv.patched.pip.req.req_install import InstallRequirement
 try:
     from pipenv.patched.pip.utils.hashes import FAVORITE_HASH
 except ImportError:
@@ -106,6 +107,7 @@ class PyPIRepository(BaseRepository):
         Returns a Version object that indicates the best match for the given
         InstallRequirement according to the external repository.
         """
+
         if ireq.editable:
             return ireq  # return itself as the best match
 
@@ -130,7 +132,6 @@ class PyPIRepository(BaseRepository):
         return new_req
 
     def get_json_dependencies(self, ireq):
-        from pip.req import InstallRequirement
 
         if not (is_pinned_requirement(ireq)):
             raise TypeError('Expected pinned InstallRequirement, got {}'.format(ireq))
@@ -217,9 +218,9 @@ class PyPIRepository(BaseRepository):
                                     ignore_requires_python=True
                                     )
             result = reqset._prepare_file(self.finder, ireq, ignore_requires_python=True)
+
             if not result:
                 if reqset.requires_python:
-                    from pipenv.patched.pip.req.req_install import InstallRequirement
 
                     marker = 'python_version=="{0}"'.format(reqset.requires_python.replace(' ', ''))
                     new_req = InstallRequirement.from_line('{0}; {1}'.format(str(ireq.req), marker))
diff --git a/pipenv/patched/piptools/utils.py b/pipenv/patched/piptools/utils.py
index cf13db0a..bc3af531 100755
--- a/pipenv/patched/piptools/utils.py
+++ b/pipenv/patched/piptools/utils.py
@@ -6,8 +6,8 @@ import sys
 from itertools import chain, groupby
 from collections import OrderedDict
 
-import pip
-from pip.req import InstallRequirement
+from pipenv.patched import pip
+from pipenv.patched.pip.req import InstallRequirement
 
 from first import first
 
diff --git a/pipenv/utils.py b/pipenv/utils.py
index 6c9c6a96..f223b5a1 100644
--- a/pipenv/utils.py
+++ b/pipenv/utils.py
@@ -316,7 +316,7 @@ def actually_resolve_reps(deps, index_lookup, markers_lookup, project, sources,
     # Note: use_json is false here, because of markers like:
     # Ignoring pluggy: markers 'python_version == ">=2.7,!=3.0.*,!=3.1.*,!=3.2.*,!=3.3.*"' don't match your environment
     # These should be honored appropriately on 3.6, but appear not to be.
-    pypi = PyPIRepository(pip_options=pip_options, use_json=False, session=session)
+    pypi = PyPIRepository(pip_options=pip_options, use_json=True, session=session)
 
     if verbose:
         logging.log.verbose = True
