commit ca05f2f3d6c9de2898f57114f15b7a88c4e3a91b
Author: Dan Ryan <dan@danryan.co>
Date:   Wed Jun 13 11:49:17 2018 -0400

    Test fix and merge
    
    Signed-off-by: Dan Ryan <dan@danryan.co>

diff --git a/pipenv/vendor/requirementslib/models/requirements.py b/pipenv/vendor/requirementslib/models/requirements.py
index 5b7a423e..91327ca4 100644
--- a/pipenv/vendor/requirementslib/models/requirements.py
+++ b/pipenv/vendor/requirementslib/models/requirements.py
@@ -395,7 +395,7 @@ class VCSRequirement(FileRequirement):
         if "+" in scheme:
             vcs_type, scheme = scheme.split("+", 1)
             vcs_type = "{0}+".format(vcs_type)
-        new_uri = urllib_parse.urlunsplit((scheme,) + rest)
+        new_uri = urllib_parse.urlunsplit((scheme,) + rest[:-1] + ('',))
         new_uri = "{0}{1}".format(vcs_type, new_uri)
         self.uri = new_uri
 
diff --git a/tests/integration/test_install_twists.py b/tests/integration/test_install_twists.py
index b4b78632..c3b1055b 100644
--- a/tests/integration/test_install_twists.py
+++ b/tests/integration/test_install_twists.py
@@ -207,7 +207,8 @@ def test_relative_paths(PipenvInstance, pypi, testsroot):
         shutil.copy(source_path, os.path.join(artifact_path, file_name))
         # Test installing a relative path in a subdirectory
         c = p.pipenv('install {}/{}'.format(artifact_dir, file_name))
-        key = [k for k in p.pipfile['packages'].keys()][0]
+        assert c.return_code == 0
+        key = next(p.pipfile['packages'].keys())
         dep = p.pipfile['packages'][key]
 
         assert 'path' in dep
