commit 5788db3312af816345b6f5f0ea9fe6efdd2c5f6d
Author: Andrew Haigh <nelfin@gmail.com>
Date:   Fri May 25 17:17:33 2018 +0900

    Fix IndexError parsing comments from `pip freeze`
    
    Ref #2229. This change only fixes the issue seen when calling `pipenv
    clean`. A future refactor should consolidate these behaviours (or use
    the actual parsing of lines from pip, i.e. FrozenRequirement, if we can
    rely on this API).

diff --git a/pipenv/core.py b/pipenv/core.py
index a14d85bd..1c28b102 100644
--- a/pipenv/core.py
+++ b/pipenv/core.py
@@ -2564,14 +2564,13 @@ def do_clean(
     # Ensure that virtualenv is available.
     ensure_project(three=three, python=python, validate=False)
     ensure_lockfile()
-    installed_packages = filter(
-        None,
-        delegator.run('{0} freeze'.format(which_pip())).out.strip().split(
-            '\n'
-        ),
-    )
+
     installed_package_names = []
-    for installed in installed_packages:
+    pip_freeze_command = delegator.run('{0} freeze'.format(which_pip()))
+    for line in pip_freeze_command.out.split('\n'):
+        installed = line.strip()
+        if not installed or installed.startswith('#'):  # Comment or empty.
+            continue
         r = Requirement.from_line(installed).requirement
         # Ignore editable installations.
         if not r.editable:
