commit 36f93e4e05063572642379f5aff0b20538934629
Author: Derek Schaller <dschaller@lyft.com>
Date:   Wed Feb 21 22:49:49 2018 -0700

    fix graph command for missing virtualenv

diff --git a/pipenv/core.py b/pipenv/core.py
index c672f72f..80a6fcde 100644
--- a/pipenv/core.py
+++ b/pipenv/core.py
@@ -2200,14 +2200,20 @@ def do_graph(bare=False, json=False, reverse=False):
         flag
     )
 
-    # Run dep-tree.
-    c = delegator.run(cmd)
+    if not project.virtualenv_exists:
+        tree_output = '{}' if json else ''
+        return_code = 0
+    else:
+        # Run dep-tree.
+        c = delegator.run(cmd)
+        tree_output = c.out
+        return_code = c.return_code
 
     if not bare:
 
         if json:
             data = []
-            for d in simplejson.loads(c.out):
+            for d in simplejson.loads(tree_output):
 
                 if d['package']['key'] not in BAD_PACKAGES:
                     data.append(d)
@@ -2215,7 +2221,7 @@ def do_graph(bare=False, json=False, reverse=False):
             click.echo(simplejson.dumps(data, indent=4))
             sys.exit(0)
         else:
-            for line in c.out.split('\n'):
+            for line in tree_output.split('\n'):
 
                 # Ignore bad packages as top level.
                 if line.split('==')[0] in BAD_PACKAGES and not reverse:
@@ -2229,10 +2235,10 @@ def do_graph(bare=False, json=False, reverse=False):
                 else:
                     click.echo(crayons.normal(line, bold=False))
     else:
-        click.echo(c.out)
+        click.echo(tree_output)
 
     # Return its return code.
-    sys.exit(c.return_code)
+    sys.exit(return_code)
 
 
 def do_update(ctx, install, dev=False, three=None, python=None, dry_run=False, bare=False, dont_upgrade=False, user=False, verbose=False, clear=False, unused=False, package_name=None, sequential=False):
