commit bf8d0b9592a4a27f958c789abcd250b1fdba1d50
Author: Dan Ryan <dan@danryan.co>
Date:   Tue Jul 17 18:23:55 2018 -0400

    Update pythonfinder for better windows support
    
    Signed-off-by: Dan Ryan <dan@danryan.co>

diff --git a/pipenv/vendor/pythonfinder/models/python.py b/pipenv/vendor/pythonfinder/models/python.py
index 687f1d43..1bc34cc0 100644
--- a/pipenv/vendor/pythonfinder/models/python.py
+++ b/pipenv/vendor/pythonfinder/models/python.py
@@ -69,6 +69,8 @@ class PythonVersion(object):
         )
 
     def matches(self, major=None, minor=None, patch=None, pre=False, dev=False, arch=None):
+        if arch and arch.isnumeric():
+            arch = '{0}bit'.format(arch)
         return (
             (major is None or self.major == major)
             and (minor is None or self.minor == minor)
@@ -180,7 +182,7 @@ class PythonVersion(object):
         creation_dict.update(
             {
                 "architecture": getattr(
-                    launcher_entry, "sys_architecture", SYSTEM_ARCH
+                    launcher_entry.info, "sys_architecture", SYSTEM_ARCH
                 ),
                 "executable": exe_path,
             }
@@ -193,6 +195,9 @@ class PythonVersion(object):
 
     @classmethod
     def create(cls, **kwargs):
+        if 'architecture' in kwargs:
+            if kwargs['architecture'].isnumeric():
+                kwargs['architecture'] = '{0}bit'.format(kwargs['architecture'])
         return cls(**kwargs)
 
 
diff --git a/pipenv/vendor/pythonfinder/pythonfinder.py b/pipenv/vendor/pythonfinder/pythonfinder.py
index 75925075..8e775ffd 100644
--- a/pipenv/vendor/pythonfinder/pythonfinder.py
+++ b/pipenv/vendor/pythonfinder/pythonfinder.py
@@ -57,6 +57,8 @@ class Finder(object):
                 major, arch = major.rsplit('-', 1)
                 if not arch.isnumeric():
                     major = "{0}-{1}".format(major, arch)
+                else:
+                    arch = "{0}bit".format(arch)
             version_dict = PythonVersion.parse(major)
             major = version_dict.get("major", major)
             minor = version_dict.get("minor", minor)
@@ -66,7 +68,7 @@ class Finder(object):
             arch = version_dict.get("architecture", arch) if arch is None else arch
         if os.name == "nt":
             match = self.windows_finder.find_python_version(
-                major, minor=minor, patch=patch, pre=pre, dev=dev, arch=arch,
+                major, minor=minor, patch=patch, pre=pre, dev=dev, arch=arch
             )
             if match:
                 return match
@@ -78,7 +80,7 @@ class Finder(object):
         version_sort = operator.attrgetter("as_python.version_sort")
         python_version_dict = getattr(self.system_path, 'python_version_dict')
         if python_version_dict:
-            paths = filter(None, [path for version in python_version_dict.values() for path in version])
+            paths = filter(None, [path for version in python_version_dict.values() for path in version if path.as_python])
             paths = sorted(paths, key=version_sort, reverse=True)
             return paths
         versions = self.system_path.find_all_python_versions(major=major, minor=minor, patch=patch, pre=pre, dev=dev, arch=arch)
