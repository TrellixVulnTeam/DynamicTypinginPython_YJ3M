commit 7a20f3635ace21e98bc817b531d511bd27a11f58
Author: Kenneth Reitz <me@kennethreitz.org>
Date:   Mon Mar 12 09:27:53 2018 -0400

    smarter setup.py treatment
    
    Signed-off-by: Kenneth Reitz <me@kennethreitz.org>

diff --git a/pipenv/patched/piptools/repositories/pypi.py b/pipenv/patched/piptools/repositories/pypi.py
index b7263870..e07ac21b 100755
--- a/pipenv/patched/piptools/repositories/pypi.py
+++ b/pipenv/patched/piptools/repositories/pypi.py
@@ -223,17 +223,25 @@ class PyPIRepository(BaseRepository):
             if setup_requires:
                 for section in setup_requires:
                     python_version = section
+                    not_python = False
+
                     for value in setup_requires[section]:
-                        if ':' in value and 'python' in value:
+                        # This is a marker.
+                        if value.startswith('[') and ':' in value:
                             python_version = value[1:-1]
+                            not_python = False
+                        # Strip out other extras.
+                        elif value.startswith('[') and ':' not in value:
+                            not_python = True
                         elif ':' not in value:
                             try:
-                                result = result + [InstallRequirement.from_line("{0}{1}".format(value, python_version).replace(':', ';'))]
+                                if not not_python:
+                                    print(value)
+                                    result = result + [InstallRequirement.from_line("{0}{1}".format(value, python_version).replace(':', ';'))]
                             # Anything could go wrong here â€” can't be too careful.
                             except Exception:
                                 pass
 
-
             if reqset.requires_python:
 
                 marker = 'python_version=="{0}"'.format(reqset.requires_python.replace(' ', ''))
