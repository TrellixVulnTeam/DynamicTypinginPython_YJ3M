commit e025d4aa794ba7ca12bbef3e39c4b33ce88c5ede
Author: Kenneth Reitz <me@kennethreitz.org>
Date:   Fri Mar 9 09:46:34 2018 -0500

    get both fancier and less fancy at the same time
    
    Signed-off-by: Kenneth Reitz <me@kennethreitz.org>

diff --git a/pipenv/patched/piptools/repositories/pypi.py b/pipenv/patched/piptools/repositories/pypi.py
index d6d8c6c9..cda890e1 100755
--- a/pipenv/patched/piptools/repositories/pypi.py
+++ b/pipenv/patched/piptools/repositories/pypi.py
@@ -163,15 +163,20 @@ class PyPIRepository(BaseRepository):
 
 
     def get_dependencies(self, ireq):
-        legacy_results = self.get_legacy_dependencies(ireq)
+        json_results = set()
+
         if self.use_json:
             try:
                 json_results = self.get_json_dependencies(ireq)
-                legacy_results.update(json_results)
             except TypeError:
-                pass
+                json_results = set()
+
+        try:
+            legacy_results = self.get_legacy_dependencies(ireq)
+        except Exception:
+            legacy_results = set()
 
-        return legacy_results
+        return json_results | legacy_results
 
     def get_legacy_dependencies(self, ireq):
         """
