commit 5334183c436c6a1572645fbd7de7720eb51f419f
Author: Dan Ryan <dan@danryan.co>
Date:   Tue Jul 24 19:11:36 2018 -0400

    Make sure there is a link to check against
    
    Signed-off-by: Dan Ryan <dan@danryan.co>

diff --git a/pipenv/patched/piptools/repositories/pypi.py b/pipenv/patched/piptools/repositories/pypi.py
index feab21b5..daaa5902 100644
--- a/pipenv/patched/piptools/repositories/pypi.py
+++ b/pipenv/patched/piptools/repositories/pypi.py
@@ -434,7 +434,7 @@ class PyPIRepository(BaseRepository):
             return set()
 
         vcs = VcsSupport()
-        if ireq.link.scheme in vcs.all_schemes and 'ssh' in ireq.link.scheme:
+        if ireq.link and ireq.link.scheme in vcs.all_schemes and 'ssh' in ireq.link.scheme:
             return set()
 
         if not is_pinned_requirement(ireq):
diff --git a/tasks/vendoring/patches/patched/piptools.patch b/tasks/vendoring/patches/patched/piptools.patch
index b527470b..8dd58066 100644
--- a/tasks/vendoring/patches/patched/piptools.patch
+++ b/tasks/vendoring/patches/patched/piptools.patch
@@ -386,7 +386,7 @@ index 1c4b943..9461709 100644
              return set()
  
 +        vcs = VcsSupport()
-+        if ireq.link.scheme in vcs.all_schemes and 'ssh' in ireq.link.scheme:
++        if ireq.link and ireq.link.scheme in vcs.all_schemes and 'ssh' in ireq.link.scheme:
 +            return set()
 +
          if not is_pinned_requirement(ireq):
