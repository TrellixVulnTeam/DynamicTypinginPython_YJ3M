commit acdd2ff1261578b2342b5f05c722de21afd49a95
Author: Tzu-ping Chung <uranusjr@gmail.com>
Date:   Fri May 4 02:37:28 2018 +0800

    Test for '\n', not platform newlines in user code
    
    Python always generates '\n' in string (unless we explicitly specify
    otherwise), so we should test that. Leave line ending handling to library
    code.

diff --git a/pipenv/project.py b/pipenv/project.py
index d9bbc385..6baff6c9 100644
--- a/pipenv/project.py
+++ b/pipenv/project.py
@@ -642,9 +642,8 @@ class Project(object):
         )
         with atomic_open_for_write(self.lockfile_location, newline=newlines) as f:
             f.write(s)
-            # Write newline at end of document. GH#319.
-            if not s.endswith(newlines):
-                f.write(newlines)
+            if not s.endswith(u'\n'):
+                f.write(u'\n')  # Write newline at end of document. GH #319.
 
     @property
     def pipfile_sources(self):
