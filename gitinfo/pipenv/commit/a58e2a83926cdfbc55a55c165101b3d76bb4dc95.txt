commit a58e2a83926cdfbc55a55c165101b3d76bb4dc95
Author: Kenneth Reitz <me@kennethreitz.org>
Date:   Wed Mar 21 07:05:03 2018 -0400

    inject environment variables into pipfile.lock
    
    Signed-off-by: Kenneth Reitz <me@kennethreitz.org>

diff --git a/pipenv/project.py b/pipenv/project.py
index 812a9841..fbf76bc0 100644
--- a/pipenv/project.py
+++ b/pipenv/project.py
@@ -411,7 +411,13 @@ class Project(object):
     @property
     def lockfile_content(self):
         with open(self.lockfile_location) as lock:
-            return json.load(lock)
+            j = json.load(lock)
+
+        # Expand environment variables in Pipfile.lock at runtime.
+        for i, source in enumerate(j['_meta']['sources'][:]):
+            j['_meta']['sources'][i]['url'] = os.path.expandvars(j['_meta']['sources'][i]['url'])
+
+        return j
 
     @property
     def vcs_packages(self):
