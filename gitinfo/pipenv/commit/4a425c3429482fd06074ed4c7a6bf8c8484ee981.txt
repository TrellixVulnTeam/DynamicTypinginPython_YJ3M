commit 4a425c3429482fd06074ed4c7a6bf8c8484ee981
Author: Dan Ryan <dan@danryan.co>
Date:   Wed Mar 28 23:00:38 2018 -0400

    Add regression tests for resolver changes
    
    Signed-off-by: Dan Ryan <dan@danryan.co>

diff --git a/tests/pypi/multidict/multidict-4.1.0-cp36-cp36m-win_amd64.whl b/tests/pypi/multidict/multidict-4.1.0-cp36-cp36m-win_amd64.whl
new file mode 100644
index 00000000..6f8c38f3
Binary files /dev/null and b/tests/pypi/multidict/multidict-4.1.0-cp36-cp36m-win_amd64.whl differ
diff --git a/tests/pypi/pyyaml/PyYAML-3.12-cp27-cp27m-win32.whl b/tests/pypi/pyyaml/PyYAML-3.12-cp27-cp27m-win32.whl
new file mode 100644
index 00000000..d9f5e245
Binary files /dev/null and b/tests/pypi/pyyaml/PyYAML-3.12-cp27-cp27m-win32.whl differ
diff --git a/tests/pypi/pyyaml/PyYAML-3.12-cp27-cp27m-win_amd64.whl b/tests/pypi/pyyaml/PyYAML-3.12-cp27-cp27m-win_amd64.whl
new file mode 100644
index 00000000..2eb7094f
Binary files /dev/null and b/tests/pypi/pyyaml/PyYAML-3.12-cp27-cp27m-win_amd64.whl differ
diff --git a/tests/pypi/pyyaml/PyYAML-3.12-cp35-cp35m-win32.whl b/tests/pypi/pyyaml/PyYAML-3.12-cp35-cp35m-win32.whl
new file mode 100644
index 00000000..f58c2f69
Binary files /dev/null and b/tests/pypi/pyyaml/PyYAML-3.12-cp35-cp35m-win32.whl differ
diff --git a/tests/pypi/pyyaml/PyYAML-3.12-cp35-cp35m-win_amd64.whl b/tests/pypi/pyyaml/PyYAML-3.12-cp35-cp35m-win_amd64.whl
new file mode 100644
index 00000000..c3d36a8b
Binary files /dev/null and b/tests/pypi/pyyaml/PyYAML-3.12-cp35-cp35m-win_amd64.whl differ
diff --git a/tests/pypi/vcrpy/vcrpy-1.11.0-py2.py3-none-any.whl b/tests/pypi/vcrpy/vcrpy-1.11.0-py2.py3-none-any.whl
new file mode 100644
index 00000000..2853aafc
Binary files /dev/null and b/tests/pypi/vcrpy/vcrpy-1.11.0-py2.py3-none-any.whl differ
diff --git a/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-manylinux1_i686.whl b/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-manylinux1_i686.whl
new file mode 100644
index 00000000..ab6c0e0c
Binary files /dev/null and b/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-manylinux1_i686.whl differ
diff --git a/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-manylinux1_x86_64.whl b/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-manylinux1_x86_64.whl
new file mode 100644
index 00000000..baeeb2c1
Binary files /dev/null and b/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-manylinux1_x86_64.whl differ
diff --git a/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-win32.whl b/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-win32.whl
new file mode 100644
index 00000000..45fe89ed
Binary files /dev/null and b/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-win32.whl differ
diff --git a/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-win_amd64.whl b/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-win_amd64.whl
new file mode 100644
index 00000000..e11d5c62
Binary files /dev/null and b/tests/pypi/yarl/yarl-1.1.1-cp36-cp36m-win_amd64.whl differ
diff --git a/tests/test_pipenv.py b/tests/test_pipenv.py
index 9b36a556..c6ae4110 100644
--- a/tests/test_pipenv.py
+++ b/tests/test_pipenv.py
@@ -1212,3 +1212,21 @@ printfoo = "python -c print('foo')"
             assert c.return_code == 0
             assert c.out == 'foo\n'
             assert c.err == ''
+
+    @pytest.mark.lock
+    @pytest.mark.complex
+    def test_resolver_unique_markers(self, pypi):
+        """vcrpy has a dependency on `yarl` which comes with a marker
+        of 'python version in "3.4, 3.5, 3.6" - this marker duplicates itself:
+
+        'yarl; python version in "3.4, 3.5, 3.6"; python version in "3.4, 3.5, 3.6"'
+
+        This verifies that we clean that successfully.
+        """
+        with PipenvInstance(chdir=True) as p:
+            c = p.pipenv('install vcrpy==1.11.0')
+            assert c.return_code == 0
+            assert 'yarl' in p.lockfile['default']
+            yarl = p.lockfile['default']['yarl']
+            assert 'markers' in yarl
+            assert yarl['markers'] == "python_version in '3.4, 3.5, 3.6'"
