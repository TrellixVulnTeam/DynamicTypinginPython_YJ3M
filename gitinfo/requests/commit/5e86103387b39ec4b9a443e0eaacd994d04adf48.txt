commit 5e86103387b39ec4b9a443e0eaacd994d04adf48
Author: Daniele Tricoli <eriol@mornie.org>
Date:   Sun May 29 20:10:37 2016 +0200

    Use xfail marker for a test expected to fail without Internet connection
    
    This is only a minor improvement on the great work of
    https://github.com/kennethreitz/requests/pull/2859 that permits to run
    tests on hosts without Internet connection.

diff --git a/tests/test_requests.py b/tests/test_requests.py
index 167d5ca7..9e54a40f 100755
--- a/tests/test_requests.py
+++ b/tests/test_requests.py
@@ -1107,6 +1107,7 @@ class TestRequests:
             preq = req.prepare()
             assert test_url == preq.url
 
+    @pytest.mark.xfail(raises=ConnectionError)
     def test_auth_is_stripped_on_redirect_off_host(self, httpbin):
         r = requests.get(
             httpbin('redirect-to'),
