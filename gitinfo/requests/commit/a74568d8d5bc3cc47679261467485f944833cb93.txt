commit a74568d8d5bc3cc47679261467485f944833cb93
Author: Kenneth Reitz <me@kennethreitz.com>
Date:   Sat Oct 22 21:10:24 2011 -0400

    simplify request dispatch flow

diff --git a/requests/models.py b/requests/models.py
index 65c047c5..a6a2c01e 100644
--- a/requests/models.py
+++ b/requests/models.py
@@ -331,24 +331,27 @@ class Request(object):
                 datetime.now().isoformat(), self.method, self.url
             ))
 
-
         # Build the URL
         url = self._build_url()
 
-
+        # Attach uploaded files.
         if self.files:
             register_openers()
 
+            # Add form-data to the multipart.
             if self.data:
                 self.files.update(self.data)
 
-            datagen, headers = multipart_encode(self.files)
-            req = _Request(url, data=datagen, headers=headers, method=self.method)
+            data, headers = multipart_encode(self.files)
 
         else:
-            req = _Request(url, data=self._enc_data, method=self.method)
+            data = self._enc_data
+            headers = {}
 
+        # Build the Urllib2 Request.
+        req = _Request(url, data=data, headers=headers, method=self.method)
 
+        # Add the headers to the request.
         if self.headers:
             for k,v in self.headers.iteritems():
                 req.add_header(k, v)
