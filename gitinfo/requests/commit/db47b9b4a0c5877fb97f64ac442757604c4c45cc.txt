commit db47b9b4a0c5877fb97f64ac442757604c4c45cc
Author: Seth Michael Larson <seth.larson@elastic.co>
Date:   Thu Apr 30 08:55:53 2020 -0500

    Don't use pyOpenSSL unless no SNI is detected

diff --git a/requests/__init__.py b/requests/__init__.py
index 626247cb..db090aa7 100644
--- a/requests/__init__.py
+++ b/requests/__init__.py
@@ -90,14 +90,22 @@ except (AssertionError, ValueError):
                   "version!".format(urllib3.__version__, chardet.__version__),
                   RequestsDependencyWarning)
 
-# Attempt to enable urllib3's SNI support, if possible
+# Attempt to enable urllib3's fallback for SNI support
+# if the standard library doesn't support SNI or the
+# 'ssl' library isn't available.
 try:
-    from urllib3.contrib import pyopenssl
-    pyopenssl.inject_into_urllib3()
+    try:
+        import ssl
+    except ImportError:
+        ssl = None
+
+    if not getattr(ssl, "HAS_SNI", False):
+        from urllib3.contrib import pyopenssl
+        pyopenssl.inject_into_urllib3()
 
-    # Check cryptography version
-    from cryptography import __version__ as cryptography_version
-    _check_cryptography(cryptography_version)
+        # Check cryptography version
+        from cryptography import __version__ as cryptography_version
+        _check_cryptography(cryptography_version)
 except ImportError:
     pass
 
