commit 5ecf789a6f2c50a69854e2663083aeea1a0ff683
Author: Braulio Valdivielso Mart√≠nez <brlvldvlsmrtnz@gmail.com>
Date:   Wed Dec 2 02:02:09 2015 +0100

    Avoid server from blocking if an exception is found in the main thread

diff --git a/testserver/server.py b/testserver/server.py
index 5c5d8069..fd6bca40 100644
--- a/testserver/server.py
+++ b/testserver/server.py
@@ -69,5 +69,10 @@ class Server(threading.Thread):
     def __exit__(self, exc_type, exc_value, traceback):
         if exc_type is None:
             self.stop_event.wait()
+        else:
+            if self.wait_to_close_event:
+                # avoid server from blocking if an exception is found
+                # in the main thread
+                self.wait_to_close_event.set() 
         return False # allow exceptions to propagate 
     
