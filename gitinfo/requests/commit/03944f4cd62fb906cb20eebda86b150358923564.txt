commit 03944f4cd62fb906cb20eebda86b150358923564
Author: Kenneth Reitz <me@kennethreitz.org>
Date:   Sat May 27 20:33:32 2017 -0400

    restore old behavior

diff --git a/.travis.yml b/.travis.yml
index c76e029b..e456e0cd 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -7,6 +7,7 @@ python:
   - "3.4"
   - "3.5"
   - "3.6"
+  - "3.7-dev"
   # - "pypy"  -- appears to hang
   # - "pypy3"
 # command to install dependencies
@@ -15,7 +16,7 @@ install: "make"
 script:
   - |
     if [[ "$TRAVIS_PYTHON_VERSION" != "2.6" ]] ; then make test-readme; fi
-  - make test
+  - make coverage
 after_success:
   - pipenv run codecov
 cache: pip
diff --git a/Makefile b/Makefile
index 5bc45550..8c07cdef 100644
--- a/Makefile
+++ b/Makefile
@@ -1,17 +1,23 @@
 .PHONY: docs
 
 init:
-	pip install -r requirements.txt
+	pip install pipenv
+	pipenv install --dev
+	pipenv run pip install -e .[socks]
+
 test:
 	# This runs all of the tests. To run an individual test, run py.test with
 	# the -k flag, like "py.test -k test_path_is_not_double_encoded"
-	python setup.py test
+	pipenv run py.test tests
 
 test-readme:
-	python setup.py check -r -s
+	pipenv run python setup.py check -r -s
 
 coverage:
-	py.test --cov-config .coveragerc --verbose --cov-report term --boxed -n 9 --cov-report xml --cov=requests tests
+	pipenv run py.test --cov-config .coveragerc --verbose --cov-report term --cov-report xml --cov=requests tests
+
+certs:
+	curl http://ci.kennethreitz.org/job/ca-bundle/lastSuccessfulBuild/artifact/cacerts.pem -o requests/cacert.pem
 
 publish:
 	pip install 'twine>=1.5.0'
diff --git a/Pipfile b/Pipfile
new file mode 100644
index 00000000..2bf3c273
--- /dev/null
+++ b/Pipfile
@@ -0,0 +1,14 @@
+[[source]]
+url = "https://pypi.python.org/simple"
+verify_ssl = true
+
+[dev-packages]
+pytest = ">=2.8.0"
+codecov = "*"
+pytest-httpbin = "==0.0.7"
+pytest-mock = "*"
+pytest-cov = "*"
+alabaster = "*"
+readme_renderer = "*"
+Sphinx = "<=1.5.5"
+PySocks = "*"
\ No newline at end of file
diff --git a/Pipfile.lock b/Pipfile.lock
new file mode 100644
index 00000000..1652b05b
--- /dev/null
+++ b/Pipfile.lock
@@ -0,0 +1,116 @@
+{
+    "_meta": {
+        "hash": {
+            "sha256": "a26ef57f42fa3da7d70d1c1decb4e6445a6ff66e47c9094ddc9ab8e1f4c0a5b6"
+        },
+        "requires": {},
+        "sources": [
+            {
+                "url": "https://pypi.python.org/simple",
+                "verify_ssl": true
+            }
+        ]
+    },
+    "default": {},
+    "develop": {
+        "alabaster": {
+            "version": "==0.7.10"
+        },
+        "appdirs": {
+            "version": "==1.4.3"
+        },
+        "babel": {
+            "version": "==2.4.0"
+        },
+        "click": {
+            "version": "==6.7"
+        },
+        "codecov": {
+            "version": "==2.0.9"
+        },
+        "coverage": {
+            "version": "==4.4.1"
+        },
+        "decorator": {
+            "version": "==4.0.11"
+        },
+        "docutils": {
+            "version": "==0.13.1"
+        },
+        "flask": {
+            "version": "==0.12.2"
+        },
+        "funcsigs": {
+            "version": "==1.0.2"
+        },
+        "httpbin": {
+            "version": "==0.5.0"
+        },
+        "imagesize": {
+            "version": "==0.7.1"
+        },
+        "itsdangerous": {
+            "version": "==0.24"
+        },
+        "jinja2": {
+            "version": "==2.9.6"
+        },
+        "markupsafe": {
+            "version": "==1.0"
+        },
+        "mock": {
+            "version": "==2.0.0"
+        },
+        "packaging": {
+            "version": "==16.8"
+        },
+        "pbr": {
+            "version": "==3.0.0"
+        },
+        "py": {
+            "version": "==1.4.33"
+        },
+        "pygments": {
+            "version": "==2.2.0"
+        },
+        "pyparsing": {
+            "version": "==2.2.0"
+        },
+        "pysocks": {
+            "version": "==1.6.7"
+        },
+        "pytest": {
+            "version": "==3.0.7"
+        },
+        "pytest-cov": {
+            "version": "==2.5.1"
+        },
+        "pytest-httpbin": {
+            "version": "==0.0.7"
+        },
+        "pytest-mock": {
+            "version": "==1.6.0"
+        },
+        "pytz": {
+            "version": "==2017.2"
+        },
+        "requests": {
+            "version": "==2.14.2"
+        },
+        "setuptools": {
+            "version": "==35.0.2"
+        },
+        "six": {
+            "version": "==1.10.0"
+        },
+        "snowballstemmer": {
+            "version": "==1.2.1"
+        },
+        "sphinx": {
+            "version": "==1.5.5"
+        },
+        "werkzeug": {
+            "version": "==0.12.2"
+        }
+    }
+}
