commit d3f14af44d9460a17c79de19ebdb65b3eec2e534
Author: Alvaro Gutierrez Perez <alvarogzp@users.noreply.github.com>
Date:   Wed Oct 18 19:27:06 2017 +0200

    Fix case-insensitive comparison in get_adapter()
    
    While trying to get the prefix for an url, the url was lowered before comparing but the prefix not, so if it contains non-lowercase characters (eg. https://api.example.com/sOmE_WeiRD_pReFIX/), it won't match.

diff --git a/requests/sessions.py b/requests/sessions.py
index 391f857d..bb57f5d8 100644
--- a/requests/sessions.py
+++ b/requests/sessions.py
@@ -696,7 +696,7 @@ class Session(SessionRedirectMixin):
         """
         for (prefix, adapter) in self.adapters.items():
 
-            if url.lower().startswith(prefix):
+            if url.lower().startswith(prefix.lower()):
                 return adapter
 
         # Nothing matches :-/
