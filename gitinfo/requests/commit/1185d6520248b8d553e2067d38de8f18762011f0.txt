commit 1185d6520248b8d553e2067d38de8f18762011f0
Author: Casey Davidson <casey@planetargon.com>
Date:   Fri Mar 4 15:17:55 2016 -0800

    Add tests to specify when CookieConflicError should be raised. References #3028.

diff --git a/tests/test_requests.py b/tests/test_requests.py
index 1ee379c9..bf2e19c1 100755
--- a/tests/test_requests.py
+++ b/tests/test_requests.py
@@ -754,6 +754,28 @@ class TestRequests:
         # make sure one can use items multiple times
         assert list(items) == list(items)
 
+    def test_cookie_duplicate_names_different_domains(self):
+        key = 'some_cookie'
+        value = 'some_value'
+        domain1 = 'test1.com'
+        domain2 = 'test2.com'
+
+        jar = requests.cookies.RequestsCookieJar()
+        jar.set(key, value, domain=domain1)
+        jar.set(key, value, domain=domain2)
+        assert key in jar
+
+    def test_cookie_duplicte_names_raises_cookie_conflict_error(self):
+        key = 'some_cookie'
+        value = 'some_value'
+        path = 'some_path'
+
+        jar = requests.cookies.RequestsCookieJar()
+        jar.set(key, value, path=path)
+        jar.set(key, value)
+        with pytest.raises(requests.cookies.CookieConflictError):
+            jar.get(key)
+
     def test_time_elapsed_blank(self, httpbin):
         r = requests.get(httpbin('get'))
         td = r.elapsed
