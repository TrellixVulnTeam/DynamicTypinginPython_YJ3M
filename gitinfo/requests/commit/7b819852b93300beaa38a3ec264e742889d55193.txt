commit 7b819852b93300beaa38a3ec264e742889d55193
Author: Idan Gazit <idan@gazit.me>
Date:   Sun Apr 22 14:39:29 2012 +0300

    Fix Content-Type validation in OAuth1 callable

diff --git a/requests/auth.py b/requests/auth.py
index f4a885ad..18d6318c 100644
--- a/requests/auth.py
+++ b/requests/auth.py
@@ -46,8 +46,9 @@ class OAuth1(AuthBase):
             signature_type, rsa_key, verifier)
 
     def __call__(self, r):
+        contenttype = r.headers.get('Content-Type')
         if (r.files or
-            r.headers['Content-Type'] != 'application/x-www-form-urlencoded'):
+            (contenttype and contenttype != 'application/x-www-form-urlencoded')):
 
             # XXX TODO can we use body signatures with a non formencoded body?
             if self.client.signature_type == SIGNATURE_TYPE_BODY:
@@ -59,7 +60,7 @@ class OAuth1(AuthBase):
             alter_body = False  # we shouldn't touch the body
         else:
             body = r.data  # OAuthLib is cool with both strings and dicts.
-            if isinstance(str, body):
+            if isinstance(body, str):
                 # XXX gross hack. We must pass unicode...
                 body = unicode(body, 'utf-8')
             alter_body = True
