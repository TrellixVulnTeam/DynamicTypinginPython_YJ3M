commit c97a530638bba86576f3e40b49cb0e061b790bdd
Author: Pawel Miech <pawelmhm@gmail.com>
Date:   Mon Oct 31 14:42:01 2016 +0100

    [httpAdapter] allow empty password in proxy credentials
    
    fixes #3659

diff --git a/requests/adapters.py b/requests/adapters.py
index 4a4c4e0e..2475879c 100644
--- a/requests/adapters.py
+++ b/requests/adapters.py
@@ -366,7 +366,7 @@ class HTTPAdapter(BaseAdapter):
         headers = {}
         username, password = get_auth_from_url(proxy)
 
-        if username and password:
+        if username:
             headers['Proxy-Authorization'] = _basic_auth_str(username,
                                                              password)
 
diff --git a/tests/test_requests.py b/tests/test_requests.py
index 5a2608e2..5ce098d9 100755
--- a/tests/test_requests.py
+++ b/tests/test_requests.py
@@ -1472,6 +1472,16 @@ class TestRequests:
         proxies['one'].clear.assert_called_once_with()
         proxies['two'].clear.assert_called_once_with()
 
+    def test_proxy_auth(self, httpbin):
+        adapter = HTTPAdapter()
+        headers = adapter.proxy_headers("http://user:pass@httpbin.org")
+        assert headers == {'Proxy-Authorization': 'Basic dXNlcjpwYXNz'}
+
+    def test_proxy_auth_empty_pass(self, httpbin):
+        adapter = HTTPAdapter()
+        headers = adapter.proxy_headers("http://user:@httpbin.org")
+        assert headers == {'Proxy-Authorization': 'Basic dXNlcjo='}
+
     def test_response_json_when_content_is_None(self, httpbin):
         r = requests.get(httpbin('/status/204'))
         # Make sure r.content is None
