commit 6adabacd81d8e453c3915f8a98692c9891df022b
Author: Braulio Valdivielso Mart√≠nez <brlvldvlsmrtnz@gmail.com>
Date:   Thu Nov 26 01:11:18 2015 +0100

    Close socket properly in test_server_closes

diff --git a/test_requests.py b/test_requests.py
index 2d433f95..e54e6f01 100755
--- a/test_requests.py
+++ b/test_requests.py
@@ -1760,11 +1760,11 @@ class TestTestServer(unittest.TestCase):
         with Server.basic_response_server() as (host, port):
             sock = socket.socket()
             sock.connect((host, port))
+            sock.close()
 
         with pytest.raises(socket.error):
             new_sock = socket.socket()
             new_sock.connect((host, port))
-        sock.close()
             
     def test_basic_response(self):
         with Server.basic_response_server() as (host, port):
