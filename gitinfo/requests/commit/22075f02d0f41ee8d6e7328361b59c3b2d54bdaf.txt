commit 22075f02d0f41ee8d6e7328361b59c3b2d54bdaf
Author: Jason Grout <jgrout6@bloomberg.net>
Date:   Tue Aug 25 18:21:20 2015 +0000

    Clarify the per-host proxy code

diff --git a/requests/adapters.py b/requests/adapters.py
index 0f3dc4da..cc6c8971 100644
--- a/requests/adapters.py
+++ b/requests/adapters.py
@@ -239,8 +239,10 @@ class HTTPAdapter(BaseAdapter):
         :param proxies: (optional) A Requests-style dictionary of proxies used on this request.
         """
         proxies = proxies or {}
-        u = urlparse(url.lower())
-        proxy = proxies.get(u.scheme+'://'+u.hostname, proxies.get(u.scheme))
+        urlparts = urlparse(url.lower())
+        proxy = proxies.get(urlparts.scheme+'://'+urlparts.hostname)
+        if proxy is None:
+            proxy = proxies.get(urlparts.scheme)
 
         if proxy:
             proxy = prepend_scheme_if_needed(proxy, 'http')
