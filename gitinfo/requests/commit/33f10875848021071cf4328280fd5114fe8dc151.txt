commit 33f10875848021071cf4328280fd5114fe8dc151
Author: Roman Haritonov <reclosedev@gmail.com>
Date:   Tue May 8 13:02:39 2012 +0400

    Move session cookie saving from Session.request() to  Request._build_response()

diff --git a/requests/models.py b/requests/models.py
index fbdfb560..beb8f144 100644
--- a/requests/models.py
+++ b/requests/models.py
@@ -203,6 +203,12 @@ class Request(object):
                 # Save cookies in Response.
                 response.cookies = self.cookies
 
+                # Save cookies in Session.
+                # (in safe mode, cookies may be None if the request didn't succeed)
+                if self.cookies is not None:
+                    for cookie in self.cookies:
+                        self.session.cookies.set_cookie(cookie)
+
                 # No exceptions were harmed in the making of this request.
                 response.error = getattr(resp, 'error', None)
 
diff --git a/requests/sessions.py b/requests/sessions.py
index 8d517ab5..dd670dd3 100644
--- a/requests/sessions.py
+++ b/requests/sessions.py
@@ -228,12 +228,6 @@ class Session(object):
         # Send the HTTP Request.
         r.send(prefetch=prefetch)
 
-        # Send any cookies back up the to the session.
-        # (in safe mode, cookies may be None if the request didn't succeed)
-        if r.response.cookies is not None:
-            for cookie in r.response.cookies:
-                self.cookies.set_cookie(cookie)
-
         # Return the response.
         return r.response
 
