commit 9ec222c363b226e908a9d72018e2f467952da52f
Author: Kamil Madac <kamil.madac@gmail.com>
Date:   Mon Dec 2 22:40:26 2013 +0100

    Added test for domain name no_proxy matching.

diff --git a/.idea/dictionaries/kmadac.xml b/.idea/dictionaries/kmadac.xml
new file mode 100644
index 00000000..93bbf4db
--- /dev/null
+++ b/.idea/dictionaries/kmadac.xml
@@ -0,0 +1,3 @@
+<component name="ProjectDictionaryState">
+  <dictionary name="kmadac" />
+</component>
\ No newline at end of file
diff --git a/test_requests.py b/test_requests.py
index cb91ade1..4aa86c3d 100755
--- a/test_requests.py
+++ b/test_requests.py
@@ -917,7 +917,15 @@ class UtilsTestCase(unittest.TestCase):
         assert get_environ_proxies('http://192.168.0.1:5000/') == {}
         assert get_environ_proxies('http://192.168.0.1/') == {}
         assert get_environ_proxies('http://172.16.1.1/') == {}
+        assert get_environ_proxies('http://172.16.1.1:5000/') == {}
         assert get_environ_proxies('http://192.168.1.1:5000/') == {'no': os.environ['no_proxy']}
 
+    def test_get_environ_proxies(self):
+        """ Ensures that IP addresses are correctly matches with ranges in no_proxy variable """
+        from requests.utils import get_environ_proxies
+        os.environ['no_proxy'] = "127.0.0.1,localhost.localdomain,192.168.0.0/24,172.16.1.1"
+        assert get_environ_proxies('http://localhost.localdomain:5000/test/') == {}
+        assert get_environ_proxies('http://www.requests.com/') == {'no': os.environ['no_proxy']}
+
 if __name__ == '__main__':
     unittest.main()
