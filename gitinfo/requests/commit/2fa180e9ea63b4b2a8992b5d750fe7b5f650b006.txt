commit 2fa180e9ea63b4b2a8992b5d750fe7b5f650b006
Author: Kenneth Reitz <me@kennethreitz.com>
Date:   Sun Aug 28 03:22:03 2011 -0400

    automatic header expansion

diff --git a/requests/api.py b/requests/api.py
index 0928d8c8..8f8d6ea0 100644
--- a/requests/api.py
+++ b/requests/api.py
@@ -15,7 +15,7 @@ import config
 from .models import Request, Response, AuthObject
 from .status_codes import codes
 from .hooks import dispatch_hook
-from .utils import cookiejar_from_dict
+from .utils import cookiejar_from_dict, header_expand
 
 from urlparse import urlparse
 
@@ -48,6 +48,14 @@ def request(method, url,
 
     cookies = cookiejar_from_dict(cookies)
 
+    # Expand header values
+    if headers:
+        for k, v in headers.items() or {}:
+            headers[k] = header_expand(v)
+
+    # headers = [(k, map(header_expand, v)) for k,v in headers.items()]
+    # print headers
+
     args = dict(
         method = method,
         url = url,
