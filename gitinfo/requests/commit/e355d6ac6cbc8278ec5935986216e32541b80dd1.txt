commit e355d6ac6cbc8278ec5935986216e32541b80dd1
Author: Bryce Boe <bbzbryce@gmail.com>
Date:   Mon Dec 17 17:13:18 2012 -0800

    Fix issue 1027. Always persist cookies.

diff --git a/requests/sessions.py b/requests/sessions.py
index 8ea1e27d..9aa8c13f 100644
--- a/requests/sessions.py
+++ b/requests/sessions.py
@@ -71,10 +71,6 @@ class SessionRedirectMixin(object):
         # ((resp.status_code is codes.see_other))
         while (('location' in resp.headers and resp.status_code in REDIRECT_STATI)):
 
-            # Persist cookies.
-            for cookie in resp.cookies:
-                self.cookies.set_cookie(cookie)
-
             resp.content  # Consume socket so it can be released
 
             if i >= self.max_redirects:
@@ -265,6 +261,10 @@ class Session(SessionRedirectMixin):
         # Send the request.
         resp = self.send(prep, stream=stream, timeout=timeout, verify=verify, cert=cert, proxies=proxies)
 
+        # Persist cookies.
+        for cookie in resp.cookies:
+            self.cookies.set_cookie(cookie)
+
         # Redirect resolving generator.
         gen = self.resolve_redirects(resp, req, stream=stream, timeout=timeout, verify=verify, cert=cert, proxies=proxies)
 
