commit 3185d295ea426fc2348fe39e57f461147cd2780a
Author: Audrey Roy <audreyr@gmail.com>
Date:   Fri Sep 6 17:11:49 2013 +0200

    Fix main tests to match new functionality: outputting the project into the cur dir.

diff --git a/cookiecutter/main.py b/cookiecutter/main.py
index 0f03a83..4e7e5fe 100755
--- a/cookiecutter/main.py
+++ b/cookiecutter/main.py
@@ -44,13 +44,11 @@ def cookiecutter(input_dir, checkout=None, no_input=False):
         got_repo_arg = False
         repo_dir = input_dir
 
-    # project_template = find_template(repo_dir)
-    config_file = os.path.join(os.path.dirname(project_template),
-                               'cookiecutter.json')
-    logging.debug('config_file is {0}'.format(config_file))
+    context_file = os.path.join(repo_dir, 'cookiecutter.json')
+    logging.debug('context_file is {0}'.format(context_file))
 
     context = generate_context(
-        config_file=config_file
+        config_file=context_file
     )
 
     # prompt the user to manually configure at the command line.
@@ -62,7 +60,6 @@ def cookiecutter(input_dir, checkout=None, no_input=False):
     # Create project from local context and project template.
     generate_files(
         repo_dir=repo_dir,
-        # template_dir=project_template,
         context=context
     )
 
diff --git a/tests/test_main.py b/tests/test_main.py
index 4308033..1ff83ec 100755
--- a/tests/test_main.py
+++ b/tests/test_main.py
@@ -41,20 +41,22 @@ class TestCookiecutterLocalNoInput(unittest.TestCase):
     def test_cookiecutter(self):
         main.cookiecutter('tests/fake-repo-pre/', no_input=True)
         self.assertTrue(os.path.isdir('tests/fake-repo-pre/{{cookiecutter.repo_name}}'))
-        self.assertTrue(os.path.isdir('tests/fake-repo-pre/fake-project'))
-        self.assertTrue(os.path.isfile('tests/fake-repo-pre/fake-project/README.rst'))
-        self.assertFalse(os.path.exists('tests/fake-repo-pre/fake-project/json/'))
+        self.assertFalse(os.path.isdir('tests/fake-repo-pre/fake-project'))
+        self.assertTrue(os.path.isdir('fake-project'))
+        self.assertTrue(os.path.isfile('fake-project/README.rst'))
+        self.assertFalse(os.path.exists('fake-project/json/'))
 
     def test_cookiecutter_no_slash(self):
         main.cookiecutter('tests/fake-repo-pre', no_input=True)
         self.assertTrue(os.path.isdir('tests/fake-repo-pre/{{cookiecutter.repo_name}}'))
-        self.assertTrue(os.path.isdir('tests/fake-repo-pre/fake-project'))
-        self.assertTrue(os.path.isfile('tests/fake-repo-pre/fake-project/README.rst'))
-        self.assertFalse(os.path.exists('tests/fake-repo-pre/fake-project/json/'))
+        self.assertFalse(os.path.isdir('tests/fake-repo-pre/fake-project'))
+        self.assertTrue(os.path.isdir('fake-project'))
+        self.assertTrue(os.path.isfile('fake-project/README.rst'))
+        self.assertFalse(os.path.exists('fake-project/json/'))
 
     def tearDown(self):
-        if os.path.isdir('tests/fake-repo-pre/fake-project'):
-            shutil.rmtree('tests/fake-repo-pre/fake-project')
+        if os.path.isdir('fake-project'):
+            shutil.rmtree('fake-project')
 
 
 class TestCookiecutterLocalWithInput(unittest.TestCase):
@@ -66,13 +68,14 @@ class TestCookiecutterLocalWithInput(unittest.TestCase):
 
         main.cookiecutter('tests/fake-repo-pre/', no_input=False)
         self.assertTrue(os.path.isdir('tests/fake-repo-pre/{{cookiecutter.repo_name}}'))
-        self.assertTrue(os.path.isdir('tests/fake-repo-pre/fake-project'))
-        self.assertTrue(os.path.isfile('tests/fake-repo-pre/fake-project/README.rst'))
-        self.assertFalse(os.path.exists('tests/fake-repo-pre/fake-project/json/'))
+        self.assertFalse(os.path.isdir('tests/fake-repo-pre/fake-project'))
+        self.assertTrue(os.path.isdir('fake-project'))
+        self.assertTrue(os.path.isfile('fake-project/README.rst'))
+        self.assertFalse(os.path.exists('fake-project/json/'))
 
     def tearDown(self):
-        if os.path.isdir('tests/fake-repo-pre/fake-project'):
-            shutil.rmtree('tests/fake-repo-pre/fake-project')
+        if os.path.isdir('fake-project'):
+            shutil.rmtree('fake-project')
 
 
 class TestArgParsing(unittest.TestCase):
