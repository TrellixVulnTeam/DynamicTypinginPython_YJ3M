commit 8c202fb5dfdab014d16a92f0df216f4b7b44d505
Author: Raphael Pierzina <raphael@hackebrot.de>
Date:   Tue Nov 11 23:48:01 2014 +0100

    Convert last test of TestGenerateFiles to pytest

diff --git a/tests/test_generate.py b/tests/test_generate.py
index 2fb7e63..bb1f37b 100755
--- a/tests/test_generate.py
+++ b/tests/test_generate.py
@@ -72,50 +72,6 @@ class TestGenerateFile(unittest.TestCase):
             os.remove('tests/files/cheese.txt')
 
 
-class TestGenerateFiles(CookiecutterCleanSystemTestCase):
-
-    def tearDown(self):
-        if os.path.exists('inputpizzä'):
-            utils.rmtree('inputpizzä')
-        if os.path.exists('inputgreen'):
-            utils.rmtree('inputgreen')
-        if os.path.exists('inputbinary_files'):
-            utils.rmtree('inputbinary_files')
-        if os.path.exists('tests/custom_output_dir'):
-            utils.rmtree('tests/custom_output_dir')
-        if os.path.exists('inputpermissions'):
-            utils.rmtree('inputpermissions')
-        super(TestGenerateFiles, self).tearDown()
-
-    def test_generate_files_permissions(self):
-        """
-        simple.txt and script.sh should retain their respective 0o644 and
-        0o755 permissions
-        """
-        generate.generate_files(
-            context={
-                'cookiecutter': {'permissions': 'permissions'}
-            },
-            repo_dir='tests/test-generate-files-permissions'
-        )
-
-        self.assertTrue(os.path.isfile('inputpermissions/simple.txt'))
-
-        # simple.txt should still be 0o644
-        self.assertEquals(
-            os.stat('tests/test-generate-files-permissions/input{{cookiecutter.permissions}}/simple.txt').st_mode & 0o777,
-            os.stat('inputpermissions/simple.txt').st_mode & 0o777
-        )
-
-        self.assertTrue(os.path.isfile('inputpermissions/script.sh'))
-
-        # script.sh should still be 0o755
-        self.assertEquals(
-            os.stat('tests/test-generate-files-permissions/input{{cookiecutter.permissions}}/script.sh').st_mode & 0o777,
-            os.stat('inputpermissions/script.sh').st_mode & 0o777
-        )
-
-
 class TestGenerateContext(CookiecutterCleanSystemTestCase):
 
     def test_generate_context(self):
diff --git a/tests/test_generate_files.py b/tests/test_generate_files.py
index f2aba93..acfc5ea 100644
--- a/tests/test_generate_files.py
+++ b/tests/test_generate_files.py
@@ -12,6 +12,7 @@ TestGenerateFiles.test_generate_files_with_trailing_newline
 TestGenerateFiles.test_generate_files_binaries
 TestGenerateFiles.test_generate_files_absolute_path
 TestGenerateFiles.test_generate_files_output_dir
+TestGenerateFiles.test_generate_files_permissions
 """
 
 from __future__ import unicode_literals
@@ -138,3 +139,27 @@ def test_generate_files_output_dir():
         output_dir='tests/custom_output_dir'
     )
     assert os.path.isfile('tests/custom_output_dir/inputpizzä/simple.txt')
+
+
+@pytest.mark.usefixtures("clean_system_remove_additional_folders")
+def test_generate_files_permissions():
+    """
+    simple.txt and script.sh should retain their respective 0o644 and
+    0o755 permissions
+    """
+    generate.generate_files(
+        context={
+            'cookiecutter': {'permissions': 'permissions'}
+        },
+        repo_dir='tests/test-generate-files-permissions'
+    )
+
+    assert os.path.isfile('inputpermissions/simple.txt')
+
+    # simple.txt should still be 0o644
+    assert os.stat('tests/test-generate-files-permissions/input{{cookiecutter.permissions}}/simple.txt').st_mode & 0o777 == os.stat('inputpermissions/simple.txt').st_mode & 0o777
+
+    assert os.path.isfile('inputpermissions/script.sh')
+
+    # script.sh should still be 0o755
+    assert os.stat('tests/test-generate-files-permissions/input{{cookiecutter.permissions}}/script.sh').st_mode & 0o777 == os.stat('inputpermissions/script.sh').st_mode & 0o777
