commit 7702da5e05ff02bca4aae14c161199c6dd055206
Author: Audrey Roy <audreyr@gmail.com>
Date:   Wed Aug 7 20:51:15 2013 +0200

    Make tests pass after json/ -> cookiecutter.json config change.

diff --git a/cookiecutter/find.py b/cookiecutter/find.py
index f44daa9..6d1230a 100755
--- a/cookiecutter/find.py
+++ b/cookiecutter/find.py
@@ -22,7 +22,7 @@ def find_template(repo_dir):
 
     logging.info('Searching {0} for the project template.'.format(repo_dir))
     contents_set = set(os.listdir(repo_dir))
-    exclude_set = set(['.DS_Store', '.git', '.gitignore', 'README.rst', 'json'])
+    exclude_set = set(['.DS_Store', '.git', '.gitignore', 'README.rst', 'cookiecutter.json'])
     
     # Subtract set of excludes from contents.
     contents_set -= exclude_set
diff --git a/cookiecutter/main.py b/cookiecutter/main.py
index cc5e8e8..c1ae6d6 100755
--- a/cookiecutter/main.py
+++ b/cookiecutter/main.py
@@ -40,12 +40,12 @@ def cookiecutter(input_dir):
         got_repo_arg = False
         project_template = find_template(input_dir)
 
-    json_dir = os.path.join(os.path.dirname(project_template), 'json/')
-    logging.info('json_dir is {0}'.format(json_dir))
+    config_file = os.path.join(os.path.dirname(project_template), 'cookiecutter.json')
+    logging.info('config_file is {0}'.format(config_file))
 
     # Create project from local context and project template.
     context = generate_context(
-        json_dir=json_dir
+        config_file=config_file
     )
     generate_files(
         template_dir=project_template,
@@ -55,7 +55,7 @@ def cookiecutter(input_dir):
     # Remove repo if Cookiecutter cloned it in the first place.
     # Here the user just wants a project, not a project template.
     if got_repo_arg:
-        generated_project = context['project']['repo_name']
+        generated_project = context['cookiecutter']['repo_name']
         remove_repo(repo_dir, generated_project)
     
 
diff --git a/tests/fake-repo-pre/{{project.repo_name}}/README.rst b/tests/fake-repo-pre/{{cookiecutter.repo_name}}/README.rst
similarity index 100%
rename from tests/fake-repo-pre/{{project.repo_name}}/README.rst
rename to tests/fake-repo-pre/{{cookiecutter.repo_name}}/README.rst
diff --git a/tests/test_examples.py b/tests/test_examples.py
index 16d6a53..56e6603 100755
--- a/tests/test_examples.py
+++ b/tests/test_examples.py
@@ -20,7 +20,7 @@ else:
 
 
 @unittest.skip(reason='Works locally with tox but fails on Travis.')
-class TestExamples(unittest.TestCase):
+class TestPyPackage(unittest.TestCase):
 
     def test_cookiecutter_pypackage(self):
         """
@@ -34,7 +34,23 @@ class TestExamples(unittest.TestCase):
     def tearDown(self):
         if os.path.isdir('cookiecutter-pypackage'):
             shutil.rmtree('cookiecutter-pypackage')
-            
+
+@unittest.skip(reason='Works locally with tox but fails on Travis.')
+class TestJQuery(unittest.TestCase):
+
+    def test_cookiecutter_jquery(self):
+        """
+        Tests that https://github.com/audreyr/cookiecutter-jquery.git works.
+        """
+
+        os.system('git clone https://github.com/audreyr/cookiecutter-jquery.git')
+        os.system('cookiecutter cookiecutter-jquery/')
+        self.assertTrue(os.path.isfile('cookiecutter-jquery/boilerplate/README.md'))
+
+    def tearDown(self):
+        if os.path.isdir('cookiecutter-jquery'):
+            shutil.rmtree('cookiecutter-jquery')
+
 @unittest.skip(reason='Works locally with tox but fails on Travis.')
 class TestExamplesRepoArg(unittest.TestCase):
     
diff --git a/tests/test_find.py b/tests/test_find.py
index bccf95f..36d1644 100755
--- a/tests/test_find.py
+++ b/tests/test_find.py
@@ -20,12 +20,27 @@ class TestFind(unittest.TestCase):
     def test_find_template(self):
         os.system('git clone https://github.com/audreyr/cookiecutter-pypackage.git')
         template = find.find_template(repo_dir='cookiecutter-pypackage')
-        self.assertEqual(template, 'cookiecutter-pypackage/{{project.repo_name}}')
-        self.assertNotEqual(template, 'cookiecutter-pypackage/{{project.repo_name }}')
-        self.assertNotEqual(template, 'cookiecutter-pypackage/{{ project.repo_name }}')
+        self.assertEqual(template, 'cookiecutter-pypackage/{{cookiecutter.repo_name}}')
+        self.assertNotEqual(template, 'cookiecutter-pypackage/{{cookiecutter.repo_name }}')
+        self.assertNotEqual(template, 'cookiecutter-pypackage/{{ cookiecutter.repo_name }}')
 
+    def tearDown(self):
         if os.path.isdir('cookiecutter-pypackage'):
             shutil.rmtree('cookiecutter-pypackage')
 
+class TestFind2(unittest.TestCase):
+
+    def test_find_template2(self):
+        os.system('git clone https://github.com/audreyr/cookiecutter-jquery.git')
+        template = find.find_template(repo_dir='cookiecutter-jquery')
+        self.assertEqual(template, 'cookiecutter-jquery/{{cookiecutter.repo_name}}')
+        self.assertNotEqual(template, 'cookiecutter-jquery/{{cookiecutter.repo_name }}')
+        self.assertNotEqual(template, 'cookiecutter-jquery/{{ cookiecutter.repo_name }}')
+
+    def tearDown(self):
+        if os.path.isdir('cookiecutter-jquery'):
+            shutil.rmtree('cookiecutter-jquery')
+
+
 if __name__ == '__main__':
     unittest.main()
diff --git a/tests/test_main.py b/tests/test_main.py
index 66372bf..c59691a 100755
--- a/tests/test_main.py
+++ b/tests/test_main.py
@@ -24,14 +24,14 @@ class TestCookiecutter(unittest.TestCase):
 
     def test_cookiecutter(self):
         main.cookiecutter('tests/fake-repo-pre/')
-        self.assertTrue(os.path.isdir('tests/fake-repo-pre/{{project.repo_name}}'))
+        self.assertTrue(os.path.isdir('tests/fake-repo-pre/{{cookiecutter.repo_name}}'))
         self.assertTrue(os.path.isdir('tests/fake-repo-pre/fake-project'))
         self.assertTrue(os.path.isfile('tests/fake-repo-pre/fake-project/README.rst'))
         self.assertFalse(os.path.exists('tests/fake-repo-pre/fake-project/json/'))
 
     def test_cookiecutter_no_slash(self):
         main.cookiecutter('tests/fake-repo-pre')
-        self.assertTrue(os.path.isdir('tests/fake-repo-pre/{{project.repo_name}}'))
+        self.assertTrue(os.path.isdir('tests/fake-repo-pre/{{cookiecutter.repo_name}}'))
         self.assertTrue(os.path.isdir('tests/fake-repo-pre/fake-project'))
         self.assertTrue(os.path.isfile('tests/fake-repo-pre/fake-project/README.rst'))
         self.assertFalse(os.path.exists('tests/fake-repo-pre/fake-project/json/'))
