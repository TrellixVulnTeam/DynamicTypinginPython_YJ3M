commit f4e7341c87f8b809e63cd19e0f7534499cbb7f1c
Author: Audrey Roy <audreyr@gmail.com>
Date:   Sat Aug 10 13:29:53 2013 +0200

    Factor out getting command-line args, and test it.

diff --git a/cookiecutter/main.py b/cookiecutter/main.py
index d5ed9e6..76e7c92 100755
--- a/cookiecutter/main.py
+++ b/cookiecutter/main.py
@@ -65,15 +65,10 @@ def cookiecutter(input_dir):
     if got_repo_arg:
         generated_project = context['cookiecutter']['repo_name']
         remove_repo(repo_dir, generated_project)
-    
 
-def main():
-    """ Entry point for the package, as defined in setup.py. """
+def parse_cookiecutter_args(args):
+    """ Parse the command-line arguments to Cookiecutter. """
 
-    # Log info and above to console
-    logging.basicConfig(format='%(levelname)s: %(message)s', level=logging.INFO)
-
-    # Get command line input/output arguments
     parser = argparse.ArgumentParser(
         description='Create a project from a Cookiecutter project template.'
     )
@@ -81,7 +76,15 @@ def main():
         'input_dir',
         help='Cookiecutter project template dir, e.g. {{project.repo_name}}/'
     )
-    args = parser.parse_args()
+    return parser.parse_args(args)
+    
+def main():
+    """ Entry point for the package, as defined in setup.py. """
+
+    # Log info and above to console
+    logging.basicConfig(format='%(levelname)s: %(message)s', level=logging.INFO)
+
+    args = parse_cookiecutter_args(sys.argv)
     
     cookiecutter(args.input_dir)
 
diff --git a/tests/test_main.py b/tests/test_main.py
index 7509476..21e4530 100755
--- a/tests/test_main.py
+++ b/tests/test_main.py
@@ -45,6 +45,12 @@ class TestCookiecutter(unittest.TestCase):
         if os.path.isdir('tests/fake-repo-pre/fake-project'):
             shutil.rmtree('tests/fake-repo-pre/fake-project')
 
+class TestArgParsing(unittest.TestCase):
+    
+    def test_parse_cookiecutter_args(self):
+        args = main.parse_cookiecutter_args(['project/'])
+        self.assertEqual(args.input_dir, 'project/')
+
 @unittest.skip(reason='Need to mock input with pexpect or something.')
 class TestCookiecutterRepoArg(unittest.TestCase):
 
