commit e2576ba5ab3b8edee6b2f502ef4da54bc90bf6d2
Author: Raphael Pierzina <raphael@hackebrot.de>
Date:   Sun Jul 31 18:03:22 2016 +0100

    Implement tests for the new debug_file flag

diff --git a/tests/test_cli.py b/tests/test_cli.py
index ca75e52..6331a2c 100644
--- a/tests/test_cli.py
+++ b/tests/test_cli.py
@@ -374,3 +374,53 @@ def test_cli_extra_context_invalid_format():
     assert result.exit_code == 2
     assert 'Error: Invalid value for "extra_context"' in result.output
     assert 'should contain items of the form key=value' in result.output
+
+
+@pytest.fixture
+def debug_file(tmpdir):
+    return tmpdir / 'fake-repo.log'
+
+
+@pytest.mark.usefixtures('remove_fake_project_dir')
+def test_debug_file_non_verbose(debug_file):
+    assert not debug_file.exists()
+
+    result = runner.invoke(main, [
+        '--no-input',
+        '--debug-file',
+        str(debug_file),
+        'tests/fake-repo-pre/',
+    ])
+    assert result.exit_code == 0
+
+    assert debug_file.exists()
+
+    context_log = (
+        "DEBUG [fake-repo-pre] cookiecutter.main: context_file is "
+        "tests/fake-repo-pre/cookiecutter.json"
+    )
+    assert context_log in debug_file.readlines(cr=False)
+    assert context_log not in result.output
+
+
+@pytest.mark.usefixtures('remove_fake_project_dir')
+def test_debug_file_verbose(debug_file):
+    assert not debug_file.exists()
+
+    result = runner.invoke(main, [
+        '--verbose',
+        '--no-input',
+        '--debug-file',
+        str(debug_file),
+        'tests/fake-repo-pre/',
+    ])
+    assert result.exit_code == 0
+
+    assert debug_file.exists()
+
+    context_log = (
+        "DEBUG [fake-repo-pre] cookiecutter.main: context_file is "
+        "tests/fake-repo-pre/cookiecutter.json"
+    )
+    assert context_log in debug_file.readlines(cr=False)
+    assert context_log in result.output
