commit 2e46e42a286e491ab28e19b279fd8bb023fdd5f4
Author: Raphael Pierzina <raphael@hackebrot.de>
Date:   Thu Aug 6 18:05:37 2015 +0200

    Implement test to ensure the context is dumped

diff --git a/tests/test_replay.py b/tests/test_replay.py
index 5bf2dba..09b4f45 100644
--- a/tests/test_replay.py
+++ b/tests/test_replay.py
@@ -5,6 +5,7 @@ test_replay
 -----------
 """
 
+import json
 import os
 import pytest
 
@@ -61,3 +62,21 @@ def test_raise_if_replay_dir_creation_fails(
         replay.dump(template_name, context)
 
     mock_ensure.assert_called_once_with(replay_dir)
+
+
+def test_run_json_dump(
+        mocker, template_name, context, replay_dir):
+    spy_ensure = mocker.spy(
+        'cookiecutter.replay.make_sure_path_exists',
+    )
+
+    replay.dump(template_name, context)
+
+    spy_ensure.assert_called_once_with(replay_dir)
+
+    replay_dir = os.path.expanduser('~/.cookiecutter_replay/')
+    replay_file = os.path.join(replay_dir, template_name)
+
+    with open(replay_file, 'r') as f:
+        dumped_context = json.load(f)
+        assert dumped_context == context
