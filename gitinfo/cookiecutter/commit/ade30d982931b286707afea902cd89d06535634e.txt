commit ade30d982931b286707afea902cd89d06535634e
Author: Raphael Pierzina <raphael@hackebrot.de>
Date:   Sat Nov 15 11:33:24 2014 +0100

    Use a fixture for the environment

diff --git a/tests/test_generate_file.py b/tests/test_generate_file.py
index 28cbf7b..5d1c2a3 100644
--- a/tests/test_generate_file.py
+++ b/tests/test_generate_file.py
@@ -33,10 +33,15 @@ def remove_cheese_file(request):
     request.addfinalizer(fin_remove_cheese_file)
 
 
+@pytest.fixture
+def env():
+    environment = Environment()
+    environment.loader = FileSystemLoader('.')
+    return environment
+
+
 @pytest.mark.usefixtures('remove_cheese_file')
-def test_generate_file():
-    env = Environment()
-    env.loader = FileSystemLoader('.')
+def test_generate_file(env):
     infile = 'tests/files/{{generate_file}}.txt'
     generate.generate_file(
         project_dir=".",
@@ -51,9 +56,7 @@ def test_generate_file():
 
 
 @pytest.mark.usefixtures('remove_cheese_file')
-def test_generate_file_verbose_template_syntax_error():
-    env = Environment()
-    env.loader = FileSystemLoader('.')
+def test_generate_file_verbose_template_syntax_error(env):
     try:
         generate.generate_file(
             project_dir=".",
