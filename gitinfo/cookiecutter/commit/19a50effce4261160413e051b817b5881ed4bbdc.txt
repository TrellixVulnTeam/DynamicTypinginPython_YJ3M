commit 19a50effce4261160413e051b817b5881ed4bbdc
Author: Raphael Pierzina <raphael@hackebrot.de>
Date:   Tue Dec 22 00:25:41 2015 +0100

    Implement a simple cli test for the UnknownExtension error

diff --git a/cookiecutter/cli.py b/cookiecutter/cli.py
index 92e4d12..0048f45 100755
--- a/cookiecutter/cli.py
+++ b/cookiecutter/cli.py
@@ -22,7 +22,8 @@ from cookiecutter.exceptions import (
     OutputDirExistsException,
     InvalidModeException,
     FailedHookException,
-    UndefinedVariableInTemplate
+    UndefinedVariableInTemplate,
+    UnknownExtension
 )
 
 logger = logging.getLogger(__name__)
@@ -105,7 +106,8 @@ def main(template, no_input, checkout, verbose, replay, overwrite_if_exists,
         )
     except (OutputDirExistsException,
             InvalidModeException,
-            FailedHookException) as e:
+            FailedHookException,
+            UnknownExtension) as e:
         click.echo(e)
         sys.exit(1)
     except UndefinedVariableInTemplate as undefined_err:
diff --git a/tests/test-extensions/cookiecutter.json b/tests/test-extensions/cookiecutter.json
new file mode 100644
index 0000000..d03feef
--- /dev/null
+++ b/tests/test-extensions/cookiecutter.json
@@ -0,0 +1,6 @@
+{
+    "project_slug": "Foobar",
+    "year": "{% now 'utc', '%Y' %}",
+    "_extensions": ["jinja2_time.TimeExtension"]
+}
+
diff --git a/tests/test-extensions/{{cookiecutter.project_slug}}/HISTORY.rst b/tests/test-extensions/{{cookiecutter.project_slug}}/HISTORY.rst
new file mode 100644
index 0000000..84a0ae0
--- /dev/null
+++ b/tests/test-extensions/{{cookiecutter.project_slug}}/HISTORY.rst
@@ -0,0 +1,7 @@
+History
+-------
+
+0.1.0 ({% now 'utc', '%Y-%m-%d' %})
+---------------------
+
+First release on PyPI.
diff --git a/tests/test_cli.py b/tests/test_cli.py
index 0db9db8..1cd0139 100644
--- a/tests/test_cli.py
+++ b/tests/test_cli.py
@@ -326,3 +326,20 @@ def test_echo_undefined_variable_error(tmpdir):
     }
     context_str = json.dumps(context, indent=4, sort_keys=True)
     assert context_str in result.output
+
+
+def test_echo_unknown_extension_error(tmpdir):
+    output_dir = str(tmpdir.mkdir('output'))
+    template_path = 'tests/test-extensions/'
+
+    result = runner.invoke(main, [
+        '--no-input',
+        '--default-config',
+        '--output-dir',
+        output_dir,
+        template_path,
+    ])
+
+    assert result.exit_code == 1
+
+    assert 'Unable to load extension: ' in result.output
