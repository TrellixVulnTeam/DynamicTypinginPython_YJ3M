commit 189e70ce76a71b3b9c282989acc6c539d73856c9
Author: Audrey Roy <audreyr@gmail.com>
Date:   Sat Sep 7 16:44:30 2013 +0200

    Better handling of clone_to_dir() in git_clone().

diff --git a/cookiecutter/vcs.py b/cookiecutter/vcs.py
index 4fa2b88..8bf2264 100755
--- a/cookiecutter/vcs.py
+++ b/cookiecutter/vcs.py
@@ -25,10 +25,14 @@ def git_clone(repo, checkout=None, clone_to_dir="."):
     :param repo: Git repo URL ending with .git.
     :param checkout: The branch, tag or commit ID to checkout after clone
     """
+    
+    # Ensure that clone_to_dir exists
+    if not os.path.isdir(clone_to_dir):
+        os.makedirs(clone_to_dir)
 
     # Return repo dir
     tail = os.path.split(repo)[1]
-    repo_dir = os.path.join(clone_to_dir, tail.rsplit('.git')[0])
+    repo_dir = os.path.normpath(os.path.join(clone_to_dir, tail.rsplit('.git')[0]))
     logging.debug('repo_dir is {0}'.format(repo_dir))
 
     if os.path.isdir(repo_dir):
diff --git a/tests/test_vcs.py b/tests/test_vcs.py
index 55a2b2b..5a5a9ef 100755
--- a/tests/test_vcs.py
+++ b/tests/test_vcs.py
@@ -28,7 +28,7 @@ else:
     input_str = '__builtin__.raw_input'
     from cStringIO import StringIO
 
-from cookiecutter import vcs
+from cookiecutter import utils, vcs
 
 
 # Log debug and above to console
@@ -68,6 +68,21 @@ class TestVCS(unittest.TestCase):
         if os.path.isdir(git_dir):
             shutil.rmtree(git_dir)
 
+    def test_git_clone_custom_dir(self):
+        os.makedirs("tests/custom_dir1/custom_dir2/")
+        repo_dir = vcs.git_clone(
+            repo='https://github.com/audreyr/cookiecutter-pypackage.git',
+            checkout=None,
+            clone_to_dir="tests/custom_dir1/custom_dir2/"
+        )
+        with utils.work_in("tests/custom_dir1/custom_dir2/"):
+            self.assertEqual(repo_dir, 'tests/custom_dir1/custom_dir2/cookiecutter-pypackage')
+            self.assertTrue(os.path.isfile('cookiecutter-pypackage/README.rst'))
+            if os.path.isdir('cookiecutter-pypackage'):
+                shutil.rmtree('cookiecutter-pypackage')
+        if os.path.isdir('tests/custom_dir1'):
+            shutil.rmtree('tests/custom_dir1')
+
 
 class TestVCSPrompt(unittest.TestCase):
 
