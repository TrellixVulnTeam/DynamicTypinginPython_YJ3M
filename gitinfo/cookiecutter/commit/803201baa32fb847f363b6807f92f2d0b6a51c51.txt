commit 803201baa32fb847f363b6807f92f2d0b6a51c51
Author: Raphael Pierzina <raphael@hackebrot.de>
Date:   Sun Nov 8 01:07:52 2015 +0100

    Test that an error in pre_gen_project aborts generation

diff --git a/tests/test_abort_generate_on_hook_error.py b/tests/test_abort_generate_on_hook_error.py
new file mode 100644
index 0000000..2b3ca74
--- /dev/null
+++ b/tests/test_abort_generate_on_hook_error.py
@@ -0,0 +1,27 @@
+# -*- coding: utf-8 -*-
+
+import pytest
+
+from cookiecutter import generate
+from cookiecutter import exceptions
+
+
+@pytest.mark.usefixtures('clean_system')
+def test_pre_gen_hook(tmpdir):
+    context = {
+        'cookiecutter': {
+            "repo_dir": "foobar",
+            "abort_pre_gen": "yes",
+            "abort_post_gen": "no"
+        }
+    }
+
+    with pytest.raises(exceptions.FailedHookException):
+        generate.generate_files(
+            repo_dir='tests/hooks-abort-render',
+            context=context,
+            output_dir=str(tmpdir)
+        )
+
+    assert not tmpdir.join('foobar').isdir()
+
