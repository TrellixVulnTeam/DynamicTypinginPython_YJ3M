commit 1d4f12b0713247dfa4beb7faf047ed9fcdefd81f
Author: Audrey Roy <audreyr@gmail.com>
Date:   Sun Sep 22 19:59:35 2013 +0200

    Get tests that test the example cookiecutters to pass on Windows.

diff --git a/tests/__init__.py b/tests/__init__.py
index f01f42d..5af2dc4 100755
--- a/tests/__init__.py
+++ b/tests/__init__.py
@@ -10,6 +10,7 @@ Contains testing helpers.
 
 import os
 import shutil
+import stat
 import sys
 if sys.version_info[:2] < (2, 7):
     import unittest2 as unittest
@@ -17,6 +18,21 @@ else:
     import unittest
 
 
+def force_delete(func, path, exc_info):
+    """
+    Error handler for `shutil.rmtree()` equivalent to `rm -rf`
+    Usage: `shutil.rmtree(path, onerror=force_delete)`
+    From stackoverflow.com/questions/2656322
+    """
+
+    if not os.access(path, os.W_OK):
+        # Is the error an access error?
+        os.chmod(path, stat.S_IWUSR)
+        func(path)
+    else:
+        raise
+
+
 class CookiecutterCleanSystemTestCase(unittest.TestCase):
     """
     Test case that simulates a clean system with no config/cloned cookiecutters.
diff --git a/tests/test_examples.py b/tests/test_examples.py
index 4aebfb5..3d41f0d 100755
--- a/tests/test_examples.py
+++ b/tests/test_examples.py
@@ -10,6 +10,7 @@ Tests for the Cookiecutter example repos.
 
 from __future__ import unicode_literals
 import errno
+import logging
 import os
 import shutil
 import subprocess
@@ -37,17 +38,21 @@ except KeyError:
     travis = False
 
 from cookiecutter import config, utils
-from tests import CookiecutterCleanSystemTestCase
+from tests import force_delete, CookiecutterCleanSystemTestCase
+
+
+logging.basicConfig(format='%(levelname)s: %(message)s', level=logging.DEBUG)
 
 
 @unittest.skipIf(condition=travis, reason='Works locally with tox but fails on Travis.')
 class TestPyPackage(CookiecutterCleanSystemTestCase):
 
+
     def tearDown(self):
         if os.path.isdir('cookiecutter-pypackage'):
-            shutil.rmtree('cookiecutter-pypackage')
+            shutil.rmtree('cookiecutter-pypackage', onerror=force_delete)
         if os.path.isdir('boilerplate'):
-            shutil.rmtree('boilerplate')
+            shutil.rmtree('boilerplate', onerror=force_delete)
         super(TestPyPackage, self).tearDown()
 
     def test_cookiecutter_pypackage(self):
@@ -69,6 +74,12 @@ class TestPyPackage(CookiecutterCleanSystemTestCase):
         )
         proc.wait()
 
+        cwd = os.getcwd()
+        logging.debug("cwd is {}".format(cwd))
+
+        ls = os.listdir(cwd)
+        logging.debug("ls is {}".format(ls))
+
         self.assertTrue(os.path.isdir('cookiecutter-pypackage'))
         self.assertTrue(os.path.isfile('boilerplate/README.rst'))
 
@@ -79,9 +90,9 @@ class TestJQuery(CookiecutterCleanSystemTestCase):
 
     def tearDown(self):
         if os.path.isdir('cookiecutter-jquery'):
-            shutil.rmtree('cookiecutter-jquery')
+            shutil.rmtree('cookiecutter-jquery', onerror=force_delete)
         if os.path.isdir('boilerplate'):
-            shutil.rmtree('boilerplate')
+            shutil.rmtree('boilerplate', onerror=force_delete)
         super(TestJQuery, self).tearDown()
 
     def test_cookiecutter_jquery(self):
@@ -113,9 +124,9 @@ class TestExamplesRepoArg(CookiecutterCleanSystemTestCase):
     def tearDown(self):
         with utils.work_in(config.DEFAULT_CONFIG['cookiecutters_dir']):
             if os.path.isdir('cookiecutter-pypackage'):
-                shutil.rmtree('cookiecutter-pypackage')
+                shutil.rmtree('cookiecutter-pypackage', onerror=force_delete)
         if os.path.isdir('boilerplate'):
-            shutil.rmtree('boilerplate')
+            shutil.rmtree('boilerplate', onerror=force_delete)
         super(TestExamplesRepoArg, self).tearDown()
 
     def test_cookiecutter_pypackage_git(self):
@@ -138,9 +149,9 @@ class TestGitBranch(CookiecutterCleanSystemTestCase):
     def tearDown(self):
         with utils.work_in(config.DEFAULT_CONFIG['cookiecutters_dir']):
             if os.path.isdir('cookiecutter-pypackage'):
-                shutil.rmtree('cookiecutter-pypackage')
+                shutil.rmtree('cookiecutter-pypackage', onerror=force_delete)
         if os.path.isdir('boilerplate'):
-            shutil.rmtree('boilerplate')
+            shutil.rmtree('boilerplate', onerror=force_delete)
         super(TestGitBranch, self).tearDown()
 
     def test_branch(self):
