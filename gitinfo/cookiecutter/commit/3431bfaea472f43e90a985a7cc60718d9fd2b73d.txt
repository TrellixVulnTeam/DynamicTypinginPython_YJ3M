commit 3431bfaea472f43e90a985a7cc60718d9fd2b73d
Author: Raphael Pierzina <raphael@hackebrot.de>
Date:   Mon Nov 17 08:18:25 2014 +0100

    Convert test_cookiecutter_local_with_input using monkeypatch

diff --git a/tests/test_cookiecutter_local_with_input.py b/tests/test_cookiecutter_local_with_input.py
new file mode 100644
index 0000000..66d5783
--- /dev/null
+++ b/tests/test_cookiecutter_local_with_input.py
@@ -0,0 +1,42 @@
+#!/usr/bin/env python
+# -*- coding: utf-8 -*-
+
+"""
+test_cookiecutter_local_no_input
+--------------------------------
+
+Tests formerly known from a unittest residing in test_main.py named
+TestCookiecutterLocalWithInput.test_cookiecutter_local_with_input
+"""
+
+import os
+import pytest
+
+from cookiecutter import main, utils
+
+
+@pytest.fixture(scope='function')
+def remove_additional_dirs(request):
+    """
+    Remove special directories which are created during the tests.
+    """
+    def fin_remove_additional_dirs():
+        if os.path.isdir('fake-project'):
+            utils.rmtree('fake-project')
+        if os.path.isdir('fake-project-input-extra'):
+            utils.rmtree('fake-project-input-extra')
+    request.addfinalizer(fin_remove_additional_dirs)
+
+
+@pytest.mark.usefixtures('clean_system', 'remove_additional_dirs')
+def test_cookiecutter_local_with_input(monkeypatch):
+    monkeypatch.setattr(
+        'cookiecutter.prompt.read_response',
+        lambda x=u'': u'\n'
+    )
+    main.cookiecutter('tests/fake-repo-pre/', no_input=False)
+    assert os.path.isdir('tests/fake-repo-pre/{{cookiecutter.repo_name}}')
+    assert not os.path.isdir('tests/fake-repo-pre/fake-project')
+    assert os.path.isdir('fake-project')
+    assert os.path.isfile('fake-project/README.rst')
+    assert not os.path.exists('fake-project/json/')
diff --git a/tests/test_main.py b/tests/test_main.py
index cc683ea..85d7fdb 100755
--- a/tests/test_main.py
+++ b/tests/test_main.py
@@ -73,15 +73,6 @@ class TestCookiecutterLocalNoInput(CookiecutterCleanSystemTestCase):
 
 class TestCookiecutterLocalWithInput(CookiecutterCleanSystemTestCase):
 
-    @patch('cookiecutter.prompt.read_response', lambda x=u'': u'\n')
-    def test_cookiecutter_local_with_input(self):
-        main.cookiecutter('tests/fake-repo-pre/', no_input=False)
-        self.assertTrue(os.path.isdir('tests/fake-repo-pre/{{cookiecutter.repo_name}}'))
-        self.assertFalse(os.path.isdir('tests/fake-repo-pre/fake-project'))
-        self.assertTrue(os.path.isdir('fake-project'))
-        self.assertTrue(os.path.isfile('fake-project/README.rst'))
-        self.assertFalse(os.path.exists('fake-project/json/'))
-
     @patch('cookiecutter.prompt.read_response', lambda x=u'': u'\n')
     def test_cookiecutter_input_extra_context(self):
         """ `Call cookiecutter()` with `no_input=False` and `extra_context` """
