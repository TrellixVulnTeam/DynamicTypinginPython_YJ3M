commit 2fa57fca6a5dfb4719ce1045b818a8d947afe692
Author: Raphael Pierzina <raphael@hackebrot.de>
Date:   Thu Nov 20 22:55:14 2014 +0100

    Convert test_cookiecutter_mercurial to pytest

diff --git a/tests/test_cookiecutter_repo_arg.py b/tests/test_cookiecutter_repo_arg.py
index a51f84f..f7d0599 100644
--- a/tests/test_cookiecutter_repo_arg.py
+++ b/tests/test_cookiecutter_repo_arg.py
@@ -7,6 +7,7 @@ test_cookiecutter_repo_arg
 
 Tests formerly known from a unittest residing in test_main.py named
 TestCookiecutterRepoArg.test_cookiecutter_git
+TestCookiecutterRepoArg.test_cookiecutter_mercurial
 """
 
 from __future__ import unicode_literals
@@ -48,3 +49,19 @@ def test_cookiecutter_git(monkeypatch):
     assert os.path.isdir('boilerplate')
     assert os.path.isfile('boilerplate/README.rst')
     assert os.path.exists('boilerplate/setup.py')
+
+
+@skipif_no_network
+@pytest.mark.usefixtures('clean_system', 'remove_additional_folders')
+def test_cookiecutter_mercurial(monkeypatch):
+    monkeypatch.setattr('cookiecutter.prompt.read_response', lambda x=u'': u'')
+
+    main.cookiecutter('https://bitbucket.org/pokoli/cookiecutter-trytonmodule')
+    clone_dir = os.path.join(
+        os.path.expanduser('~/.cookiecutters'),
+        'cookiecutter-trytonmodule'
+    )
+    assert os.path.exists(clone_dir)
+    assert os.path.isdir('module_name')
+    assert os.path.isfile('module_name/README')
+    assert os.path.exists('module_name/setup.py')
diff --git a/tests/test_main.py b/tests/test_main.py
index aefda8d..15cacdd 100755
--- a/tests/test_main.py
+++ b/tests/test_main.py
@@ -147,30 +147,5 @@ class TestAbbreviationExpansion(unittest.TestCase):
         )
 
 
-@unittest.skipIf(condition=no_network, reason='Needs a network connection to GitHub/Bitbucket.')
-class TestCookiecutterRepoArg(CookiecutterCleanSystemTestCase):
-
-    def tearDown(self):
-        if os.path.isdir('cookiecutter-pypackage'):
-            utils.rmtree('cookiecutter-pypackage')
-        if os.path.isdir('boilerplate'):
-            utils.rmtree('boilerplate')
-        if os.path.isdir('cookiecutter-trytonmodule'):
-            utils.rmtree('cookiecutter-trytonmodule')
-        if os.path.isdir('module_name'):
-            utils.rmtree('module_name')
-        super(TestCookiecutterRepoArg, self).tearDown()
-
-    @patch('cookiecutter.prompt.read_response', lambda x=u'': u'')
-    def test_cookiecutter_mercurial(self):
-        main.cookiecutter('https://bitbucket.org/pokoli/cookiecutter-trytonmodule')
-        logging.debug('Current dir is {0}'.format(os.getcwd()))
-        clone_dir = os.path.join(os.path.expanduser('~/.cookiecutters'), 'cookiecutter-trytonmodule')
-        self.assertTrue(os.path.exists(clone_dir))
-        self.assertTrue(os.path.isdir('module_name'))
-        self.assertTrue(os.path.isfile('module_name/README'))
-        self.assertTrue(os.path.exists('module_name/setup.py'))
-
-
 if __name__ == '__main__':
     unittest.main()
