commit d4a186100eadff83057ffd6f799ebcba77c9e99c
Author: Raphael Pierzina <raphael@hackebrot.de>
Date:   Sat Nov 15 16:15:54 2014 +0100

    Remove original test_examples and convert examples_repo_arg

diff --git a/tests/test_examples.py b/tests/test_examples.py
deleted file mode 100755
index 2dc1e66..0000000
--- a/tests/test_examples.py
+++ /dev/null
@@ -1,59 +0,0 @@
-#!/usr/bin/env python
-# -*- coding: utf-8 -*-
-
-"""
-test_examples
---------------
-
-Tests for the Cookiecutter example repos.
-"""
-
-from __future__ import unicode_literals
-import logging
-import os
-import subprocess
-
-from cookiecutter.compat import unittest
-from cookiecutter import config, utils
-from tests import CookiecutterCleanSystemTestCase
-
-try:
-    travis = os.environ[u'TRAVIS']
-except KeyError:
-    travis = False
-
-try:
-    no_network = os.environ[u'DISABLE_NETWORK_TESTS']
-except KeyError:
-    no_network = False
-
-logging.basicConfig(format='%(levelname)s: %(message)s', level=logging.DEBUG)
-
-
-@unittest.skipIf(condition=travis, reason='Works locally with tox but fails on Travis.')
-@unittest.skipIf(condition=no_network, reason='Needs a network connection to GitHub.')
-class TestExamplesRepoArg(CookiecutterCleanSystemTestCase):
-
-    def tearDown(self):
-        with utils.work_in(config.DEFAULT_CONFIG['cookiecutters_dir']):
-            if os.path.isdir('cookiecutter-pypackage'):
-                utils.rmtree('cookiecutter-pypackage')
-        if os.path.isdir('boilerplate'):
-            utils.rmtree('boilerplate')
-        super(TestExamplesRepoArg, self).tearDown()
-
-    def test_cookiecutter_pypackage_git(self):
-        proc = subprocess.Popen(
-            'cookiecutter https://github.com/audreyr/cookiecutter-pypackage.git',
-            stdin=subprocess.PIPE,
-            shell=True
-        )
-
-        # Just skip all the prompts
-        proc.communicate(input=b'\n\n\n\n\n\n\n\n\n\n\n\n')
-
-        self.assertTrue(os.path.isfile('boilerplate/README.rst'))
-
-
-if __name__ == '__main__':
-    unittest.main()
diff --git a/tests/test_examples_repo_arg.py b/tests/test_examples_repo_arg.py
new file mode 100644
index 0000000..e107b03
--- /dev/null
+++ b/tests/test_examples_repo_arg.py
@@ -0,0 +1,49 @@
+#!/usr/bin/env python
+# -*- coding: utf-8 -*-
+
+"""
+test_cookiecutters
+------------------
+
+Test formerly known from a unittest residing in test_generate.py named
+TestExamplesRepoArg.test_cookiecutter_pypackage_git
+"""
+
+from __future__ import unicode_literals
+import os
+import subprocess
+import pytest
+
+from cookiecutter import config, utils
+from tests.skipif_markers import skipif_travis, skipif_no_network
+
+
+@pytest.fixture(scope='function')
+def remove_additional_dirs(request):
+    """
+    Remove special directories which are creating during the tests.
+    """
+    def fin_remove_additional_dirs():
+        with utils.work_in(config.DEFAULT_CONFIG['cookiecutters_dir']):
+            if os.path.isdir('cookiecutter-pypackage'):
+                utils.rmtree('cookiecutter-pypackage')
+        if os.path.isdir('boilerplate'):
+            utils.rmtree('boilerplate')
+    request.addfinalizer(fin_remove_additional_dirs)
+
+
+@skipif_travis
+@skipif_no_network
+@pytest.mark.usefixtures('clean_system', 'remove_additional_dirs')
+def test_cookiecutter_pypackage_git():
+    proc = subprocess.Popen(
+        'cookiecutter https://github.com/audreyr/cookiecutter-pypackage.git',
+        stdin=subprocess.PIPE,
+        shell=True
+    )
+
+    # Just skip all the prompts
+    proc.communicate(input=b'\n\n\n\n\n\n\n\n\n\n\n\n')
+
+    assert os.path.isfile('boilerplate/README.rst')
+
