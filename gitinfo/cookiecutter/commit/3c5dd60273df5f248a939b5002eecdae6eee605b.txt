commit 3c5dd60273df5f248a939b5002eecdae6eee605b
Author: Javier SÃ¡nchez Portero <javiersanp@gmail.com>
Date:   Sat Apr 25 09:31:02 2020 +0100

    Fixed: Fail with gitolite repositories (#1144)
    
    * Fix fail with gitolite repositories
    
    * Remove duplicate tests #1144
    
    Co-authored-by: Andrey Shpak <ashpak@ashpak.ru>

diff --git a/cookiecutter/vcs.py b/cookiecutter/vcs.py
index ee4feea..417b4ea 100644
--- a/cookiecutter/vcs.py
+++ b/cookiecutter/vcs.py
@@ -70,6 +70,7 @@ def clone(repo_url, checkout=None, clone_to_dir='.', no_input=False):
     :param clone_to_dir: The directory to clone to.
                          Defaults to the current directory.
     :param no_input: Suppress all user prompts when calling via API.
+    :returns: str with path to the new directory of the repository.
     """
     # Ensure that clone_to_dir exists
     clone_to_dir = os.path.expanduser(clone_to_dir)
@@ -84,12 +85,13 @@ def clone(repo_url, checkout=None, clone_to_dir='.', no_input=False):
         raise VCSNotInstalled(msg)
 
     repo_url = repo_url.rstrip('/')
-    tail = os.path.split(repo_url)[1]
+    repo_name = os.path.split(repo_url)[1]
     if repo_type == 'git':
-        repo_dir = os.path.normpath(os.path.join(clone_to_dir, tail.rsplit('.git')[0]))
+        repo_name = repo_name.split(':')[-1].rsplit('.git')[0]
+        repo_dir = os.path.normpath(os.path.join(clone_to_dir, repo_name))
     elif repo_type == 'hg':
-        repo_dir = os.path.normpath(os.path.join(clone_to_dir, tail))
-    logger.debug('repo_dir is %s', repo_dir)
+        repo_dir = os.path.normpath(os.path.join(clone_to_dir, repo_name))
+    logger.debug('repo_dir is {0}'.format(repo_dir))
 
     if os.path.isdir(repo_dir):
         clone = prompt_and_delete(repo_dir, no_input=no_input)
diff --git a/tests/vcs/test_clone.py b/tests/vcs/test_clone.py
index 10c625d..41a48a4 100644
--- a/tests/vcs/test_clone.py
+++ b/tests/vcs/test_clone.py
@@ -74,6 +74,9 @@ def test_clone_should_abort_if_user_does_not_want_to_reclone(mocker, tmpdir):
     [
         ('git', 'https://github.com/hello/world.git', 'world'),
         ('hg', 'https://bitbucket.org/foo/bar', 'bar'),
+        ('git', 'git@host:gitoliterepo', 'gitoliterepo'),
+        ('git', 'git@gitlab.com:cookiecutter/cookiecutter.git', 'cookiecutter'),
+        ('git', 'git@github.com:cookiecutter/cookiecutter.git', 'cookiecutter'),
     ],
 )
 def test_clone_should_invoke_vcs_command(
