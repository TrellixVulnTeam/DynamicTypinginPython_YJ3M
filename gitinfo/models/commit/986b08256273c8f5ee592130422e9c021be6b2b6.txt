commit 986b08256273c8f5ee592130422e9c021be6b2b6
Author: Hongkun Yu <hongkuny@google.com>
Date:   Tue May 26 09:26:41 2020 -0700

    Add init_checkpoint for nhnet benchmark.
    
    PiperOrigin-RevId: 313205490

diff --git a/official/benchmark/nhnet_benchmark.py b/official/benchmark/nhnet_benchmark.py
index 1bc2d255..d0b6c6ed 100644
--- a/official/benchmark/nhnet_benchmark.py
+++ b/official/benchmark/nhnet_benchmark.py
@@ -32,6 +32,7 @@ from official.utils.flags import core as flags_core
 MIN_LOSS = 0.40
 MAX_LOSS = 0.55
 NHNET_DATA = 'gs://tf-perfzero-data/nhnet/v1/processed/train.tfrecord*'
+PRETRAINED_CHECKPOINT_PATH = 'gs://cloud-tpu-checkpoints/bert/keras_bert/uncased_L-24_H-1024_A-16/bert_model.ckpt'
 
 FLAGS = flags.FLAGS
 
@@ -126,6 +127,7 @@ class NHNetAccuracyBenchmark(NHNetBenchmark):
     FLAGS.train_steps = 50000
     FLAGS.checkpoint_interval = FLAGS.train_steps
     FLAGS.distribution_strategy = 'tpu'
+    FLAGS.init_checkpoint = PRETRAINED_CHECKPOINT_PATH
     FLAGS.model_dir = self._get_model_dir(
         'benchmark_accuracy_4x4_tpu_bf32_50k_steps')
     self._run_and_report_benchmark()
