commit 68d983b9bc91d9db9a2b7cbe1b1a69d44921e210
Author: vivek rathod <rathodv@google.com>
Date:   Fri Jun 26 17:29:23 2020 -0700

    Merged commit includes the following changes: (#8742)
    
    318569851  by jonathanhuang:
    
        Fix for fine-tuning from classification checkpoints in the v2 binary.
    
    --
    
    PiperOrigin-RevId: 318569851

diff --git a/research/object_detection/meta_architectures/faster_rcnn_meta_arch.py b/research/object_detection/meta_architectures/faster_rcnn_meta_arch.py
index 8672f981..5c89cf8f 100644
--- a/research/object_detection/meta_architectures/faster_rcnn_meta_arch.py
+++ b/research/object_detection/meta_architectures/faster_rcnn_meta_arch.py
@@ -2801,7 +2801,10 @@ class FasterRCNNMetaArch(model.DetectionModel):
       A dict mapping keys to Trackable objects (tf.Module or Checkpoint).
     """
     if fine_tune_checkpoint_type == 'classification':
-      return {'feature_extractor': self.classification_backbone}
+      return {
+          'feature_extractor':
+              self._feature_extractor.classification_backbone
+      }
     elif fine_tune_checkpoint_type == 'detection':
       fake_model = tf.train.Checkpoint(
           _feature_extractor_for_box_classifier_features=
diff --git a/research/object_detection/meta_architectures/ssd_meta_arch.py b/research/object_detection/meta_architectures/ssd_meta_arch.py
index 6105aa7f..d5db202a 100644
--- a/research/object_detection/meta_architectures/ssd_meta_arch.py
+++ b/research/object_detection/meta_architectures/ssd_meta_arch.py
@@ -1320,7 +1320,10 @@ class SSDMetaArch(model.DetectionModel):
       A dict mapping keys to Trackable objects (tf.Module or Checkpoint).
     """
     if fine_tune_checkpoint_type == 'classification':
-      return {'feature_extractor': self.classification_backbone}
+      return {
+          'feature_extractor':
+              self._feature_extractor.classification_backbone
+      }
     elif fine_tune_checkpoint_type == 'detection':
       fake_model = tf.train.Checkpoint(
           _feature_extractor=self._feature_extractor)
