commit 8a1dbbadee7a84a54af45cc0dc3da4f6e730f3d7
Author: Chen Chen <chendouble@google.com>
Date:   Wed Jun 10 14:23:14 2020 -0700

    Fix get_config() of MaskedSoftmax.
    
    PiperOrigin-RevId: 315767729

diff --git a/official/nlp/modeling/layers/masked_softmax.py b/official/nlp/modeling/layers/masked_softmax.py
index 53a24b6d..42a9e97a 100644
--- a/official/nlp/modeling/layers/masked_softmax.py
+++ b/official/nlp/modeling/layers/masked_softmax.py
@@ -64,6 +64,9 @@ class MaskedSoftmax(tf.keras.layers.Layer):
           scores, axis=self._normalization_axes, keepdims=True))
 
   def get_config(self):
-    config = {'mask_expansion_axes': self._mask_expansion_axes}
+    config = {
+        'mask_expansion_axes': self._mask_expansion_axes,
+        'normalization_axes': self._normalization_axes
+    }
     base_config = super(MaskedSoftmax, self).get_config()
     return dict(list(base_config.items()) + list(config.items()))
diff --git a/official/nlp/modeling/layers/masked_softmax_test.py b/official/nlp/modeling/layers/masked_softmax_test.py
index 56e48142..befe0f78 100644
--- a/official/nlp/modeling/layers/masked_softmax_test.py
+++ b/official/nlp/modeling/layers/masked_softmax_test.py
@@ -105,6 +105,15 @@ class MaskedSoftmaxLayerTest(keras_parameterized.TestCase):
     is_zeros = np.greater(output_data, 0)
     self.assertAllEqual(expected_zeros, is_zeros)
 
+  def test_serialize_deserialize(self):
+    test_layer = masked_softmax.MaskedSoftmax(
+        mask_expansion_axes=[1], normalization_axes=[6, 7])
+    new_layer = masked_softmax.MaskedSoftmax.from_config(
+        test_layer.get_config())
+
+    # If the serialization was successful, the new config should match the old.
+    self.assertAllEqual(test_layer.get_config(), new_layer.get_config())
+
 
 if __name__ == '__main__':
   tf.test.main()
