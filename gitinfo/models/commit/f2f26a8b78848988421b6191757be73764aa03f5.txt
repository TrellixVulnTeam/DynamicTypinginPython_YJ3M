commit f2f26a8b78848988421b6191757be73764aa03f5
Author: Chen Chen <chendouble@google.com>
Date:   Fri May 29 10:58:57 2020 -0700

    Internal change
    
    PiperOrigin-RevId: 313812017

diff --git a/official/nlp/modeling/layers/transformer_scaffold.py b/official/nlp/modeling/layers/transformer_scaffold.py
index db7df1f3..f26b9161 100644
--- a/official/nlp/modeling/layers/transformer_scaffold.py
+++ b/official/nlp/modeling/layers/transformer_scaffold.py
@@ -176,16 +176,16 @@ class TransformerScaffold(tf.keras.layers.Layer):
 
     if self._feedforward_block is None:
       self._intermediate_dense = tf.keras.layers.experimental.EinsumDense(
-          "...x,xy->...y",
-          output_shape=self._intermediate_size,
-          bias_axes="y",
+          "abc,cd->abd",
+          output_shape=(None, self._intermediate_size),
+          bias_axes="d",
           activation=self._intermediate_activation,
           name="intermediate",
           **common_kwargs)
       self._output_dense = tf.keras.layers.experimental.EinsumDense(
-          "...x,xy->...y",
-          output_shape=hidden_size,
-          bias_axes="y",
+          "abc,cd->abd",
+          output_shape=(None, hidden_size),
+          bias_axes="d",
           name="output",
           **common_kwargs)
 
