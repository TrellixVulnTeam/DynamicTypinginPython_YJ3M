commit 2151c4471a741b54f3a67ec5ffcadbc72af40059
Author: Zhichao Lu <lzc@google.com>
Date:   Wed Apr 11 11:56:16 2018 -0700

    Enforcing that all eval metric ops have valid python strings.
    
    PiperOrigin-RevId: 192485456

diff --git a/research/object_detection/model_lib.py b/research/object_detection/model_lib.py
index a02e53e4..c5785769 100644
--- a/research/object_detection/model_lib.py
+++ b/research/object_detection/model_lib.py
@@ -365,10 +365,11 @@ def create_model_fn(detection_model_fn, configs, hparams, use_tpu=False):
         for loss_key, loss_tensor in iter(losses_dict.items()):
           eval_metric_ops[loss_key] = tf.metrics.mean(loss_tensor)
         for var in optimizer_summary_vars:
-          eval_metric_ops[str(var.op.name)] = (var, tf.no_op())
+          eval_metric_ops[var.op.name] = (var, tf.no_op())
         if img_summary is not None:
           eval_metric_ops['Detections_Left_Groundtruth_Right'] = (
               img_summary, tf.no_op())
+        eval_metric_ops = {str(k): v for k, v in eval_metric_ops.iteritems()}
 
     if use_tpu:
       return tf.contrib.tpu.TPUEstimatorSpec(
