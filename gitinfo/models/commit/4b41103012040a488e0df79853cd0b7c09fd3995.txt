commit 4b41103012040a488e0df79853cd0b7c09fd3995
Author: Manoj Plakal <30733558+plakal@users.noreply.github.com>
Date:   Tue Feb 13 15:56:43 2018 -0500

    Add sanity checks to mel computation.
    
    Clamp the requested frequency range to [0, Nyquist].

diff --git a/research/audioset/mel_features.py b/research/audioset/mel_features.py
index 13b14f75..672e216f 100644
--- a/research/audioset/mel_features.py
+++ b/research/audioset/mel_features.py
@@ -153,9 +153,15 @@ def spectrogram_to_mel_matrix(num_mel_bins=20,
     ValueError: if frequency edges are incorrectly ordered.
   """
   nyquist_hertz = audio_sample_rate / 2.
+  if upper_edge_hertz > nyquist_hertz:
+    raise ValueError("upper_edge_hertz %.1f is greater than Nyquist %.1f" %
+                     (upper_edge_hertz, nyquist_hertz))
   if lower_edge_hertz >= upper_edge_hertz:
     raise ValueError("lower_edge_hertz %.1f >= upper_edge_hertz %.1f" %
                      (lower_edge_hertz, upper_edge_hertz))
+  if upper_edge_hertz > nyquist_hertz:
+    raise ValueError("upper_edge_hertz %.1f is greater than Nyquist %.1f" %
+                     (upper_edge_hertz, nyquist_hertz))  
   spectrogram_bins_hertz = np.linspace(0.0, nyquist_hertz, num_spectrogram_bins)
   spectrogram_bins_mel = hertz_to_mel(spectrogram_bins_hertz)
   # The i'th mel band (starting from i=1) has center frequency
