commit 0fb0fa84480fcd9ce2ecdacb9a1fcc1217ab8693
Author: Tobias Morville <4254061+TMorville@users.noreply.github.com>
Date:   Sat Apr 25 05:31:54 2020 +0200

    Added .values to series object to prevent crash when running data_sampler. (#7951)
    
    Co-authored-by: Tobias Morville <tmo@Tobiass-MacBook-Pro.local>

diff --git a/research/deep_contextual_bandits/bandits/data/data_sampler.py b/research/deep_contextual_bandits/bandits/data/data_sampler.py
index 4d3595f2..55d1bae3 100644
--- a/research/deep_contextual_bandits/bandits/data/data_sampler.py
+++ b/research/deep_contextual_bandits/bandits/data/data_sampler.py
@@ -71,7 +71,7 @@ def sample_mushroom_data(file_name,
       size=num_contexts)
   eat_reward = r_eat_safe * df.iloc[ind, 0]
   eat_reward += np.multiply(random_poison, df.iloc[ind, 1])
-  eat_reward = eat_reward.reshape((num_contexts, 1))
+  eat_reward = eat_reward.values.reshape((num_contexts, 1))
 
   # compute optimal expected reward and optimal actions
   exp_eat_poison_reward = r_eat_poison_bad * prob_poison_bad
