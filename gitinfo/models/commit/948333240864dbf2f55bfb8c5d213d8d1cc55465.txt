commit 948333240864dbf2f55bfb8c5d213d8d1cc55465
Author: Yeqing Li <yeqing@google.com>
Date:   Tue Nov 5 19:02:48 2019 -0800

    Internal change
    
    PiperOrigin-RevId: 278756245

diff --git a/official/benchmark/retinanet_benchmark.py b/official/benchmark/retinanet_benchmark.py
index 1d4bc8bf..38d3c7c6 100644
--- a/official/benchmark/retinanet_benchmark.py
+++ b/official/benchmark/retinanet_benchmark.py
@@ -134,7 +134,10 @@ class RetinanetBenchmarkBase(DetectionBenchmarkBase):
 
   def _run_detection_main(self):
     """Starts detection job."""
-    return detection.run(callbacks=[self.timer_callback])
+    if self.timer_callback:
+      return detection.run(callbacks=[self.timer_callback])
+    else:
+      return detection.run()
 
 
 class RetinanetAccuracy(RetinanetBenchmarkBase):
@@ -180,6 +183,10 @@ class RetinanetAccuracy(RetinanetBenchmarkBase):
             'iterations_per_loop': 100,
             'total_steps': 22500,
             'train_file_pattern': self.train_data_path,
+            'checkpoint': {
+                'path': self.resnet_checkpoint_path,
+                'prefix': 'resnet50/'
+            },
         },
         'eval': {
             'batch_size': 8,
diff --git a/official/modeling/training/distributed_executor.py b/official/modeling/training/distributed_executor.py
index 4b15c691..8fb78413 100644
--- a/official/modeling/training/distributed_executor.py
+++ b/official/modeling/training/distributed_executor.py
@@ -426,14 +426,16 @@ class DistributedExecutor(object):
       if not custom_callbacks:
         return
       for callback in custom_callbacks:
-        callback.on_batch_begin(batch)
+        if callback:
+          callback.on_batch_begin(batch)
 
     def _run_callbacks_on_batch_end(batch):
       """Runs custom callbacks at the end of every step."""
       if not custom_callbacks:
         return
       for callback in custom_callbacks:
-        callback.on_batch_end(batch)
+        if callback:
+          callback.on_batch_end(batch)
 
     if save_config:
       self._save_config(model_dir)
