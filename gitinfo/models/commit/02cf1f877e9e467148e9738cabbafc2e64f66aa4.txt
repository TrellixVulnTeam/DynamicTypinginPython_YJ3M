commit 02cf1f877e9e467148e9738cabbafc2e64f66aa4
Author: Zongwei Zhou <zongweiz@google.com>
Date:   Tue Apr 14 12:47:59 2020 -0700

    Fix errors in classifier trainer when there is no distribution strategy
    
    PiperOrigin-RevId: 306495321

diff --git a/official/vision/image_classification/classifier_trainer.py b/official/vision/image_classification/classifier_trainer.py
index 436d8bb0..c3805a75 100644
--- a/official/vision/image_classification/classifier_trainer.py
+++ b/official/vision/image_classification/classifier_trainer.py
@@ -109,7 +109,8 @@ def _get_dataset_builders(params: base_configs.ExperimentConfig,
     logging.warning('label_smoothing not applied, so datasets will not be one '
                     'hot encoded.')
 
-  num_devices = strategy.num_replicas_in_sync
+  num_devices = strategy.num_replicas_in_sync if strategy else 1
+
   image_size = get_image_size_from_model(params)
 
   dataset_configs = [
@@ -309,7 +310,8 @@ def train_and_eval(
 
   strategy_scope = distribution_utils.get_strategy_scope(strategy)
 
-  logging.info('Detected %d devices.', strategy.num_replicas_in_sync)
+  logging.info('Detected %d devices.',
+               strategy.num_replicas_in_sync if strategy else 1)
 
   label_smoothing = params.model.loss.label_smoothing
   one_hot = label_smoothing and label_smoothing > 0
