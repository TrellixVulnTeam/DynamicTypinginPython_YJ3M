commit a2e95a60dc10751706d84ea2656b9f72b7b18110
Author: A. Unique TensorFlower <gardener@tensorflow.org>
Date:   Fri Feb 21 11:01:36 2020 -0800

    Internal change
    
    PiperOrigin-RevId: 296469938

diff --git a/official/utils/misc/keras_utils.py b/official/utils/misc/keras_utils.py
index 21342948..90e366b0 100644
--- a/official/utils/misc/keras_utils.py
+++ b/official/utils/misc/keras_utils.py
@@ -26,7 +26,7 @@ from absl import logging
 import tensorflow as tf
 from tensorflow.core.protobuf import rewriter_config_pb2
 from tensorflow.python import tf2
-from tensorflow.python.profiler import profiler_v2 as profiler
+from tensorflow.python.eager import profiler
 
 
 class BatchTimestamp(object):
@@ -145,15 +145,17 @@ class ProfilerCallback(tf.keras.callbacks.Callback):
   def on_batch_begin(self, batch, logs=None):
     if batch == self.start_step_in_epoch and self.should_start:
       self.should_start = False
-      profiler.start(self.log_dir)
+      profiler.start()
       logging.info('Profiler started at Step %s', self.start_step)
 
   def on_batch_end(self, batch, logs=None):
     if batch == self.stop_step_in_epoch and self.should_stop:
       self.should_stop = False
-      profiler.stop()
-      logging.info('Profiler saved profiles for steps between %s and %s to %s',
-                   self.start_step, self.stop_step, self.log_dir)
+      results = profiler.stop()
+      profiler.save(self.log_dir, results)
+      logging.info(
+          'Profiler saved profiles for steps between %s and %s to %s',
+          self.start_step, self.stop_step, self.log_dir)
 
 
 def set_session_config(enable_eager=False,
