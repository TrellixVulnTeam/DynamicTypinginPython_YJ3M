commit 30cf3752911b929da70ddeb37b66fc047eb47605
Author: Joel Shor <shor.joel@gmail.com>
Date:   Sat May 5 16:44:23 2018 +0300

    Made `generate_cifar10_tfrecords.py` python3 compatible.

diff --git a/tutorials/image/cifar10_estimator/generate_cifar10_tfrecords.py b/tutorials/image/cifar10_estimator/generate_cifar10_tfrecords.py
index 409cee4e..d1a599c3 100644
--- a/tutorials/image/cifar10_estimator/generate_cifar10_tfrecords.py
+++ b/tutorials/image/cifar10_estimator/generate_cifar10_tfrecords.py
@@ -25,6 +25,7 @@ from __future__ import print_function
 
 import argparse
 import os
+import sys
 
 import tarfile
 from six.moves import cPickle as pickle
@@ -63,7 +64,10 @@ def _get_file_names():
 
 def read_pickle_from_file(filename):
   with tf.gfile.Open(filename, 'rb') as f:
-    data_dict = pickle.load(f)
+    if sys.version_info >= (3, 0):
+      data_dict = pickle.load(f, encoding='bytes')
+    else:
+      data_dict = pickle.load(f)
   return data_dict
 
 
@@ -73,8 +77,8 @@ def convert_to_tfrecord(input_files, output_file):
   with tf.python_io.TFRecordWriter(output_file) as record_writer:
     for input_file in input_files:
       data_dict = read_pickle_from_file(input_file)
-      data = data_dict['data']
-      labels = data_dict['labels']
+      data = data_dict[b'data']
+      labels = data_dict[b'labels']
       num_entries_in_batch = len(labels)
       for i in range(num_entries_in_batch):
         example = tf.train.Example(features=tf.train.Features(
