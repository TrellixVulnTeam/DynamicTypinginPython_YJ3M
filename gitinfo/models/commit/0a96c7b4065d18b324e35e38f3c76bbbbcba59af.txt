commit 0a96c7b4065d18b324e35e38f3c76bbbbcba59af
Author: Reed <reedwm@google.com>
Date:   Thu May 2 19:03:28 2019 -0700

    Add graph rewrite convergence benchmark (#6712)

diff --git a/official/resnet/estimator_benchmark.py b/official/resnet/estimator_benchmark.py
index ce24edc7..99711a5e 100644
--- a/official/resnet/estimator_benchmark.py
+++ b/official/resnet/estimator_benchmark.py
@@ -160,6 +160,21 @@ class Resnet50EstimatorAccuracy(EstimatorBenchmark):
     FLAGS.hooks = ['ExamplesPerSecondHook']
     self._run_and_report_benchmark()
 
+  def benchmark_graph_fp16_graph_rewrite_8_gpu(self):
+    """Test FP16 graph rewrite 8 GPUs graph mode."""
+    self._setup()
+    FLAGS.num_gpus = 8
+    FLAGS.data_dir = self.data_dir
+    FLAGS.batch_size = 256 * 8
+    FLAGS.train_epochs = 90
+    FLAGS.epochs_between_evals = 10
+    FLAGS.model_dir = self._get_model_dir(
+        'benchmark_graph_fp16_graph_rewrite_8_gpu')
+    FLAGS.dtype = 'fp16'
+    FLAGS.fp16_implementation = 'graph_rewrite'
+    FLAGS.hooks = ['ExamplesPerSecondHook']
+    self._run_and_report_benchmark()
+
   def _run_and_report_benchmark(self):
     start_time_sec = time.time()
     stats = imagenet_main.run_imagenet(flags.FLAGS)
