commit 18e064386b3a5a6ba86b12ba62487b4c9a9ceb87
Author: Karmel Allison <karmel@arcaio.com>
Date:   Mon Apr 9 10:09:43 2018 -0700

    Adding cast to fp32 for TensorRT no image case (#3917)
    
    * Adding cast to fp32
    
    * Adding myself to OWNERS

diff --git a/CODEOWNERS b/CODEOWNERS
index b94677c8..b43320c2 100644
--- a/CODEOWNERS
+++ b/CODEOWNERS
@@ -39,6 +39,7 @@
 /research/swivel/ @waterson
 /research/syntaxnet/ @calberti @andorardo @bogatyy @markomernick
 /research/tcn/ @coreylynch @sermanet
+/research/tensorrt/ @karmel
 /research/textsum/ @panyx0718 @peterjliu
 /research/transformer/ @daviddao
 /research/video_prediction/ @cbfinn
diff --git a/research/tensorrt/tensorrt.py b/research/tensorrt/tensorrt.py
index 459b29f4..7db2f951 100644
--- a/research/tensorrt/tensorrt.py
+++ b/research/tensorrt/tensorrt.py
@@ -118,7 +118,8 @@ def batch_from_random(batch_size, output_height=224, output_width=224,
       [batch_size, output_height, output_width, num_channels]
   """
   shape = [batch_size, output_height, output_width, num_channels]
-  return np.random.random_sample(shape)
+  # Make sure we return float32, as float64 will not get cast automatically.
+  return np.random.random_sample(shape).astype(np.float32)
 
 
 ################################################################################
