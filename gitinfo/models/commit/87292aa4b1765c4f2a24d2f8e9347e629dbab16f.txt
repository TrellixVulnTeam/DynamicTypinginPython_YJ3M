commit 87292aa4b1765c4f2a24d2f8e9347e629dbab16f
Author: Chen Chen <chendouble@google.com>
Date:   Wed Jun 3 23:19:16 2020 -0700

    Internal Change
    
    PiperOrigin-RevId: 314674292

diff --git a/official/recommendation/ncf_keras_main.py b/official/recommendation/ncf_keras_main.py
index 99ad1afa..a4f2376b 100644
--- a/official/recommendation/ncf_keras_main.py
+++ b/official/recommendation/ncf_keras_main.py
@@ -191,7 +191,8 @@ def _get_keras_model(params):
   # Custom training loop calculates loss and metric as a part of
   # training/evaluation step function.
   if not params["keras_use_ctl"]:
-    softmax_logits = MetricLayer(params)([softmax_logits, dup_mask_input])
+    softmax_logits = MetricLayer(
+        params["match_mlperf"])([softmax_logits, dup_mask_input])
     # TODO(b/134744680): Use model.add_loss() instead once the API is well
     # supported.
     softmax_logits = LossLayer(batch_size)(
