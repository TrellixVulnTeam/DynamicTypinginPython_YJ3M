commit e61c0ebc0c54c9e5768cd59752b330c591cc6d7d
Author: Sergey Mironov <grrwlf@gmail.com>
Date:   Sun Apr 26 01:23:10 2020 +0300

    Handle non-login shell case in stdout utility

diff --git a/official/utils/flags/_conventions.py b/official/utils/flags/_conventions.py
index 81ad21b0..331ae569 100644
--- a/official/utils/flags/_conventions.py
+++ b/official/utils/flags/_conventions.py
@@ -40,7 +40,7 @@ def _stdout_utf8():
     codecs.lookup("utf-8")
   except LookupError:
     return False
-  return sys.stdout.encoding == "UTF-8"
+  return getattr(sys.stdout, 'encoding', '') == "UTF-8"
 
 
 if _stdout_utf8():
