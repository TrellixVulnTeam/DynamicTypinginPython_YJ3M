commit 8fadb6ed5a409877ae5f5c83a48d86efd28866cd
Author: Andy Craze <accraze@gmail.com>
Date:   Fri Apr 24 12:12:03 2020 -0700

    Update VariationalAutoencoder.py (#5049)
    
    Add axis=1 for to reconstruction error calculation. This will avoid taking the sum of cost so that the training objective will no longer be  batch-size dependent.
    
    Fixes #2243

diff --git a/research/autoencoder/autoencoder_models/VariationalAutoencoder.py b/research/autoencoder/autoencoder_models/VariationalAutoencoder.py
index 8767891a..3c2556ab 100644
--- a/research/autoencoder/autoencoder_models/VariationalAutoencoder.py
+++ b/research/autoencoder/autoencoder_models/VariationalAutoencoder.py
@@ -21,7 +21,7 @@ class VariationalAutoencoder(object):
         self.reconstruction = tf.add(tf.matmul(self.z, self.weights['w2']), self.weights['b2'])
 
         # cost
-        reconstr_loss = 0.5 * tf.reduce_sum(tf.pow(tf.subtract(self.reconstruction, self.x), 2.0))
+        reconstr_loss = 0.5 * tf.reduce_sum(tf.pow(tf.subtract(self.reconstruction, self.x), 2.0), 1)
         latent_loss = -0.5 * tf.reduce_sum(1 + self.z_log_sigma_sq
                                            - tf.square(self.z_mean)
                                            - tf.exp(self.z_log_sigma_sq), 1)
