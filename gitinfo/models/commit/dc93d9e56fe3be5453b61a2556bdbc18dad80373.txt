commit dc93d9e56fe3be5453b61a2556bdbc18dad80373
Author: A. Unique TensorFlower <gardener@tensorflow.org>
Date:   Tue Oct 8 11:08:33 2019 -0700

    Internal change
    
    PiperOrigin-RevId: 273562498

diff --git a/official/vision/image_classification/resnet_imagenet_main.py b/official/vision/image_classification/resnet_imagenet_main.py
index 943ff2f0..1512c4ff 100644
--- a/official/vision/image_classification/resnet_imagenet_main.py
+++ b/official/vision/image_classification/resnet_imagenet_main.py
@@ -232,9 +232,12 @@ def run(flags_obj):
                       validation_freq=flags_obj.epochs_between_evals,
                       verbose=2)
   if flags_obj.enable_checkpoint_and_export:
-    # Keras model.save assumes a float32 input designature.
-    export_path = os.path.join(flags_obj.model_dir, 'saved_model')
-    model.save(export_path, include_optimizer=False)
+    if dtype == tf.bfloat16:
+      logging.warning("Keras model.save does not support bfloat16 dtype.")
+    else:
+      # Keras model.save assumes a float32 input designature.
+      export_path = os.path.join(flags_obj.model_dir, 'saved_model')
+      model.save(export_path, include_optimizer=False)
 
   eval_output = None
   if not flags_obj.skip_eval:
