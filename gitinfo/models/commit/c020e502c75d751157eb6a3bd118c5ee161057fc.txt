commit c020e502c75d751157eb6a3bd118c5ee161057fc
Author: Qianli Scott Zhu <scottzhu@google.com>
Date:   Fri Jul 13 12:14:59 2018 -0700

    Add shorter timeout for GCP util. (#4762)
    
    * Add shorter timeout for GCP util.
    
    * Add comment for change reason and unit for timeout.

diff --git a/official/utils/logs/cloud_lib.py b/official/utils/logs/cloud_lib.py
index 0f42dbe2..a2d9bd3d 100644
--- a/official/utils/logs/cloud_lib.py
+++ b/official/utils/logs/cloud_lib.py
@@ -25,7 +25,10 @@ GCP_METADATA_HEADER = {"Metadata-Flavor": "Google"}
 def on_gcp():
   """Detect whether the current running environment is on GCP."""
   try:
-    response = requests.get(GCP_METADATA_URL, headers=GCP_METADATA_HEADER)
+    # Timeout in 5 seconds, in case the test environment has connectivity issue.
+    # There is not default timeout, which means it might block forever.
+    response = requests.get(
+        GCP_METADATA_URL, headers=GCP_METADATA_HEADER, timeout=5)
     return response.status_code == 200
   except requests.exceptions.RequestException:
     return False
