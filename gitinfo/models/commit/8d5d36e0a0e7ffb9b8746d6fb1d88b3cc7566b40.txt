commit 8d5d36e0a0e7ffb9b8746d6fb1d88b3cc7566b40
Author: Haoyu Zhang <haoyuzhang@google.com>
Date:   Fri Mar 22 16:06:56 2019 -0700

    Disable Tensorboard callback by default (#6424)

diff --git a/official/resnet/keras/keras_cifar_main.py b/official/resnet/keras/keras_cifar_main.py
index fa64e63a..216d6710 100644
--- a/official/resnet/keras/keras_cifar_main.py
+++ b/official/resnet/keras/keras_cifar_main.py
@@ -180,14 +180,14 @@ def run(flags_obj):
     num_eval_steps = None
     validation_data = None
 
+  callbacks = [time_callback, lr_callback]
+  if flags_obj.enable_tensorboard:
+    callbacks.append(tensorboard_callback)
+
   history = model.fit(train_input_dataset,
                       epochs=train_epochs,
                       steps_per_epoch=train_steps,
-                      callbacks=[
-                          time_callback,
-                          lr_callback,
-                          tensorboard_callback
-                      ],
+                      callbacks=callbacks,
                       validation_steps=num_eval_steps,
                       validation_data=validation_data,
                       validation_freq=flags_obj.epochs_between_evals,
diff --git a/official/resnet/keras/keras_common.py b/official/resnet/keras/keras_common.py
index b1a6b541..6b88eb90 100644
--- a/official/resnet/keras/keras_common.py
+++ b/official/resnet/keras/keras_common.py
@@ -257,6 +257,9 @@ def define_keras_flags():
       name='enable_xla', default=False,
       help='Whether to enable XLA auto jit compilation. This is still an '
       'experimental feature, and is not yet effective with TF 2.0.')
+  flags.DEFINE_boolean(
+      name='enable_tensorboard', default=False,
+      help='Whether to enable Tensorboard callback.')
   flags.DEFINE_integer(
       name='train_steps', default=None,
       help='The number of steps to run for training. If it is larger than '
diff --git a/official/resnet/keras/keras_imagenet_main.py b/official/resnet/keras/keras_imagenet_main.py
index 2f1fe080..27068cb6 100644
--- a/official/resnet/keras/keras_imagenet_main.py
+++ b/official/resnet/keras/keras_imagenet_main.py
@@ -193,14 +193,14 @@ def run(flags_obj):
     num_eval_steps = None
     validation_data = None
 
+  callbacks = [time_callback, lr_callback]
+  if flags_obj.enable_tensorboard:
+    callbacks.append(tensorboard_callback)
+
   history = model.fit(train_input_dataset,
                       epochs=train_epochs,
                       steps_per_epoch=train_steps,
-                      callbacks=[
-                          time_callback,
-                          lr_callback,
-                          tensorboard_callback
-                      ],
+                      callbacks=callbacks,
                       validation_steps=num_eval_steps,
                       validation_data=validation_data,
                       validation_freq=flags_obj.epochs_between_evals,
