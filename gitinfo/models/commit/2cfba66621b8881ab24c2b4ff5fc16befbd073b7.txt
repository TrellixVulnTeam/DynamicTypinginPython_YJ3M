commit 2cfba66621b8881ab24c2b4ff5fc16befbd073b7
Author: Asim Shankar <ashankar@google.com>
Date:   Thu Jan 18 01:28:10 2018 -0800

    [mnist]: TPU tweaks

diff --git a/official/mnist/dataset.py b/official/mnist/dataset.py
index 9eac0b11..32a0392d 100644
--- a/official/mnist/dataset.py
+++ b/official/mnist/dataset.py
@@ -59,11 +59,11 @@ def check_labels_file_header(filename):
 
 def download(directory, filename):
   """Download (and unzip) a file from the MNIST dataset, if it doesn't already exist."""
-  if not tf.gfile.Exists(directory):
-    tf.gfile.MakeDirs(directory)
   filepath = os.path.join(directory, filename)
   if tf.gfile.Exists(filepath):
     return filepath
+  if not tf.gfile.Exists(directory):
+    tf.gfile.MakeDirs(directory)
   # CVDF mirror of http://yann.lecun.com/exdb/mnist/
   url = 'https://storage.googleapis.com/cvdf-datasets/mnist/' + filename + '.gz'
   zipped_filepath = filepath + '.gz'
diff --git a/official/mnist/mnist_tpu.py b/official/mnist/mnist_tpu.py
index 89e3997d..c18b1ef0 100644
--- a/official/mnist/mnist_tpu.py
+++ b/official/mnist/mnist_tpu.py
@@ -133,7 +133,8 @@ def main(argv):
   # Note that the number of examples used during evaluation is
   # --eval_steps * --batch_size.
   # So if you change --batch_size then change --eval_steps too.
-  estimator.evaluate(input_fn=eval_input_fn, steps=FLAGS.eval_steps)
+  if FLAGS.eval_steps:
+    estimator.evaluate(input_fn=eval_input_fn, steps=FLAGS.eval_steps)
 
 
 if __name__ == "__main__":
