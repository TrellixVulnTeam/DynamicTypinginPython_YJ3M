commit edcb214683344247a6ddd97ad0624546d512c3f2
Author: A. Unique TensorFlower <gardener@tensorflow.org>
Date:   Fri Apr 3 09:41:40 2020 -0700

    Internal changes.
    
    PiperOrigin-RevId: 304633832

diff --git a/official/vision/detection/dataloader/input_reader.py b/official/vision/detection/dataloader/input_reader.py
index 475b53cf..dd24b7e6 100644
--- a/official/vision/detection/dataloader/input_reader.py
+++ b/official/vision/detection/dataloader/input_reader.py
@@ -85,13 +85,14 @@ class InputFn(object):
 
     if self._input_sharding and ctx and ctx.num_input_pipelines > 1:
       dataset = dataset.shard(ctx.num_input_pipelines, ctx.input_pipeline_id)
+    dataset = dataset.cache()
+
     if self._is_training:
       dataset = dataset.repeat()
 
     dataset = dataset.interleave(
         map_func=lambda file_name: self._dataset_fn(file_name), cycle_length=32,
         num_parallel_calls=tf.data.experimental.AUTOTUNE)
-    dataset = dataset.cache()
 
     if self._is_training:
       # Large shuffle size is critical for 2vm input pipeline. Can use small
