commit 39704281a37ac193f08a2abde541e04a6bc4e8d9
Author: Erekle <ersho.ge@gmail.com>
Date:   Wed Jun 12 18:46:51 2019 +0400

    Fixed UnicodeDecodeError error (#7006)

diff --git a/research/deeplab/datasets/build_ade20k_data.py b/research/deeplab/datasets/build_ade20k_data.py
index b637fb43..69f0a522 100644
--- a/research/deeplab/datasets/build_ade20k_data.py
+++ b/research/deeplab/datasets/build_ade20k_data.py
@@ -91,11 +91,11 @@ def _convert_dataset(dataset_split, dataset_dir, dataset_label_dir):
         sys.stdout.flush()
         # Read the image.
         image_filename = img_names[i]
-        image_data = tf.gfile.FastGFile(image_filename, 'r').read()
+        image_data = tf.gfile.FastGFile(image_filename, 'rb').read()
         height, width = image_reader.read_image_dims(image_data)
         # Read the semantic segmentation annotation.
         seg_filename = seg_names[i]
-        seg_data = tf.gfile.FastGFile(seg_filename, 'r').read()
+        seg_data = tf.gfile.FastGFile(seg_filename, 'rb').read()
         seg_height, seg_width = label_reader.read_image_dims(seg_data)
         if height != seg_height or width != seg_width:
           raise RuntimeError('Shape mismatched between image and label.')
