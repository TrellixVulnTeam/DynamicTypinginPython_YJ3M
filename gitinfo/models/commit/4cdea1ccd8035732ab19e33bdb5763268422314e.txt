commit 4cdea1ccd8035732ab19e33bdb5763268422314e
Author: Taylor Robie <taylorrobie@google.com>
Date:   Thu Dec 27 15:33:51 2018 -0800

    skip bisection when it is not needed

diff --git a/official/recommendation/data_pipeline.py b/official/recommendation/data_pipeline.py
index 4feb2336..93684962 100644
--- a/official/recommendation/data_pipeline.py
+++ b/official/recommendation/data_pipeline.py
@@ -826,6 +826,10 @@ class BisectionDataConstructor(BaseDataConstructor):
         (neg_item_choice - self._total_negatives[right_index])
     )[use_shortcut]
 
+    if np.all(use_shortcut):
+      # The bisection code is ill-posed when there are no elements.
+      return output
+
     not_use_shortcut = np.logical_not(use_shortcut)
     left_index = left_index[not_use_shortcut]
     right_index = right_index[not_use_shortcut]
