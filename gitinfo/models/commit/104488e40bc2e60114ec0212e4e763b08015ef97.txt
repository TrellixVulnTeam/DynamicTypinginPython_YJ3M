commit 104488e40bc2e60114ec0212e4e763b08015ef97
Author: Hongkun Yu <hongkuny@google.com>
Date:   Sun Apr 5 11:52:47 2020 -0700

    Internal change
    
    PiperOrigin-RevId: 304908157

diff --git a/official/benchmark/bert_benchmark_utils.py b/official/benchmark/bert_benchmark_utils.py
index 44b82992..107e8151 100644
--- a/official/benchmark/bert_benchmark_utils.py
+++ b/official/benchmark/bert_benchmark_utils.py
@@ -23,7 +23,7 @@ import time
 # pylint: disable=g-bad-import-order
 import numpy as np
 from absl import flags
-import tensorflow.compat.v2 as tf
+import tensorflow as tf
 # pylint: enable=g-bad-import-order
 
 from official.utils.flags import core as flags_core
diff --git a/official/benchmark/bert_squad_benchmark.py b/official/benchmark/bert_squad_benchmark.py
index 31a4c38b..51d57b77 100644
--- a/official/benchmark/bert_squad_benchmark.py
+++ b/official/benchmark/bert_squad_benchmark.py
@@ -104,7 +104,6 @@ class BertSquadBenchmarkBase(benchmark_utils.BertBenchmarkBase):
   @flagsaver.flagsaver
   def _train_squad(self, run_eagerly=False, ds_type='mirrored'):
     """Runs BERT SQuAD training. Uses mirrored strategy by default."""
-    assert tf.version.VERSION.startswith('2.')
     self._init_gpu_and_data_threads()
     input_meta_data = self._read_input_meta_data_from_file()
     strategy = self._get_distribution_strategy(ds_type)
@@ -118,7 +117,6 @@ class BertSquadBenchmarkBase(benchmark_utils.BertBenchmarkBase):
   @flagsaver.flagsaver
   def _evaluate_squad(self, ds_type='mirrored'):
     """Runs BERT SQuAD evaluation. Uses mirrored strategy by default."""
-    assert tf.version.VERSION.startswith('2.')
     self._init_gpu_and_data_threads()
     input_meta_data = self._read_input_meta_data_from_file()
     strategy = self._get_distribution_strategy(ds_type)
diff --git a/official/benchmark/keras_benchmark.py b/official/benchmark/keras_benchmark.py
index 9d045793..dd94da46 100644
--- a/official/benchmark/keras_benchmark.py
+++ b/official/benchmark/keras_benchmark.py
@@ -32,7 +32,8 @@ class KerasBenchmark(PerfZeroBenchmark):
                default_flags=None,
                flag_methods=None,
                tpu=None):
-    assert tf.version.VERSION.startswith('2.')
+    # Due to xla legacy benchmark.
+    tf.compat.v1.enable_v2_behavior()
     super(KerasBenchmark, self).__init__(
         output_dir=output_dir,
         default_flags=default_flags,
diff --git a/official/benchmark/ncf_keras_benchmark.py b/official/benchmark/ncf_keras_benchmark.py
index 5622eeec..1e572b2a 100644
--- a/official/benchmark/ncf_keras_benchmark.py
+++ b/official/benchmark/ncf_keras_benchmark.py
@@ -50,7 +50,6 @@ class NCFKerasBenchmarkBase(tf.test.Benchmark):
 
   def _setup(self):
     """Sets up and resets flags before each test."""
-    assert tf.version.VERSION.startswith('2.')
     logging.set_verbosity(logging.INFO)
     if NCFKerasBenchmarkBase.local_flags is None:
       ncf_common.define_ncf_flags()
diff --git a/official/benchmark/tfhub_memory_usage_benchmark.py b/official/benchmark/tfhub_memory_usage_benchmark.py
index 4000f990..b373e1b9 100644
--- a/official/benchmark/tfhub_memory_usage_benchmark.py
+++ b/official/benchmark/tfhub_memory_usage_benchmark.py
@@ -20,7 +20,7 @@ import functools
 import time
 
 from absl import flags
-import tensorflow.compat.v2 as tf
+import tensorflow as tf
 import tensorflow_hub as hub
 
 from official.utils.testing.perfzero_benchmark import PerfZeroBenchmark
diff --git a/official/benchmark/transformer_benchmark.py b/official/benchmark/transformer_benchmark.py
index 011ae68d..ecb68541 100644
--- a/official/benchmark/transformer_benchmark.py
+++ b/official/benchmark/transformer_benchmark.py
@@ -44,7 +44,8 @@ class TransformerBenchmark(PerfZeroBenchmark):
 
   def __init__(self, output_dir=None, default_flags=None, root_data_dir=None,
                flag_methods=None):
-    assert tf.version.VERSION.startswith('2.')
+    # Due to xla legacy benchmark.
+    tf.compat.v1.enable_v2_behavior()
     root_data_dir = root_data_dir if root_data_dir else ''
 
     self.train_data_dir = os.path.join(root_data_dir,
diff --git a/official/recommendation/ncf_keras_main.py b/official/recommendation/ncf_keras_main.py
index d5f13c33..a35bb9c0 100644
--- a/official/recommendation/ncf_keras_main.py
+++ b/official/recommendation/ncf_keras_main.py
@@ -29,7 +29,7 @@ import os
 from absl import app
 from absl import flags
 from absl import logging
-import tensorflow as tf
+import tensorflow.compat.v2 as tf
 # pylint: enable=g-bad-import-order
 
 from official.recommendation import constants as rconst
diff --git a/official/vision/detection/main.py b/official/vision/detection/main.py
index 81addab8..81134710 100644
--- a/official/vision/detection/main.py
+++ b/official/vision/detection/main.py
@@ -251,6 +251,5 @@ def main(argv):
 
 
 if __name__ == '__main__':
-  assert tf.version.VERSION.startswith('2.')
   tf.config.set_soft_device_placement(True)
   app.run(main)
diff --git a/official/vision/image_classification/resnet/tfhub_export.py b/official/vision/image_classification/resnet/tfhub_export.py
index aefcc495..db00173f 100644
--- a/official/vision/image_classification/resnet/tfhub_export.py
+++ b/official/vision/image_classification/resnet/tfhub_export.py
@@ -59,7 +59,7 @@ def main(argv):
   if len(argv) > 1:
     raise app.UsageError("Too many command-line arguments.")
 
-  assert tf.version.VERSION.startswith('2.')
+  tf.enable_v2_behavior()
   export_tfhub(FLAGS.model_path, FLAGS.export_path)
 
 
