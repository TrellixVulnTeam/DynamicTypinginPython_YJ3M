commit 650c6d2ea432a7b0282cb7d5a938e54151cf5494
Author: Ted Kaemming <ted@kaemming.com>
Date:   Fri Oct 9 14:07:11 2015 -0700

    Also record the users affected within a project.

diff --git a/src/sentry/event_manager.py b/src/sentry/event_manager.py
index 2aa71e2ebc..70afdf0736 100644
--- a/src/sentry/event_manager.py
+++ b/src/sentry/event_manager.py
@@ -468,12 +468,10 @@ class EventManager(object):
                 return event
 
         if event_user:
-            tsdb.record(
-                tsdb.models.users_affected_by_group,
-                group.id,
-                (event_user.tag_value,),
-                timestamp=event.datetime,
-            )
+            tsdb.record_multi((
+                (tsdb.models.users_affected_by_group, group.id, (event_user.tag_value,)),
+                (tsdb.models.users_affected_by_project, project.id, (event_user.tag_value,)),
+            ), timestamp=event.datetime)
 
         if is_new and release:
             buffer.incr(Release, {'new_groups': 1}, {
diff --git a/src/sentry/tsdb/base.py b/src/sentry/tsdb/base.py
index 18bdd68449..7aeaf932a2 100644
--- a/src/sentry/tsdb/base.py
+++ b/src/sentry/tsdb/base.py
@@ -48,9 +48,12 @@ class TSDBModel(Enum):
     # the number of events blocked due to being blacklisted
     organization_total_blacklisted = 202
 
-    # distinct count of users that have been affected by a group
+    # distinct count of users that have been affected by an event in a group
     users_affected_by_group = 300
 
+    # distinct count of users that have been affected by an event in a project
+    users_affected_by_project = 301
+
 
 class BaseTSDB(object):
     models = TSDBModel
diff --git a/tests/sentry/test_event_manager.py b/tests/sentry/test_event_manager.py
index b378919f52..b38cd5db0f 100644
--- a/tests/sentry/test_event_manager.py
+++ b/tests/sentry/test_event_manager.py
@@ -329,6 +329,15 @@ class EventManagerTest(TransactionTestCase):
             event.group.id: 1,
         }
 
+        assert tsdb.get_distinct_counts_totals(
+            tsdb.models.users_affected_by_project,
+            (event.project.id,),
+            event.datetime,
+            event.datetime,
+        ) == {
+            event.project.id: 1,
+        }
+
         assert EventUser.objects.filter(
             project=self.project,
             ident='1',
