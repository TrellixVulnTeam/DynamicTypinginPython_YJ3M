commit 28a5ee52a29d91355bc10ce2f9e38cd35222f434
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Wed Mar 2 11:47:18 2016 -0800

    Correctly filter only ACTIVE projects on notification settings page

diff --git a/src/sentry/web/frontend/accounts.py b/src/sentry/web/frontend/accounts.py
index 12ac692d0a..8ffcb90820 100644
--- a/src/sentry/web/frontend/accounts.py
+++ b/src/sentry/web/frontend/accounts.py
@@ -20,7 +20,7 @@ from django.utils import timezone
 from sudo.decorators import sudo_required
 
 from sentry.models import (
-    LostPasswordHash, Project, UserOption
+    LostPasswordHash, Project, ProjectStatus, UserOption
 )
 from sentry.plugins import plugins
 from sentry.web.decorators import login_required
@@ -178,6 +178,7 @@ def notification_settings(request):
     project_list = list(Project.objects.filter(
         team__organizationmemberteam__organizationmember__user=request.user,
         team__organizationmemberteam__is_active=True,
+        status=ProjectStatus.VISIBLE,
     ).distinct())
 
     project_forms = [
diff --git a/tests/sentry/web/frontend/accounts/tests.py b/tests/sentry/web/frontend/accounts/tests.py
index c45bfa1f16..7aa07d20f0 100644
--- a/tests/sentry/web/frontend/accounts/tests.py
+++ b/tests/sentry/web/frontend/accounts/tests.py
@@ -8,7 +8,7 @@ from django.core.urlresolvers import reverse
 from exam import fixture
 from social_auth.models import UserSocialAuth
 
-from sentry.models import UserOption, LostPasswordHash, User
+from sentry.models import UserOption, LostPasswordHash, User, ProjectStatus
 from sentry.testutils import TestCase
 
 
@@ -130,6 +130,7 @@ class NotificationSettingsTest(TestCase):
         team = self.create_team(organization=organization)
         project = self.create_project(organization=organization, team=team)
         team2 = self.create_team(organization=organization)
+        self.create_project(organization=organization, team=team, status=ProjectStatus.PENDING_DELETION)
         self.create_project(organization=organization, team=team2)
         self.create_member(organization=organization, user=user, teams=[project.team])
         self.login_as(user)
