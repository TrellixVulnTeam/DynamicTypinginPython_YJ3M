commit 3d167c011c3163934f552ea141012f36104115bd
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Mar 7 11:53:07 2015 -0800

    Move release fetching code

diff --git a/src/sentry/lang/javascript/processor.py b/src/sentry/lang/javascript/processor.py
index 920c4fd1b2..a3335ac6ec 100644
--- a/src/sentry/lang/javascript/processor.py
+++ b/src/sentry/lang/javascript/processor.py
@@ -352,6 +352,18 @@ class SourceProcessor(object):
             ])
         return frames
 
+    def get_release(self, data):
+        if not data.get('release'):
+            return
+
+        try:
+            return Release.objects.get(
+                project=data['project'],
+                version=data['release'],
+            )
+        except Release.DoesNotExist:
+            return
+
     def process(self, data):
         stacktraces = self.get_stacktraces(data)
         if not stacktraces:
@@ -367,16 +379,7 @@ class SourceProcessor(object):
             id=data['project'],
         )
 
-        if data.get('release'):
-            try:
-                release = Release.objects.get(
-                    project=project.id,
-                    version=data['release'],
-                )
-            except Release.DoesNotExist:
-                release = None
-        else:
-            release = None
+        release = self.get_release(data)
 
         # all of these methods assume mutation on the original
         # objects rather than re-creation
