commit c57e5d5cbe709f557cf6bf0a98ea55abe30a9b52
Author: Billy Vong <billy@sentry.io>
Date:   Fri Dec 1 14:25:26 2017 -0800

    fix(api): Do not allow empty allowed domains

diff --git a/src/sentry/api/endpoints/project_details.py b/src/sentry/api/endpoints/project_details.py
index 0fd9e807aa..d66af216ac 100644
--- a/src/sentry/api/endpoints/project_details.py
+++ b/src/sentry/api/endpoints/project_details.py
@@ -104,6 +104,14 @@ class ProjectAdminSerializer(ProjectMemberSerializer):
             )
         return attrs
 
+    def validate_allowedDomains(self, attrs, source):
+        allowed_domains = attrs[source]
+        if len(allowed_domains) == 0:
+            raise serializers.ValidationError(
+                'Empty value will block all requests, use * to accept from all domains'
+            )
+        return attrs
+
     def validate_slug(self, attrs, source):
         slug = attrs[source]
         project = self.context['project']
@@ -308,7 +316,7 @@ class ProjectDetailsEndpoint(ProjectEndpoint):
             project.update_option('sentry:resolve_age', result['resolveAge'])
         if result.get('scrapeJavaScript') is not None:
             project.update_option('sentry:scrape_javascript', result['scrapeJavaScript'])
-        if result.get('allowedDomains') is not None:
+        if result.get('allowedDomains'):
             project.update_option('sentry:origins', result['allowedDomains'])
 
         if result.get('isSubscribed'):
