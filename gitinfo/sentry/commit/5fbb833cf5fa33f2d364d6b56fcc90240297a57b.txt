commit 5fbb833cf5fa33f2d364d6b56fcc90240297a57b
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Apr 16 23:05:18 2015 -0700

    Handle sample rate in counts

diff --git a/src/sentry/utils/metrics.py b/src/sentry/utils/metrics.py
index 1699169b2b..4f5f9cbc19 100644
--- a/src/sentry/utils/metrics.py
+++ b/src/sentry/utils/metrics.py
@@ -23,7 +23,9 @@ def incr(key, amount=1):
                 rate=sample_rate)
 
     if sample_rate >= 1 or random() >= sample_rate:
-        tsdb.incr(tsdb.models.internal, key)
+        if sample_rate > 0 and sample_rate < 1:
+            amount = amount * (1.0 / sample_rate)
+        tsdb.incr(tsdb.models.internal, key, amount)
 
 
 def timing(key, value):
