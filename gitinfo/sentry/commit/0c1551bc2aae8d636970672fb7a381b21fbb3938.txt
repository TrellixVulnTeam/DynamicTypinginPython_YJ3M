commit 0c1551bc2aae8d636970672fb7a381b21fbb3938
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 17 22:29:53 2012 -0800

    Safety check for cache return value

diff --git a/src/sentry/manager.py b/src/sentry/manager.py
index 32990c8159..bf1a63c01a 100644
--- a/src/sentry/manager.py
+++ b/src/sentry/manager.py
@@ -214,6 +214,12 @@ class BaseManager(models.Manager):
             if key != pk_name:
                 return self.get_from_cache(**{pk_name: retval})
 
+            if type(retval) != self.model:
+                if settings.DEBUG:
+                    raise ValueError('Unexpected value type returned from cache')
+                logger.error('Cache response returned invalid value %r', retval)
+                return self.get(**kwargs)
+
             return retval
         else:
             return self.get(**kwargs)
