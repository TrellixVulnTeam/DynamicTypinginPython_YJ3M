commit df0da0722d626670ccc75b0ae655cfd38e47f4d5
Author: Mark Story <mark@sentry.io>
Date:   Fri Apr 3 10:07:58 2020 -0400

    fix(ui) Fix wide tooltips overflowing the viewport (#18069)
    
    The previous logic failed to take into account the chart left offset in
    the page. This corrects that omission and fixes positioning of wide
    tooltips as we'll have more of those with top5 graphs.

diff --git a/src/sentry/static/sentry/app/components/charts/components/tooltip.jsx b/src/sentry/static/sentry/app/components/charts/components/tooltip.jsx
index bb943a1000..dbe1319247 100644
--- a/src/sentry/static/sentry/app/components/charts/components/tooltip.jsx
+++ b/src/sentry/static/sentry/app/components/charts/components/tooltip.jsx
@@ -153,16 +153,23 @@ export default function Tooltip({
       const tipWidth = dom.clientWidth;
       const tipHeight = dom.clientHeight;
 
-      // Determine new left edge.
+      // Get the left offset of the tip container (the chart)
+      // so that we can estimate overflows
+      const chartLeft = dom.parentNode.getBoundingClientRect().left;
+
+      // Determine the new left edge.
       let leftPos = pos[0] - tipWidth / 2;
       let arrowPosition = '50%';
-      const rightEdge = pos[0] + tipWidth;
+
+      // And the right edge taking into account the chart left offset
+      const rightEdge = chartLeft + pos[0] + tipWidth / 2;
 
       // If the tooltip would go off viewport shift the tooltip over with a gap.
-      if (rightEdge >= window.innerWidth - 30) {
-        leftPos -= rightEdge - window.innerWidth + 30;
+      if (rightEdge >= window.innerWidth - 20) {
+        leftPos -= rightEdge - window.innerWidth + 20;
         arrowPosition = `${pos[0] - leftPos}px`;
       }
+
       // Reposition the arrow.
       const arrow = dom.querySelector('.tooltip-arrow');
       if (arrow) {
