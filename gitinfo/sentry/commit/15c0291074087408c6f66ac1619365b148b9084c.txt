commit 15c0291074087408c6f66ac1619365b148b9084c
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Feb 6 13:47:38 2014 -0800

    Trim various keys in stacktrace

diff --git a/src/sentry/manager.py b/src/sentry/manager.py
index dc514ec091..4ad24e2ec0 100644
--- a/src/sentry/manager.py
+++ b/src/sentry/manager.py
@@ -271,6 +271,7 @@ class GroupManager(BaseManager, ChartMixin):
         trim_dict(
             data['extra'], max_size=settings.SENTRY_MAX_EXTRA_VARIABLE_SIZE)
 
+        # TODO: each interface should describe its own normalization logic
         if 'sentry.interfaces.Exception' in data:
             if 'values' not in data['sentry.interfaces.Exception']:
                 data['sentry.interfaces.Exception'] = {
@@ -286,17 +287,24 @@ class GroupManager(BaseManager, ChartMixin):
                     value = exc_data.get(key)
                     if value:
                         exc_data[key] = trim(value)
+
                 if exc_data.get('stacktrace'):
                     trim_frames(exc_data['stacktrace'])
                     for frame in exc_data['stacktrace']['frames']:
                         stack_vars = frame.get('vars', {})
                         trim_dict(stack_vars)
+                        for key, value in frame.iteritems():
+                            if key not in ('vars', 'data'):
+                                frame[key] = trim(value)
 
         if 'sentry.interfaces.Stacktrace' in data:
             trim_frames(data['sentry.interfaces.Stacktrace'])
             for frame in data['sentry.interfaces.Stacktrace']['frames']:
                 stack_vars = frame.get('vars', {})
                 trim_dict(stack_vars)
+                for key, value in frame.iteritems():
+                    if key not in ('vars', 'data'):
+                        frame[key] = trim(value)
 
         if 'sentry.interfaces.Message' in data:
             msg_data = data['sentry.interfaces.Message']
