commit 5db70b3881d54cba1a54edd448f08d6ecb1fa390
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Apr 7 15:35:36 2013 -0700

    Conform plugin perm responses to the standard plugin Response api

diff --git a/src/sentry/plugins/base.py b/src/sentry/plugins/base.py
index c558dbab1d..2307191847 100644
--- a/src/sentry/plugins/base.py
+++ b/src/sentry/plugins/base.py
@@ -327,7 +327,7 @@ class IPlugin(local):
             return response
 
         if not isinstance(response, Response):
-            raise NotImplementedError('Please use self.render() when returning responses.')
+            raise NotImplementedError('Use self.render() when returning responses.')
 
         event = group.get_latest_event() or Event()
         event.group = group
diff --git a/src/sentry/web/frontend/generic.py b/src/sentry/web/frontend/generic.py
index 2457db3722..1672b242db 100644
--- a/src/sentry/web/frontend/generic.py
+++ b/src/sentry/web/frontend/generic.py
@@ -14,6 +14,7 @@ from django.utils.translation import ugettext as _
 from sentry.models import Team
 from sentry.permissions import can_create_teams
 from sentry.plugins import plugins
+from sentry.plugins.base import Response
 from sentry.web.decorators import login_required
 from sentry.web.helpers import render_to_response
 
@@ -76,10 +77,18 @@ def missing_perm(request, perm, **kwargs):
 
     Plugins may overwrite this with the ``missing_perm_response`` hook.
     """
-    resp = plugins.first('missing_perm_response', request, perm, **kwargs)
+    response = plugins.first('missing_perm_response', request, perm, **kwargs)
 
-    if resp:
-        return resp
+    if response:
+        if isinstance(response, HttpResponseRedirect):
+            return response
+
+        if not isinstance(response, Response):
+            raise NotImplementedError('Use self.render() when returning responses.')
+
+        return response.respond(request, {
+            'perm': perm,
+        })
 
     if perm.label:
         return render_to_response('sentry/generic_error.html', {
