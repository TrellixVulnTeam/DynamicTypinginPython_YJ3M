commit f1d271cbfacea18dc85b4b345c3c76571be445dc
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jan 3 17:43:14 2012 -0800

    Initial work

diff --git a/sentry/utils/sqlparser.py b/sentry/utils/sqlparser.py
new file mode 100644
index 0000000000..fcd85190a2
--- /dev/null
+++ b/sentry/utils/sqlparser.py
@@ -0,0 +1,37 @@
+"""
+sentry.utils.sqlparser
+~~~~~~~~~~~~~~~~~~~~~~
+
+:copyright: (c) 2010 by the Sentry Team, see AUTHORS for more details.
+:license: BSD, see LICENSE for more details.
+"""
+from sqlparse import engine
+from sqlparse import filters
+from sqlparse import tokens as T
+
+
+class ValueFilter(filters.TokenFilter):
+    include = (T.String, T.Number)
+    exclude = (T.String.Symbol,)
+
+    def process(self, stack, stream):
+        for ttype, value in stream:
+            parent = ttype
+            while parent:
+                if parent in self.exclude:
+                    break
+                if parent in self.include:
+                    value = '?'
+                    break
+                if ttype.parent == parent:
+                    parent = None
+                else:
+                    parent = ttype.parent
+            yield ttype, value
+
+
+def parse(query):
+    stack = engine.FilterStack()
+    stack.preprocess.append(ValueFilter())
+    stack.postprocess.append(filters.SerializerUnicode())
+    return ''.join(stack.run(query))
