commit 65f609f04f08c0c8f2456563e27f8c4ebc456c0a
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Nov 20 02:10:39 2012 -0800

    Support django-compressor

diff --git a/.gitignore b/.gitignore
index fd2acf5e1b..e8aec0d9e1 100644
--- a/.gitignore
+++ b/.gitignore
@@ -11,6 +11,7 @@
 *.pid
 pip-log.txt
 .DS_Store
+/src/sentry/static/CACHE/
 /docs/html
 /docs/doctrees
 example/db.sqlite
diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index becc4066d0..9628a9e6f6 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -141,6 +141,7 @@ INSTALLED_APPS = (
     'django.contrib.sites',
     'django.contrib.messages',
 
+    'compressor',
     'crispy_forms',
     'djcelery',
     'gunicorn',
@@ -157,7 +158,8 @@ INSTALLED_APPS = (
     'django_social_auth_trello',
 )
 
-STATIC_URL = '/_admin_media/'
+STATIC_ROOT = os.path.join(PROJECT_ROOT, 'static')
+STATIC_URL = '/_static/'
 
 LOCALE_PATHS = (
     os.path.join(PROJECT_ROOT, 'locale'),
diff --git a/src/sentry/templates/sentry/layout.html b/src/sentry/templates/sentry/layout.html
index 970d13a92f..77abf5b7b2 100644
--- a/src/sentry/templates/sentry/layout.html
+++ b/src/sentry/templates/sentry/layout.html
@@ -1,3 +1,4 @@
+{% load compress %}
 {% load i18n %}
 {% load sentry_helpers %}
 
@@ -28,17 +29,20 @@
         <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/html5shiv.js" %}"></script>
         <![endif]-->
         {% block scripts %}
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.animate-colors-min.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.clippy.min.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.cookie.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.flot.min.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/json2.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/underscore.min.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/backbone.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/select2/select2.min.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/global.min.js" %}"></script>
-            <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/site.js" %}"></script>
+            {% compress js %}
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.animate-colors-min.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.clippy.min.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.cookie.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/jquery.flot.min.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/json2.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/underscore.min.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/backbone.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/select2/select2.min.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/bootstrap.min.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/global.min.js" %}"></script>
+                <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/site.js" %}"></script>
+            {% endcompress %}
             <script type="text/javascript">
             Sentry.config({
                 urlPrefix: {{ URL_PREFIX|to_json|safe }},
@@ -131,7 +135,6 @@
           </div>
         </div>
 
-        <script type="text/javascript" src="{% url sentry-media "sentry" "scripts/bootstrap.min.js" %}"></script>
         <script type="text/javascript">
         $(function(){
             $('.clippy').clippy({
diff --git a/src/sentry/web/frontend/generic.py b/src/sentry/web/frontend/generic.py
index a499556406..4c1799a413 100644
--- a/src/sentry/web/frontend/generic.py
+++ b/src/sentry/web/frontend/generic.py
@@ -52,8 +52,8 @@ def static_media(request, module, path, root=None):
 
     if root:
         document_root = root
-    elif module == 'sentry':
-        document_root = os.path.join(settings.MODULE_ROOT, 'static', 'sentry')
+    elif module in ('sentry', 'CACHE'):
+        document_root = os.path.join(settings.MODULE_ROOT, 'static', module)
     elif module not in dj_settings.INSTALLED_APPS:
         raise Http404('Invalid module provided.')
     else:
