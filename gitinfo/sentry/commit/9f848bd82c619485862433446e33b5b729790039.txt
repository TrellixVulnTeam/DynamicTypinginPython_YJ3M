commit 9f848bd82c619485862433446e33b5b729790039
Author: Jan Michael Auer <account@jauer.org>
Date:   Mon Nov 20 23:36:24 2017 +0100

    ci: Upload artifacts using the Zeus CLI tool (#6546)

diff --git a/.travis.yml b/.travis.yml
index 61aedc2638..b1921ab560 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -39,14 +39,16 @@ script:
   - make travis-test-$TEST_SUITE
 after_success:
   - codecov -e TEST_SUITE
-  - bin/upload-zeus-artifact junit.xml "text/xml+xunit"
-  - bin/upload-zeus-artifact coverage.xml "text/xml+coverage"
-  - bin/upload-zeus-artifact pytest.html "text/html+pytest"
+  - npm install -g @zeus-ci/cli
+  - zeus upload -t "text/xml+xunit" junit.xml
+  - zeus upload -t "text/xml+coverage" coverage.xml
+  - zeus upload -t "text/html+pytest" pytest.html
 after_failure:
   - dmesg | tail -n 100
-  - bin/upload-zeus-artifact junit.xml "text/xml+xunit"
-  - bin/upload-zeus-artifact coverage.xml "text/xml+coverage"
-  - bin/upload-zeus-artifact pytest.html "text/html+pytest"
+  - npm install -g @zeus-ci/cli
+  - zeus upload -t "text/xml+xunit" junit.xml
+  - zeus upload -t "text/xml+coverage" coverage.xml
+  - zeus upload -t "text/html+pytest" pytest.html
 # each attribute in the matrix will override the global attribute
 matrix:
   fast_finish: true
diff --git a/bin/update-zeus-job b/bin/update-zeus-job
deleted file mode 100755
index 1f15616624..0000000000
--- a/bin/update-zeus-job
+++ /dev/null
@@ -1,16 +0,0 @@
-#!/bin/bash -eu
-if [[ "$TRAVIS_PULL_REQUEST" != "false" ]]; then
-    BUILD_NAME="PR #${TRAVIS_PULL_REQUEST}"
-else
-    BUILD_NAME=""
-fi
-
-curl $ZEUS_HOOK_BASE/builds/$TRAVIS_BUILD_NUMBER \
-    -X POST \
-    -H 'Content-Type: application/json' \
-    -d "{\"label\": \"${BUILD_NAME}\", \"ref\": \"$TRAVIS_COMMIT\", \"url\": \"https://travis-ci.org/${TRAVIS_REPO_SLUG}/builds/${TRAVIS_BUILD_ID}\"}"
-
-curl $ZEUS_HOOK_BASE/builds/$TRAVIS_BUILD_NUMBER/jobs/$TRAVIS_JOB_NUMBER \
-    -X POST \
-    -H 'Content-Type: application/json' \
-    -d "{\"label\": \"${TEST_SUITE}\", \"status\": \"$1\", \"result\": \"$2\", \"url\": \"https://travis-ci.org/${TRAVIS_REPO_SLUG}/jobs/${TRAVIS_JOB_ID}\", \"allow_failure\": ${TRAVIS_ALLOW_FAILURE}}"
diff --git a/bin/upload-zeus-artifact b/bin/upload-zeus-artifact
deleted file mode 100755
index 543f7a4f5f..0000000000
--- a/bin/upload-zeus-artifact
+++ /dev/null
@@ -1,10 +0,0 @@
-#!/bin/bash -eu
-
-if [[ -e $1 ]]; then
-    curl -i $ZEUS_HOOK_BASE/builds/$TRAVIS_BUILD_ID/jobs/$TRAVIS_JOB_ID/artifacts \
-        -X POST \
-        -F "file=@$1" \
-        -F "type=$2"
-else
-    (>&2 echo "[WARN] File not found: $1")
-fi
