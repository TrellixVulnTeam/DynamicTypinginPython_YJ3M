commit 54ca69adeca80f29a4416fd0778b1f68636f5882
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Mon Jul 30 17:45:34 2018 -0700

    feat(integrations): Support markdown in modal alerts

diff --git a/src/sentry/static/sentry/app/components/modals/integrationDetailsModal.jsx b/src/sentry/static/sentry/app/components/modals/integrationDetailsModal.jsx
index e07567a137..e937a06541 100644
--- a/src/sentry/static/sentry/app/components/modals/integrationDetailsModal.jsx
+++ b/src/sentry/static/sentry/app/components/modals/integrationDetailsModal.jsx
@@ -15,6 +15,10 @@ import space from 'app/styles/space';
 
 const EARLY_ADOPTER_INTEGRATIONS = ['github', 'jira', 'github_enterprise'];
 
+const alertMarkedRenderer = new marked.Renderer();
+alertMarkedRenderer.paragraph = s => s;
+const alertMarked = text => marked(text, {renderer: alertMarkedRenderer});
+
 class IntegrationDetailsModal extends React.Component {
   static propTypes = {
     closeModal: PropTypes.func.isRequired,
@@ -44,6 +48,16 @@ class IntegrationDetailsModal extends React.Component {
     const {metadata} = provider;
     const description = marked(metadata.description);
 
+    const alerts = metadata.aspects.alerts || [];
+
+    if (!provider.canAdd && metadata.aspects.externalInstall) {
+      alerts.push({
+        type: 'warning',
+        icon: 'icon-exit',
+        text: metadata.aspects.externalInstall.noticeText,
+      });
+    }
+
     return (
       <React.Fragment>
         <Flex align="center" mb={2}>
@@ -65,19 +79,11 @@ class IntegrationDetailsModal extends React.Component {
           </Box>
         </Metadata>
 
-        {!provider.canAdd &&
-          metadata.aspects.externalInstall && (
-            <Alert type="warning" icon="icon-exit">
-              {metadata.aspects.externalInstall.noticeText}
-            </Alert>
-          )}
-
-        {metadata.aspects.alerts &&
-          metadata.aspects.alerts.map((alert, i) => (
-            <Alert key={i} type={alert.type}>
-              {alert.text}
-            </Alert>
-          ))}
+        {alerts.map((alert, i) => (
+          <Alert key={i} type={alert.type} icon={alert.icon}>
+            <span dangerouslySetInnerHTML={{__html: alertMarked(alert.text)}} />
+          </Alert>
+        ))}
 
         <div className="modal-footer">
           <Button size="small" onClick={closeModal}>
diff --git a/tests/js/setup.js b/tests/js/setup.js
index 6fb840f810..74cb7c5477 100644
--- a/tests/js/setup.js
+++ b/tests/js/setup.js
@@ -553,13 +553,11 @@ window.TestStubs = {
         issue_url: 'http://example.com/jira_integration_issue_url',
         source_url: 'http://example.com/jira_integration_source_url',
         aspects: {
-          externalInstall: [
-            {
-              url: 'http://jira.com',
-              buttonText: 'Visit Jira',
-              noticeText: 'You must visit jira to install the integration',
-            },
-          ],
+          externalInstall: {
+            url: 'http://jira.com',
+            buttonText: 'Visit Jira',
+            noticeText: 'You must visit jira to install the integration',
+          },
         },
       },
       ...params,
diff --git a/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap b/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap
index a6e95fb88c..0382660910 100644
--- a/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap
+++ b/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap
@@ -64,7 +64,13 @@ exports[`IntegrationDetailsModal renders simple integration 1`] = `
     key="0"
     type="warning"
   >
-    This is a an alert example
+    <span
+      dangerouslySetInnerHTML={
+        Object {
+          "__html": "This is a an alert example",
+        }
+      }
+    />
   </Alert>
   <div
     className="modal-footer"
diff --git a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap
index 3fc62431bf..b0128cc169 100644
--- a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap
+++ b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap
@@ -196,13 +196,11 @@ exports[`OrganizationIntegrations render() with installed integrations Displays
                 "key": "jira",
                 "metadata": Object {
                   "aspects": Object {
-                    "externalInstall": Array [
-                      Object {
-                        "buttonText": "Visit Jira",
-                        "noticeText": "You must visit jira to install the integration",
-                        "url": "http://jira.com",
-                      },
-                    ],
+                    "externalInstall": Object {
+                      "buttonText": "Visit Jira",
+                      "noticeText": "You must visit jira to install the integration",
+                      "url": "http://jira.com",
+                    },
                   },
                   "author": "Rick",
                   "description": "*markdown* formatted Jira _description_",
