commit 7a825c99f02d233526898959312ef3980785b2b5
Author: Jan Michael Auer <jan.auer@sentry.io>
Date:   Wed Aug 14 17:37:07 2019 +0200

    ref(conf): Change the default for internal system IPs (#14349)
    
    This adds all internal IP ranges as a default to `INTERNAL_SYSTEM_IPS`. These ranges are used to permit `SystemTokenAuthentication`, which gives all permissions and superuser access to anyone who has that token.
    
    The defaults are chosen for https://github.com/getsentry/onpremise

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 82c27d92f6..cfb3da0bd9 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -77,8 +77,28 @@ ADMINS = ()
 # This gives access to functionality like the debug toolbar.
 INTERNAL_IPS = ()
 
+# List of IP subnets which should not be accessible
+SENTRY_DISALLOWED_IPS = ()
+
 # Hosts that are allowed to use system token authentication.
-INTERNAL_SYSTEM_IPS = ()
+# http://en.wikipedia.org/wiki/Reserved_IP_addresses
+INTERNAL_SYSTEM_IPS = (
+    "0.0.0.0/8",
+    "10.0.0.0/8",
+    "100.64.0.0/10",
+    "127.0.0.0/8",
+    "169.254.0.0/16",
+    "172.16.0.0/12",
+    "192.0.0.0/29",
+    "192.0.2.0/24",
+    "192.88.99.0/24",
+    "192.168.0.0/16",
+    "198.18.0.0/15",
+    "198.51.100.0/24",
+    "224.0.0.0/4",
+    "240.0.0.0/4",
+    "255.255.255.255/32",
+)
 
 MANAGERS = ADMINS
 
@@ -1159,9 +1179,6 @@ SENTRY_SOURCE_FETCH_SOCKET_TIMEOUT = 2
 # Maximum content length for source files before we abort fetching
 SENTRY_SOURCE_FETCH_MAX_SIZE = 40 * 1024 * 1024
 
-# List of IP subnets which should not be accessible
-SENTRY_DISALLOWED_IPS = ()
-
 # Fields which managed users cannot change via Sentry UI. Username and password
 # cannot be changed by managed users. Optionally include 'email' and
 # 'name' in SENTRY_MANAGED_USER_FIELDS.
