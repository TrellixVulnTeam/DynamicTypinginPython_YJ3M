commit 7d17c3043886f5985421c7c098e5c245129d0bb4
Author: Mark Story <mark@mark-story.com>
Date:   Tue Apr 23 11:59:09 2019 -0400

    fix(ui) Fix gap between pin and slider buttons (#12849)
    
    Users that don't have org-write shouldn't see a gap in their search
    button bar. Instead we should give evenly spaced buttons for all.
    
    Use flexbox instead of absolute positioning. By moving borders and
    backgrounds around we can use flexbox to position the button bar
    instead of hardcoding positional widths in.

diff --git a/src/sentry/static/sentry/app/components/smartSearchBar/index.jsx b/src/sentry/static/sentry/app/components/smartSearchBar/index.jsx
index a79939f742..08e98ac2ce 100644
--- a/src/sentry/static/sentry/app/components/smartSearchBar/index.jsx
+++ b/src/sentry/static/sentry/app/components/smartSearchBar/index.jsx
@@ -714,11 +714,10 @@ class SmartSearchBar extends React.Component {
 
     if (hasPinnedSearch) {
       return (
-        <Container isDisabled={disabled}>
-          <form onSubmit={this.onSubmit}>
+        <Container isDisabled={disabled} isOpen={this.state.dropdownVisible}>
+          <StyledForm onSubmit={this.onSubmit}>
             <StyledInput
               type="text"
-              className="search-input form-control"
               placeholder={placeholder}
               name="query"
               innerRef={this.searchInput}
@@ -743,7 +742,7 @@ class SmartSearchBar extends React.Component {
                 />
               </DropdownWrapper>
             )}
-          </form>
+          </StyledForm>
           <ButtonBar>
             <CreateSavedSearchButton
               query={this.state.query}
@@ -853,23 +852,32 @@ const PinIcon = styled(InlineSvg)`
 `;
 
 const Container = styled.div`
-  position: relative;
+  border: 1px solid ${p => p.theme.borderLight};
+  border-radius: ${p =>
+    p.isOpen
+      ? `0 ${p.theme.borderRadius} 0 0`
+      : `0 ${p.theme.borderRadius} ${p.theme.borderRadius} 0`};
+  /* match button height */
+  height: 40px;
+  box-shadow: inset ${p => p.theme.dropShadowLight};
+  background: #fff;
+
   flex-grow: 1;
+  position: relative;
+
   z-index: ${p => p.theme.zIndex.dropdown};
+  display: flex;
 `;
 
-// Buttons are 18px wide, and we want 3px gutters
-const buttonBarWidth = 18 * 3 + 3 * 3;
-
 const ButtonBar = styled.div`
-  position: absolute;
-  top: ${space(1.5)};
-  right: ${space(1.5)};
   display: flex;
-  justify-content: space-between;
-  width: ${buttonBarWidth}px;
+  justify-content: flex-end;
+  margin-right: ${space(1)};
 
   button {
+    margin-left: ${space(0.5)};
+    width: 18px;
+
     background: transparent;
     &:hover {
       background: transparent;
@@ -881,19 +889,20 @@ const DropdownWrapper = styled('div')`
   display: ${p => (p.visible ? 'block' : 'none')};
 `;
 
+const StyledForm = styled.form`
+  flex-grow: 1;
+`;
+
 const StyledInput = styled.input`
-  border: 1px solid ${p => p.theme.borderLight};
-  border-radius: 0 ${p => p.theme.borderRadius} ${p => p.theme.borderRadius} 0;
-  box-shadow: inset ${p => p.theme.dropShadowLight};
   color: ${p => p.theme.foreground};
+  background: transparent;
+  border: 0;
+  outline: none;
 
   font-size: ${p => p.theme.fontSizeMedium};
-  /* match the height of buttons */
-  height: 40px;
   width: 100%;
-
-  /* pad the right side of the input to accomodate the button bar */
-  padding: ${space(1)} ${buttonBarWidth + 12}px ${space(1)} ${space(1)};
+  height: 100%;
+  padding: 0 0 0 ${space(1)};
 
   &::placeholder {
     color: ${p => p.theme.gray1};
diff --git a/src/sentry/static/sentry/app/components/smartSearchBar/searchDropdown.jsx b/src/sentry/static/sentry/app/components/smartSearchBar/searchDropdown.jsx
index 3c3f6a1446..8414e21205 100644
--- a/src/sentry/static/sentry/app/components/smartSearchBar/searchDropdown.jsx
+++ b/src/sentry/static/sentry/app/components/smartSearchBar/searchDropdown.jsx
@@ -112,9 +112,10 @@ const StyledSearchDropdown = styled('div')`
   border: 1px solid ${p => p.theme.borderLight};
   border-radius: 0 0 4px 4px;
   position: absolute;
-  top: 37px;
-  right: 0;
-  left: 0;
+  top: 38px;
+  /* Container has a border that we need to account for */
+  right: -1px;
+  left: -1px;
   background: #fff;
   z-index: ${p => p.theme.zIndex.dropdown};
   overflow: hidden;
