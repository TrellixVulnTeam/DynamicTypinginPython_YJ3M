commit d556880c6269ae361d09d344a3996f0ae8bb02e3
Author: maxbittker <maxbittker@gmail.com>
Date:   Wed Mar 1 18:45:42 2017 -0800

    hacky feature flag for similarity view

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index fe9f68ff95..246cda8b39 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -733,6 +733,7 @@ SENTRY_FEATURES = {
     'organizations:sso': True,
     'organizations:callsigns': False,
     'organizations:release-commits': False,
+    'organizations:similarity-view': True,
     'projects:global-events': False,
     'projects:plugins': True,
     'projects:dsym': False,
diff --git a/src/sentry/features/__init__.py b/src/sentry/features/__init__.py
index ca7a6f47f4..667ac3b86a 100644
--- a/src/sentry/features/__init__.py
+++ b/src/sentry/features/__init__.py
@@ -14,6 +14,7 @@ default_manager.add('organizations:onboarding', OrganizationFeature)  # NOQA
 default_manager.add('organizations:callsigns', OrganizationFeature)  # NOQA
 default_manager.add('organizations:repos', OrganizationFeature)  # NOQA
 default_manager.add('organizations:release-commits', OrganizationFeature)  # NOQA
+default_manager.add('organizations:similarity-view', OrganizationFeature)  # NOQA
 default_manager.add('projects:global-events', ProjectFeature)  # NOQA
 default_manager.add('projects:plugins', ProjectPluginFeature)  # NOQA
 default_manager.add('workflow:release-emails', ProjectFeature)  # NOQA
diff --git a/src/sentry/static/sentry/app/stores/configStore.jsx b/src/sentry/static/sentry/app/stores/configStore.jsx
index 71948967b3..eb3ba04769 100644
--- a/src/sentry/static/sentry/app/stores/configStore.jsx
+++ b/src/sentry/static/sentry/app/stores/configStore.jsx
@@ -37,4 +37,3 @@ const ConfigStore = Reflux.createStore({
 });
 
 export default ConfigStore;
-
diff --git a/src/sentry/static/sentry/app/views/groupDetails/header.jsx b/src/sentry/static/sentry/app/views/groupDetails/header.jsx
index 49051ad21c..7eb7a92886 100644
--- a/src/sentry/static/sentry/app/views/groupDetails/header.jsx
+++ b/src/sentry/static/sentry/app/views/groupDetails/header.jsx
@@ -10,6 +10,7 @@ import ListLink from '../../components/listLink';
 import ShortId from '../../components/shortId';
 import GroupTitle from '../../components/group/title';
 import ProjectState from '../../mixins/projectState';
+import ConfigStore from '../../stores/configStore';
 import {t} from '../../locale';
 
 const GroupHeader = React.createClass({
@@ -111,6 +112,8 @@ const GroupHeader = React.createClass({
 
     let message = this.getMessage();
 
+    let hasSimView = ConfigStore.getConfig().features.has('organizations:similarity-view');
+
     return (
       <div className={className}>
         <div className="row">
@@ -205,9 +208,10 @@ const GroupHeader = React.createClass({
           <ListLink to={`/${orgId}/${projectId}/issues/${groupId}/events/`}>
             {t('Related Events')}
           </ListLink>
+          {hasSimView &&
           <ListLink to={`/${orgId}/${projectId}/issues/${groupId}/similar/`}>
-            {t('Similar Issues')} <span className="badge animated">{'?'}</span>
-          </ListLink>
+            {t('Similar Issues')} <span className="badge">{'?'}</span>
+          </ListLink>}
         </ul>
       </div>
     );
diff --git a/src/sentry/templatetags/sentry_react.py b/src/sentry/templatetags/sentry_react.py
index 0cadfc16e4..1881e0f0a8 100644
--- a/src/sentry/templatetags/sentry_react.py
+++ b/src/sentry/templatetags/sentry_react.py
@@ -97,13 +97,16 @@ def get_react_config(context):
 
     if user:
         user = extract_lazy_object(user)
-
+    org = user.get_orgs()[0]  # TODO MAX awful hack
     enabled_features = []
     if features.has('organizations:create', actor=user):
         enabled_features.append('organizations:create')
     if features.has('auth:register', actor=user):
         enabled_features.append('auth:register')
 
+    if features.has('organizations:similarity-view', actor=user, organization=org):
+        enabled_features.append('organizations:similarity-view')
+
     version_info = _get_version_info()
 
     needs_upgrade = False
