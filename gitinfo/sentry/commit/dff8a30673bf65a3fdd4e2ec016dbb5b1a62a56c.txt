commit dff8a30673bf65a3fdd4e2ec016dbb5b1a62a56c
Author: Ben Vinegar <ben@benv.ca>
Date:   Tue Apr 5 22:46:39 2016 -0700

    Simplify searchBar escape/blur test to no longer use DOM ...
    
    This removes the "rendering components directly into document.body is discouraged" warning logged during tests.

diff --git a/tests/js/spec/views/stream/searchBar.spec.jsx b/tests/js/spec/views/stream/searchBar.spec.jsx
index a07e771de7..4dae6349ff 100644
--- a/tests/js/spec/views/stream/searchBar.spec.jsx
+++ b/tests/js/spec/views/stream/searchBar.spec.jsx
@@ -1,6 +1,4 @@
 import React from 'react';
-import ReactDOM from 'react-dom';
-import TestUtils from 'react-addons-test-utils';
 import {shallow, mount} from 'enzyme';
 
 import {Client} from 'app/api';
@@ -114,19 +112,15 @@ describe('SearchBar', function() {
   describe('onKeyUp()', function () {
     describe('escape', function () {
       it('blurs the input', function () {
-        // needs to be rendered into document.body or cannot query document.activeElement
-        let searchBar = ReactDOM.render(<SearchBar orgId="123" projectId="456"/>, document.body);
-        searchBar.state.dropdownVisible = true;
+        let wrapper = shallow(<SearchBar orgId="123" projectId="456"/>);
+        wrapper.setState({dropdownVisible: true});
 
-        let input = ReactDOM.findDOMNode(searchBar.refs.searchInput);
+        let instance = wrapper.instance();
+        this.sandbox.stub(instance, 'blur');
 
-        input.focus();
+        wrapper.find('input').simulate('keyup', {key: 'Escape', keyCode: '27'});
 
-        expect(document.activeElement).to.eql(input);
-
-        TestUtils.Simulate.keyUp(input, {key: 'Escape', keyCode: '27'});
-
-        expect(document.activeElement).to.not.eql(input);
+        expect(instance.blur.calledOnce).to.be.ok;
       });
     });
   });
