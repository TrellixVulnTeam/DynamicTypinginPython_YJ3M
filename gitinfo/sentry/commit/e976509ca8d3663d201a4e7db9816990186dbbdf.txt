commit e976509ca8d3663d201a4e7db9816990186dbbdf
Author: Katie Lundsgaard <katie@getsentry.com>
Date:   Wed Apr 26 14:53:26 2017 -0700

    Add last commit for a release to the release overview view (#5297)

diff --git a/src/sentry/static/sentry/app/components/commitAuthorStats.jsx b/src/sentry/static/sentry/app/components/commitAuthorStats.jsx
index 21c3adb1f9..3bfb98cee3 100644
--- a/src/sentry/static/sentry/app/components/commitAuthorStats.jsx
+++ b/src/sentry/static/sentry/app/components/commitAuthorStats.jsx
@@ -66,6 +66,13 @@ const CommitAuthorStats = React.createClass({
     });
   },
 
+  componentDidUpdate(prevProps, prevState) {
+    if (prevState.loading && !this.state.loading) {
+      this.removeTooltips();
+      this.attachTooltips();
+    }
+  },
+
   renderEmpty() {
     return <div className="box empty">{t('No authors in this release')}</div>;
   },
@@ -110,7 +117,11 @@ const CommitAuthorStats = React.createClass({
                 className="list-group-item list-group-item-sm list-group-avatar">
                 <div className="row row-flex row-center-vertically">
                   <div className="col-sm-8">
-                    <Avatar user={author} size={32} />
+                    <span
+                      className="avatar-grid-item m-b-0 tip"
+                      title={author.name + ' ' + author.email}>
+                      <Avatar user={author} size={32} />
+                    </span>
                     <CommitBar
                       totalCommits={commitList.length}
                       authorCommits={commitCount}
diff --git a/src/sentry/static/sentry/app/components/lastCommit.jsx b/src/sentry/static/sentry/app/components/lastCommit.jsx
new file mode 100644
index 0000000000..4e57cc8f28
--- /dev/null
+++ b/src/sentry/static/sentry/app/components/lastCommit.jsx
@@ -0,0 +1,58 @@
+import React from 'react';
+
+import Avatar from './avatar';
+import TimeSince from './timeSince';
+
+import {t} from '../locale';
+
+const LastCommit = React.createClass({
+  propTypes: {
+    commit: React.PropTypes.object.isRequired,
+    headerClass: React.PropTypes.string
+  },
+
+  renderMessage(message) {
+    if (!message) {
+      return t('No message provided');
+    }
+
+    let firstLine = message.split(/\n/)[0];
+    if (firstLine.length > 100) {
+      let truncated = firstLine.substr(0, 90);
+      let words = truncated.split(/ /);
+      // try to not have elipsis mid-word
+      if (words.length > 1) {
+        words.pop();
+        truncated = words.join(' ');
+      }
+      return truncated + '...';
+    }
+    return firstLine;
+  },
+
+  render() {
+    let {commit, headerClass} = this.props;
+    let commitAuthor = commit && commit.author;
+    return (
+      <div>
+        <h6 className={headerClass}>Last commit</h6>
+        <div className="commit">
+          <div className="commit-avatar">
+            <Avatar user={commitAuthor || {username: '?'}} />
+          </div>
+          <div className="commit-message truncate">
+            {this.renderMessage(commit.message)}
+          </div>
+          <div className="commit-meta">
+            <strong>
+              {(commitAuthor && commitAuthor.name) || t('Unknown Author')}
+            </strong>&nbsp;
+            <TimeSince date={commit.dateCreated} />
+          </div>
+        </div>
+      </div>
+    );
+  }
+});
+
+export default LastCommit;
diff --git a/src/sentry/static/sentry/app/components/versionHoverCard.jsx b/src/sentry/static/sentry/app/components/versionHoverCard.jsx
index 6b0025e826..a456c6cf44 100644
--- a/src/sentry/static/sentry/app/components/versionHoverCard.jsx
+++ b/src/sentry/static/sentry/app/components/versionHoverCard.jsx
@@ -3,6 +3,7 @@ import _ from 'underscore';
 
 import Avatar from './avatar';
 
+import LastCommit from './lastCommit';
 import LoadingIndicator from './loadingIndicator';
 import LoadingError from './loadingError';
 import TimeSince from './timeSince';
@@ -115,29 +116,10 @@ const VersionHoverCard = React.createClass({
     );
   },
 
-  renderMessage(message) {
-    if (!message) {
-      return t('No message provided');
-    }
-
-    if (message.length > 100) {
-      let truncated = message.substr(0, 90);
-      let words = truncated.split(' ');
-      // try to not have elipsis mid-word
-      if (words.length > 1) {
-        words.pop();
-        truncated = words.join(' ');
-      }
-      return truncated + '...';
-    }
-    return message;
-  },
-
   renderBody() {
     let {release, deploys} = this.state;
     let {version} = this.props;
     let lastCommit = release.lastCommit;
-    let commitAuthor = lastCommit && lastCommit.author;
     let shortVersion = getShortVersion(version);
 
     let recentDeploysByEnviroment = deploys.reduce(function(dbe, deploy) {
@@ -190,29 +172,7 @@ const VersionHoverCard = React.createClass({
               </div>
             </div>
           </div>
-          {lastCommit &&
-            <div>
-              <div className="divider">
-                <h6 className="commit-heading">Last commit</h6>
-              </div>
-              <div className="commit">
-                <div className="commit-avatar">
-                  <Avatar user={commitAuthor || {username: '?'}} />
-                </div>
-                <div className="commit-meta">
-                  <TimeSince
-                    date={lastCommit.dateCreated}
-                    className="pull-right text-light"
-                  />
-                  <strong>
-                    {(commitAuthor && commitAuthor.name) || t('Unknown Author')}
-                  </strong>
-                </div>
-                <div className="commit-message break-word">
-                  {this.renderMessage(lastCommit.message)}
-                </div>
-              </div>
-            </div>}
+          {lastCommit && <LastCommit commit={lastCommit} headerClass="commit-heading" />}
           {deploys.length > 0 &&
             <div>
               <div className="divider">
diff --git a/src/sentry/static/sentry/app/views/releases/releaseOverview.jsx b/src/sentry/static/sentry/app/views/releases/releaseOverview.jsx
index bce560be20..36ed11f9d2 100644
--- a/src/sentry/static/sentry/app/views/releases/releaseOverview.jsx
+++ b/src/sentry/static/sentry/app/views/releases/releaseOverview.jsx
@@ -3,6 +3,7 @@ import React from 'react';
 import LoadingIndicator from '../../components/loadingIndicator';
 import LoadingError from '../../components/loadingError';
 import IconOpen from '../../icons/icon-open';
+import LastCommit from '../../components/lastCommit';
 import IssueList from '../../components/issueList';
 import CommitAuthorStats from '../../components/commitAuthorStats';
 import ReleaseProjectStatSparkline from '../../components/releaseProjectStatSparkline';
@@ -14,6 +15,10 @@ import ApiMixin from '../../mixins/apiMixin';
 import {t} from '../../locale';
 
 const ReleaseOverview = React.createClass({
+  contextTypes: {
+    release: React.PropTypes.object
+  },
+
   mixins: [ApiMixin],
 
   getInitialState() {
@@ -111,6 +116,8 @@ const ReleaseOverview = React.createClass({
 
   render() {
     let {orgId, projectId, version} = this.props.params;
+    let {release} = this.context;
+    let lastCommit = release.lastCommit;
 
     if (this.state.loading) return <LoadingIndicator />;
 
@@ -192,6 +199,8 @@ const ReleaseOverview = React.createClass({
           <div className="col-sm-4">
             {hasRepos
               ? <div>
+                  {lastCommit &&
+                    <LastCommit commit={lastCommit} headerClass="nav-header" />}
                   <CommitAuthorStats
                     orgId={orgId}
                     projectId={projectId}
diff --git a/src/sentry/static/sentry/less/releases.less b/src/sentry/static/sentry/less/releases.less
index 258cc6cc36..16d4a78a7a 100644
--- a/src/sentry/static/sentry/less/releases.less
+++ b/src/sentry/static/sentry/less/releases.less
@@ -130,4 +130,33 @@
   .dropdown-menu {
     top: -4px;
   }
+}
+
+/**
+* Last Commit in Release Overview
+* ============================================================================
+*/
+
+.commit {
+  margin-top: 5px;
+  margin-bottom: 20px;
+  position: relative;
+  padding: 1px 0 0 25px;
+  font-size: 13px;
+
+  .commit-avatar {
+    position: absolute;
+    .square(19px);
+    top: 2px;
+    left: 0;
+
+    .avatar {
+      .square(19px);
+    }
+  }
+
+  .commit-message {
+    line-height: 1.4;
+    margin: 2px 0 5px;
+  }
 }
\ No newline at end of file
diff --git a/src/sentry/static/sentry/less/sentry-hovercard.less b/src/sentry/static/sentry/less/sentry-hovercard.less
index ceaddcca1c..6facdf25a7 100644
--- a/src/sentry/static/sentry/less/sentry-hovercard.less
+++ b/src/sentry/static/sentry/less/sentry-hovercard.less
@@ -73,6 +73,39 @@
   .hovercard-body {
     padding: @hovercard-padding;
     min-height: 74px;
+
+    .commit-heading {
+      margin: 10px 0;
+    }
+
+    .commit {
+      margin-top: 5px;
+      margin-bottom: 0;
+      position: relative;
+      padding: 1px 0 0 25px;
+      font-size: 13px;
+
+      .commit-avatar {
+        position: absolute;
+        .square(19px);
+        top: 2px;
+        left: 0;
+
+        .avatar {
+          .square(19px);
+        }
+      }
+
+      .commit-message {
+        line-height: 1.4;
+        margin: 2px 0 5px;
+      }
+
+      .commit-meta {
+        font-size: 12px;
+        color: @70;
+      }
+    }
   }
 
   .divider {
@@ -132,42 +165,6 @@
     }
   }
 
-  .commit-heading {
-    margin: 10px 0;
-  }
-
-  .commit {
-    margin-top: 5px;
-    position: relative;
-    padding: 1px 0 0 38px;
-    font-size: 13px;
-
-    .commit-avatar {
-      position: absolute;
-      .square(30px);
-      top: 1px;
-      left: 0;
-
-      .avatar {
-        .square(30px);
-      }
-    }
-
-    .commit-message {
-      line-height: 1.4;
-      margin: 2px 0 5px;
-    }
-
-    .commit-meta {
-      font-size: 12px;
-      color: @70;
-
-      strong {
-        color: @gray-dark;
-      }
-    }
-  }
-
   .deploy-heading {
     margin: 10px 0;
   }
