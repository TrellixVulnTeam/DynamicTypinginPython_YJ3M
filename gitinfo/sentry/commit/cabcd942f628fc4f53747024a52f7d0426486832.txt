commit cabcd942f628fc4f53747024a52f7d0426486832
Author: David Cramer <dcramer@gmail.com>
Date:   Wed May 28 20:06:49 2014 -0700

    Add tests for freq sort

diff --git a/tests/sentry/search/django/tests.py b/tests/sentry/search/django/tests.py
index 159d8cdb6e..c451c61663 100644
--- a/tests/sentry/search/django/tests.py
+++ b/tests/sentry/search/django/tests.py
@@ -24,6 +24,7 @@ class DjangoSearchBackendTest(TestCase):
             project=self.project1,
             checksum='a' * 40,
             message='foo',
+            times_seen=5,
             status=STATUS_UNRESOLVED,
             last_seen=datetime(2013, 8, 13, 3, 8, 24, 880386),
             first_seen=datetime(2013, 7, 13, 3, 8, 24, 880386),
@@ -41,6 +42,7 @@ class DjangoSearchBackendTest(TestCase):
             project=self.project1,
             checksum='b' * 40,
             message='bar',
+            times_seen=10,
             status=STATUS_RESOLVED,
             last_seen=datetime(2013, 7, 14, 3, 8, 24, 880386),
             first_seen=datetime(2013, 7, 14, 3, 8, 24, 880386),
@@ -95,6 +97,11 @@ class DjangoSearchBackendTest(TestCase):
         assert results[0] == self.group2
         assert results[1] == self.group1
 
+        results = self.backend.query(self.project1, sort_by='freq')
+        assert len(results) == 2
+        assert results[0] == self.group2
+        assert results[1] == self.group1
+
     def test_status(self):
         results = self.backend.query(self.project1, status=STATUS_UNRESOLVED)
         assert len(results) == 1
diff --git a/tests/sentry/search/elastic_search/test_backend.py b/tests/sentry/search/elastic_search/test_backend.py
index d1aceac9c9..81015f77f8 100644
--- a/tests/sentry/search/elastic_search/test_backend.py
+++ b/tests/sentry/search/elastic_search/test_backend.py
@@ -39,6 +39,7 @@ class ElasticSearchTest(TestCase):
             project=self.project1,
             checksum='a' * 40,
             message='foo',
+            times_seen=5,
             status=STATUS_UNRESOLVED,
             last_seen=datetime(2013, 8, 13, 3, 8, 24, 880386),
             first_seen=datetime(2013, 7, 13, 3, 8, 24, 880386),
@@ -56,6 +57,7 @@ class ElasticSearchTest(TestCase):
             project=self.project1,
             checksum='b' * 40,
             message='bar',
+            times_seen=10,
             status=STATUS_RESOLVED,
             last_seen=datetime(2013, 7, 14, 3, 8, 24, 880386),
             first_seen=datetime(2013, 7, 14, 3, 8, 24, 880386),
@@ -112,6 +114,11 @@ class ElasticSearchTest(TestCase):
         assert results[0] == self.group2
         assert results[1] == self.group1
 
+        results = self.backend.query(self.project1, sort_by='freq')
+        assert len(results) == 2
+        assert results[0] == self.group2
+        assert results[1] == self.group1
+
     def test_status(self):
         results = self.backend.query(self.project1, status=STATUS_UNRESOLVED)
         assert len(results) == 1
