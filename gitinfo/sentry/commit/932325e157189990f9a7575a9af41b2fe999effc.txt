commit 932325e157189990f9a7575a9af41b2fe999effc
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Aug 17 12:36:00 2016 -0700

    Allow rich data in contexts
    
    @getsentry/infrastructure @mitsuhiko @bentlegen

diff --git a/src/sentry/interfaces/contexts.py b/src/sentry/interfaces/contexts.py
index ff2c1aa7e0..651f77dee5 100644
--- a/src/sentry/interfaces/contexts.py
+++ b/src/sentry/interfaces/contexts.py
@@ -19,8 +19,6 @@ from sentry.interfaces.base import Interface
 
 __all__ = ('Contexts',)
 
-EMPTY_VALUES = frozenset(('', None))
-
 context_types = {}
 
 
@@ -52,7 +50,9 @@ class ContextType(object):
         self.alias = alias
         ctx_data = {}
         for key, value in six.iteritems(trim(data)):
-            if value not in EMPTY_VALUES:
+            # we use simple checks here, rathern than ' in set()' to avoid
+            # issues with maps/lists
+            if value is not None and value != '':
                 ctx_data[force_text(key)] = value
         self.data = ctx_data
 
diff --git a/tests/sentry/interfaces/test_contexts.py b/tests/sentry/interfaces/test_contexts.py
index 6246f13e5c..274d4cc1f8 100644
--- a/tests/sentry/interfaces/test_contexts.py
+++ b/tests/sentry/interfaces/test_contexts.py
@@ -108,6 +108,8 @@ class ContextsTest(TestCase):
             'whatever': {
                 'foo': 'bar',
                 'blub': 'blah',
+                'biz': [1, 2, 3],
+                'baz': {'foo': 'bar'},
             },
         })
         assert sorted(ctx.iter_tags()) == []
@@ -116,6 +118,8 @@ class ContextsTest(TestCase):
                 'type': 'default',
                 'foo': 'bar',
                 'blub': 'blah',
+                'biz': [1, 2, 3],
+                'baz': {'foo': 'bar'},
             }
         }
 
