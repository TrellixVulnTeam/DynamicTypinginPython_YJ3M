commit 6e50c690ae6838d0b7d51f4afe388bff59742097
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Jan 26 15:45:21 2013 -0800

    Remove excess javascript

diff --git a/src/sentry/static/sentry/scripts/sentry.core.js b/src/sentry/static/sentry/scripts/sentry.core.js
index 9e1e34e6a7..16ff76a19b 100644
--- a/src/sentry/static/sentry/scripts/sentry.core.js
+++ b/src/sentry/static/sentry/scripts/sentry.core.js
@@ -19,96 +19,6 @@ if (Sentry === undefined) {
 
     var $ = jQuery;
 
-    Sentry.prettyDate = function(date_str) {
-        // we need to zero out at CST
-        var time = Date.parse(date_str);
-        var now = new Date();
-        var now_utc = Date.UTC(
-            now.getUTCFullYear(),
-            now.getUTCMonth(),
-            now.getUTCDate(),
-            now.getUTCHours(),
-            now.getUTCMinutes(),
-            now.getUTCSeconds()
-        );
-
-        var seconds = (now_utc - time) / 1000;
-        // var offset = (new Date().getTimezoneOffset() - 300) * 60;
-        // seconds = seconds + offset;
-        var token = 'ago';
-        var time_formats = [
-          [60, 'just now', 'just now'], // 60
-          [120, '1 minute ago', '1 minute from now'], // 60*2
-          [3600, 'minutes', 60], // 60*60, 60
-          [7200, '1 hour ago', '1 hour from now'], // 60*60*2
-          [86400, 'hours', 3600], // 60*60*24, 60*60
-          [172800, 'yesterday', 'tomorrow'], // 60*60*24*2
-          [604800, 'days', 86400], // 60*60*24*7, 60*60*24
-          [1209600, 'last week', 'next week'], // 60*60*24*7*4*2
-          [2419200, 'weeks', 604800], // 60*60*24*7*4, 60*60*24*7
-          [4838400, 'last month', 'next month'], // 60*60*24*7*4*2
-          [29030400, 'months', 2419200], // 60*60*24*7*4*12, 60*60*24*7*4
-          [58060800, 'last year', 'next year'], // 60*60*24*7*4*12*2
-          [2903040000, 'years', 29030400], // 60*60*24*7*4*12*100, 60*60*24*7*4*12
-          [5806080000, 'last century', 'next century'], // 60*60*24*7*4*12*100*2
-          [58060800000, 'centuries', 2903040000] // 60*60*24*7*4*12*100*20, 60*60*24*7*4*12*100
-        ];
-        var list_choice = 1;
-
-        if (seconds < 0)
-        {
-            seconds = Math.abs(seconds);
-            token = 'from now';
-            list_choice = 2;
-        }
-
-        for (var i=0, format; (format = time_formats[i]); i++) {
-            if (seconds < format[0])
-            {
-                if (typeof format[2] == 'string')
-                    return format[list_choice];
-                else
-                    return Math.floor(seconds / format[2]) + ' ' + format[1] + ' ' + token;
-            }
-        }
-        return time;
-    };
-
-    Sentry.prettyDates = function() {
-        $('.pretty-date').each(function(_, el){
-            var $el = $(el);
-            var title = $el.attr('title');
-            if (title) {
-                var date = Sentry.prettyDate(title);
-                if (date) {
-                    $el.text(date);
-                }
-            }
-        });
-    };
-
-    Sentry.toggle = function(el){
-      var $el = $(el);
-      $el.toggle();
-    };
-
-    Sentry.getQueryParams = function() {
-        var vars = {}, hash;
-        var href = window.location.href;
-        if (href.indexOf('?') === -1) {
-          return vars;
-        }
-        var hashes = href.slice(href.indexOf('?') + 1, (href.indexOf('#') !== -1 ? href.indexOf('#') : href.length)).split('&');
-        $.each(hashes, function(_, chunk){
-            hash = chunk.split('=');
-            if (!hash[0] && !hash[1]) {
-              return;
-            }
-            vars[hash[0]] = hash[1] ? decodeURIComponent(hash[1]).replace(/\+/, ' ') : '';
-        });
-        return vars;
-    };
-
     $(document).ready(function(){
         // replace text inputs with remote select2 widgets
         $('.filter').each(function(_, el){
@@ -152,16 +62,12 @@ if (Sentry === undefined) {
             }
             if ($input.length) {
                 $input.on('change', function(e){
-                    var query = Sentry.getQueryParams();
+                    var query = app.utils.getQueryParams();
                     query[e.target.name] = e.val;
                     window.location.href = '?' + $.param(query);
                 });
             }
         });
-
-        // Update date strings periodically
-        setInterval(Sentry.prettyDates, 5000);
-        Sentry.prettyDates();
     });
 
     $(document).ajaxSend(function(event, xhr, settings) {
diff --git a/src/sentry/static/sentry/scripts/utils.js b/src/sentry/static/sentry/scripts/utils.js
index b31563f86b..66e90a37b8 100644
--- a/src/sentry/static/sentry/scripts/utils.js
+++ b/src/sentry/static/sentry/scripts/utils.js
@@ -124,9 +124,23 @@
 
     };
 
-    // initialize
     $(function(){
+        // Change all select boxes to select2 elements.
         $('select').select2({width: 'element'});
+
+        // Update date strings periodically
+        setInterval(function() {
+            $('.pretty-date').each(function(_, el){
+                var $el = $(el);
+                var title = $el.attr('title');
+                if (title) {
+                    var date = app.utils.prettyDate(title);
+                    if (date) {
+                        $el.text(date);
+                    }
+                }
+            });
+        }, 5000);
     });
 
 }(app, jQuery));
diff --git a/src/sentry/templates/sentry/groups/group_list.html b/src/sentry/templates/sentry/groups/group_list.html
index c1c49c2bfe..934f7ed6e3 100644
--- a/src/sentry/templates/sentry/groups/group_list.html
+++ b/src/sentry/templates/sentry/groups/group_list.html
@@ -81,7 +81,7 @@
             </ul>
         </div>
         <div class="btn-group">
-            <a href="#" class="btn dropdown-toggle" onclick="Sentry.toggle('#daterange');">
+            <a href="#" class="btn dropdown-toggle" onclick="$('#daterange').toggle();">
                 {% if from_date %}
                     {% if not to_date %}
                         Since: {{ from_date|date:"M jS" }}
