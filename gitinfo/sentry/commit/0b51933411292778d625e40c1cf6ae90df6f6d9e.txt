commit 0b51933411292778d625e40c1cf6ae90df6f6d9e
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Mar 3 17:11:55 2015 -0800

    First semi-working pass at pagination

diff --git a/src/sentry/static/sentry/app/utils.jsx b/src/sentry/static/sentry/app/utils.jsx
index 2369fb826b..4533490ec9 100644
--- a/src/sentry/static/sentry/app/utils.jsx
+++ b/src/sentry/static/sentry/app/utils.jsx
@@ -35,12 +35,13 @@ module.exports = {
         links = {};
 
     header_vals.forEach((val) => {
-      var match = /<([^>]+)>; rel="([^"]+)"(?:; results="([^"]+)")?/g.exec(val);
+      var match = /<([^>]+)>; rel="([^"]+)"(?:; results="([^"]+)")?(?:; cursor="([^"]+)")?/g.exec(val);
       var hasResults = (match[3] === 'true' ? true : (match[3] === 'false' ? false : null));
 
       links[match[2]] = {
         href: match[1],
-        results: hasResults
+        results: hasResults,
+        cursor: match[4]
       };
     });
 
diff --git a/src/sentry/static/sentry/app/views/groupEvents.jsx b/src/sentry/static/sentry/app/views/groupEvents.jsx
index f9ecdf16d0..7dd70fb112 100644
--- a/src/sentry/static/sentry/app/views/groupEvents.jsx
+++ b/src/sentry/static/sentry/app/views/groupEvents.jsx
@@ -1,9 +1,10 @@
 /*** @jsx React.DOM */
 
 var React = require("react");
-var {Link} = require("react-router");
+var Router = require("react-router");
 
 var api = require("../api");
+var GroupEventsPagination = require("./groupEvents/pagination");
 var GroupState = require("../mixins/groupState");
 var LoadingError = require("../components/loadingError");
 var LoadingIndicator = require("../components/loadingIndicator");
@@ -11,13 +12,14 @@ var PropTypes = require("../proptypes");
 var TimeSince = require("../components/timeSince");
 
 var GroupEvents = React.createClass({
-  mixins: [GroupState],
+  mixins: [GroupState, Router.Navigation, Router.State],
 
   getInitialState() {
     return {
       eventList: [],
       loading: true,
-      error: false
+      error: false,
+      pageLinks: '',
     };
   },
 
@@ -26,17 +28,21 @@ var GroupEvents = React.createClass({
   },
 
   fetchData() {
+    var queryParams = this.getQuery();
+    var querystring = $.param(queryParams);
+
     this.setState({
       loading: true,
       error: false
     });
 
-    api.request('/groups/' + this.getGroup().id + '/events/', {
-      success: (data) => {
+    api.request('/groups/' + this.getGroup().id + '/events/?' + querystring, {
+      success: (data, _, jqXHR) => {
         this.setState({
           eventList: data,
           error: false,
-          loading: false
+          loading: false,
+          pageLinks: jqXHR.getResponseHeader('Link')
         });
       },
       error: (error) => {
@@ -66,11 +72,11 @@ var GroupEvents = React.createClass({
       return (
         <tr key={eventIdx}>
           <td>
-            <Link to="groupEventDetails"
-                  params={linkParams}>{event.message}</Link>
+            <Router.Link to="groupEventDetails"
+                  params={linkParams}>{event.message}</Router.Link>
             <br />
-            <small className="tagList">{event.tags.map((tag) => {
-              return <span>{tag[0]} = {tag[1]}</span>;
+            <small className="tagList">{event.tags.map((tag, tagIdx) => {
+              return <span key={tagIdx}>{tag[0]} = {tag[1]}</span>;
             })}</small>
           </td>
           <td>
@@ -81,9 +87,13 @@ var GroupEvents = React.createClass({
     });
 
     return (
-      <table className="table">
-        {children}
-      </table>
+      <div>
+        <table className="table">
+          {children}
+        </table>
+
+        <GroupEventsPagination pageLinks={this.state.pageLinks} />
+      </div>
     );
   }
 });
diff --git a/src/sentry/static/sentry/app/views/groupEvents/pagination.jsx b/src/sentry/static/sentry/app/views/groupEvents/pagination.jsx
new file mode 100644
index 0000000000..91175c7a9a
--- /dev/null
+++ b/src/sentry/static/sentry/app/views/groupEvents/pagination.jsx
@@ -0,0 +1,57 @@
+/*** @jsx React.DOM */
+var React = require("react");
+var Router = require("react-router");
+
+var utils = require("../../utils");
+
+var GroupEventsPagination = React.createClass({
+  mixins: [Router.Navigation, Router.State],
+
+  propTypes: {
+    pageLinks: React.PropTypes.string.isRequired,
+  },
+
+  onPage(cursor) {
+    var queryParams = this.getQuery();
+    queryParams.cursor = cursor;
+
+    this.transitionTo('groupEvents', this.getParams(), queryParams);
+  },
+
+  render(){
+    if (!this.props.pageLinks) {
+      return <div />;
+    }
+
+    var links = utils.parseLinkHeader(this.props.pageLinks);
+
+    var previousPageClassName = 'btn btn-default btn-lg prev';
+    if (links.previous.results === false) {
+      previousPageClassName += ' disabled';
+    }
+
+    var nextPageClassName = 'btn btn-default btn-lg next';
+    if (links.next.results === false) {
+      nextPageClassName += ' disabled';
+    }
+
+    return (
+      <div className="stream-pagination">
+        <div className="btn-group pull-right">
+          <a className={previousPageClassName}
+             disabled={links.previous.results === false}
+             onClick={this.onPage.bind(this, links.previous.cursor)}>
+            <span title="Previous" className="icon-arrow-left"></span>
+          </a>
+          <a className={nextPageClassName}
+             disabled={links.next.results === false}
+             onClick={this.onPage.bind(this, links.next.cursor)}>
+            <span title="Next" className="icon-arrow-right"></span>
+          </a>
+        </div>
+      </div>
+    );
+  }
+});
+
+module.exports = GroupEventsPagination;
diff --git a/src/sentry/static/sentry/app/views/stream.jsx b/src/sentry/static/sentry/app/views/stream.jsx
index 0b2dd3daa4..fbb4feb1d7 100644
--- a/src/sentry/static/sentry/app/views/stream.jsx
+++ b/src/sentry/static/sentry/app/views/stream.jsx
@@ -214,7 +214,6 @@ var Stream = React.createClass({
           </ul>
         )}
         <StreamPagination
-          groupList={this.state.groupList}
           pageLinks={this.state.pageLinks} />
       </div>
     );
diff --git a/src/sentry/static/sentry/app/views/stream/pagination.jsx b/src/sentry/static/sentry/app/views/stream/pagination.jsx
index 23c3ed8888..6433eab78b 100644
--- a/src/sentry/static/sentry/app/views/stream/pagination.jsx
+++ b/src/sentry/static/sentry/app/views/stream/pagination.jsx
@@ -1,16 +1,25 @@
 /*** @jsx React.DOM */
 var React = require("react");
+var Router = require("react-router");
 
 var utils = require("../../utils");
 
 var StreamPagination = React.createClass({
+  mixins: [Router.Navigation, Router.State],
+
   propTypes: {
-    groupList: React.PropTypes.instanceOf(Array).isRequired,
     pageLinks: React.PropTypes.string.isRequired
   },
 
+  onPage(cursor) {
+    var queryParams = this.getQuery();
+    queryParams.cursor = cursor;
+
+    this.transitionTo('stream', this.getParams(), queryParams);
+  },
+
   render: function(){
-    if (!this.props.pageLinks || this.props.groupList.length === 0) {
+    if (!this.props.pageLinks) {
       return <div />;
     }
 
@@ -31,12 +40,12 @@ var StreamPagination = React.createClass({
         <div className="btn-group pull-right">
           <a className={previousPageClassName}
              disabled={links.previous.results === false}
-             href={links.previous.href}>
+             onClick={this.onPage.bind(this, links.previous.cursor)}>
             <span title="Previous" className="icon-arrow-left"></span>
           </a>
           <a className={nextPageClassName}
              disabled={links.next.results === false}
-             href={links.next.href}>
+             onClick={this.onPage.bind(this, links.next.cursor)}>
             <span title="Next" className="icon-arrow-right"></span>
           </a>
         </div>
