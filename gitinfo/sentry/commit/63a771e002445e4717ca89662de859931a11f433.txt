commit 63a771e002445e4717ca89662de859931a11f433
Author: Mark Story <mark@sentry.io>
Date:   Thu Jun 4 10:12:24 2020 -0400

    ref(ts) Convert ProjectBadge to typescript (#19161)
    
    I had to make a few small logic/typing changes but I think they are low
    risk changes.

diff --git a/src/sentry/static/sentry/app/components/idBadge/projectBadge.jsx b/src/sentry/static/sentry/app/components/idBadge/projectBadge.jsx
deleted file mode 100644
index 5697c488ab..0000000000
--- a/src/sentry/static/sentry/app/components/idBadge/projectBadge.jsx
+++ /dev/null
@@ -1,37 +0,0 @@
-import React from 'react';
-import PropTypes from 'prop-types';
-
-import BaseBadge from 'app/components/idBadge/baseBadge';
-import BadgeDisplayName from 'app/components/idBadge/badgeDisplayName';
-
-export default class ProjectBadge extends React.PureComponent {
-  static propTypes = {
-    ...BaseBadge.propTypes,
-    project: BaseBadge.propTypes.project.isRequired,
-    avatarSize: PropTypes.number,
-    /**
-     * If true, will use default max-width, or specify one as a string
-     */
-    hideOverflow: PropTypes.oneOfType([PropTypes.bool, PropTypes.string]),
-    hideAvatar: PropTypes.bool,
-  };
-
-  static defaultProps = {
-    hideAvatar: false,
-    hideOverflow: true,
-  };
-
-  render() {
-    const {hideOverflow, project, ...props} = this.props;
-
-    return (
-      <BaseBadge
-        displayName={
-          <BadgeDisplayName hideOverflow={hideOverflow}>{project.slug}</BadgeDisplayName>
-        }
-        project={project}
-        {...props}
-      />
-    );
-  }
-}
diff --git a/src/sentry/static/sentry/app/components/idBadge/projectBadge.tsx b/src/sentry/static/sentry/app/components/idBadge/projectBadge.tsx
new file mode 100644
index 0000000000..816a6a338f
--- /dev/null
+++ b/src/sentry/static/sentry/app/components/idBadge/projectBadge.tsx
@@ -0,0 +1,50 @@
+import React from 'react';
+import PropTypes from 'prop-types';
+
+import {AvatarProject} from 'app/types';
+import BaseBadge from 'app/components/idBadge/baseBadge';
+import BadgeDisplayName from 'app/components/idBadge/badgeDisplayName';
+
+type Props = {
+  project: AvatarProject;
+  avatarSize?: number;
+  className?: string;
+  hideOverflow?: boolean | string;
+  // Inherited from BaseBadge
+  hideAvatar?: boolean;
+  displayName?: React.ReactNode;
+  description?: React.ReactNode;
+  hideName?: boolean;
+  avatarClassName?: string;
+};
+
+function ProjectBadge({
+  hideOverflow = true,
+  hideAvatar = false,
+  project,
+  ...props
+}: Props) {
+  return (
+    <BaseBadge
+      displayName={
+        <BadgeDisplayName hideOverflow={hideOverflow}>{project.slug}</BadgeDisplayName>
+      }
+      project={project}
+      hideAvatar={hideAvatar}
+      {...props}
+    />
+  );
+}
+
+ProjectBadge.propTypes = {
+  ...BaseBadge.propTypes,
+  project: BaseBadge.propTypes.project.isRequired,
+  avatarSize: PropTypes.number,
+  /**
+   * If true, will use default max-width, or specify one as a string
+   */
+  hideOverflow: PropTypes.oneOfType([PropTypes.bool, PropTypes.string]),
+  hideAvatar: PropTypes.bool,
+};
+
+export default ProjectBadge;
diff --git a/src/sentry/static/sentry/app/types/index.tsx b/src/sentry/static/sentry/app/types/index.tsx
index d4cbf9f4c7..c83d799961 100644
--- a/src/sentry/static/sentry/app/types/index.tsx
+++ b/src/sentry/static/sentry/app/types/index.tsx
@@ -921,8 +921,8 @@ export type ReleaseProject = {
   slug: string;
   name: string;
   id: number;
-  platform: string;
-  platforms: string[];
+  platform: PlatformKey;
+  platforms: PlatformKey[];
   newGroups: number;
   healthData?: Health;
 };
diff --git a/src/sentry/static/sentry/app/utils/projects.tsx b/src/sentry/static/sentry/app/utils/projects.tsx
index 7e9a6ee143..cc537bf40a 100644
--- a/src/sentry/static/sentry/app/utils/projects.tsx
+++ b/src/sentry/static/sentry/app/utils/projects.tsx
@@ -5,7 +5,7 @@ import partition from 'lodash/partition';
 import uniqBy from 'lodash/uniqBy';
 
 import {Client} from 'app/api';
-import {Project} from 'app/types';
+import {Project, AvatarProject} from 'app/types';
 import {defined} from 'app/utils';
 import ProjectActions from 'app/actions/projectActions';
 import ProjectsStore from 'app/stores/projectsStore';
@@ -15,9 +15,7 @@ import parseLinkHeader from 'app/utils/parseLinkHeader';
 import withApi from 'app/utils/withApi';
 import withProjects from 'app/utils/withProjects';
 
-type ProjectPlaceholder = {
-  slug: string;
-};
+type ProjectPlaceholder = AvatarProject;
 
 type State = {
   /**
diff --git a/src/sentry/static/sentry/app/views/alerts/details/header.tsx b/src/sentry/static/sentry/app/views/alerts/details/header.tsx
index 464a1a66eb..a0492ef4db 100644
--- a/src/sentry/static/sentry/app/views/alerts/details/header.tsx
+++ b/src/sentry/static/sentry/app/views/alerts/details/header.tsx
@@ -124,12 +124,11 @@ export default class DetailsHeader extends React.Component<Props> {
               <ItemValue>
                 {project && (
                   <Projects slugs={[project]} orgId={params.orgId}>
-                    {({projects}) => (
-                      <ProjectBadge
-                        avatarSize={18}
-                        project={projects && projects.length && projects[0]}
-                      />
-                    )}
+                    {({projects}) =>
+                      projects?.length && (
+                        <ProjectBadge avatarSize={18} project={projects[0]} />
+                      )
+                    }
                   </Projects>
                 )}
               </ItemValue>
diff --git a/tests/js/spec/views/organizationGroupDetails/__snapshots__/groupSimilar.spec.jsx.snap b/tests/js/spec/views/organizationGroupDetails/__snapshots__/groupSimilar.spec.jsx.snap
index ba01d1fba9..e45cb04e34 100644
--- a/tests/js/spec/views/organizationGroupDetails/__snapshots__/groupSimilar.spec.jsx.snap
+++ b/tests/js/spec/views/organizationGroupDetails/__snapshots__/groupSimilar.spec.jsx.snap
@@ -1278,9 +1278,7 @@ exports[`Issues Similar View renders with mocked data 1`] = `
                                     avatar={
                                       <ProjectBadge
                                         avatarSize={14}
-                                        hideAvatar={false}
                                         hideName={true}
-                                        hideOverflow={true}
                                         project={
                                           Object {
                                             "id": "123",
@@ -1296,9 +1294,7 @@ exports[`Issues Similar View renders with mocked data 1`] = `
                                       avatar={
                                         <ProjectBadge
                                           avatarSize={14}
-                                          hideAvatar={false}
                                           hideName={true}
-                                          hideOverflow={true}
                                           project={
                                             Object {
                                               "id": "123",
@@ -1315,9 +1311,7 @@ exports[`Issues Similar View renders with mocked data 1`] = `
                                         avatar={
                                           <ProjectBadge
                                             avatarSize={14}
-                                            hideAvatar={false}
                                             hideName={true}
-                                            hideOverflow={true}
                                             project={
                                               Object {
                                                 "id": "123",
@@ -1337,9 +1331,7 @@ exports[`Issues Similar View renders with mocked data 1`] = `
                                         >
                                           <ProjectBadge
                                             avatarSize={14}
-                                            hideAvatar={false}
                                             hideName={true}
-                                            hideOverflow={true}
                                             project={
                                               Object {
                                                 "id": "123",
diff --git a/tests/js/spec/views/projectsDashboard/__snapshots__/projectCard.spec.jsx.snap b/tests/js/spec/views/projectsDashboard/__snapshots__/projectCard.spec.jsx.snap
index 5f9a2bca41..eb009809e1 100644
--- a/tests/js/spec/views/projectsDashboard/__snapshots__/projectCard.spec.jsx.snap
+++ b/tests/js/spec/views/projectsDashboard/__snapshots__/projectCard.spec.jsx.snap
@@ -161,8 +161,6 @@ exports[`ProjectCard renders 1`] = `
                             project-slug
                           </span>
                         }
-                        hideAvatar={false}
-                        hideOverflow={true}
                         project={
                           Object {
                             "environments": Array [],
