commit a22a77906ccffb1133954ea5390c0256d05a62ca
Author: Filippo Pacifici <fpacifici@sentry.io>
Date:   Thu Nov 14 09:26:58 2019 -0800

    Upgrade Clickhouse in dev and CI (#15590)
    
    dev environment and CI are using a quite old version of Clickhouse. Upgrading it to 19.11

diff --git a/.travis.yml b/.travis.yml
index 33ac829583..b2d5e3e565 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -78,7 +78,7 @@ base_postgres: &postgres_default
     - postgresql
   before_install:
     - *pip_install
-    - docker run -d --network host --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server:19.4
+    - docker run -d --network host --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server:19.11
     - docker run -d --network host --name snuba --env SNUBA_SETTINGS=test --env CLICKHOUSE_SERVER=localhost:9000 getsentry/snuba
     - docker ps -a
   install:
@@ -98,7 +98,7 @@ base_acceptance: &acceptance_default
     - *pip_install
     - find "$NODE_DIR" -type d -empty -delete
     - nvm install
-    - docker run -d --network host --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server:19.4
+    - docker run -d --network host --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server:19.11
     - docker run -d --network host --name snuba --env SNUBA_SETTINGS=test --env CLICKHOUSE_SERVER=localhost:9000 getsentry/snuba
     - docker ps -a
   install:
@@ -217,7 +217,7 @@ matrix:
       name: 'Symbolicator Integration'
       env: TEST_SUITE=symbolicator
       before_install:
-        - docker run -d --network host --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server:19.4
+        - docker run -d --network host --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server:19.11
         - docker run -d --network host --name snuba --env SNUBA_SETTINGS=test --env CLICKHOUSE_SERVER=localhost:9000 getsentry/snuba
         - docker run -d --network host --name symbolicator us.gcr.io/sentryio/symbolicator:latest run
         - docker ps -a
@@ -234,7 +234,7 @@ matrix:
         - *pip_install
         - docker run -d --network host --name zookeeper -e ZOOKEEPER_CLIENT_PORT=2181 confluentinc/cp-zookeeper:4.1.0
         - docker run -d --network host --name kafka -e KAFKA_ZOOKEEPER_CONNECT=localhost:2181 -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://localhost:9092 -e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 confluentinc/cp-kafka:4.1.0
-        - docker run -d --network host --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server:19.4
+        - docker run -d --network host --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server:19.11
         - docker run -d --network host --name snuba --env SNUBA_SETTINGS=test --env CLICKHOUSE_SERVER=localhost:9000 getsentry/snuba
         - docker ps -a
       install:
diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 003ce68243..4bc1528ae0 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -1336,7 +1336,7 @@ SENTRY_DEVSERVICES = {
         "volumes": {"kafka": {"bind": "/var/lib/kafka"}},
     },
     "clickhouse": {
-        "image": "yandex/clickhouse-server:19.3",
+        "image": "yandex/clickhouse-server:19.11",
         "ports": {"9000/tcp": 9000, "9009/tcp": 9009, "8123/tcp": 8123},
         "ulimits": [{"name": "nofile", "soft": 262144, "hard": 262144}],
         "volumes": {"clickhouse": {"bind": "/var/lib/clickhouse"}},
