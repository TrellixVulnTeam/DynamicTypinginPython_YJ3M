commit 9780169badfd6e6a105274ca2c9af88a3664ca5e
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Wed Apr 10 09:46:49 2019 -0700

    feat(discover): Improve validation messages (#12708)
    
    Return a proper validation message if no fields or aggregations are
    supplied by the user. Whilst this won't ever happen using the Discover
    UI some users are now accessing the Discover API directly, so this will
    help provide more useful feedback.

diff --git a/src/sentry/api/endpoints/organization_discover_query.py b/src/sentry/api/endpoints/organization_discover_query.py
index 7b34e844d7..93d4b74203 100644
--- a/src/sentry/api/endpoints/organization_discover_query.py
+++ b/src/sentry/api/endpoints/organization_discover_query.py
@@ -40,6 +40,7 @@ class DiscoverQuerySerializer(serializers.Serializer):
         child=serializers.CharField(),
         required=False,
         allow_null=True,
+        default=[],
     )
     limit = serializers.IntegerField(min_value=0, max_value=10000, required=False)
     rollup = serializers.IntegerField(required=False)
@@ -91,6 +92,9 @@ class DiscoverQuerySerializer(serializers.Serializer):
         elif date_fields_provided > 1:
             raise serializers.ValidationError('Conflicting date filters supplied')
 
+        if not data.get('fields') and not data.get('aggregations'):
+            raise serializers.ValidationError('Specify at least one field or aggregation')
+
         try:
             start, end = get_date_range_from_params({
                 'start': data.get('start'),
