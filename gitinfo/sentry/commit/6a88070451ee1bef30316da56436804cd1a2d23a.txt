commit 6a88070451ee1bef30316da56436804cd1a2d23a
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jun 11 21:10:40 2014 -0700

    Remove add member flow (only use invite)

diff --git a/src/sentry/templates/sentry/teams/members/new.html b/src/sentry/templates/sentry/teams/members/new.html
index ae4c6ae8c2..dad264f3c8 100644
--- a/src/sentry/templates/sentry/teams/members/new.html
+++ b/src/sentry/templates/sentry/teams/members/new.html
@@ -2,7 +2,7 @@
 
 {% load i18n %}
 
-{% block title %}{% trans "New Member" %} | {{ block.super }}{% endblock %}
+{% block title %}{% trans "Add Team Member" %} | {{ block.super }}{% endblock %}
 
 {% block sidebar %}
     {{ block.super }}
@@ -11,22 +11,14 @@
 {% endblock %}
 
 {% block inner %}
-    <ul class="nav nav-tabs">
-        <li class="active"><a href="#invite" data-toggle="tab">{% trans "Invite a new user" %}</a></li>
-        <li><a href="#add" data-toggle="tab">{% trans "Add an existing user" %}</a></li>
-    </ul>
-    <div class="tab-content">
-        <div class="tab-pane active" id="invite">
-            <p>{% trans "Invite a member to join this team via their email address. If they do not already have an account, they will first be asked to create one." %}</p>
-            {% with invite_form as form %}
-                {% include "sentry/partial/_form.html" %}
-            {% endwith %}
+    <div class="box">
+        <div class="box-header">
+            <h3>{% trans "Add Team Member" %}</h3>
         </div>
-        <div class="tab-pane" id="add">
-            <p>{% trans "You may add a user by their username if they already have an account." %}</p>
-            {% with add_form as form %}
-                {% include "sentry/partial/_form.html" %}
-            {% endwith %}
+        <div class="box-content with-padding">
+            <p>{% trans "Invite a member to join this team via their email address. If they do not already have an account, they will first be asked to create one." %}</p>
+
+            {% include "sentry/partial/_form.html" %}
         </div>
     </div>
 {% endblock %}
diff --git a/src/sentry/web/forms/teams.py b/src/sentry/web/forms/teams.py
index dfc7f0bc22..055dfd2ece 100644
--- a/src/sentry/web/forms/teams.py
+++ b/src/sentry/web/forms/teams.py
@@ -78,24 +78,6 @@ class InviteTeamMemberForm(BaseTeamMemberForm):
         return value
 
 
-class NewTeamMemberForm(BaseTeamMemberForm):
-    user = UserField()
-
-    class Meta:
-        fields = ('type', 'user')
-        model = TeamMember
-
-    def clean_user(self):
-        value = self.cleaned_data['user']
-        if not value:
-            return None
-
-        if self.team.member_set.filter(user=value).exists():
-            raise forms.ValidationError(_('User is already a member of this team'))
-
-        return value
-
-
 class AcceptInviteForm(forms.Form):
     pass
 
diff --git a/src/sentry/web/frontend/teams.py b/src/sentry/web/frontend/teams.py
index 923d92d1ee..c857257fd8 100644
--- a/src/sentry/web/frontend/teams.py
+++ b/src/sentry/web/frontend/teams.py
@@ -25,7 +25,7 @@ from sentry.utils.samples import create_sample_event
 from sentry.web.decorators import login_required, has_access
 from sentry.web.forms.teams import (
     NewTeamForm, NewTeamAdminForm,
-    EditTeamMemberForm, NewTeamMemberForm,
+    EditTeamMemberForm,
     InviteTeamMemberForm, AcceptInviteForm, NewAccessGroupForm,
     EditAccessGroupForm, NewAccessGroupMemberForm, NewAccessGroupProjectForm,
     RemoveAccessGroupForm)
@@ -176,21 +176,10 @@ def new_team_member(request, team):
         'type': MEMBER_USER,
     }
 
-    invite_form = InviteTeamMemberForm(team, request.POST or None, initial=initial, prefix='invite')
-    add_form = NewTeamMemberForm(team, request.POST or None, initial=initial, prefix='add')
+    form = InviteTeamMemberForm(team, request.POST or None, initial=initial, prefix='invite')
 
-    if add_form.is_valid():
-        pm = add_form.save(commit=False)
-        pm.team = team
-        pm.save()
-
-        messages.add_message(request, messages.SUCCESS,
-            _('The team member was added.'))
-
-        return HttpResponseRedirect(reverse('sentry-manage-team-members', args=[team.slug]))
-
-    elif invite_form.is_valid():
-        pm = invite_form.save(commit=False)
+    if form.is_valid():
+        pm = form.save(commit=False)
         pm.team = team
         pm.save()
 
@@ -204,8 +193,7 @@ def new_team_member(request, team):
     context = csrf(request)
     context.update({
         'page': 'members',
-        'add_form': add_form,
-        'invite_form': invite_form,
+        'form': form,
         'SUBSECTION': 'members',
     })
 
