commit bdb0773f855f6d82c0c36a2a85ce35d5f55d7a41
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Fri May 1 16:24:03 2020 -0700

    fix(ui): Fix broken completion of tag keys in SmartSearchBar (#18573)

diff --git a/src/sentry/static/sentry/app/components/smartSearchBar/index.tsx b/src/sentry/static/sentry/app/components/smartSearchBar/index.tsx
index db2877148d..d6c6d8eebf 100644
--- a/src/sentry/static/sentry/app/components/smartSearchBar/index.tsx
+++ b/src/sentry/static/sentry/app/components/smartSearchBar/index.tsx
@@ -969,8 +969,12 @@ class SmartSearchBar extends React.Component<Props, State> {
     const lastChar = replaceText.charAt(replaceText.length - 1);
     replaceText += lastChar === ':' || lastChar === '.' ? '' : ' ';
 
+    const isNewTerm = query.charAt(query.length - 1) === ' ';
+
     if (!terms) {
       newQuery = replaceText;
+    } else if (isNewTerm) {
+      newQuery = `${query}${replaceText}`;
     } else {
       const last = terms.pop() ?? '';
 
diff --git a/src/sentry/static/sentry/app/components/smartSearchBar/searchDropdown.jsx b/src/sentry/static/sentry/app/components/smartSearchBar/searchDropdown.jsx
index fe0f03d78e..109054c09c 100644
--- a/src/sentry/static/sentry/app/components/smartSearchBar/searchDropdown.jsx
+++ b/src/sentry/static/sentry/app/components/smartSearchBar/searchDropdown.jsx
@@ -127,8 +127,7 @@ const LoadingWrapper = styled('div')`
 
 const Info = styled('div')`
   display: flex;
-  justify-content: center;
-  padding: ${space(1)};
+  padding: ${space(1)} ${space(2)};
   font-size: ${p => p.theme.fontSizeLarge};
   color: ${p => p.theme.gray2};
 `;
diff --git a/tests/js/spec/components/smartSearchBar.spec.jsx b/tests/js/spec/components/smartSearchBar.spec.jsx
index 4c8f0134a1..71d5e7c1e7 100644
--- a/tests/js/spec/components/smartSearchBar.spec.jsx
+++ b/tests/js/spec/components/smartSearchBar.spec.jsx
@@ -552,7 +552,20 @@ describe('SmartSearchBar', function() {
     });
   });
 
-  describe('onTogglePinnedSearch', function() {
+  describe('onAutoComplete()', function() {
+    it('completes terms from the list', function() {
+      const props = {
+        query: 'event.type:error ',
+        organization,
+        supportedTags,
+      };
+      const searchBar = mountWithTheme(<SmartSearchBar {...props} />, options).instance();
+      searchBar.onAutoComplete('myTag:', {type: 'tag'});
+      expect(searchBar.state.query).toEqual('event.type:error myTag:');
+    });
+  });
+
+  describe('onTogglePinnedSearch()', function() {
     let pinRequest, unpinRequest;
     beforeEach(function() {
       pinRequest = MockApiClient.addMockResponse({
