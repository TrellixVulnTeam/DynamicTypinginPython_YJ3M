commit c1b195ad1f2bcfefa0127242da368aa6d80f02c8
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Thu Mar 29 11:02:10 2018 -0700

    feat(buffers): Move process_pending task to it's own queue (#7848)

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 1d6aa9cc9f..64c569d99b 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -441,6 +441,7 @@ CELERY_QUEUES = [
     Queue('alerts', routing_key='alerts'),
     Queue('auth', routing_key='auth'),
     Queue('assemble', routing_key='assemble'),
+    Queue('buffers.process_pending', routing_key='buffers.process_pending'),
     Queue('commits', routing_key='commits'),
     Queue('cleanup', routing_key='cleanup'),
     Queue('default', routing_key='default'),
@@ -521,7 +522,7 @@ CELERYBEAT_SCHEDULE = {
         'schedule': timedelta(seconds=10),
         'options': {
             'expires': 10,
-            'queue': 'counters-0',
+            'queue': 'buffers.process_pending',
         }
     },
     'sync-options': {
diff --git a/src/sentry/queue/routers.py b/src/sentry/queue/routers.py
index 2319f200b3..e5c81ec6f6 100644
--- a/src/sentry/queue/routers.py
+++ b/src/sentry/queue/routers.py
@@ -7,7 +7,6 @@ from celery import current_app
 
 COUNTER_TASKS = set(
     [
-        'sentry.tasks.process_buffer.process_pending',
         'sentry.tasks.process_buffer.process_incr',
     ]
 )
diff --git a/src/sentry/tasks/process_buffer.py b/src/sentry/tasks/process_buffer.py
index 75b28dfdf5..1fb4d7ed13 100644
--- a/src/sentry/tasks/process_buffer.py
+++ b/src/sentry/tasks/process_buffer.py
@@ -16,7 +16,10 @@ from sentry.utils.locking import UnableToAcquireLock
 logger = logging.getLogger(__name__)
 
 
-@instrumented_task(name='sentry.tasks.process_buffer.process_pending')
+@instrumented_task(
+    name='sentry.tasks.process_buffer.process_pending',
+    queue='buffers.process_pending',
+)
 def process_pending(partition=None):
     """
     Process pending buffers.
