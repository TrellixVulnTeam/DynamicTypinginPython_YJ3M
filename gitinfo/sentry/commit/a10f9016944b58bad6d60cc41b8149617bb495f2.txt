commit a10f9016944b58bad6d60cc41b8149617bb495f2
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Feb 8 12:11:20 2013 -0800

    Correct crossdomain.xml support

diff --git a/src/sentry/templates/sentry/crossdomain.xml b/src/sentry/templates/sentry/crossdomain.xml
index ccbcaea062..5aada418bb 100644
--- a/src/sentry/templates/sentry/crossdomain.xml
+++ b/src/sentry/templates/sentry/crossdomain.xml
@@ -1,6 +1,9 @@
+<?xml version="1.0"?>
+<!DOCTYPE cross-domain-policy SYSTEM
+    "http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
 <cross-domain-policy>
     {% for origin in origin_list %}
-        <allow-access-from domain="{{ origin }}" secure="true"></allow-access-from>
+        <allow-access-from domain="{{ origin }}" secure="false"></allow-access-from>
     {% endfor %}
-    <allow-http-request-headers-from domain="*" headers="X-Sentry-Auth" secure="true"></allow-http-request-headers-from>
+    <allow-http-request-headers-from domain="*" headers="X-Sentry-Auth" secure="false"></allow-http-request-headers-from>
 </cross-domain-policy>
diff --git a/src/sentry/templates/sentry/crossdomain_index.xml b/src/sentry/templates/sentry/crossdomain_index.xml
new file mode 100644
index 0000000000..d42b1ce438
--- /dev/null
+++ b/src/sentry/templates/sentry/crossdomain_index.xml
@@ -0,0 +1,6 @@
+<?xml version="1.0"?>
+<!DOCTYPE cross-domain-policy SYSTEM
+    "http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
+<cross-domain-policy>
+    <site-control permitted-cross-domain-policies="all" />
+</cross-domain-policy>
\ No newline at end of file
diff --git a/src/sentry/web/api.py b/src/sentry/web/api.py
index f1e99e2348..3b84fd63fa 100644
--- a/src/sentry/web/api.py
+++ b/src/sentry/web/api.py
@@ -696,9 +696,7 @@ def search_tags(request, team, project):
 
 
 def crossdomain_xml_index(request):
-    response = HttpResponse("""<cross-domain-policy>
-        <site-control permitted-cross-domain-policies="all"></site-control>
-    </cross-domain-policy>""")
+    response = render_to_response('sentry/crossdomain_index.xml')
     response['Content-Type'] = 'application/xml'
     return response
 
@@ -719,7 +717,7 @@ def crossdomain_xml(request, project_id):
 
     response = render_to_response('sentry/crossdomain.xml', {
         'origin_list': origin_list
-    }, request)
+    })
     response['Content-Type'] = 'application/xml'
 
     return response
