commit c17dfba021e64a90cc6c27cc32176385b7429e08
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jan 13 13:13:08 2015 -0600

    Expand nginx conf to suggest more reasonable production defaults

diff --git a/docs/quickstart/nginx.rst b/docs/quickstart/nginx.rst
index f0c95039cb..ac18c547ca 100644
--- a/docs/quickstart/nginx.rst
+++ b/docs/quickstart/nginx.rst
@@ -17,8 +17,30 @@ Below is a sample configuration for Nginx, which includes the RealIP module:
       real_ip_header X-Forwarded-For;
       real_ip_recursive on;
 
+      # SSL configuration -- change these certs to match yours
+      ssl_certificate      /etc/ssl/sentry.example.com.crt;
+      ssl_certificate_key  /etc/ssl/sentry.example.com.key;
+
+      # NOTE: These settings may not be the most-current recommended
+      # defaults
+      ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
+      ssl_ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:RSA+3DES:!aNULL:!MD5:!DSS;
+      ssl_prefer_server_ciphers on;
+      ssl_session_cache shared:SSL:128m;
+      ssl_session_timeout 10m;
+
       server {
         listen   80;
+        location / {
+          if ($request_method = GET) {
+            rewrite  ^ https://$host$request_uri? permanent;
+          }
+          return 405;
+        }
+      }
+
+      server {
+        listen   443 ssl;
 
         proxy_set_header   Host                 $http_host;
         proxy_set_header   X-Forwarded-Proto    $scheme;
@@ -40,15 +62,9 @@ Below is a sample configuration for Nginx, which includes the RealIP module:
 
         location / {
           proxy_pass        http://localhost:9000;
-        }
 
-        location ~* /api/(?P<projectid>\d+/)?store/ {
-          proxy_pass        http://localhost:9000;
-
-          limit_req   zone=one  burst=3  nodelay;
-          limit_req   zone=two  burst=10  nodelay;
+          add_header Strict-Transport-Security "max-age=31536000";
         }
-
       }
     }
 
