commit 8c452469952368fb89fc423ef64ad0a00a6976d9
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Tue Jun 27 16:02:58 2017 +0200

    Correctly strip prefixes from releases

diff --git a/src/sentry/models/release.py b/src/sentry/models/release.py
index 248a1e2ac3..968c23ea06 100644
--- a/src/sentry/models/release.py
+++ b/src/sentry/models/release.py
@@ -30,7 +30,7 @@ logger = logging.getLogger(__name__)
 
 
 _sha1_re = re.compile(r'^[a-f0-9]{40}$')
-_dotted_path_prefix_re = re.compile(r'^([a-z][a-z0-9-]+)(\.[a-z][a-z0-9-]+)+-')
+_dotted_path_prefix_re = re.compile(r'^([a-zA-Z][a-zA-Z0-9-]+)(\.[a-zA-Z][a-zA-Z0-9-]+)+-')
 BAD_RELEASE_CHARS = '\n\f\t/'
 
 
diff --git a/src/sentry/static/sentry/app/utils.jsx b/src/sentry/static/sentry/app/utils.jsx
index 14837f2c0d..0c2bdd7f11 100644
--- a/src/sentry/static/sentry/app/utils.jsx
+++ b/src/sentry/static/sentry/app/utils.jsx
@@ -222,7 +222,7 @@ export function formatBytes(bytes) {
 }
 
 export function getShortVersion(version) {
-  let match = version.match(/^(?:[a-z][a-z0-9-]+)(?:\.[a-z][a-z0-9-]+)+-(.*)$/);
+  let match = version.match(/^(?:[a-zA-Z][a-zA-Z0-9-]+)(?:\.[a-zA-Z][a-zA-Z0-9-]+)+-(.*)$/);
   if (match) {
     version = match[1];
   }
diff --git a/tests/sentry/models/test_release.py b/tests/sentry/models/test_release.py
index 2a28911d89..d75c450897 100644
--- a/tests/sentry/models/test_release.py
+++ b/tests/sentry/models/test_release.py
@@ -143,6 +143,17 @@ class MergeReleasesTest(TestCase):
         assert not Release.objects.filter(id=release2.id).exists()
         assert not Release.objects.filter(id=release3.id).exists()
 
+    def test_short_version_dotted_prefix(self):
+        org = self.create_organization()
+
+        release = Release.objects.create(
+            version='foo.bar.Baz-1.0',
+            organization=org
+        )
+
+        assert release.version == 'foo.bar.Baz-1.0'
+        assert release.short_version == '1.0'
+
 
 class SetCommitsTestCase(TestCase):
     def test_simple(self):
