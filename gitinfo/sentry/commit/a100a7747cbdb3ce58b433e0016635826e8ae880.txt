commit a100a7747cbdb3ce58b433e0016635826e8ae880
Author: David Cramer <dcramer@gmail.com>
Date:   Sun May 27 15:45:04 2012 -0700

    Add sentry_useragents plugin

diff --git a/docs/plugins/index.rst b/docs/plugins/index.rst
index 0779eaa7cf..dc8e6608af 100644
--- a/docs/plugins/index.rst
+++ b/docs/plugins/index.rst
@@ -12,9 +12,11 @@ your ``INSTALLED_APPS``::
 
     INSTALLED_APPS = [
       ...
+      'sentry.plugins.sentry_mail',
       'sentry.plugins.sentry_servers',
       'sentry.plugins.sentry_sites',
       'sentry.plugins.sentry_urls',
+      'sentry.plugins.sentry_useragents',
     ]
 
 .. data:: sentry.plugins.sentry_server
@@ -67,6 +69,20 @@ your ``INSTALLED_APPS``::
           'sentry.plugins.sentry_mail',
         ]
 
+.. data:: sentry.plugins.sentry_useragents
+    :noindex:
+
+    Enables a tagging of browsers and operating systems based on the
+    'User-Agent' header in the HTTP interface.
+
+    ::
+
+        INSTALLED_APPS = [
+          'sentry.plugins.sentry_useragents',
+        ]
+
+    .. versionadded:: 4.5.0
+
 Recognized 3rd Party Extensions
 -------------------------------
 
diff --git a/sentry/plugins/sentry_useragents/__init__.py b/sentry/plugins/sentry_useragents/__init__.py
new file mode 100644
index 0000000000..a7715e0368
--- /dev/null
+++ b/sentry/plugins/sentry_useragents/__init__.py
@@ -0,0 +1,7 @@
+"""
+sentry.plugins.sentry_useragents
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+:copyright: (c) 2010-2012 by the Sentry Team, see AUTHORS for more details.
+:license: BSD, see LICENSE for more details.
+"""
diff --git a/sentry/plugins/sentry_useragents/models.py b/sentry/plugins/sentry_useragents/models.py
new file mode 100644
index 0000000000..eb46143749
--- /dev/null
+++ b/sentry/plugins/sentry_useragents/models.py
@@ -0,0 +1,70 @@
+"""
+sentry.plugins.sentry_useragents.models
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+:copyright: (c) 2010-2012 by the Sentry Team, see AUTHORS for more details.
+:license: BSD, see LICENSE for more details.
+"""
+import httpagentparser
+import sentry
+
+from django.utils.translation import ugettext_lazy as _
+
+from sentry.plugins import register
+from sentry.plugins.bases.tag import TagPlugin
+
+
+class UserAgentPlugin(TagPlugin):
+    version = sentry.VERSION
+    author = "Sentry Team"
+    author_url = "https://github.com/dcramer/sentry"
+
+    def get_tag_values(self, event):
+        http = event.interfaces.get('sentry.interfaces.Http')
+        if not http:
+            return []
+        if not http.headers:
+            return []
+        if 'User-Agent' not in http.headers:
+            return []
+        ua = httpagentparser.detect(http.headers['User-Agent'])
+        return self.get_tag_values_from_ua(ua)
+
+
+class BrowserPlugin(UserAgentPlugin):
+    """
+    Adds additional support for showing information about browsers including:
+
+    * A panel which shows all browsers a message was seen on.
+    * A sidebar module which shows the browsers most actively seen on.
+    """
+    slug = 'browsers'
+    title = _('Browsers')
+    tag = 'browser'
+    tag_label = _('Browser Name')
+
+    def get_tag_values_from_ua(self, ua):
+        return ['%(name)s %(version)s' % ua['browser']]
+
+
+register(BrowserPlugin)
+
+
+class OsPlugin(UserAgentPlugin):
+    """
+    Adds additional support for showing information about operating systems including:
+
+    * A panel which shows all operating systems a message was seen on.
+    * A sidebar module which shows the operating systems most actively seen on.
+    """
+    slug = 'os'
+    title = _('Operating Systems')
+    tag = 'os'
+    tag_label = _('Operating System')
+
+    def get_tag_values_from_ua(self, ua):
+        if 'flavor' in ua:
+            return ['%(name)s %(version)s' % ua['flavor']]
+        return [ua['os']]
+
+register(OsPlugin)
diff --git a/setup.py b/setup.py
index e1581477b5..68fb8c8300 100755
--- a/setup.py
+++ b/setup.py
@@ -63,6 +63,7 @@ install_requires = [
     'raven>=1.9.0',
     'simplejson>=2.3.0,<2.5.0',
     'South>=0.7',
+    'httpagentparser>=1.0.5'
 ]
 
 dependency_links = [
@@ -71,7 +72,7 @@ dependency_links = [
 
 setup(
     name='sentry',
-    version='4.4.6',
+    version='4.5.0',
     author='David Cramer',
     author_email='dcramer@gmail.com',
     url='http://github.com/dcramer/sentry',
