commit ae07f117d364b6e8c1e5ee1ab8cf6507dd94a00d
Author: Burak Yigit Kaya <byk@sentry.io>
Date:   Mon Sep 9 20:18:17 2019 +0300

    fix(user-feedback): Fix user feedback page hostname (#14429)
    
    Should actually use the host in settings
    
    Fixes #13970

diff --git a/src/sentry/web/frontend/error_page_embed.py b/src/sentry/web/frontend/error_page_embed.py
index 416cae8fc4..2b423879ec 100644
--- a/src/sentry/web/frontend/error_page_embed.py
+++ b/src/sentry/web/frontend/error_page_embed.py
@@ -12,7 +12,7 @@ from django.utils.safestring import mark_safe
 from django.utils.translation import ugettext_lazy as _
 from django.views.decorators.csrf import csrf_exempt
 
-from sentry import eventstore
+from sentry import eventstore, options as sentry_options
 from sentry.models import Event, ProjectKey, ProjectOption, UserReport
 from sentry.web.helpers import render_to_response
 from sentry.signals import user_feedback_received
@@ -208,7 +208,9 @@ class ErrorPageEmbedView(View):
         )
 
         context = {
-            "endpoint": mark_safe("*/" + json.dumps(request.build_absolute_uri()) + ";/*"),
+            "endpoint": mark_safe(
+                "*/" + json.dumps(sentry_options.get("system.url-prefix")) + ";/*"
+            ),
             "template": mark_safe("*/" + json.dumps(template) + ";/*"),
             "strings": json.dumps_htmlsafe(
                 {
