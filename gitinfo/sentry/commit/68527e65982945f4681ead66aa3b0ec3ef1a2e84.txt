commit 68527e65982945f4681ead66aa3b0ec3ef1a2e84
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Aug 10 14:13:50 2014 -0700

    Move group details logic into controller

diff --git a/src/sentry/static/sentry/app/base.js b/src/sentry/static/sentry/app/base.js
index 387d37d900..c469834bdf 100644
--- a/src/sentry/static/sentry/app/base.js
+++ b/src/sentry/static/sentry/app/base.js
@@ -179,130 +179,6 @@
 
         }),
 
-        GroupDetailsPage: BasePage.extend({
-
-            initialize: function(data){
-                BasePage.prototype.initialize.apply(this, arguments);
-
-                this.group_list = new app.views.GroupListView({
-                    className: 'group-list',
-                    id: 'event_list',
-                    members: [data.group],
-                    model: app.models.Group
-                });
-
-                $('#chart').height('150px');
-                app.charts.createBasic('#chart');
-
-                $('#public-status .action').click(function(){
-                    var $this = $(this);
-                    $.ajax({
-                        url: $this.attr('data-api-url'),
-                        type: 'post',
-                        success: function(group){
-                            var selector = (group.isPublic ? 'true' : 'false');
-                            var nselector = (group.isPublic ? 'false' : 'true');
-                            $('#public-status span[data-public="' + selector + '"]').show();
-                            $('#public-status span[data-public="' + nselector + '"]').hide();
-                        },
-                        error: function(){
-                            window.alert('There was an error changing the public status');
-                        }
-                    });
-                });
-
-                $('.add-note-form textarea').focus(function () {
-                    $(this).addClass('expanded');
-                });
-
-                $('.add-note-form textarea').keypress(function (e) {
-                    if (e.which == 13 && !e.shiftKey) {
-                      $('.add-note-form').submit();
-                      return false;
-                    }
-                });
-
-                var $event_nav = $('#event_nav');
-                if ($event_nav.length > 0) {
-                    var $window = $(window);
-                    var $nav_links = $event_nav.find('a[href*=#]');
-                    var $nav_targets = [];
-                    var scroll_offset = $event_nav.offset().top;
-                    var event_nav_height;
-                    var last_target;
-
-                    $window.resize(function(){
-                        event_nav_height = $event_nav.find('.nav').outerHeight();
-                        $event_nav.height(event_nav_height + 'px');
-                    }).resize();
-
-                    $nav_links.click(function(e){
-                        var $el = $(this);
-                        var target = $(this.hash);
-
-                        $el.parent().addClass('active').siblings().removeClass('active');
-
-                        $('html,body').animate({
-                            scrollTop: target.position().top + event_nav_height
-                        }, 'fast');
-
-                        if (history.pushState) {
-                            history.pushState({}, '', this.hash);
-                        }
-
-                        e.preventDefault();
-                    }).each(function(){
-                        if (this.hash.length > 1 && $(this.hash).length) {
-                            $nav_targets.push(this.hash);
-                        }
-                    });
-
-                    var resizeTimer;
-                    $window.scroll(function(){
-                        clearTimeout(resizeTimer);
-                        resizeTimer = setTimeout(function(){
-                            // Change fixed nav if needed
-                            if ($window.scrollTop() > scroll_offset) {
-                                if (!$event_nav.hasClass('fixed')) {
-                                    $event_nav.addClass('fixed');
-                                }
-                            } else if ($event_nav.hasClass('fixed')) {
-                                $event_nav.removeClass('fixed');
-                            }
-
-                            if ($nav_targets.length) {
-                                // Get container scroll position
-                                var from_top = $window.scrollTop() + event_nav_height + 20;
-
-                                // Get id of current scroll item
-                                var cur = $.map($nav_targets, function(hash){
-                                    if ($(hash).offset().top < from_top) {
-                                        return hash;
-                                    }
-                                });
-
-                                // Get the id of the current element
-                                var target = cur ? cur[cur.length - 1] : null;
-
-                                if (!target) {
-                                    target = $nav_targets[0];
-                                }
-
-                                if (last_target !== target) {
-                                   last_target = target;
-
-                                   // Set/remove active class
-                                   $nav_links
-                                     .parent().removeClass("active")
-                                     .end().filter("[href=" + target + "]").parent().addClass("active");
-                                }
-                            }
-                        }, 1);
-                    }).scroll();
-                }
-            }
-        }),
-
         WallPage: BasePage.extend({
             initialize: function(){
                 BasePage.prototype.initialize.apply(this, {
diff --git a/src/sentry/static/sentry/app/controllers/groupDetails.js b/src/sentry/static/sentry/app/controllers/groupDetails.js
index 8bdf653e2d..733938456d 100644
--- a/src/sentry/static/sentry/app/controllers/groupDetails.js
+++ b/src/sentry/static/sentry/app/controllers/groupDetails.js
@@ -9,6 +9,37 @@
     init: function() {
       // TODO(dcramer): remove the window hack
       this.$http.post('/api/0/groups/' + window.SentryConfig.selectedGroup.id + '/markseen/');
+
+      $('#chart').height('150px');
+      app.charts.createBasic('#chart');
+
+      $('#public-status .action').click(function(){
+          var $this = $(this);
+          $.ajax({
+              url: $this.attr('data-api-url'),
+              type: 'post',
+              success: function(group){
+                  var selector = (group.isPublic ? 'true' : 'false');
+                  var nselector = (group.isPublic ? 'false' : 'true');
+                  $('#public-status span[data-public="' + selector + '"]').show();
+                  $('#public-status span[data-public="' + nselector + '"]').hide();
+              },
+              error: function(){
+                  window.alert('There was an error changing the public status');
+              }
+          });
+      });
+
+      $('.add-note-form textarea').focus(function () {
+          $(this).addClass('expanded');
+      });
+
+      $('.add-note-form textarea').keypress(function (e) {
+          if (e.which == 13 && !e.shiftKey) {
+            $('.add-note-form').submit();
+            return false;
+          }
+      });
     }
   });
 }());
diff --git a/src/sentry/templates/sentry/groups/details.html b/src/sentry/templates/sentry/groups/details.html
index 0835d34b03..cf4445befb 100644
--- a/src/sentry/templates/sentry/groups/details.html
+++ b/src/sentry/templates/sentry/groups/details.html
@@ -234,9 +234,5 @@
 {% block content_after %}
     <script>
     window.SentryConfig.selectedGroup = {% convert_to_json selectedGroup %};
-
-    new app.GroupDetailsPage({
-        group: {{ group|to_json:request|safe }},
-    });
     </script>
 {% endblock %}
