commit 48c6740da176be24b1d1844d4ea111cdb2bd1983
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jan 28 01:08:55 2014 -0800

    Add plugin suffix to stat instrumentation

diff --git a/src/sentry/tasks/base.py b/src/sentry/tasks/base.py
index d9c1fa69de..0884449f2d 100644
--- a/src/sentry/tasks/base.py
+++ b/src/sentry/tasks/base.py
@@ -11,11 +11,15 @@ from django_statsd.clients import statsd
 from functools import wraps
 
 
-def instrumented_task(name, queue, **kwargs):
+def instrumented_task(name, queue, stat_suffix=None, **kwargs):
+    statsd_key = 'tasks.{name}'.format(name=name)
+    if stat_suffix:
+        statsd_key += '.{key}'.format(key=stat_suffix)
+
     def wrapped(func):
         @wraps(func)
         def _wrapped(*args, **kwargs):
-            with statsd.timer('tasks.{name}'.format(name=name)):
+            with statsd.timer(statsd_key):
                 return func(*args, **kwargs)
         return task(name=name, queue=queue, **kwargs)(func)
     return wrapped
diff --git a/src/sentry/tasks/post_process.py b/src/sentry/tasks/post_process.py
index eee585e2d5..6bc3a2620f 100644
--- a/src/sentry/tasks/post_process.py
+++ b/src/sentry/tasks/post_process.py
@@ -33,7 +33,8 @@ def post_process_group(group, event, **kwargs):
 
 @instrumented_task(
     name='sentry.tasks.post_process.plugin_post_process_group',
-    queue='triggers')
+    queue='triggers',
+    stat_suffix=lambda plugin_slug, *a, **k: plugin_slug)
 def plugin_post_process_group(plugin_slug, group, **kwargs):
     """
     Fires post processing hooks for a group.
