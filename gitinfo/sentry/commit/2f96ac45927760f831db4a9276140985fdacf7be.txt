commit 2f96ac45927760f831db4a9276140985fdacf7be
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 15 00:29:11 2014 -0800

    Update team dashboard endpoints

diff --git a/src/sentry/templates/sentry/dashboard.html b/src/sentry/templates/sentry/dashboard.html
index bd64f73e5b..ddf9286bef 100644
--- a/src/sentry/templates/sentry/dashboard.html
+++ b/src/sentry/templates/sentry/dashboard.html
@@ -30,9 +30,9 @@
                             <div class="page-header clearfix">
                                 <h3 class="pull-left">{% trans "Trends" %}</h3>
                                 <ul class="nav nav-pills nav-small pull-right">
-                                    <li><a href="#top_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-trends' team.slug %}?minutes=15&amp;limit=5">{% trans "15 minutes" %}</a></li>
-                                    <li><a href="#top_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-trends' team.slug %}?minutes=60&amp;limit=5">{% trans "60 minutes" %}</a></li>
-                                    <li class="active"><a href="#top_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-trends' team.slug %}?minutes=1440&amp;limit=5">{% trans "24 hours" %}</a></li>
+                                    <li><a href="#top_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-trends' organization.slug team.slug %}?minutes=15&amp;limit=5">{% trans "15 minutes" %}</a></li>
+                                    <li><a href="#top_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-trends' organization.slug team.slug %}?minutes=60&amp;limit=5">{% trans "60 minutes" %}</a></li>
+                                    <li class="active"><a href="#top_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-trends' organization.slug team.slug %}?minutes=1440&amp;limit=5">{% trans "24 hours" %}</a></li>
                                 </ul>
                             </div>
                             <div class="tab-content">
@@ -43,9 +43,9 @@
                             <div class="page-header clearfix">
                                 <h3 class="pull-left">{% trans "New Events" %}</h3>
                                 <ul class="nav nav-pills nav-small pull-right">
-                                    <li><a href="#new_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-new' team.slug %}?minutes=15&amp;limit=5">{% trans "15 minutes" %}</a></li>
-                                    <li><a href="#new_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-new' team.slug %}?minutes=60&amp;limit=5">{% trans "60 minutes" %}</a></li>
-                                    <li class="active"><a href="#new_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-new' team.slug %}?minutes=1440&amp;limit=5">{% trans "24 hours" %}</a></li>
+                                    <li><a href="#new_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-new' organization.slug team.slug %}?minutes=15&amp;limit=5">{% trans "15 minutes" %}</a></li>
+                                    <li><a href="#new_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-new' organization.slug team.slug %}?minutes=60&amp;limit=5">{% trans "60 minutes" %}</a></li>
+                                    <li class="active"><a href="#new_events" data-toggle="ajtab" data-uri="{% url 'sentry-api-groups-new' organization.slug team.slug %}?minutes=1440&amp;limit=5">{% trans "24 hours" %}</a></li>
                                 </ul>
                             </div>
                             <div class="tab-content">
diff --git a/src/sentry/web/api.py b/src/sentry/web/api.py
index e946fee60a..bc91ae4834 100644
--- a/src/sentry/web/api.py
+++ b/src/sentry/web/api.py
@@ -684,16 +684,11 @@ def clear(request, organization, project):
 @never_cache
 @csrf_exempt
 @has_access
-def get_group_trends(request, organization, team=None, project=None):
+def get_group_trends(request, organization, team):
     minutes = int(request.REQUEST.get('minutes', 15))
     limit = min(100, int(request.REQUEST.get('limit', 10)))
 
-    if not team and project:
-        project_list = [project]
-    elif team:
-        project_list = Project.objects.get_for_user(team=team, user=request.user)
-    else:
-        return HttpResponse(status=400)
+    project_list = Project.objects.get_for_user(team=team, user=request.user)
 
     project_dict = dict((p.id, p) for p in project_list)
 
@@ -724,16 +719,11 @@ def get_group_trends(request, organization, team=None, project=None):
 @never_cache
 @csrf_exempt
 @has_access
-def get_new_groups(request, organization, team=None, project=None):
+def get_new_groups(request, organization, team):
     minutes = int(request.REQUEST.get('minutes', 15))
     limit = min(100, int(request.REQUEST.get('limit', 10)))
 
-    if not team and project:
-        project_list = [project]
-    elif team:
-        project_list = Project.objects.get_for_user(team=team, user=request.user)
-    else:
-        return HttpResponse(status=400)
+    project_list = Project.objects.get_for_user(team=team, user=request.user)
 
     project_dict = dict((p.id, p) for p in project_list)
 
@@ -760,16 +750,11 @@ def get_new_groups(request, organization, team=None, project=None):
 @never_cache
 @csrf_exempt
 @has_access
-def get_resolved_groups(request, organization, team=None, project=None):
+def get_resolved_groups(request, organization, team):
     minutes = int(request.REQUEST.get('minutes', 15))
     limit = min(100, int(request.REQUEST.get('limit', 10)))
 
-    if not team and project:
-        project_list = [project]
-    elif team:
-        project_list = Project.objects.get_for_user(team=team, user=request.user)
-    else:
-        return HttpResponse(status=400)
+    project_list = Project.objects.get_for_user(team=team, user=request.user)
 
     project_dict = dict((p.id, p) for p in project_list)
 
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index 11bc5433a4..f4b02634eb 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -278,11 +278,11 @@ urlpatterns += patterns('',
     url(r'^api/(?P<organization_slug>[\w_-]+)/(?P<project_id>[\w_-]+)/group/(?P<group_id>[\w_-]+)/remove/$', api.remove_group,
         name='sentry-api-remove-group'),
 
-    url(r'^api/(?P<organization_slug>[\w_-]+)/(?:(?P<project_id>[\w_-]+)/)?groups/trends/$', api.get_group_trends,
+    url(r'^api/(?P<organization_slug>[\w_-]+)/(?P<team_slug>[\w_-]+)/groups/trends/$', api.get_group_trends,
         name='sentry-api-groups-trends'),
-    url(r'^api/(?P<organization_slug>[\w_-]+)/(?:(?P<project_id>[\w_-]+)/)?groups/newest/$', api.get_new_groups,
+    url(r'^api/(?P<organization_slug>[\w_-]+)/(?P<team_slug>[\w_-]+)/groups/newest/$', api.get_new_groups,
         name='sentry-api-groups-new'),
-    url(r'^api/(?P<organization_slug>[\w_-]+)/(?:(?P<project_id>[\w_-]+)/)?groups/resolved/$', api.get_resolved_groups,
+    url(r'^api/(?P<organization_slug>[\w_-]+)/(?P<team_slug>[\w_-]+)/groups/resolved/$', api.get_resolved_groups,
         name='sentry-api-groups-resolved'),
 
     url(r'^api/(?P<organization_slug>[\w_-]+)/(?P<project_id>[\w_-]+)/group/(?P<group_id>[\w_-]+)/set/public/$', api.make_group_public,
