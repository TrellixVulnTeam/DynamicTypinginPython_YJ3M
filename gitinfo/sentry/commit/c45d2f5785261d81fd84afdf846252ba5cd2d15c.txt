commit c45d2f5785261d81fd84afdf846252ba5cd2d15c
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Feb 19 23:57:26 2013 -0800

    Add some semi-useful popovers in replacement of titles on stacktraces

diff --git a/src/sentry/interfaces.py b/src/sentry/interfaces.py
index eac2b30226..1e7fb23948 100644
--- a/src/sentry/interfaces.py
+++ b/src/sentry/interfaces.py
@@ -417,6 +417,10 @@ class Stacktrace(Interface):
             lineno = int(frame['lineno'])
         else:
             lineno = None
+        if frame.get('colno') is not None:
+            colno = int(frame['colno'])
+        else:
+            colno = None
 
         in_app = bool(frame.get('in_app', True))
 
@@ -427,9 +431,11 @@ class Stacktrace(Interface):
             'function': frame.get('function'),
             'start_lineno': start_lineno,
             'lineno': lineno,
+            'colno': colno,
             'context': context,
             'context_line': frame.get('context_line'),
             'in_app': in_app,
+            'is_url': is_url(frame.get('abs_path') or ''),
         }
         if not is_public:
             frame_data['vars'] = frame.get('vars') or []
@@ -439,6 +445,7 @@ class Stacktrace(Interface):
             frame_data.update({
                 'sourcemap': data['sourcemap'].rsplit('/', 1)[-1],
                 'orig_filename': data['orig_filename'],
+                'orig_function': data['orig_function'],
                 'orig_lineno': data['orig_lineno'],
                 'orig_colno': data['orig_colno'],
             })
diff --git a/src/sentry/static/sentry/less/sentry.less b/src/sentry/static/sentry/less/sentry.less
index ddaa09f131..402388a608 100644
--- a/src/sentry/static/sentry/less/sentry.less
+++ b/src/sentry/static/sentry/less/sentry.less
@@ -1203,6 +1203,9 @@ ul.traceback { list-style-type: none; margin-left: 0; }
     font-size: 12px;
 
     a.annotation {
+      &.trigger-popover {
+        cursor: pointer;
+      }
       color: inherit;
       padding: 0 1px;
       border-bottom: 1px dotted #666;
@@ -2065,4 +2068,26 @@ table.vars {
   footer {
     .border-radius(0 0 7px 7px);
   }
-}
\ No newline at end of file
+}
+
+
+.popover {
+  width: auto;
+  min-width: 236px;
+  max-width: 600px;
+}
+.popover * {
+  font-size: 11px;
+  line-height: 14px;
+  margin-top: 0;
+  margin-bottom: 0;
+}
+.popover-title {
+  font-size: 10px;
+  background: #56AFE8;
+  color: #fff;
+}
+.popover-title,
+.popover-content {
+  padding: 4px 10px;
+}
diff --git a/src/sentry/static/sentry/styles/global.min.css b/src/sentry/static/sentry/styles/global.min.css
index 02a43a0799..e5625d2f4a 100644
--- a/src/sentry/static/sentry/styles/global.min.css
+++ b/src/sentry/static/sentry/styles/global.min.css
@@ -7423,6 +7423,9 @@ ul.traceback {
   padding: 0 1px;
   border-bottom: 1px dotted #666;
 }
+.frame p a.annotation.trigger-popover {
+  cursor: pointer;
+}
 .frame p a.annotation:hover {
   text-decoration: none;
 }
@@ -8274,3 +8277,23 @@ table.vars td table {
     border-radius: 0 0 7px 7px;
   }
 }
+.popover {
+  width: auto;
+  min-width: 236px;
+  max-width: 600px;
+}
+.popover * {
+  font-size: 11px;
+  line-height: 14px;
+  margin-top: 0;
+  margin-bottom: 0;
+}
+.popover-title {
+  font-size: 10px;
+  background: #56AFE8;
+  color: #fff;
+}
+.popover-title,
+.popover-content {
+  padding: 4px 10px;
+}
diff --git a/src/sentry/static/sentry/styles/sentry.css b/src/sentry/static/sentry/styles/sentry.css
index 02a43a0799..e5625d2f4a 100644
--- a/src/sentry/static/sentry/styles/sentry.css
+++ b/src/sentry/static/sentry/styles/sentry.css
@@ -7423,6 +7423,9 @@ ul.traceback {
   padding: 0 1px;
   border-bottom: 1px dotted #666;
 }
+.frame p a.annotation.trigger-popover {
+  cursor: pointer;
+}
 .frame p a.annotation:hover {
   text-decoration: none;
 }
@@ -8274,3 +8277,23 @@ table.vars td table {
     border-radius: 0 0 7px 7px;
   }
 }
+.popover {
+  width: auto;
+  min-width: 236px;
+  max-width: 600px;
+}
+.popover * {
+  font-size: 11px;
+  line-height: 14px;
+  margin-top: 0;
+  margin-bottom: 0;
+}
+.popover-title {
+  font-size: 10px;
+  background: #56AFE8;
+  color: #fff;
+}
+.popover-title,
+.popover-content {
+  padding: 4px 10px;
+}
diff --git a/src/sentry/templates/sentry/layout.html b/src/sentry/templates/sentry/layout.html
index 9b87598fee..4913ce1a79 100644
--- a/src/sentry/templates/sentry/layout.html
+++ b/src/sentry/templates/sentry/layout.html
@@ -136,6 +136,7 @@
             });
             $('input[data-toggle="datepicker"]').datepicker();
             $('.tip').tooltip();
+            $('.trigger-popover').popover();
             $('.nav-tabs .active a').tab('show')
             $('.project-selector').on('change', function(e){
                 var $el = $(e.target).get(0);
diff --git a/src/sentry/templates/sentry/partial/interfaces/stacktrace.html b/src/sentry/templates/sentry/partial/interfaces/stacktrace.html
index 0cd5d9704b..79f77b0a81 100644
--- a/src/sentry/templates/sentry/partial/interfaces/stacktrace.html
+++ b/src/sentry/templates/sentry/partial/interfaces/stacktrace.html
@@ -24,13 +24,52 @@
                 <li class="frame{% if not frame.in_app %} system-frame{% endif %} frame-{{ forloop.counter0 }}">
                     <p>
                         {% if frame.filename %}
-                            <code{% if frame.abs_path and frame.abs_path != filename %} title="{{ frame.abs_path }}"{% endif %}>{{ frame.filename }}</code>
+                            {% if frame.is_url %}
+                                <a href="{{ frame.abs_path }}">
+                            {% endif %}
+                            <code>{{ frame.filename }}</code>
+                            {% if frame.sourcemap %}
+                                <a class="annotation trigger-popover"
+                                    data-placement="right"
+                                    data-title="Original Location"
+                                    data-content="<dl>
+                                        <dt>Filename</dt>
+                                        <dd>{{ frame.orig_filename }}</dd>
+                                        <dt>Line Number</dt>
+                                        <dd>{{ frame.orig_lineno|default_if_none:"n/a" }})</dd>
+                                        <dt>Column Number</dt>
+                                        <dd>{{ frame.orig_colno|default_if_none:"n/a" }}</dd>
+                                        <dt>Function</dt>
+                                        <dd>{{ frame.orig_function|default_if_none:"n/a" }}</dd>
+                                    </dl>
+                                    <p>via {{ frame.sourcemap }}</p>">?</a>
+                            {% elif frame.abs_path and frame.abs_path != filename %}
+                                <a class="annotation trigger-popover"
+                                    data-placement="right"
+                                    data-title="Original Location"
+                                    data-content="<dl>
+                                        <dt>Filename</dt>
+                                        <dd>{{ frame.abs_path }}</dd>
+                                        {% if not frame.lineno|is_none %}
+                                            <dt>Line Number</dt>
+                                            <dd>{{ frame.lineno }}</dd>
+                                        {% endif %}
+                                        {% if not frame.colno|is_none %}
+                                            <dt>Column Number</dt>
+                                            <dd>{{ frame.colno }}</dd>
+                                        {% endif %}
+                                        {% if frame.function %}
+                                            <dt>Function</dt>
+                                            <dd>{{ frame.function }}</dd>
+                                        {% endif %}
+                                    </dl>">?</a>
+                            {% endif %}
+                            {% if frame.is_url %}
+                                </a>
+                            {% endif %}
                         {% elif frame.module %}
                             <code>{{ frame.module }}</code>
                         {% endif %}
-                        {% if frame.sourcemap %}
-                             <a href="#" class="annotation tip" rel="tooltip" data-placement="right" data-title="Occurred in {{ frame.orig_filename }} (line {{ frame.orig_lineno }})<br>(via {{ frame.sourcemap }})">?</a>
-                        {% endif %}
                         {% if frame.function %}
                              {% if frame.filename or frame.module %}in {% endif %}<code>{{ frame.function }}</code>
                         {% endif %}
diff --git a/src/sentry/templatetags/sentry_helpers.py b/src/sentry/templatetags/sentry_helpers.py
index f88a6e02a4..898d5d9c86 100644
--- a/src/sentry/templatetags/sentry_helpers.py
+++ b/src/sentry/templatetags/sentry_helpers.py
@@ -98,6 +98,11 @@ def to_str(data):
     return str(data)
 
 
+@register.filter
+def is_none(value):
+    return value is None
+
+
 @register.simple_tag
 def sentry_version():
     import sentry
