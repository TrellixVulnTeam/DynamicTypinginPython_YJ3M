commit 1a27fb624b82ba065fe658941963459ef7cbcb68
Author: Jess MacQueen <jessmacqueen@gmail.com>
Date:   Mon Jul 23 17:12:56 2018 -0700

    ref(integrations): Move config saving to method

diff --git a/src/sentry/api/endpoints/organization_integration_details.py b/src/sentry/api/endpoints/organization_integration_details.py
index 86fb7d805a..ac70304f77 100644
--- a/src/sentry/api/endpoints/organization_integration_details.py
+++ b/src/sentry/api/endpoints/organization_integration_details.py
@@ -6,7 +6,7 @@ from sentry.api.bases.organization import (
     OrganizationEndpoint, OrganizationIntegrationsPermission
 )
 from sentry.api.serializers import serialize
-from sentry.models import OrganizationIntegration, ProjectIntegration
+from sentry.models import Integration, OrganizationIntegration, ProjectIntegration
 
 
 class OrganizationIntegrationDetailsEndpoint(OrganizationEndpoint):
@@ -39,15 +39,14 @@ class OrganizationIntegrationDetailsEndpoint(OrganizationEndpoint):
 
     def post(self, request, organization, integration_id):
         try:
-            integration = OrganizationIntegration.objects.get(
-                integration_id=integration_id,
-                organization=organization,
+            integration = Integration.objects.get(
+                id=integration_id,
+                organizations=organization,
             )
-        except OrganizationIntegration.DoesNotExist:
+        except Integration.DoesNotExist:
             raise Http404
 
-        config = integration.config
-        config.update(request.DATA)
-        integration.update(config=config)
+        installation = integration.get_installation(organization.id)
+        installation.update_organization_config(request.DATA)
 
         return self.respond(status=200)
diff --git a/src/sentry/integrations/base.py b/src/sentry/integrations/base.py
index 43135d4ff0..a0d3e24641 100644
--- a/src/sentry/integrations/base.py
+++ b/src/sentry/integrations/base.py
@@ -189,6 +189,14 @@ class Integration(object):
         """
         return []
 
+    def update_organization_config(self, data):
+        """
+        Update the configuration field for an organization integration.
+        """
+        config = self.org_integration.config
+        config.update(data)
+        self.org_integration.update(config=config)
+
     def get_project_config(self):
         """
         Provides configuration for the integration on a per-project
