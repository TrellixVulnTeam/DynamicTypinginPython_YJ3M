commit 308da9198d30079d705cc60e2ad2a838cfff013f
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 1 09:52:36 2014 -0800

    Remove access group management pages

diff --git a/src/sentry/templates/sentry/bases/team.html b/src/sentry/templates/sentry/bases/team.html
index b16d48d603..448f5e4673 100644
--- a/src/sentry/templates/sentry/bases/team.html
+++ b/src/sentry/templates/sentry/bases/team.html
@@ -13,7 +13,6 @@
             </a>
             <ul class="dropdown-menu">
                 <li><a href="{% url 'sentry-new-project' team.slug %}">{% trans "New Project" %}</a></li>
-                <li><a href="{% url 'sentry-new-access-group' team.slug %}">{% trans "New Access Group" %}</a></li>
             </ul>
         </div>
 
@@ -24,11 +23,6 @@
             <li{% block team_projects_nav %}{% endblock %}>
                 <a href="{% url 'sentry-manage-team-projects' team.slug %}">{% trans "Projects" %}</a>
             </li>
-            {% if team|has_access_groups %}
-                <li{% block team_accessgroups_nav %}{% endblock %}>
-                    <a href="{% url 'sentry-manage-access-groups' team.slug %}">{% trans "Access Groups" %}</a>
-                </li>
-            {% endif %}
         </ul>
 
         {% block inner %}
diff --git a/src/sentry/templates/sentry/teams/groups/details.html b/src/sentry/templates/sentry/teams/groups/details.html
deleted file mode 100644
index 082b48e2e8..0000000000
--- a/src/sentry/templates/sentry/teams/groups/details.html
+++ /dev/null
@@ -1,52 +0,0 @@
-{% extends "sentry/teams/groups/list.html" %}
-
-{% load crispy_forms_tags %}
-{% load i18n %}
-{% load sentry_helpers %}
-
-{% block title %}
-    {{ group.name }} | {{ block.super }}
-{% endblock %}
-
-{% block bodyclass %} with-left-sidebar{% endblock %}
-
-{% block sidebar %}
-    <select style="margin-left:-14px" onchange="window.location.href=$(this.options[this.selectedIndex]).data('url');">
-        {% for g in group_list %}
-            <option {% if g == group %} selected="selected"{% endif %} data-url="{% url 'sentry-edit-access-group' g.team.slug g.id %}">{{ g.name }}</option>
-        {% endfor %}
-    </select>
-    <ul class="nav nav-list">
-        <li class="nav-header">{% trans "Access Group" %}</li>
-        <li{% if page == 'details' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-edit-access-group' group.team.slug group.id %}">{% trans "Settings" %}</a>
-        </li>
-        <li{% if page == 'members' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-access-group-members' group.team.slug group.id %}">{% trans "Members" %}</a>
-        </li>
-        <li{% if page == 'projects' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-access-group-projects' group.team.slug group.id %}">{% trans "Projects" %}</a>
-        </li>
-    </ul>
-{% endblock %}
-
-{% block inner %}
-    <div class="page-header">
-        <h2>{% trans "Group Settings" %}</h2>
-    </div>
-
-    <form action="" method="post">
-        {% csrf_token %}
-        {{ form|as_crispy_errors }}
-
-        {% for field in form %}
-            {{ field|as_crispy_field }}
-        {% endfor %}
-
-        <fieldset class="form-actions">
-            <button type="submit" class="btn btn-primary">{% trans "Save Changes" %}</button>
-            <a href="{% url 'sentry-remove-access-group' group.team.slug group.id %}" class="btn btn-danger">{% trans "Remove Access Group" %}</a>
-        </fieldset>
-    </form>
-    
-{% endblock %}
diff --git a/src/sentry/templates/sentry/teams/groups/list.html b/src/sentry/templates/sentry/teams/groups/list.html
deleted file mode 100644
index 90d64ecffd..0000000000
--- a/src/sentry/templates/sentry/teams/groups/list.html
+++ /dev/null
@@ -1,41 +0,0 @@
-{% extends "sentry/bases/team.html" %}
-
-{% load i18n %}
-{% load sentry_helpers %}
-
-{% block title %}{% trans "Access Groups" %} | {{ block.super }}{% endblock %}
-
-{% block team_accessgroups_nav %} class="active"{% endblock %}
-
-{% block inner %}
-    {% if group_list %}
-        <table class="table table-striped">
-            <colgroup>
-                <col/>
-                <col width="100px"/>
-                <col width="100px"/>
-            </colgroup>
-            <thead>
-                <tr>
-                    <th>{% trans "Name" %}</th>
-                    <th style="text-align:center;">{% trans "Access Type" %}</th>
-                    <th style="text-align:center">{% trans "Actions" %}</th>
-                </tr>
-            </thead>
-            <tbody>
-                {% for group in group_list %}
-                    <tr>
-                        <td><a href="{% url 'sentry-edit-access-group' team.slug group.id %}">{{ group.name }}</a>{% if group.managed %} ({% trans "automatically managed" %}){% endif %}</td>
-                        <td style="text-align:center">{{ group.get_type_display }}</td>
-                        <td style="text-align:center">
-                            <a href="{% url 'sentry-remove-access-group' team.slug group.id %}"
-                               class="btn btn-small btn-danger">{% trans "Remove" %}</a>
-                        </td>
-                    </tr>
-                {% endfor %}
-            </tbody>
-        </table>
-    {% else %}
-        <p>{% trans "You have not created any access groups yet." %}</p>
-    {% endif %}
-{% endblock %}
diff --git a/src/sentry/templates/sentry/teams/groups/members.html b/src/sentry/templates/sentry/teams/groups/members.html
deleted file mode 100644
index 5160fe09fe..0000000000
--- a/src/sentry/templates/sentry/teams/groups/members.html
+++ /dev/null
@@ -1,58 +0,0 @@
-{% extends "sentry/teams/groups/details.html" %}
-
-{% load crispy_forms_tags %}
-{% load i18n %}
-{% load sentry_helpers %}
-
-{% block title %}
-    {% trans "Members" %} | {{ block.super }}
-{% endblock %}
-
-{% block inner %}
-    <div class="page-header">
-        <h2>{% trans "Group Members" %}</h2>
-    </div>
-
-    {% if member_list %}
-        <table class="table table-striped">
-            <colgroup>
-                <col/>
-                <col width="100px"/>
-                <col width="180px"/>
-            </colgroup>
-            <thead>
-                <tr>
-                    <th>{% trans "User" %}</th>
-                    <th style="text-align:center">{% trans "Actions" %}</th>
-                </tr>
-            </thead>
-            <tbody>
-                {% for member in member_list %}
-                    <tr>
-                        <td>
-                            <strong>{% if member.first_name %}{{ member.first_name }} &mdash; {% endif %}{{ member.username }}</strong><br>
-                            {{ member.email }}
-                        </td>
-                        <td style="text-align:center;">
-                            <a href="{% url 'sentry-remove-access-group-member' group.team.slug group.id member.id %}" class="btn">{% trans "Remove" %}</a>
-                        </td>
-                    </tr>
-                {% endfor %}
-            </tbody>
-        </table>
-    {% else %}
-        <p>{% trans "There are no members assigned to this group." %}
-    {% endif %}
-
-    <form action="" method="post" class="form-search">
-        {% csrf_token %}
-        {{ form|as_crispy_errors }}
-
-        {{ form.user }} <button type="submit" class="btn btn-primary" style="padding: 6px 10px; margin-left: 5px">{% trans "Add Member" %}</button>
-    </form>
-
-    <script type="text/javascript">
-    new app.AccessGroupMembersPage();
-    </script>
-
-{% endblock %}
diff --git a/src/sentry/templates/sentry/teams/groups/new.html b/src/sentry/templates/sentry/teams/groups/new.html
deleted file mode 100644
index d7ee84e6fc..0000000000
--- a/src/sentry/templates/sentry/teams/groups/new.html
+++ /dev/null
@@ -1,13 +0,0 @@
-{% extends "sentry/teams/groups/list.html" %}
-
-{% load i18n %}
-
-{% block title %}{% trans "New Access Group" %} | {{ block.super }}{% endblock %}
-
-{% block inner %}
-    <div class="page-header">
-        <h2>{% trans "New Access Group" %}</h2>
-    </div>
-
-    {% include "sentry/partial/_form.html" %}
-{% endblock %}
diff --git a/src/sentry/templates/sentry/teams/groups/projects.html b/src/sentry/templates/sentry/teams/groups/projects.html
deleted file mode 100644
index 436feedab4..0000000000
--- a/src/sentry/templates/sentry/teams/groups/projects.html
+++ /dev/null
@@ -1,58 +0,0 @@
-{% extends "sentry/teams/groups/details.html" %}
-
-{% load crispy_forms_tags %}
-{% load i18n %}
-{% load sentry_helpers %}
-
-{% block title %}
-    {% trans "Projects" %} | {{ block.super }}
-{% endblock %}
-
-
-{% block inner %}
-    <div class="page-header">
-        <h2>{% trans "Group Projects" %}</h2>
-    </div>
-
-    {% if project_list %}
-        <table class="table table-striped">
-            <colgroup>
-                <col/>
-                <col width="100px"/>
-                <col width="180px"/>
-            </colgroup>
-            <thead>
-                <tr>
-                    <th>{% trans "Project" %}</th>
-                    <th style="text-align:center">{% trans "Actions" %}</th>
-                </tr>
-            </thead>
-            <tbody>
-                {% for project in project_list %}
-                    <tr>
-                        <td>
-                            {{ project.name }} &mdash; {{ project.slug }}
-                        </td>
-                        <td style="text-align:center;">
-                            <a href="{% url 'sentry-remove-access-group-project' group.team.slug group.id project.id %}" class="btn">{% trans "Remove" %}</a>
-                        </td>
-                    </tr>
-                {% endfor %}
-            </tbody>
-        </table>
-    {% else %}
-        <p>{% trans "There are no projects assigned to this group." %}
-    {% endif %}
-
-    <form action="" method="post" class="form-search">
-        {% csrf_token %}
-        {{ form|as_crispy_errors }}
-
-        {{ form.project }} <button type="submit" class="btn btn-primary" style="padding: 6px 10px; margin-left: 5px">{% trans "Add Project" %}</button>
-    </form>
-
-    <script type="text/javascript">
-    new app.AccessGroupProjectsPage();
-    </script>
-
-{% endblock %}
diff --git a/src/sentry/templates/sentry/teams/groups/remove.html b/src/sentry/templates/sentry/teams/groups/remove.html
deleted file mode 100644
index 3b7d2803f7..0000000000
--- a/src/sentry/templates/sentry/teams/groups/remove.html
+++ /dev/null
@@ -1,22 +0,0 @@
-{% extends "sentry/teams/groups/details.html" %}
-
-{% load crispy_forms_tags %}
-{% load i18n %}
-
-{% block title %}{% trans "Remove Access Group" %} | {{ block.super }}{% endblock %}
-
-{% block main %}
-    <section class="body">
-        <form action="" method="post">
-            <p>{% trans "Are you sure you wish to remove this access group? This change is permanent!" %}</p>
-            {% csrf_token %}
-            {{ form|as_crispy_errors }}
-            {% for field in form %}
-                {{ field|as_crispy_field }}
-            {% endfor %}
-            <fieldset class="form-actions">
-                <button type="submit" class="btn btn-danger">{% trans "Confirm" %}</button> <a href="{% url 'sentry-manage-access-groups' group.team.slug %}" class="btn">{% trans "Cancel" %}</a>
-            </fieldset>
-        </form>
-    </section>
-{% endblock %}
diff --git a/src/sentry/web/frontend/create_access_group.py b/src/sentry/web/frontend/create_access_group.py
deleted file mode 100644
index 54e1fffdf9..0000000000
--- a/src/sentry/web/frontend/create_access_group.py
+++ /dev/null
@@ -1,56 +0,0 @@
-from __future__ import absolute_import
-
-from django import forms
-from sentry.constants import MEMBER_TYPES, MEMBER_USER
-from django.core.urlresolvers import reverse
-from django.http import HttpResponseRedirect
-from django.utils.translation import ugettext_lazy as _
-
-from sentry.models import OrganizationMemberType, AccessGroup
-from sentry.web.frontend.base import TeamView
-
-
-class NewAccessGroupForm(forms.ModelForm):
-    name = forms.CharField(label=_('Group Name'), max_length=200,
-        widget=forms.TextInput(attrs={'placeholder': _('API Team')}))
-    type = forms.ChoiceField(label=_('Access Type'), choices=MEMBER_TYPES,
-        help_text=_('Members will gain this level of access to all projects assigned to this group.'))
-
-    class Meta:
-        fields = ('name', 'type')
-        model = AccessGroup
-
-
-class CreateAccessGroupView(TeamView):
-    required_access = OrganizationMemberType.ADMIN
-
-    def get_form(self, request):
-        initial = {
-            'type': MEMBER_USER,
-        }
-
-        return NewAccessGroupForm(request.POST or None, initial=initial)
-
-    def get(self, request, organization, team):
-        form = self.get_form(request)
-
-        context = {
-            'form': form,
-        }
-
-        return self.respond('sentry/teams/groups/new.html', context)
-
-    def post(self, request, organization, team):
-        form = self.get_form(request)
-        if form.is_valid():
-            inst = form.save(commit=False)
-            inst.team = team
-            inst.managed = False
-            inst.save()
-            return HttpResponseRedirect(reverse('sentry-manage-access-groups', args=[team.slug]))
-
-        context = {
-            'form': form,
-        }
-
-        return self.respond('sentry/teams/groups/new.html', context)
diff --git a/src/sentry/web/frontend/team_access_groups.py b/src/sentry/web/frontend/team_access_groups.py
deleted file mode 100644
index 3216d08b12..0000000000
--- a/src/sentry/web/frontend/team_access_groups.py
+++ /dev/null
@@ -1,15 +0,0 @@
-from __future__ import absolute_import
-
-from sentry.models import AccessGroup, OrganizationMemberType
-from sentry.web.frontend.base import TeamView
-
-
-class TeamAccessGroupsView(TeamView):
-    required_access = OrganizationMemberType.MEMBER
-
-    def get(self, request, organization, team):
-        context = {
-            'group_list': AccessGroup.objects.filter(team=team),
-        }
-
-        return self.respond('sentry/teams/groups/list.html', context)
diff --git a/src/sentry/web/frontend/teams.py b/src/sentry/web/frontend/teams.py
deleted file mode 100644
index c20c3c5391..0000000000
--- a/src/sentry/web/frontend/teams.py
+++ /dev/null
@@ -1,187 +0,0 @@
-"""
-sentry.web.frontend.teams
-~~~~~~~~~~~~~~~~~~~~~~~~~
-
-:copyright: (c) 2012 by the Sentry Team, see AUTHORS for more details.
-:license: BSD, see LICENSE for more details.
-"""
-from __future__ import absolute_import
-
-from django.contrib import messages
-from django.core.context_processors import csrf
-from django.core.urlresolvers import reverse
-from django.http import HttpResponseRedirect
-from django.views.decorators.csrf import csrf_protect
-from django.utils.translation import ugettext as _
-
-from sentry.constants import MEMBER_OWNER
-from sentry.models import AccessGroup, User
-from sentry.web.decorators import has_access
-from sentry.web.forms.teams import (
-    EditAccessGroupForm, NewAccessGroupMemberForm,
-    NewAccessGroupProjectForm, RemoveAccessGroupForm
-)
-from sentry.web.helpers import render_to_response
-
-
-def render_with_team_context(team, template, context, request=None):
-    context.update({
-        'team': team,
-        'SECTION': 'team',
-    })
-
-    return render_to_response(template, context, request)
-
-
-@has_access(MEMBER_OWNER)
-@csrf_protect
-def access_group_details(request, team, group_id):
-    try:
-        group = AccessGroup.objects.get(team=team, id=group_id)
-    except AccessGroup.DoesNotExist:
-        return HttpResponseRedirect(reverse('sentry-manage-access-groups', args=[team.slug]))
-
-    form = EditAccessGroupForm(request.POST or None, instance=group)
-    if form.is_valid():
-        form.save()
-
-    context = csrf(request)
-    context.update({
-        'group': group,
-        'form': form,
-        'group_list': AccessGroup.objects.filter(team=team),
-        'page': 'details',
-        'SUBSECTION': 'groups',
-    })
-
-    return render_with_team_context(team, 'sentry/teams/groups/details.html', context, request)
-
-
-@has_access(MEMBER_OWNER)
-@csrf_protect
-def remove_access_group(request, team, group_id):
-    try:
-        group = AccessGroup.objects.get(team=team, id=group_id)
-    except AccessGroup.DoesNotExist:
-        return HttpResponseRedirect(reverse('sentry-manage-access-groups', args=[team.slug]))
-
-    if request.method == 'POST':
-        form = RemoveAccessGroupForm(request.POST)
-    else:
-        form = RemoveAccessGroupForm()
-
-    if form.is_valid():
-        group.delete()
-
-        messages.add_message(request, messages.SUCCESS,
-            _('%s was permanently removed.') % (group.name,))
-
-        return HttpResponseRedirect(reverse('sentry-manage-access-groups', args=[team.slug]))
-
-    context = csrf(request)
-    context.update({
-        'form': form,
-        'group': group,
-        'page': 'details',
-        'SUBSECTION': 'groups',
-    })
-
-    return render_with_team_context(team, 'sentry/teams/groups/remove.html', context, request)
-
-
-@has_access(MEMBER_OWNER)
-@csrf_protect
-def access_group_members(request, team, group_id):
-    try:
-        group = AccessGroup.objects.get(team=team, id=group_id)
-    except AccessGroup.DoesNotExist:
-        return HttpResponseRedirect(reverse('sentry-manage-access-groups', args=[team.slug]))
-
-    form = NewAccessGroupMemberForm(request.POST or None)
-    if form.is_valid():
-        user = form.cleaned_data['user']
-        group.members.add(user)
-
-        messages.add_message(request, messages.SUCCESS,
-            _('%s was added to this access group.') % (user.email,))
-
-        return HttpResponseRedirect(reverse('sentry-access-group-members', args=[team.slug, group.id]))
-
-    context = csrf(request)
-    context.update({
-        'group': group,
-        'form': form,
-        'member_list': group.members.all(),
-        'group_list': AccessGroup.objects.filter(team=team),
-        'page': 'members',
-        'SUBSECTION': 'groups',
-    })
-
-    return render_with_team_context(team, 'sentry/teams/groups/members.html', context, request)
-
-
-@csrf_protect
-@has_access(MEMBER_OWNER)
-def remove_access_group_member(request, team, group_id, user_id):
-    try:
-        group = AccessGroup.objects.get(team=team, id=group_id)
-    except AccessGroup.DoesNotExist:
-        return HttpResponseRedirect(reverse('sentry-access-group-members', args=[team.slug, group.id]))
-
-    try:
-        user = User.objects.get(id=user_id)
-    except User.DoesNotExist:
-        return HttpResponseRedirect(reverse('sentry-access-group-members', args=[team.slug, group.id]))
-
-    group.members.remove(user)
-
-    return HttpResponseRedirect(reverse('sentry-access-group-members', args=[team.slug, group.id]))
-
-
-@has_access(MEMBER_OWNER)
-@csrf_protect
-def access_group_projects(request, team, group_id):
-    try:
-        group = AccessGroup.objects.get(team=team, id=group_id)
-    except AccessGroup.DoesNotExist:
-        return HttpResponseRedirect(reverse('sentry-manage-access-groups', args=[team.slug]))
-
-    form = NewAccessGroupProjectForm(group, request.POST or None)
-    if form.is_valid():
-        project = form.cleaned_data['project']
-        group.projects.add(project)
-
-        messages.add_message(request, messages.SUCCESS,
-            _('%s was added to this access group.') % (project.name,))
-
-        return HttpResponseRedirect(reverse('sentry-access-group-projects', args=[team.slug, group.id]))
-
-    group_list = list(AccessGroup.objects.filter(team=team))
-    for g_ in group_list:
-        g_.team = team
-
-    context = csrf(request)
-    context.update({
-        'group': group,
-        'form': form,
-        'project_list': group.projects.all(),
-        'group_list': group_list,
-        'page': 'projects',
-        'SUBSECTION': 'groups',
-    })
-
-    return render_with_team_context(team, 'sentry/teams/groups/projects.html', context, request)
-
-
-@csrf_protect
-@has_access(MEMBER_OWNER)
-# XXX: has_access is automatically converting project for us
-def remove_access_group_project(request, team, group_id, project):
-    try:
-        group = AccessGroup.objects.get(team=team, id=group_id)
-    except AccessGroup.DoesNotExist:
-        return HttpResponseRedirect(reverse('sentry-access-group-projects', args=[team.slug, group.id]))
-
-    group.projects.remove(project)
-
-    return HttpResponseRedirect(reverse('sentry-access-group-projects', args=[team.slug, group.id]))
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index d71775b737..3a4f6769c9 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -20,7 +20,7 @@ from django.conf import settings
 from sentry.web import api
 from sentry.web.frontend import (
     alerts, accounts, generic, groups, events,
-    admin, docs, teams, users, explore, explore_code)
+    admin, docs, users, explore, explore_code)
 
 import sentry.web.frontend.projects.general
 import sentry.web.frontend.projects.keys
@@ -40,7 +40,6 @@ from sentry.web.frontend.organization_members import OrganizationMembersView
 from sentry.web.frontend.organization_member_settings import OrganizationMemberSettingsView
 from sentry.web.frontend.organization_settings import OrganizationSettingsView
 from sentry.web.frontend.organization_teams import OrganizationTeamsView
-from sentry.web.frontend.create_access_group import CreateAccessGroupView
 from sentry.web.frontend.create_organization import CreateOrganizationView
 from sentry.web.frontend.create_organization_member import CreateOrganizationMemberView
 from sentry.web.frontend.create_project import CreateProjectView
@@ -48,7 +47,6 @@ from sentry.web.frontend.create_team import CreateTeamView
 from sentry.web.frontend.project_settings import ProjectSettingsView
 from sentry.web.frontend.remove_project import RemoveProjectView
 from sentry.web.frontend.remove_team import RemoveTeamView
-from sentry.web.frontend.team_access_groups import TeamAccessGroupsView
 from sentry.web.frontend.team_projects import TeamProjectsView
 from sentry.web.frontend.team_settings import TeamSettingsView
 
@@ -145,22 +143,6 @@ urlpatterns += patterns('',
         name='sentry-manage-team'),
     url(r'^account/teams/(?P<team_slug>[\w_-]+)/remove/$', RemoveTeamView.as_view(),
         name='sentry-remove-team'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/$', TeamAccessGroupsView.as_view(),
-        name='sentry-manage-access-groups'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/new/$', CreateAccessGroupView.as_view(),
-        name='sentry-new-access-group'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/(?P<group_id>\d+)/edit/$', teams.access_group_details,
-        name='sentry-edit-access-group'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/(?P<group_id>\d+)/remove/$', teams.remove_access_group,
-        name='sentry-remove-access-group'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/(?P<group_id>\d+)/members/$', teams.access_group_members,
-        name='sentry-access-group-members'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/(?P<group_id>\d+)/members/(?P<user_id>\d+)/remove/$',
-        teams.remove_access_group_member, name='sentry-remove-access-group-member'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/(?P<group_id>\d+)/projects/$', teams.access_group_projects,
-        name='sentry-access-group-projects'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/(?P<group_id>\d+)/projects/(?P<project_id>\d+)/remove/$',
-        teams.remove_access_group_project, name='sentry-remove-access-group-project'),
     url(r'^account/teams/(?P<team_slug>[\w_-]+)/projects/$', TeamProjectsView.as_view(),
         name='sentry-manage-team-projects'),
     url(r'^account/teams/(?P<team_slug>[\w_-]+)/projects/new/$', CreateProjectView.as_view(),
