commit af9636229b6ba397d2152758ef04afce5e846172
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Aug 11 15:41:24 2016 -0700

    Restrict Auth settings to Owner (#3918)
    
    * Restrict Auth settings to Owner
    
    This changes Auth so that it can only be modified and configured by an Owner of the ornanization. This incidentally fixes a role escalation issue wherein a Manager could change the default_role to Owner, have a new user authentication, and then escalate themselves to Owner via that new user.
    
    @getsentry/security

diff --git a/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx b/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx
index 0291f53ad9..0aa51ca716 100644
--- a/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx
@@ -70,7 +70,7 @@ const HomeSidebar = React.createClass({
                   </a>
                 </li>
               }
-              {features.has('sso') && access.has('org:write') &&
+              {features.has('sso') && access.has('org:delete') &&
                 <li><a href={urlPrefix + '/auth/'}>{t('Auth')}</a></li>
               }
               {access.has('org:delete') && features.has('api-keys') &&
diff --git a/src/sentry/web/frontend/organization_auth_settings.py b/src/sentry/web/frontend/organization_auth_settings.py
index 88d837faba..cf2e12d99a 100644
--- a/src/sentry/web/frontend/organization_auth_settings.py
+++ b/src/sentry/web/frontend/organization_auth_settings.py
@@ -39,7 +39,9 @@ class AuthProviderSettingsForm(forms.Form):
 
 
 class OrganizationAuthSettingsView(OrganizationView):
-    required_scope = 'org:write'
+    # We restrict auth settings to org:delete as it allows a non-owner to
+    # escalate members to own by disabling the default role.
+    required_scope = 'org:delete'
 
     def _disable_provider(self, request, organization, auth_provider):
         self.create_audit_entry(
