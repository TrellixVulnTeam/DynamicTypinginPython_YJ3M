commit 5236bf5c8900fe8f21c3f9bf74e8d2af6f2668ab
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Thu Jun 9 22:29:30 2016 +0200

    Use the same logic for package trimming on culprit as we have for the UI

diff --git a/src/sentry/interfaces/stacktrace.py b/src/sentry/interfaces/stacktrace.py
index 0c649acc34..6f4bf9d7f7 100644
--- a/src/sentry/interfaces/stacktrace.py
+++ b/src/sentry/interfaces/stacktrace.py
@@ -40,6 +40,15 @@ _java_enhancer_re = re.compile(r'''
 ''', re.X)
 
 
+def trim_package(pkg):
+    if not pkg:
+        return '?'
+    pkg = pkg.split('/')[-1]
+    if pkg.endswith(('.dylib', '.so', '.a')):
+        pkg = pkg.rsplit('.', 1)[0]
+    return pkg
+
+
 def get_context(lineno, context_line, pre_context=None, post_context=None, filename=None):
     if lineno is None:
         return []
@@ -440,7 +449,7 @@ class Frame(Interface):
         if platform in ('objc', 'cocoa'):
             return '%s (%s)' % (
                 self.function or '?',
-                self.package or '?',
+                trim_package(self.package),
             )
         fileloc = self.module or self.filename
         if not fileloc:
