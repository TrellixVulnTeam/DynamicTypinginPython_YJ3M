commit f89a0abce4556134aee75ea3286dca61ee1adbe1
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Dec 14 15:45:29 2014 -0800

    Correct team => project in urls

diff --git a/src/sentry/admin.py b/src/sentry/admin.py
index 6d7c51d28c..f5fdc08e93 100644
--- a/src/sentry/admin.py
+++ b/src/sentry/admin.py
@@ -44,7 +44,7 @@ class ProjectAdmin(admin.ModelAdmin):
         if not instance.team:
             slug = instance.slug
         else:
-            slug = '%s/%s' % (instance.team.slug, instance.slug)
+            slug = '%s/%s' % (instance.organization.slug, instance.slug)
         return mark_safe('%s<br><small>%s</small>' % (
             escape(slug), escape(instance.name)))
 
diff --git a/src/sentry/api/serializers/models/group.py b/src/sentry/api/serializers/models/group.py
index 692e8cbe55..273e5a691f 100644
--- a/src/sentry/api/serializers/models/group.py
+++ b/src/sentry/api/serializers/models/group.py
@@ -80,7 +80,7 @@ class GroupSerializer(Serializer):
 
         if obj.team:
             permalink = absolute_uri(reverse('sentry-group', args=[
-                obj.team.slug, obj.project.slug, obj.id]))
+                obj.organization.slug, obj.project.slug, obj.id]))
         else:
             permalink = None
 
diff --git a/src/sentry/coreapi.py b/src/sentry/coreapi.py
index 0e2fdba1d9..303d91dafd 100644
--- a/src/sentry/coreapi.py
+++ b/src/sentry/coreapi.py
@@ -107,12 +107,15 @@ def client_metadata(client=None, project=None, exception=None, tags=None, extra=
         if project.team:
             extra['team_slug'] = project.team.slug
             extra['team_id'] = project.team.id
+        if project.organization:
+            extra['organization_slug'] = project.organization.slug
+            extra['organization_id'] = project.organization.id
 
     tags['client'] = client
     if exception:
         tags['exc_type'] = type(exception).__name__
-    if project and project.team:
-        tags['project'] = '%s/%s' % (project.team.slug, project.slug)
+    if project and project.organization:
+        tags['project'] = '%s/%s' % (project.organization.slug, project.slug)
 
     result = {'extra': extra}
     if exception:
diff --git a/src/sentry/models/alert.py b/src/sentry/models/alert.py
index d6446f1cfe..7b3dde53ae 100644
--- a/src/sentry/models/alert.py
+++ b/src/sentry/models/alert.py
@@ -80,6 +80,10 @@ class Alert(Model):
     def team(self):
         return self.project.team
 
+    @property
+    def organization(self):
+        return self.project.organization
+
     @property
     def is_resolved(self):
         return (self.status == STATUS_RESOLVED
@@ -87,7 +91,7 @@ class Alert(Model):
 
     def get_absolute_url(self):
         return absolute_uri(reverse('sentry-alert-details', args=[
-            self.team.slug, self.project.slug, self.id]))
+            self.organization.slug, self.project.slug, self.id]))
 
 
 class AlertRelatedGroup(Model):
diff --git a/src/sentry/models/group.py b/src/sentry/models/group.py
index bd4d0b434b..900a1dcce3 100644
--- a/src/sentry/models/group.py
+++ b/src/sentry/models/group.py
@@ -159,7 +159,7 @@ class Group(Model):
 
     def get_absolute_url(self):
         return absolute_uri(reverse('sentry-group', args=[
-            self.team.slug, self.project.slug, self.id]))
+            self.organization.slug, self.project.slug, self.id]))
 
     @property
     def avg_time_spent(self):
@@ -256,6 +256,10 @@ class Group(Model):
             message = truncatechars(message.splitlines()[0], 100)
         return message
 
+    @property
+    def organization(self):
+        return self.project.organization
+
     @property
     def team(self):
         return self.project.team
diff --git a/src/sentry/models/project.py b/src/sentry/models/project.py
index 8ab26af5dd..a92b71f7d1 100644
--- a/src/sentry/models/project.py
+++ b/src/sentry/models/project.py
@@ -109,7 +109,7 @@ class Project(Model):
 
     def get_absolute_url(self):
         return absolute_uri(reverse('sentry-stream', args=[
-            self.team.slug, self.slug]))
+            self.organization.slug, self.slug]))
 
     def merge_to(self, project):
         from sentry.models import (
diff --git a/src/sentry/models/tagkey.py b/src/sentry/models/tagkey.py
index b11247213b..d92f2e0bcf 100644
--- a/src/sentry/models/tagkey.py
+++ b/src/sentry/models/tagkey.py
@@ -68,7 +68,7 @@ class TagKey(Model):
         except KeyError:
             url_name = self.DEFAULT_URL_NAME
             return absolute_uri(reverse(url_name, args=[
-                self.project.team.slug, self.project.slug, self.key]))
+                self.project.organization.slug, self.project.slug, self.key]))
 
         return absolute_uri(reverse(url_name, args=[
-            self.project.team.slug, self.project.slug]))
+            self.project.organization.slug, self.project.slug]))
diff --git a/src/sentry/models/tagvalue.py b/src/sentry/models/tagvalue.py
index 42c7a2e106..e9795140f3 100644
--- a/src/sentry/models/tagvalue.py
+++ b/src/sentry/models/tagvalue.py
@@ -63,7 +63,7 @@ class TagValue(Model):
         else:
             url_name = 'sentry-explore-tag-value'
             return absolute_uri(reverse(url_name, args=[
-                self.project.team.slug, self.project.slug, self.key, self.id]))
+                self.project.organization.slug, self.project.slug, self.key, self.id]))
 
         return absolute_uri(reverse(url_name, args=[
-            self.project.team.slug, self.project.slug, self.id]))
+            self.project.organization.slug, self.project.slug, self.id]))
diff --git a/src/sentry/plugins/base.py b/src/sentry/plugins/base.py
index 80f8797f51..f2d52cc4ea 100644
--- a/src/sentry/plugins/base.py
+++ b/src/sentry/plugins/base.py
@@ -227,7 +227,7 @@ class IPlugin(local):
 
         >>> plugin.get_url(group)
         """
-        return reverse('sentry-group-plugin-action', args=(group.team.slug, group.project.slug, group.pk, self.slug))
+        return reverse('sentry-group-plugin-action', args=(group.organization.slug, group.project.slug, group.pk, self.slug))
 
     def get_conf_key(self):
         """
diff --git a/src/sentry/plugins/bases/issue.py b/src/sentry/plugins/bases/issue.py
index 11dbd9f01c..c86341a300 100644
--- a/src/sentry/plugins/bases/issue.py
+++ b/src/sentry/plugins/bases/issue.py
@@ -44,7 +44,7 @@ class IssuePlugin(Plugin):
         output = [
             absolute_uri(reverse('sentry-group', kwargs={
                 'project_id': group.project.slug,
-                'team_slug': group.team.slug,
+                'team_slug': group.organization.slug,
                 'group_id': group.id,
             })),
         ]
@@ -190,7 +190,7 @@ class IssuePlugin(Plugin):
                 data=issue_information,
             )
 
-            return self.redirect(reverse('sentry-group', args=[group.team.slug, group.project_id, group.pk]))
+            return self.redirect(reverse('sentry-group', args=[group.organization.slug, group.project_id, group.pk]))
 
         context = {
             'form': form,
diff --git a/src/sentry/plugins/sentry_mail/models.py b/src/sentry/plugins/sentry_mail/models.py
index 19957c4d46..a0cf8e2433 100644
--- a/src/sentry/plugins/sentry_mail/models.py
+++ b/src/sentry/plugins/sentry_mail/models.py
@@ -68,7 +68,7 @@ class MailPlugin(NotificationPlugin):
 
     def get_project_url(self, project):
         return absolute_uri(reverse('sentry-stream', args=[
-            project.team.slug,
+            project.organization.slug,
             project.slug,
         ]))
 
diff --git a/src/sentry/static/sentry/scripts/app.js b/src/sentry/static/sentry/scripts/app.js
index f2187c66b6..423cfdb0f3 100644
--- a/src/sentry/static/sentry/scripts/app.js
+++ b/src/sentry/static/sentry/scripts/app.js
@@ -340,7 +340,7 @@
                                 var tagValue = item[0],
                                     timesSeen = item[1],
                                     percent = parseInt(timesSeen / total * 100, 10),
-                                    url = app.config.urlPrefix + '/' + app.config.teamId + '/' + app.config.projectId + '/';
+                                    url = app.config.urlPrefix + '/' + app.config.organizationId + '/' + app.config.projectId + '/';
 
                                 $('<li>' +
                                     '<div class="progressbar">' +
diff --git a/src/sentry/static/sentry/scripts/global.min.js b/src/sentry/static/sentry/scripts/global.min.js
index 934837bfff..1f8cb1ff13 100644
--- a/src/sentry/static/sentry/scripts/global.min.js
+++ b/src/sentry/static/sentry/scripts/global.min.js
@@ -1,3 +1,3 @@
-app=window.app={config:{},templates:{},utils:{}};(function(app,Backbone){"use strict";app.models={};app.models.Group=Backbone.Model.extend({defaults:{count:0,version:0,annotations:[],tags:[],hasSeen:false,isBookmarked:false,historicalData:[]}})})(app,Backbone);(function(app){"use strict";app.templates={group:""+'<div class="count" data-count="<%= app.utils.formatNumber(count) %>">'+'<span title="<%= count %>"><%= app.utils.formatNumber(count) %></span>'+"</div>"+'<div class="details">'+'<h3><a href="<%= permalink %>"><%= title %></a></h3>'+'<p class="message">'+"<%= message %>"+"</p>"+'<div class="meta">'+"<% $.each(annotations, function(_, tag) { %>"+'<span class="tag annotation" data-tag="<%= tag.label %>" data-count="<%= app.utils.formatNumber(tag.count) %>">'+"<i><%= tag.label %></i>"+'<span title="<%= count %>"><%= app.utils.formatNumber(tag.count) %></span>'+"</span>"+"<% }) %>"+'<span class="last-seen pretty-date"></span>'+"<% if (timeSpent) { %>"+'<span class="tag time-spent"><%= Math.round(timeSpent) %>ms</span>'+"<% } %>"+'<span class="tag tag-project">'+'<a href="<%= projectUrl %>"><%= project.name %></a>'+"</span>"+'<span class="tag tag-logger">'+'<a href="<%= loggerUrl %>"><%= logger %></a>'+"</span>"+"<% _.each(tags, function(tag){ %> "+'<span class="tag"><%= tag %></span>'+"<% }) %>"+"</div>"+'<span class="sparkline"></span>'+'<ul class="actions">'+"<% if (canResolve) { %>"+"<li>"+'<a href="#" data-action="resolve">'+'<i aria-hidden="true" class="icon-checkmark"></i>'+"</a>"+"</li>"+"<li>"+'<a href="#" data-action="bookmark" class="bookmark" title="Bookmark">'+'<i aria-hidden="true" class="icon-star"></i>'+"</a>"+"</li>"+"<% } %>"+"</ul>"+"</div>"}})(app);(function(app,jQuery,_,moment){"use strict";var $=jQuery;var number_formats=[[1e9,"b"],[1e6,"m"],[1e3,"k"]];app.utils={getQueryParams:function(){var vars={},href=window.location.href,hashes,hash;if(href.indexOf("?")==-1)return vars;hashes=href.slice(href.indexOf("?")+1,href.indexOf("#")!=-1?href.indexOf("#"):href.length).split("&");$.each(hashes,function(_,chunk){hash=chunk.split("=");if(!hash[0]&&!hash[1])return;vars[decodeURIComponent(hash[0])]=hash[1]?decodeURIComponent(hash[1]).replace(/\+/," "):""});return vars},floatFormat:function(number,places){var multi=Math.pow(10,places);return parseInt(number*multi,10)/multi},formatNumber:function(number){var b,x,y,o,p;number=parseInt(number,10);for(var i=0;b=number_formats[i];i++){x=b[0];y=b[1];o=Math.floor(number/x);p=number%x;if(o>0){if(o/10>1||!p)return""+o+y;return""+this.floatFormat(number/x,1)+y}}return""+number},slugify:function(str){str=str.replace(/^\s+|\s+$/g,"");str=str.toLowerCase();var from="àáäâèéëêìíïîòóöôùúüûñç·/_,:;";var to="aaaaeeeeiiiioooouuuunc------";for(var i=0,l=from.length;i<l;i++){str=str.replace(new RegExp(from.charAt(i),"g"),to.charAt(i))}str=str.replace(/[^a-z0-9\s\-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");return str},varToggle:function(link,$elm){var $link=$(link);if(!$link.attr("data-expand-label"))$link.attr("data-expand-label",$link.html());$elm.toggle();if($elm.is(":visible"))$link.html($link.attr("data-collapse-label"));else $link.html($link.attr("data-expand-label"))},getSearchUsersUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/users/search/"},getSearchProjectsUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/projects/search/"},getSearchTagsUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/tags/search/"},makeSearchableInput:function(el,url,callback,options){$(el).select2($.extend({allowClear:true,width:"element",initSelection:function(el,callback){var $el=$(el);callback({id:$el.val(),text:$el.val()})},ajax:{url:url,dataType:"json",data:function(term,page){return{query:term,limit:10}},results:function(data,page){var results=callback(data);return{results:callback(data)}}}},options||{}))},escape:function(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},makeSearchableUsersInput:function(el){this.makeSearchableInput(el,this.getSearchUsersUrl(),_.bind(function(data){var results=[];$(data.results).each(_.bind(function(_,val){var label;if(val.first_name){label=this.escape(val.first_name)+" &mdash; "+this.escape(val.username)}else{label=this.escape(val.username)}label+="<br>"+this.escape(val.email);results.push({id:val.username,text:label})},this));if(data.query&&$(results).filter(function(){return this.id.localeCompare(data.query)===0}).length===0){results.push({id:this.escape(data.query),text:this.escape(data.query)})}return results},this),{escapeMarkup:function(s){return s}})}};$(function(){$(".body select").each(function(){var $this=$(this),options={width:"element",allowClear:false,minimumResultsForSearch:10};if($this.attr("data-allowClear")){options.allowClear=$this.attr("data-allowClear")}$this.select2(options)});setInterval(function(){$(".pretty-date").each(function(_,el){var $el=$(el);var dt=$el.data("datetime");if(dt){var date=moment(dt);if(date){$el.text(date.fromNow());$el.attr("title",date.format("llll"))}}})},5e3)})})(app,jQuery,_,moment);(function(app,Backbone){"use strict";app.ScoredList=Backbone.Collection.extend({comparator:function(member){return-member.get("score")}})})(app,Backbone);(function(app,Backbone,jQuery,moment){"use strict";var $=jQuery;app.charts={render:function(el,options){var $el=$("#chart");var url=$el.attr("data-api-url");var title=$(el).attr("data-title");var $spark=$el.find(".sparkline");$spark.height($el.height());$.ajax({url:$el.attr("data-api-url"),type:"get",dataType:"json",data:{since:(new Date).getTime()/1e3-3600*24,resolution:"1h"},success:function(resp){var data=[],maxval=10;$spark.empty();$.each(resp,function(_,val){var date=new Date(val[0]*1e3);data.push({y:val[1],label:moment(date).fromNow()});if(val[1]>maxval){maxval=val[1]}});app.charts.createSparkline($spark,data,options)}})},createSparkline:function(el,points,options){var $el=$(el),existing=$el.children(),maxval=10,title,point,pct,child,point_width;if(options===undefined){options={}}for(var i=0;i<points.length;i++){point=points[i];if(typeof point==="number"){point=points[i]={y:point}}if(point.y>maxval){maxval=point.y}}point_width=app.utils.floatFormat(100/points.length,2)+"%";for(i=0;i<points.length;i++){point=points[i];pct=app.utils.floatFormat(point.y/maxval*99,2)+"%";title=point.y+" events";if(point.label){title=title+"<br>("+point.label+")"}if(existing.get(i)===undefined){$('<a style="width:'+point_width+';" rel="tooltip" title="'+title+'"><span style="height:'+pct+'">'+point.y+"</span></a>").tooltip({placement:options.placement||"bottom",html:true,container:"body"}).appendTo($el)}else{$(existing[i]).find("span").css("height",pct).text(point.y).attr("title",point.label||point.y)}}}}})(app,Backbone,jQuery,moment);(function(window,app,Backbone,jQuery,_,moment){"use strict";var $=jQuery;app.GroupView=Backbone.View.extend({tagName:"li",className:"group",template:_.template(app.templates.group),initialize:function(){Backbone.View.prototype.initialize.apply(this,arguments);_.bindAll(this,"updateCount","updateAllAnnotations","updateAnnotation","updateLastSeen","updateResolved","updateHasSeen","renderSparkline","updateBookmarked","render");this.model.on({"change:count":this.updateCount,"change:annotations":this.updateAllAnnotations,"change:lastSeen":this.updateLastSeen,"change:isBookmarked":this.updateBookmarked,"change:isResolved":this.updateResolved,"change:hasSeen":this.updateHasSeen,"change:historicalData":this.renderSparkline},this)},render:function(){var data=this.model.toJSON();data.projectUrl=app.config.urlPrefix+"/"+app.config.teamId+"/"+data.project.slug+"/";data.loggerUrl=data.projectUrl+"?logger="+data.logger;this.$el.html(this.template(data));this.$el.attr("data-id",this.model.id);this.$el.addClass(this.getLevelClassName());this.$el.find("a[data-action=resolve]").click(_.bind(function(e){e.preventDefault();if(this.model.get("isResolved")){this.unresolve()}else{this.resolve()}},this));this.$el.find("a[data-action=bookmark]").click(_.bind(function(e){e.preventDefault();this.bookmark()},this));this.updateLastSeen();this.renderSparkline();this.updateResolved();this.updateHasSeen();this.updateBookmarked()},updateBookmarked:function(){if(this.model.get("isBookmarked")){this.$el.find("a[data-action=bookmark]").addClass("checked")}else{this.$el.find("a[data-action=bookmark]").removeClass("checked")}},updateResolved:function(){if(this.model.get("isResolved")){this.$el.addClass("resolved")}else{this.$el.removeClass("resolved")}},updateHasSeen:function(){if(this.model.get("hasSeen")){this.$el.addClass("seen")}else{this.$el.removeClass("seen")}},renderSparkline:function(obj){var data=this.model.get("historicalData");if(!data||!data.length)return;this.$el.addClass("with-sparkline");app.charts.createSparkline(this.$el.find(".sparkline"),data)},resolve:function(){$.ajax({url:this.getResolveUrl(),type:"post",dataType:"json",success:_.bind(function(response){this.model.set("version",response.version+5e3);this.model.set("isResolved",true)},this)})},unresolve:function(){$.ajax({url:this.getUnresolveUrl(),type:"post",dataType:"json",success:_.bind(function(response){this.model.set("version",response.version+5e3);this.model.set("isResolved",false)},this)})},getResolveUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/group/"+this.model.get("id")+"/set/resolved/"},getUnresolveUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/group/"+this.model.get("id")+"/set/unresolved/"},getBookmarkUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/bookmark/"},bookmark:function(){$.ajax({url:this.getBookmarkUrl(),type:"post",dataType:"json",data:{gid:this.model.get("id")},success:_.bind(function(response){this.model.set("version",response.version);this.model.set("isBookmarked",response.isBookmarked)},this)})},getLevelClassName:function(){return"level-"+this.model.get("levelName")},updateLastSeen:function(){var dt=moment(this.model.get("lastSeen"));this.$el.find(".last-seen").text(dt.fromNow()).data("datetime",this.model.get("lastSeen")).attr("title",dt.format("llll"))},updateCount:function(){var new_count=app.utils.formatNumber(this.model.get("count"));var counter=this.$el.find(".count");var digit=counter.find("span");if(digit.is(":animated"))return false;if(counter.data("count")==new_count){return false}counter.data("count",new_count);var replacement=$("<span></span>",{css:{top:"-2.1em",opacity:0},text:new_count});digit.before(replacement).animate({top:"2.5em",opacity:0},"fast",function(){digit.remove()});replacement.delay(100).animate({top:0,opacity:1},"fast")},updateAnnotation:function(annotation){var value=annotation.count;if(value===null)return;var new_count=app.utils.formatNumber(value);var counter=this.$el.find('.annotation[data-tag="'+annotation.label+'"]');var digit=counter.find("span");if(digit.is(":animated"))return false;if(counter.data("count")==new_count){return false}counter.data("count",new_count);var replacement=$("<span></span>",{css:{top:"-2.1em",opacity:0},text:new_count});digit.before(replacement).animate({top:"2.5em",opacity:0},"fast",function(){digit.remove()});replacement.delay(100).animate({top:0,opacity:1},"fast")},updateAllAnnotations:function(){var self=this;$.each(this.model.get("annotations"),function(index,annotation){self.updateAnnotation(annotation)})}});app.OrderedElementsView=Backbone.View.extend({emptyMessage:'<div class="empty-message"><h2>No events to show.</h2><p>We\'ll notify you if that changes. In the meantime why not take a moment to become more familiar with Sentry.</p><p class="links"><a href="docs/">Installation instructions</a> <a href="settings/">Project settings</a></p></div>',loadingMessage:"<p>Loading...</p>",model:app.models.Group,defaults:{maxItems:50,view:Backbone.View},initialize:function(data){if(_.isUndefined(data))data={};var members=data.members;Backbone.View.prototype.initialize.apply(this,arguments);this.options=$.extend({},this.defaults,this.options,data);this.$wrapper=$("#"+this.id);this.$parent=$("<ul></ul>");this.$empty=$('<li class="empty"></li>');this.$wrapper.html(this.$parent);if(this.options.className)this.$parent.addClass(this.options.className);_.bindAll(this,"renderMemberInContainer","unrenderMember","reSortMembers");this.collection=new app.ScoredList([],{model:data.model});this.collection.on("add",this.renderMemberInContainer,this);this.collection.on("remove",this.unrenderMember,this);this.collection.on("reset",this.reSortMembers,this);delete data.members;this.reset(members)},reset:function(members){this.$parent.empty();this.setEmpty();if(members===undefined){this.$empty.html(this.loadingMessage);this.collection.reset();this.setEmpty();this.loaded=false}else{this.$empty.html(this.emptyMessage);this.collection.reset(members);this.loaded=true}},setEmpty:function(){this.$parent.html(this.$empty)},extend:function(data){for(var i=0;i<data.length;i++){this.addMember(data[i])}},addMember:function(member){var existing=this.collection.get(member.id);function getAttr(x){if(typeof member.get==="function"){return member.get(x)}else{return member[x]}}if(!existing){if(this.collection.length>=this.options.maxItems){if(getAttr("score")<this.collection.last().get("score"))return;while(this.collection.length>=this.options.maxItems)this.collection.pop()}}else if(existing.get("version")>=(getAttr("version")||0)){return}this.collection.add(member,{merge:true})},reSortMembers:function(){this.collection.each(_.bind(function(member){this.renderMemberInContainer(member)},this))},updateMember:function(member,options){if(_.isUndefined(options))options={};var existing=this.collection.get(member.id);if(existing.get("version")>=member.get("version"))return;this.collection.add(member,{merge:true,sort:options.sort!==false?true:false})},hasMember:function(member){return this.collection.get(member.id)?true:false},removeMember:function(member){this.collection.remove(member)},renderMemberInContainer:function(member){var new_pos=this.collection.indexOf(member),$el,$rel;this.$parent.find("li.empty").remove();$el=$("#"+this.id+member.id);if(!$el.length){$el=this.renderMember(member)}else if($el.index()===new_pos){return}if(new_pos===0){this.$parent.prepend($el)}else{$rel=$("#"+this.id+this.collection.at(new_pos).id);if(!$rel.length){this.$parent.append($el)}else if($el.id!==$rel.id){$el.insertBefore($rel)}else{return}}if(this.loaded)$el.css("background-color","#eee").animate({backgroundColor:"#fff"},300)},renderMember:function(member){var view=new this.options.view({model:member,id:this.id+member.id});view.render();return view.$el},unrenderMember:function(member){this.$parent.find("#"+this.id+member.id).remove();if(!this.$parent.find("li").length)this.setEmpty()}});app.GroupListView=app.OrderedElementsView.extend({defaults:{realtime:false,stream:false,pollUrl:null,pollTime:1e3,tickTime:100},initialize:function(data){if(_.isUndefined(data))data={};data.model=app.models.Group;data.view=app.GroupView;app.OrderedElementsView.prototype.initialize.call(this,data);this.options=$.extend({},this.defaults,this.options,data);this.queue=new app.ScoredList([],{model:data.model});this.cursor=null;_.bindAll(this,"poll","pollSuccess","pollFailure","tick");this.poll();window.setInterval(this.tick,this.options.tickTime)},tick:function(){if(!this.queue.length)return;var item=this.queue.pop();if(this.options.canStream){this.addMember(item)}else if(this.hasMember(item)){this.updateMember(item,{sort:false})}},pollSuccess:function(groups){if(!groups.length)return window.setTimeout(this.poll,this.options.pollTime*5);this.cursor=groups[groups.length-1].score;this.queue.add(groups,{merge:true});window.setTimeout(this.poll,this.options.pollTime)},pollFailure:function(jqXHR,textStatus,errorThrown){window.setTimeout(this.poll,this.options.pollTime*10)},poll:function(){var data;if(!this.options.realtime||!this.options.pollUrl)return window.setTimeout(this.poll,this.options.pollTime);data=app.utils.getQueryParams();data.cursor=this.cursor||undefined;$.ajax({url:this.options.pollUrl,type:"GET",dataType:"json",data:data,success:this.pollSuccess,error:this.pollFailure})}})})(window,app,Backbone,jQuery,_,moment);(function(window,app,Backbone,jQuery,_){"use strict";var $=jQuery;var BasePage=Backbone.View.extend({defaults:{canStream:false,realtime:false},initialize:function(data){Backbone.View.prototype.initialize.apply(this,arguments);if(_.isUndefined(data))data={};this.options=$.extend({},this.defaults,this.options,data);this.views={};this.initializeAjaxTabs()},initializeAjaxTabs:function(){$("a[data-toggle=ajtab]").click(_.bind(function(e){var $tab=$(e.target),uri=$tab.attr("data-uri"),view_id=$tab.attr("href").substr(1),view=this.getView(view_id,uri),$cont,$parent;e.preventDefault();if(!uri)return view.reset();$cont=$("#"+view_id);$parent=$cont.parent();$parent.css("opacity",.6);$.ajax({url:uri,dataType:"json",success:function(data){view.reset(data);$parent.css("opacity",1);$tab.tab("show")},error:function(){$cont.html("<p>There was an error fetching data from the server.</p>")}})},this));$("li.active a[data-toggle=ajtab]").click()},makeDefaultView:function(id){return new app.GroupListView({className:"group-list small",id:id,maxItems:5,stream:this.options.stream,realtime:this.options.realtime,model:app.models.Group})},getView:function(id,uri){if(!this.views[id])this.views[id]=this.makeDefaultView(id);var view=this.views[id];view.options.pollUrl=uri;return view}});app.StreamPage=BasePage.extend({initialize:function(data){BasePage.prototype.initialize.apply(this,arguments);this.group_list=new app.GroupListView({className:"group-list",id:"event_list",members:data.groups,maxItems:50,realtime:$.cookie("pausestream")?false:true,canStream:this.options.canStream,pollUrl:app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/poll/",model:app.models.Group});this.control=$("a[data-action=pause]");this.updateStreamOptions();this.initFilters();this.control.click(_.bind(function(e){e.preventDefault();this.options.realtime=this.group_list.options.realtime=this.control.hasClass("realtime-pause");this.updateStreamOptions()},this));$("#chart").height("50px");app.charts.render("#chart",{placement:"left"})},initFilters:function(){$(".filter").each(_.bind(function(_,el){var $filter=$(el);var $input=$filter.find("input[type=text]");if($input.length>0){$input.select2({initSelection:function(el,callback){var $el=$(el);callback({id:$el.val(),text:$el.val()})},allowClear:true,minimumInputLength:3,ajax:{url:app.utils.getSearchTagsUrl(),dataType:"json",data:function(term,page){return{query:term,quietMillis:300,name:$input.attr("name"),limit:10}},results:function(data,page){var results=[];$(data.results).each(function(_,val){results.push({id:app.utils.escape(val),text:app.utils.escape(val)})});return{results:results}}}})}else{$input=$filter.find("select").select2({allowClear:true})}if($input.length>0){$input.on("change",function(e){var query=app.utils.getQueryParams();query[e.target.name]=e.val;window.location.href="?"+$.param(query)})}},this))},updateStreamOptions:function(){if(this.options.realtime){$.removeCookie("pausestream");this.control.removeClass("realtime-pause");this.control.addClass("realtime-play");this.control.html(this.control.attr("data-pause-label"))}else{$.cookie("pausestream","1",{expires:7});this.control.addClass("realtime-pause");this.control.removeClass("realtime-play");this.control.html(this.control.attr("data-play-label"))}}});app.DashboardPage=BasePage.extend({initialize:function(data){BasePage.prototype.initialize.apply(this,arguments);$("#chart").height("150px");Sentry.charts.render("#chart")}});app.SelectTeamPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);this.refreshSparklines();$(window).on("resize",this.refreshSparklines)},refreshSparklines:function(){$(".chart").each(function(n,el){var $el=$(el);$.ajax({url:$el.attr("data-api-url"),type:"get",dataType:"json",data:{since:(new Date).getTime()/1e3-3600*24,resolution:"1h"},success:_.bind(function(data){for(var i=0;i<data.length;i++){data[i][0]=data[i][0]*1e3}$.plot($el,[{data:data,color:"#ebeff3",shadowSize:0,lines:{lineWidth:2,show:true,fill:true,color:"#f6f8fa"}}],{yaxis:{min:0},grid:{show:false},hoverable:false,legend:{noColumns:5},lines:{show:false}})},this)})})}});app.GroupDetailsPage=BasePage.extend({initialize:function(data){BasePage.prototype.initialize.apply(this,arguments);this.group_list=new app.GroupListView({className:"group-list",id:"event_list",members:[data.group],model:app.models.Group});$("#chart").height("150px");Sentry.charts.render("#chart");$(".share-link").popover({html:true,placement:"left",container:document.body,title:"Share Event",content:function(){var $this=$(this);var $content=$('<form class="share-form"></form>');var $urlel=$('<code class="clippy">'+$this.data("share-url")+"</code>");$urlel.clippy({clippy_path:app.config.clippyPath,keep_text:true});$content.append($urlel);$content.append($('<label class="checkbox"><input type="checkbox"> Allow anonymous users to view this event.</label>'));$content.find("input[type=checkbox]").change(function(){var url=$this.data($(this).is(":checked")?"public-url":"private-url");$.ajax({url:url,type:"post",success:function(group){$this.data("public",group.isPublic?"true":"false")},error:function(){window.alert("There was an error changing the public status")}})}).attr("checked",$this.data("public")=="true");return $content}});$(".add-note-btn").click(function(e){var $el=$(this),$form=$(".add-note-form",$el.parent());e.preventDefault();if($el.hasClass("selected")){$el.removeClass("selected");$form.addClass("hide")}else{$el.addClass("selected");$form.removeClass("hide");$form.find("textarea:first").focus()}});$(".add-note-form").submit(function(el){var $this=$(this);$this.find("button[type=submit]").attr("disabled",true).addClass("disabled");$this.find("textarea").addClass("disabled")});$(".tag-widget").each(function(){var $widget=$(this);$.ajax({url:$widget.data("url"),error:function(){$widget.find(".loading").remove();$widget.append($('<li class="error">Unable to load tag information</li>'))},success:function(data){var total=data.total,eTagName=encodeURIComponent(data.name);$widget.find(".loading").remove();if(total===0){$widget.append($("<li>No data available.</li>"))}else{$.each(data.values,function(_,item){var tagValue=item[0],timesSeen=item[1],percent=parseInt(timesSeen/total*100,10),url=app.config.urlPrefix+"/"+app.config.teamId+"/"+app.config.projectId+"/";$("<li>"+'<div class="progressbar">'+'<div style="width:'+percent+'%">'+timesSeen+"</div>"+'<a href="'+url+"?"+eTagName+"="+encodeURIComponent(tagValue)+'">'+tagValue+"<span>"+percent+"%</span>"+"</a>"+"</div>"+"</li>").appendTo($widget)})}}})});var $event_nav=$("#event_nav");if($event_nav.length>0){var $window=$(window);var $nav_links=$event_nav.find("a[href*=#]");var $nav_targets=[];var scroll_offset=$event_nav.offset().top;var event_nav_height;var last_target;$window.resize(function(){event_nav_height=$event_nav.find(".nav").outerHeight();$event_nav.height(event_nav_height+"px")}).resize();$nav_links.click(function(e){var $el=$(this);var target=$(this.hash);$el.parent().addClass("active").siblings().removeClass("active");$("html,body").animate({scrollTop:target.position().top+event_nav_height},"fast");if(history.pushState){history.pushState({},"",this.hash)}e.preventDefault()}).each(function(){if(this.hash.length>1&&$(this.hash).length){$nav_targets.push(this.hash)}});var resizeTimer;$window.scroll(function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){if($window.scrollTop()>scroll_offset){if(!$event_nav.hasClass("fixed")){$event_nav.addClass("fixed")}}else if($event_nav.hasClass("fixed")){$event_nav.removeClass("fixed")}if($nav_targets.length){var from_top=$window.scrollTop()+event_nav_height+20;var cur=$.map($nav_targets,function(hash){if($(hash).offset().top<from_top){return hash}});var target=cur?cur[cur.length-1]:null;if(!target){target=$nav_targets[0]}if(last_target!==target){last_target=target;$nav_links.parent().removeClass("active").end().filter("[href="+target+"]").parent().addClass("active")}}},1)}).scroll()}}});app.WallPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,{realtime:true,pollTime:3e3});this.sparkline=$(".chart");this.sparkline.height(this.sparkline.parent().height());this.stats=$("#stats");_.bindAll(this,"refreshStats","refreshSparkline");this.refreshSparkline();this.refreshStats()},makeDefaultView:function(id){return new app.GroupListView({className:"group-list",id:id,maxItems:5,stream:this.options.stream,realtime:this.options.realtime,model:app.models.Group})},refreshSparkline:function(){$.ajax({url:this.sparkline.attr("data-api-url"),type:"get",dataType:"json",data:{since:(new Date).getTime()/1e3-3600*24,resolution:"1h"},success:_.bind(function(data){for(var i=0;i<data.length;i++){data[i][0]=data[i][0]*1e3}this.sparkline.empty();$.plot(this.sparkline,[{data:data,color:"#52566c",shadowSize:0,lines:{lineWidth:2,show:true,fill:true,fillColor:"#232428"}}],{yaxis:{min:0},grid:{show:false},hoverable:false,legend:{noColumns:5},lines:{show:false}});window.setTimeout(this.refreshSparkline,1e4)},this)})},refreshStats:function(){$.ajax({url:this.stats.attr("data-uri"),dataType:"json",success:_.bind(function(data){this.stats.find("[data-stat]").each(function(){var $this=$(this);var new_count=data[$this.attr("data-stat")];var counter=$this.find("big");var digit=counter.find("span");if(digit.is(":animated"))return false;if(counter.data("count")==new_count){return false}counter.data("count",new_count);var replacement=$("<span></span>",{css:{top:"-2.1em",opacity:0},text:new_count});digit.before(replacement).animate({top:"2.5em",opacity:0},"fast",function(){digit.remove()});replacement.delay(100).animate({top:0,opacity:1},"fast")});window.setTimeout(this.refreshStats,1e3)},this)})}});app.AccessGroupMembersPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);app.utils.makeSearchableUsersInput("form input[name=user]")}});app.TeamDetailsPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);app.utils.makeSearchableUsersInput("form input[name=owner]")}});app.ProjectDetailsPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);app.utils.makeSearchableUsersInput("form input[name=owner]");$("input[type=range]").each(_.bind(function loop(n,el){var $el=$(el),min=parseInt($el.attr("min"),10),max=parseInt($el.attr("max"),10),step=parseInt($el.attr("step"),10),values=[],$value=$('<span class="value"></span>');var i=min;while(i<=max){values.push(i);if(i<12){i+=1}else if(i<24){i+=3}else if(i<36){i+=6}else if(i<48){i+=12}else{i+=24}}$el.on("slider:ready",_.bind(function sliderready(event,data){$value.appendTo(data.el);$value.html(this.formatHours(data.value))},this)).on("slider:changed",_.bind(function sliderchanged(event,data){$value.html(this.formatHours(data.value))},this)).simpleSlider({range:[min,max],step:step,allowedValues:values,snap:true})},this))},formatHours:function formatHours(val){val=parseInt(val,10);if(val===0){return"Disabled"}else if(val>23&&val%24===0){val=val/24;return val+" day"+(val!=1?"s":"")}return val+" hour"+(val!=1?"s":"")}});app.ProjectNotificationsPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);$("input[type=range]").each(_.bind(function loop(n,el){var $el=$(el),min=parseInt($el.attr("min"),10),max=parseInt($el.attr("max"),10),step=parseInt($el.attr("step"),10),$value=$('<span class="value"></span>');$el.on("slider:ready",_.bind(function sliderready(event,data){$value.appendTo(data.el);$value.html(this.formatThreshold(data.value))},this)).on("slider:changed",_.bind(function sliderchanged(event,data){$value.html(this.formatThreshold(data.value))},this)).simpleSlider({range:[min,max],step:step,snap:true})},this))},formatThreshold:function formatThreshold(value){if(!value){return"Disabled"}return value+"%"}});app.NewProjectPage=BasePage.extend({initialize:function(data){this.el=$(data.el);BasePage.prototype.initialize.apply(this,arguments);if(this.options.canSelectTeam&&this.options.canCreateTeam){$("#new_team").hide();$('a[rel="create-new-team"]').click(function(){$("#new_team").show();$("#select_team").hide()});$('a[rel="select-team"]').click(function(){$("#new_team").hide();$("#select_team").show()})}}});app.NewProjectRulePage=BasePage.extend({initialize:function(data){var select2_options={width:"element",allowClear:false,minimumResultsForSearch:10};BasePage.prototype.initialize.apply(this,arguments);_.bindAll(this,"addAction","addCondition","parseFormData");this.actions_by_id={};this.conditions_by_id={};this.el=$(data.el);this.action_sel=this.el.find('select[id="action-select"]');this.action_table=this.el.find("table.action-list");this.action_table_body=this.action_table.find("tbody");this.condition_sel=this.el.find('select[id="condition-select"]');this.condition_table=this.el.find("table.condition-list");this.condition_table_body=this.condition_table.find("tbody");this.action_sel.empty();this.action_sel.append($("<option></option>"));$.each(data.actions,_.bind(function(_,action){var opt=$("<option></option>");opt.attr({value:action.id});opt.text(action.label);opt.appendTo(this.action_sel);this.actions_by_id[action.id]=action},this));this.condition_sel.empty();this.condition_sel.append($("<option></option>"));$.each(data.conditions,_.bind(function(_,condition){var opt=$("<option></option>");opt.attr({value:condition.id});opt.text(condition.label);opt.appendTo(this.condition_sel);this.conditions_by_id[condition.id]=condition},this));this.action_sel.select2(select2_options);this.condition_sel.select2(select2_options);this.action_sel.change(_.bind(function(){this.addAction(this.action_sel.val())},this));this.condition_sel.change(_.bind(function(){this.addCondition(this.condition_sel.val())},this));this.parseFormData(data.form_data,data.form_errors)},parseFormData:function(form_data,form_errors){var data={action:{},action_match:form_data.action_match||"all",condition:{},label:form_data.label||""};form_errors=form_errors||{};$.each(form_data,function(key,value){var matches=key.match(/^(condition|action)\[(\d+)\]\[(.+)\]$/);var type,num;if(!matches){return}type=matches[1];num=matches[2];if(data[type][num]===undefined){data[type][num]={}}data[type][num][matches[3]]=value});this.el.find("input[name=label]").val(data.label);this.el.find('select[name="action_match"]').val(data.action_match);$.each(_.sortBy(data.condition),_.bind(function(num,item){this.addCondition(item.id,item,form_errors["condition["+num+"]"]||false)},this));$.each(_.sortBy(data.action),_.bind(function(num,item){this.addAction(item.id,item,form_errors["action["+num+"]"]||false)},this))},addCondition:function(id,options,has_errors){var node=this.conditions_by_id[id],row=$("<tr></tr>"),remove_btn=$('<button class="btn btn-small">Remove</button>'),num=this.condition_table_body.find("tr").length,html=$("<div>"+node.html+"</div>"),prefix="condition["+num+"]",id_field=$('<input type="hidden" name="'+prefix+'[id]" value="'+node.id+'">');has_errors=has_errors||false;options=options||{};if(has_errors){row.addClass("error")}html.find("select").each(function(){var $this=$(this),options={width:"element",allowClear:false,minimumResultsForSearch:10};if($this.attr("data-allowClear")){options.allowClear=$this.attr("data-allowClear")}$this.select2(options)});html.find("input, select, textarea").each(function(_,el){var $el=$(el),name=$el.attr("name");$el.attr("name",prefix+"["+name+"]");$el.val(options[name]||"")});row.append($("<td></td>").append(html).append(id_field));row.append($("<td></td>").append(remove_btn));row.appendTo(this.condition_table_body);
-remove_btn.click(function(){row.remove();return false});this.condition_sel.data("select2").clear();this.condition_table.show()},addAction:function(id,options,has_errors){var node=this.actions_by_id[id],row=$("<tr></tr>"),remove_btn=$('<button class="btn btn-small">Remove</button>'),num=this.action_table_body.find("tr").length,html=$("<div>"+node.html+"</div>"),prefix="action["+num+"]",id_field=$('<input type="hidden" name="'+prefix+'[id]" value="'+node.id+'">');has_errors=has_errors||false;options=options||{};if(has_errors){row.addClass("error")}html.find("select").each(function(){var $this=$(this),options={width:"element",allowClear:false,minimumResultsForSearch:10};if($this.attr("data-allowClear")){options.allowClear=$this.attr("data-allowClear")}$this.select2(options)});html.find("input, select, textarea").each(function(_,el){var $el=$(el),name=$el.attr("name");$el.attr("name",prefix+"["+name+"]");$el.val(options[name]||"")});row.append($("<td></td>").append(html).append(id_field));row.append($("<td></td>").append(remove_btn));row.appendTo(this.action_table_body);remove_btn.click(function(){row.remove();return false});this.action_sel.data("select2").clear();this.action_table.show()}});Backbone.sync=function(method,model,success,error){success()}})(window,app,Backbone,jQuery,_);
+app=window.app={config:{},templates:{},utils:{}};(function(app,Backbone){"use strict";app.models={};app.models.Group=Backbone.Model.extend({defaults:{count:0,version:0,annotations:[],tags:[],hasSeen:false,isBookmarked:false,historicalData:[]}})})(app,Backbone);(function(app){"use strict";app.templates={group:""+'<div class="count" data-count="<%= app.utils.formatNumber(count) %>">'+'<span title="<%= count %>"><%= app.utils.formatNumber(count) %></span>'+"</div>"+'<div class="details">'+'<h3><a href="<%= permalink %>"><%= title %></a></h3>'+'<p class="message">'+"<%= message %>"+"</p>"+'<div class="meta">'+"<% $.each(annotations, function(_, tag) { %>"+'<span class="tag annotation" data-tag="<%= tag.label %>" data-count="<%= app.utils.formatNumber(tag.count) %>">'+"<i><%= tag.label %></i>"+'<span title="<%= count %>"><%= app.utils.formatNumber(tag.count) %></span>'+"</span>"+"<% }) %>"+'<span class="last-seen pretty-date"></span>'+"<% if (timeSpent) { %>"+'<span class="tag time-spent"><%= Math.round(timeSpent) %>ms</span>'+"<% } %>"+'<span class="tag tag-project">'+'<a href="<%= projectUrl %>"><%= project.name %></a>'+"</span>"+'<span class="tag tag-logger">'+'<a href="<%= loggerUrl %>"><%= logger %></a>'+"</span>"+"<% _.each(tags, function(tag){ %> "+'<span class="tag"><%= tag %></span>'+"<% }) %>"+"</div>"+'<span class="sparkline"></span>'+'<ul class="actions">'+"<% if (canResolve) { %>"+"<li>"+'<a href="#" data-action="resolve">'+'<i aria-hidden="true" class="icon-checkmark"></i>'+"</a>"+"</li>"+"<li>"+'<a href="#" data-action="bookmark" class="bookmark" title="Bookmark">'+'<i aria-hidden="true" class="icon-star"></i>'+"</a>"+"</li>"+"<% } %>"+"</ul>"+"</div>"}})(app);(function(app,jQuery,_,moment){"use strict";var $=jQuery;var number_formats=[[1e9,"b"],[1e6,"m"],[1e3,"k"]];app.utils={getQueryParams:function(){var vars={},href=window.location.href,hashes,hash;if(href.indexOf("?")==-1)return vars;hashes=href.slice(href.indexOf("?")+1,href.indexOf("#")!=-1?href.indexOf("#"):href.length).split("&");$.each(hashes,function(_,chunk){hash=chunk.split("=");if(!hash[0]&&!hash[1])return;vars[decodeURIComponent(hash[0])]=hash[1]?decodeURIComponent(hash[1]).replace(/\+/," "):""});return vars},floatFormat:function(number,places){var multi=Math.pow(10,places);return parseInt(number*multi,10)/multi},formatNumber:function(number){var b,x,y,o,p;number=parseInt(number,10);for(var i=0;b=number_formats[i];i++){x=b[0];y=b[1];o=Math.floor(number/x);p=number%x;if(o>0){if(o/10>1||!p)return""+o+y;return""+this.floatFormat(number/x,1)+y}}return""+number},slugify:function(str){str=str.replace(/^\s+|\s+$/g,"");str=str.toLowerCase();var from="àáäâèéëêìíïîòóöôùúüûñç·/_,:;";var to="aaaaeeeeiiiioooouuuunc------";for(var i=0,l=from.length;i<l;i++){str=str.replace(new RegExp(from.charAt(i),"g"),to.charAt(i))}str=str.replace(/[^a-z0-9\s\-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");return str},varToggle:function(link,$elm){var $link=$(link);if(!$link.attr("data-expand-label"))$link.attr("data-expand-label",$link.html());$elm.toggle();if($elm.is(":visible"))$link.html($link.attr("data-collapse-label"));else $link.html($link.attr("data-expand-label"))},getSearchUsersUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/users/search/"},getSearchProjectsUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/projects/search/"},getSearchTagsUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/tags/search/"},makeSearchableInput:function(el,url,callback,options){$(el).select2($.extend({allowClear:true,width:"element",initSelection:function(el,callback){var $el=$(el);callback({id:$el.val(),text:$el.val()})},ajax:{url:url,dataType:"json",data:function(term,page){return{query:term,limit:10}},results:function(data,page){var results=callback(data);return{results:callback(data)}}}},options||{}))},escape:function(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},makeSearchableUsersInput:function(el){this.makeSearchableInput(el,this.getSearchUsersUrl(),_.bind(function(data){var results=[];$(data.results).each(_.bind(function(_,val){var label;if(val.first_name){label=this.escape(val.first_name)+" &mdash; "+this.escape(val.username)}else{label=this.escape(val.username)}label+="<br>"+this.escape(val.email);results.push({id:val.username,text:label})},this));if(data.query&&$(results).filter(function(){return this.id.localeCompare(data.query)===0}).length===0){results.push({id:this.escape(data.query),text:this.escape(data.query)})}return results},this),{escapeMarkup:function(s){return s}})}};$(function(){$(".body select").each(function(){var $this=$(this),options={width:"element",allowClear:false,minimumResultsForSearch:10};if($this.attr("data-allowClear")){options.allowClear=$this.attr("data-allowClear")}$this.select2(options)});setInterval(function(){$(".pretty-date").each(function(_,el){var $el=$(el);var dt=$el.data("datetime");if(dt){var date=moment(dt);if(date){$el.text(date.fromNow());$el.attr("title",date.format("llll"))}}})},5e3)})})(app,jQuery,_,moment);(function(app,Backbone){"use strict";app.ScoredList=Backbone.Collection.extend({comparator:function(member){return-member.get("score")}})})(app,Backbone);(function(app,Backbone,jQuery,moment){"use strict";var $=jQuery;app.charts={render:function(el,options){var $el=$("#chart");var url=$el.attr("data-api-url");var title=$(el).attr("data-title");var $spark=$el.find(".sparkline");$spark.height($el.height());$.ajax({url:$el.attr("data-api-url"),type:"get",dataType:"json",data:{since:(new Date).getTime()/1e3-3600*24,resolution:"1h"},success:function(resp){var data=[],maxval=10;$spark.empty();$.each(resp,function(_,val){var date=new Date(val[0]*1e3);data.push({y:val[1],label:moment(date).fromNow()});if(val[1]>maxval){maxval=val[1]}});app.charts.createSparkline($spark,data,options)}})},createSparkline:function(el,points,options){var $el=$(el),existing=$el.children(),maxval=10,title,point,pct,child,point_width;if(options===undefined){options={}}for(var i=0;i<points.length;i++){point=points[i];if(typeof point==="number"){point=points[i]={y:point}}if(point.y>maxval){maxval=point.y}}point_width=app.utils.floatFormat(100/points.length,2)+"%";for(i=0;i<points.length;i++){point=points[i];pct=app.utils.floatFormat(point.y/maxval*99,2)+"%";title=point.y+" events";if(point.label){title=title+"<br>("+point.label+")"}if(existing.get(i)===undefined){$('<a style="width:'+point_width+';" rel="tooltip" title="'+title+'"><span style="height:'+pct+'">'+point.y+"</span></a>").tooltip({placement:options.placement||"bottom",html:true,container:"body"}).appendTo($el)}else{$(existing[i]).find("span").css("height",pct).text(point.y).attr("title",point.label||point.y)}}}}})(app,Backbone,jQuery,moment);(function(window,app,Backbone,jQuery,_,moment){"use strict";var $=jQuery;app.GroupView=Backbone.View.extend({tagName:"li",className:"group",template:_.template(app.templates.group),initialize:function(){Backbone.View.prototype.initialize.apply(this,arguments);_.bindAll(this,"updateCount","updateAllAnnotations","updateAnnotation","updateLastSeen","updateResolved","updateHasSeen","renderSparkline","updateBookmarked","render");this.model.on({"change:count":this.updateCount,"change:annotations":this.updateAllAnnotations,"change:lastSeen":this.updateLastSeen,"change:isBookmarked":this.updateBookmarked,"change:isResolved":this.updateResolved,"change:hasSeen":this.updateHasSeen,"change:historicalData":this.renderSparkline},this)},render:function(){var data=this.model.toJSON();data.projectUrl=app.config.urlPrefix+"/"+app.config.organizationId+"/"+data.project.slug+"/";data.loggerUrl=data.projectUrl+"?logger="+data.logger;this.$el.html(this.template(data));this.$el.attr("data-id",this.model.id);this.$el.addClass(this.getLevelClassName());this.$el.find("a[data-action=resolve]").click(_.bind(function(e){e.preventDefault();if(this.model.get("isResolved")){this.unresolve()}else{this.resolve()}},this));this.$el.find("a[data-action=bookmark]").click(_.bind(function(e){e.preventDefault();this.bookmark()},this));this.updateLastSeen();this.renderSparkline();this.updateResolved();this.updateHasSeen();this.updateBookmarked()},updateBookmarked:function(){if(this.model.get("isBookmarked")){this.$el.find("a[data-action=bookmark]").addClass("checked")}else{this.$el.find("a[data-action=bookmark]").removeClass("checked")}},updateResolved:function(){if(this.model.get("isResolved")){this.$el.addClass("resolved")}else{this.$el.removeClass("resolved")}},updateHasSeen:function(){if(this.model.get("hasSeen")){this.$el.addClass("seen")}else{this.$el.removeClass("seen")}},renderSparkline:function(obj){var data=this.model.get("historicalData");if(!data||!data.length)return;this.$el.addClass("with-sparkline");app.charts.createSparkline(this.$el.find(".sparkline"),data)},resolve:function(){$.ajax({url:this.getResolveUrl(),type:"post",dataType:"json",success:_.bind(function(response){this.model.set("version",response.version+5e3);this.model.set("isResolved",true)},this)})},unresolve:function(){$.ajax({url:this.getUnresolveUrl(),type:"post",dataType:"json",success:_.bind(function(response){this.model.set("version",response.version+5e3);this.model.set("isResolved",false)},this)})},getResolveUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/group/"+this.model.get("id")+"/set/resolved/"},getUnresolveUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/group/"+this.model.get("id")+"/set/unresolved/"},getBookmarkUrl:function(){return app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/bookmark/"},bookmark:function(){$.ajax({url:this.getBookmarkUrl(),type:"post",dataType:"json",data:{gid:this.model.get("id")},success:_.bind(function(response){this.model.set("version",response.version);this.model.set("isBookmarked",response.isBookmarked)},this)})},getLevelClassName:function(){return"level-"+this.model.get("levelName")},updateLastSeen:function(){var dt=moment(this.model.get("lastSeen"));this.$el.find(".last-seen").text(dt.fromNow()).data("datetime",this.model.get("lastSeen")).attr("title",dt.format("llll"))},updateCount:function(){var new_count=app.utils.formatNumber(this.model.get("count"));var counter=this.$el.find(".count");var digit=counter.find("span");if(digit.is(":animated"))return false;if(counter.data("count")==new_count){return false}counter.data("count",new_count);var replacement=$("<span></span>",{css:{top:"-2.1em",opacity:0},text:new_count});digit.before(replacement).animate({top:"2.5em",opacity:0},"fast",function(){digit.remove()});replacement.delay(100).animate({top:0,opacity:1},"fast")},updateAnnotation:function(annotation){var value=annotation.count;if(value===null)return;var new_count=app.utils.formatNumber(value);var counter=this.$el.find('.annotation[data-tag="'+annotation.label+'"]');var digit=counter.find("span");if(digit.is(":animated"))return false;if(counter.data("count")==new_count){return false}counter.data("count",new_count);var replacement=$("<span></span>",{css:{top:"-2.1em",opacity:0},text:new_count});digit.before(replacement).animate({top:"2.5em",opacity:0},"fast",function(){digit.remove()});replacement.delay(100).animate({top:0,opacity:1},"fast")},updateAllAnnotations:function(){var self=this;$.each(this.model.get("annotations"),function(index,annotation){self.updateAnnotation(annotation)})}});app.OrderedElementsView=Backbone.View.extend({emptyMessage:'<div class="empty-message"><h2>No events to show.</h2><p>We\'ll notify you if that changes. In the meantime why not take a moment to become more familiar with Sentry.</p><p class="links"><a href="docs/">Installation instructions</a> <a href="settings/">Project settings</a></p></div>',loadingMessage:"<p>Loading...</p>",model:app.models.Group,defaults:{maxItems:50,view:Backbone.View},initialize:function(data){if(_.isUndefined(data))data={};var members=data.members;Backbone.View.prototype.initialize.apply(this,arguments);this.options=$.extend({},this.defaults,this.options,data);this.$wrapper=$("#"+this.id);this.$parent=$("<ul></ul>");this.$empty=$('<li class="empty"></li>');this.$wrapper.html(this.$parent);if(this.options.className)this.$parent.addClass(this.options.className);_.bindAll(this,"renderMemberInContainer","unrenderMember","reSortMembers");this.collection=new app.ScoredList([],{model:data.model});this.collection.on("add",this.renderMemberInContainer,this);this.collection.on("remove",this.unrenderMember,this);this.collection.on("reset",this.reSortMembers,this);delete data.members;this.reset(members)},reset:function(members){this.$parent.empty();this.setEmpty();if(members===undefined){this.$empty.html(this.loadingMessage);this.collection.reset();this.setEmpty();this.loaded=false}else{this.$empty.html(this.emptyMessage);this.collection.reset(members);this.loaded=true}},setEmpty:function(){this.$parent.html(this.$empty)},extend:function(data){for(var i=0;i<data.length;i++){this.addMember(data[i])}},addMember:function(member){var existing=this.collection.get(member.id);function getAttr(x){if(typeof member.get==="function"){return member.get(x)}else{return member[x]}}if(!existing){if(this.collection.length>=this.options.maxItems){if(getAttr("score")<this.collection.last().get("score"))return;while(this.collection.length>=this.options.maxItems)this.collection.pop()}}else if(existing.get("version")>=(getAttr("version")||0)){return}this.collection.add(member,{merge:true})},reSortMembers:function(){this.collection.each(_.bind(function(member){this.renderMemberInContainer(member)},this))},updateMember:function(member,options){if(_.isUndefined(options))options={};var existing=this.collection.get(member.id);if(existing.get("version")>=member.get("version"))return;this.collection.add(member,{merge:true,sort:options.sort!==false?true:false})},hasMember:function(member){return this.collection.get(member.id)?true:false},removeMember:function(member){this.collection.remove(member)},renderMemberInContainer:function(member){var new_pos=this.collection.indexOf(member),$el,$rel;this.$parent.find("li.empty").remove();$el=$("#"+this.id+member.id);if(!$el.length){$el=this.renderMember(member)}else if($el.index()===new_pos){return}if(new_pos===0){this.$parent.prepend($el)}else{$rel=$("#"+this.id+this.collection.at(new_pos).id);if(!$rel.length){this.$parent.append($el)}else if($el.id!==$rel.id){$el.insertBefore($rel)}else{return}}if(this.loaded)$el.css("background-color","#eee").animate({backgroundColor:"#fff"},300)},renderMember:function(member){var view=new this.options.view({model:member,id:this.id+member.id});view.render();return view.$el},unrenderMember:function(member){this.$parent.find("#"+this.id+member.id).remove();if(!this.$parent.find("li").length)this.setEmpty()}});app.GroupListView=app.OrderedElementsView.extend({defaults:{realtime:false,stream:false,pollUrl:null,pollTime:1e3,tickTime:100},initialize:function(data){if(_.isUndefined(data))data={};data.model=app.models.Group;data.view=app.GroupView;app.OrderedElementsView.prototype.initialize.call(this,data);this.options=$.extend({},this.defaults,this.options,data);this.queue=new app.ScoredList([],{model:data.model});this.cursor=null;_.bindAll(this,"poll","pollSuccess","pollFailure","tick");this.poll();window.setInterval(this.tick,this.options.tickTime)},tick:function(){if(!this.queue.length)return;var item=this.queue.pop();if(this.options.canStream){this.addMember(item)}else if(this.hasMember(item)){this.updateMember(item,{sort:false})}},pollSuccess:function(groups){if(!groups.length)return window.setTimeout(this.poll,this.options.pollTime*5);this.cursor=groups[groups.length-1].score;this.queue.add(groups,{merge:true});window.setTimeout(this.poll,this.options.pollTime)},pollFailure:function(jqXHR,textStatus,errorThrown){window.setTimeout(this.poll,this.options.pollTime*10)},poll:function(){var data;if(!this.options.realtime||!this.options.pollUrl)return window.setTimeout(this.poll,this.options.pollTime);data=app.utils.getQueryParams();data.cursor=this.cursor||undefined;$.ajax({url:this.options.pollUrl,type:"GET",dataType:"json",data:data,success:this.pollSuccess,error:this.pollFailure})}})})(window,app,Backbone,jQuery,_,moment);(function(window,app,Backbone,jQuery,_){"use strict";var $=jQuery;var BasePage=Backbone.View.extend({defaults:{canStream:false,realtime:false},initialize:function(data){Backbone.View.prototype.initialize.apply(this,arguments);if(_.isUndefined(data))data={};this.options=$.extend({},this.defaults,this.options,data);this.views={};this.initializeAjaxTabs()},initializeAjaxTabs:function(){$("a[data-toggle=ajtab]").click(_.bind(function(e){var $tab=$(e.target),uri=$tab.attr("data-uri"),view_id=$tab.attr("href").substr(1),view=this.getView(view_id,uri),$cont,$parent;e.preventDefault();if(!uri)return view.reset();$cont=$("#"+view_id);$parent=$cont.parent();$parent.css("opacity",.6);$.ajax({url:uri,dataType:"json",success:function(data){view.reset(data);$parent.css("opacity",1);$tab.tab("show")},error:function(){$cont.html("<p>There was an error fetching data from the server.</p>")}})},this));$("li.active a[data-toggle=ajtab]").click()},makeDefaultView:function(id){return new app.GroupListView({className:"group-list small",id:id,maxItems:5,stream:this.options.stream,realtime:this.options.realtime,model:app.models.Group})},getView:function(id,uri){if(!this.views[id])this.views[id]=this.makeDefaultView(id);var view=this.views[id];view.options.pollUrl=uri;return view}});app.StreamPage=BasePage.extend({initialize:function(data){BasePage.prototype.initialize.apply(this,arguments);this.group_list=new app.GroupListView({className:"group-list",id:"event_list",members:data.groups,maxItems:50,realtime:$.cookie("pausestream")?false:true,canStream:this.options.canStream,pollUrl:app.config.urlPrefix+"/api/"+app.config.organizationId+"/"+app.config.projectId+"/poll/",model:app.models.Group});this.control=$("a[data-action=pause]");this.updateStreamOptions();this.initFilters();this.control.click(_.bind(function(e){e.preventDefault();this.options.realtime=this.group_list.options.realtime=this.control.hasClass("realtime-pause");this.updateStreamOptions()},this));$("#chart").height("50px");app.charts.render("#chart",{placement:"left"})},initFilters:function(){$(".filter").each(_.bind(function(_,el){var $filter=$(el);var $input=$filter.find("input[type=text]");if($input.length>0){$input.select2({initSelection:function(el,callback){var $el=$(el);callback({id:$el.val(),text:$el.val()})},allowClear:true,minimumInputLength:3,ajax:{url:app.utils.getSearchTagsUrl(),dataType:"json",data:function(term,page){return{query:term,quietMillis:300,name:$input.attr("name"),limit:10}},results:function(data,page){var results=[];$(data.results).each(function(_,val){results.push({id:app.utils.escape(val),text:app.utils.escape(val)})});return{results:results}}}})}else{$input=$filter.find("select").select2({allowClear:true})}if($input.length>0){$input.on("change",function(e){var query=app.utils.getQueryParams();query[e.target.name]=e.val;window.location.href="?"+$.param(query)})}},this))},updateStreamOptions:function(){if(this.options.realtime){$.removeCookie("pausestream");this.control.removeClass("realtime-pause");this.control.addClass("realtime-play");this.control.html(this.control.attr("data-pause-label"))}else{$.cookie("pausestream","1",{expires:7});this.control.addClass("realtime-pause");this.control.removeClass("realtime-play");this.control.html(this.control.attr("data-play-label"))}}});app.DashboardPage=BasePage.extend({initialize:function(data){BasePage.prototype.initialize.apply(this,arguments);$("#chart").height("150px");Sentry.charts.render("#chart")}});app.SelectTeamPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);this.refreshSparklines();$(window).on("resize",this.refreshSparklines)},refreshSparklines:function(){$(".chart").each(function(n,el){var $el=$(el);$.ajax({url:$el.attr("data-api-url"),type:"get",dataType:"json",data:{since:(new Date).getTime()/1e3-3600*24,resolution:"1h"},success:_.bind(function(data){for(var i=0;i<data.length;i++){data[i][0]=data[i][0]*1e3}$.plot($el,[{data:data,color:"#ebeff3",shadowSize:0,lines:{lineWidth:2,show:true,fill:true,color:"#f6f8fa"}}],{yaxis:{min:0},grid:{show:false},hoverable:false,legend:{noColumns:5},lines:{show:false}})},this)})})}});app.GroupDetailsPage=BasePage.extend({initialize:function(data){BasePage.prototype.initialize.apply(this,arguments);this.group_list=new app.GroupListView({className:"group-list",id:"event_list",members:[data.group],model:app.models.Group});$("#chart").height("150px");Sentry.charts.render("#chart");$(".share-link").popover({html:true,placement:"left",container:document.body,title:"Share Event",content:function(){var $this=$(this);var $content=$('<form class="share-form"></form>');var $urlel=$('<code class="clippy">'+$this.data("share-url")+"</code>");$urlel.clippy({clippy_path:app.config.clippyPath,keep_text:true});$content.append($urlel);$content.append($('<label class="checkbox"><input type="checkbox"> Allow anonymous users to view this event.</label>'));$content.find("input[type=checkbox]").change(function(){var url=$this.data($(this).is(":checked")?"public-url":"private-url");$.ajax({url:url,type:"post",success:function(group){$this.data("public",group.isPublic?"true":"false")},error:function(){window.alert("There was an error changing the public status")}})}).attr("checked",$this.data("public")=="true");return $content}});$(".add-note-btn").click(function(e){var $el=$(this),$form=$(".add-note-form",$el.parent());e.preventDefault();if($el.hasClass("selected")){$el.removeClass("selected");$form.addClass("hide")}else{$el.addClass("selected");$form.removeClass("hide");$form.find("textarea:first").focus()}});$(".add-note-form").submit(function(el){var $this=$(this);$this.find("button[type=submit]").attr("disabled",true).addClass("disabled");$this.find("textarea").addClass("disabled")});$(".tag-widget").each(function(){var $widget=$(this);$.ajax({url:$widget.data("url"),error:function(){$widget.find(".loading").remove();$widget.append($('<li class="error">Unable to load tag information</li>'))},success:function(data){var total=data.total,eTagName=encodeURIComponent(data.name);$widget.find(".loading").remove();if(total===0){$widget.append($("<li>No data available.</li>"))}else{$.each(data.values,function(_,item){var tagValue=item[0],timesSeen=item[1],percent=parseInt(timesSeen/total*100,10),url=app.config.urlPrefix+"/"+app.config.organizationId+"/"+app.config.projectId+"/";$("<li>"+'<div class="progressbar">'+'<div style="width:'+percent+'%">'+timesSeen+"</div>"+'<a href="'+url+"?"+eTagName+"="+encodeURIComponent(tagValue)+'">'+tagValue+"<span>"+percent+"%</span>"+"</a>"+"</div>"+"</li>").appendTo($widget)})}}})});var $event_nav=$("#event_nav");if($event_nav.length>0){var $window=$(window);var $nav_links=$event_nav.find("a[href*=#]");var $nav_targets=[];var scroll_offset=$event_nav.offset().top;var event_nav_height;var last_target;$window.resize(function(){event_nav_height=$event_nav.find(".nav").outerHeight();$event_nav.height(event_nav_height+"px")}).resize();$nav_links.click(function(e){var $el=$(this);var target=$(this.hash);$el.parent().addClass("active").siblings().removeClass("active");$("html,body").animate({scrollTop:target.position().top+event_nav_height},"fast");if(history.pushState){history.pushState({},"",this.hash)}e.preventDefault()}).each(function(){if(this.hash.length>1&&$(this.hash).length){$nav_targets.push(this.hash)}});var resizeTimer;$window.scroll(function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){if($window.scrollTop()>scroll_offset){if(!$event_nav.hasClass("fixed")){$event_nav.addClass("fixed")}}else if($event_nav.hasClass("fixed")){$event_nav.removeClass("fixed")}if($nav_targets.length){var from_top=$window.scrollTop()+event_nav_height+20;var cur=$.map($nav_targets,function(hash){if($(hash).offset().top<from_top){return hash}});var target=cur?cur[cur.length-1]:null;if(!target){target=$nav_targets[0]}if(last_target!==target){last_target=target;$nav_links.parent().removeClass("active").end().filter("[href="+target+"]").parent().addClass("active")}}},1)}).scroll()}}});app.WallPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,{realtime:true,pollTime:3e3});this.sparkline=$(".chart");this.sparkline.height(this.sparkline.parent().height());this.stats=$("#stats");_.bindAll(this,"refreshStats","refreshSparkline");this.refreshSparkline();this.refreshStats()},makeDefaultView:function(id){return new app.GroupListView({className:"group-list",id:id,maxItems:5,stream:this.options.stream,realtime:this.options.realtime,model:app.models.Group})},refreshSparkline:function(){$.ajax({url:this.sparkline.attr("data-api-url"),type:"get",dataType:"json",data:{since:(new Date).getTime()/1e3-3600*24,resolution:"1h"},success:_.bind(function(data){for(var i=0;i<data.length;i++){data[i][0]=data[i][0]*1e3}this.sparkline.empty();$.plot(this.sparkline,[{data:data,color:"#52566c",shadowSize:0,lines:{lineWidth:2,show:true,fill:true,fillColor:"#232428"}}],{yaxis:{min:0},grid:{show:false},hoverable:false,legend:{noColumns:5},lines:{show:false}});window.setTimeout(this.refreshSparkline,1e4)},this)})},refreshStats:function(){$.ajax({url:this.stats.attr("data-uri"),dataType:"json",success:_.bind(function(data){this.stats.find("[data-stat]").each(function(){var $this=$(this);var new_count=data[$this.attr("data-stat")];var counter=$this.find("big");var digit=counter.find("span");if(digit.is(":animated"))return false;if(counter.data("count")==new_count){return false}counter.data("count",new_count);var replacement=$("<span></span>",{css:{top:"-2.1em",opacity:0},text:new_count});digit.before(replacement).animate({top:"2.5em",opacity:0},"fast",function(){digit.remove()});replacement.delay(100).animate({top:0,opacity:1},"fast")});window.setTimeout(this.refreshStats,1e3)},this)})}});app.AccessGroupMembersPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);app.utils.makeSearchableUsersInput("form input[name=user]")}});app.TeamDetailsPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);app.utils.makeSearchableUsersInput("form input[name=owner]")}});app.ProjectDetailsPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);app.utils.makeSearchableUsersInput("form input[name=owner]");$("input[type=range]").each(_.bind(function loop(n,el){var $el=$(el),min=parseInt($el.attr("min"),10),max=parseInt($el.attr("max"),10),step=parseInt($el.attr("step"),10),values=[],$value=$('<span class="value"></span>');var i=min;while(i<=max){values.push(i);if(i<12){i+=1}else if(i<24){i+=3}else if(i<36){i+=6}else if(i<48){i+=12}else{i+=24}}$el.on("slider:ready",_.bind(function sliderready(event,data){$value.appendTo(data.el);$value.html(this.formatHours(data.value))},this)).on("slider:changed",_.bind(function sliderchanged(event,data){$value.html(this.formatHours(data.value))},this)).simpleSlider({range:[min,max],step:step,allowedValues:values,snap:true})},this))},formatHours:function formatHours(val){val=parseInt(val,10);if(val===0){return"Disabled"}else if(val>23&&val%24===0){val=val/24;return val+" day"+(val!=1?"s":"")}return val+" hour"+(val!=1?"s":"")}});app.ProjectNotificationsPage=BasePage.extend({initialize:function(){BasePage.prototype.initialize.apply(this,arguments);$("input[type=range]").each(_.bind(function loop(n,el){var $el=$(el),min=parseInt($el.attr("min"),10),max=parseInt($el.attr("max"),10),step=parseInt($el.attr("step"),10),$value=$('<span class="value"></span>');$el.on("slider:ready",_.bind(function sliderready(event,data){$value.appendTo(data.el);$value.html(this.formatThreshold(data.value))},this)).on("slider:changed",_.bind(function sliderchanged(event,data){$value.html(this.formatThreshold(data.value))},this)).simpleSlider({range:[min,max],step:step,snap:true})},this))},formatThreshold:function formatThreshold(value){if(!value){return"Disabled"}return value+"%"}});app.NewProjectPage=BasePage.extend({initialize:function(data){this.el=$(data.el);BasePage.prototype.initialize.apply(this,arguments);if(this.options.canSelectTeam&&this.options.canCreateTeam){$("#new_team").hide();$('a[rel="create-new-team"]').click(function(){$("#new_team").show();$("#select_team").hide()});$('a[rel="select-team"]').click(function(){$("#new_team").hide();$("#select_team").show()})}}});app.NewProjectRulePage=BasePage.extend({initialize:function(data){var select2_options={width:"element",allowClear:false,minimumResultsForSearch:10};BasePage.prototype.initialize.apply(this,arguments);_.bindAll(this,"addAction","addCondition","parseFormData");this.actions_by_id={};this.conditions_by_id={};this.el=$(data.el);this.action_sel=this.el.find('select[id="action-select"]');this.action_table=this.el.find("table.action-list");this.action_table_body=this.action_table.find("tbody");this.condition_sel=this.el.find('select[id="condition-select"]');this.condition_table=this.el.find("table.condition-list");this.condition_table_body=this.condition_table.find("tbody");this.action_sel.empty();this.action_sel.append($("<option></option>"));$.each(data.actions,_.bind(function(_,action){var opt=$("<option></option>");opt.attr({value:action.id});opt.text(action.label);opt.appendTo(this.action_sel);this.actions_by_id[action.id]=action},this));this.condition_sel.empty();this.condition_sel.append($("<option></option>"));$.each(data.conditions,_.bind(function(_,condition){var opt=$("<option></option>");opt.attr({value:condition.id});opt.text(condition.label);opt.appendTo(this.condition_sel);this.conditions_by_id[condition.id]=condition},this));this.action_sel.select2(select2_options);this.condition_sel.select2(select2_options);this.action_sel.change(_.bind(function(){this.addAction(this.action_sel.val())},this));this.condition_sel.change(_.bind(function(){this.addCondition(this.condition_sel.val())},this));this.parseFormData(data.form_data,data.form_errors)},parseFormData:function(form_data,form_errors){var data={action:{},action_match:form_data.action_match||"all",condition:{},label:form_data.label||""};form_errors=form_errors||{};$.each(form_data,function(key,value){var matches=key.match(/^(condition|action)\[(\d+)\]\[(.+)\]$/);var type,num;if(!matches){return}type=matches[1];num=matches[2];if(data[type][num]===undefined){data[type][num]={}}data[type][num][matches[3]]=value});this.el.find("input[name=label]").val(data.label);this.el.find('select[name="action_match"]').val(data.action_match);$.each(_.sortBy(data.condition),_.bind(function(num,item){this.addCondition(item.id,item,form_errors["condition["+num+"]"]||false)},this));$.each(_.sortBy(data.action),_.bind(function(num,item){this.addAction(item.id,item,form_errors["action["+num+"]"]||false)},this))},addCondition:function(id,options,has_errors){var node=this.conditions_by_id[id],row=$("<tr></tr>"),remove_btn=$('<button class="btn btn-small">Remove</button>'),num=this.condition_table_body.find("tr").length,html=$("<div>"+node.html+"</div>"),prefix="condition["+num+"]",id_field=$('<input type="hidden" name="'+prefix+'[id]" value="'+node.id+'">');has_errors=has_errors||false;options=options||{};if(has_errors){row.addClass("error")}html.find("select").each(function(){var $this=$(this),options={width:"element",allowClear:false,minimumResultsForSearch:10};if($this.attr("data-allowClear")){options.allowClear=$this.attr("data-allowClear")}$this.select2(options)});html.find("input, select, textarea").each(function(_,el){var $el=$(el),name=$el.attr("name");$el.attr("name",prefix+"["+name+"]");$el.val(options[name]||"")});row.append($("<td></td>").append(html).append(id_field));row.append($("<td></td>").append(remove_btn));
+row.appendTo(this.condition_table_body);remove_btn.click(function(){row.remove();return false});this.condition_sel.data("select2").clear();this.condition_table.show()},addAction:function(id,options,has_errors){var node=this.actions_by_id[id],row=$("<tr></tr>"),remove_btn=$('<button class="btn btn-small">Remove</button>'),num=this.action_table_body.find("tr").length,html=$("<div>"+node.html+"</div>"),prefix="action["+num+"]",id_field=$('<input type="hidden" name="'+prefix+'[id]" value="'+node.id+'">');has_errors=has_errors||false;options=options||{};if(has_errors){row.addClass("error")}html.find("select").each(function(){var $this=$(this),options={width:"element",allowClear:false,minimumResultsForSearch:10};if($this.attr("data-allowClear")){options.allowClear=$this.attr("data-allowClear")}$this.select2(options)});html.find("input, select, textarea").each(function(_,el){var $el=$(el),name=$el.attr("name");$el.attr("name",prefix+"["+name+"]");$el.val(options[name]||"")});row.append($("<td></td>").append(html).append(id_field));row.append($("<td></td>").append(remove_btn));row.appendTo(this.action_table_body);remove_btn.click(function(){row.remove();return false});this.action_sel.data("select2").clear();this.action_table.show()}});Backbone.sync=function(method,model,success,error){success()}})(window,app,Backbone,jQuery,_);
 //@ sourceMappingURL=global.min.map.js
\ No newline at end of file
diff --git a/src/sentry/static/sentry/scripts/views.js b/src/sentry/static/sentry/scripts/views.js
index b1c5407e9e..ac50951bea 100644
--- a/src/sentry/static/sentry/scripts/views.js
+++ b/src/sentry/static/sentry/scripts/views.js
@@ -28,7 +28,7 @@
 
         render: function(){
             var data = this.model.toJSON();
-            data.projectUrl = app.config.urlPrefix + '/' + app.config.teamId +
+            data.projectUrl = app.config.urlPrefix + '/' + app.config.organizationId +
                 '/' + data.project.slug + '/';
             data.loggerUrl = data.projectUrl + '?logger=' + data.logger;
 
diff --git a/src/sentry/templates/sentry/admin/users/edit.html b/src/sentry/templates/sentry/admin/users/edit.html
index 2bb8350d2f..3e7f75019e 100644
--- a/src/sentry/templates/sentry/admin/users/edit.html
+++ b/src/sentry/templates/sentry/admin/users/edit.html
@@ -43,7 +43,7 @@
                     {% for project, avg_events in project_list|with_event_counts %}
                         <tr>
                             <td>
-                                {{ project.name }} <a href="{% url 'sentry-stream' project.team.slug project.slug %}">[view]</a>
+                                {{ project.name }} <a href="{% url 'sentry-stream' project.organization.slug project.slug %}">[view]</a>
                                 </a>
                             </td>
                             <td style="text-align:center; vertical-align:middle;">
diff --git a/src/sentry/templates/sentry/admin/users/list_projects.html b/src/sentry/templates/sentry/admin/users/list_projects.html
index 6bc1118342..cc7c8f7904 100644
--- a/src/sentry/templates/sentry/admin/users/list_projects.html
+++ b/src/sentry/templates/sentry/admin/users/list_projects.html
@@ -29,7 +29,7 @@
                     {% for project, avg_events in project_list.objects|with_event_counts %}
                         <tr>
                             <td>
-                                {{ project.name }} <a href="{% url 'sentry-stream' project.team.slug project.slug %}">[view]</a>
+                                {{ project.name }} <a href="{% url 'sentry-stream' project.organization.slug project.slug %}">[view]</a>
                                 </a>
                             </td>
                             <td style="text-align:center; vertical-align:middle;">
diff --git a/src/sentry/templates/sentry/alerts/details.html b/src/sentry/templates/sentry/alerts/details.html
index 9a54aa48f1..d69de2651c 100644
--- a/src/sentry/templates/sentry/alerts/details.html
+++ b/src/sentry/templates/sentry/alerts/details.html
@@ -21,7 +21,7 @@
 
 {% block sidebar %}
     {% if not alert.is_resolved %}
-        <a href="{% url 'sentry-resolve-alert' project.team.slug project.slug alert.id %}" class="btn btn-primary" style="display: block">Resolve Alert</a>
+        <a href="{% url 'sentry-resolve-alert' project.organization.slug project.slug alert.id %}" class="btn btn-primary" style="display: block">Resolve Alert</a>
         <br>
     {% endif %}
     <h6>{% trans "Meta" %}</h6>
diff --git a/src/sentry/templates/sentry/alerts/list.html b/src/sentry/templates/sentry/alerts/list.html
index a535e02854..f520c1b74d 100644
--- a/src/sentry/templates/sentry/alerts/list.html
+++ b/src/sentry/templates/sentry/alerts/list.html
@@ -15,7 +15,7 @@
         <ul>
             {% for alert in alert_list %}
                 <li>
-                    <h4><a href="{% url 'sentry-alert-details' project.team.slug project.slug alert.id %}">{{ alert.datetime }}</a>
+                    <h4><a href="{% url 'sentry-alert-details' project.organization.slug project.slug alert.id %}">{{ alert.datetime }}</a>
                         <small>
                             &mdash; <span class="pretty-date" title="{{ alert.datetime|date:"c" }}Z">{{ alert.datetime|timesince }}</span>
                         </small></h4>
@@ -23,6 +23,6 @@
                 </li>
             {% endfor %}
         </ul>
-        <p>You can change your alert settings by visiting your <a href="{% url 'sentry-project-notifications' project.team.slug project.slug %}">project's notification settings</a> page.</p>
+        <p>You can change your alert settings by visiting your <a href="{% url 'sentry-project-notifications' project.organization.slug project.slug %}">project's notification settings</a> page.</p>
     </section>
 {% endblock %}
diff --git a/src/sentry/templates/sentry/alerts/team.html b/src/sentry/templates/sentry/alerts/team.html
index 5b7414e853..11c00f0e56 100644
--- a/src/sentry/templates/sentry/alerts/team.html
+++ b/src/sentry/templates/sentry/alerts/team.html
@@ -18,9 +18,9 @@
         <ul>
             {% for alert in alert_list %}
                 <li>
-                    <h4><a href="{% url 'sentry-alert-details' team.slug alert.project.slug alert.id %}">{{ alert.datetime }}</a>
+                    <h4><a href="{% url 'sentry-alert-details' organization.slug alert.project.slug alert.id %}">{{ alert.datetime }}</a>
                         <small>
-                            &mdash; <a href="{% url 'sentry-alerts' team.slug alert.project.slug %}">{{ alert.project.name }}</a>
+                            &mdash; <a href="{% url 'sentry-alerts' organization.slug alert.project.slug %}">{{ alert.project.name }}</a>
                             &mdash; <span class="pretty-date" title="{{ alert.datetime|date:"c" }}Z">{{ alert.datetime|timesince }}</span>
                         </small></h4>
                     {{ alert.message|linebreaks }}
diff --git a/src/sentry/templates/sentry/emails/error.html b/src/sentry/templates/sentry/emails/error.html
index 12a9c61f6e..2f7d176756 100644
--- a/src/sentry/templates/sentry/emails/error.html
+++ b/src/sentry/templates/sentry/emails/error.html
@@ -10,7 +10,7 @@
 
 {% block inner %}
     <h2>
-        {% url 'sentry-stream' group.project.team.slug group.project.slug as project_link %}
+        {% url 'sentry-stream' group.project.organization.slug group.project.slug as project_link %}
         {% if group.times_seen == 1 %}
             New Event on <a href="{% absolute_uri project_link %}" class="highlight">{{ group.team.name }} {{ group.project.name }}</a>
         {% else %}
diff --git a/src/sentry/templates/sentry/emails/new_note.html b/src/sentry/templates/sentry/emails/new_note.html
index 6eee204761..bc0be53765 100644
--- a/src/sentry/templates/sentry/emails/new_note.html
+++ b/src/sentry/templates/sentry/emails/new_note.html
@@ -10,8 +10,8 @@
 {% endblock %}
 
 {% block inner %}
-    {% url 'sentry-group' group.team.slug group.project.slug group.id as group_link %}
-    {% url 'sentry-stream' group.team.slug group.project.slug as project_link %}
+    {% url 'sentry-group' group.organization.slug group.project.slug group.id as group_link %}
+    {% url 'sentry-stream' group.organization.slug group.project.slug as project_link %}
     <div class="event level-{{ group.get_level_display }}">
         <div class="count">
             <span title="{{ group.times_seen }}">{{ group.times_seen|small_count }}</span>
diff --git a/src/sentry/templates/sentry/explore/code/list_tag.html b/src/sentry/templates/sentry/explore/code/list_tag.html
index f2454e5d26..321ab88f0a 100644
--- a/src/sentry/templates/sentry/explore/code/list_tag.html
+++ b/src/sentry/templates/sentry/explore/code/list_tag.html
@@ -9,9 +9,9 @@
 {% block inner %}
     <ul class="nav nav-tabs">
         <li{% if selection == 'filenames' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-explore-code' team.slug project.slug %}">Files</a></li>
+            <a href="{% url 'sentry-explore-code' organization.slug project.slug %}">Files</a></li>
         <li{% if selection == 'functions' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-explore-code-by-function' team.slug project.slug %}">Functions</a></li>
+            <a href="{% url 'sentry-explore-code-by-function' organization.slug project.slug %}">Functions</a></li>
     </ul>
 
     {% paginator tag_list from request as tag_list %}
@@ -48,11 +48,11 @@
                     <tr>
                         <td>
                             {% if selection == 'functions' %}
-                                {% url 'sentry-explore-code-details-by-function' team.slug project.slug tag.id as link %}
+                                {% url 'sentry-explore-code-details-by-function' organization.slug project.slug tag.id as link %}
                                 <a href="{{ link }}">{{ tag.data.function }}</a><br>
                                 <small>{{ tag.data.filename }}</small>
                             {% else %}
-                                {% url 'sentry-explore-code-details' team.slug project.slug tag.id as link %}
+                                {% url 'sentry-explore-code-details' organization.slug project.slug tag.id as link %}
                                 <a href="{{ link }}">{{ tag.data.filename }}</a><br>
                             {% endif %}
                         </td>
diff --git a/src/sentry/templates/sentry/explore/code/tag_details.html b/src/sentry/templates/sentry/explore/code/tag_details.html
index 16294778dc..2d3c3216ca 100644
--- a/src/sentry/templates/sentry/explore/code/tag_details.html
+++ b/src/sentry/templates/sentry/explore/code/tag_details.html
@@ -17,10 +17,10 @@
     <h6>{% trans "Code Details" %}</h6>
     <dl>
         <dt>{% trans "Filename:" %}</dt>
-        <dd><a href="{% url 'sentry-explore-code-details' team.slug project.slug tag.id %}">{{ tag.data.filename }}</a></dd>
+        <dd><a href="{% url 'sentry-explore-code-details' organization.slug project.slug tag.id %}">{{ tag.data.filename }}</a></dd>
         {% if selection == 'functions' %}
             <dt>{% trans "Function:" %}</dt>
-            <dd><a href="{% url 'sentry-explore-code-details-by-function' team.slug project.slug tag.id %}">{{ tag.data.function }}</a></dd>
+            <dd><a href="{% url 'sentry-explore-code-details-by-function' organization.slug project.slug tag.id %}">{{ tag.data.function }}</a></dd>
         {% endif %}
         <dt>First Seen:</dt>
         <dd>{{ tag.first_seen|timesince }}</dd>
diff --git a/src/sentry/templates/sentry/explore/tag_value_details.html b/src/sentry/templates/sentry/explore/tag_value_details.html
index e02a4f99f4..ae0316ad3c 100644
--- a/src/sentry/templates/sentry/explore/tag_value_details.html
+++ b/src/sentry/templates/sentry/explore/tag_value_details.html
@@ -11,7 +11,7 @@
     <dl>
         <dt>{% trans "Key:" %}</dt>
         <dd>
-            <a href="{% url 'sentry-explore-tag' team.slug project.slug tag_key.key %}">{{ tag_key.get_label }}</a>
+            <a href="{% url 'sentry-explore-tag' organization.slug project.slug tag_key.key %}">{{ tag_key.get_label }}</a>
         </dd>
         <dt>First Seen:</dt>
         <dd>{{ tag_value.first_seen|timesince }}</dd>
diff --git a/src/sentry/templates/sentry/groups/details.html b/src/sentry/templates/sentry/groups/details.html
index e9f9b162e9..3c4abc07dc 100644
--- a/src/sentry/templates/sentry/groups/details.html
+++ b/src/sentry/templates/sentry/groups/details.html
@@ -52,8 +52,8 @@
 
                 <div class="btn-toolbar event-toolbar">
                     <!-- We switch the ordering of events here as it makes more sense visually -->
-                    <a class="btn pull-left prev {% if not next_event %} disabled{% endif %}"{% if next_event %} href="{% url 'sentry-group-event' group.team.slug group.project.slug group.id next_event.id %}"{% endif %}><span></span> {% trans "Newer Event" %}</a>
-                    <a class="btn pull-right next {% if not prev_event %} disabled{% endif %}"{% if prev_event %} href="{% url 'sentry-group-event' group.team.slug group.project.slug group.id prev_event.id %}"{% endif %}>{% trans "Older Event" %} <span></span></a>
+                    <a class="btn pull-left prev {% if not next_event %} disabled{% endif %}"{% if next_event %} href="{% url 'sentry-group-event' group.organization.slug group.project.slug group.id next_event.id %}"{% endif %}><span></span> {% trans "Newer Event" %}</a>
+                    <a class="btn pull-right next {% if not prev_event %} disabled{% endif %}"{% if prev_event %} href="{% url 'sentry-group-event' group.organization.slug group.project.slug group.id prev_event.id %}"{% endif %}>{% trans "Older Event" %} <span></span></a>
                     <h4>
                     Event at <span title="{{ event.datetime }}">{% localized_datetime event.datetime %}</span> [{{ event.size|filesizeformat }}]<br><small>ID: {{ event.event_id }}</small></h4>
                 </div>
@@ -76,12 +76,12 @@
 
 {% block sidebar %}
     <ul class="nav nav-list">
-        <li{% if page == 'details' %} class="active"{% endif %}><a href="{% url 'sentry-group' group.team.slug group.project.slug group.id %}">Aggregate</a></li>
+        <li{% if page == 'details' %} class="active"{% endif %}><a href="{% url 'sentry-group' group.organization.slug group.project.slug group.id %}">Aggregate</a></li>
         <li{% if page == 'tag_list' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-group-tags' group.team.slug group.project.slug group.id %}">{% trans "Tags" %}</a>
+            <a href="{% url 'sentry-group-tags' group.organization.slug group.project.slug group.id %}">{% trans "Tags" %}</a>
         </li>
         <li{% if page == 'event_list' or page == 'event' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-group-events' group.team.slug group.project.slug group.id %}">{% trans "Similar Events" %}</a>
+            <a href="{% url 'sentry-group-events' group.organization.slug group.project.slug group.id %}">{% trans "Similar Events" %}</a>
         </li>
     </ul>
 
@@ -124,15 +124,15 @@
         <li class="nav-header">{% trans "Actions" %}</li>
         {% if can_admin_event %}
             {% if not group.is_muted %}
-                <li><a href="{% url 'sentry-api-set-group-mute' group.team.slug project.slug group.id %}">{% trans "Mute Event" %}</a></li>
+                <li><a href="{% url 'sentry-api-set-group-mute' group.organization.slug project.slug group.id %}">{% trans "Mute Event" %}</a></li>
             {% elif not group.is_resolved %}
-                <li><a href="{% url 'sentry-api-set-group-unresolve' group.team.slug project.slug group.id %}">{% trans "Unmute Event" %}</a></li>
+                <li><a href="{% url 'sentry-api-set-group-unresolve' group.organization.slug project.slug group.id %}">{% trans "Unmute Event" %}</a></li>
             {% endif %}
-            {% url 'sentry-group' group.team.slug group.project.slug group.id as group_link %}
+            {% url 'sentry-group' group.organization.slug group.project.slug group.id as group_link %}
             <li>
                 <a href="javascript:void(0)"
-                   data-public-url="{% url 'sentry-api-set-group-public' group.team.slug group.project.slug group.id %}"
-                   data-private-url="{% url 'sentry-api-set-group-private' group.team.slug group.project.slug group.id %}"
+                   data-public-url="{% url 'sentry-api-set-group-public' group.organization.slug group.project.slug group.id %}"
+                   data-private-url="{% url 'sentry-api-set-group-private' group.organization.slug group.project.slug group.id %}"
                    data-share-url="{% absolute_uri group_link %}"
                    data-public="{% if group.is_public %}true{% else %}false{% endif %}"
                    class="share-link">{% trans "Share Event" %}</a>
@@ -142,11 +142,11 @@
             {% endfor %}
         {% endif %}
         <li><a {% if event.id %}
-        href="{% url 'sentry-group-event-json' group.team.slug project.slug group.id event.id %}"{% else %}
-        href="{% url 'sentry-group-event-json' group.team.slug project.slug group.id 'latest' %}"{% endif %}
+        href="{% url 'sentry-group-event-json' group.organization.slug project.slug group.id event.id %}"{% else %}
+        href="{% url 'sentry-group-event-json' group.organization.slug project.slug group.id 'latest' %}"{% endif %}
         >{% trans "Raw JSON Data" %}</a></li>
         {% if can_remove_event %}
-            <li><a href="{% url 'sentry-api-remove-group' group.team.slug project.slug group.id %}"
+            <li><a href="{% url 'sentry-api-remove-group' group.organization.slug project.slug group.id %}"
                    onclick="return confirm('{% trans "Are you sure you wish to delete all data for this event?" %}');">{% trans "Remove Event Data" %}</a></li>
         {% endif %}
     </ul>
diff --git a/src/sentry/templates/sentry/groups/group_list.html b/src/sentry/templates/sentry/groups/group_list.html
index 9e9dc29e93..ff61825985 100644
--- a/src/sentry/templates/sentry/groups/group_list.html
+++ b/src/sentry/templates/sentry/groups/group_list.html
@@ -132,7 +132,7 @@
             {% for alert in recent_alerts %}
                 <li class="alert alert-error">
                     <a class="close" data-dismiss="alert">×</a>
-                    <a href="{% url 'sentry-alert-details' project.team.slug project.slug alert.id %}">{{ alert.message }}</a>
+                    <a href="{% url 'sentry-alert-details' project.organization.slug project.slug alert.id %}">{{ alert.message }}</a>
                     <small>&mdash; {{ alert.datetime|timesince }}</small>
                 </li>
             {% endfor %}
diff --git a/src/sentry/templates/sentry/groups/public_details.html b/src/sentry/templates/sentry/groups/public_details.html
index f516b7fe49..8a4c0364e0 100644
--- a/src/sentry/templates/sentry/groups/public_details.html
+++ b/src/sentry/templates/sentry/groups/public_details.html
@@ -28,8 +28,8 @@
 
                 <div class="btn-toolbar event-toolbar">
                     <!-- We switch the ordering of events here as it makes more sense visually -->
-                    <a class="btn pull-left prev {% if not next_event %} disabled{% endif %}"{% if next_event %} href="{% url 'sentry-group-event' group.team.slug group.project.slug group.id next_event.id %}"{% endif %}><span></span> {% trans "Newer Event" %}</a>
-                    <a class="btn pull-right next {% if not prev_event %} disabled{% endif %}"{% if prev_event %} href="{% url 'sentry-group-event' group.team.slug group.project.slug group.id prev_event.id %}"{% endif %}>{% trans "Older Event" %} <span></span></a>
+                    <a class="btn pull-left prev {% if not next_event %} disabled{% endif %}"{% if next_event %} href="{% url 'sentry-group-event' group.organization.slug group.project.slug group.id next_event.id %}"{% endif %}><span></span> {% trans "Newer Event" %}</a>
+                    <a class="btn pull-right next {% if not prev_event %} disabled{% endif %}"{% if prev_event %} href="{% url 'sentry-group-event' group.organization.slug group.project.slug group.id prev_event.id %}"{% endif %}>{% trans "Older Event" %} <span></span></a>
                     <h4>Event at {{ event.datetime }} {{ event.datetime.tzinfo }}</h4>
                 </div>
 
diff --git a/src/sentry/templates/sentry/groups/tag_list.html b/src/sentry/templates/sentry/groups/tag_list.html
index 208df76fb2..1cf51ac4f3 100644
--- a/src/sentry/templates/sentry/groups/tag_list.html
+++ b/src/sentry/templates/sentry/groups/tag_list.html
@@ -15,7 +15,7 @@
             {% endif %}
             <div class="span6">
                 <div class="page-header">
-                    <span class="pull-right"><a href="{% url 'sentry-group-tag-details' group.team.slug group.project.slug group.id tag_key.key|urlquote %}">More Details</a></span>
+                    <span class="pull-right"><a href="{% url 'sentry-group-tag-details' group.organization.slug group.project.slug group.id tag_key.key|urlquote %}">More Details</a></span>
 
                     <h4>{{ tag_key.get_label }} <small>({{ values_seen|small_count }})</small></h4>
                 </div>
@@ -25,7 +25,7 @@
                         <li>
                             <div class="progressbar">
                                 <div style="width:{{ percent }}%;">{{ times_seen }}</div>
-                                <a href="{% url 'sentry-stream' group.team.slug group.project.slug %}?{{ tag_key.key|urlquote }}={{ tag_value|urlquote }}">
+                                <a href="{% url 'sentry-stream' group.organization.slug group.project.slug %}?{{ tag_key.key|urlquote }}={{ tag_value|urlquote }}">
                                     {{ tag_value }}
                                     <span>{{ times_seen|small_count }} ({{ percent }}%)</span>
                                 </a>
diff --git a/src/sentry/templates/sentry/partial/_client_config.html b/src/sentry/templates/sentry/partial/_client_config.html
index 3cf36f3184..0dc8f51f71 100644
--- a/src/sentry/templates/sentry/partial/_client_config.html
+++ b/src/sentry/templates/sentry/partial/_client_config.html
@@ -56,43 +56,43 @@
 </div>
 <ul class="client-platform-list">
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'python' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'python' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/python48x48.png" %}"></span>
             <strong>Python</strong>
         </a>
     </li>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'php' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'php' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/php48x48.png" %}"></span>
             <strong>PHP</strong>
         </a>
     </li>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'ruby' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'ruby' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/ruby48x48.png" %}"></span>
             <strong>Ruby</strong>
         </a>
     </li>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'javascript' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'javascript' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/javascript48x48.png" %}"></span>
             <strong>JavaScript</strong>
         </a>
     </li>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'java' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'java' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/java48x48.png" %}"></span>
             <strong>Java</strong>
         </a>
     </li>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'node.js' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'node.js' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/node48x48.png" %}"></span>
             <strong>Node.js</strong>
         </a>
     </li>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'ios' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'ios' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/ios48x48.png" %}"></span>
             <strong>iOS</strong>
         </a>
@@ -103,19 +103,19 @@
 </div>
 <ul class="client-platform-list">
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'rails3' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'rails3' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/rails48x48.png" %}"></span>
             <strong>Rails 3</strong>
         </a>
     </li>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'rails4' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'rails4' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/rails48x48.png" %}"></span>
             <strong>Rails 4</strong>
         </a>
     </li>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'django' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'django' %}">
             <span><img src="{% url 'sentry-media' "sentry" "images/platforms/django48x48.png" %}"></span>
             <strong>Django</strong>
         </a>
@@ -127,12 +127,12 @@
 </div>
 <ul>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'csharp' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'csharp' %}">
             <strong>C#</strong>
         </a>
     </li>
     <li>
-        <a href="{% url 'sentry-docs-client' project.team.slug project.slug 'r' %}">
+        <a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'r' %}">
             <strong>R Project</strong>
         </a>
     </li>
diff --git a/src/sentry/templates/sentry/partial/_event.html b/src/sentry/templates/sentry/partial/_event.html
index 5dd2b9128c..e9525f061b 100644
--- a/src/sentry/templates/sentry/partial/_event.html
+++ b/src/sentry/templates/sentry/partial/_event.html
@@ -4,7 +4,7 @@
 <li class="event">
     <div class="details">
         <h3>
-            <a href="{% url 'sentry-group-event' event.team.slug event.project.slug event.group_id event.pk %}">
+            <a href="{% url 'sentry-group-event' event.organization.slug event.project.slug event.group_id event.pk %}">
                 {{ event.message_short }}
             </a>
         </h3>
@@ -14,7 +14,7 @@
                 <span class="time-spent">{{ event.time_spent|duration }}</span>
             {% endif %}
         </div>
-        <a href="{% url 'sentry-group-event' event.team.slug event.project.slug event.group_id event.pk %}" class="row_link"></a>
+        <a href="{% url 'sentry-group-event' event.organization.slug event.project.slug event.group_id event.pk %}" class="row_link"></a>
     </div>
 </li>
 
diff --git a/src/sentry/templates/sentry/partial/_event_details.html b/src/sentry/templates/sentry/partial/_event_details.html
index c9192cacc9..878b8946be 100644
--- a/src/sentry/templates/sentry/partial/_event_details.html
+++ b/src/sentry/templates/sentry/partial/_event_details.html
@@ -11,7 +11,7 @@
                 <li>
                     <strong>{{ tag_key }}</strong>
                     <em>=</em>
-                    <span><a href="{% url 'sentry-stream' group.team.slug group.project.slug %}?{{ tag_key }}={{ tag_value }}">{{ tag_value }}</a> {% if tag_value|is_url %}<a href="{{ tag_value }}" class="icon-share"></a>{% endif %}</span>
+                    <span><a href="{% url 'sentry-stream' group.organization.slug group.project.slug %}?{{ tag_key }}={{ tag_value }}">{{ tag_value }}</a> {% if tag_value|is_url %}<a href="{{ tag_value }}" class="icon-share"></a>{% endif %}</span>
                 </li>
             {% endfor %}
         </ul>
diff --git a/src/sentry/templates/sentry/partial/_group.html b/src/sentry/templates/sentry/partial/_group.html
index 6ca0dae7f6..fafc26f876 100644
--- a/src/sentry/templates/sentry/partial/_group.html
+++ b/src/sentry/templates/sentry/partial/_group.html
@@ -7,12 +7,12 @@
     <div class="count"><span title="{{ group.times_seen }}">{{ group.times_seen|small_count }}</span></div>
     <div class="details">
         <h3>
-            <a href="{% url 'sentry-group' group.team.slug group.project.slug group.pk %}">
+            <a href="{% url 'sentry-group' group.organization.slug group.project.slug group.pk %}">
                 {{ group.title }}
             </a>
         </h3>
         <p class="message" title="{{ group.message }}">
-            <a href="{% url 'sentry-stream' group.team.slug group.project.slug %}?logger={{ group.logger }}" class="tag tag-logger">{{ group.logger }}</a>
+            <a href="{% url 'sentry-stream' group.organization.slug group.project.slug %}?logger={{ group.logger }}" class="tag tag-logger">{{ group.logger }}</a>
             {% for tag in group|get_tags:request %}<span class="tag">{{ tag }}</span> {% endfor %}
             {{ group.error }}
         </p>
diff --git a/src/sentry/templates/sentry/partial/client_config/java_base.html b/src/sentry/templates/sentry/partial/client_config/java_base.html
index 7b5f03ea03..4c3e51b7df 100644
--- a/src/sentry/templates/sentry/partial/client_config/java_base.html
+++ b/src/sentry/templates/sentry/partial/client_config/java_base.html
@@ -6,11 +6,11 @@
 </div>
 
 <ul class="nav nav-tabs">
-    <li{% if platform == 'java' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'java' %}">Java</a></li>
-    <li{% if platform == 'java_logging' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'java_logging' %}">java.util.logging</a></li>
-    <li{% if platform == 'java_log4j' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'java_log4j' %}">log4j</a></li>
-    <li{% if platform == 'java_log4j2' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'java_log4j2' %}">log4j2</a></li>
-    <li{% if platform == 'java_logback' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'java_logback' %}">logback</a></li>
+    <li{% if platform == 'java' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'java' %}">Java</a></li>
+    <li{% if platform == 'java_logging' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'java_logging' %}">java.util.logging</a></li>
+    <li{% if platform == 'java_log4j' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'java_log4j' %}">log4j</a></li>
+    <li{% if platform == 'java_log4j2' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'java_log4j2' %}">log4j2</a></li>
+    <li{% if platform == 'java_logback' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'java_logback' %}">logback</a></li>
 </ul>
 
 <p>{% blocktrans with 'https://github.com/kencochrane/raven-java' as link %}Start by installing <a href="{{ link }}">raven-java</a>.{% endblocktrans %}</p>
@@ -22,7 +22,7 @@
   &lt;artifactId&gt;raven&lt;/artifactId&gt;
   &lt;version&gt;4.0&lt;/version&gt;
 &lt;/dependency&gt;</pre>
-    
+
 {% block inner %}
 {% endblock %}
 
diff --git a/src/sentry/templates/sentry/partial/client_config/node_base.html b/src/sentry/templates/sentry/partial/client_config/node_base.html
index b5763815ad..a21f3ca9dd 100644
--- a/src/sentry/templates/sentry/partial/client_config/node_base.html
+++ b/src/sentry/templates/sentry/partial/client_config/node_base.html
@@ -5,9 +5,9 @@
 </div>
 
 <ul class="nav nav-tabs">
-	<li{% if platform == 'node.js' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'node.js' %}">Node.js</a></li>
-	<li{% if platform == 'express' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'express' %}">Express</a></li>
-	<li{% if platform == 'connect' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'connect' %}">Connect</a></li>
+	<li{% if platform == 'node.js' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'node.js' %}">Node.js</a></li>
+	<li{% if platform == 'express' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'express' %}">Express</a></li>
+	<li{% if platform == 'connect' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'connect' %}">Connect</a></li>
 </ul>
 
 {% block inner %}
diff --git a/src/sentry/templates/sentry/partial/client_config/python_base.html b/src/sentry/templates/sentry/partial/client_config/python_base.html
index 42540a286e..e5468fe383 100644
--- a/src/sentry/templates/sentry/partial/client_config/python_base.html
+++ b/src/sentry/templates/sentry/partial/client_config/python_base.html
@@ -6,11 +6,11 @@
 </div>
 
 <ul class="nav nav-tabs">
-	<li{% if platform == 'python' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'python' %}">Python</a></li>
-	<li{% if platform == 'django' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'django' %}">Django</a></li>
-	<li{% if platform == 'flask' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'flask' %}">Flask</a></li>
-	<li{% if platform == 'pyramid' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'pyramid' %}">Pyramid</a></li>
-	<li{% if platform == 'tornado' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'tornado' %}">Tornado</a></li>
+	<li{% if platform == 'python' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'python' %}">Python</a></li>
+	<li{% if platform == 'django' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'django' %}">Django</a></li>
+	<li{% if platform == 'flask' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'flask' %}">Flask</a></li>
+	<li{% if platform == 'pyramid' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'pyramid' %}">Pyramid</a></li>
+	<li{% if platform == 'tornado' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'tornado' %}">Tornado</a></li>
 </ul>
 
 <p>{% blocktrans with 'https://github.com/getsentry/raven-python' as link %}Start by installing <a href="{{ link }}">raven-python</a>:{% endblocktrans %}</p>
diff --git a/src/sentry/templates/sentry/partial/client_config/ruby_base.html b/src/sentry/templates/sentry/partial/client_config/ruby_base.html
index cb7a3a7e51..e19e56229b 100644
--- a/src/sentry/templates/sentry/partial/client_config/ruby_base.html
+++ b/src/sentry/templates/sentry/partial/client_config/ruby_base.html
@@ -6,11 +6,11 @@
 </div>
 
 <ul class="nav nav-tabs">
-	<li{% if platform == 'ruby' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'ruby' %}">Ruby</a></li>
-	<li{% if platform == 'rails3' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'rails3' %}">Rails 3</a></li>
-  <li{% if platform == 'rails4' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'rails4' %}">Rails 4</a></li>
-  <li{% if platform == 'sinatra' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'sinatra' %}">Sinatra</a></li>
-  <li{% if platform == 'sidekiq' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.team.slug project.slug 'sidekiq' %}">Sidekiq</a></li>
+	<li{% if platform == 'ruby' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'ruby' %}">Ruby</a></li>
+	<li{% if platform == 'rails3' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'rails3' %}">Rails 3</a></li>
+  <li{% if platform == 'rails4' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'rails4' %}">Rails 4</a></li>
+  <li{% if platform == 'sinatra' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'sinatra' %}">Sinatra</a></li>
+  <li{% if platform == 'sidekiq' %} class="active"{% endif %}><a href="{% url 'sentry-docs-client' project.organization.slug project.slug 'sidekiq' %}">Sidekiq</a></li>
 </ul>
 
 
diff --git a/src/sentry/templates/sentry/plugins/bases/tag/index.html b/src/sentry/templates/sentry/plugins/bases/tag/index.html
index 5a6b71c013..f005e6d0b8 100644
--- a/src/sentry/templates/sentry/plugins/bases/tag/index.html
+++ b/src/sentry/templates/sentry/plugins/bases/tag/index.html
@@ -27,7 +27,7 @@
             <tbody>
                 {% for tag_value, times_seen, first_seen, last_seen in tag_list.objects %}
                     <tr>
-                        <td><a href="{% url 'sentry-stream' group.team.slug group.project.slug %}?{{ tag_name }}={{ tag_value }}">{{ tag_value }}</a></td>
+                        <td><a href="{% url 'sentry-stream' group.organization.slug group.project.slug %}?{{ tag_name }}={{ tag_value }}">{{ tag_value }}</a></td>
                         <td style="text-align:center">{{ times_seen|small_count }}</td>
                         <td style="text-align:center">{% if first_seen %}{{ first_seen|timesince }}{% else %}<em>n/a</em>{% endif %}</td>
                         <td style="text-align:center">{% if last_seen %}{{ last_seen|timesince }}{% else %}<em>n/a</em>{% endif %}</td>
diff --git a/src/sentry/templates/sentry/plugins/bases/tag/widget.html b/src/sentry/templates/sentry/plugins/bases/tag/widget.html
index 6035dd08f6..f5e7caa38b 100644
--- a/src/sentry/templates/sentry/plugins/bases/tag/widget.html
+++ b/src/sentry/templates/sentry/plugins/bases/tag/widget.html
@@ -2,7 +2,7 @@
 {% load sentry_helpers %}
 
 <ul class="nav nav-list counted-list tag-widget"
-    data-url="{% url 'sentry-api-group-tags' group.team.slug group.project.slug group.id tag_name %}">
+    data-url="{% url 'sentry-api-group-tags' group.organization.slug group.project.slug group.id tag_name %}">
     <li class="nav-header">{{ title }}</li>
     <li class="loading">Loading...</li>
 </ul>
diff --git a/src/sentry/templates/sentry/projects/keys.html b/src/sentry/templates/sentry/projects/keys.html
index 53d065471b..c8ab4f27af 100644
--- a/src/sentry/templates/sentry/projects/keys.html
+++ b/src/sentry/templates/sentry/projects/keys.html
@@ -9,7 +9,7 @@
 {% block inner %}
     <div class="page-header">
         {% if can_add_key %}
-            <a href="{% url 'sentry-new-project-key' project.team.slug project.slug %}" class="btn pull-right btn-primary">{% trans "Generate New Key" %}</a>
+            <a href="{% url 'sentry-new-project-key' project.organization.slug project.slug %}" class="btn pull-right btn-primary">{% trans "Generate New Key" %}</a>
         {% endif %}
         <h2>
             {% trans "Manage API Keys" %}
@@ -31,9 +31,9 @@
                 <tr>
                     <td>
                         {% if key.label %}
-                            <a href="{% url 'sentry-edit-project-key' project.team.slug project.slug key.id %}">{{ key.label }}</a>
+                            <a href="{% url 'sentry-edit-project-key' project.organization.slug project.slug key.id %}">{{ key.label }}</a>
                         {% else %}
-                            <a href="{% url 'sentry-edit-project-key' project.team.slug project.slug key.id %}">{{ key.public_key }}</a> {% if key.user %} &mdash; {{ key.user.email }}{% endif %}
+                            <a href="{% url 'sentry-edit-project-key' project.organization.slug project.slug key.id %}">{{ key.public_key }}</a> {% if key.user %} &mdash; {{ key.user.email }}{% endif %}
                         {% endif %}<br>
                         <code class="clippy">{{ key.dsn_private }}</code><br>
                         {% if key.user_added %}
@@ -42,7 +42,7 @@
                     </td>
                     <td style="text-align:center; vertical-align:middle;">
                         {% if key.can_remove %}
-                            <form method="POST" action="{% url 'sentry-remove-project-key' project.team.slug project.slug key.id %}" style="display:inline">
+                            <form method="POST" action="{% url 'sentry-remove-project-key' project.organization.slug project.slug key.id %}" style="display:inline">
                                 {% csrf_token %}
                                 <input type="submit" class="btn btn-danger btn-small" value="{% trans "Revoke" %}">
                             </form>
diff --git a/src/sentry/templates/sentry/projects/manage.html b/src/sentry/templates/sentry/projects/manage.html
index aaa4ab553e..8ff432e182 100644
--- a/src/sentry/templates/sentry/projects/manage.html
+++ b/src/sentry/templates/sentry/projects/manage.html
@@ -47,7 +47,7 @@
             <div class="form-actions">
                 <button type="submit" class="btn btn-primary">{% trans "Save Changes" %}</button>
                 {% if not project.is_internal_project %}
-                    <a href="{% url 'sentry-remove-project' project.team.slug project.slug %}" class="btn btn-danger">{% trans "Remove Project" %}</a>
+                    <a href="{% url 'sentry-remove-project' project.organization.slug project.slug %}" class="btn btn-danger">{% trans "Remove Project" %}</a>
                 {% else %}
                     <p class="pull-right">{% trans "This project cannot be removed. It is used internally by the Sentry server." %}</p>
                 {% endif %}
diff --git a/src/sentry/templates/sentry/projects/notifications.html b/src/sentry/templates/sentry/projects/notifications.html
index 25d91aa4ba..5942dce966 100644
--- a/src/sentry/templates/sentry/projects/notifications.html
+++ b/src/sentry/templates/sentry/projects/notifications.html
@@ -17,7 +17,7 @@
             <h3>{% trans "Events" %}</h3>
         </div>
 
-        {% url 'sentry-project-rules' team.slug project.slug as link %}
+        {% url 'sentry-project-rules' organization.slug project.slug as link %}
         <p>{% blocktrans %}Sentry will notify you based on the <a href="{{ link }}">rules configured for this project</a>.{% endblocktrans %}</p>
 
         <div class="page-header">
diff --git a/src/sentry/templates/sentry/projects/plugins/configure.html b/src/sentry/templates/sentry/projects/plugins/configure.html
index 80d996d80d..c6cb40dff5 100644
--- a/src/sentry/templates/sentry/projects/plugins/configure.html
+++ b/src/sentry/templates/sentry/projects/plugins/configure.html
@@ -8,12 +8,12 @@
         <div class="pull-right">
             {% if plugin.can_disable %}
                 {% if not plugin_is_enabled %}
-                    <a href="{% url 'sentry-enable-project-plugin' project.team.slug project.slug plugin.slug %}" class="btn">{% trans "Enable Plugin" %}</a>
+                    <a href="{% url 'sentry-enable-project-plugin' project.organization.slug project.slug plugin.slug %}" class="btn">{% trans "Enable Plugin" %}</a>
                 {% else %}
-                    <a href="{% url 'sentry-disable-project-plugin' project.team.slug project.slug plugin.slug %}" class="btn">{% trans "Disable Plugin" %}</a>
+                    <a href="{% url 'sentry-disable-project-plugin' project.organization.slug project.slug plugin.slug %}" class="btn">{% trans "Disable Plugin" %}</a>
                 {% endif %}
             {% endif %}
-            <a href="{% url 'sentry-reset-project-plugin' project.team.slug project.slug plugin.slug %}" class="btn"
+            <a href="{% url 'sentry-reset-project-plugin' project.organization.slug project.slug plugin.slug %}" class="btn"
                 onclick="return confirm('{% trans "Are you sure you wish to reset all configuration for this plugin?" %}');">{% trans "Reset Configuration" %}</a>
         </div>
         <h2>{% blocktrans with plugin.get_title as name %}Configure {{ name }}{% endblocktrans %}</h2>
diff --git a/src/sentry/templates/sentry/projects/plugins/list.html b/src/sentry/templates/sentry/projects/plugins/list.html
index 70108b8530..1aad623838 100644
--- a/src/sentry/templates/sentry/projects/plugins/list.html
+++ b/src/sentry/templates/sentry/projects/plugins/list.html
@@ -25,7 +25,7 @@
                     <tr>
                         <td>
                             {% if plugin.has_project_conf %}
-                                <a href="{% url 'sentry-configure-project-plugin' project.team.slug project.slug plugin.slug %}">{{ plugin.get_title }}</a>
+                                <a href="{% url 'sentry-configure-project-plugin' project.organization.slug project.slug plugin.slug %}">{{ plugin.get_title }}</a>
                             {% else %}
                                 {{ plugin.get_title }}
                             {% endif %}
diff --git a/src/sentry/templates/sentry/projects/rules/list.html b/src/sentry/templates/sentry/projects/rules/list.html
index 859729f4cc..bbfc483361 100644
--- a/src/sentry/templates/sentry/projects/rules/list.html
+++ b/src/sentry/templates/sentry/projects/rules/list.html
@@ -4,7 +4,7 @@
 
 {% block inner %}
     <div class="page-header">
-        <a href="{% url 'sentry-new-project-rule' project.team.slug project.slug %}" class="btn pull-right btn-primary">{% trans "New Rule" %}</a>
+        <a href="{% url 'sentry-new-project-rule' project.organization.slug project.slug %}" class="btn pull-right btn-primary">{% trans "New Rule" %}</a>
         <h2>{% trans "Rules" %}</h2>
     </div>
     {% if rule_list %}
@@ -19,10 +19,10 @@
                 {% for rule in rule_list %}
                     <tr>
                         <td>
-                            <a href="{% url 'sentry-edit-project-rule' project.team.slug project.slug rule.id %}">{{ rule.label }}</a>
+                            <a href="{% url 'sentry-edit-project-rule' project.organization.slug project.slug rule.id %}">{{ rule.label }}</a>
                         </td>
                         <td>
-                            <a href="{% url 'sentry-remove-project-rule' project.team.slug project.slug rule.id %}"
+                            <a href="{% url 'sentry-remove-project-rule' project.organization.slug project.slug rule.id %}"
                                onclick="confirm('Are you sure you want to remove this rule?')">Delete</a>
                         </td>
                     </tr>
diff --git a/src/sentry/templates/sentry/users/list.html b/src/sentry/templates/sentry/users/list.html
index 3c0cddfa93..a3fbb7e905 100644
--- a/src/sentry/templates/sentry/users/list.html
+++ b/src/sentry/templates/sentry/users/list.html
@@ -39,7 +39,7 @@
             <tbody>
                 {% for tag in tag_list.paginator.objects %}
                     <tr>
-                        <td><a href="{% url 'sentry-user-details' team.slug project.slug tag.id %}">{{ tag.get_label }}</a></td>
+                        <td><a href="{% url 'sentry-user-details' organization.slug project.slug tag.id %}">{{ tag.get_label }}</a></td>
                         <td style="text-align:center">{{ tag.last_seen|timesince }}</td>
                         <td style="text-align:center">{{ tag.times_seen|small_count }}</td>
                     </tr>
diff --git a/src/sentry/utils/javascript.py b/src/sentry/utils/javascript.py
index 40f8259c7d..5f0bf91bc0 100644
--- a/src/sentry/utils/javascript.py
+++ b/src/sentry/utils/javascript.py
@@ -167,7 +167,7 @@ class GroupTransformer(Transformer):
             'level': obj.level,
             'levelName': escape(obj.get_level_display()),
             'logger': escape(obj.logger),
-            'permalink': absolute_uri(reverse('sentry-group', args=[obj.team.slug, obj.project.slug, obj.id])),
+            'permalink': absolute_uri(reverse('sentry-group', args=[obj.organization.slug, obj.project.slug, obj.id])),
             'firstSeen': self.localize_datetime(obj.first_seen, request=request),
             'lastSeen': self.localize_datetime(obj.last_seen, request=request),
             'timeSpent': obj.avg_time_spent,
diff --git a/src/sentry/web/frontend/alerts.py b/src/sentry/web/frontend/alerts.py
index 7da147a0ed..cf4574fca0 100644
--- a/src/sentry/web/frontend/alerts.py
+++ b/src/sentry/web/frontend/alerts.py
@@ -21,7 +21,7 @@ from sentry.web.helpers import render_to_response
 
 @login_required
 @has_access
-def alert_list(request, team, project=None):
+def alert_list(request, organization, team=None, project=None):
     alert_list = Alert.objects.filter(
         group__isnull=True,
         status=STATUS_UNRESOLVED,
@@ -38,7 +38,8 @@ def alert_list(request, team, project=None):
         template = 'sentry/alerts/team.html'
 
     return render_to_response(template, {
-        'team': team,
+        'organization': project.organization,
+        'team': project.team,
         'project': project,
         'alert_list': list(alert_list[:20]),
         'SECTION': 'alerts',
@@ -47,16 +48,17 @@ def alert_list(request, team, project=None):
 
 @login_required
 @has_access
-def alert_details(request, team, project, alert_id):
+def alert_details(request, organization, project, alert_id):
     try:
         alert = Alert.objects.get(id=alert_id, project=project)
     except Alert.DoesNotExist:
-        return HttpResponseRedirect(reverse('sentry-alerts', args=[team.slug, project.slug]))
+        return HttpResponseRedirect(reverse('sentry-alerts', args=[organization.slug, project.slug]))
 
     related_group_list = list(alert.related_groups.order_by('-score', '-times_seen'))
 
     return render_to_response('sentry/alerts/details.html', {
-        'team': team,
+        'organization': project.organization,
+        'team': project.team,
         'project': project,
         'alert': alert,
         'related_group_list': related_group_list,
@@ -66,12 +68,12 @@ def alert_details(request, team, project, alert_id):
 
 @login_required
 @has_access
-def resolve_alert(request, team, project, alert_id):
+def resolve_alert(request, organization, project, alert_id):
     try:
         alert = Alert.objects.get(id=alert_id, project=project)
     except Alert.DoesNotExist:
-        return HttpResponseRedirect(reverse('sentry-alerts', args=[team.slug, project.slug]))
+        return HttpResponseRedirect(reverse('sentry-alerts', args=[organization.slug, project.slug]))
 
     alert.update(status=STATUS_RESOLVED)
 
-    return HttpResponseRedirect(reverse('sentry-alert-details', args=[team.slug, project.slug, alert.id]))
+    return HttpResponseRedirect(reverse('sentry-alert-details', args=[organization.slug, project.slug, alert.id]))
diff --git a/tests/sentry/web/frontend/users/tests.py b/tests/sentry/web/frontend/users/tests.py
index 8eeeb8d4f3..c8d503f9f9 100644
--- a/tests/sentry/web/frontend/users/tests.py
+++ b/tests/sentry/web/frontend/users/tests.py
@@ -64,7 +64,7 @@ class UserDetailsTest(TestCase):
 
     def test_invalid_tuser_id(self):
         resp = self.client.get(reverse('sentry-user-details', args=[
-            self.team.slug, self.project.slug, 0]))
+            self.organization.slug, self.project.slug, 0]))
         assert resp.status_code == 302
 
     def test_does_load(self):
