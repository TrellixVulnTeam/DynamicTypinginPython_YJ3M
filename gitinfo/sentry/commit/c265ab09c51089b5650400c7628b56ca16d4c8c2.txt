commit c265ab09c51089b5650400c7628b56ca16d4c8c2
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Thu Jan 18 10:58:20 2018 -0800

    fix(ui): Add pagination to Members List (#6988)
    
    * fix members pagination
    * add logic to asyncView to handle pagination more easily

diff --git a/src/sentry/static/sentry/app/components/asyncComponent.jsx b/src/sentry/static/sentry/app/components/asyncComponent.jsx
index 1a5fc7eed1..b42d8e4acc 100644
--- a/src/sentry/static/sentry/app/components/asyncComponent.jsx
+++ b/src/sentry/static/sentry/app/components/asyncComponent.jsx
@@ -76,16 +76,23 @@ class AsyncComponent extends React.Component {
 
     endpoints.forEach(([stateKey, endpoint, params, options]) => {
       options = options || {};
+      let locationQuery = (this.props.location && this.props.location.query) || {};
+      let paramsQuery = (params && params.query) || {};
+      // If paginate option then pass entire `query` object to API call
+      // It should only be expecting `query.cursor` for pagination
+      let query = options.paginate && {...locationQuery, ...paramsQuery};
+
       this.api.request(endpoint, {
         method: 'GET',
         ...params,
+        query,
         success: (data, _, jqXHR) => {
           this.setState(prevState => {
             return {
               [stateKey]: data,
+              [`${stateKey}PageLinks`]: jqXHR.getResponseHeader('Link'),
               remainingRequests: prevState.remainingRequests - 1,
               loading: prevState.remainingRequests > 1,
-              pageLinks: jqXHR.getResponseHeader('Link'),
             };
           });
         },
diff --git a/src/sentry/static/sentry/app/views/settings/organization/members/organizationMembersView.jsx b/src/sentry/static/sentry/app/views/settings/organization/members/organizationMembersView.jsx
index c39168b772..9a072013dd 100644
--- a/src/sentry/static/sentry/app/views/settings/organization/members/organizationMembersView.jsx
+++ b/src/sentry/static/sentry/app/views/settings/organization/members/organizationMembersView.jsx
@@ -10,6 +10,7 @@ import IndicatorStore from '../../../../stores/indicatorStore';
 import OrganizationAccessRequests from './organizationAccessRequests';
 import OrganizationMemberRow from './organizationMemberRow';
 import OrganizationSettingsView from '../../../organizationSettingsView';
+import Pagination from '../../../../components/pagination';
 import Panel from '../../components/panel';
 import PanelBody from '../../components/panelBody';
 import PanelHeader from '../../components/panelHeader';
@@ -40,7 +41,12 @@ class OrganizationMembersView extends OrganizationSettingsView {
 
   getEndpoints() {
     return [
-      ['members', `/organizations/${this.props.params.orgId}/members/`],
+      [
+        'members',
+        `/organizations/${this.props.params.orgId}/members/`,
+        {},
+        {paginate: true},
+      ],
       [
         'authProvider',
         `/organizations/${this.props.params.orgId}/auth-provider/`,
@@ -201,7 +207,7 @@ class OrganizationMembersView extends OrganizationSettingsView {
 
   renderBody() {
     let {params, routes} = this.props;
-    let {members, requestList} = this.state;
+    let {membersPageLinks, members, requestList} = this.state;
     let {organization} = this.context;
     let {orgId} = params || {};
     let {name: orgName, access} = organization;
@@ -284,6 +290,8 @@ class OrganizationMembersView extends OrganizationSettingsView {
             })}
           </PanelBody>
         </Panel>
+
+        <Pagination pageLinks={membersPageLinks} />
       </div>
     );
   }
diff --git a/tests/js/spec/views/__snapshots__/organizationMembersView.spec.jsx.snap b/tests/js/spec/views/__snapshots__/organizationMembersView.spec.jsx.snap
index 030fc4ab4b..88a4c19173 100644
--- a/tests/js/spec/views/__snapshots__/organizationMembersView.spec.jsx.snap
+++ b/tests/js/spec/views/__snapshots__/organizationMembersView.spec.jsx.snap
@@ -1147,6 +1147,9 @@ exports[`OrganizationMembersView No Require Link does not have 2fa warning if us
           </Styled(div)>
         </div>
       </Styled(div)>
+      <Pagination
+        onCursor={[Function]}
+      />
     </div>
   </DocumentTitle>
 </OrganizationMembersView>
@@ -2366,6 +2369,9 @@ exports[`OrganizationMembersView Require Link does not have 2fa warning if user
           </Styled(div)>
         </div>
       </Styled(div)>
+      <Pagination
+        onCursor={[Function]}
+      />
     </div>
   </DocumentTitle>
 </OrganizationMembersView>
