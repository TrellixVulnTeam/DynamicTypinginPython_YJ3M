commit 3ff4784d9ba5e484fd115ea176a89b119daee78e
Author: Jess MacQueen <macqueen@users.noreply.github.com>
Date:   Thu Dec 15 13:57:13 2016 -0800

    handle when ReleaseEnvironment has invalid project ids (#4679)

diff --git a/src/sentry/south_migrations/0283_populate_release_environment_and_release_file_organization.py b/src/sentry/south_migrations/0283_populate_release_environment_and_release_file_organization.py
index 270187ae3e..12d575d336 100644
--- a/src/sentry/south_migrations/0283_populate_release_environment_and_release_file_organization.py
+++ b/src/sentry/south_migrations/0283_populate_release_environment_and_release_file_organization.py
@@ -14,13 +14,19 @@ class Migration(DataMigration):
             organization_id__isnull=True
         )
         for re in RangeQuerySetWrapperWithProgressBar(release_environments):
-            orm.ReleaseEnvironment.objects.filter(
-                id=re.id
-            ).update(
-                organization_id=orm.Project.objects.filter(
+            try:
+                org_id = orm.Project.objects.filter(
                     id=re.project_id
                 ).values_list('organization_id', flat=True)[0]
-            )
+            except IndexError:
+                pass
+            else:
+                orm.ReleaseEnvironment.objects.filter(
+                    id=re.id
+                ).update(
+                    organization_id=org_id
+                )
+
 
         release_files = orm.ReleaseFile.objects.filter(
             organization__isnull=True
