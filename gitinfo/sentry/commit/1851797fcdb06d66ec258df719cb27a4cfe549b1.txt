commit 1851797fcdb06d66ec258df719cb27a4cfe549b1
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Mon Oct 21 16:01:16 2019 -0700

    feat(api): Change `isSuperuser` for UI to disregard "active" sâ€¦ (#15194)
    
    Note: This intentionally does not use the "active" superuser flag as
    the frontend should only ever use this flag as a hint that the user *can* be a superuser.
    The API will always need to check to see if the superuser state is active for the user.
    
    This is needed to support the case where you access a different org and get denied, but the UI
    can open the sudo dialog if you are an "inactive" superuser so that you can authenticate yourself.

diff --git a/src/sentry/web/client_config.py b/src/sentry/web/client_config.py
index 4a2abc38fa..6abe446972 100644
--- a/src/sentry/web/client_config.py
+++ b/src/sentry/web/client_config.py
@@ -169,7 +169,15 @@ def get_client_config(request=None):
         context.update(
             {"isAuthenticated": True, "user": serialize(user, user, DetailedUserSerializer())}
         )
-        context["user"]["isSuperuser"] = is_superuser
+
+        if request.user.is_superuser:
+            # Note: This intentionally does not use the "active" superuser flag as
+            # the frontend should only ever use this flag as a hint that the user can be a superuser
+            # the API will always need to check for active superuser.
+            #
+            # This is needed in the case where you access a different org and get denied, but the UI
+            # can open the sudo dialog if you are an "inactive" superuser
+            context["user"]["isSuperuser"] = request.user.is_superuser
     else:
         context.update({"isAuthenticated": False, "user": None})
 
