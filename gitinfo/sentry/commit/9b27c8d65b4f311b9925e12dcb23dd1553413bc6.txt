commit 9b27c8d65b4f311b9925e12dcb23dd1553413bc6
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Fri Nov 3 11:22:26 2017 -0700

    fix event_manager test

diff --git a/tests/sentry/test_event_manager.py b/tests/sentry/test_event_manager.py
index 616476cb82..7ea7f66541 100644
--- a/tests/sentry/test_event_manager.py
+++ b/tests/sentry/test_event_manager.py
@@ -77,14 +77,38 @@ class EventManagerTest(TransactionTestCase):
         should_sample.return_value = True
         event_id = 'a' * 32
 
-        manager = EventManager(self.make_event())
+        manager = EventManager(self.make_event(event_id=event_id))
+        event = manager.save(1)
+
+        # This is a brand new event, so it is actually saved.
+        # In this case, we don't need an EventMapping, but we
+        # do need the Event.
+        assert not EventMapping.objects.filter(
+            group_id=event.group_id,
+            event_id=event_id,
+        ).exists()
+
+        assert Event.objects.filter(
+            event_id=event_id,
+        ).exists()
+
+        event_id = 'b' * 32
+
+        manager = EventManager(self.make_event(event_id=event_id))
         event = manager.save(1)
 
+        # This second is a dupe, so should be sampled
+        # For a sample, we want to store the EventMapping,
+        # but don't need to store the Event
         assert EventMapping.objects.filter(
             group_id=event.group_id,
             event_id=event_id,
         ).exists()
 
+        assert not Event.objects.filter(
+            event_id=event_id,
+        ).exists()
+
     @patch('sentry.event_manager.should_sample')
     def test_sample_feature_flag(self, should_sample):
         should_sample.return_value = True
