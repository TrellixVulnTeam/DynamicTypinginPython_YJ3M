commit d2ed3ff9dc829f8670f57896a8d44a097953b84e
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Feb 17 02:43:08 2012 -0800

    Add ProjectCountByMinute to cleanup script

diff --git a/sentry/queue/tasks/cleanup.py b/sentry/queue/tasks/cleanup.py
index bcafb0f293..5712ddf66a 100644
--- a/sentry/queue/tasks/cleanup.py
+++ b/sentry/queue/tasks/cleanup.py
@@ -29,7 +29,7 @@ def cleanup(days=30, logger=None, site=None, server=None, level=None,
     import datetime
 
     from sentry.models import Group, Event, MessageCountByMinute, \
-      MessageFilterValue, FilterValue, SearchDocument
+      MessageFilterValue, FilterValue, SearchDocument, ProjectCountByMinute
     from sentry.utils.query import RangeQuerySetWrapper, SkinnyQuerySet
 
     def cleanup_groups(iterable):
@@ -97,6 +97,15 @@ def cleanup(days=30, logger=None, site=None, server=None, level=None,
 
         cleanup_groups(RangeQuerySetWrapper(qs))
 
+    # Project counts
+    qs = SkinnyQuerySet(ProjectCountByMinute).filter(date__lte=ts)
+    if project:
+        qs = qs.filter(project=project)
+
+    for obj in RangeQuerySetWrapper(qs):
+        print ">>> Removing <%s: id=%s>" % (obj.__class__.__name__, obj.pk)
+        obj.delete()
+
     # attempt to cleanup any groups that may now be empty
     groups_to_delete = []
     for group_id in groups_to_check:
