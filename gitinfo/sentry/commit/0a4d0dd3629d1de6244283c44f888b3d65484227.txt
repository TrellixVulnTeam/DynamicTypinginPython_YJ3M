commit 0a4d0dd3629d1de6244283c44f888b3d65484227
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 28 12:45:11 2015 -0600

    Handle superusers leaving teams on new installs

diff --git a/src/sentry/api/endpoints/organization_member_team_details.py b/src/sentry/api/endpoints/organization_member_team_details.py
index 4f2c036789..5658b978af 100644
--- a/src/sentry/api/endpoints/organization_member_team_details.py
+++ b/src/sentry/api/endpoints/organization_member_team_details.py
@@ -172,9 +172,15 @@ class OrganizationMemberTeamDetailsEndpoint(OrganizationEndpoint):
                 organizationmember=om,
             )
         except OrganizationMemberTeam.DoesNotExist:
-            # if the relationship doesnt exist, they're already a member
-            return Response(serialize(
-                team, request.user, TeamWithProjectsSerializer()), status=200)
+            # we need to create the row in order to handle superusers leaving a
+            # team which they were never a member for (therefor there was never
+            # a matching row)
+            omt = OrganizationMemberTeam(
+                team=team,
+                organizationmember=om,
+                # setting this to true ensures it gets saved below
+                is_active=True,
+            )
 
         if omt.is_active:
             omt.is_active = False
