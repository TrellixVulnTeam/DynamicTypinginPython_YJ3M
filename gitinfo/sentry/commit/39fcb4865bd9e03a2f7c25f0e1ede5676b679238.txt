commit 39fcb4865bd9e03a2f7c25f0e1ede5676b679238
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Mon Oct 12 19:24:36 2015 -0700

    Block CSP reports from 'about:blank'

diff --git a/src/sentry/web/api.py b/src/sentry/web/api.py
index 1f6b7463a6..c8359529ce 100644
--- a/src/sentry/web/api.py
+++ b/src/sentry/web/api.py
@@ -437,6 +437,11 @@ class CspReportView(StoreView):
             raise APIError('Missing csp-report')
 
         origin = report.get('document-uri')
+
+        # No idea, but this is garbage
+        if origin == 'about:blank':
+            raise APIForbidden('Invalid document-uri')
+
         if not is_valid_origin(origin, project):
             raise APIForbidden('Invalid document-uri')
 
diff --git a/tests/sentry/web/api/tests.py b/tests/sentry/web/api/tests.py
index b05ef60047..8456d3104b 100644
--- a/tests/sentry/web/api/tests.py
+++ b/tests/sentry/web/api/tests.py
@@ -44,6 +44,14 @@ class CspReportViewTest(TestCase):
         )
         assert resp.status_code == 403, resp.content
 
+        get_origins.return_value = ['*']
+        resp = self.client.post(self.path,
+            content_type='application/csp-report',
+            data='{"csp-report":{"document_uri":"about:blank"}}',
+            HTTP_USER_AGENT='awesome',
+        )
+        assert resp.status_code == 403, resp.content
+
     @mock.patch('sentry.web.api.is_valid_origin', mock.Mock(return_value=True))
     @mock.patch('sentry.web.api.CspReportView.process')
     def test_post_success(self, process):
