commit 4ea97d4419290916a74be7fb2978826b4f25b47e
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Apr 9 11:50:03 2015 -0400

    Improve identity logging

diff --git a/src/sentry/auth/providers/oauth2.py b/src/sentry/auth/providers/oauth2.py
index 1346404c91..0efb783ff7 100644
--- a/src/sentry/auth/providers/oauth2.py
+++ b/src/sentry/auth/providers/oauth2.py
@@ -175,7 +175,7 @@ class OAuth2Provider(Provider):
         refresh_token = auth_identity.data.get('refresh_token')
 
         if not refresh_token:
-            raise IdentityNotValid
+            raise IdentityNotValid('Missing refresh token')
 
         data = self.get_refresh_token_params(
             refresh_token=refresh_token,
diff --git a/src/sentry/tasks/check_auth.py b/src/sentry/tasks/check_auth.py
index 6f4577540b..2e33eeff56 100644
--- a/src/sentry/tasks/check_auth.py
+++ b/src/sentry/tasks/check_auth.py
@@ -60,6 +60,11 @@ def check_auth_identity(auth_identity_id, **kwargs):
     try:
         provider.refresh_identity(auth_identity)
     except IdentityNotValid:
+        logger.warning(
+            'AuthIdentity(id=%s) notified as not valid',
+            auth_identity_id,
+            exc_info=True,
+        )
         metrics.incr('auth.identities.invalidated', 1)
         is_linked = False
         is_valid = False
