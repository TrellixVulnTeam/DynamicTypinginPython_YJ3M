commit cfd2ee807ae329ebfda050689c57cbb0bc187e9a
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Wed Oct 26 10:44:23 2016 -0700

    templates: add {% system_origin %} tag to spit out simply the origin (#4410)
    
    This varies slightly from `{% absolute uri '' %}` in that it'd guarantee
    there is no path.

diff --git a/src/sentry/templatetags/sentry_helpers.py b/src/sentry/templatetags/sentry_helpers.py
index 3939008a1c..625d796793 100644
--- a/src/sentry/templatetags/sentry_helpers.py
+++ b/src/sentry/templatetags/sentry_helpers.py
@@ -37,7 +37,7 @@ from sentry.utils.javascript import to_json
 from sentry.utils.strings import soft_break as _soft_break
 from sentry.utils.strings import soft_hyphenate, to_unicode, truncatechars
 from six.moves import range
-from six.moves.urllib.parse import quote, urlencode
+from six.moves.urllib.parse import quote, urlencode, urlparse
 
 SentryVersion = namedtuple('SentryVersion', [
     'current', 'latest', 'update_available', 'build',
@@ -70,6 +70,13 @@ def absolute_uri(path='', *args):
     return absolute_uri(path.format(*args))
 
 
+@register.simple_tag
+def system_origin():
+    from sentry.utils.http import absolute_uri
+    url = urlparse(absolute_uri())
+    return '%s://%s' % (url.scheme, url.netloc)
+
+
 @register.filter
 def pprint(value, break_after=10):
     """
diff --git a/tests/sentry/templatetags/test_sentry_helpers.py b/tests/sentry/templatetags/test_sentry_helpers.py
new file mode 100644
index 0000000000..e4a6d7e2ed
--- /dev/null
+++ b/tests/sentry/templatetags/test_sentry_helpers.py
@@ -0,0 +1,12 @@
+from __future__ import absolute_import
+
+from django.template import Context, Template
+
+
+def test_system_origin():
+    result = Template("""
+        {% load sentry_helpers %}
+        {% system_origin %}
+    """).render(Context()).strip()
+
+    assert result == 'http://testserver'
