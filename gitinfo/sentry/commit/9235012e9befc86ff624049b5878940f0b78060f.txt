commit 9235012e9befc86ff624049b5878940f0b78060f
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Sep 28 11:25:09 2015 -0700

    Link comments to activity pane (fixes GH-1951)

diff --git a/src/sentry/models/activity.py b/src/sentry/models/activity.py
index 409cd9a2e3..01a313bed7 100644
--- a/src/sentry/models/activity.py
+++ b/src/sentry/models/activity.py
@@ -135,6 +135,7 @@ class Activity(Model):
 
         project = self.project
         org = self.project.organization
+        group = self.group
 
         if self.user:
             author = self.user.first_name or self.user.username
@@ -158,21 +159,25 @@ class Activity(Model):
         context = {
             'data': self.data,
             'author': author,
-            'project': self.project,
+            'project': project,
             'project_link': absolute_uri(reverse('sentry-stream', kwargs={
                 'organization_slug': org.slug,
                 'project_id': project.slug,
             })),
         }
 
-        if self.group:
+        if group:
+            group_link = absolute_uri('/{}/{}/group/{}/'.format(org.slug, project.slug, group.id))
+            activity_link = '{}activity/'.format(group_link)
+
             headers.update({
-                'X-Sentry-Reply-To': group_id_to_email(self.group.id),
+                'X-Sentry-Reply-To': group_id_to_email(group.id),
             })
 
             context.update({
-                'group': self.group,
-                'link': self.group.get_absolute_url(),
+                'group': group,
+                'link': group_link,
+                'activity_link': activity_link,
             })
 
         # TODO(dcramer): abstract each activity email into its own helper class
diff --git a/src/sentry/templates/sentry/emails/activity/note.html b/src/sentry/templates/sentry/emails/activity/note.html
index d34026e2c9..607c567b68 100644
--- a/src/sentry/templates/sentry/emails/activity/note.html
+++ b/src/sentry/templates/sentry/emails/activity/note.html
@@ -1,7 +1,7 @@
 {% extends "sentry/emails/base.html" %}
 
 {% block header %}
-  <a href="{{ link }}" class="btn">View on Sentry</a>
+  <a href="{{ activity_link }}" class="btn">View on Sentry</a>
   <h1>Sentry</h1>
 {% endblock %}
 
diff --git a/src/sentry/templates/sentry/emails/activity/note.txt b/src/sentry/templates/sentry/emails/activity/note.txt
index f2c3627822..c8f44ef735 100644
--- a/src/sentry/templates/sentry/emails/activity/note.txt
+++ b/src/sentry/templates/sentry/emails/activity/note.txt
@@ -10,7 +10,7 @@ Details
 
 {{ group.title }}
 
-{{ link }}
+{{ activity_link }}
 
 {% endautoescape %}
 {% endspaceless %}
