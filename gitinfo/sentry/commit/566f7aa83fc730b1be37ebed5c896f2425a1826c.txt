commit 566f7aa83fc730b1be37ebed5c896f2425a1826c
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Oct 9 16:31:30 2015 -0700

    Bind ASSET_VERSION at runtime

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 0e7aeb4e1c..b6deef9ef8 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -260,17 +260,7 @@ STATICFILES_FINDERS = (
     "django.contrib.staticfiles.finders.AppDirectoriesFinder",
 )
 
-
-def get_asset_version():
-    path = os.path.join(STATIC_ROOT, 'version')
-    try:
-        with open(path) as fp:
-            return fp.read().strip()
-    except IOError:
-        from time import time
-        return int(time())
-
-ASSET_VERSION = get_asset_version()
+ASSET_VERSION = 0
 
 # setup a default media root to somewhere useless
 MEDIA_ROOT = '/tmp/sentry-media'
diff --git a/src/sentry/utils/runner.py b/src/sentry/utils/runner.py
index a741b79683..f1889c7040 100644
--- a/src/sentry/utils/runner.py
+++ b/src/sentry/utils/runner.py
@@ -289,6 +289,16 @@ def initialize_gevent():
         make_psycopg_green()
 
 
+def get_asset_version(settings):
+    path = os.path.join(settings.STATIC_ROOT, 'version')
+    try:
+        with open(path) as fp:
+            return fp.read().strip()
+    except IOError:
+        from time import time
+        return int(time())
+
+
 def initialize_app(config, skip_backend_validation=False):
     settings = config['settings']
 
@@ -313,6 +323,8 @@ def initialize_app(config, skip_backend_validation=False):
 
     settings.CACHES['default']['VERSION'] = settings.CACHE_VERSION
 
+    settings.ASSET_VERSION = get_asset_version(settings)
+
     if USE_GEVENT:
         from django.db import connections
         connections['default'].allow_thread_sharing = True
