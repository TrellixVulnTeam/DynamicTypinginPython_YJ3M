commit 8e504156babad0756927491b8c6a79f613f630fb
Author: Brett Hoerner <brett@bretthoerner.com>
Date:   Fri Sep 8 13:56:55 2017 -0500

    test: Verify GroupTagKey, GroupTagValue and TagValue are deleted in câ€¦ (#6068)

diff --git a/tests/fixtures/cleanup.json b/tests/fixtures/cleanup.json
index 50ef80c37e..f6cb048af4 100644
--- a/tests/fixtures/cleanup.json
+++ b/tests/fixtures/cleanup.json
@@ -168,5 +168,41 @@
     },
     "model": "sentry.event",
     "pk": 18
+  },
+  {
+    "fields": {
+      "project_id": 1,
+      "group_id": 2,
+      "key": "key",
+      "values_seen": 1
+    },
+    "model": "sentry.grouptagkey",
+    "pk": 19
+  },
+  {
+    "fields": {
+      "project_id": 1,
+      "group_id": 2,
+      "times_seen": 1,
+      "key": "key",
+      "value": "value",
+      "last_seen": "2010-08-31 17:54:24Z",
+      "first_seen": "2010-08-31 17:54:24Z"
+    },
+    "model": "sentry.grouptagvalue",
+    "pk": 20
+  },
+  {
+    "fields": {
+      "project_id": 1,
+      "key": "key",
+      "value": "value",
+      "data": null,
+      "times_seen": 1,
+      "last_seen": "2010-08-31 17:54:24Z",
+      "first_seen": "2010-08-31 17:54:24Z"
+    },
+    "model": "sentry.tagvalue",
+    "pk": 21
   }
 ]
diff --git a/tests/sentry/runner/commands/test_cleanup.py b/tests/sentry/runner/commands/test_cleanup.py
index 9085c58d13..78a08d1a26 100644
--- a/tests/sentry/runner/commands/test_cleanup.py
+++ b/tests/sentry/runner/commands/test_cleanup.py
@@ -2,11 +2,11 @@
 
 from __future__ import absolute_import
 
-from sentry.models import Event, Group, GroupTagValue, TagValue, TagKey
+from sentry.models import Event, Group, GroupTagKey, GroupTagValue, TagValue
 from sentry.runner.commands.cleanup import cleanup
 from sentry.testutils import CliTestCase
 
-ALL_MODELS = (Event, Group, GroupTagValue, TagValue, TagKey)
+ALL_MODELS = (Event, Group, GroupTagKey, GroupTagValue, TagValue)
 
 
 class SentryCleanupTest(CliTestCase):
@@ -23,7 +23,9 @@ class SentryCleanupTest(CliTestCase):
     def test_project(self):
         orig_counts = {}
         for model in ALL_MODELS:
-            orig_counts[model] = model.objects.count()
+            count = model.objects.count()
+            assert count > 0
+            orig_counts[model] = count
 
         rv = self.invoke('--days=1', '--project=2')
         assert rv.exit_code == 0, rv.output
