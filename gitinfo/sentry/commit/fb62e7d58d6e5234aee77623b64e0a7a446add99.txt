commit fb62e7d58d6e5234aee77623b64e0a7a446add99
Author: Alex Hofsteede <alex@hofsteede.com>
Date:   Thu Sep 13 14:45:31 2018 -0700

    fix(snuba): Use AND for event search tag conditions. (#9762)

diff --git a/src/sentry/tagstore/snuba/backend.py b/src/sentry/tagstore/snuba/backend.py
index 04465734b9..5df8357546 100644
--- a/src/sentry/tagstore/snuba/backend.py
+++ b/src/sentry/tagstore/snuba/backend.py
@@ -520,7 +520,7 @@ class SnubaTagStorage(TagStorage):
             'issue': [group_id],
         }
 
-        conditions = [[[u'tags[{}]'.format(k), '=', v] for (k, v) in tags.items()]]
+        conditions = [[u'tags[{}]'.format(k), '=', v] for (k, v) in tags.items()]
 
         result = snuba.raw_query(start, end, selected_columns=['event_id'],
                                  conditions=conditions, orderby='-timestamp', filter_keys=filters,
diff --git a/tests/snuba/tagstore/test_tagstore_backend.py b/tests/snuba/tagstore/test_tagstore_backend.py
index cfcf531a37..3e1457cb3d 100644
--- a/tests/snuba/tagstore/test_tagstore_backend.py
+++ b/tests/snuba/tagstore/test_tagstore_backend.py
@@ -304,10 +304,10 @@ class TagStorageTest(SnubaTestCase):
             self.proj1group1.id,
             self.proj1env1.id,
             {
-                'foo': 'bar',  # OR
-                'release': '200'
+                'foo': 'bar',  # AND
+                'sentry:release': '200'
             }
-        ) == {'event_id__in': set(["1" * 32, "2" * 32])}
+        ) == {'event_id__in': set(["2" * 32])}
 
         assert self.ts.get_group_event_filter(
             self.proj1.id,
