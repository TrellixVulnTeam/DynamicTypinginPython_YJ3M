commit d8432c7064391071d5741cfd0df45fd49ebe994a
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Tue Jan 30 15:18:23 2018 -0800

    test: Add a snapshot test for release stats

diff --git a/src/sentry/static/sentry/app/components/group/releaseStats.jsx b/src/sentry/static/sentry/app/components/group/releaseStats.jsx
index 5a7bd36e05..66860aff30 100644
--- a/src/sentry/static/sentry/app/components/group/releaseStats.jsx
+++ b/src/sentry/static/sentry/app/components/group/releaseStats.jsx
@@ -24,6 +24,11 @@ const GroupReleaseStats = createReactClass({
 
   propTypes: {
     group: PropTypes.object,
+    location: PropTypes.object,
+  },
+
+  contextTypes: {
+    organization: PropTypes.object,
   },
 
   mixins: [
@@ -186,9 +191,7 @@ const GroupReleaseStats = createReactClass({
 
   render() {
     let group = this.props.group;
-    let environment = this.state.environment;
-    let data = this.state.data;
-    let hasEnvironmentsFeature = this.state.hasEnvironmentsFeature;
+    let {environment, data, hasEnvironmentsFeature} = this.state;
 
     let envList = this.state.envList;
 
diff --git a/tests/js/setup.js b/tests/js/setup.js
index 819de9cf22..d45c9a4a1d 100644
--- a/tests/js/setup.js
+++ b/tests/js/setup.js
@@ -185,6 +185,16 @@ window.TestStubs = {
     };
   },
 
+  Group: () => {
+    return {
+      id: '1',
+      stats: {
+        '24h': [[1517281200, 2], [1517310000, 1]],
+        '30d': [[1514764800, 1], [1515024000, 122]],
+      },
+    };
+  },
+
   Integration: params => {
     return {
       id: '4',
diff --git a/tests/js/spec/components/group/__snapshots__/releaseStats.spec.jsx.snap b/tests/js/spec/components/group/__snapshots__/releaseStats.spec.jsx.snap
new file mode 100644
index 0000000000..5b13e3cf9a
--- /dev/null
+++ b/tests/js/spec/components/group/__snapshots__/releaseStats.spec.jsx.snap
@@ -0,0 +1,691 @@
+// Jest Snapshot v1, https://goo.gl/fbAQLP
+
+exports[`GroupReleaseStats renders 1`] = `
+<GroupReleaseStats
+  group={
+    Object {
+      "id": "1",
+      "stats": Object {
+        "24h": Array [
+          Array [
+            1517281200,
+            2,
+          ],
+          Array [
+            1517310000,
+            1,
+          ],
+        ],
+        "30d": Array [
+          Array [
+            1514764800,
+            1,
+          ],
+          Array [
+            1515024000,
+            122,
+          ],
+        ],
+      },
+    }
+  }
+  location={
+    Object {
+      "pathame": "/mock-pathname/",
+      "query": Object {},
+    }
+  }
+>
+  <div
+    className="env-stats"
+  >
+    <h6>
+      <span>
+        <DropdownLink
+          alwaysRenderMenu={true}
+          anchorRight={false}
+          caret={true}
+          disabled={false}
+          title="All Environments"
+        >
+          <DropdownMenu
+            keepMenuOpen={false}
+          >
+            <span
+              className="dropdown"
+            >
+              <a
+                className="dropdown-actor dropdown-toggle"
+                onClick={[Function]}
+                onMouseEnter={[Function]}
+                onMouseLeave={[Function]}
+              >
+                <div
+                  className="dropdown-actor-title"
+                >
+                  <span>
+                    All Environments
+                  </span>
+                  <i
+                    className="icon-arrow-down"
+                  />
+                </div>
+              </a>
+              <ul
+                className="dropdown-menu"
+                onClick={[Function]}
+                onMouseLeave={[Function]}
+              >
+                <MenuItem
+                  isActive={true}
+                  onClick={[Function]}
+                >
+                  <li
+                    className="active"
+                    href={null}
+                    onClick={[Function]}
+                    role="presentation"
+                    title={null}
+                  >
+                    <a
+                      onClick={[Function]}
+                      tabIndex="-1"
+                    >
+                      All Environments
+                    </a>
+                  </li>
+                </MenuItem>
+              </ul>
+            </span>
+          </DropdownMenu>
+        </DropdownLink>
+      </span>
+    </h6>
+    <div
+      className="env-content"
+    >
+      <div>
+        <GroupReleaseChart
+          environment="All Environments"
+          environmentStats={
+            Object {
+              "24h": Array [
+                Array [
+                  1517281200,
+                  2,
+                ],
+                Array [
+                  1517310000,
+                  1,
+                ],
+              ],
+              "30d": Array [
+                Array [
+                  1514764800,
+                  1,
+                ],
+                Array [
+                  1515024000,
+                  122,
+                ],
+              ],
+            }
+          }
+          group={
+            Object {
+              "id": "1",
+              "stats": Object {
+                "24h": Array [
+                  Array [
+                    1517281200,
+                    2,
+                  ],
+                  Array [
+                    1517310000,
+                    1,
+                  ],
+                ],
+                "30d": Array [
+                  Array [
+                    1514764800,
+                    1,
+                  ],
+                  Array [
+                    1515024000,
+                    122,
+                  ],
+                ],
+              },
+            }
+          }
+          release={null}
+          releaseStats={null}
+          statsPeriod="24h"
+          title="Last 24 Hours"
+        >
+          <div
+            className="bar-chart group-chart "
+          >
+            <h6>
+              <span>
+                Last 24 Hours
+              </span>
+            </h6>
+            <StackedBarChart
+              barClasses={
+                Array [
+                  "release",
+                  "environment",
+                  "inactive",
+                ]
+              }
+              className="sparkline"
+              height={40}
+              label="events"
+              markers={Array []}
+              placement="bottom"
+              points={
+                Array [
+                  Object {
+                    "x": 1517281200,
+                    "y": Array [
+                      0,
+                      2,
+                      0,
+                    ],
+                  },
+                  Object {
+                    "x": 1517310000,
+                    "y": Array [
+                      0,
+                      1,
+                      0,
+                    ],
+                  },
+                ]
+              }
+              series={Array []}
+              tooltip={[Function]}
+              width={null}
+            >
+              <figure
+                className="sparkline barchart"
+                style={
+                  Object {
+                    "height": 40,
+                    "width": null,
+                  }
+                }
+              >
+                <span
+                  className="max-y"
+                >
+                  <count
+                    value={10}
+                  >
+                    <span>
+                      10
+                    </span>
+                  </count>
+                </span>
+                <span
+                  className="min-y"
+                >
+                  0
+                </span>
+                <span>
+                  <a
+                    className="chart-column tip"
+                    data-point-index={1517281200}
+                    key="1517281200"
+                    style={
+                      Object {
+                        "height": "100%",
+                        "width": "50%",
+                      }
+                    }
+                  >
+                    <span
+                      className="release"
+                      key="0"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "0%",
+                          "height": "0%",
+                        }
+                      }
+                    >
+                      0
+                    </span>
+                    <span
+                      className="environment"
+                      key="1"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "0%",
+                          "height": "19.8%",
+                        }
+                      }
+                    >
+                      2
+                    </span>
+                    <span
+                      className="inactive"
+                      key="2"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "19.8%",
+                          "height": "0%",
+                        }
+                      }
+                    >
+                      0
+                    </span>
+                  </a>
+                  <a
+                    className="chart-column tip"
+                    data-point-index={1517310000}
+                    key="1517310000"
+                    style={
+                      Object {
+                        "height": "100%",
+                        "width": "50%",
+                      }
+                    }
+                  >
+                    <span
+                      className="release"
+                      key="0"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "0%",
+                          "height": "0%",
+                        }
+                      }
+                    >
+                      0
+                    </span>
+                    <span
+                      className="environment"
+                      key="1"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "0%",
+                          "height": "9.9%",
+                        }
+                      }
+                    >
+                      1
+                    </span>
+                    <span
+                      className="inactive"
+                      key="2"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "9.9%",
+                          "height": "0%",
+                        }
+                      }
+                    >
+                      0
+                    </span>
+                  </a>
+                </span>
+              </figure>
+            </StackedBarChart>
+          </div>
+        </GroupReleaseChart>
+        <GroupReleaseChart
+          className="bar-chart-small"
+          environment="All Environments"
+          environmentStats={
+            Object {
+              "24h": Array [
+                Array [
+                  1517281200,
+                  2,
+                ],
+                Array [
+                  1517310000,
+                  1,
+                ],
+              ],
+              "30d": Array [
+                Array [
+                  1514764800,
+                  1,
+                ],
+                Array [
+                  1515024000,
+                  122,
+                ],
+              ],
+            }
+          }
+          group={
+            Object {
+              "id": "1",
+              "stats": Object {
+                "24h": Array [
+                  Array [
+                    1517281200,
+                    2,
+                  ],
+                  Array [
+                    1517310000,
+                    1,
+                  ],
+                ],
+                "30d": Array [
+                  Array [
+                    1514764800,
+                    1,
+                  ],
+                  Array [
+                    1515024000,
+                    122,
+                  ],
+                ],
+              },
+            }
+          }
+          release={null}
+          releaseStats={null}
+          statsPeriod="30d"
+          title="Last 30 Days"
+        >
+          <div
+            className="bar-chart group-chart bar-chart-small"
+          >
+            <h6>
+              <span>
+                Last 30 Days
+              </span>
+            </h6>
+            <StackedBarChart
+              barClasses={
+                Array [
+                  "release",
+                  "environment",
+                  "inactive",
+                ]
+              }
+              className="sparkline"
+              height={40}
+              label="events"
+              markers={Array []}
+              placement="bottom"
+              points={
+                Array [
+                  Object {
+                    "x": 1514764800,
+                    "y": Array [
+                      0,
+                      1,
+                      0,
+                    ],
+                  },
+                  Object {
+                    "x": 1515024000,
+                    "y": Array [
+                      0,
+                      122,
+                      0,
+                    ],
+                  },
+                ]
+              }
+              series={Array []}
+              tooltip={[Function]}
+              width={null}
+            >
+              <figure
+                className="sparkline barchart"
+                style={
+                  Object {
+                    "height": 40,
+                    "width": null,
+                  }
+                }
+              >
+                <span
+                  className="max-y"
+                >
+                  <count
+                    value={122}
+                  >
+                    <span>
+                      122
+                    </span>
+                  </count>
+                </span>
+                <span
+                  className="min-y"
+                >
+                  0
+                </span>
+                <span>
+                  <a
+                    className="chart-column tip"
+                    data-point-index={1514764800}
+                    key="1514764800"
+                    style={
+                      Object {
+                        "height": "100%",
+                        "width": "50%",
+                      }
+                    }
+                  >
+                    <span
+                      className="release"
+                      key="0"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "0%",
+                          "height": "0%",
+                        }
+                      }
+                    >
+                      0
+                    </span>
+                    <span
+                      className="environment"
+                      key="1"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "0%",
+                          "height": "0.81%",
+                        }
+                      }
+                    >
+                      1
+                    </span>
+                    <span
+                      className="inactive"
+                      key="2"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "0.81%",
+                          "height": "0%",
+                        }
+                      }
+                    >
+                      0
+                    </span>
+                  </a>
+                  <a
+                    className="chart-column tip"
+                    data-point-index={1515024000}
+                    key="1515024000"
+                    style={
+                      Object {
+                        "height": "100%",
+                        "width": "50%",
+                      }
+                    }
+                  >
+                    <span
+                      className="release"
+                      key="0"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "0%",
+                          "height": "0%",
+                        }
+                      }
+                    >
+                      0
+                    </span>
+                    <span
+                      className="environment"
+                      key="1"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "0%",
+                          "height": "99%",
+                        }
+                      }
+                    >
+                      122
+                    </span>
+                    <span
+                      className="inactive"
+                      key="2"
+                      style={
+                        Object {
+                          "backgroundColor": null,
+                          "bottom": "99%",
+                          "height": "0%",
+                        }
+                      }
+                    >
+                      0
+                    </span>
+                  </a>
+                </span>
+              </figure>
+            </StackedBarChart>
+          </div>
+        </GroupReleaseChart>
+        <h6>
+          <span>
+            First seen
+          </span>
+        </h6>
+        <SeenInfo
+          environment={null}
+          hasRelease={false}
+          orgId="org-slug"
+          projectId="project-slug"
+          release={null}
+          title="First seen"
+        >
+          <dl
+            className="seen-info"
+          >
+            <dt
+              key="0"
+            >
+              When
+              :
+            </dt>
+            <dd
+              key="1"
+            >
+              n/a
+            </dd>
+            <dt
+              key="4"
+            >
+              Release
+              :
+            </dt>
+            <dd
+              key="5"
+            >
+              <small
+                style={
+                  Object {
+                    "fontStyle": "italic",
+                    "marginLeft": 5,
+                  }
+                }
+              >
+                <a
+                  href="/org-slug/project-slug/settings/release-tracking/"
+                >
+                  not configured
+                </a>
+              </small>
+            </dd>
+          </dl>
+        </SeenInfo>
+        <h6>
+          <span>
+            Last seen
+          </span>
+        </h6>
+        <SeenInfo
+          environment={null}
+          hasRelease={false}
+          orgId="org-slug"
+          projectId="project-slug"
+          release={null}
+          title="Last seen"
+        >
+          <dl
+            className="seen-info"
+          >
+            <dt
+              key="0"
+            >
+              When
+              :
+            </dt>
+            <dd
+              key="1"
+            >
+              n/a
+            </dd>
+            <dt
+              key="4"
+            >
+              Release
+              :
+            </dt>
+            <dd
+              key="5"
+            >
+              <small
+                style={
+                  Object {
+                    "fontStyle": "italic",
+                    "marginLeft": 5,
+                  }
+                }
+              >
+                <a
+                  href="/org-slug/project-slug/settings/release-tracking/"
+                >
+                  not configured
+                </a>
+              </small>
+            </dd>
+          </dl>
+        </SeenInfo>
+      </div>
+    </div>
+  </div>
+</GroupReleaseStats>
+`;
diff --git a/tests/js/spec/components/group/releaseStats.spec.jsx b/tests/js/spec/components/group/releaseStats.spec.jsx
new file mode 100644
index 0000000000..aae3560745
--- /dev/null
+++ b/tests/js/spec/components/group/releaseStats.spec.jsx
@@ -0,0 +1,25 @@
+import React from 'react';
+import {mount} from 'enzyme';
+
+import GroupReleaseStats from 'app/components/group/releaseStats';
+
+describe('GroupReleaseStats', function() {
+  let component;
+  beforeEach(function() {
+    component = mount(
+      <GroupReleaseStats group={TestStubs.Group()} location={TestStubs.location()} />,
+      {
+        context: {
+          organization: TestStubs.Organization(),
+          project: TestStubs.Project(),
+          team: TestStubs.Team(),
+          group: TestStubs.Group(),
+        },
+      }
+    );
+  });
+
+  it('renders', function() {
+    expect(component).toMatchSnapshot();
+  });
+});
