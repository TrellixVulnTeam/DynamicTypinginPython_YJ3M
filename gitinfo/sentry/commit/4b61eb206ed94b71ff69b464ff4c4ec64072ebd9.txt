commit 4b61eb206ed94b71ff69b464ff4c4ec64072ebd9
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Fri Oct 23 14:38:45 2015 -0700

    Make sure we collapse headers that are a list into strings

diff --git a/src/sentry/interfaces/http.py b/src/sentry/interfaces/http.py
index d668782b35..d237cf50bc 100644
--- a/src/sentry/interfaces/http.py
+++ b/src/sentry/interfaces/http.py
@@ -32,6 +32,13 @@ def format_headers(value):
     result = []
     cookie_header = None
     for k, v in value:
+        # If a header value is a list of header,
+        # we want to normalize this into a comma separated list
+        # This is how most other libraries handle this.
+        # See: urllib3._collections:HTTPHeaderDict.itermerged
+        if isinstance(v, list):
+            v = ', '.join(v)
+
         if k.lower() == 'cookie':
             cookie_header = v
         else:
diff --git a/tests/sentry/interfaces/test_http.py b/tests/sentry/interfaces/test_http.py
index e3bb1c84dc..b183142b7f 100644
--- a/tests/sentry/interfaces/test_http.py
+++ b/tests/sentry/interfaces/test_http.py
@@ -115,3 +115,10 @@ class HttpTest(TestCase):
         ))
         assert result.url == 'http://example.com'
         assert result.full_url == 'http://example.com?foo=bar#fragment'
+
+    def test_header_value_list(self):
+        result = Http.to_python(dict(
+            url='http://example.com',
+            headers={'Foo': ['1', '2']},
+        ))
+        assert result.headers == [('Foo', '1, 2')]
