commit cf7e72f6cecd67cd35c1a9d561970b2e2fa17b11
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Aug 31 14:44:29 2015 -0700

    Fix stacktrace slimming

diff --git a/src/sentry/interfaces/stacktrace.py b/src/sentry/interfaces/stacktrace.py
index e4dc0f2324..5b2e4cf758 100644
--- a/src/sentry/interfaces/stacktrace.py
+++ b/src/sentry/interfaces/stacktrace.py
@@ -114,10 +114,11 @@ def remove_filename_outliers(filename):
     return _filename_version_re.sub('<version>/', filename)
 
 
-def slim_frame_data(stacktrace, frame_allowance=settings.SENTRY_MAX_STACKTRACE_FRAMES):
+def slim_frame_data(stacktrace,
+                    frame_allowance=settings.SENTRY_MAX_STACKTRACE_FRAMES):
     """
     Removes various excess metadata from middle frames which go beyond
-    ``max_frames``.
+    ``frame_allowance``.
     """
     frames = stacktrace['frames']
     frames_len = len(frames)
@@ -129,9 +130,9 @@ def slim_frame_data(stacktrace, frame_allowance=settings.SENTRY_MAX_STACKTRACE_F
 
     for n in xrange(half_max, frames_len - half_max):
         # remove heavy components
-        frames[half_max].pop('vars', None)
-        frames[half_max].pop('pre_context', None)
-        frames[half_max].pop('post_context', None)
+        frames[n].pop('vars', None)
+        frames[n].pop('pre_context', None)
+        frames[n].pop('post_context', None)
 
 
 def validate_bool(value, required=True):
