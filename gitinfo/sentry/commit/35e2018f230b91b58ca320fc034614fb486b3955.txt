commit 35e2018f230b91b58ca320fc034614fb486b3955
Author: Chris Clark <christopherchristopherclark@gmail.com>
Date:   Mon Feb 4 12:30:33 2019 -0800

    feat(global-header): clear time period button (#11853)

diff --git a/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx b/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx
index 7f28ea5e7b..c86277fc9d 100644
--- a/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx
@@ -143,6 +143,18 @@ class TimeRangeSelector extends React.PureComponent {
     this.handleUpdate(newDateTime);
   };
 
+  handleClear = () => {
+    const {onChange} = this.props;
+    const newDateTime = {
+      relative: DEFAULT_STATS_PERIOD,
+      start: null,
+      end: null,
+      utc: this.state.utc,
+    };
+    callIfFunction(onChange, newDateTime);
+    this.handleUpdate(newDateTime);
+  };
+
   handleSelectDateRange = ({start, end}) => {
     const {onChange} = this.props;
 
@@ -209,9 +221,10 @@ class TimeRangeSelector extends React.PureComponent {
             <StyledHeaderItem
               icon={<StyledInlineSvg src="icon-calendar" />}
               isOpen={isOpen}
-              hasSelected={true}
+              hasSelected={this.props.relative !== DEFAULT_STATS_PERIOD}
               hasChanges={this.state.hasChanges}
-              allowClear={false}
+              onClear={this.handleClear}
+              allowClear={true}
               onSubmit={this.handleCloseMenu}
               {...getActorProps({isStyled: true})}
             >
diff --git a/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap b/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
index 06e11b9cb4..2fb9dad230 100644
--- a/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
+++ b/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
@@ -1421,9 +1421,9 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                   className="css-1lz3nth-TimeRangeRoot e1u8612l0"
                                 >
                                   <StyledHeaderItem
-                                    allowClear={false}
+                                    allowClear={true}
                                     hasChanges={false}
-                                    hasSelected={true}
+                                    hasSelected={false}
                                     icon={
                                       <StyledInlineSvg
                                         src="icon-calendar"
@@ -1431,6 +1431,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                     }
                                     innerRef={[Function]}
                                     isOpen={false}
+                                    onClear={[Function]}
                                     onClick={[Function]}
                                     onKeyDown={[Function]}
                                     onMouseEnter={[Function]}
@@ -1444,16 +1445,17 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                     tabIndex={-1}
                                   >
                                     <ForwardRef
-                                      allowClear={false}
+                                      allowClear={true}
                                       className="css-22y332-StyledHeaderItem e1u8612l1"
                                       hasChanges={false}
-                                      hasSelected={true}
+                                      hasSelected={false}
                                       icon={
                                         <StyledInlineSvg
                                           src="icon-calendar"
                                         />
                                       }
                                       isOpen={false}
+                                      onClear={[Function]}
                                       onClick={[Function]}
                                       onKeyDown={[Function]}
                                       onMouseEnter={[Function]}
@@ -1467,10 +1469,10 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                       tabIndex={-1}
                                     >
                                       <HeaderItem
-                                        allowClear={false}
+                                        allowClear={true}
                                         className="css-22y332-StyledHeaderItem e1u8612l1"
                                         hasChanges={false}
-                                        hasSelected={true}
+                                        hasSelected={false}
                                         icon={
                                           <StyledInlineSvg
                                             src="icon-calendar"
@@ -1478,6 +1480,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                         }
                                         innerRef={[Function]}
                                         isOpen={false}
+                                        onClear={[Function]}
                                         onClick={[Function]}
                                         onKeyDown={[Function]}
                                         onMouseEnter={[Function]}
@@ -1492,7 +1495,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                       >
                                         <StyledHeaderItem
                                           className="css-22y332-StyledHeaderItem e1u8612l1"
-                                          hasSelected={true}
+                                          hasSelected={false}
                                           innerRef={[Function]}
                                           isOpen={false}
                                           onClick={[Function]}
@@ -1507,7 +1510,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                           tabIndex={-1}
                                         >
                                           <div
-                                            className="e1u8612l1 css-xvcre7-StyledHeaderItem-StyledHeaderItem enk2k7v0"
+                                            className="e1u8612l1 css-1v6igws-StyledHeaderItem-StyledHeaderItem enk2k7v0"
                                             onClick={[Function]}
                                             onKeyDown={[Function]}
                                             onMouseEnter={[Function]}
@@ -1520,10 +1523,10 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                             tabIndex={-1}
                                           >
                                             <IconContainer
-                                              hasSelected={true}
+                                              hasSelected={false}
                                             >
                                               <span
-                                                className="css-mzutvw-IconContainer enk2k7v2"
+                                                className="css-1af7peg-IconContainer enk2k7v2"
                                               >
                                                 <StyledInlineSvg
                                                   src="icon-calendar"
