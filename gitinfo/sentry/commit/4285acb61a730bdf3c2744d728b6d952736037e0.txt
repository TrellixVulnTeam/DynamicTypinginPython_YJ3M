commit 4285acb61a730bdf3c2744d728b6d952736037e0
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Aug 5 18:05:30 2014 -0700

    Ensure key context is a store key

diff --git a/src/sentry/web/frontend/docs.py b/src/sentry/web/frontend/docs.py
index 606fb36c84..99add1b615 100644
--- a/src/sentry/web/frontend/docs.py
+++ b/src/sentry/web/frontend/docs.py
@@ -17,15 +17,13 @@ from sentry.web.helpers import render_to_response, render_to_string, get_raven_j
 
 def get_key_context(user, project):
     try:
-        key = ProjectKey.objects.get(user=user, project=project)
-    except ProjectKey.DoesNotExist:
-        try:
-            key = ProjectKey.objects.filter(
-                project=project,
-                user__isnull=True,
-            )[0]
-        except IndexError:
-            key = None
+        key = ProjectKey.objects.filter(
+            project=project,
+            user__isnull=True,
+            roles=ProjectKey.roles.store,
+        )[0]
+    except IndexError:
+        key = None
 
     if key is None:
         dsn = 'SENTRY_DSN'
