commit 62d03d6de4e946e1451dcc7ccde8653d00dbe5b3
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Fri Jan 4 15:44:22 2019 -0800

    fix(ui): Fix Global Selection Header invalid dates (#11376)
    
    Will followup with tests

diff --git a/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/globalSelectionHeader.jsx b/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/globalSelectionHeader.jsx
index f797bfe406..9be9de5e11 100644
--- a/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/globalSelectionHeader.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/globalSelectionHeader.jsx
@@ -90,7 +90,7 @@ class GlobalSelectionHeader extends React.Component {
 
     if (defined(project) && Array.isArray(project)) {
       project = project.map(p => parseInt(p, 10));
-    } else {
+    } else if (defined(project)) {
       const projectIdInt = parseInt(project, 10);
       project = isNaN(projectIdInt) ? [] : [projectIdInt];
     }
@@ -134,8 +134,10 @@ class GlobalSelectionHeader extends React.Component {
 
       // This will update store with values from URL parameters
       updateDateTime({start, end, period, utc});
-      updateEnvironments(environment);
-      updateProjects(project);
+
+      // environment/project here can be null i.e. if only period is set in url params
+      updateEnvironments(environment || []);
+      updateProjects(project || []);
     } else {
       // Otherwise, we can update URL with values from store
       //
diff --git a/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap b/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
index d51d751a4d..a317a50d02 100644
--- a/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
+++ b/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
@@ -268,7 +268,27 @@ exports[`OrganizationUserFeedback renders 1`] = `
                   "location": Object {
                     "query": Object {},
                   },
-                  "push": [MockFunction],
+                  "push": [MockFunction] {
+                    "calls": Array [
+                      Array [
+                        Object {
+                          "pathname": undefined,
+                          "query": Object {
+                            "environment": Array [],
+                            "project": Array [],
+                            "statsPeriod": "14d",
+                            "utc": "true",
+                          },
+                        },
+                      ],
+                    ],
+                    "results": Array [
+                      Object {
+                        "isThrow": false,
+                        "value": undefined,
+                      },
+                    ],
+                  },
                   "replace": [MockFunction],
                   "setRouteLeaveHook": [MockFunction],
                 }
@@ -377,7 +397,27 @@ exports[`OrganizationUserFeedback renders 1`] = `
                     "location": Object {
                       "query": Object {},
                     },
-                    "push": [MockFunction],
+                    "push": [MockFunction] {
+                      "calls": Array [
+                        Array [
+                          Object {
+                            "pathname": undefined,
+                            "query": Object {
+                              "environment": Array [],
+                              "project": Array [],
+                              "statsPeriod": "14d",
+                              "utc": "true",
+                            },
+                          },
+                        ],
+                      ],
+                      "results": Array [
+                        Object {
+                          "isThrow": false,
+                          "value": undefined,
+                        },
+                      ],
+                    },
                     "replace": [MockFunction],
                     "setRouteLeaveHook": [MockFunction],
                   }
