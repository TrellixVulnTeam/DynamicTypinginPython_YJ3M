commit 075b53d92c728c2af6e76e844a505d44fbc8b3e1
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Tue Jan 22 14:56:12 2019 -0800

    feat(releases): Display release landing page (#11600)
    
    Display release landing page when there are no results and default
    filters are selected.

diff --git a/src/sentry/static/sentry/app/views/releases/list/organizationReleases/index.jsx b/src/sentry/static/sentry/app/views/releases/list/organizationReleases/index.jsx
index 2120d39ce1..2e224c4e74 100644
--- a/src/sentry/static/sentry/app/views/releases/list/organizationReleases/index.jsx
+++ b/src/sentry/static/sentry/app/views/releases/list/organizationReleases/index.jsx
@@ -21,6 +21,7 @@ import PageHeading from 'app/components/pageHeading';
 
 import ReleaseList from '../shared/releaseList';
 import ReleaseListHeader from '../shared/releaseListHeader';
+import ReleaseLanding from '../shared/releaseLanding';
 import {getQuery} from '../shared/utils';
 
 class OrganizationReleases extends AsyncView {
@@ -54,21 +55,34 @@ class OrganizationReleases extends AsyncView {
     });
   };
 
+  hasFilters() {
+    const {location} = this.props;
+
+    const hasQueryFilter = !!location.query.query;
+    const hasEnvironmentFilter = !!location.query.environment;
+
+    // If all or one project is selected show the setup screen
+    // We check the type since a single project value is represented as a
+    // string when deserialized and multiple values as an array.
+    const hasProjectFilter =
+      !location.query.project || Array.isArray(location.query.project);
+
+    return hasQueryFilter || hasProjectFilter || hasEnvironmentFilter;
+  }
+
   renderStreamBody() {
-    if (this.state.loading) {
+    const {organization} = this.props;
+    const {loading, releaseList} = this.state;
+
+    if (loading) {
       return <LoadingIndicator />;
     }
 
-    if (this.state.releaseList.length === 0) {
-      return this.renderNoQueryResults();
+    if (releaseList.length === 0) {
+      return this.hasFilters() ? this.renderNoQueryResults() : this.renderEmpty();
     }
 
-    return (
-      <ReleaseList
-        releaseList={this.state.releaseList}
-        orgId={this.props.organization.slug}
-      />
-    );
+    return <ReleaseList releaseList={releaseList} orgId={organization.slug} />;
   }
 
   renderNoQueryResults() {
@@ -79,6 +93,10 @@ class OrganizationReleases extends AsyncView {
     );
   }
 
+  renderEmpty() {
+    return <ReleaseLanding />;
+  }
+
   renderNoAccess() {
     return (
       <PageContent>
diff --git a/src/sentry/static/sentry/app/views/releases/list/projectReleases/index.jsx b/src/sentry/static/sentry/app/views/releases/list/projectReleases/index.jsx
index f9c35245c0..b4cfd5603f 100644
--- a/src/sentry/static/sentry/app/views/releases/list/projectReleases/index.jsx
+++ b/src/sentry/static/sentry/app/views/releases/list/projectReleases/index.jsx
@@ -17,10 +17,8 @@ import {t, tct} from 'app/locale';
 import {Panel, PanelBody} from 'app/components/panels';
 import EmptyStateWarning from 'app/components/emptyStateWarning';
 import withEnvironmentInQueryString from 'app/utils/withEnvironmentInQueryString';
-
-import ReleaseLanding from 'app/views/releases/list/projectReleases/releaseLanding';
 import PageHeading from 'app/components/pageHeading';
-
+import ReleaseLanding from '../shared/releaseLanding';
 import ReleaseEmptyState from './releaseEmptyState';
 import ReleaseList from '../shared/releaseList';
 import ReleaseListHeader from '../shared/releaseListHeader';
diff --git a/src/sentry/static/sentry/app/views/releases/list/projectReleases/releaseLanding.jsx b/src/sentry/static/sentry/app/views/releases/list/shared/releaseLanding.jsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/releases/list/projectReleases/releaseLanding.jsx
rename to src/sentry/static/sentry/app/views/releases/list/shared/releaseLanding.jsx
diff --git a/src/sentry/static/sentry/app/views/releases/list/projectReleases/releaseLandingCard.jsx b/src/sentry/static/sentry/app/views/releases/list/shared/releaseLandingCard.jsx
similarity index 97%
rename from src/sentry/static/sentry/app/views/releases/list/projectReleases/releaseLandingCard.jsx
rename to src/sentry/static/sentry/app/views/releases/list/shared/releaseLandingCard.jsx
index 3ebe072e29..5619521218 100644
--- a/src/sentry/static/sentry/app/views/releases/list/projectReleases/releaseLandingCard.jsx
+++ b/src/sentry/static/sentry/app/views/releases/list/shared/releaseLandingCard.jsx
@@ -46,7 +46,7 @@ class ReleaseLandingCard extends React.Component {
                 href={'https://docs.sentry.io/learn/releases/'}
                 onClick={this.props.onClick}
               >
-                {t(this.getMessage())}
+                {this.getMessage()}
               </StyledButton>
             ) : (
               <StyledButton onClick={this.props.onClick}>
diff --git a/tests/js/spec/views/releases/list/projectReleasesLanding.spec.jsx b/tests/js/spec/views/releases/list/releaseLanding.jsx
similarity index 93%
rename from tests/js/spec/views/releases/list/projectReleasesLanding.spec.jsx
rename to tests/js/spec/views/releases/list/releaseLanding.jsx
index 4918712518..879b553817 100644
--- a/tests/js/spec/views/releases/list/projectReleasesLanding.spec.jsx
+++ b/tests/js/spec/views/releases/list/releaseLanding.jsx
@@ -1,7 +1,7 @@
 import React from 'react';
 import {mount} from 'enzyme';
 
-import ReleaseLanding from 'app/views/releases/list/projectReleases/releaseLanding';
+import ReleaseLanding from 'app/views/releases/list/shared/releaseLanding';
 
 describe('ProjectReleasesLanding', function() {
   describe('renders and progresses', function() {
