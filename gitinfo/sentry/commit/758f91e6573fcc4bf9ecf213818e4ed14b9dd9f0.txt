commit 758f91e6573fcc4bf9ecf213818e4ed14b9dd9f0
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Tue Feb 13 13:52:02 2018 -0800

    fix(asynccomponent): Allow async component to be used without router props
    
    Fixes #7245

diff --git a/src/sentry/static/sentry/app/components/asyncComponent.jsx b/src/sentry/static/sentry/app/components/asyncComponent.jsx
index 2976942496..806abdf5ac 100644
--- a/src/sentry/static/sentry/app/components/asyncComponent.jsx
+++ b/src/sentry/static/sentry/app/components/asyncComponent.jsx
@@ -11,6 +11,10 @@ import LoadingIndicator from '../components/loadingIndicator';
 import RouteError from './../views/routeError';
 
 class AsyncComponent extends React.Component {
+  static contextTypes = {
+    router: PropTypes.object.isRequired,
+  };
+
   constructor(props, context) {
     super(props, context);
 
@@ -25,11 +29,11 @@ class AsyncComponent extends React.Component {
     this.fetchData();
   }
 
-  componentWillReceiveProps(nextProps) {
+  componentWillReceiveProps(nextProps, nextContext) {
     // re-fetch data when router params change
     if (
       !isEqual(this.props.params, nextProps.params) ||
-      this.props.location.search !== nextProps.location.search
+      this.context.router.location.search !== nextContext.router.location.search
     ) {
       this.remountComponent();
     }
@@ -210,8 +214,4 @@ AsyncComponent.errorHandler = (component, fn) => {
   };
 };
 
-AsyncComponent.contextTypes = {
-  router: PropTypes.object.isRequired,
-};
-
 export default AsyncComponent;
diff --git a/tests/js/setup.js b/tests/js/setup.js
index 205af11682..c534f17f74 100644
--- a/tests/js/setup.js
+++ b/tests/js/setup.js
@@ -34,6 +34,7 @@ window.TestStubs = {
     setRouteLeaveHook: sinon.spy(),
     isActive: sinon.spy(),
     createHref: sinon.spy(),
+    location: sinon.spy(),
   }),
 
   location: () => ({
