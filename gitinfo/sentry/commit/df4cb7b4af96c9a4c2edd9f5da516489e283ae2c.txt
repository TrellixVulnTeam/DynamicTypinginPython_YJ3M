commit df4cb7b4af96c9a4c2edd9f5da516489e283ae2c
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Tue Mar 29 18:58:07 2016 +0200

    Store datetimes as floats instead of timestamps to make riak happy.

diff --git a/src/sentry/interfaces/breadcrumbs.py b/src/sentry/interfaces/breadcrumbs.py
index 050d239e52..069eed583d 100644
--- a/src/sentry/interfaces/breadcrumbs.py
+++ b/src/sentry/interfaces/breadcrumbs.py
@@ -15,6 +15,7 @@ from datetime import datetime
 
 from sentry.interfaces.base import Interface, InterfaceValidationError
 from sentry.utils.safe import trim
+from sentry.utils.dates import to_timestamp, to_datetime
 
 
 validators = {}
@@ -164,7 +165,9 @@ class Breadcrumbs(Interface):
                 raise InterfaceValidationError('Unable to determine timestamp for crumb')
             values.append({
                 'type': ty,
-                'timestamp': ts,
+                # We need to store timestamps here as this will go into
+                # the node store which does not support datetime objects.
+                'timestamp': to_timestamp(ts),
                 'data': validate_payload_for_type(crumb.get('data'), ty),
             })
         return cls(values=values)
@@ -176,6 +179,12 @@ class Breadcrumbs(Interface):
         return 'breadcrumbs'
 
     def get_api_context(self, is_public=False):
+        def _convert(x):
+            return {
+                'type': x['type'],
+                'timestamp': to_datetime(x['timestamp']),
+                'data': x['data'],
+            }
         return {
-            'values': self.values,
+            'values': map(_convert, self.values),
         }
