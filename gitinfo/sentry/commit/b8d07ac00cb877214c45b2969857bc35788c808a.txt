commit b8d07ac00cb877214c45b2969857bc35788c808a
Author: Wessie <wessie@r-a-d.io>
Date:   Wed Mar 6 22:15:28 2013 +0100

    Moved activity creation down.

diff --git a/src/sentry/plugins/bases/.issue.py.swp b/src/sentry/plugins/bases/.issue.py.swp
new file mode 100644
index 0000000000..2094f556cc
Binary files /dev/null and b/src/sentry/plugins/bases/.issue.py.swp differ
diff --git a/src/sentry/plugins/bases/issue.py b/src/sentry/plugins/bases/issue.py
index 7bd00ac76b..7060529ccb 100644
--- a/src/sentry/plugins/bases/issue.py
+++ b/src/sentry/plugins/bases/issue.py
@@ -168,23 +168,23 @@ class IssuePlugin(Plugin):
                 )
             except forms.ValidationError, e:
                 form.errors['__all__'] = [u'Error creating issue: %s' % e]
-            else:
-                issue_information = {
-                    'title': form.cleaned_data['title'],
-                    'provider': self.get_title(),
-                    'location': self.get_issue_url(group, issue_id),
-                }
-                Activity.objects.create(
-                    project=group.project,
-                    group=group,
-                    type=Activity.CREATE_ISSUE,
-                    user=request.user,
-                    data=issue_information,
-                    )
 
         if form.is_valid():
             GroupMeta.objects.set_value(group, '%s:tid' % prefix, issue_id)
 
+            issue_information = {
+                'title': form.cleaned_data['title'],
+                'provider': self.get_title(),
+                'location': self.get_issue_url(group, issue_id),
+            }
+            Activity.objects.create(
+                project=group.project,
+                group=group,
+                type=Activity.CREATE_ISSUE,
+                user=request.user,
+                data=issue_information,
+                )
+
             return self.redirect(reverse('sentry-group', args=[group.team.slug, group.project_id, group.pk]))
 
         context = {
