commit 1b122adfcdee83b843e6c75c256fb3fac22bd946
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Jul 30 14:33:08 2015 -0700

    Fix default SENTRY_URL_PREFIX

diff --git a/src/sentry/middleware/locale.py b/src/sentry/middleware/locale.py
index c85a3f59a5..c05db1a145 100644
--- a/src/sentry/middleware/locale.py
+++ b/src/sentry/middleware/locale.py
@@ -15,7 +15,6 @@ from django.core.urlresolvers import reverse
 
 from sentry.app import env
 from sentry.models import UserOption
-from sentry.utils.http import absolute_uri
 from sentry.utils.safe import safe_execute
 
 
@@ -23,7 +22,7 @@ class SentryLocaleMiddleware(object):
     def process_request(self, request):
         # HACK: bootstrap some env crud if we haven't yet
         if not settings.SENTRY_URL_PREFIX:
-            settings.SENTRY_URL_PREFIX = absolute_uri(reverse('sentry')).strip('/')
+            settings.SENTRY_URL_PREFIX = request.build_absolute_uri(reverse('sentry')).strip('/')
 
         # bind request to env
         env.request = request
