commit 35a73783d156963237a3e970759c459913fdfed3
Author: Luke Rohde <rohde.luke@gmail.com>
Date:   Tue May 21 15:52:03 2019 -0400

    feat(grouping): Ignore GeneratedMethodAccessor suffix (#13305)

diff --git a/src/sentry/grouping/strategies/legacy.py b/src/sentry/grouping/strategies/legacy.py
index fb6c905f26..b2e437465f 100644
--- a/src/sentry/grouping/strategies/legacy.py
+++ b/src/sentry/grouping/strategies/legacy.py
@@ -88,6 +88,8 @@ def remove_module_outliers_legacy(module, platform):
     if platform == 'java':
         if module[:35] == 'sun.reflect.GeneratedMethodAccessor':
             return 'sun.reflect.GeneratedMethodAccessor', 'removed reflection marker'
+        if module[:44] == 'jdk.internal.reflect.GeneratedMethodAccessor':
+            return 'jdk.internal.reflect.GeneratedMethodAccessor', 'removed reflection marker'
         old_module = module
         module = _java_reflect_enhancer_re.sub(r'\1<auto>', module)
         module = _java_cglib_enhancer_re.sub(r'\1<auto>', module)
diff --git a/src/sentry/grouping/strategies/newstyle.py b/src/sentry/grouping/strategies/newstyle.py
index 571b6fa155..9cb75df904 100644
--- a/src/sentry/grouping/strategies/newstyle.py
+++ b/src/sentry/grouping/strategies/newstyle.py
@@ -130,6 +130,11 @@ def get_module_component_v1(abs_path, module, platform):
                 values=['sun.reflect.GeneratedMethodAccessor'],
                 hint='removed reflection marker',
             )
+        elif module[:44] == 'jdk.internal.reflect.GeneratedMethodAccessor':
+            module_component.update(
+                values=['jdk.internal.reflect.GeneratedMethodAccessor'],
+                hint='removed reflection marker',
+            )
         else:
             old_module = module
             module = _java_reflect_enhancer_re.sub(r'\1<auto>', module)
diff --git a/tests/sentry/grouping/grouping_inputs/frame-ignores-sun-java-generated-methods.json b/tests/sentry/grouping/grouping_inputs/frame-ignores-sun-java-generated-methods.json
index b81612d5e1..d20d751d27 100644
--- a/tests/sentry/grouping/grouping_inputs/frame-ignores-sun-java-generated-methods.json
+++ b/tests/sentry/grouping/grouping_inputs/frame-ignores-sun-java-generated-methods.json
@@ -4,6 +4,10 @@
       {
         "function": "invoke",
         "module": "sun.reflect.GeneratedMethodAccessor12345"
+      },
+      {
+        "function": "invoke",
+        "module": "jdk.internal.reflect.GeneratedMethodAccessor12345"
       }
     ]
   },
diff --git a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/combined:2019_04_07/frame_ignores_sun_java_generated_methods.pysnap b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/combined:2019_04_07/frame_ignores_sun_java_generated_methods.pysnap
index 1f90251067..84b1050cd2 100644
--- a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/combined:2019_04_07/frame_ignores_sun_java_generated_methods.pysnap
+++ b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/combined:2019_04_07/frame_ignores_sun_java_generated_methods.pysnap
@@ -1,5 +1,5 @@
 ---
-created: '2019-04-07T10:03:31.262050Z'
+created: '2019-05-21T19:16:08.166809Z'
 creator: sentry
 source: tests/sentry/grouping/test_variants.py
 ---
@@ -13,9 +13,14 @@ app:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame* (frame considered in-app because no frame is in-app)
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
 --------------------------------------------------------------------------
 system:
-  hash: 'df0a8233b314c542a0b98a4e8865c7b5'
+  hash: '9bc326575875422d0d4ced3c35d9f916'
   component:
     system*
       stacktrace*
@@ -24,3 +29,8 @@ system:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame*
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
diff --git a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/legacy:2019_03_12/frame_ignores_sun_java_generated_methods.pysnap b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/legacy:2019_03_12/frame_ignores_sun_java_generated_methods.pysnap
index da3f305bf8..406f1a0d7c 100644
--- a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/legacy:2019_03_12/frame_ignores_sun_java_generated_methods.pysnap
+++ b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/legacy:2019_03_12/frame_ignores_sun_java_generated_methods.pysnap
@@ -1,5 +1,5 @@
 ---
-created: '2019-03-14T17:12:37.195959Z'
+created: '2019-05-21T19:16:09.511284Z'
 creator: sentry
 source: tests/sentry/grouping/test_variants.py
 ---
@@ -13,9 +13,14 @@ app:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame* (frame considered in-app because no frame is in-app)
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
 --------------------------------------------------------------------------
 system:
-  hash: 'df0a8233b314c542a0b98a4e8865c7b5'
+  hash: '9bc326575875422d0d4ced3c35d9f916'
   component:
     system*
       stacktrace*
@@ -24,3 +29,8 @@ system:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame*
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
diff --git a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_04_05/frame_ignores_sun_java_generated_methods.pysnap b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_04_05/frame_ignores_sun_java_generated_methods.pysnap
index db191cb745..04e740c105 100644
--- a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_04_05/frame_ignores_sun_java_generated_methods.pysnap
+++ b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_04_05/frame_ignores_sun_java_generated_methods.pysnap
@@ -1,5 +1,5 @@
 ---
-created: '2019-03-15T11:58:33.017753Z'
+created: '2019-05-21T19:16:10.811034Z'
 creator: sentry
 source: tests/sentry/grouping/test_variants.py
 ---
@@ -13,9 +13,14 @@ app:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame (non app frame)
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
 --------------------------------------------------------------------------
 system:
-  hash: 'df0a8233b314c542a0b98a4e8865c7b5'
+  hash: '9bc326575875422d0d4ced3c35d9f916'
   component:
     system*
       stacktrace*
@@ -24,3 +29,8 @@ system:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame*
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
diff --git a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_04_17/frame_ignores_sun_java_generated_methods.pysnap b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_04_17/frame_ignores_sun_java_generated_methods.pysnap
index f3fe16d890..0abbcc9676 100644
--- a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_04_17/frame_ignores_sun_java_generated_methods.pysnap
+++ b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_04_17/frame_ignores_sun_java_generated_methods.pysnap
@@ -1,5 +1,5 @@
 ---
-created: '2019-04-17T20:07:50.420285Z'
+created: '2019-05-21T19:16:12.157909Z'
 creator: sentry
 source: tests/sentry/grouping/test_variants.py
 ---
@@ -13,9 +13,14 @@ app:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame (non app frame)
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
 --------------------------------------------------------------------------
 system:
-  hash: 'df0a8233b314c542a0b98a4e8865c7b5'
+  hash: '9bc326575875422d0d4ced3c35d9f916'
   component:
     system*
       stacktrace*
@@ -24,3 +29,8 @@ system:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame*
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
diff --git a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_05_08/frame_ignores_sun_java_generated_methods.pysnap b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_05_08/frame_ignores_sun_java_generated_methods.pysnap
index 3e1eb43f73..3e9c3119e6 100644
--- a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_05_08/frame_ignores_sun_java_generated_methods.pysnap
+++ b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/newstyle:2019_05_08/frame_ignores_sun_java_generated_methods.pysnap
@@ -1,5 +1,5 @@
 ---
-created: '2019-05-08T07:29:42.288933Z'
+created: '2019-05-21T19:16:13.403893Z'
 creator: sentry
 source: tests/sentry/grouping/test_variants.py
 ---
@@ -13,9 +13,14 @@ app:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame (non app frame)
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
 --------------------------------------------------------------------------
 system:
-  hash: 'df0a8233b314c542a0b98a4e8865c7b5'
+  hash: '9bc326575875422d0d4ced3c35d9f916'
   component:
     system*
       stacktrace*
@@ -24,3 +29,8 @@ system:
             'sun.reflect.GeneratedMethodAccessor'
           function*
             u'invoke'
+        frame*
+          module* (removed reflection marker)
+            'jdk.internal.reflect.GeneratedMethodAccessor'
+          function*
+            u'invoke'
