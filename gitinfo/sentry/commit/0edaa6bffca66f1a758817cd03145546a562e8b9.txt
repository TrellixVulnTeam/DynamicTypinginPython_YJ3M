commit 0edaa6bffca66f1a758817cd03145546a562e8b9
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Oct 10 12:37:51 2015 -0700

    Various asset fixes/cleanup

diff --git a/src/sentry/templatetags/sentry_assets.py b/src/sentry/templatetags/sentry_assets.py
index f9912fe9f5..0f860cc823 100644
--- a/src/sentry/templatetags/sentry_assets.py
+++ b/src/sentry/templatetags/sentry_assets.py
@@ -1,8 +1,8 @@
 from __future__ import absolute_import
 
-from django.conf import settings
 from django.template import Library
-from urlparse import urljoin
+
+from sentry.utils.assets import get_asset_url
 
 register = Library()
 
@@ -16,7 +16,4 @@ def asset_url(module, path):
       {% asset_url 'sentry' 'dist/sentry.css' %}
       =>  "/_static/74d127b78dc7daf2c51f/sentry/dist/sentry.css"
     """
-    return urljoin(
-        settings.STATIC_URL.format(version=settings.ASSET_VERSION),
-        '{}/{}'.format(module, path)
-    )
+    return get_asset_url(module, path)
diff --git a/src/sentry/templatetags/sentry_react.py b/src/sentry/templatetags/sentry_react.py
index d696824ffa..0acd8653ba 100644
--- a/src/sentry/templatetags/sentry_react.py
+++ b/src/sentry/templatetags/sentry_react.py
@@ -4,13 +4,13 @@ import sentry
 
 from django import template
 from django.conf import settings
-from django.core.urlresolvers import reverse
 from django.utils.html import mark_safe
 from pkg_resources import parse_version
 
 from sentry import features, options
 from sentry.api.serializers.base import serialize
 from sentry.utils import json
+from sentry.utils.assets import get_asset_url
 from sentry.utils.functional import extract_lazy_object
 
 register = template.Library()
@@ -52,7 +52,7 @@ def get_react_config(context):
         'urlPrefix': settings.SENTRY_URL_PREFIX,
         'version': _get_version_info(),
         'features': enabled_features,
-        'mediaUrl': reverse('sentry-media', args=[settings.ASSET_VERSION, 'sentry', '']),
+        'mediaUrl': get_asset_url('sentry', ''),
     }
     if user and user.is_authenticated():
         context.update({
diff --git a/src/sentry/utils/assets.py b/src/sentry/utils/assets.py
new file mode 100644
index 0000000000..dff1ad6460
--- /dev/null
+++ b/src/sentry/utils/assets.py
@@ -0,0 +1,18 @@
+from __future__ import absolute_import
+
+from django.conf import settings
+
+
+def get_asset_url(module, path):
+    """
+    Returns a versioned asset URL (located within Sentry's static files).
+
+    Example:
+      {% asset_url 'sentry' 'dist/sentry.css' %}
+      =>  "/_static/74d127b78dc7daf2c51f/sentry/dist/sentry.css"
+    """
+    return '{}/{}/{}'.format(
+        settings.STATIC_URL.format(version=settings.ASSET_VERSION).rstrip('/'),
+        module,
+        path,
+    )
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index 3487498466..6f529015a8 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -106,7 +106,7 @@ urlpatterns += patterns(
     url(r'^api/(?P<project_id>[\w_-]+)/store/$', api.StoreView.as_view(),
         name='sentry-api-store'),
 
-    url(r'^_static/(?P<version>[^/]+)/(?P<module>[^/]+)/(?P<path>.*)$', generic.static_media,
+    url(r'^_static/(?P<module>[^/]+)/(?P<path>.*)$', generic.static_media,
         name='sentry-media'),
 
     # API
