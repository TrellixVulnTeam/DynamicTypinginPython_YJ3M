commit 67273fa2fd9f0ade4218fb19101d2202b0454f96
Author: ted kaemming <ted@getsentry.com>
Date:   Wed Jan 15 11:21:31 2020 -0800

    ref(similarity): Allow disabling scope tags in metrics wrapper (#16469)

diff --git a/src/sentry/similarity/__init__.py b/src/sentry/similarity/__init__.py
index b5140c34af..220ad850f1 100644
--- a/src/sentry/similarity/__init__.py
+++ b/src/sentry/similarity/__init__.py
@@ -74,7 +74,7 @@ def _make_index_backend(cluster=None):
         RedisScriptMinHashIndexBackend(
             cluster, "sim:1", MinHashSignatureBuilder(16, 0xFFFF), 8, 60 * 60 * 24 * 30, 3, 5000
         ),
-        scope_tag_name="project_id",
+        scope_tag_name=None,
     )
 
 
diff --git a/src/sentry/similarity/backends/metrics.py b/src/sentry/similarity/backends/metrics.py
index ba8d7f2f27..0b7b3d33e5 100644
--- a/src/sentry/similarity/backends/metrics.py
+++ b/src/sentry/similarity/backends/metrics.py
@@ -14,7 +14,11 @@ class MetricsWrapper(AbstractIndexBackend):
         return getattr(self.backend, name)
 
     def __instrumented_method_call(self, method, scope, *args, **kwargs):
-        with timer(self.template.format(method), tags={self.scope_tag_name: scope}):
+        tags = {}
+        if self.scope_tag_name is not None:
+            tags[self.scope_tag_name] = scope
+
+        with timer(self.template.format(method), tags=tags):
             return getattr(self.backend, method)(scope, *args, **kwargs)
 
     def record(self, *args, **kwargs):
