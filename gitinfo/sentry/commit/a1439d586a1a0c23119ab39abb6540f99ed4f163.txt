commit a1439d586a1a0c23119ab39abb6540f99ed4f163
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Aug 17 17:32:01 2015 -0700

    Various improvements to event details
    
    - Move tags below errors
    - Add release information to event details
    - Move user's ID above email

diff --git a/src/sentry/api/endpoints/event_details.py b/src/sentry/api/endpoints/event_details.py
index 8872cc49ba..6d2c5b61b9 100644
--- a/src/sentry/api/endpoints/event_details.py
+++ b/src/sentry/api/endpoints/event_details.py
@@ -5,7 +5,7 @@ from rest_framework.response import Response
 from sentry.api.base import DocSection, Endpoint
 from sentry.api.bases.group import GroupPermission
 from sentry.api.serializers import serialize
-from sentry.models import Event
+from sentry.models import Event, Release
 
 
 class EventDetailsEndpoint(Endpoint):
@@ -13,6 +13,19 @@ class EventDetailsEndpoint(Endpoint):
 
     permission_classes = (GroupPermission,)
 
+    def _get_release_info(self, request, event):
+        version = event.get_tag('sentry:release')
+        if not version:
+            return None
+        try:
+            release = Release.objects.get(
+                project=event.project,
+                version=version,
+            )
+        except Release.DoesNotExist:
+            return {'version': version}
+        return serialize(release, request.user)
+
     def get(self, request, event_id):
         """
         Retrieve an event
@@ -56,6 +69,7 @@ class EventDetailsEndpoint(Endpoint):
             prev_event = None
 
         data = serialize(event, request.user)
+        data['release'] = self._get_release_info(request, event)
 
         if next_event:
             data['nextEventID'] = str(next_event.id)
diff --git a/src/sentry/static/sentry/app/components/eventEntries.jsx b/src/sentry/static/sentry/app/components/eventEntries.jsx
index f6ac27488a..fd752f6019 100644
--- a/src/sentry/static/sentry/app/components/eventEntries.jsx
+++ b/src/sentry/static/sentry/app/components/eventEntries.jsx
@@ -3,6 +3,7 @@ import React from "react";
 import ClippedBox from "./clippedBox";
 import ContextData from "./contextData";
 import EventDataSection from "./eventDataSection";
+import EventTags from "./eventTags";
 import PropTypes from "../proptypes";
 import utils from "../utils";
 
@@ -198,6 +199,9 @@ var EventEntries = React.createClass({
             group={group}
             event={evt} />
         }
+        <EventTags
+            group={group}
+            event={evt} />
         {entries}
         {!utils.objectIsEmpty(evt.context) &&
           <EventExtraData
diff --git a/src/sentry/static/sentry/app/views/groupDetails/eventTags.jsx b/src/sentry/static/sentry/app/components/eventTags.jsx
similarity index 85%
rename from src/sentry/static/sentry/app/views/groupDetails/eventTags.jsx
rename to src/sentry/static/sentry/app/components/eventTags.jsx
index 4919758eb8..38b0929414 100644
--- a/src/sentry/static/sentry/app/views/groupDetails/eventTags.jsx
+++ b/src/sentry/static/sentry/app/components/eventTags.jsx
@@ -1,7 +1,7 @@
 import React from "react";
-import PropTypes from "../../proptypes";
+import PropTypes from "../proptypes";
 
-var GroupEventTags = React.createClass({
+var EventTags = React.createClass({
   propTypes: {
     group: PropTypes.Group.isRequired,
     event: PropTypes.Event.isRequired
@@ -34,6 +34,6 @@ var GroupEventTags = React.createClass({
   }
 });
 
-export default GroupEventTags;
+export default EventTags;
 
 
diff --git a/src/sentry/static/sentry/app/views/groupDetails/event.jsx b/src/sentry/static/sentry/app/views/groupDetails/event.jsx
index da64cc9217..76347fde4d 100644
--- a/src/sentry/static/sentry/app/views/groupDetails/event.jsx
+++ b/src/sentry/static/sentry/app/views/groupDetails/event.jsx
@@ -3,12 +3,13 @@ import Sticky from "react-sticky";
 import DateTime from "../../components/dateTime";
 import GroupEventEntries from "../../components/eventEntries";
 import GroupEventHeader from "./eventHeader";
-import GroupEventTags from "./eventTags";
 import GroupState from "../../mixins/groupState";
 import Gravatar from "../../components/gravatar";
 import PropTypes from "../../proptypes";
 import TimeSince from "../../components/timeSince";
 import utils from "../../utils";
+import Version from "../../components/version";
+
 
 var UserWidget = React.createClass({
   propTypes: {
@@ -23,14 +24,14 @@ var UserWidget = React.createClass({
         <div className="pull-right"><Gravatar email={user.email} size={84} /></div>
         <h6><span>User</span></h6>
         <dl>
-          {user.email && [
-            <dt>Email:</dt>,
-            <dd>{user.email}</dd>
-          ]}
           {user.id && [
             <dt>ID:</dt>,
             <dd>{user.id}</dd>
           ]}
+          {user.email && [
+            <dt>Email:</dt>,
+            <dd>{user.email}</dd>
+          ]}
           {user.username && [
             <dt>Username:</dt>,
             <dd>{user.username}</dd>
@@ -49,6 +50,22 @@ var UserWidget = React.createClass({
   }
 });
 
+var ReleaseWidget = React.createClass({
+  render() {
+    var release = this.props.data;
+
+    return (
+      <div className="user-widget">
+        <h6><span>Release</span></h6>
+        <dl>
+          <dt key={4}>Version:</dt>
+          <dd key={5}><Version version={release.version} /></dd>
+        </dl>
+      </div>
+    );
+  }
+});
+
 var GroupEvent = React.createClass({
   mixins: [GroupState],
 
@@ -63,9 +80,6 @@ var GroupEvent = React.createClass({
     return (
       <div className="row event">
         <div className="col-md-9">
-          <GroupEventTags
-              group={group}
-              event={evt} />
           <GroupEventEntries
               group={group}
               event={evt} />
@@ -84,6 +98,9 @@ var GroupEvent = React.createClass({
             {evt.user &&
               <UserWidget data={evt.user} />
             }
+            {evt.release &&
+              <ReleaseWidget data={evt.release} />
+            }
           </div>
         </div>
       </div>
diff --git a/src/sentry/static/sentry/app/views/groupEventDetails.jsx b/src/sentry/static/sentry/app/views/groupEventDetails.jsx
index fa73f288ee..99ab855bbc 100644
--- a/src/sentry/static/sentry/app/views/groupEventDetails.jsx
+++ b/src/sentry/static/sentry/app/views/groupEventDetails.jsx
@@ -104,9 +104,7 @@ var GroupEventDetails = React.createClass({
         : (this.state.error ?
           <LoadingError onRetry={this.fetchData} />
         :
-          <div>
-            <GroupEvent group={group} event={evt} />
-          </div>
+          <GroupEvent group={group} event={evt} />
         )}
       </div>
     );
diff --git a/src/sentry/static/sentry/app/views/groupOverview.jsx b/src/sentry/static/sentry/app/views/groupOverview.jsx
index df6417ffb8..b37709cb21 100644
--- a/src/sentry/static/sentry/app/views/groupOverview.jsx
+++ b/src/sentry/static/sentry/app/views/groupOverview.jsx
@@ -6,7 +6,6 @@ import Count from "../components/count";
 import DateTime from "../components/dateTime";
 import GroupChart from "./groupDetails/chart";
 import GroupEventEntries from "../components/eventEntries";
-import GroupEventTags from "./groupDetails/eventTags";
 import GroupState from "../mixins/groupState";
 import MutedBox from "../components/mutedBox";
 import LoadingError from "../components/loadingError";
@@ -302,9 +301,6 @@ var GroupOverview = React.createClass({
                   }} className="pull-right btn btn-sm">More Details</Router.Link>
                   This summary is based on the most recent event in this aggregate.
                 </div>
-                <GroupEventTags
-                  group={group}
-                  event={evt} />
                 <GroupEventEntries
                     group={group}
                     event={evt} />
