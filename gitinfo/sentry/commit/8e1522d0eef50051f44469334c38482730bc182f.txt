commit 8e1522d0eef50051f44469334c38482730bc182f
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Feb 13 01:01:58 2013 -0800

    Ensure we never pull in bad counts

diff --git a/src/sentry/tasks/check_alerts.py b/src/sentry/tasks/check_alerts.py
index 45194c80f8..22a036ae6a 100644
--- a/src/sentry/tasks/check_alerts.py
+++ b/src/sentry/tasks/check_alerts.py
@@ -74,12 +74,14 @@ def check_alerts(**kwargs):
     # TODO: we could force more work on the db by eliminating onces which dont have the full aggregate we need
     qs = ProjectCountByMinute.objects.filter(
         date__gt=when - timedelta(minutes=MINUTE_NORMALIZATION),
+        count__gt=0,
     ).values_list('project_id', 'date', 'times_seen')
     for project_id, date, count in qs:
+        normalized_count = int(count / (((when - date).seconds + 1) / 60))
         maybe_delay(check_project_alerts,
             project_id=project_id,
             when=when,
-            count=int(count / ((when - date).seconds / 60)),
+            count=normalized_count,
             expires=120,
         )
 
