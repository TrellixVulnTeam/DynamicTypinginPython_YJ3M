commit 2fdf5f52c1d72c67bceceae53fc8c447817040d6
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Sat Apr 9 20:16:27 2016 +0200

    Fixed counters in MySQL
    
    The behavior for multiple sql statements in the same execute
    block seem to be inconsistent in different environments.

diff --git a/src/sentry/models/counter.py b/src/sentry/models/counter.py
index 10b0ad13b7..0ad0762674 100644
--- a/src/sentry/models/counter.py
+++ b/src/sentry/models/counter.py
@@ -77,9 +77,9 @@ def increment_project_counter(project, delta=1):
                             (project_id, value)
                      values (%s, @new_val := %s)
            on duplicate key
-                     update value = @new_val := value + %s;
-                     select @new_val;
+                     update value = @new_val := value + %s
             ''', [project.id, delta, delta])
+            cur.execute('select @new_val')
             return cur.fetchone()[0]
         else:
             raise AssertionError("Not implemented database engine path")
