commit d927197a22bd6f4db8308654753ebb9bd79f5e0a
Author: ted kaemming <ted@kaemming.com>
Date:   Wed Dec 12 10:35:14 2018 -0800

    fix(search): Prevent SequencePaginator from throwing IndexError when used incorrectly (#11016)

diff --git a/src/sentry/api/paginator.py b/src/sentry/api/paginator.py
index 39da459219..e2c41a91b3 100644
--- a/src/sentry/api/paginator.py
+++ b/src/sentry/api/paginator.py
@@ -262,7 +262,7 @@ def reverse_bisect_left(a, x, lo=0, hi=None):
     if lo < 0:
         raise ValueError('lo must be non-negative')
 
-    if hi is None:
+    if hi is None or hi > len(a):
         hi = len(a)
 
     while lo < hi:
diff --git a/tests/sentry/api/test_paginator.py b/tests/sentry/api/test_paginator.py
index bd0bbb41d7..a719508c95 100644
--- a/tests/sentry/api/test_paginator.py
+++ b/tests/sentry/api/test_paginator.py
@@ -345,6 +345,8 @@ def test_reverse_bisect_left():
     assert reverse_bisect_left([2, 2, 1], 1) == 2
     assert reverse_bisect_left([2, 2, 1], 2) == 0
 
+    assert reverse_bisect_left([3, 2, 1], 2, hi=10) == 1
+
 
 class SequencePaginatorTestCase(SimpleTestCase):
     def test_empty_results(self):
