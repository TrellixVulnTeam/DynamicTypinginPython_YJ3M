commit 5d4cb6a1d8dfc1dec8ad59d821c9e140e0f32b4a
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Oct 19 19:17:38 2014 +0200

    Expand rule tests

diff --git a/tests/sentry/tasks/post_process/tests.py b/tests/sentry/tasks/post_process/tests.py
index 9d98c35abc..fc9069f493 100644
--- a/tests/sentry/tasks/post_process/tests.py
+++ b/tests/sentry/tasks/post_process/tests.py
@@ -83,10 +83,26 @@ class PostProcessGroupTest(TestCase):
             Rule(
                 id=1,
                 data={
-                    'actions': [{'id': action_id}],
-                    'conditions': [{'id': condition_id}],
+                    'actions': [{
+                        'id': 'sentry.rules.actions.notify_event.NotifyEventAction',
+                    }],
+                    'conditions': [{
+                        'id': 'sentry.rules.conditions.first_seen_event.FirstSeenEventCondition',
+                    }],
                 }
-            )
+            ),
+            Rule(
+                id=2,
+                data={
+                    'actions': [{
+                        'id': 'sentry.rules.actions.notify_event_service.NotifyEventAction',
+                        'service': 'mail',
+                    }],
+                    'conditions': [{
+                        'id': 'sentry.rules.conditions.every_event.EveryEventCondition',
+                    }],
+                }
+            ),
         ]
 
         post_process_group(
@@ -98,7 +114,9 @@ class PostProcessGroupTest(TestCase):
 
         mock_get_rules.assert_called_once_with(self.project)
 
-        assert not mock_execute_rule.apply_async.called
+        assert len(mock_execute_rule.apply_async.mock_calls) == 1
+
+        mock_execute_rule.apply_async.reset_mock()
 
         post_process_group(
             event=event,
@@ -107,7 +125,9 @@ class PostProcessGroupTest(TestCase):
             is_sample=False,
         )
 
-        assert len(mock_execute_rule.apply_async.mock_calls) == 1
+        assert len(mock_execute_rule.apply_async.mock_calls) == 2
+
+        mock_execute_rule.apply_async.reset_mock()
 
         post_process_group(
             event=event,
