commit 2ff1a9f413f243be88417ec660831d9283f63fe4
Author: adhiraj <693121+adhiraj@users.noreply.github.com>
Date:   Wed Oct 31 17:18:01 2018 -0700

    feat(analytics): Log issue.ignored event (#10377)

diff --git a/src/sentry/analytics/events/issue_ignored.py b/src/sentry/analytics/events/issue_ignored.py
new file mode 100644
index 0000000000..9ac95e9087
--- /dev/null
+++ b/src/sentry/analytics/events/issue_ignored.py
@@ -0,0 +1,22 @@
+from __future__ import absolute_import
+
+from sentry import analytics
+
+
+class IssueIgnoredEvent(analytics.Event):
+    type = 'issue.ignored'
+
+    attributes = (
+        analytics.Attribute('user_id', type=int, required=False),
+        analytics.Attribute('default_user_id', type=int),
+        analytics.Attribute('organization_id', type=int),
+        analytics.Attribute('group_id'),
+        analytics.Attribute('ignore_duration', type=int, required=False),
+        analytics.Attribute('ignore_count', type=int, required=False),
+        analytics.Attribute('ignore_window', type=int, required=False),
+        analytics.Attribute('ignore_user_count', type=int, required=False),
+        analytics.Attribute('ignore_user_window', type=int, required=False),
+    )
+
+
+analytics.register(IssueIgnoredEvent)
diff --git a/src/sentry/api/endpoints/project_group_index.py b/src/sentry/api/endpoints/project_group_index.py
index 86d5b435e4..cb484f6f01 100644
--- a/src/sentry/api/endpoints/project_group_index.py
+++ b/src/sentry/api/endpoints/project_group_index.py
@@ -689,7 +689,6 @@ class ProjectGroupIndexEndpoint(ProjectEndpoint, EnvironmentMixin):
                                 'ignoreWindow': ignore_window,
                                 'actor': serialize(extract_lazy_object(request.user), request.user),
                             }
-                        issue_ignored.send_robust(project=project, sender=self.__class__)
                     else:
                         GroupSnooze.objects.filter(
                             group__in=group_ids,
@@ -714,6 +713,13 @@ class ProjectGroupIndexEndpoint(ProjectEndpoint, EnvironmentMixin):
                         'ignoreWindow': ignore_window,
                     }
 
+                issue_ignored.send_robust(
+                    project=project,
+                    user=acting_user,
+                    group_list=group_list,
+                    activity_data=activity_data,
+                    sender=self.__class__)
+
                 for group in group_list:
                     group.status = new_status
 
diff --git a/src/sentry/receivers/features.py b/src/sentry/receivers/features.py
index 14937fb94a..db8ec84f6c 100644
--- a/src/sentry/receivers/features.py
+++ b/src/sentry/receivers/features.py
@@ -339,11 +339,31 @@ def record_ownership_rule_created(project, **kwargs):
 
 
 @issue_ignored.connect(weak=False)
-def record_issue_ignored(project, **kwargs):
+def record_issue_ignored(project, user, group_list, activity_data, **kwargs):
     FeatureAdoption.objects.record(
         organization_id=project.organization_id, feature_slug="issue_ignored", complete=True
     )
 
+    if user and user.is_authenticated():
+        user_id = default_user_id = user.id
+    else:
+        user_id = None
+        default_user_id = project.organization.get_default_owner().id
+
+    for group in group_list:
+        analytics.record(
+            'issue.ignored',
+            user_id=user_id,
+            default_user_id=default_user_id,
+            organization_id=project.organization_id,
+            group_id=group.id,
+            ignore_duration=activity_data.get('ignoreDuration'),
+            ignore_count=activity_data.get('ignoreCount'),
+            ignore_window=activity_data.get('ignoreWindow'),
+            ignore_user_count=activity_data.get('ignoreUserCount'),
+            ignore_user_window=activity_data.get('ignoreUserWindow'),
+        )
+
 
 @team_created.connect(weak=False)
 def record_team_created(organization, user, team, **kwargs):
diff --git a/src/sentry/signals.py b/src/sentry/signals.py
index 05ad32949e..8008ad597b 100644
--- a/src/sentry/signals.py
+++ b/src/sentry/signals.py
@@ -95,7 +95,7 @@ release_created = BetterSignal(providing_args=["release"])
 deploy_created = BetterSignal(providing_args=["deploy"])
 resolved_with_commit = BetterSignal(providing_args=["organization_id", "user", "group"])
 ownership_rule_created = BetterSignal(providing_args=["project"])
-issue_ignored = BetterSignal(providing_args=["project"])
+issue_ignored = BetterSignal(providing_args=["project", "user", "group_list", "activity_data"])
 
 terms_accepted = BetterSignal(providing_args=["organization", "user", "ip_address"])
 team_created = BetterSignal(providing_args=["organization", "user", "team"])
