commit 9172f7c22ef082f85aa912f4b92500db1131644a
Author: Stephen Cefali <scefali@sentry.io>
Date:   Wed Feb 12 16:36:44 2020 -0800

    feat(integrations): add slug to integration provider and improve provider type (#16992)

diff --git a/src/sentry/api/serializers/models/integration.py b/src/sentry/api/serializers/models/integration.py
index 4e192d99f4..f0c24be730 100644
--- a/src/sentry/api/serializers/models/integration.py
+++ b/src/sentry/api/serializers/models/integration.py
@@ -21,6 +21,7 @@ class IntegrationSerializer(Serializer):
             "status": obj.get_status_display(),
             "provider": {
                 "key": provider.key,
+                "slug": provider.key,
                 "name": provider.name,
                 "canAdd": provider.can_add,
                 "canDisable": provider.can_disable,
@@ -85,6 +86,7 @@ class IntegrationProviderSerializer(Serializer):
 
         return {
             "key": obj.key,
+            "slug": obj.key,
             "name": obj.name,
             "metadata": metadata,
             "canAdd": obj.can_add,
diff --git a/src/sentry/static/sentry/app/types/index.tsx b/src/sentry/static/sentry/app/types/index.tsx
index 589be2b2a2..a081d8a580 100644
--- a/src/sentry/static/sentry/app/types/index.tsx
+++ b/src/sentry/static/sentry/app/types/index.tsx
@@ -491,15 +491,26 @@ export enum RepositoryStatus {
   DELETION_IN_PROGRESS = 'deletion_in_progress',
 }
 
-export type IntegrationProvider = {
+type BaseIntegrationProvider = {
   key: string;
+  slug: string;
   name: string;
   canAdd: boolean;
   canDisable: boolean;
   features: string[];
-  aspects: any; //TODO(ts)
+};
+
+export type IntegrationProvider = BaseIntegrationProvider & {
   setupDialog: {url: string; width: number; height: number};
-  metadata: any; //TODO(ts)
+  metadata: {
+    description: string;
+    features: IntegrationFeature[];
+    author: string;
+    noun: string;
+    issue_url: string;
+    source_url: string;
+    aspects: any; //TODO(ts)
+  };
 };
 
 export type IntegrationFeature = {
@@ -568,7 +579,7 @@ export type Integration = {
   domainName: string;
   accountType: string;
   status: ObjectStatus;
-  provider: IntegrationProvider;
+  provider: BaseIntegrationProvider & {aspects: any};
   configOrganization: Field[];
   //TODO(ts): This includes the initial data that is passed into the integration's configuration form
   configData: object;
diff --git a/tests/js/sentry-test/fixtures/githubIntegrationProvider.js b/tests/js/sentry-test/fixtures/githubIntegrationProvider.js
index 7e49034ec0..297077c33e 100644
--- a/tests/js/sentry-test/fixtures/githubIntegrationProvider.js
+++ b/tests/js/sentry-test/fixtures/githubIntegrationProvider.js
@@ -1,6 +1,7 @@
 export function GitHubIntegrationProvider(params = {}) {
   return {
     key: 'github',
+    slug: 'github',
     name: 'GitHub',
     canAdd: true,
     config: [],
diff --git a/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap b/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap
index 0efd097410..948840e4b4 100644
--- a/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap
+++ b/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap
@@ -65,6 +65,7 @@ exports[`IntegrationDetailsModal renders simple integration 1`] = `
         "url": "/github-integration-setup-uri/",
         "width": 100,
       },
+      "slug": "github",
     }
   }
 >
@@ -218,6 +219,7 @@ exports[`IntegrationDetailsModal renders simple integration 1`] = `
           "url": "/github-integration-setup-uri/",
           "width": 100,
         },
+        "slug": "github",
       }
     }
   >
@@ -650,6 +652,7 @@ exports[`IntegrationDetailsModal renders simple integration 1`] = `
                         "url": "/github-integration-setup-uri/",
                         "width": 100,
                       },
+                      "slug": "github",
                     }
                   }
                   size="small"
@@ -728,6 +731,7 @@ exports[`IntegrationDetailsModal renders simple integration 1`] = `
                             "url": "/github-integration-setup-uri/",
                             "width": 100,
                           },
+                          "slug": "github",
                         }
                       }
                     >
diff --git a/tests/sentry/api/endpoints/test_group_integration_details.py b/tests/sentry/api/endpoints/test_group_integration_details.py
index e51fef1ee3..38b612e333 100644
--- a/tests/sentry/api/endpoints/test_group_integration_details.py
+++ b/tests/sentry/api/endpoints/test_group_integration_details.py
@@ -51,6 +51,7 @@ class GroupIntegrationDetailsTest(APITestCase):
                 "status": integration.get_status_display(),
                 "provider": {
                     "key": provider.key,
+                    "slug": provider.key,
                     "name": provider.name,
                     "canAdd": provider.can_add,
                     "canDisable": provider.can_disable,
@@ -90,6 +91,7 @@ class GroupIntegrationDetailsTest(APITestCase):
                 "status": integration.get_status_display(),
                 "provider": {
                     "key": provider.key,
+                    "slug": provider.key,
                     "name": provider.name,
                     "canAdd": provider.can_add,
                     "canDisable": provider.can_disable,
diff --git a/tests/sentry/api/endpoints/test_group_integrations.py b/tests/sentry/api/endpoints/test_group_integrations.py
index 9306ecca98..2ed176ed68 100644
--- a/tests/sentry/api/endpoints/test_group_integrations.py
+++ b/tests/sentry/api/endpoints/test_group_integrations.py
@@ -43,6 +43,7 @@ class GroupIntegrationsTest(APITestCase):
                 "status": integration.get_status_display(),
                 "provider": {
                     "key": provider.key,
+                    "slug": provider.key,
                     "name": provider.name,
                     "canAdd": provider.can_add,
                     "canDisable": provider.can_disable,
