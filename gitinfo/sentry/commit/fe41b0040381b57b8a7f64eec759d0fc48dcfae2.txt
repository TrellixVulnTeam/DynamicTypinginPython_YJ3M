commit fe41b0040381b57b8a7f64eec759d0fc48dcfae2
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Feb 21 13:33:11 2011 -0800

    Ensure sentry gets attached to request under any circumstance possible

diff --git a/sentry/client/base.py b/sentry/client/base.py
index 0f2cd2a3b5..a9710c4a39 100644
--- a/sentry/client/base.py
+++ b/sentry/client/base.py
@@ -106,6 +106,12 @@ class SentryClient(object):
 
         self.send(**kwargs)
         
+        if request:
+            # attach the sentry object to the request
+            request.sentry = {
+                'id': message_id,
+            }
+        
         return message_id
 
     def send(self, **kwargs):
diff --git a/sentry/client/models.py b/sentry/client/models.py
index a9c7108c2d..cb3baf52c2 100644
--- a/sentry/client/models.py
+++ b/sentry/client/models.py
@@ -36,11 +36,6 @@ def sentry_exception_handler(request=None, **kwargs):
         )
         
         message_id = get_client().create_from_exception(**extra)
-        if request:
-            # attach the sentry object to the request
-            request.sentry = {
-                'id': message_id,
-            }
     except Exception, exc:
         try:
             logger.exception(u'Unable to process log entry: %s' % (exc,))
