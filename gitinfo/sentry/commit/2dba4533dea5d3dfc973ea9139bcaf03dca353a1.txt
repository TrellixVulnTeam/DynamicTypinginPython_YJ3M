commit 2dba4533dea5d3dfc973ea9139bcaf03dca353a1
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jan 11 18:18:31 2016 -0800

    Correct deletion handling (outside of transaction)

diff --git a/src/sentry/tasks/merge.py b/src/sentry/tasks/merge.py
index 54dc441d5f..897d58b786 100644
--- a/src/sentry/tasks/merge.py
+++ b/src/sentry/tasks/merge.py
@@ -83,7 +83,11 @@ def merge_objects(models, group, new_group, limit=1000,
                         id=obj.id
                     ).update(group=new_group)
                 except IntegrityError:
-                    obj.delete()
+                    delete = True
+                else:
+                    delete = False
+            if delete:
+                obj.delete()
             has_more = True
 
         if has_more:
