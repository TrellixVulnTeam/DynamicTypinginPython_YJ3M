commit 686f2d0b942955f94948da94791bc707d5f7e874
Author: Mark Story <mark@sentry.io>
Date:   Wed Oct 30 12:52:47 2019 -0400

    fix(discover) Fix key error in discover1 (#15324)
    
    When no projects are sent in the request we should not 500.
    
    Fixes SENTRY-D5Z

diff --git a/src/sentry/discover/endpoints/discover_query.py b/src/sentry/discover/endpoints/discover_query.py
index 487ea5aae8..02972f802a 100644
--- a/src/sentry/discover/endpoints/discover_query.py
+++ b/src/sentry/discover/endpoints/discover_query.py
@@ -101,8 +101,8 @@ class DiscoverQueryEndpoint(OrganizationEndpoint):
             return Response(status=404)
 
         try:
-            requested_projects = set(map(int, request.data["projects"]))
-        except ValueError:
+            requested_projects = set(map(int, request.data.get("projects", [])))
+        except (ValueError, TypeError):
             raise ResourceDoesNotExist()
         projects = self._get_projects_by_id(requested_projects, request, organization)
 
