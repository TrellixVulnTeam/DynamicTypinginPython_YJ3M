commit 89bca9820e7cf23e52fe27fbcd04aaeff8e2c7ce
Author: ckj <chris.jennings@github.com>
Date:   Sat Jun 14 02:56:07 2014 -0400

    Make 'Add note' form inline

diff --git a/src/sentry/static/sentry/app/base.js b/src/sentry/static/sentry/app/base.js
index 1667a4036b..a701b6fb30 100644
--- a/src/sentry/static/sentry/app/base.js
+++ b/src/sentry/static/sentry/app/base.js
@@ -293,19 +293,14 @@ define([
                     });
                 });
 
-                $('.add-note-btn').click(function(e){
-                    var $el = $(this),
-                        $form = $('.add-note-form', $el.parent());
-
-                    e.preventDefault();
+                $('.add-note-form textarea').focus(function () {
+                    $(this).addClass('expanded');
+                });
 
-                    if ($el.hasClass('selected')) {
-                        $el.removeClass('selected');
-                        $form.addClass('hide');
-                    } else {
-                        $el.addClass('selected');
-                        $form.removeClass('hide');
-                        $form.find('textarea:first').focus();
+                $('.add-note-form textarea').keypress(function (e) {
+                    if (e.which == 13 && !e.shiftKey) {
+                      $('.add-note-form').submit();
+                      return false;
                     }
                 });
 
diff --git a/src/sentry/static/sentry/less/sentry.less b/src/sentry/static/sentry/less/sentry.less
index 775c6b85f4..89c3549c2e 100644
--- a/src/sentry/static/sentry/less/sentry.less
+++ b/src/sentry/static/sentry/less/sentry.less
@@ -1986,26 +1986,30 @@ table.vars {
 
   > ul {
     list-style: none;
-    margin: 0 0 20px;
+    margin: 0 0 0;
     padding-left: 0;
 
     > li {
-      margin-bottom: 5px;
-      line-height: 30px;
+      padding: 10px 0;
       position: relative;
-      padding-left: 20px;
+      padding-left: 24px;
+      border-bottom: 2px solid #f1f2f3;
+
+      &:last-child {
+        border: 0;
+      }
 
       .avatar {
         position: absolute;
         left: 0;
-        top: 4px;
+        top: 11px;
         width: 16px;
         height: 16px;
         display: block;
         background-size: 16px 16px;
         background-repeat: no-repeat;
         background-position: center center;
-        border-radius: 16px;
+        border-radius: 3px;
 
         img {
           width: 16px;
@@ -2017,9 +2021,13 @@ table.vars {
         &.sentry {
           background-image: url('../images/favicon.ico');
         }
+      }
 
-        p {
-          font-size: 12px;
+      p {
+        font-size: 12px;
+        margin-bottom: 10px;
+        &:last-child {
+          margin: 0;
         }
       }
 
@@ -2030,60 +2038,20 @@ table.vars {
     }
   }
 
-  .add-note-btn {
-    font-size: 12px;
-    font-weight: 300;
-    letter-spacing: -0.1px;
-    position: absolute;
-    right: 0;
-    top: 0;
-    padding: 2px 5px;
-    background: #eff3f7;
-    color: #666d73;
-    border: 1px solid #eff3f7;
-    border-radius: 4px;
-
-    .icon-comment {
-      .opacity(50);
-    }
-    &:hover.selected,
-    &.selected {
-      z-index: 1001;
-      border-color: darken(#eff3f7, 10%);
-      border-radius: 4px 4px 0 0;
-      border-bottom-color: #eff3f7;
-    }
-
-  }
+  .post-box {
 
-  form.add-note-form {
-    z-index: 1000;
-    position: absolute;
-    right: 0;
-    top: 25px;
-    background: #eff3f7;
-    padding: 10px;
-    border: 1px solid darken(#eff3f7, 10%);
+    // border-bottom: 2px solid #f1f2f3;
+    margin: -0 -0 5px;
 
-    > textarea {
-      font-size: 13px;
-      max-width: 600px;
-      background: #fff;
-      border: 1px solid darken(#eff3f7, 10%);
-      font-weight: 300;
-      height: 80px;
+    textarea {
+      .form-control();
+      min-height: 36px;
       margin: 0;
-      right: 0;
-      left: 0;
-      margin-bottom: 10px;
-      .box-shadow(none);
-      .placeholder(#ddd);
-    }
+      .transition(.15s ease-in-out min-height);
 
-    .form-actions {
-      text-align: right;
-      padding: 0;
-      margin: 0;
+      &.expanded {
+        min-height: 52px;
+      }
     }
   }
 }
diff --git a/src/sentry/static/sentry/styles/global.min.css b/src/sentry/static/sentry/styles/global.min.css
index e5f7316b16..81b9028859 100644
--- a/src/sentry/static/sentry/styles/global.min.css
+++ b/src/sentry/static/sentry/styles/global.min.css
@@ -8243,26 +8243,29 @@ table.vars tbody > tr:nth-child(even) > th {
 }
 .activity > ul {
   list-style: none;
-  margin: 0 0 20px;
+  margin: 0 0 0;
   padding-left: 0;
 }
 .activity > ul > li {
-  margin-bottom: 5px;
-  line-height: 30px;
+  padding: 10px 0;
   position: relative;
-  padding-left: 20px;
+  padding-left: 24px;
+  border-bottom: 2px solid #f1f2f3;
+}
+.activity > ul > li:last-child {
+  border: 0;
 }
 .activity > ul > li .avatar {
   position: absolute;
   left: 0;
-  top: 4px;
+  top: 11px;
   width: 16px;
   height: 16px;
   display: block;
   background-size: 16px 16px;
   background-repeat: no-repeat;
   background-position: center center;
-  border-radius: 16px;
+  border-radius: 3px;
 }
 .activity > ul > li .avatar img {
   width: 16px;
@@ -8273,75 +8276,73 @@ table.vars tbody > tr:nth-child(even) > th {
 .activity > ul > li .avatar.sentry {
   background-image: url('../images/favicon.ico');
 }
-.activity > ul > li .avatar p {
+.activity > ul > li p {
   font-size: 12px;
+  margin-bottom: 10px;
+}
+.activity > ul > li p:last-child {
+  margin: 0;
 }
 .activity > ul > li .sep,
 .activity > ul > li .time {
   font-size: 12px;
   color: #aaa;
 }
-.activity .add-note-btn {
-  font-size: 12px;
-  font-weight: 300;
-  letter-spacing: -0.1px;
-  position: absolute;
-  right: 0;
-  top: 0;
-  padding: 2px 5px;
-  background: #eff3f7;
-  color: #666d73;
-  border: 1px solid #eff3f7;
+.activity .post-box {
+  margin: 0 0 5px;
+}
+.activity .post-box textarea {
+  display: block;
+  width: 100%;
+  height: 34px;
+  padding: 6px 12px;
+  font-size: 14px;
+  line-height: 1.42857143;
+  color: #465262;
+  background-color: #ffffff;
+  background-image: none;
+  border: 1px solid #cccccc;
   border-radius: 4px;
+  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
+  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
+  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
+  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
+  box-shadow: none;
+  height: auto;
+  border: 2px solid #e9eaea;
+  min-height: 36px;
+  margin: 0;
+  -webkit-transition: 0.15s ease-in-out min-height;
+  transition: 0.15s ease-in-out min-height;
 }
-.activity .add-note-btn .icon-comment {
-  opacity: 50;
-  filter: alpha(opacity=5000);
+.activity .post-box textarea:focus {
+  border-color: #66afe9;
+  outline: 0;
+  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
+  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
 }
-.activity .add-note-btn:hover.selected,
-.activity .add-note-btn.selected {
-  z-index: 1001;
-  border-color: #cdd9e6;
-  border-radius: 4px 4px 0 0;
-  border-bottom-color: #eff3f7;
+.activity .post-box textarea::-moz-placeholder {
+  color: #999999;
+  opacity: 1;
 }
-.activity form.add-note-form {
-  z-index: 1000;
-  position: absolute;
-  right: 0;
-  top: 25px;
-  background: #eff3f7;
-  padding: 10px;
-  border: 1px solid #cdd9e6;
+.activity .post-box textarea:-ms-input-placeholder {
+  color: #999999;
 }
-.activity form.add-note-form > textarea {
-  font-size: 13px;
-  max-width: 600px;
-  background: #fff;
-  border: 1px solid #cdd9e6;
-  font-weight: 300;
-  height: 80px;
-  margin: 0;
-  right: 0;
-  left: 0;
-  margin-bottom: 10px;
-  -webkit-box-shadow: none;
-  box-shadow: none;
+.activity .post-box textarea::-webkit-input-placeholder {
+  color: #999999;
 }
-.activity form.add-note-form > textarea::-moz-placeholder {
-  color: #dddddd;
+.activity .post-box textarea[disabled],
+.activity .post-box textarea[readonly],
+fieldset[disabled] .activity .post-box textarea {
+  cursor: not-allowed;
+  background-color: #eeeeee;
   opacity: 1;
 }
-.activity form.add-note-form > textarea:-ms-input-placeholder {
-  color: #dddddd;
-}
-.activity form.add-note-form > textarea::-webkit-input-placeholder {
-  color: #dddddd;
+textarea.activity .post-box textarea {
+  height: auto;
 }
-.activity form.add-note-form .form-actions {
-  text-align: right;
-  padding: 0;
-  margin: 0;
+.activity .post-box textarea.expanded {
+  min-height: 52px;
 }
 .seen-by {
   position: relative;
diff --git a/src/sentry/static/sentry/styles/sentry.css b/src/sentry/static/sentry/styles/sentry.css
index e5f7316b16..81b9028859 100644
--- a/src/sentry/static/sentry/styles/sentry.css
+++ b/src/sentry/static/sentry/styles/sentry.css
@@ -8243,26 +8243,29 @@ table.vars tbody > tr:nth-child(even) > th {
 }
 .activity > ul {
   list-style: none;
-  margin: 0 0 20px;
+  margin: 0 0 0;
   padding-left: 0;
 }
 .activity > ul > li {
-  margin-bottom: 5px;
-  line-height: 30px;
+  padding: 10px 0;
   position: relative;
-  padding-left: 20px;
+  padding-left: 24px;
+  border-bottom: 2px solid #f1f2f3;
+}
+.activity > ul > li:last-child {
+  border: 0;
 }
 .activity > ul > li .avatar {
   position: absolute;
   left: 0;
-  top: 4px;
+  top: 11px;
   width: 16px;
   height: 16px;
   display: block;
   background-size: 16px 16px;
   background-repeat: no-repeat;
   background-position: center center;
-  border-radius: 16px;
+  border-radius: 3px;
 }
 .activity > ul > li .avatar img {
   width: 16px;
@@ -8273,75 +8276,73 @@ table.vars tbody > tr:nth-child(even) > th {
 .activity > ul > li .avatar.sentry {
   background-image: url('../images/favicon.ico');
 }
-.activity > ul > li .avatar p {
+.activity > ul > li p {
   font-size: 12px;
+  margin-bottom: 10px;
+}
+.activity > ul > li p:last-child {
+  margin: 0;
 }
 .activity > ul > li .sep,
 .activity > ul > li .time {
   font-size: 12px;
   color: #aaa;
 }
-.activity .add-note-btn {
-  font-size: 12px;
-  font-weight: 300;
-  letter-spacing: -0.1px;
-  position: absolute;
-  right: 0;
-  top: 0;
-  padding: 2px 5px;
-  background: #eff3f7;
-  color: #666d73;
-  border: 1px solid #eff3f7;
+.activity .post-box {
+  margin: 0 0 5px;
+}
+.activity .post-box textarea {
+  display: block;
+  width: 100%;
+  height: 34px;
+  padding: 6px 12px;
+  font-size: 14px;
+  line-height: 1.42857143;
+  color: #465262;
+  background-color: #ffffff;
+  background-image: none;
+  border: 1px solid #cccccc;
   border-radius: 4px;
+  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
+  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
+  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
+  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
+  box-shadow: none;
+  height: auto;
+  border: 2px solid #e9eaea;
+  min-height: 36px;
+  margin: 0;
+  -webkit-transition: 0.15s ease-in-out min-height;
+  transition: 0.15s ease-in-out min-height;
 }
-.activity .add-note-btn .icon-comment {
-  opacity: 50;
-  filter: alpha(opacity=5000);
+.activity .post-box textarea:focus {
+  border-color: #66afe9;
+  outline: 0;
+  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
+  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
 }
-.activity .add-note-btn:hover.selected,
-.activity .add-note-btn.selected {
-  z-index: 1001;
-  border-color: #cdd9e6;
-  border-radius: 4px 4px 0 0;
-  border-bottom-color: #eff3f7;
+.activity .post-box textarea::-moz-placeholder {
+  color: #999999;
+  opacity: 1;
 }
-.activity form.add-note-form {
-  z-index: 1000;
-  position: absolute;
-  right: 0;
-  top: 25px;
-  background: #eff3f7;
-  padding: 10px;
-  border: 1px solid #cdd9e6;
+.activity .post-box textarea:-ms-input-placeholder {
+  color: #999999;
 }
-.activity form.add-note-form > textarea {
-  font-size: 13px;
-  max-width: 600px;
-  background: #fff;
-  border: 1px solid #cdd9e6;
-  font-weight: 300;
-  height: 80px;
-  margin: 0;
-  right: 0;
-  left: 0;
-  margin-bottom: 10px;
-  -webkit-box-shadow: none;
-  box-shadow: none;
+.activity .post-box textarea::-webkit-input-placeholder {
+  color: #999999;
 }
-.activity form.add-note-form > textarea::-moz-placeholder {
-  color: #dddddd;
+.activity .post-box textarea[disabled],
+.activity .post-box textarea[readonly],
+fieldset[disabled] .activity .post-box textarea {
+  cursor: not-allowed;
+  background-color: #eeeeee;
   opacity: 1;
 }
-.activity form.add-note-form > textarea:-ms-input-placeholder {
-  color: #dddddd;
-}
-.activity form.add-note-form > textarea::-webkit-input-placeholder {
-  color: #dddddd;
+textarea.activity .post-box textarea {
+  height: auto;
 }
-.activity form.add-note-form .form-actions {
-  text-align: right;
-  padding: 0;
-  margin: 0;
+.activity .post-box textarea.expanded {
+  min-height: 52px;
 }
 .seen-by {
   position: relative;
diff --git a/src/sentry/templates/sentry/groups/details.html b/src/sentry/templates/sentry/groups/details.html
index 50523ab0ca..1f3d9995ba 100644
--- a/src/sentry/templates/sentry/groups/details.html
+++ b/src/sentry/templates/sentry/groups/details.html
@@ -39,6 +39,16 @@
                     <h3>Activity</h3>
                 </div>
                 <div class="activity box-content with-padding" id="activity">
+                    <div class="post-box">
+                        <form class="add-note-form" method="POST" action=".">
+                            {% csrf_token %}
+                            <input type="hidden" name="o" value="note">
+                            {{ add_note_form.text }}
+                            <!-- <fieldset class="form-actions">
+                                <button type="submit" class="btn btn-small btn-primary">{% trans "Add Note" %}</button>
+                            </fieldset> -->
+                        </form>
+                    </div>
                     <ul>
                         {% for item in activity %}
                             {% with item|render_activity as out %}
@@ -48,15 +58,6 @@
                             {% endwith %}
                         {% endfor %}
                     </ul>
-                    <a href="#add-note" class="add-note-btn"><i class="icon-comment"></i> Add Note</a>
-                    <form class="add-note-form hide" method="POST" action=".">
-                        {% csrf_token %}
-                        <input type="hidden" name="o" value="note">
-                        {{ add_note_form.text }}
-                        <fieldset class="form-actions">
-                            <button type="submit" class="btn btn-small btn-primary">{% trans "Add Note" %}</button>
-                        </fieldset>
-                    </form>
                 </div>
             </div>
 
diff --git a/src/sentry/web/forms/__init__.py b/src/sentry/web/forms/__init__.py
index 3154ef8a55..ff554fa46c 100644
--- a/src/sentry/web/forms/__init__.py
+++ b/src/sentry/web/forms/__init__.py
@@ -64,7 +64,7 @@ class TestEmailForm(forms.Form):
 
 
 class NewNoteForm(forms.Form):
-    text = forms.CharField(widget=forms.Textarea(attrs={'class': 'span8'}))
+    text = forms.CharField(widget=forms.Textarea(attrs={'rows': '1', 'placeholder': 'Type a note and press enter...'}))
 
     def save(self, event, user):
         activity = Activity.objects.create(
