commit 25ee78b5475dfa47c234f504f0eb714ab197dffe
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jul 25 15:13:53 2017 -0400

    admin: basic quotas panel

diff --git a/src/sentry/api/endpoints/internal_quotas.py b/src/sentry/api/endpoints/internal_quotas.py
new file mode 100644
index 0000000000..12d11b82d9
--- /dev/null
+++ b/src/sentry/api/endpoints/internal_quotas.py
@@ -0,0 +1,22 @@
+from __future__ import absolute_import
+
+from django.conf import settings
+from rest_framework.response import Response
+
+from sentry import options
+from sentry.api.base import Endpoint
+from sentry.api.permissions import SuperuserPermission
+
+
+class InternalQuotasEndpoint(Endpoint):
+    permission_classes = (SuperuserPermission, )
+
+    def get(self, request):
+        return Response(
+            {
+                'backend': settings.SENTRY_QUOTAS,
+                'options': {
+                    'system.rate-limit': options.get('system.rate-limit'),
+                }
+            }
+        )
diff --git a/src/sentry/api/urls.py b/src/sentry/api/urls.py
index bbcbbe1efc..022e6d1a12 100644
--- a/src/sentry/api/urls.py
+++ b/src/sentry/api/urls.py
@@ -30,6 +30,7 @@ from .endpoints.group_tombstone import GroupTombstoneEndpoint
 from .endpoints.group_user_reports import GroupUserReportsEndpoint
 from .endpoints.index import IndexEndpoint
 from .endpoints.internal_queue_tasks import InternalQueueTasksEndpoint
+from .endpoints.internal_quotas import InternalQuotasEndpoint
 from .endpoints.internal_stats import InternalStatsEndpoint
 from .endpoints.legacy_project_redirect import LegacyProjectRedirectEndpoint
 from .endpoints.organization_access_request_details import OrganizationAccessRequestDetailsEndpoint
@@ -788,6 +789,7 @@ urlpatterns = patterns(
     url(
         r'^internal/options/$', SystemOptionsEndpoint.as_view(), name='sentry-api-0-system-options'
     ),
+    url(r'^internal/quotas/$', InternalQuotasEndpoint.as_view()),
     url(r'^internal/queue/tasks/$', InternalQueueTasksEndpoint.as_view()),
     url(r'^internal/stats/$', InternalStatsEndpoint.as_view(),
         name='sentry-api-0-internal-stats'),
diff --git a/src/sentry/static/sentry/app/routes.jsx b/src/sentry/static/sentry/app/routes.jsx
index 0b75a38e61..4f0a1c8228 100644
--- a/src/sentry/static/sentry/app/routes.jsx
+++ b/src/sentry/static/sentry/app/routes.jsx
@@ -9,6 +9,7 @@ import AdminOrganizations from './views/adminOrganizations';
 import AdminOverview from './views/adminOverview';
 import AdminProjects from './views/adminProjects';
 import AdminQueue from './views/adminQueue';
+import AdminQuotas from './views/adminQuotas';
 import AdminSettings from './views/adminSettings';
 import AdminUsers from './views/adminUsers';
 import ApiApplicationDetails from './views/apiApplicationDetails';
@@ -395,6 +396,7 @@ function routes() {
         <Route path="organizations/" component={errorHandler(AdminOrganizations)} />
         <Route path="projects/" component={errorHandler(AdminProjects)} />
         <Route path="queue/" component={errorHandler(AdminQueue)} />
+        <Route path="quotas/" component={errorHandler(AdminQuotas)} />
         <Route path="settings/" component={errorHandler(AdminSettings)} />
         <Route path="users/" component={errorHandler(AdminUsers)} />
         {hooksAdminRoutes}
diff --git a/src/sentry/static/sentry/app/views/adminLayout.jsx b/src/sentry/static/sentry/app/views/adminLayout.jsx
index e14d9aa19b..287b4ad80b 100644
--- a/src/sentry/static/sentry/app/views/adminLayout.jsx
+++ b/src/sentry/static/sentry/app/views/adminLayout.jsx
@@ -44,6 +44,9 @@ export default React.createClass({
                     <ListLink index={true} to="/manage/queue/">
                       Queue
                     </ListLink>
+                    <ListLink index={true} to="/manage/quotas/">
+                      Quotas
+                    </ListLink>
                     <li>
                       <a href="/manage/status/environment/">Environment</a>
                     </li>
diff --git a/src/sentry/static/sentry/app/views/adminQuotas.jsx b/src/sentry/static/sentry/app/views/adminQuotas.jsx
new file mode 100644
index 0000000000..e14efb69c9
--- /dev/null
+++ b/src/sentry/static/sentry/app/views/adminQuotas.jsx
@@ -0,0 +1,67 @@
+/*eslint getsentry/jsx-needs-il8n:0*/
+import React from 'react';
+
+import AsyncView from './asyncView';
+import {TextField} from '../components/forms';
+import InternalStatChart from '../components/internalStatChart';
+
+export default class AdminQuotas extends AsyncView {
+  getEndpoints() {
+    return [['config', '/internal/quotas/']];
+  }
+
+  getDefaultState() {
+    return {
+      since: new Date().getTime() / 1000 - 3600 * 24 * 7,
+      resolution: '1h'
+    };
+  }
+
+  renderBody() {
+    let {config} = this.state;
+    return (
+      <div>
+        <h3>Quotas</h3>
+
+        <div className="box">
+          <div className="box-header">
+            <h4>Config</h4>
+          </div>
+
+          <div className="box-content with-padding">
+            <TextField value={config.backend} label="Backend" disabled={true} />
+            <TextField
+              value={config.options['system.rate-limit']}
+              label="Rate Limit"
+              disabled={true}
+            />
+          </div>
+        </div>
+
+        <div className="box">
+          <div className="box-header">
+            <h4>Total Events</h4>
+          </div>
+          <InternalStatChart
+            since={this.state.since}
+            resolution={this.state.resolution}
+            stat="events.total"
+            label="Events"
+          />
+        </div>
+
+        <div className="box">
+          <div className="box-header">
+            <h4>Dropped Events</h4>
+          </div>
+          <InternalStatChart
+            since={this.state.since}
+            resolution={this.state.resolution}
+            stat="events.dropped"
+            label="Events"
+          />
+        </div>
+      </div>
+    );
+  }
+}
