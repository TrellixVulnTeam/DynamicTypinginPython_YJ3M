commit 0ebf48b8f24df9656d06ae368d31d642f18930c8
Author: Snyk bot <snyk-bot@users.noreply.github.com>
Date:   Tue Dec 19 21:26:26 2017 +0200

    [Snyk Update] New fixes for 1 vulnerable dependency path (#6659)
    
    * fix: package.json to reduce vulnerabilities
    
    The following vulnerabilities are fixed with an upgrade:
    - https://snyk.io/vuln/npm:moment:20170905
    
    Latest report for getsentry/sentry:
    https://snyk.io/test/github/getsentry/sentry
    
    * Get timezone back in formatted times
    
    Disclaimer: I don't know how timezones work and couldn't tell any difference when i changed my timezone in preferences, but this makes the tests pass and might be right.

diff --git a/package.json b/package.json
index ff8483ed95..3cd8fa25b9 100644
--- a/package.json
+++ b/package.json
@@ -51,7 +51,7 @@
     "mobx": "^3.2.2",
     "mobx-react": "^4.2.2",
     "mockdate": "2.0.2",
-    "moment": "2.10.6",
+    "moment": "2.19.3",
     "moment-timezone": "0.4.1",
     "node-libs-browser": "0.5.3",
     "platformicons": "0.1.1",
diff --git a/src/sentry/static/sentry/app/components/dateTime.jsx b/src/sentry/static/sentry/app/components/dateTime.jsx
index 18675e81f6..987a401b5a 100644
--- a/src/sentry/static/sentry/app/components/dateTime.jsx
+++ b/src/sentry/static/sentry/app/components/dateTime.jsx
@@ -1,6 +1,6 @@
 import PropTypes from 'prop-types';
 import React from 'react';
-import moment from 'moment';
+import moment from 'moment-timezone';
 import _ from 'lodash';
 
 import ConfigStore from '../stores/configStore';
@@ -54,7 +54,9 @@ const DateTime = React.createClass({
       date = new Date(date);
     }
 
-    return <time {...carriedProps}>{moment(date).format(format)}</time>;
+    return (
+      <time {...carriedProps}>{moment.tz(date, options.timezome).format(format)}</time>
+    );
   },
 });
 
diff --git a/src/sentry/static/sentry/app/components/timeSince.jsx b/src/sentry/static/sentry/app/components/timeSince.jsx
index cb2af2ba77..3bd4ba0df2 100644
--- a/src/sentry/static/sentry/app/components/timeSince.jsx
+++ b/src/sentry/static/sentry/app/components/timeSince.jsx
@@ -1,6 +1,6 @@
 import PropTypes from 'prop-types';
 import React from 'react';
-import moment from 'moment';
+import moment from 'moment-timezone';
 import _ from 'lodash';
 import PureRenderMixin from 'react-addons-pure-render-mixin';
 
@@ -76,11 +76,10 @@ const TimeSince = React.createClass({
     let user = ConfigStore.get('user');
     let options = user ? user.options : {};
     let format = options.clock24Hours ? 'MMMM D YYYY HH:mm:ss z' : 'LLL z';
-
     return (
       <time
         dateTime={date.toISOString()}
-        title={moment(date).format(format)}
+        title={moment.tz(date, options.timezone).format(format)}
         className={this.props.className}
       >
         {this.state.relative}
