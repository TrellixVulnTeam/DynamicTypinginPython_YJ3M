commit ca6a705f3956c22e8ab2413f7395e69141af2ab3
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Jan 8 12:40:09 2012 -0800

    Cleanup Sentry client JS to handle exceptions/tracebacks in more situations

diff --git a/sentry/static/scripts/client.js b/sentry/static/scripts/client.js
index e596fce444..bfa0acea44 100644
--- a/sentry/static/scripts/client.js
+++ b/sentry/static/scripts/client.js
@@ -101,6 +101,7 @@ if (Sentry === undefined) {
         var stack;
         var headers;
         var message = e.toString();
+        var fileurl;
 
         if (e.line) { // WebKit
             lineno = e.line;
@@ -112,10 +113,7 @@ if (Sentry === undefined) {
             fileurl = e.sourceURL;
         } else if (e.fileName) { // Mozilla
             fileurl = e.fileName;
-        } else {
-            fileurl = window.location.href;
         }
-
         if (e.stack) {
             try {
                 traceback = self.parseTraceback(e.stack);
@@ -134,7 +132,8 @@ if (Sentry === undefined) {
             stack = {
                 "frames": traceback
             };
-        } else {
+            fileurl = traceback[0].filename;
+        } else if (fileurl) {
             stack = {
                 "frames": [
                     {
@@ -147,7 +146,7 @@ if (Sentry === undefined) {
 
         var data = {
             "message": label,
-            "culprit": fileurl,
+            "culprit": fileurl || undefined,
             "sentry.interfaces.Stacktrace": stack || undefined,
             "sentry.interfaces.Exception": {
                 "type": e.name,
