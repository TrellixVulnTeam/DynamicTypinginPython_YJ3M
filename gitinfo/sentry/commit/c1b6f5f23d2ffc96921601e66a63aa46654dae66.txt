commit c1b6f5f23d2ffc96921601e66a63aa46654dae66
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Feb 18 09:57:08 2015 -0800

    Ensure APIKey vs ProjectKey diffs are handled

diff --git a/src/sentry/api/bases/organization.py b/src/sentry/api/bases/organization.py
index b0e4a28f0f..dae7946de8 100644
--- a/src/sentry/api/bases/organization.py
+++ b/src/sentry/api/bases/organization.py
@@ -16,6 +16,8 @@ class OrganizationPermission(ScopedPermission):
 
     def has_object_permission(self, request, view, organization):
         if request.auth:
+            if self.is_project_key(request):
+                return False
             return request.auth.organization_id == organization.organization_id
         if request.user.is_superuser:
             return True
diff --git a/src/sentry/api/bases/project.py b/src/sentry/api/bases/project.py
index f88bd871c6..02031cb54c 100644
--- a/src/sentry/api/bases/project.py
+++ b/src/sentry/api/bases/project.py
@@ -18,7 +18,10 @@ class ProjectPermission(ScopedPermission):
 
     def has_object_permission(self, request, view, project):
         if request.auth:
+            if self.is_project_key(request):
+                return request.auth.project_id == project.id
             return request.auth.organization_id == project.organization_id
+
         if request.user.is_superuser:
             return True
 
diff --git a/src/sentry/api/bases/team.py b/src/sentry/api/bases/team.py
index e706375ecf..9498f9430c 100644
--- a/src/sentry/api/bases/team.py
+++ b/src/sentry/api/bases/team.py
@@ -18,6 +18,8 @@ class TeamPermission(ScopedPermission):
 
     def has_object_permission(self, request, view, team):
         if request.auth:
+            if self.is_project_key(request):
+                return False
             return request.auth.organization_id == team.organization_id
         if request.user.is_superuser:
             return True
diff --git a/src/sentry/api/permissions.py b/src/sentry/api/permissions.py
index dd8deb154a..b7d15df617 100644
--- a/src/sentry/api/permissions.py
+++ b/src/sentry/api/permissions.py
@@ -11,6 +11,15 @@ class NoPermission(permissions.BasePermission):
 
 
 class ScopedPermission(permissions.BasePermission):
+    """
+    Permissions work depending on the type of authentication:
+
+    - A user inherits permissions based on their membership role. These are
+      still dictated as common scopes, but they can't be checked until the
+      has_object_permission hook is called.
+    - ProjectKeys (legacy) are granted only project based scopes. This
+    - APIKeys specify their scope, and work as expected.
+    """
     scope_map = {
         'GET': (),
         'POST': (),
