commit b4cea7664f17afad769741fa7f99a216d1c0a142
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Sep 3 14:10:37 2012 -0700

    5.0.0-dev: Only support Django 1.4

diff --git a/setup.py b/setup.py
index fe452ea5c4..e609c76716 100755
--- a/setup.py
+++ b/setup.py
@@ -51,7 +51,7 @@ install_requires = [
     'django-celery>=2.5.5',
     'celery>=2.5.3',
     'django-crispy-forms>=1.1.4',
-    'Django>=1.2,<1.5',
+    'Django>=1.4.1,<=1.5',
     'django-indexer>=0.3.0',
     'django-paging>=0.2.4',
     'django-picklefield>=0.2.0',
@@ -70,7 +70,7 @@ install_requires = [
 
 setup(
     name='sentry',
-    version='4.10.0',
+    version='5.0.0-dev',
     author='David Cramer',
     author_email='dcramer@gmail.com',
     url='http://www.getsentry.com',
diff --git a/src/sentry/models.py b/src/sentry/models.py
index c91c8495dd..ee7c551bcd 100644
--- a/src/sentry/models.py
+++ b/src/sentry/models.py
@@ -13,6 +13,7 @@ import math
 import time
 import uuid
 import urlparse
+
 from datetime import datetime
 from hashlib import md5
 from indexer.models import BaseIndex
@@ -27,6 +28,7 @@ from django.db.models.signals import post_syncdb, post_save, pre_delete, \
 from django.template.defaultfilters import slugify
 from django.utils.datastructures import SortedDict
 from django.utils.encoding import smart_unicode
+from django.utils.timezone import now
 from django.utils.translation import ugettext_lazy as _
 
 from sentry.conf import settings
@@ -110,7 +112,7 @@ class TeamMember(Model):
     user = models.ForeignKey(User, related_name="sentry_teammember_set")
     is_active = models.BooleanField(default=True)
     type = models.IntegerField(choices=MEMBER_TYPES, default=globals().get(settings.DEFAULT_PROJECT_ACCESS))
-    date_added = models.DateTimeField(default=datetime.now)
+    date_added = models.DateTimeField(default=now)
 
     objects = BaseManager()
 
@@ -134,7 +136,7 @@ class Project(Model):
     owner = models.ForeignKey(User, related_name="sentry_owned_project_set", null=True)
     team = models.ForeignKey(Team, null=True)
     public = models.BooleanField(default=settings.ALLOW_PUBLIC_PROJECTS)
-    date_added = models.DateTimeField(default=datetime.now)
+    date_added = models.DateTimeField(default=now)
     status = models.PositiveIntegerField(default=0, choices=(
         (0, 'Visible'),
         (1, 'Hidden'),
@@ -287,7 +289,7 @@ class PendingTeamMember(Model):
     team = models.ForeignKey(Team, related_name="pending_member_set")
     email = models.EmailField()
     type = models.IntegerField(choices=MEMBER_TYPES, default=globals().get(settings.DEFAULT_PROJECT_ACCESS))
-    date_added = models.DateTimeField(default=datetime.now)
+    date_added = models.DateTimeField(default=now)
 
     objects = BaseManager()
 
@@ -389,8 +391,8 @@ class Group(MessageBase):
     """
     status = models.PositiveIntegerField(default=0, choices=STATUS_LEVELS, db_index=True)
     times_seen = models.PositiveIntegerField(default=1, db_index=True)
-    last_seen = models.DateTimeField(default=datetime.now, db_index=True)
-    first_seen = models.DateTimeField(default=datetime.now, db_index=True)
+    last_seen = models.DateTimeField(default=now, db_index=True)
+    first_seen = models.DateTimeField(default=now, db_index=True)
     resolved_at = models.DateTimeField(null=True, db_index=True)
     # active_at should be the same as first_seen by default
     active_at = models.DateTimeField(null=True, db_index=True)
@@ -480,7 +482,7 @@ class Event(MessageBase):
     """
     group = models.ForeignKey(Group, blank=True, null=True, related_name="event_set")
     event_id = models.CharField(max_length=32, null=True, db_column="message_id")
-    datetime = models.DateTimeField(default=datetime.now, db_index=True)
+    datetime = models.DateTimeField(default=now, db_index=True)
     time_spent = models.FloatField(null=True)
     server_name = models.CharField(max_length=128, db_index=True, null=True)
     site = models.CharField(max_length=128, db_index=True, null=True)
@@ -625,8 +627,8 @@ class MessageFilterValue(Model):
     times_seen = models.PositiveIntegerField(default=0)
     key = models.CharField(choices=FILTER_KEYS, max_length=32)
     value = models.CharField(max_length=200)
-    last_seen = models.DateTimeField(default=datetime.now, db_index=True, null=True)
-    first_seen = models.DateTimeField(default=datetime.now, db_index=True, null=True)
+    last_seen = models.DateTimeField(default=now, db_index=True, null=True)
+    first_seen = models.DateTimeField(default=now, db_index=True, null=True)
 
     objects = BaseManager()
 
@@ -690,8 +692,8 @@ class SearchDocument(Model):
     group = models.ForeignKey(Group)
     total_events = models.PositiveIntegerField(default=1)
     status = models.PositiveIntegerField(default=0)
-    date_added = models.DateTimeField(default=datetime.now)
-    date_changed = models.DateTimeField(default=datetime.now)
+    date_added = models.DateTimeField(default=now)
+    date_changed = models.DateTimeField(default=now)
 
     objects = SearchDocumentManager()
 
diff --git a/src/sentry/utils/compat/db.py b/src/sentry/utils/compat/db.py
deleted file mode 100644
index 2370557667..0000000000
--- a/src/sentry/utils/compat/db.py
+++ /dev/null
@@ -1,27 +0,0 @@
-"""
-sentry.utils.db
-~~~~~~~~~~~~~~~
-
-:copyright: (c) 2010-2012 by the Sentry Team, see AUTHORS for more details.
-:license: BSD, see LICENSE for more details.
-"""
-
-from django.conf import settings
-try:
-    from django.db import connections
-    dbconf = settings.DATABASES
-except ImportError:
-    # Compat with < Django 1.2
-    from django.db import connection
-    connections = {'default': connection}  # NOQA
-    dbconf = {
-        'default': {
-            'ENGINE': settings.DATABASE_ENGINE,
-            'NAME': settings.DATABASE_NAME,
-            'HOST': settings.DATABASE_HOST,
-            'USER': settings.DATABASE_USER,
-            'PASSWORD': settings.DATABASE_PASSWORD,
-            'TEST_NAME': settings.DATABASE_TEST_NAME,
-            'OPTIONS': settings.DATABASE_OPTIONS
-        }
-    }
diff --git a/tests/base.py b/tests/base.py
index 678b69768e..bc75572370 100644
--- a/tests/base.py
+++ b/tests/base.py
@@ -7,14 +7,13 @@ from sentry.conf import settings
 from sentry.utils import json
 from sentry.utils.auth import get_signature, get_auth_header
 from sentry.utils.compat import pickle
-from sentry.utils.compat.db import connections
 
 
 from django.conf import settings as django_settings
 from django.core.cache import cache
 from django.core.management import call_command
 from django.core.urlresolvers import reverse
-from django.db import DEFAULT_DB_ALIAS
+from django.db import connections, DEFAULT_DB_ALIAS
 from django.test import TestCase, TransactionTestCase
 from django.test.client import Client
 
