commit 8f06833a2a6a1d6010be346c0b8ff6969f95daa8
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Thu Dec 14 16:43:37 2017 -0800

    feat(ui): Change team settings route hierarchy (#6748)
    
    Change team settings route hierarchy so that navigation is active works
    as expected without path regexes.
    
    Change "your teams" to have an explicit route path (previously was just
    index route for "teams/")

diff --git a/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx b/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx
index 0db0db7b6f..bbe94dcb08 100644
--- a/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx
@@ -129,17 +129,7 @@ const HomeSidebar = React.createClass({
           >
             {t('Dashboard')}
           </ListLink>
-          <ListLink
-            to={`${pathPrefix}/teams/`}
-            isActive={() => {
-              // return true if path matches /organizations/slug-name/teams/ OR /organizations/slug-name/all-teams/
-              return /^\/organizations\/[^\/]+\/(teams|all-teams)\/$/.test(
-                this.context.location.pathname
-              );
-            }}
-          >
-            {t('Projects & Teams')}
-          </ListLink>
+          <ListLink to={`${pathPrefix}/teams/`}>{t('Projects & Teams')}</ListLink>
           {access.has('org:read') && (
             <ListLink to={`${pathPrefix}/stats/`}>{t('Stats')}</ListLink>
           )}
diff --git a/src/sentry/static/sentry/app/routes.jsx b/src/sentry/static/sentry/app/routes.jsx
index 063cc6ecf4..0b75a38e61 100644
--- a/src/sentry/static/sentry/app/routes.jsx
+++ b/src/sentry/static/sentry/app/routes.jsx
@@ -189,31 +189,32 @@ const orgSettingsRoutes = [
     component={errorHandler(OrganizationGeneralSettingsView)}
   />,
 
-  <Route
-    key="team-details"
-    name="Teams"
-    path="teams/:teamId/"
-    component={errorHandler(TeamDetails)}
-  >
-    <IndexRedirect to="settings/" />
-    <Route path="settings/" name="Settings" component={errorHandler(TeamSettings)} />
-    <Route path="members/" name="Members" component={errorHandler(TeamMembers)} />
-  </Route>,
+  <Route key="teams" name="Project & Teams" path="teams/">
+    <IndexRedirect to="your-teams" />
+    <Route
+      path="all-teams/"
+      name="All Teams"
+      allTeams
+      component={errorHandler(OrganizationTeams)}
+    />
 
-  <Route
-    key="teams"
-    path="teams/"
-    name="Teams"
-    component={errorHandler(OrganizationTeams)}
-  />,
+    <Route
+      name="Your Teams"
+      path="your-teams/"
+      component={errorHandler(OrganizationTeams)}
+    />
 
-  <Route
-    key="all-teams"
-    path="all-teams/"
-    name="All Teams"
-    allTeams
-    component={errorHandler(OrganizationTeams)}
-  />,
+    <Route
+      key="team-details"
+      name="Team"
+      path=":teamId/"
+      component={errorHandler(TeamDetails)}
+    >
+      <IndexRedirect to="settings/" />
+      <Route path="settings/" name="Settings" component={errorHandler(TeamSettings)} />
+      <Route path="members/" name="Members" component={errorHandler(TeamMembers)} />
+    </Route>
+  </Route>,
 
   <Route
     key="org-stats"
diff --git a/src/sentry/static/sentry/app/views/organizationTeams/organizationTeamsView.jsx b/src/sentry/static/sentry/app/views/organizationTeams/organizationTeamsView.jsx
index 496d52f5a6..085bc5f15b 100644
--- a/src/sentry/static/sentry/app/views/organizationTeams/organizationTeamsView.jsx
+++ b/src/sentry/static/sentry/app/views/organizationTeams/organizationTeamsView.jsx
@@ -38,15 +38,15 @@ class OrganizationTeamsView extends React.Component {
 
     if (!organization) return null;
 
-    let urlPrefix = recreateRoute('', {routes, params, stepBack: -1});
+    let urlPrefix = recreateRoute('', {routes, params, stepBack: -2});
 
     return (
       <div className="row">
         <div className="col-md-9">
           <div className="team-list">
             <ul className="nav nav-tabs border-bottom">
-              <ListLink to={`${urlPrefix}teams/`}>{t('Your Teams')}</ListLink>
-              <ListLink to={`${urlPrefix}all-teams/`}>
+              <ListLink to={`${urlPrefix}teams/your-teams/`}>{t('Your Teams')}</ListLink>
+              <ListLink to={`${urlPrefix}teams/all-teams/`}>
                 {t('All Teams')}{' '}
                 <span className="badge badge-soft">{allTeams.length}</span>
               </ListLink>
diff --git a/src/sentry/static/sentry/app/views/settings/team/organizationTeamsView.jsx b/src/sentry/static/sentry/app/views/settings/team/organizationTeamsView.jsx
index b518b2e72e..8134dfd8ce 100644
--- a/src/sentry/static/sentry/app/views/settings/team/organizationTeamsView.jsx
+++ b/src/sentry/static/sentry/app/views/settings/team/organizationTeamsView.jsx
@@ -37,13 +37,14 @@ class OrganizationTeamsView extends React.Component {
 
     if (!organization) return null;
 
-    let urlPrefix = recreateRoute('', {routes, params, stepBack: -1});
+    let teamRoute = routes.find(({path}) => path === 'teams/');
+    let urlPrefix = recreateRoute(teamRoute, {routes, params, stepBack: -1});
 
     return (
       <div className="team-list">
         <ul className="nav nav-tabs border-bottom">
-          <ListLink to={`${urlPrefix}teams/`}>{t('Your Teams')}</ListLink>
-          <ListLink to={`${urlPrefix}all-teams/`}>
+          <ListLink to={`${urlPrefix}teams/your-teams/`}>{t('Your Teams')}</ListLink>
+          <ListLink to={`${urlPrefix}teams/all-teams/`}>
             {t('All Teams')} <span className="badge badge-soft">{allTeams.length}</span>
           </ListLink>
         </ul>
diff --git a/src/sentry/static/sentry/app/views/settings/team/teamMembers.jsx b/src/sentry/static/sentry/app/views/settings/team/teamMembers.jsx
index 9f29dda7a3..592b84842a 100644
--- a/src/sentry/static/sentry/app/views/settings/team/teamMembers.jsx
+++ b/src/sentry/static/sentry/app/views/settings/team/teamMembers.jsx
@@ -7,7 +7,6 @@ import Button from '../../../components/buttons/button';
 import LoadingError from '../../../components/loadingError';
 import LoadingIndicator from '../../../components/loadingIndicator';
 import OrganizationState from '../../../mixins/organizationState';
-import recreateRoute from '../../../utils/recreateRoute';
 import {t} from '../../../locale';
 
 const TeamMembers = React.createClass({
@@ -65,7 +64,7 @@ const TeamMembers = React.createClass({
     if (this.state.loading) return <LoadingIndicator />;
     else if (this.state.error) return <LoadingError onRetry={this.fetchData} />;
 
-    let {params, routes} = this.props;
+    let {params} = this.props;
 
     let access = this.getAccess();
 
@@ -77,7 +76,7 @@ const TeamMembers = React.createClass({
               priority="primary"
               size="small"
               className="pull-right"
-              to={`${recreateRoute('members/new/', {routes, params, stepBack: -2})}`}
+              to={`/settings/organization/${params.orgId}/members/new/`}
             >
               <span className="icon-plus" /> {t('Invite Member')}
             </Button>
@@ -110,11 +109,7 @@ const TeamMembers = React.createClass({
                     <Avatar user={member} size={80} />
                     <h5>
                       <Link
-                        to={`${recreateRoute(`members/${member.id}`, {
-                          routes,
-                          params,
-                          stepBack: -2,
-                        })}`}
+                        to={`/settings/organization/${params.orgId}/members/${member.id}`}
                       >
                         {member.email}
                       </Link>
