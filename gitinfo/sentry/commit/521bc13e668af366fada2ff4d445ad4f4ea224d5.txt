commit 521bc13e668af366fada2ff4d445ad4f4ea224d5
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Nov 13 11:03:08 2015 -0800

    Ensure upgrade merges/ignores ghost migrations

diff --git a/src/sentry/management/commands/upgrade.py b/src/sentry/management/commands/upgrade.py
index 621364c309..6ce37b51f5 100644
--- a/src/sentry/management/commands/upgrade.py
+++ b/src/sentry/management/commands/upgrade.py
@@ -28,7 +28,15 @@ class Command(BaseCommand):
     def handle(self, **options):
         call_command(
             'syncdb',
-            migrate=True,
+            interactive=(not options['noinput']),
+            traceback=options['traceback'],
+            verbosity=options['verbosity'],
+        )
+
+        call_command(
+            'migrate',
+            merge=True,
+            ignore_ghost_migrations=True,
             interactive=(not options['noinput']),
             traceback=options['traceback'],
             verbosity=options['verbosity'],
