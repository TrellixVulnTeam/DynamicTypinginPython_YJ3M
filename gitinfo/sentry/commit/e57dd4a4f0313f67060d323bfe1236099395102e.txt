commit e57dd4a4f0313f67060d323bfe1236099395102e
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Dec 5 12:27:16 2014 -0800

    Add sidebar to org admin

diff --git a/src/sentry/templates/sentry/bases/organization.html b/src/sentry/templates/sentry/bases/organization.html
index 49dbda337c..437f67b725 100644
--- a/src/sentry/templates/sentry/bases/organization.html
+++ b/src/sentry/templates/sentry/bases/organization.html
@@ -33,9 +33,6 @@
           {% trans "Admin" %}
         </a>
       </li>
-      {% block organization_nav %}
-        {% comment %}This block is utilized by getsentry.com{% endcomment %}
-      {% endblock %}
     </ul>
 
     {% if request.user|needs_access_group_migration:organization %}
diff --git a/src/sentry/templates/sentry/bases/organization_settings.html b/src/sentry/templates/sentry/bases/organization_settings.html
new file mode 100644
index 0000000000..3a5d9ebe51
--- /dev/null
+++ b/src/sentry/templates/sentry/bases/organization_settings.html
@@ -0,0 +1,28 @@
+{% extends "sentry/bases/organization.html" %}
+
+{% load crispy_forms_tags %}
+{% load i18n %}
+
+{% block org_settings_nav %}active{% endblock %}
+
+{% block inner %}
+  <div class="row">
+    <div class="span" style="width:600px">
+      {% block org_settings_inner %}{% endblock %}
+    </div>
+
+    <div class="span" style="width:220px">
+      <ul class="nav nav-list">
+        <li class="nav-header">{% trans "Organization" %}</li>
+        <li class="{% block org_sidebar_settings_nav %}{% endblock %}">
+          <a href="{% url 'sentry-organization-settings' organization.id %}">{% trans "Settings" %}</a>
+        </li>
+        <li class="{% block org_sidebar_remove_nav %}{% endblock %}">
+          <a href="{% url 'sentry-remove-organization' organization.id %}">{% trans "Remove Organization" %}</a>
+        </li>
+        {% block org_sidebar_nav_extra %}
+          {% comment %}This block is utilized by getsentry.com{% endcomment %}
+        {% endblock %}
+      </ul>
+    </div>
+{% endblock %}
diff --git a/src/sentry/templates/sentry/organization-settings.html b/src/sentry/templates/sentry/organization-settings.html
index cc9ff0e1aa..d86b6d6cae 100644
--- a/src/sentry/templates/sentry/organization-settings.html
+++ b/src/sentry/templates/sentry/organization-settings.html
@@ -1,11 +1,11 @@
-{% extends "sentry/bases/organization.html" %}
+{% extends "sentry/bases/organization_settings.html" %}
 
 {% load crispy_forms_tags %}
 {% load i18n %}
 
-{% block org_settings_nav %}active{% endblock %}
+{% block org_sidebar_settings_nav %}active{% endblock %}
 
-{% block inner %}
+{% block org_settings_inner %}
   <form class="form-stacked" action="" method="post">
     {% csrf_token %}
 
@@ -23,7 +23,6 @@
     </fieldset>
 
     <fieldset class="form-actions">
-      <a href="{% url 'sentry-remove-organization' organization.id %}" class="btn btn-danger">{% trans "Remove Organization" %}</a>
       <button type="submit" class="btn btn-primary">{% trans "Save Changes" %}</button>
     </fieldset>
   </form>
diff --git a/src/sentry/templates/sentry/remove-organization.html b/src/sentry/templates/sentry/remove-organization.html
index 7caf92ff32..fa5a884cde 100644
--- a/src/sentry/templates/sentry/remove-organization.html
+++ b/src/sentry/templates/sentry/remove-organization.html
@@ -1,18 +1,15 @@
-{% extends "sentry/bases/organization.html" %}
+{% extends "sentry/bases/organization_settings.html" %}
 
 {% load crispy_forms_tags %}
 {% load i18n %}
 
-{% block org_settings_nav %}active{% endblock %}
+{% block org_sidebar_remove_nav %}active{% endblock %}
 
-{% block inner %}
-  <div class="page-header">
-    <h3>{% trans "Remove Organization" %}</h3>
-  </div>
+{% block org_settings_inner %}
   <form class="form-stacked" action="" method="post">
     {% csrf_token %}
 
-    <p>{% trans "Removing this organization is permanent and cannot be undone!" %}</p>
+    <p><strong>{% trans "Removing this organization is permanent and cannot be undone!" %}</strong></p>
 
     {% if team_list %}
       <p>{% trans "This will also remove the following teams and all associated data:" %}</p>
diff --git a/src/sentry/web/frontend/base.py b/src/sentry/web/frontend/base.py
index 23e25a88e1..089f106512 100644
--- a/src/sentry/web/frontend/base.py
+++ b/src/sentry/web/frontend/base.py
@@ -8,7 +8,6 @@ from django.http import HttpResponseRedirect
 from django.utils.decorators import method_decorator
 from django.views.decorators.csrf import csrf_protect
 from django.views.generic import View
-from sudo.utils import has_sudo_privileges
 from sudo.views import redirect_to_sudo
 
 from sentry.models import Organization, Project, Team
@@ -132,7 +131,7 @@ class BaseView(View, OrganizationMixin):
             request.session['_next'] = request.get_full_path()
             return self.redirect(get_login_url())
 
-        if self.sudo_required and not has_sudo_privileges(request):
+        if self.sudo_required and not request.is_sudo():
             return redirect_to_sudo(request.get_full_path())
 
         args, kwargs = self.convert_args(request, *args, **kwargs)
