commit 21547240749407b56f3bcb5da3482b370eda1457
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jul 1 15:31:43 2015 -0700

    Create activity entries for releases

diff --git a/src/sentry/api/endpoints/project_releases.py b/src/sentry/api/endpoints/project_releases.py
index 8c5b5867bb..ddb297ecdf 100644
--- a/src/sentry/api/endpoints/project_releases.py
+++ b/src/sentry/api/endpoints/project_releases.py
@@ -8,7 +8,7 @@ from rest_framework.response import Response
 from sentry.api.base import DocSection
 from sentry.api.bases.project import ProjectEndpoint
 from sentry.api.serializers import serialize
-from sentry.models import Release
+from sentry.models import Activity, Release
 
 
 class ReleaseSerializer(serializers.Serializer):
@@ -74,6 +74,14 @@ class ProjectReleasesEndpoint(ProjectEndpoint):
                     return Response({
                         'detail': 'Release with version already exists'
                     }, status=400)
+                else:
+                    Activity.objects.create(
+                        type=Activity.RELEASE,
+                        project=project,
+                        ident=result['version'],
+                        data={'version': result['version']},
+                        datetime=release.date_released,
+                    )
 
             return Response(serialize(release, request.user), status=201)
         return Response(serializer.errors, status=400)
diff --git a/src/sentry/event_manager.py b/src/sentry/event_manager.py
index d18c6ccbfd..101afdaf1b 100644
--- a/src/sentry/event_manager.py
+++ b/src/sentry/event_manager.py
@@ -26,7 +26,8 @@ from sentry.constants import (
 )
 from sentry.interfaces.base import get_interface
 from sentry.models import (
-    Event, EventMapping, Group, GroupHash, GroupStatus, Project, Release
+    Activity, Event, EventMapping, Group, GroupHash, GroupStatus, Project,
+    Release
 )
 from sentry.plugins import plugins
 from sentry.signals import regression_signal
@@ -325,10 +326,21 @@ class EventManager(object):
             # TODO(dcramer): we should ensure we create Release objects
             tags.append(('sentry:release', release))
 
-            group_kwargs['first_release'] = Release.objects.get_or_create(
+            group_kwargs['first_release'], created = Release.objects.get_or_create(
                 project=project,
                 version=release,
-            )[0]
+                defaults={
+                    'date_created': date,
+                },
+            )
+
+            Activity.objects.create(
+                type=Activity.RELEASE,
+                project=project,
+                ident=release,
+                data={'version': release},
+                datetime=date,
+            )
 
         for plugin in plugins.for_project(project, version=None):
             added_tags = safe_execute(plugin.get_tags, event,
diff --git a/src/sentry/plugins/interfaces/releasehook.py b/src/sentry/plugins/interfaces/releasehook.py
index a8eaf163d0..c471f63af8 100644
--- a/src/sentry/plugins/interfaces/releasehook.py
+++ b/src/sentry/plugins/interfaces/releasehook.py
@@ -12,7 +12,7 @@ __all__ = ['ReleaseHook']
 
 from django.utils import timezone
 
-from sentry.models import Release
+from sentry.models import Activity, Release
 
 
 class ReleaseHook(object):
@@ -34,6 +34,13 @@ class ReleaseHook(object):
             project=self.project,
             values=values,
         )
+        Activity.objects.create(
+            type=Activity.RELEASE,
+            project=self.project,
+            ident=version,
+            data={'version': version},
+            datetime=values['date_released'],
+        )
 
     def handle(self, request):
         raise NotImplementedError
diff --git a/src/sentry/templatetags/sentry_activity.py b/src/sentry/templatetags/sentry_activity.py
index 4f34113cfe..2be01dc892 100644
--- a/src/sentry/templatetags/sentry_activity.py
+++ b/src/sentry/templatetags/sentry_activity.py
@@ -32,6 +32,7 @@ ACTIVITY_ACTION_STRINGS = {
     Activity.FIRST_SEEN: 'first saw this event',
     Activity.ASSIGNED: 'assigned this event to {user:s}',
     Activity.UNASSIGNED: 'unassigned this event',
+    Activity.RELEASE: 'saw a new release: {version:s}',
 }
 
 
