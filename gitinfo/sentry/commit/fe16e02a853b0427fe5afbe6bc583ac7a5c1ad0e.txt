commit fe16e02a853b0427fe5afbe6bc583ac7a5c1ad0e
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Mon Jan 14 15:00:55 2019 -0800

    fix(ui): Fix header stacking (#11511)
    
    Global selection header needs to be below the sidebar for the org / user
    menu to stack correctly
    
    Also ensures the error wrapper sits above all other components

diff --git a/src/sentry/static/sentry/app/components/organizations/header.jsx b/src/sentry/static/sentry/app/components/organizations/header.jsx
index 01c0c6c654..3bc5c40d09 100644
--- a/src/sentry/static/sentry/app/components/organizations/header.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/header.jsx
@@ -6,7 +6,7 @@ const Header = styled(Flex)`
   box-shadow: ${p => p.theme.dropShadowLight};
   font-size: ${p => p.theme.fontSizeExtraLarge};
   height: 60px;
-  z-index: ${p => p.theme.zIndex.sidebar};
+  z-index: ${p => p.theme.zIndex.globalSelectionHeader};
   position: relative;
   width: 100%;
   background: #fff;
diff --git a/src/sentry/static/sentry/app/utils/theme.jsx b/src/sentry/static/sentry/app/utils/theme.jsx
index 24e25884c7..30170ba1b4 100644
--- a/src/sentry/static/sentry/app/utils/theme.jsx
+++ b/src/sentry/static/sentry/app/utils/theme.jsx
@@ -64,10 +64,11 @@ const theme = {
   background: '#fff',
 
   zIndex: {
-    orgAndUserMenu: 1003,
-    sidebar: 1002,
-    header: 1000,
+    orgAndUserMenu: 1004,
+    globalSelectionHeader: 1002,
+    sidebar: 1003,
     dropdown: 1001,
+    header: 1000,
     modal: 10000,
     toast: 10001,
     dropdownAutocomplete: {
diff --git a/src/sentry/static/sentry/less/layout.less b/src/sentry/static/sentry/less/layout.less
index fb651b24ba..acce1accde 100644
--- a/src/sentry/static/sentry/less/layout.less
+++ b/src/sentry/static/sentry/less/layout.less
@@ -23,7 +23,7 @@ body {
       margin: 0;
     }
     .sentry-error-embed-wrapper {
-      z-index: 1000;
+      z-index: 1005;
     }
   }
 
diff --git a/tests/js/spec/components/sidebar/__snapshots__/index.spec.jsx.snap b/tests/js/spec/components/sidebar/__snapshots__/index.spec.jsx.snap
index 66c364c2f0..92f0014153 100644
--- a/tests/js/spec/components/sidebar/__snapshots__/index.spec.jsx.snap
+++ b/tests/js/spec/components/sidebar/__snapshots__/index.spec.jsx.snap
@@ -168,7 +168,7 @@ exports[`Sidebar SidebarDropdown can open Sidebar org/name dropdown menu 1`] = `
   }
 >
   <div
-    className="css-14uk1a6-OrgAndUserMenu-SidebarDropdownMenu e1fowdfw9"
+    className="css-1ldvedv-OrgAndUserMenu-SidebarDropdownMenu e1fowdfw9"
     onClick={[Function]}
     onMouseEnter={[Function]}
     onMouseLeave={[Function]}
@@ -1290,11 +1290,11 @@ exports[`Sidebar can have onboarding feature 1`] = `
     collapsed={false}
   >
     <Component
-      className="css-1q74azb-StyledSidebarPanel-getPositionForOrientation e1cvaskl0"
+      className="css-1qwi75e-StyledSidebarPanel-getPositionForOrientation e1cvaskl0"
       collapsed={false}
     >
       <div
-        className="css-1q74azb-StyledSidebarPanel-getPositionForOrientation e1cvaskl0"
+        className="css-1qwi75e-StyledSidebarPanel-getPositionForOrientation e1cvaskl0"
       >
         <SidebarPanelHeader>
           <div
@@ -1717,7 +1717,7 @@ exports[`Sidebar renders without org and router 1`] = `
   org={null}
 >
   <div
-    className="css-14uk1a6-OrgAndUserMenu-SidebarDropdownMenu e1fowdfw9"
+    className="css-1ldvedv-OrgAndUserMenu-SidebarDropdownMenu e1fowdfw9"
     onClick={[Function]}
     onMouseEnter={[Function]}
     onMouseLeave={[Function]}
diff --git a/tests/js/spec/views/__snapshots__/organizationsDetails.spec.jsx.snap b/tests/js/spec/views/__snapshots__/organizationsDetails.spec.jsx.snap
index 51be542324..43987de750 100644
--- a/tests/js/spec/views/__snapshots__/organizationsDetails.spec.jsx.snap
+++ b/tests/js/spec/views/__snapshots__/organizationsDetails.spec.jsx.snap
@@ -5,7 +5,7 @@ exports[`OrganizationDetails render() deletion in progress should render a delet
   class="app"
 >
   <div
-    class="css-11c8i4p-StyledSidebar-responsiveFlex e1sgxx350"
+    class="css-5cf61n-StyledSidebar-responsiveFlex e1sgxx350"
   >
     <div
       class="css-1uxlgm0-SidebarSectionGroup-responsiveFlex e1sgxx351"
@@ -481,7 +481,7 @@ exports[`OrganizationDetails render() pending deletion should render a restorati
   class="app"
 >
   <div
-    class="css-11c8i4p-StyledSidebar-responsiveFlex e1sgxx350"
+    class="css-5cf61n-StyledSidebar-responsiveFlex e1sgxx350"
   >
     <div
       class="css-1uxlgm0-SidebarSectionGroup-responsiveFlex e1sgxx351"
@@ -984,7 +984,7 @@ exports[`OrganizationDetails render() pending deletion should render a restorati
   class="app"
 >
   <div
-    class="css-11c8i4p-StyledSidebar-responsiveFlex e1sgxx350"
+    class="css-5cf61n-StyledSidebar-responsiveFlex e1sgxx350"
   >
     <div
       class="css-1uxlgm0-SidebarSectionGroup-responsiveFlex e1sgxx351"
diff --git a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap
index 9d899f0412..ffbeef66d6 100644
--- a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap
+++ b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap
@@ -759,10 +759,11 @@ exports[`OrganizationIntegrations render() with installed integrations Displays
                                                     "actor": 1008,
                                                     "menu": 1007,
                                                   },
+                                                  "globalSelectionHeader": 1002,
                                                   "header": 1000,
                                                   "modal": 10000,
-                                                  "orgAndUserMenu": 1003,
-                                                  "sidebar": 1002,
+                                                  "orgAndUserMenu": 1004,
+                                                  "sidebar": 1003,
                                                   "toast": 10001,
                                                 },
                                               }
@@ -1025,10 +1026,11 @@ exports[`OrganizationIntegrations render() with installed integrations Displays
                                                             "actor": 1008,
                                                             "menu": 1007,
                                                           },
+                                                          "globalSelectionHeader": 1002,
                                                           "header": 1000,
                                                           "modal": 10000,
-                                                          "orgAndUserMenu": 1003,
-                                                          "sidebar": 1002,
+                                                          "orgAndUserMenu": 1004,
+                                                          "sidebar": 1003,
                                                           "toast": 10001,
                                                         },
                                                       }
@@ -2173,10 +2175,11 @@ exports[`OrganizationIntegrations render() with installed integrations Displays
                                                     "actor": 1008,
                                                     "menu": 1007,
                                                   },
+                                                  "globalSelectionHeader": 1002,
                                                   "header": 1000,
                                                   "modal": 10000,
-                                                  "orgAndUserMenu": 1003,
-                                                  "sidebar": 1002,
+                                                  "orgAndUserMenu": 1004,
+                                                  "sidebar": 1003,
                                                   "toast": 10001,
                                                 },
                                               }
@@ -2439,10 +2442,11 @@ exports[`OrganizationIntegrations render() with installed integrations Displays
                                                             "actor": 1008,
                                                             "menu": 1007,
                                                           },
+                                                          "globalSelectionHeader": 1002,
                                                           "header": 1000,
                                                           "modal": 10000,
-                                                          "orgAndUserMenu": 1003,
-                                                          "sidebar": 1002,
+                                                          "orgAndUserMenu": 1004,
+                                                          "sidebar": 1003,
                                                           "toast": 10001,
                                                         },
                                                       }
@@ -3888,10 +3892,11 @@ exports[`OrganizationIntegrations render() without integrations Displays integra
                                                     "actor": 1008,
                                                     "menu": 1007,
                                                   },
+                                                  "globalSelectionHeader": 1002,
                                                   "header": 1000,
                                                   "modal": 10000,
-                                                  "orgAndUserMenu": 1003,
-                                                  "sidebar": 1002,
+                                                  "orgAndUserMenu": 1004,
+                                                  "sidebar": 1003,
                                                   "toast": 10001,
                                                 },
                                               }
@@ -4154,10 +4159,11 @@ exports[`OrganizationIntegrations render() without integrations Displays integra
                                                             "actor": 1008,
                                                             "menu": 1007,
                                                           },
+                                                          "globalSelectionHeader": 1002,
                                                           "header": 1000,
                                                           "modal": 10000,
-                                                          "orgAndUserMenu": 1003,
-                                                          "sidebar": 1002,
+                                                          "orgAndUserMenu": 1004,
+                                                          "sidebar": 1003,
                                                           "toast": 10001,
                                                         },
                                                       }
@@ -4647,10 +4653,11 @@ exports[`OrganizationIntegrations render() without integrations Displays integra
                                                     "actor": 1008,
                                                     "menu": 1007,
                                                   },
+                                                  "globalSelectionHeader": 1002,
                                                   "header": 1000,
                                                   "modal": 10000,
-                                                  "orgAndUserMenu": 1003,
-                                                  "sidebar": 1002,
+                                                  "orgAndUserMenu": 1004,
+                                                  "sidebar": 1003,
                                                   "toast": 10001,
                                                 },
                                               }
@@ -4913,10 +4920,11 @@ exports[`OrganizationIntegrations render() without integrations Displays integra
                                                             "actor": 1008,
                                                             "menu": 1007,
                                                           },
+                                                          "globalSelectionHeader": 1002,
                                                           "header": 1000,
                                                           "modal": 10000,
-                                                          "orgAndUserMenu": 1003,
-                                                          "sidebar": 1002,
+                                                          "orgAndUserMenu": 1004,
+                                                          "sidebar": 1003,
                                                           "toast": 10001,
                                                         },
                                                       }
diff --git a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/sentryAppInstallations.spec.jsx.snap b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/sentryAppInstallations.spec.jsx.snap
index 4b4f566697..b956524984 100644
--- a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/sentryAppInstallations.spec.jsx.snap
+++ b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/sentryAppInstallations.spec.jsx.snap
@@ -420,10 +420,11 @@ exports[`Sentry App Installations when Apps exist displays all Apps owned by the
                                           "actor": 1008,
                                           "menu": 1007,
                                         },
+                                        "globalSelectionHeader": 1002,
                                         "header": 1000,
                                         "modal": 10000,
-                                        "orgAndUserMenu": 1003,
-                                        "sidebar": 1002,
+                                        "orgAndUserMenu": 1004,
+                                        "sidebar": 1003,
                                         "toast": 10001,
                                       },
                                     }
@@ -686,10 +687,11 @@ exports[`Sentry App Installations when Apps exist displays all Apps owned by the
                                                   "actor": 1008,
                                                   "menu": 1007,
                                                 },
+                                                "globalSelectionHeader": 1002,
                                                 "header": 1000,
                                                 "modal": 10000,
-                                                "orgAndUserMenu": 1003,
-                                                "sidebar": 1002,
+                                                "orgAndUserMenu": 1004,
+                                                "sidebar": 1003,
                                                 "toast": 10001,
                                               },
                                             }
