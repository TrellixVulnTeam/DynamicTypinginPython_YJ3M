commit 753f4bda7540d70698da6841ebced7ef1bd0b4ad
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Dec 17 13:58:37 2016 -0800

    [security] restrict project key query on enable/disable

diff --git a/src/sentry/web/frontend/disable_project_key.py b/src/sentry/web/frontend/disable_project_key.py
index b6a1e510d2..a624d4d9c5 100644
--- a/src/sentry/web/frontend/disable_project_key.py
+++ b/src/sentry/web/frontend/disable_project_key.py
@@ -13,7 +13,10 @@ class DisableProjectKeyView(ProjectView):
 
     def post(self, request, organization, team, project, key_id):
         try:
-            key = ProjectKey.objects.get(id=key_id)
+            key = ProjectKey.objects.get(
+                project=project,
+                id=key_id,
+            )
         except ProjectKey.DoesNotExist:
             return self.redirect(reverse('sentry-manage-project-keys', args=[project.organization.slug, project.slug]))
 
diff --git a/src/sentry/web/frontend/enable_project_key.py b/src/sentry/web/frontend/enable_project_key.py
index 382cbe9c1b..20c2b3aac7 100644
--- a/src/sentry/web/frontend/enable_project_key.py
+++ b/src/sentry/web/frontend/enable_project_key.py
@@ -13,7 +13,10 @@ class EnableProjectKeyView(ProjectView):
 
     def post(self, request, organization, team, project, key_id):
         try:
-            key = ProjectKey.objects.get(id=key_id)
+            key = ProjectKey.objects.get(
+                project=project,
+                id=key_id,
+            )
         except ProjectKey.DoesNotExist:
             return self.redirect(reverse('sentry-manage-project-keys', args=[project.organization.slug, project.slug]))
 
