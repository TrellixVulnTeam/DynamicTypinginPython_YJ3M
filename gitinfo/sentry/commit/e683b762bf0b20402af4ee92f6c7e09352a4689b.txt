commit e683b762bf0b20402af4ee92f6c7e09352a4689b
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Wed Oct 18 17:52:06 2017 -0700

    feat: Track SSO auth success / error metrics

diff --git a/src/sentry/auth/helper.py b/src/sentry/auth/helper.py
index 77e7085dd0..df693d472a 100644
--- a/src/sentry/auth/helper.py
+++ b/src/sentry/auth/helper.py
@@ -19,7 +19,7 @@ from sentry.models import (
     OrganizationMemberTeam, User, UserEmail
 )
 from sentry.tasks.auth import email_missing_links
-from sentry.utils import auth
+from sentry.utils import auth, metrics
 from sentry.utils.redis import clusters
 from sentry.utils.hashlib import md5_text
 from sentry.utils.http import absolute_uri
@@ -628,6 +628,7 @@ class AuthHelper(object):
             return HttpResponseRedirect(auth.get_login_redirect(self.request))
 
         self.clear_session()
+        metrics.incr('sso.login-success', tags={'provider': self.provider.key})
 
         return HttpResponseRedirect(auth.get_login_redirect(self.request))
 
@@ -760,6 +761,11 @@ class AuthHelper(object):
                 'sentry-organization-auth-settings', args=[self.organization.slug]
             )
 
+        metrics.incr('sso.error', tags={
+            'provider': self.provider.key,
+            'flow': self.state.flow
+        })
+
         messages.add_message(
             self.request,
             messages.ERROR,
