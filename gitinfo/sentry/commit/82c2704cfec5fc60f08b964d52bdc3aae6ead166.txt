commit 82c2704cfec5fc60f08b964d52bdc3aae6ead166
Author: Matej Minar <matej.minar@sentry.io>
Date:   Fri Mar 20 16:37:03 2020 +0100

    feat(ui): Add feature flag, better query (#17809)
    
    * feat(ui): Add feature flag, better query
    
    * Update src/sentry/static/sentry/app/views/releasesV2/detail/overview/issues.tsx
    
    Co-Authored-By: Alberto Leal <mail4alberto@gmail.com>
    
    Co-authored-by: Alberto Leal <mail4alberto@gmail.com>

diff --git a/src/sentry/static/sentry/app/views/releasesV2/detail/overview/index.tsx b/src/sentry/static/sentry/app/views/releasesV2/detail/overview/index.tsx
index 56301a84e9..5a58c43bc2 100644
--- a/src/sentry/static/sentry/app/views/releasesV2/detail/overview/index.tsx
+++ b/src/sentry/static/sentry/app/views/releasesV2/detail/overview/index.tsx
@@ -56,7 +56,7 @@ class ReleaseOverview extends React.Component<Props, State> {
             <ReleaseStatsRequest
               api={api}
               orgId={organization.slug}
-              projectSlug={project?.slug}
+              projectSlug={project.slug}
               version={version}
               selection={selection}
               location={location}
@@ -73,7 +73,11 @@ class ReleaseOverview extends React.Component<Props, State> {
                         {...releaseStatsProps}
                       />
                     )}
-                    <Issues orgId={organization.slug} version={params.release} />
+                    <Issues
+                      orgId={organization.slug}
+                      projectId={project.id}
+                      version={params.release}
+                    />
                   </Main>
                   <Sidebar>
                     {commitCount > 0 && (
diff --git a/src/sentry/static/sentry/app/views/releasesV2/detail/overview/issues.tsx b/src/sentry/static/sentry/app/views/releasesV2/detail/overview/issues.tsx
index 21fcfc8dea..1b7a0b24cb 100644
--- a/src/sentry/static/sentry/app/views/releasesV2/detail/overview/issues.tsx
+++ b/src/sentry/static/sentry/app/views/releasesV2/detail/overview/issues.tsx
@@ -9,10 +9,12 @@ import space from 'app/styles/space';
 import {Panel} from 'app/components/panels';
 import EventView from 'app/views/eventsV2/eventView';
 import {formatVersion} from 'app/utils/formatters';
+import Feature from 'app/components/acl/feature';
 
 type Props = {
   orgId: string;
   version: string;
+  projectId: number;
 };
 
 type State = {
@@ -25,22 +27,17 @@ class Issues extends React.Component<Props, State> {
     issuesType: 'new',
   };
 
-  // TODO(releasesV2): figure out the query we want + do we want to pass globalSelectionHeader values?
   getDiscoverUrl() {
-    const {version, orgId} = this.props;
+    const {version, orgId, projectId} = this.props;
 
     const discoverQuery = {
       id: undefined,
       version: 2,
       name: `${t('Release')} ${formatVersion(version)}`,
-      fields: ['title', 'count(id)', 'event.type', 'user', 'last_seen'],
-      query: `release:${version}`,
-
-      projects: [],
-      range: '',
-      start: '',
-      end: '',
-      environment: [''],
+      fields: ['title', 'count()', 'event.type', 'issue', 'last_seen()'],
+      query: `release:${version} !event.type:transaction`,
+      orderby: '-last_seen',
+      projects: [projectId],
     } as const;
 
     const discoverView = EventView.fromSavedQuery(discoverQuery);
@@ -111,7 +108,9 @@ class Issues extends React.Component<Props, State> {
             ))}
           </DropdownControl>
 
-          <Button to={this.getDiscoverUrl()}>{t('Open in Discover')}</Button>
+          <Feature features={['discover-basic']}>
+            <Button to={this.getDiscoverUrl()}>{t('Open in Discover')}</Button>
+          </Feature>
         </ControlsWrapper>
 
         <TableWrapper>
