commit fba909a4c5cc32a2cd3240346998bf4b571964c8
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 1 15:14:51 2014 -0800

    Switch to .iterator()

diff --git a/src/sentry/migrations/0131_add_default_orgs.py b/src/sentry/migrations/0131_add_default_orgs.py
index 7e5289f11c..f60540300f 100644
--- a/src/sentry/migrations/0131_add_default_orgs.py
+++ b/src/sentry/migrations/0131_add_default_orgs.py
@@ -12,7 +12,7 @@ class Migration(DataMigration):
 
         user_orgs = {}
         team_list = Team.objects.select_related('owner')
-        for team in team_list:
+        for team in team_list.iterator():
             if team.owner not in user_orgs:
                 user_orgs[team.owner] = Organization.objects.create(
                     name=team.name,
diff --git a/src/sentry/migrations/0132_add_org_members.py b/src/sentry/migrations/0132_add_org_members.py
index ef4ad5bf6c..81e70ac2e5 100644
--- a/src/sentry/migrations/0132_add_org_members.py
+++ b/src/sentry/migrations/0132_add_org_members.py
@@ -11,8 +11,8 @@ class Migration(DataMigration):
         OrganizationMember = orm['sentry.OrganizationMember']
         TeamMember = orm['sentry.TeamMember']
 
-        for org in Organization.objects.all():
-            for team in org.team_set.all():
+        for org in Organization.objects.all().iterator():
+            for team in org.team_set.all().iterator():
                 OrganizationMember.objects.get_or_create(
                     organization=org,
                     user=team.owner,
diff --git a/src/sentry/migrations/0137_migrate_team_members.py b/src/sentry/migrations/0137_migrate_team_members.py
index de502a3ea2..2dec00a20d 100644
--- a/src/sentry/migrations/0137_migrate_team_members.py
+++ b/src/sentry/migrations/0137_migrate_team_members.py
@@ -16,7 +16,7 @@ class Migration(DataMigration):
 
         teams_by_org = defaultdict(list)
 
-        for org in Organization.objects.all():
+        for org in Organization.objects.iterator():
             for team in Team.objects.filter(organization=org):
                 teams_by_org[org].append(team)
 
@@ -32,7 +32,7 @@ class Migration(DataMigration):
             ).select_related('user', 'team')
 
             members_by_user = defaultdict(list)
-            for member in team_member_qs:
+            for member in team_member_qs.iterator():
                 members_by_user[member.user].append(member)
 
             total_teams = len(team_list)
