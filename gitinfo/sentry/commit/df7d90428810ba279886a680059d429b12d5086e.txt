commit df7d90428810ba279886a680059d429b12d5086e
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Fri Nov 25 13:31:15 2016 +0100

    Allow plugins to override the on_hold flag

diff --git a/src/sentry/event_manager.py b/src/sentry/event_manager.py
index ef9fdae6c9..9da73c5113 100644
--- a/src/sentry/event_manager.py
+++ b/src/sentry/event_manager.py
@@ -234,6 +234,9 @@ class EventManager(object):
         # First we pull out our top-level (non-data attr) kwargs
         data = self.data
 
+        # Do not put the group on hold for now.
+        data['on_hold'] = False
+
         if not isinstance(data.get('level'), (six.string_types, int)):
             data['level'] = logging.ERROR
         elif data['level'] not in LOG_LEVELS:
@@ -401,6 +404,8 @@ class EventManager(object):
 
         data = self.data.copy()
 
+        on_hold = data.pop('on_hold')
+
         # First we pull out our top-level (non-data attr) kwargs
         event_id = data.pop('event_id')
         level = data.pop('level')
@@ -566,6 +571,14 @@ class EventManager(object):
             },
         })
 
+        # If we want to put the group on hold we mark the group as such.
+        # In theory this should only ever happen on new groups or for
+        # groups that are already on hold.  However in case something
+        # breaks internally we want to make sure that we never
+        # accidentally set a group that is on hold to not be on hold.
+        if on_hold:
+            group_kwargs['on_hold'] = True
+
         if release:
             release = Release.get_or_create(
                 project=project,
