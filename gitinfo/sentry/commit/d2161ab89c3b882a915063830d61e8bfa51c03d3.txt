commit d2161ab89c3b882a915063830d61e8bfa51c03d3
Author: Matej Minar <matej.minar@sentry.io>
Date:   Fri Mar 27 00:09:06 2020 +0100

    fix(ui): Small improvements on releases v2 (#17946)
    
    * fix(ui): Recheck lazy histograms on releases change, fixed empty message, conditional project
    
    * added lazyload forcecheck comment
    
    * better lazyload forcecheck comment

diff --git a/src/sentry/static/sentry/app/views/releasesV2/list/index.tsx b/src/sentry/static/sentry/app/views/releasesV2/list/index.tsx
index 65f3228fb8..0390d972a5 100644
--- a/src/sentry/static/sentry/app/views/releasesV2/list/index.tsx
+++ b/src/sentry/static/sentry/app/views/releasesV2/list/index.tsx
@@ -2,6 +2,7 @@ import React from 'react';
 import {RouteComponentProps} from 'react-router/lib/Router';
 import styled from '@emotion/styled';
 import pick from 'lodash/pick';
+import {forceCheck} from 'react-lazyload';
 
 import {t} from 'app/locale';
 import space from 'app/styles/space';
@@ -71,6 +72,23 @@ class ReleasesList extends AsyncView<Props, State> {
     return [['releases', `/organizations/${organization.slug}/releases/`, {query}]];
   }
 
+  componentDidUpdate(prevProps, prevState) {
+    super.componentDidUpdate(prevProps, prevState);
+
+    if (prevState.releases !== this.state.releases) {
+      /**
+       * Manually trigger checking for elements in viewport.
+       * Helpful when LazyLoad components enter the viewport without resize or scroll events,
+       * https://github.com/twobin/react-lazyload#forcecheck
+       *
+       * HealthStatsCharts are being rendered only when they are scrolled into viewport.
+       * This is how we re-check them without scrolling once releases change as this view
+       * uses shouldReload=true and there is no reloading happening.
+       */
+      forceCheck();
+    }
+  }
+
   getQuery() {
     const {query} = this.props.location.query;
 
@@ -159,7 +177,7 @@ class ReleasesList extends AsyncView<Props, State> {
       );
     }
 
-    return t('There are no releases.');
+    return <EmptyStateWarning small>{t('There are no releases.')}</EmptyStateWarning>;
   }
 
   renderInnerBody() {
diff --git a/src/sentry/static/sentry/app/views/releasesV2/list/releaseCard.tsx b/src/sentry/static/sentry/app/views/releasesV2/list/releaseCard.tsx
index de31388a82..35c9242005 100644
--- a/src/sentry/static/sentry/app/views/releasesV2/list/releaseCard.tsx
+++ b/src/sentry/static/sentry/app/views/releasesV2/list/releaseCard.tsx
@@ -69,7 +69,9 @@ const ReleaseCard = ({release, project, location, reloading}: Props) => (
           </VersionColumn>
 
           <ProjectsColumn>
-            <ProjectBadge project={project} avatarSize={14} key={project?.slug} />
+            {project && (
+              <ProjectBadge project={project} avatarSize={14} key={project?.slug} />
+            )}
           </ProjectsColumn>
 
           <CommitsColumn>
