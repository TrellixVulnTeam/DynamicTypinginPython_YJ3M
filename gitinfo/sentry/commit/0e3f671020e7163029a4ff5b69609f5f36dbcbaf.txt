commit 0e3f671020e7163029a4ff5b69609f5f36dbcbaf
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Thu Apr 2 14:28:39 2020 -0700

    ref(onboarding): No-op alert-task migration (#18053)
    
    This should not live in sentry, we'll move this to the sentry.io SAAS
    repo (getsentry)

diff --git a/src/sentry/migrations/0053_migrate_alert_task_onboarding.py b/src/sentry/migrations/0053_migrate_alert_task_onboarding.py
index ac7665db6f..49ba8071c1 100644
--- a/src/sentry/migrations/0053_migrate_alert_task_onboarding.py
+++ b/src/sentry/migrations/0053_migrate_alert_task_onboarding.py
@@ -2,49 +2,7 @@
 # Generated by Django 1.11.28 on 2020-03-12 21:02
 from __future__ import unicode_literals
 
-
-from datetime import datetime
 from django.db import migrations
-from django.db.models import OuterRef, Exists
-
-
-def mark_all_projects_completed_alert_rule_onboarding(apps, schema_editor):
-    from sentry.utils.query import RangeQuerySetWrapperWithProgressBar
-    from sentry.models import OnboardingTaskStatus, OnboardingTask
-
-    Organization = apps.get_model("sentry", "organization")
-    OrganizationOnboardingTask = apps.get_model("sentry", "organizationonboardingtask")
-
-    # Locate all organizations, annotated which have not completed alert
-    # onboarding tasks.
-    #
-    # Queryplan:
-    #
-    # Seq Scan on sentry_organization (cost=0.00..1310384.71 rows=293362 width=57)
-    # SubPlan 1
-    # -> Index Only Scan using sentry_organizationonboar_organization_id_47e98e05cae29cf3_uniq on sentry_organizationonboardingtask u0 (cost=0.42..4.44 rows=1 width=0)
-    # Index Cond: ((organization_id = sentry_organization.id) AND (task = 10))
-    # SubPlan 2
-    # -> Index Only Scan using sentry_organizationonboar_organization_id_47e98e05cae29cf3_uniq on sentry_organizationonboardingtask u0_1 (cost=0.42..15696.40 rows=22913 width=8)
-    # Index Cond: (task = 10)
-    #
-    target_organizations = Organization.objects.annotate(
-        alert_task_complete=Exists(
-            OrganizationOnboardingTask.objects.filter(
-                organization_id=OuterRef("id"), task=OnboardingTask.ALERT_RULE
-            )
-        )
-    )
-
-    for org in RangeQuerySetWrapperWithProgressBar(target_organizations):
-        if org.alert_task_complete:
-            continue
-
-        OrganizationOnboardingTask.objects.update_or_create(
-            organization_id=org.id,
-            task=OnboardingTask.ALERT_RULE,
-            defaults={"status": OnboardingTaskStatus.COMPLETE},
-        )
 
 
 class Migration(migrations.Migration):
@@ -67,4 +25,8 @@ class Migration(migrations.Migration):
 
     dependencies = [("sentry", "0052_organizationonboardingtask_completion_seen")]
 
-    operations = [migrations.RunPython(mark_all_projects_completed_alert_rule_onboarding)]
+    # NOTE: This migration previously was making changes that were only
+    # applicable to the sentry.io SAAS project. We've changed this migration to
+    # be a no-op before it had been run, and will be moving the migration to
+    # getsentry.
+    operations = []
