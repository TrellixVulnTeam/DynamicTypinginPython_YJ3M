commit 4fdbbbc26b975ab811ee308008a60df40ebcb9c7
Author: ted kaemming <ted@kaemming.com>
Date:   Fri Feb 22 10:43:52 2019 -0800

    ref(eventstream): Expose method to check if running forwarder is required (#12166)

diff --git a/src/sentry/eventstream/base.py b/src/sentry/eventstream/base.py
index b1a3b01e49..824d42ab16 100644
--- a/src/sentry/eventstream/base.py
+++ b/src/sentry/eventstream/base.py
@@ -27,6 +27,7 @@ class EventStream(Service):
         'end_unmerge',
         'start_delete_tag',
         'end_delete_tag',
+        'requires_post_process_forwarder',
         'run_post_process_forwarder',
     )
 
@@ -69,6 +70,10 @@ class EventStream(Service):
     def end_delete_tag(self, state):
         pass
 
+    def requires_post_process_forwarder(self):
+        return False
+
     def run_post_process_forwarder(self, consumer_group, commit_log_topic,
                                    synchronize_commit_group, commit_batch_size=100, initial_offset_reset='latest'):
+        assert not self.requires_post_process_forwarder()
         raise ForwarderNotRequired
diff --git a/src/sentry/eventstream/kafka/backend.py b/src/sentry/eventstream/kafka/backend.py
index ac813a0938..6e21a9f6f3 100644
--- a/src/sentry/eventstream/kafka/backend.py
+++ b/src/sentry/eventstream/kafka/backend.py
@@ -291,6 +291,9 @@ class KafkaEventStream(EventStream):
             asynchronous=False
         )
 
+    def requires_post_process_forwarder(self):
+        return True
+
     def run_post_process_forwarder(self, consumer_group, commit_log_topic,
                                    synchronize_commit_group, commit_batch_size=100, initial_offset_reset='latest'):
         logger.debug('Starting post-process forwarder...')
