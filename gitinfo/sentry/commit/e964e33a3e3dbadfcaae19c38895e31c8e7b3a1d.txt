commit e964e33a3e3dbadfcaae19c38895e31c8e7b3a1d
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Aug 4 21:33:07 2013 -0700

    Strip tags/extra data at view level so nav renders correctly

diff --git a/src/sentry/templates/sentry/groups/public_details.html b/src/sentry/templates/sentry/groups/public_details.html
index dd3a84b45e..f516b7fe49 100644
--- a/src/sentry/templates/sentry/groups/public_details.html
+++ b/src/sentry/templates/sentry/groups/public_details.html
@@ -43,30 +43,7 @@
                     <pre id="full-message">{{ event.message }}</pre>
                 {% endif %}
 
-                {% for interface, interface_html in interface_list %}
-                    <div id="{{ interface.get_slug }}">
-                        {{ interface_html }}
-                    </div>
-                {% endfor %}
-
-                {% if version_data %}
-                    <div id="versions">
-                        <div class="page-header">
-                            <h2>{% trans "Package Versions" %}</h2>
-                        </div>
-                        <table class="table table-striped">
-                            <colgroup>
-                                <col style="width:130px">
-                            </colgroup>
-                            {% for k, v in version_data.iteritems|as_sorted %}
-                                <tr>
-                                    <th class="key">{{ k }}</th>
-                                    <td class="values"><code>{{ v }}</code></td>
-                                </tr>
-                            {% endfor %}
-                        </table>
-                    </div>
-                {% endif %}
+                {% include "sentry/partial/_event_details.html" %}
             {% endwith %}
         {% endblock %}
     </section>
diff --git a/src/sentry/web/frontend/groups.py b/src/sentry/web/frontend/groups.py
index fbe101c9ae..07915ba01a 100644
--- a/src/sentry/web/frontend/groups.py
+++ b/src/sentry/web/frontend/groups.py
@@ -166,7 +166,7 @@ def _get_group_list(request, project):
     }
 
 
-def render_with_group_context(group, template, context, request=None, event=None):
+def render_with_group_context(group, template, context, request=None, event=None, is_public=False):
     context.update({
         'team': group.project.team,
         'project': group.project,
@@ -190,14 +190,18 @@ def render_with_group_context(group, template, context, request=None, event=None
             next_event = None
             prev_event = None
 
-        extra_data = event.data.get('extra', {})
-        if not isinstance(extra_data, dict):
-            extra_data = {}
+        if not is_public:
+            extra_data = event.data.get('extra', {})
+            if not isinstance(extra_data, dict):
+                extra_data = {}
+
+            context.update({
+                'tags': event.get_tags(),
+                'json_data': extra_data,
+            })
 
         context.update({
             'event': event,
-            'json_data': extra_data,
-            'tags': event.get_tags(),
             'version_data': event.data.get('modules', None),
             'next_event': next_event,
             'prev_event': prev_event,
@@ -401,13 +405,17 @@ def group(request, team, project, group, event_id=None):
         'activity': activity,
     }
 
-    if group_is_public(group, request.user):
+    is_public = group_is_public(group, request.user)
+
+    if is_public:
         template = 'sentry/groups/public_details.html'
         context['PROJECT_LIST'] = [project]
     else:
         template = 'sentry/groups/details.html'
 
-    return render_with_group_context(group, template, context, request, event=event)
+    return render_with_group_context(
+        group, template, context, request,
+        event=event, is_public=is_public)
 
 
 @has_group_access
