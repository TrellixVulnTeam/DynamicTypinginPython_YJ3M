commit 618fdc0e4ce83b9dfaec22e2a388577f514ec873
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Aug 10 15:52:23 2015 -0700

    Add release artifacts view (fixes GH-1734)

diff --git a/bin/load-mocks b/bin/load-mocks
index 0bed53e457..53ac0ece79 100755
--- a/bin/load-mocks
+++ b/bin/load-mocks
@@ -11,8 +11,8 @@ from random import randint
 
 from sentry.app import tsdb
 from sentry.models import (
-    Activity, User, GroupMeta, Organization, OrganizationAccessRequest,
-    OrganizationMember, Project, Team
+    Activity, File, GroupMeta, Organization, OrganizationAccessRequest,
+    OrganizationMember, Project, Release, ReleaseFile, Team, User
 )
 from sentry.utils.samples import create_sample_event
 
@@ -112,26 +112,43 @@ def main():
                 }
             )
 
+            release = Release.objects.get_or_create(
+                version='4f38b65c62c4565aa94bba391ff8946922a8eed4',
+                project=project,
+            )[0]
+
+            ReleaseFile.objects.get_or_create(
+                project=project,
+                release=release,
+                name='an-example.js',
+                file=File.objects.get_or_create(
+                    name='an-example.js',
+                    type='release.file',
+                    checksum='abcde' * 8,
+                    size=13043,
+                )[0],
+            )
+
             event1 = create_sample_event(
                 project=project,
                 platform='python',
-                release='4f38b65c62c4565aa94bba391ff8946922a8eed4',
+                release=release.version,
             )
             create_sample_time_series(event1)
 
             event2 = create_sample_event(
                 project=project,
                 platform='javascript',
-                release='4f38b65c62c4565aa94bba391ff8946922a8eed4',
+                release=release.version,
             )
             create_sample_time_series(event2)
 
             Activity.objects.create(
                 type=Activity.RELEASE,
                 project=project,
-                ident='4f38b65c62c4565aa94bba391ff8946922a8eed4',
+                ident=release.version,
                 user=user,
-                data={'version': '4f38b65c62c4565aa94bba391ff8946922a8eed4'},
+                data={'version': release.version},
             )
 
             event3 = create_sample_event(project, 'java')
diff --git a/src/sentry/static/sentry/app/routes.jsx b/src/sentry/static/sentry/app/routes.jsx
index 0c2fdd16f5..37c77c3a8e 100644
--- a/src/sentry/static/sentry/app/routes.jsx
+++ b/src/sentry/static/sentry/app/routes.jsx
@@ -20,6 +20,7 @@ import ProjectDetails from "./views/projectDetails";
 import ProjectReleases from "./views/projectReleases";
 import PropTypes from "./proptypes";
 import ReleaseAllEvents from "./views/releaseAllEvents";
+import ReleaseArtifacts from "./views/releaseArtifacts";
 import ReleaseDetails from "./views/releaseDetails";
 import ReleaseNewEvents from "./views/releaseNewEvents";
 import RouteNotFound from "./views/routeNotFound";
@@ -43,6 +44,7 @@ var routes = (
         <Route name="releaseDetails" path="releases/:version/" handler={ReleaseDetails}>
           <DefaultRoute name="releaseNewEvents" handler={ReleaseNewEvents} />
           <Route name="releaseAllEvents" path="all-events/" handler={ReleaseAllEvents} />
+          <Route name="releaseArtifacts" path="artifacts/" handler={ReleaseArtifacts} />
         </Route>
         <Route name="groupDetails" path="group/:groupId/" handler={GroupDetails}
                ignoreScrollBehavior>
diff --git a/src/sentry/static/sentry/app/views/releaseArtifacts.jsx b/src/sentry/static/sentry/app/views/releaseArtifacts.jsx
new file mode 100644
index 0000000000..4011f2e1e5
--- /dev/null
+++ b/src/sentry/static/sentry/app/views/releaseArtifacts.jsx
@@ -0,0 +1,94 @@
+import React from "react";
+import Router from "react-router";
+import PropTypes from "../proptypes";
+
+import api from "../api";
+import FileSize from "../components/fileSize";
+import LoadingError from "../components/loadingError";
+import LoadingIndicator from "../components/loadingIndicator";
+
+var ReleaseArtifacts = React.createClass({
+  contextTypes: {
+    router: React.PropTypes.func,
+    release: PropTypes.AnyModel
+  },
+
+  getInitialState() {
+    return {
+      loading: true,
+      error: false,
+      fileList: [],
+      pageLinks: null
+    };
+  },
+
+  componentWillMount() {
+    this.fetchData();
+  },
+
+  routeDidChange() {
+    this.fetchData();
+  },
+
+  fetchData() {
+    var router = this.context.router;
+    var params = router.getCurrentParams();
+    var endpoint = '/projects/' + params.orgId + '/' + params.projectId + '/releases/' + params.version + '/files/';
+
+    this.setState({
+      loading: true,
+      error: false
+    });
+
+    api.request(endpoint, {
+      success: (data, _, jqXHR) => {
+        this.setState({
+          error: false,
+          loading: false,
+          fileList: data,
+          pageLinks: jqXHR.getResponseHeader('Link')
+        });
+      },
+      error: () => {
+        this.setState({
+          error: true,
+          loading: false
+        });
+      }
+    });
+  },
+
+
+  render() {
+    if (this.state.loading)
+      return <LoadingIndicator />;
+    else if (this.state.error)
+      return <LoadingError onRetry={this.fetchData} />;
+    else if (this.state.fileList.length === 0)
+      return (
+        <div className="box empty-stream">
+          <span className="icon icon-exclamation"></span>
+          <p>There are no artifacts uploaded for this release.</p>
+        </div>
+      );
+
+    // TODO(dcramer): files should allow you to download and delete them
+    return (
+      <div>
+        <table className="table">
+          {this.state.fileList.map((file) => {
+            console.log(file);
+            return (
+              <tr>
+                <td><strong>{file.name}</strong></td>
+                <td style={{width: 120}}><FileSize bytes={file.size} /></td>
+              </tr>
+            );
+          })}
+        </table>
+      </div>
+    );
+  }
+});
+
+export default ReleaseArtifacts;
diff --git a/src/sentry/static/sentry/app/views/releaseDetails.jsx b/src/sentry/static/sentry/app/views/releaseDetails.jsx
index 57e46a101f..77b9ecaa52 100644
--- a/src/sentry/static/sentry/app/views/releaseDetails.jsx
+++ b/src/sentry/static/sentry/app/views/releaseDetails.jsx
@@ -121,6 +121,7 @@ var ReleaseDetails = React.createClass({
             <ul className="nav nav-tabs">
               <ListLink to="releaseNewEvents" params={params}>New Events</ListLink>
               <ListLink to="releaseAllEvents" params={params}>All Events</ListLink>
+              <ListLink to="releaseArtifacts" params={params} className="pull-right">Artifacts</ListLink>
             </ul>
           </div>
           <Router.RouteHandler />
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index 197c7a7b04..38186cf09d 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -383,6 +383,8 @@ urlpatterns += patterns('',
         name='sentry-release-details'),
     url(r'^(?P<organization_slug>[\w_-]+)/(?P<project_id>[\w_-]+)/releases/(?P<version>[^\/]+)/all-events/$', ReactPageView.as_view(),
         name='sentry-release-details-all-events'),
+    url(r'^(?P<organization_slug>[\w_-]+)/(?P<project_id>[\w_-]+)/releases/(?P<version>[^\/]+)/artifacts/$', ReactPageView.as_view(),
+        name='sentry-release-details-artifacts'),
     url(r'^(?P<organization_slug>[\w_-]+)/(?P<project_id>[\w_-]+)/dashboard/$', ReactPageView.as_view(),
         name='sentry-dashboard'),
     url(r'^(?P<organization_slug>[\w_-]+)/(?P<project_id>[\w_-]+)/events/$', ReactPageView.as_view(),
