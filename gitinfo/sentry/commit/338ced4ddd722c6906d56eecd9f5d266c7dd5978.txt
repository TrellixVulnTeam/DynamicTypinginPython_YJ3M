commit 338ced4ddd722c6906d56eecd9f5d266c7dd5978
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Tue Dec 3 16:18:15 2019 -0800

    chore(utils): Move custom urlsafe_b64decode into utils.signing (#15902)

diff --git a/src/sentry/auth/providers/google/utils.py b/src/sentry/auth/providers/google/utils.py
deleted file mode 100644
index 4c36d95d02..0000000000
--- a/src/sentry/auth/providers/google/utils.py
+++ /dev/null
@@ -1,8 +0,0 @@
-from __future__ import absolute_import, print_function
-
-import base64
-
-
-def urlsafe_b64decode(b64string):
-    padded = b64string + b"=" * (4 - len(b64string) % 4)
-    return base64.urlsafe_b64decode(padded)
diff --git a/src/sentry/auth/providers/google/views.py b/src/sentry/auth/providers/google/views.py
index 62316725dc..ab2be2e47a 100644
--- a/src/sentry/auth/providers/google/views.py
+++ b/src/sentry/auth/providers/google/views.py
@@ -4,9 +4,9 @@ import logging
 
 from sentry.auth.view import AuthView, ConfigureView
 from sentry.utils import json
+from sentry.utils.signing import urlsafe_b64decode
 
 from .constants import DOMAIN_BLOCKLIST, ERR_INVALID_DOMAIN, ERR_INVALID_RESPONSE
-from .utils import urlsafe_b64decode
 
 logger = logging.getLogger("sentry.auth.google")
 
diff --git a/src/sentry/utils/signing.py b/src/sentry/utils/signing.py
index a58e77c878..b56f9da38a 100644
--- a/src/sentry/utils/signing.py
+++ b/src/sentry/utils/signing.py
@@ -3,7 +3,8 @@ Generic way to sign and unsign data for use in urls.
 """
 from __future__ import absolute_import
 
-from base64 import urlsafe_b64encode, urlsafe_b64decode
+import base64
+
 from django.core.signing import TimestampSigner
 from sentry.utils.json import dumps, loads
 
@@ -11,13 +12,13 @@ SALT = "sentry-generic-signing"
 
 
 def sign(**kwargs):
-    return urlsafe_b64encode(TimestampSigner(salt=SALT).sign(dumps(kwargs))).rstrip("=")
+    return base64.urlsafe_b64encode(TimestampSigner(salt=SALT).sign(dumps(kwargs))).rstrip("=")
 
 
 def unsign(data, max_age=60 * 60 * 24 * 2):
-    padding = len(data) % 4
-    return loads(
-        TimestampSigner(salt=SALT).unsign(
-            urlsafe_b64decode(data + b"=" * (4 - padding)), max_age=max_age
-        )
-    )
+    return loads(TimestampSigner(salt=SALT).unsign(urlsafe_b64decode(data), max_age=max_age))
+
+
+def urlsafe_b64decode(b64string):
+    padded = b64string + b"=" * (4 - len(b64string) % 4)
+    return base64.urlsafe_b64decode(padded)
