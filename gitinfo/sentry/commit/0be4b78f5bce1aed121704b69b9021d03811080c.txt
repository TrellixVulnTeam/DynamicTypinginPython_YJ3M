commit 0be4b78f5bce1aed121704b69b9021d03811080c
Author: Ben Vinegar <ben@benv.ca>
Date:   Tue May 24 19:07:44 2016 -0700

    Show user's email sub status on project notification page
    
    /cc @getsentry/ui

diff --git a/src/sentry/templates/sentry/project-notifications.html b/src/sentry/templates/sentry/project-notifications.html
index 2a57c9664d..7451ce026d 100644
--- a/src/sentry/templates/sentry/project-notifications.html
+++ b/src/sentry/templates/sentry/project-notifications.html
@@ -19,7 +19,12 @@
       </div>
       <div class="box-content with-padding">
         {% url 'sentry-project-rules' organization.slug project.slug as link %}
-        <p>{% blocktrans %}Sentry will notify you based on the <a href="{{ link }}">rules configured for this project</a>.{% endblocktrans %}</p>
+        <p>{% blocktrans %}Sentry will notify users subscribed to this project based on the <a href="{{ link }}">rules configured for this project</a>.{% endblocktrans %}</p>
+
+        {% if not is_user_subbed %}
+        {% url 'sentry-account-settings-notifications' as account_notification_url %}
+        <p style="font-style:italic">You are currently not subscribed to this project. To subscribe, go to <a href="{{ account_notification_url }}">Account Notifications</a>.</p>
+        {% endif %}
       </div>
     </div>
 
diff --git a/src/sentry/web/frontend/project_notifications.py b/src/sentry/web/frontend/project_notifications.py
index 7d1d905a8b..3697e5f639 100644
--- a/src/sentry/web/frontend/project_notifications.py
+++ b/src/sentry/web/frontend/project_notifications.py
@@ -8,6 +8,7 @@ from django.utils.translation import ugettext_lazy as _
 from sentry import constants
 from sentry import options
 from sentry.app import digests
+from sentry.models import UserOption
 from sentry.digests import get_option_key as get_digest_option_key
 from sentry.plugins import plugins, NotificationPlugin
 from sentry.web.forms.projects import (
@@ -46,6 +47,14 @@ class ProjectNotificationsView(ProjectView):
         )
 
     def handle(self, request, organization, team, project):
+        is_user_subbed = UserOption.objects.get_value(
+            request.user, project, 'mail:alert', None)
+        if is_user_subbed is None:
+            is_user_subbed = UserOption.objects.get_value(
+                request.user, None, 'subscribe_by_default', '1') == '1'
+        else:
+            is_user_subbed = bool(is_user_subbed)
+
         op = request.POST.get('op')
         if op == 'enable':
             self._handle_enable_plugin(request, project)
@@ -145,6 +154,7 @@ class ProjectNotificationsView(ProjectView):
             'other_plugins': other_plugins,
             'general_form': general_form,
             'digests_form': digests_form,
+            'is_user_subbed': is_user_subbed
         }
 
         return self.respond('sentry/project-notifications.html', context)
