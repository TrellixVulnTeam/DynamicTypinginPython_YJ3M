commit bfee365e8778368a83b95e71bee02038989f3a9c
Author: Mark Story <mark@mark-story.com>
Date:   Thu Apr 18 17:03:31 2019 -0400

    fix(ui) Clear pinned/saved search on submit (#12839)
    
    When submitting a new search query we should clear any saved searches as
    the user wants to look at something else.
    
    Fixes SEN-501

diff --git a/src/sentry/static/sentry/app/views/organizationStream/overview.jsx b/src/sentry/static/sentry/app/views/organizationStream/overview.jsx
index d85e36de27..2cf9530906 100644
--- a/src/sentry/static/sentry/app/views/organizationStream/overview.jsx
+++ b/src/sentry/static/sentry/app/views/organizationStream/overview.jsx
@@ -379,7 +379,8 @@ const OrganizationStream = createReactClass({
       // if query is the same, just re-fetch data
       this.fetchData();
     } else {
-      this.transitionTo({query});
+      // Clear the saved search as the user wants something else.
+      this.transitionTo({query}, null);
     }
   },
 
diff --git a/tests/js/spec/views/organizationStream/overview.spec.jsx b/tests/js/spec/views/organizationStream/overview.spec.jsx
index 1df28a7af8..cf328c24ce 100644
--- a/tests/js/spec/views/organizationStream/overview.spec.jsx
+++ b/tests/js/spec/views/organizationStream/overview.spec.jsx
@@ -443,6 +443,45 @@ describe('OrganizationStream', function() {
       );
     });
 
+    it('clears a saved search when a custom one is entered', async function() {
+      savedSearchesRequest = MockApiClient.addMockResponse({
+        url: '/organizations/org-slug/searches/',
+        body: [
+          savedSearch,
+          TestStubs.Search({
+            id: '123',
+            name: 'Pinned search',
+            isPinned: true,
+            isGlobal: false,
+            isOrgCustom: true,
+            query: 'is:resolved',
+          }),
+        ],
+      });
+      createWrapper();
+      await tick();
+      await wrapper.update();
+
+      // Update the search input
+      wrapper
+        .find('StreamFilters SmartSearchBar StyledInput input')
+        .simulate('change', {target: {value: 'dogs'}});
+      // Submit the form
+      wrapper.find('StreamFilters SmartSearchBar form').simulate('submit');
+      await wrapper.update();
+
+      expect(browserHistory.push).toHaveBeenLastCalledWith(
+        expect.objectContaining({
+          pathname: '/organizations/org-slug/issues/',
+          query: {
+            environment: [],
+            project: [],
+            query: 'dogs',
+          },
+        })
+      );
+    });
+
     it.todo('pins and unpins a custom query');
 
     it.todo('pins and unpins a saved query');
