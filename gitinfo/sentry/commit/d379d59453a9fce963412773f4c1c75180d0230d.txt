commit d379d59453a9fce963412773f4c1c75180d0230d
Author: Xavier Ordoquy <xordoquy@linovia.com>
Date:   Mon Jan 2 15:59:10 2012 +0100

    Removed the ugly global.

diff --git a/tests/processor.py b/tests/processor.py
index 83d979d6f8..18e9b30e4f 100644
--- a/tests/processor.py
+++ b/tests/processor.py
@@ -1,10 +1,11 @@
 
 from sentry.processors import BaseProcessor
 
-CALLED = 0
-
 
 class TestProcessor(BaseProcessor):
+
+    def __init__(self, *args, **kwargs):
+        self.called = 0
+
     def post_processing(self, event):
-        global CALLED
-        CALLED += 1
+        self.called += 1
diff --git a/tests/tests.py b/tests/tests.py
index fbdacb7767..f5ab58b3a4 100644
--- a/tests/tests.py
+++ b/tests/tests.py
@@ -620,5 +620,7 @@ class SentryProcessorsTest(TestCase):
     def test_processors_called(self):
         self.create_event()
         self.create_event()
-        from . import processor
-        self.assertEqual(processor.CALLED, 2)
+        import sentry.processors
+        processors = sentry.processors.PROCESSORS_CACHE
+        self.assertEqual(len(processors), 1)
+        self.assertEqual(processors[0].called, 2)
