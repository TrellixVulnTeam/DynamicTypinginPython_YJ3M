commit 79b851f7511e5c123718915d56989fecdef8b76f
Author: Matej Minar <matej.minar@sentry.io>
Date:   Fri Jun 5 10:06:53 2020 +0200

    feat(ui): More visible switch to new releases (#19189)

diff --git a/src/sentry/static/sentry/app/views/releases/detail/index.jsx b/src/sentry/static/sentry/app/views/releases/detail/index.jsx
index 2778a860be..0b75909ad4 100644
--- a/src/sentry/static/sentry/app/views/releases/detail/index.jsx
+++ b/src/sentry/static/sentry/app/views/releases/detail/index.jsx
@@ -15,8 +15,6 @@ import withGlobalSelection from 'app/utils/withGlobalSelection';
 import withOrganization from 'app/utils/withOrganization';
 import withProfiler from 'app/utils/withProfiler';
 import withProjects from 'app/utils/withProjects';
-import Feature from 'app/components/acl/feature';
-import SwitchReleasesButton from 'app/views/releasesV2/utils/switchReleasesButton';
 
 import ReleaseHeader from './releaseHeader';
 
@@ -114,7 +112,6 @@ class OrganizationReleaseDetails extends AsyncView {
     const {
       location,
       params: {orgId},
-      organization,
     } = this.props;
     const {release} = this.state;
 
@@ -134,9 +131,6 @@ class OrganizationReleaseDetails extends AsyncView {
           release,
           query,
         })}
-        <Feature features={['releases-v2']} organization={organization}>
-          <SwitchReleasesButton version="2" orgId={organization.id} />
-        </Feature>
       </PageContent>
     );
   }
diff --git a/src/sentry/static/sentry/app/views/releases/detail/releaseDetailActions.jsx b/src/sentry/static/sentry/app/views/releases/detail/releaseDetailActions.jsx
index 574c68f745..cd4c6693c2 100644
--- a/src/sentry/static/sentry/app/views/releases/detail/releaseDetailActions.jsx
+++ b/src/sentry/static/sentry/app/views/releases/detail/releaseDetailActions.jsx
@@ -1,6 +1,7 @@
 import PropTypes from 'prop-types';
 import React from 'react';
 import {browserHistory} from 'react-router';
+import styled from '@emotion/styled';
 
 import {t} from 'app/locale';
 import {addErrorMessage, addLoadingMessage} from 'app/actionCreators/indicator';
@@ -8,6 +9,10 @@ import SentryTypes from 'app/sentryTypes';
 import Button from 'app/components/button';
 import Confirm from 'app/components/confirm';
 import {IconDelete} from 'app/icons';
+import Feature from 'app/components/acl/feature';
+import SwitchReleasesButton from 'app/views/releasesV2/utils/switchReleasesButton';
+import ButtonBar from 'app/components/buttonBar';
+import space from 'app/styles/space';
 
 import {deleteRelease} from './utils';
 
@@ -34,19 +39,33 @@ export default class ReleaseDetailsActions extends React.Component {
   };
 
   render() {
+    const {orgId} = this.props;
+
     return (
-      <div className="m-b-1">
-        <Confirm
-          onConfirm={this.handleDelete}
-          message={t(
-            'Deleting this release is permanent. Are you sure you wish to continue?'
-          )}
-        >
-          <Button size="small" icon={<IconDelete />}>
-            {t('Delete')}
-          </Button>
-        </Confirm>
-      </div>
+      <Wrapper>
+        <ButtonBar gap={1}>
+          <Confirm
+            onConfirm={this.handleDelete}
+            message={t(
+              'Deleting this release is permanent. Are you sure you wish to continue?'
+            )}
+          >
+            <Button size="small" icon={<IconDelete />}>
+              {t('Delete')}
+            </Button>
+          </Confirm>
+
+          <Feature features={['releases-v2']}>
+            <SwitchReleasesButton version="2" orgId={orgId} />
+          </Feature>
+        </ButtonBar>
+      </Wrapper>
     );
   }
 }
+
+const Wrapper = styled('div')`
+  display: flex;
+  justify-content: flex-start;
+  margin-bottom: ${space(3)};
+`;
diff --git a/src/sentry/static/sentry/app/views/releases/list/index.jsx b/src/sentry/static/sentry/app/views/releases/list/index.jsx
index d655f52e50..05ebc01ab0 100644
--- a/src/sentry/static/sentry/app/views/releases/list/index.jsx
+++ b/src/sentry/static/sentry/app/views/releases/list/index.jsx
@@ -1,5 +1,6 @@
 import {browserHistory} from 'react-router';
 import React from 'react';
+import styled from '@emotion/styled';
 
 import {ALL_ACCESS_PROJECTS} from 'app/constants/globalSelectionHeader';
 import {PageContent, PageHeader} from 'app/styles/organization';
@@ -20,6 +21,7 @@ import withOrganization from 'app/utils/withOrganization';
 import Feature from 'app/components/acl/feature';
 import SwitchReleasesButton from 'app/views/releasesV2/utils/switchReleasesButton';
 import {defined} from 'app/utils';
+import space from 'app/styles/space';
 
 import {getQuery} from './utils';
 import ReleaseLanding from './releaseLanding';
@@ -179,14 +181,17 @@ class OrganizationReleases extends AsyncView {
         <LightWeightNoProjectMessage organization={organization}>
           <PageHeader>
             <PageHeading>{t('Releases')}</PageHeading>
-            <div>
+            <Wrapper>
+              <Feature features={['releases-v2']} organization={organization}>
+                <SwitchReleasesButton version="2" orgId={organization.id} />
+              </Feature>
               <SearchBar
                 defaultQuery=""
                 placeholder={t('Search for a release')}
                 query={location.query.query}
                 onSearch={this.onSearch}
               />
-            </div>
+            </Wrapper>
           </PageHeader>
           <div>
             <Panel>
@@ -194,9 +199,6 @@ class OrganizationReleases extends AsyncView {
               <PanelBody>{this.renderStreamBody()}</PanelBody>
             </Panel>
             <Pagination pageLinks={this.state.releaseListPageLinks} />
-            <Feature features={['releases-v2']} organization={organization}>
-              <SwitchReleasesButton version="2" orgId={organization.id} />
-            </Feature>
           </div>
         </LightWeightNoProjectMessage>
       </PageContent>
@@ -204,4 +206,11 @@ class OrganizationReleases extends AsyncView {
   }
 }
 
+const Wrapper = styled('div')`
+  display: grid;
+  grid-gap: ${space(1)};
+  margin-left: ${space(2)};
+  grid-template-columns: auto auto;
+`;
+
 export default withOrganization(withGlobalSelection(withProfiler(ReleasesContainer)));
diff --git a/src/sentry/static/sentry/app/views/releasesV2/utils/switchReleasesButton.tsx b/src/sentry/static/sentry/app/views/releasesV2/utils/switchReleasesButton.tsx
index 91a7fccfcd..a32a058cfd 100644
--- a/src/sentry/static/sentry/app/views/releasesV2/utils/switchReleasesButton.tsx
+++ b/src/sentry/static/sentry/app/views/releasesV2/utils/switchReleasesButton.tsx
@@ -2,6 +2,7 @@ import React from 'react';
 
 import {t} from 'app/locale';
 import Button from 'app/components/button';
+import {IconReleases} from 'app/icons';
 
 import {switchReleasesVersion} from './index';
 
@@ -15,11 +16,23 @@ const SwitchReleasesButton = ({orgId, version}: Props) => {
     switchReleasesVersion(version, orgId);
   };
 
+  if (version === '2') {
+    return (
+      <Button
+        priority="primary"
+        size="small"
+        icon={<IconReleases size="sm" />}
+        onClick={switchReleases}
+      >
+        {t('Go to New Releases')}
+      </Button>
+    );
+  }
+
   return (
     <div>
       <Button priority="link" size="small" onClick={switchReleases}>
-        {version === '1' && t('Go to Legacy Releases')}
-        {version === '2' && t('Go to New Releases')}
+        {t('Go to Legacy Releases')}
       </Button>
     </div>
   );
