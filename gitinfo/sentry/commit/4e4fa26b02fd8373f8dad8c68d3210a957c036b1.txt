commit 4e4fa26b02fd8373f8dad8c68d3210a957c036b1
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jun 8 14:42:41 2015 -0700

    Add bulk group stats endpoint

diff --git a/src/sentry/api/endpoints/project_group_stats.py b/src/sentry/api/endpoints/project_group_stats.py
new file mode 100644
index 0000000000..f23880abad
--- /dev/null
+++ b/src/sentry/api/endpoints/project_group_stats.py
@@ -0,0 +1,32 @@
+from __future__ import absolute_import
+
+from rest_framework.response import Response
+
+from sentry.app import tsdb
+from sentry.api.base import StatsMixin
+from sentry.api.bases.project import ProjectEndpoint
+from sentry.models import Group
+
+
+class ProjectGroupStatsEndpoint(ProjectEndpoint, StatsMixin):
+    def get(self, request, project):
+        group_ids = request.GET.getlist('id')
+        if not group_ids:
+            return Response(status=204)
+
+        group_list = Group.objects.filter(project=project, id__in=group_ids)
+        group_ids = [g.id for g in group_list]
+
+        if not group_ids:
+            return Response(status=204)
+
+        data = tsdb.get_range(
+            model=tsdb.models.group,
+            keys=group_ids,
+            **self._parse_args(request)
+        )
+
+        return Response({
+            str(k): v
+            for k, v in data.items()
+        })
diff --git a/src/sentry/api/urls.py b/src/sentry/api/urls.py
index bd6d5bc3f0..41c7fb8e82 100644
--- a/src/sentry/api/urls.py
+++ b/src/sentry/api/urls.py
@@ -30,6 +30,7 @@ from .endpoints.organization_stats import OrganizationStatsEndpoint
 from .endpoints.organization_teams import OrganizationTeamsEndpoint
 from .endpoints.project_details import ProjectDetailsEndpoint
 from .endpoints.project_group_index import ProjectGroupIndexEndpoint
+from .endpoints.project_group_stats import ProjectGroupStatsEndpoint
 from .endpoints.project_keys import ProjectKeysEndpoint
 from .endpoints.project_key_details import ProjectKeyDetailsEndpoint
 from .endpoints.project_member_index import ProjectMemberIndexEndpoint
@@ -124,6 +125,9 @@ urlpatterns = patterns(
     url(r'^projects/(?P<organization_slug>[^\/]+)/(?P<project_slug>[^\/]+)/groups/$',
         ProjectGroupIndexEndpoint.as_view(),
         name='sentry-api-0-project-group-index'),
+    url(r'^projects/(?P<organization_slug>[^\/]+)/(?P<project_slug>[^\/]+)/groups/stats/$',
+        ProjectGroupStatsEndpoint.as_view(),
+        name='sentry-api-0-project-group-stats'),
     url(r'^projects/(?P<organization_slug>[^\/]+)/(?P<project_slug>[^\/]+)/keys/$',
         ProjectKeysEndpoint.as_view(),
         name='sentry-api-0-project-keys'),
diff --git a/tests/sentry/api/endpoints/test_project_group_stats.py b/tests/sentry/api/endpoints/test_project_group_stats.py
new file mode 100644
index 0000000000..fde7e4c3ff
--- /dev/null
+++ b/tests/sentry/api/endpoints/test_project_group_stats.py
@@ -0,0 +1,36 @@
+from django.core.urlresolvers import reverse
+
+from sentry.app import tsdb
+from sentry.testutils import APITestCase
+
+
+class ProjectGroupStatsTest(APITestCase):
+    def test_simple(self):
+        self.login_as(user=self.user)
+
+        project = self.create_project()
+        group1 = self.create_group(project=project)
+        group2 = self.create_group(project=project)
+
+        url = reverse('sentry-api-0-project-group-stats', kwargs={
+            'organization_slug': project.organization.slug,
+            'project_slug': project.slug,
+        })
+        response = self.client.get('%s?id=%s&id=%s' % (url, group1.id, group2.id),
+                                   format='json')
+
+        tsdb.incr(tsdb.models.group, group1.id, count=3)
+
+        response = self.client.get('%s?id=%s&id=%s' % (url, group1.id, group2.id),
+                                   format='json')
+
+        assert response.status_code == 200, response.content
+        assert len(response.data) == 2
+        assert str(group1.id) in response.data
+        assert str(group2.id) in response.data
+
+        group_data = response.data[str(group1.id)]
+        assert group_data[-1][1] == 3, response.data
+        for point in group_data[:-1]:
+            assert point[1] == 0
+        assert len(group_data) == 24
