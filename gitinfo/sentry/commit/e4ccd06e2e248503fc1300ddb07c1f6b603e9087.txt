commit e4ccd06e2e248503fc1300ddb07c1f6b603e9087
Author: William Mak <william@wmak.io>
Date:   Mon Jan 6 16:18:40 2020 -0500

    fix(audit-logs) - Adding ACL to the audit logs endpoint
    
    - using `org:write` which matches what the frontend uses to determine if
      we show that section in our settings.

diff --git a/src/sentry/api/bases/organization.py b/src/sentry/api/bases/organization.py
index 1b81eea689..a0a26af113 100644
--- a/src/sentry/api/bases/organization.py
+++ b/src/sentry/api/bases/organization.py
@@ -64,6 +64,10 @@ class OrganizationPermission(SentryPermission):
         return any(request.access.has_scope(s) for s in allowed_scopes)
 
 
+class OrganizationAuditPermission(OrganizationPermission):
+    scope_map = {"GET": ["org:write"]}
+
+
 class OrganizationEventPermission(OrganizationPermission):
     scope_map = {
         "GET": ["event:read", "event:write", "event:admin"],
diff --git a/src/sentry/api/endpoints/organization_auditlogs.py b/src/sentry/api/endpoints/organization_auditlogs.py
index dd2c79b68b..0b2cb23a88 100644
--- a/src/sentry/api/endpoints/organization_auditlogs.py
+++ b/src/sentry/api/endpoints/organization_auditlogs.py
@@ -3,12 +3,15 @@ from __future__ import absolute_import
 from sentry.api.bases import OrganizationEndpoint
 from sentry.api.paginator import DateTimePaginator
 from sentry.api.serializers import serialize
+from sentry.api.bases.organization import OrganizationAuditPermission
 from sentry.models import AuditLogEntry
 
 EVENT_REVERSE_MAP = {v: k for k, v in AuditLogEntry._meta.get_field("event").choices}
 
 
 class OrganizationAuditLogsEndpoint(OrganizationEndpoint):
+    permission_classes = (OrganizationAuditPermission,)
+
     def get(self, request, organization):
         queryset = AuditLogEntry.objects.filter(organization=organization).select_related("actor")
 
