commit 48d860324a0372d0cf9982c0481d556bb7a6b6a5
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Dec 17 12:59:15 2019 -0800

    feat(sdk): Add configurable self-tracing

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 89a8e42d39..7baa8fa9fa 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -916,6 +916,9 @@ SENTRY_FRONTEND_DSN = None
 # Configuration for JavaScript's whitelistUrls - defaults to ALLOWED_HOSTS
 SENTRY_FRONTEND_WHITELIST_URLS = None
 
+# Sample rate for Sentry transactions
+SENTRY_APM_SAMPLING = 0
+
 # DSN to use for Sentry monitors
 SENTRY_MONITOR_DSN = None
 SENTRY_MONITOR_API_ROOT = None
diff --git a/src/sentry/static/sentry/app/bootstrap.jsx b/src/sentry/static/sentry/app/bootstrap.jsx
index 259bae7733..50a22a005c 100644
--- a/src/sentry/static/sentry/app/bootstrap.jsx
+++ b/src/sentry/static/sentry/app/bootstrap.jsx
@@ -32,7 +32,7 @@ if (window.__initialData) {
 // SDK INIT  --------------------------------------------------------
 const config = ConfigStore.getConfig();
 // Only enable self-tracing when isApmDataSamplingEnabled is true
-const tracesSampleRate = config && config.isApmDataSamplingEnabled ? 1 : 0;
+const tracesSampleRate = config ? config.apmSampling : 0;
 Sentry.init({
   ...window.__SENTRY__OPTIONS,
   integrations: [
diff --git a/src/sentry/web/client_config.py b/src/sentry/web/client_config.py
index 21b776a74a..120d4a6742 100644
--- a/src/sentry/web/client_config.py
+++ b/src/sentry/web/client_config.py
@@ -146,6 +146,7 @@ def get_client_config(request=None):
         "dsn": public_dsn,
         "statuspage": _get_statuspage(),
         "messages": [{"message": msg.message, "level": msg.tags} for msg in messages],
+        "apmSampling": float(settings.SENTRY_APM_SAMPLING or 0),
         "isOnPremise": settings.SENTRY_ONPREMISE,
         "invitesEnabled": settings.SENTRY_ENABLE_INVITES,
         "gravatarBaseUrl": settings.SENTRY_GRAVATAR_BASE_URL,
