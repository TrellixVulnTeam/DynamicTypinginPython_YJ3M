commit 1d72aa606f845ff565da4406706450bfe8f822a7
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 26 17:12:37 2011 -0800

    Added status page for sentry

diff --git a/sentry/__init__.py b/sentry/__init__.py
index 3f9b259260..79f261cf0b 100644
--- a/sentry/__init__.py
+++ b/sentry/__init__.py
@@ -11,3 +11,6 @@ try:
         .get_distribution('django-sentry').version
 except Exception, e:
     VERSION = 'unknown'
+
+# We store global interpreter state in here
+environment = {}
diff --git a/sentry/scripts/runner.py b/sentry/scripts/runner.py
index 3ada75e588..08a1c6a349 100644
--- a/sentry/scripts/runner.py
+++ b/sentry/scripts/runner.py
@@ -1,5 +1,6 @@
 #!/usr/bin/env python
 import base64
+import datetime
 import eventlet
 import errno
 import imp
@@ -14,7 +15,7 @@ from django.conf import settings as django_settings
 from django.core.management import call_command
 from eventlet import wsgi, patcher
 from optparse import OptionParser
-from sentry import VERSION
+from sentry import VERSION, environment
 
 patcher.monkey_patch()
 
@@ -299,6 +300,9 @@ def main():
         except OSError, e:
             raise e.__class__, 'Unable to write default settings file to %r' % config_path
 
+    environment['config'] = config_path
+    environment['start_date'] = datetime.datetime.now()
+
     settings_from_file(config_path)
 
     if getattr(options, 'debug', False):
diff --git a/sentry/static/styles/bootstrap.css b/sentry/static/styles/bootstrap.css
index 8fd4fd4177..a468b1c774 100644
--- a/sentry/static/styles/bootstrap.css
+++ b/sentry/static/styles/bootstrap.css
@@ -6,7 +6,7 @@
  * http://www.apache.org/licenses/LICENSE-2.0
  *
  * Designed and built with all the love in the world @twitter by @mdo and @fat.
- * Date: Mon Dec 26 16:27:02 PST 2011
+ * Date: Mon Dec 26 17:12:27 PST 2011
  */
 /* Reset.less
  * Props to Eric Meyer (meyerweb.com) for his CSS reset file. We're using an adapted version here	that cuts out some of the reset HTML elements we will never need here (i.e., dfn, samp, etc).
diff --git a/sentry/static/styles/global.css b/sentry/static/styles/global.css
index f5e38af79e..8124a4a1cd 100644
--- a/sentry/static/styles/global.css
+++ b/sentry/static/styles/global.css
@@ -163,13 +163,9 @@ a:visited { color: inherit; }*/
 
 /* tracebacks */
 .frame table.vars { margin:5px 0 2px 35px; }
-table.vars tbody td:first-child { padding-right: 20px; }
-table.vars td { font-family:monospace; }
 table.vars td.code { overflow: hidden; }
 table.vars td.code pre { margin-bottom: 0; }
 div.pastebin textarea { padding: 10px; background: #f9f9f9; border-color: #ddd; }
-table.vars { border-collapse: collapse; background:white; margin-bottom: 10px; }
-table.vars thead th { padding:3px 6px 3px 3px; background:#eee; text-align:left; font-weight:bold; border:1px solid #ddd; border-width: 1px 0; font-size:11px; }
 
 ul.traceback { list-style-type: none; margin-left: 0;}
 ul.traceback li.frame { margin-bottom: 1em; overflow: hidden; position: relative; }
diff --git a/sentry/templates/sentry/layout.html b/sentry/templates/sentry/layout.html
index f95f9a7d62..36d4417de1 100644
--- a/sentry/templates/sentry/layout.html
+++ b/sentry/templates/sentry/layout.html
@@ -34,10 +34,12 @@
                     <div class="container">
                         <a class="brand" href="{% url sentry %}">Sentry</a>
                         <ul class="nav">
-<!--                             <li class="active"><a href="#">Home</a></li>
-                            <li><a href="#about">About</a></li>
-                            <li><a href="#contact">Contact</a></li>
- -->                        </ul>
+                            <li><a href="{% url sentry %}">Home</a></li>
+                            {% if project and project_list|length > 1 %}
+                                <li><a href="{% url sentry project.pk %}">{{ project.name }}</a></li>
+                            {% endif %}
+                            <li><a href="{% url sentry-status %}">Status</a></li>
+                        </ul>
                         <ul class="nav secondary-nav">
                             {% if request.user.is_authenticated %}
                                 {% if project_list and project_list|length > 1 %}
diff --git a/sentry/templates/sentry/status.html b/sentry/templates/sentry/status.html
new file mode 100644
index 0000000000..d487b46136
--- /dev/null
+++ b/sentry/templates/sentry/status.html
@@ -0,0 +1,56 @@
+{% extends "sentry/layout.html" %}
+
+{% load i18n %}
+{% load sentry_helpers %}
+
+{% block title %}{% trans "Sentry Status" %} | {{ block.super }}{% endblock %}
+
+{% block heading %}{% trans "Sentry Status" %}{% endblock %}
+
+{% block content %}
+    <div class="span16">
+        <div class="page-header">
+            <h2>Environment</h2>
+        </div>
+        {% if environment %}
+            <table class="vars bordered-table zebra-striped">
+                <colgroup>
+                    <col style="width:220px">
+                </colgroup>
+                <tbody>
+                    <tr>
+                        <th>Server Version</th>
+                        <td>{% sentry_version %}</td>
+                    </tr>
+                    <tr>
+                        <th>Configuration File</th>
+                        <td>{{ environment.config }}</td>
+                    </tr>
+                    <tr>
+                        <th>Uptime</th>
+                        <td>{{ environment.start_date|timesince }} (since {{ environment.start_date|date }})</td>
+                    </tr>
+                </tbody>
+            </table>
+        {% else %}
+            <p>Environment not found (are you using the builtin Sentry webserver?).</p>
+        {% endif %}
+
+        <div class="page-header">
+            <h2>Configuration{% if environment.config %} <small>{{ environment.config }}</small>{% endif %}</h2>
+        </div>
+        <table class="vars bordered-table zebra-striped">
+            <colgroup>
+                <col style="width:220px">
+            </colgroup>
+            <tbody>
+                {% for key, value in config %}
+                    <tr>
+                        <th>{{ key }}</th>
+                        <td class="code"><pre>{{ value|pprint }}</pre></td>
+                    </tr>
+                {% endfor %}
+            </tbody>
+        </table>
+    </div>
+{% endblock %}
diff --git a/sentry/web/frontend/generic.py b/sentry/web/frontend/generic.py
index eaef4367c6..1dd45a4d26 100644
--- a/sentry/web/frontend/generic.py
+++ b/sentry/web/frontend/generic.py
@@ -2,6 +2,7 @@ from django.core.urlresolvers import reverse
 from django.http import HttpResponseRedirect, Http404, HttpResponseNotModified, \
   HttpResponse
 
+from sentry import environment
 from sentry.conf import settings
 from sentry.web.decorators import login_required
 from sentry.web.helpers import get_project_list, render_to_response
@@ -15,6 +16,24 @@ def dashboard(request):
     return render_to_response('sentry/dashboard.html', request=request)
 
 
+@login_required
+def status(request):
+    config = []
+    for k in sorted(dir(settings)):
+        if k == 'KEY':
+            continue
+        if k.startswith('_'):
+            continue
+        if k.upper() != k:
+            continue
+        config.append((k, getattr(settings, k)))
+
+    return render_to_response('sentry/status.html', {
+        'config': config,
+        'environment': environment,
+    }, request)
+
+
 def static_media(request, path):
     """
     Serve static files below a given point in the directory structure.
diff --git a/sentry/web/urls.py b/sentry/web/urls.py
index ed06d1484c..49a327ba42 100644
--- a/sentry/web/urls.py
+++ b/sentry/web/urls.py
@@ -70,6 +70,7 @@ urlpatterns = patterns('',
     # Global
 
     url(r'^$', generic.dashboard, name='sentry'),
+    url(r'^status$', generic.status, name='sentry-status'),
 
     # JS
 
