commit ff6a13847351d456df6507a286e9542fe1de43dc
Author: Brett Hoerner <brett@bretthoerner.com>
Date:   Wed Jan 17 16:49:02 2018 -0600

    fix(tags): Prevent schema migration from dropping legacy tagstore tabâ€¦ (#6993)

diff --git a/src/sentry/tagstore/models.py b/src/sentry/tagstore/models.py
index eb0277879f..860d574d1c 100644
--- a/src/sentry/tagstore/models.py
+++ b/src/sentry/tagstore/models.py
@@ -17,15 +17,14 @@ if settings.SENTRY_TAGSTORE.startswith('sentry.tagstore.legacy'):
     from sentry.tagstore.legacy.models import *  # NOQA
 elif settings.SENTRY_TAGSTORE.startswith('sentry.tagstore.v2'):
     from sentry.tagstore.v2.models import *  # NOQA
+
+    # Prevent schema migration from adding DROP TABLE for Legacy
+    from sentry.tagstore.legacy import models as _legacy_models  # NOQA
 elif settings.SENTRY_TAGSTORE.startswith('sentry.tagstore.multi'):
     for backend in settings.SENTRY_TAGSTORE_OPTIONS.get('backends', []):
         if backend[0].startswith('sentry.tagstore.legacy'):
             from sentry.tagstore.legacy.models import *  # NOQA
         elif backend[0].startswith('sentry.tagstore.v2'):
-            from sentry.tagstore.v2.models import TagKey as V2TagKey  # NOQA
-            from sentry.tagstore.v2.models import TagValue as V2TagValue  # NOQA
-            from sentry.tagstore.v2.models import GroupTagKey as V2GroupTagKey  # NOQA
-            from sentry.tagstore.v2.models import GroupTagValue as V2GroupTagValue  # NOQA
-            from sentry.tagstore.v2.models import EventTag as V2EventTag  # NOQA
+            from sentry.tagstore.v2 import models as _v2_models  # NOQA
 else:
     raise ImproperlyConfigured("Found unknown tagstore backend '%s'" % settings.SENTRY_TAGSTORE)
