commit 21e7f1227d67bbd29555582bc182cc5a8b2d5a1c
Author: Daniel Griesser <daniel.griesser.86@gmail.com>
Date:   Tue Sep 26 13:59:28 2017 +0200

    fix: Always use project dsym instead versioned
    
    Fixes GH-6192

diff --git a/src/sentry/api/endpoints/dsym_files.py b/src/sentry/api/endpoints/dsym_files.py
index dc3e7b7b8b..c97c20d5d2 100644
--- a/src/sentry/api/endpoints/dsym_files.py
+++ b/src/sentry/api/endpoints/dsym_files.py
@@ -50,27 +50,29 @@ class DSymFilesEndpoint(ProjectEndpoint):
 
     content_negotiation_class = ConditionalContentNegotiation
 
-    def download(self, version_dsym_id, project):
+    def download(self, project_dsym_id, project):
         rate_limited = ratelimits.is_limited(
             project=project,
             key='rl:DSymFilesEndpoint:download:%s:%s' % (
-                version_dsym_id, project.id),
+                project_dsym_id, project.id),
             limit=10,
         )
         if rate_limited:
             logger.info('notification.rate_limited',
                         extra={'project_id': project.id,
-                               'version_dsym_id': version_dsym_id})
+                               'project_dsym_id': project_dsym_id})
             return HttpResponse(
                 {
                     'Too many download requests',
                 }, status=403
             )
 
-        versioned_dsym = VersionDSymFile.objects.filter(
-            id=version_dsym_id
-        ).select_related('projectdsymfile').first()
-        dsym = versioned_dsym.dsym_file
+        dsym = ProjectDSymFile.objects.filter(
+            id=project_dsym_id
+        ).first()
+
+        if dsym is None:
+            raise Http404
 
         suffix = ".dSYM"
         if dsym.dsym_type == 'proguard' and dsym.object_name == 'proguard-mapping':
diff --git a/src/sentry/static/sentry/app/views/projectDebugSymbols.jsx b/src/sentry/static/sentry/app/views/projectDebugSymbols.jsx
index d61565cc45..10d5f5b3d9 100644
--- a/src/sentry/static/sentry/app/views/projectDebugSymbols.jsx
+++ b/src/sentry/static/sentry/app/views/projectDebugSymbols.jsx
@@ -292,7 +292,7 @@ const ProjectDebugSymbols = React.createClass({
       if (dsym === undefined || dsym === null) {
         return null;
       }
-      const url = `${this.api.baseUrl}/projects/${orgId}/${projectId}/files/dsyms/?download_id=${dsymFile.id}`;
+      const url = `${this.api.baseUrl}/projects/${orgId}/${projectId}/files/dsyms/?download_id=${dsym.id}`;
       return (
         <tr key={key}>
           <td>
