commit eef2cfa0293c3e1b603d281c811e178be603414b
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Aug 14 20:06:01 2013 -0700

    Add accept-encoding header to url fetching

diff --git a/src/sentry/tasks/fetch_source.py b/src/sentry/tasks/fetch_source.py
index ff69c343b1..ef445640b4 100644
--- a/src/sentry/tasks/fetch_source.py
+++ b/src/sentry/tasks/fetch_source.py
@@ -102,7 +102,10 @@ def fetch_url_content(url):
 
     try:
         opener = urllib2.build_opener()
-        opener.addheaders = [('User-Agent', 'Sentry/%s' % sentry.VERSION)]
+        opener.addheaders = [
+            ('Accept-Encoding', 'gzip'),
+            ('User-Agent', 'Sentry/%s' % sentry.VERSION),
+        ]
         req = opener.open(url)
         headers = dict(req.headers)
         body = req.read()
@@ -113,6 +116,7 @@ def fetch_url_content(url):
             body = zlib.decompress(body, 16 + zlib.MAX_WBITS)
         body = body.rstrip('\n')
     except Exception:
+        logging.info('Failed fetching %r', url, exc_info=True)
         return BAD_SOURCE
 
     return (url, headers, body)
