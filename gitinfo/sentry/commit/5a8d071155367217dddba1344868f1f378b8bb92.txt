commit 5a8d071155367217dddba1344868f1f378b8bb92
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Fri Aug 24 10:03:22 2018 -0700

    fix(ui): Fix parsing API error response in GroupEvents (#9504)
    
    Related to https://github.com/getsentry/sentry/pull/9477
    Fixes JAVASCRIPT-3WD

diff --git a/src/sentry/static/sentry/app/utils/parseApiError.jsx b/src/sentry/static/sentry/app/utils/parseApiError.jsx
new file mode 100644
index 0000000000..0a15c573c7
--- /dev/null
+++ b/src/sentry/static/sentry/app/utils/parseApiError.jsx
@@ -0,0 +1,10 @@
+export default function parseApiError(resp) {
+  let {detail} = (resp && resp.responseJSON) || {};
+
+  // return immediately if string
+  if (typeof detail === 'string') return detail;
+
+  if (detail && detail.message) return detail.message;
+
+  return 'Unknown API Error';
+}
diff --git a/src/sentry/static/sentry/app/views/groupEvents.jsx b/src/sentry/static/sentry/app/views/groupEvents.jsx
index 449e33de49..da7ce0307b 100644
--- a/src/sentry/static/sentry/app/views/groupEvents.jsx
+++ b/src/sentry/static/sentry/app/views/groupEvents.jsx
@@ -1,22 +1,23 @@
+import {browserHistory} from 'react-router';
 import React from 'react';
 import createReactClass from 'create-react-class';
-import {browserHistory} from 'react-router';
 
-import SentryTypes from 'app/sentryTypes';
+import {Panel, PanelBody} from 'app/components/panels';
+import {getQueryEnvironment, getQueryStringWithEnvironment} from 'app/utils/queryString';
+import {setActiveEnvironment} from 'app/actionCreators/environments';
+import {t, tct} from 'app/locale';
 import ApiMixin from 'app/mixins/apiMixin';
+import EmptyStateWarning from 'app/components/emptyStateWarning';
+import EnvironmentStore from 'app/stores/environmentStore';
+import EventsTable from 'app/components/eventsTable/eventsTable';
 import GroupState from 'app/mixins/groupState';
 import LoadingError from 'app/components/loadingError';
 import LoadingIndicator from 'app/components/loadingIndicator';
 import Pagination from 'app/components/pagination';
 import SearchBar from 'app/components/searchBar';
-import EventsTable from 'app/components/eventsTable/eventsTable';
-import {t, tct} from 'app/locale';
+import SentryTypes from 'app/sentryTypes';
+import parseApiError from 'app/utils/parseApiError';
 import withEnvironment from 'app/utils/withEnvironment';
-import {getQueryEnvironment, getQueryStringWithEnvironment} from 'app/utils/queryString';
-import EnvironmentStore from 'app/stores/environmentStore';
-import {setActiveEnvironment} from 'app/actionCreators/environments';
-import EmptyStateWarning from 'app/components/emptyStateWarning';
-import {Panel, PanelBody} from 'app/components/panels';
 
 const GroupEvents = createReactClass({
   displayName: 'GroupEvents',
@@ -122,10 +123,8 @@ const GroupEvents = createReactClass({
         });
       },
       error: err => {
-        let error = err.responseJSON || true;
-        error = error.detail || true;
         this.setState({
-          error,
+          error: parseApiError(err),
           loading: false,
         });
       },
diff --git a/src/sentry/static/sentry/app/views/stream/stream.jsx b/src/sentry/static/sentry/app/views/stream/stream.jsx
index 0abef70ee2..39b6317a78 100644
--- a/src/sentry/static/sentry/app/views/stream/stream.jsx
+++ b/src/sentry/static/sentry/app/views/stream/stream.jsx
@@ -31,6 +31,7 @@ import StreamGroup from 'app/components/stream/group';
 import StreamSidebar from 'app/views/stream/sidebar';
 import TimeSince from 'app/components/timeSince';
 import analytics from 'app/utils/analytics';
+import parseApiError from 'app/utils/parseApiError';
 import parseLinkHeader from 'app/utils/parseLinkHeader';
 import queryString from 'app/utils/queryString';
 import utils from 'app/utils';
@@ -421,14 +422,8 @@ const Stream = createReactClass({
         });
       },
       error: err => {
-        let {detail} = (err && err.responseJSON) || {};
-        let error =
-          typeof detail === 'string'
-            ? detail
-            : (detail && detail.message) || 'Unknown HTTP error';
-
         this.setState({
-          error,
+          error: parseApiError(err),
           dataLoading: false,
         });
       },
