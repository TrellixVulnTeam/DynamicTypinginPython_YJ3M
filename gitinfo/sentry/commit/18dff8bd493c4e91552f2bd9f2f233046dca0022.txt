commit 18dff8bd493c4e91552f2bd9f2f233046dca0022
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Sat Aug 30 18:43:33 2014 +0000

    Validate ip address with ipaddr
    
    Also now supports ipv6 addresses

diff --git a/src/sentry/interfaces/user.py b/src/sentry/interfaces/user.py
index d0ee9fb373..a670e791c3 100644
--- a/src/sentry/interfaces/user.py
+++ b/src/sentry/interfaces/user.py
@@ -11,17 +11,15 @@ __all__ = ('User',)
 from sentry.interfaces.base import Interface
 from sentry.utils.safe import trim, trim_dict
 from sentry.web.helpers import render_to_string
+from ipaddr import IPAddress
 
 
 def validate_ip(value, required=True):
-    # TODO(dcramer): we should just use ipaddr here
     if not required and not value:
         return
 
-    assert value.count('.') == 3
-    for comp in value.split('.'):
-        assert comp.isdigit()
-        assert -1 < int(comp) <= 256
+    # will raise a ValueError
+    IPAddress(value)
     return value
 
 
