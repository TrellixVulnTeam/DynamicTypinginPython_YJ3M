commit 054211e8ecdf8fd07d14d40e84183e1a3af474bf
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Sep 21 06:01:02 2015 -0700

    Wrap buffer process_pending in Lock
    
    This should greatly reduce cascades with the current design.

diff --git a/src/sentry/tasks/process_buffer.py b/src/sentry/tasks/process_buffer.py
index c438c4c4cb..8153a4d7c1 100644
--- a/src/sentry/tasks/process_buffer.py
+++ b/src/sentry/tasks/process_buffer.py
@@ -9,6 +9,7 @@ sentry.tasks.process_buffer
 from __future__ import absolute_import
 
 from sentry.tasks.base import instrumented_task
+from sentry.utils.cache import Lock
 
 
 @instrumented_task(
@@ -18,8 +19,9 @@ def process_pending():
     Process pending buffers.
     """
     from sentry import app
-
-    app.buffer.process_pending()
+    lock_key = 'buffer:process_pending'
+    with Lock(lock_key, nowait=True, timeout=60):
+        app.buffer.process_pending()
 
 
 @instrumented_task(
