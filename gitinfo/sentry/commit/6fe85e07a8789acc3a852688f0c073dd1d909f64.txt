commit 6fe85e07a8789acc3a852688f0c073dd1d909f64
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Tue Jan 3 10:09:36 2017 -0800

    accounts: add rate limit to password recovery form submission
    
    People are attempting to abuse this to send out lots of email.

diff --git a/src/sentry/web/frontend/accounts.py b/src/sentry/web/frontend/accounts.py
index 23a7bbe0e9..34ea39187e 100644
--- a/src/sentry/web/frontend/accounts.py
+++ b/src/sentry/web/frontend/accounts.py
@@ -65,6 +65,18 @@ def expired(request, user):
 
 
 def recover(request):
+    from sentry.app import ratelimiter
+
+    if request.method == 'POST' and ratelimiter.is_limited(
+        'accounts:recover:{}'.format(request.META['REMOTE_ADDR']),
+        limit=5, window=60,  # 5 per minute should be enough for anyone
+    ):
+        return HttpResponse(
+            'You have made too many password recovery attempts. Please try again later.',
+            content_type='text/plain',
+            status=429,
+        )
+
     form = RecoverPasswordForm(request.POST or None)
     if form.is_valid():
         password_hash = send_password_recovery_mail(form.cleaned_data['user'])
