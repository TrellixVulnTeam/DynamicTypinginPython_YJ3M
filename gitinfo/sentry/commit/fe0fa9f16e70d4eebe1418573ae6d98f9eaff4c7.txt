commit fe0fa9f16e70d4eebe1418573ae6d98f9eaff4c7
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Aug 7 08:43:22 2018 -0700

    Prevent duplicate post_syncdb signal actions

diff --git a/src/sentry/models/counter.py b/src/sentry/models/counter.py
index 2167f61386..81e8e031a9 100644
--- a/src/sentry/models/counter.py
+++ b/src/sentry/models/counter.py
@@ -60,7 +60,7 @@ def increment_project_counter(project, delta=1):
                  where project_id = %s
             ''', [project.id]
             ).fetchone()[0]
-            while 1:
+            while True:
                 cur.execute(
                     '''
                     update sentry_projectcounter
@@ -95,7 +95,10 @@ def increment_project_counter(project, delta=1):
 
 # this must be idempotent because it seems to execute twice
 # (at least during test runs)
-def create_counter_function(db, created_models, **kwargs):
+def create_counter_function(db, created_models, app, **kwargs):
+    if app.__name__ != 'sentry.models':
+        return
+
     if not is_postgres(db):
         return
 
diff --git a/src/sentry/receivers/core.py b/src/sentry/receivers/core.py
index 166df48fc4..5a8d85d6ef 100644
--- a/src/sentry/receivers/core.py
+++ b/src/sentry/receivers/core.py
@@ -36,7 +36,10 @@ def handle_db_failure(func):
     return wrapped
 
 
-def create_default_projects(created_models, verbosity=2, **kwargs):
+def create_default_projects(created_models, app, verbosity=2, **kwargs):
+    if app.__name__ != 'sentry.models':
+        return
+
     if Project not in created_models:
         return
 
@@ -125,7 +128,10 @@ def set_sentry_version(latest=None, **kwargs):
     options.set('sentry:latest_version', (latest or current))
 
 
-def create_keys_for_project(instance, created, **kwargs):
+def create_keys_for_project(instance, created, app, **kwargs):
+    if app.__name__ != 'sentry.models':
+        return
+
     if not created or kwargs.get('raw'):
         return
 
diff --git a/src/sentry/receivers/users.py b/src/sentry/receivers/users.py
index f84d2f1a55..0543610324 100644
--- a/src/sentry/receivers/users.py
+++ b/src/sentry/receivers/users.py
@@ -7,8 +7,12 @@ from sentry.models import User
 
 
 def create_first_user(app, created_models, verbosity, db, **kwargs):
+    # this is super confusing
+    if app.__name__ != 'sentry.models':
+        return
     if User not in created_models:
         return
+
     if hasattr(router, 'allow_migrate'):
         if not router.allow_migrate(db, User):
             return
