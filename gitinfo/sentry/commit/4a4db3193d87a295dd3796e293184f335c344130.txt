commit 4a4db3193d87a295dd3796e293184f335c344130
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Feb 6 13:58:12 2014 -0800

    Edge case for PHP anonymous functions

diff --git a/src/sentry/interfaces.py b/src/sentry/interfaces.py
index a676978d80..bee3d94aec 100644
--- a/src/sentry/interfaces.py
+++ b/src/sentry/interfaces.py
@@ -368,8 +368,19 @@ class Frame(object):
         elif self.filename and not self.is_url():
             output.append(remove_filename_outliers(self.filename))
 
+        if self.context_line is None:
+            can_use_context = False
+        elif len(self.context_line) > 120:
+            can_use_context = False
+        # XXX: deal with PHP anonymous functions (used for things like SQL
+        # queries and JSON data)
+        elif self.function and self.function.startswith('[Anonymous'):
+            can_use_context = True
+        else:
+            can_use_context = True
+
         # XXX: hack around what appear to be non-useful lines of context
-        if self.context_line is not None and len(self.context_line) < 120:
+        if can_use_context:
             output.append(self.context_line)
         elif not output:
             # If we were unable to achieve any context at this point
