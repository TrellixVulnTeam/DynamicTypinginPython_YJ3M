commit 948252ecf2122b6d72ef29516bd0ac9a73080ed1
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Thu Feb 22 12:02:36 2018 -0800

    feat(environments): Support sentry_environment querystring arg

diff --git a/src/sentry/web/api.py b/src/sentry/web/api.py
index 3e616ef516..5fab9c293d 100644
--- a/src/sentry/web/api.py
+++ b/src/sentry/web/api.py
@@ -680,6 +680,7 @@ class SecurityReportView(StoreView):
             'interface': interface.path,
             'report': instance,
             'release': request.GET.get('sentry_release'),
+            'environment': request.GET.get('sentry_environment'),
         }
 
         response_or_event_id = self.process(
diff --git a/tests/sentry/coreapi/tests.py b/tests/sentry/coreapi/tests.py
index 0844391bf2..89f5751272 100644
--- a/tests/sentry/coreapi/tests.py
+++ b/tests/sentry/coreapi/tests.py
@@ -662,6 +662,7 @@ class SecurityApiHelperTest(BaseAPITest):
     def test_csp_validate_basic(self):
         report = {
             "release": "abc123",
+            "environment": "production",
             "interface": 'sentry.interfaces.Csp',
             "report": {
                 "csp-report": {
@@ -678,6 +679,7 @@ class SecurityApiHelperTest(BaseAPITest):
         result = self.validate_and_normalize(report)
         assert result['logger'] == 'csp'
         assert result['release'] == 'abc123'
+        assert result['environment'] == 'production'
         assert result['errors'] == []
         assert 'sentry.interfaces.Message' in result
         assert 'culprit' in result
