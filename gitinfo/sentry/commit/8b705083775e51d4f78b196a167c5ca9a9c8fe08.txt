commit 8b705083775e51d4f78b196a167c5ca9a9c8fe08
Author: Yaniv Aknin <yaniv@aknin.name>
Date:   Wed Dec 28 21:39:34 2011 +0200

    add --service to the start command (so far, only http service)

diff --git a/sentry/commands/start.py b/sentry/commands/start.py
index 6aee04d042..55eebcac30 100644
--- a/sentry/commands/start.py
+++ b/sentry/commands/start.py
@@ -16,11 +16,14 @@ from sentry.commands.utils import options, opt
     opt('--debug', action='store_true', default=False, dest='debug'),
     opt('--pidfile', dest='pidfile'),
     opt('--logfile', dest='logfile'),
+    opt('--service', dest='service', default='http', choices=['http']),
 )
-def start(daemonize=False, host=None, port=None, debug=False, pidfile=None, logfile=None):
-    from sentry.utils.server import SentryServer
-
-    app = SentryServer(
+def start(daemonize=False, host=None, port=None, debug=False, pidfile=None, logfile=None, service='http'):
+    from sentry.utils import server
+    app_class = {
+        'http': server.SentryHTTPServer,
+    }[service]
+    app = app_class(
         host=host,
         port=port,
         pidfile=pidfile,
diff --git a/sentry/utils/server.py b/sentry/utils/server.py
index 02aca24413..be323e487b 100644
--- a/sentry/utils/server.py
+++ b/sentry/utils/server.py
@@ -57,6 +57,7 @@ class SentryServer(DaemonRunner):
         else:
             self.do_action()
 
+class SentryHTTPServer(SentryServer):
     def run(self):
         from sentry.wsgi import application
 
