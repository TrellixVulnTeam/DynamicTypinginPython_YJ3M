commit 3f3ff03908038ab2602d1250ab2dbea68431f886
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Apr 15 19:38:48 2012 -0700

    More sane slug migrations

diff --git a/sentry/migrations/0047_migrate_project_slugs.py b/sentry/migrations/0047_migrate_project_slugs.py
index 4d829022fc..b462c3d54d 100644
--- a/sentry/migrations/0047_migrate_project_slugs.py
+++ b/sentry/migrations/0047_migrate_project_slugs.py
@@ -12,11 +12,13 @@ class Migration(DataMigration):
         from sentry.utils.models import update
 
         for project in orm['sentry.Project'].objects.all():
+            if project.slug:
+                continue
             base_slug = slugify(project.name)
             slug = base_slug
             n = 0
             while True:
-                if orm['sentry.Project'].objects.filter(slug=slug):
+                if orm['sentry.Project'].objects.filter(slug=slug).exists():
                     n += 1
                     slug = base_slug + '-' + str(n)
                     continue
