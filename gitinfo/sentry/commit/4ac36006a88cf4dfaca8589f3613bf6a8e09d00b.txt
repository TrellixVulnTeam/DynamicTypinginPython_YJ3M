commit 4ac36006a88cf4dfaca8589f3613bf6a8e09d00b
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jul 29 22:09:55 2015 -0700

    Various fixes for passing through date values

diff --git a/src/sentry/static/sentry/app/components/dateTimeInput.jsx b/src/sentry/static/sentry/app/components/dateTimeInput.jsx
index 276a72b206..f879d0ece8 100644
--- a/src/sentry/static/sentry/app/components/dateTimeInput.jsx
+++ b/src/sentry/static/sentry/app/components/dateTimeInput.jsx
@@ -4,14 +4,22 @@ var DatePicker = require("react-datepicker");
 
 var DateTimeInput = React.createClass({
   getInitialState() {
+    var datetime = this.props.dateTime;
+    if (!datetime) {
+      return {
+        dateValue: null,
+        timeValue: ''
+      };
+    }
+
     return {
-      dateValue: moment(),
-      timeValue: ''
+      dateValue: datetime,
+      timeValue: datetime.format("HH:MM")
     };
   },
 
   render() {
-    var {dateValue, timeValue, month} = this.state;
+    var {dateValue, timeValue} = this.state;
 
     var selectedDay = moment(dateValue, "L", true).toDate();
 
diff --git a/src/sentry/static/sentry/app/views/stream.jsx b/src/sentry/static/sentry/app/views/stream.jsx
index 07311cde50..cd4da38921 100644
--- a/src/sentry/static/sentry/app/views/stream.jsx
+++ b/src/sentry/static/sentry/app/views/stream.jsx
@@ -2,6 +2,7 @@ var React = require("react");
 var Reflux = require("reflux");
 var $ = require("jquery");
 var Cookies = require("js-cookie");
+var moment = require("moment");
 
 var api = require("../api");
 var GroupActions = require("../actions/groupActions");
@@ -31,7 +32,7 @@ var Stream = React.createClass({
 
   getDefaultProps() {
     var dateFrom = new Date(); dateFrom.setDate(dateFrom.getDate() - 3);
-    dateFrom = dateFrom.getTime() / 1000;
+    dateFrom = moment(dateFrom);
 
     return {
       defaultQuery: "is:unresolved",
@@ -182,7 +183,7 @@ var Stream = React.createClass({
     queryParams.limit = this.props.maxItems;
     queryParams.statsPeriod = this.state.statsPeriod;
     if (!queryParams.hasOwnProperty("since")) {
-      queryParams.since = this.props.defaultDateFrom;
+      queryParams.since = this.props.defaultDateFrom.toISOString();
     }
     if (!queryParams.hasOwnProperty("query")) {
       queryParams.query = this.props.defaultQuery;
@@ -322,6 +323,7 @@ var Stream = React.createClass({
     return (
       <div>
         <StreamFilters query={this.state.query}
+          defaultDateFrom={this.props.defaultDateFrom}
           defaultQuery={this.props.defaultQuery}
           onQueryChange={this.onQueryChange}
           onFilterChange={this.onFilterChange}
@@ -334,8 +336,7 @@ var Stream = React.createClass({
             onRealtimeChange={this.onRealtimeChange}
             realtimeActive={this.state.realtimeActive}
             statsPeriod={this.state.statsPeriod}
-            groupIds={this.state.groupIds}
-            defaultDateFrom={this.props.defaultDateFrom} />
+            groupIds={this.state.groupIds} />
         </div>
         {this.renderStreamBody()}
         <Pagination pageLinks={this.state.pageLinks} onPage={this.onPage} />
diff --git a/src/sentry/static/sentry/app/views/stream/dateSelector.jsx b/src/sentry/static/sentry/app/views/stream/dateSelector.jsx
index 65df425567..319f5f2d4e 100644
--- a/src/sentry/static/sentry/app/views/stream/dateSelector.jsx
+++ b/src/sentry/static/sentry/app/views/stream/dateSelector.jsx
@@ -1,5 +1,6 @@
 var PureRenderMixin = require('react/addons').addons.PureRenderMixin;
 var React = require("react");
+var moment = require("moment");
 
 var DateTimeInput = require("../../components/dateTimeInput");
 var DropdownLink = require("../../components/dropdownLink");
@@ -13,8 +14,8 @@ var CustomDateRange = React.createClass({
   getInitialState() {
     return {
       isModalOpen: false,
-      dateFrom: '',
-      dateTo: '',
+      dateFrom: this.props.dateFrom,
+      dateTo: this.props.dateTo,
       dateType: 'last_seen'
     };
   },
@@ -153,7 +154,9 @@ var DateSelector = React.createClass({
           title="Since: All time">
         <MenuItem>All Time</MenuItem>
         <MenuItem noAnchor={true}>
-          <CustomDateRange />
+          <CustomDateRange
+            dateFrom={this.state.dateFrom}
+            dateTo={this.state.dateTo} />
         </MenuItem>
       </DropdownLink>
     );
diff --git a/src/sentry/static/sentry/app/views/stream/filters.jsx b/src/sentry/static/sentry/app/views/stream/filters.jsx
index d780f56dc3..1a92bb486d 100644
--- a/src/sentry/static/sentry/app/views/stream/filters.jsx
+++ b/src/sentry/static/sentry/app/views/stream/filters.jsx
@@ -16,6 +16,7 @@ var StreamFilters = React.createClass({
   getDefaultProps() {
     return {
       defaultQuery: "",
+      defaultDateFrom: "",
       filter: "",
       query: "",
       onFilterChange: function() {},
