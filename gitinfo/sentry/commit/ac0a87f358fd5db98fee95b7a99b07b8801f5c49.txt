commit ac0a87f358fd5db98fee95b7a99b07b8801f5c49
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 15 01:24:46 2014 -0800

    Correct project settings link

diff --git a/src/sentry/permissions.py b/src/sentry/permissions.py
index f48ab9078d..5d0163b07a 100644
--- a/src/sentry/permissions.py
+++ b/src/sentry/permissions.py
@@ -165,6 +165,17 @@ def can_manage_team(user, team):
     return False
 
 
+@requires_login
+def can_manage_project(user, project):
+    if can_manage_org(user, project.organization):
+        return True
+
+    if is_project_admin(user, project):
+        return True
+
+    return False
+
+
 @requires_login
 def can_add_organization_member(user, organization):
     # must be an owner of the team
diff --git a/src/sentry/templates/sentry/bases/explore.html b/src/sentry/templates/sentry/bases/explore.html
index 61cfc2282a..48291558c3 100644
--- a/src/sentry/templates/sentry/bases/explore.html
+++ b/src/sentry/templates/sentry/bases/explore.html
@@ -1,7 +1,7 @@
 {% extends "sentry/layout.html" %}
 
 {% load i18n %}
-{% load sentry_helpers %}
+{% load sentry_permissions %}
 
 {% block title %}{{ project.name }} | {{ block.super }}{% endblock %}
 
@@ -14,11 +14,11 @@
         <li class="active">
             <a href="{% url 'sentry-explore' project.organization.slug project.slug %}">{% trans "Explore" %}</a>
         </li>
-        {% if team and request.user|can_admin_team:team %}
-            <li>
-                <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}">{% trans "Settings" %}</a>
-            </li>
-        {% endif %}
+        <li>
+            <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}">
+                {% trans "Settings" %}
+            </a>
+        </li>
     </ul>
 {% endblock %}
 
diff --git a/src/sentry/templates/sentry/bases/settings.html b/src/sentry/templates/sentry/bases/settings.html
index 475ba913ca..5bcd47c988 100644
--- a/src/sentry/templates/sentry/bases/settings.html
+++ b/src/sentry/templates/sentry/bases/settings.html
@@ -1,6 +1,7 @@
 {% extends "sentry/layout.html" %}
 
 {% load i18n %}
+{% load sentry_permissions %}
 
 {% block title %}{{ project.name }} Settings | {{ block.super }}{% endblock %}
 
@@ -10,6 +11,9 @@
         <li>
             <a href="{% url 'sentry-stream' project.organization.slug project.slug %}">{% trans "Stream" %}</a>
         </li>
+        <li>
+            <a href="{% url 'sentry-explore' project.organization.slug project.slug %}">{% trans "Explore" %}</a>
+        </li>
         <li class="active">
             <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}">{% trans "Settings" %}</a>
         </li>
diff --git a/src/sentry/templates/sentry/bases/stream.html b/src/sentry/templates/sentry/bases/stream.html
index 1d7955b690..42988671f2 100644
--- a/src/sentry/templates/sentry/bases/stream.html
+++ b/src/sentry/templates/sentry/bases/stream.html
@@ -1,7 +1,7 @@
 {% extends "sentry/layout.html" %}
 
 {% load i18n %}
-{% load sentry_helpers %}
+{% load sentry_permissions %}
 
 {% block title %}{{ project.name }} | {{ block.super }}{% endblock %}
 
@@ -20,12 +20,10 @@
         <li>
             <a href="{% url 'sentry-explore' project.organization.slug project.slug %}">{% trans "Explore" %}</a>
         </li>
-        {% if team and request.user|can_admin_team:team %}
-            <li>
-                <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}" title="{% trans "Project Settings" %}">
-                    {% trans "Settings" %}
-                </a>
-            </li>
-        {% endif %}
+        <li>
+            <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}">
+                {% trans "Settings" %}
+            </a>
+        </li>
     </ul>
 {% endblock %}
diff --git a/src/sentry/templatetags/sentry_helpers.py b/src/sentry/templatetags/sentry_helpers.py
index 95e59058a3..434379668b 100644
--- a/src/sentry/templatetags/sentry_helpers.py
+++ b/src/sentry/templatetags/sentry_helpers.py
@@ -32,8 +32,8 @@ import six
 from six.moves import range
 
 from sentry import options
-from sentry.constants import STATUS_MUTED, EVENTS_PER_PAGE, MEMBER_OWNER
-from sentry.models import Organization, Team
+from sentry.constants import STATUS_MUTED, EVENTS_PER_PAGE
+from sentry.models import Organization
 from sentry.web.helpers import group_is_public
 from sentry.utils import to_unicode
 from sentry.utils.avatar import get_gravatar_url
@@ -468,18 +468,6 @@ def basename(value):
     return os.path.basename(value)
 
 
-@register.filter
-def can_admin_team(user, team):
-    if user.is_superuser:
-        return True
-    if team.owner == user:
-        return True
-    if team.slug in Team.objects.get_for_user(
-            organization=team.organization, user=user, access=MEMBER_OWNER):
-        return True
-    return False
-
-
 @register.filter
 def user_display_name(user):
     return user.first_name or user.username
diff --git a/src/sentry/templatetags/sentry_permissions.py b/src/sentry/templatetags/sentry_permissions.py
index 2ae36760ab..09d13bf803 100644
--- a/src/sentry/templatetags/sentry_permissions.py
+++ b/src/sentry/templatetags/sentry_permissions.py
@@ -12,7 +12,8 @@ from django import template
 from sentry.models import AccessGroup
 from sentry.permissions import (
     can_create_organizations, can_create_teams, can_create_projects,
-    can_remove_team, can_remove_project, can_manage_team, can_manage_org
+    can_remove_team, can_remove_project, can_manage_project, can_manage_team,
+    can_manage_org
 )
 
 register = template.Library()
@@ -23,6 +24,7 @@ register.filter('can_create_organizations')(lambda a: can_create_organizations(a
 register.filter('can_create_teams')(lambda a, b: can_create_teams(a, b))
 register.filter('can_create_projects')(lambda a, b: can_create_projects(a, b))
 register.filter('can_manage_team')(lambda a, b: can_manage_team(a, b))
+register.filter('can_manage_project')(lambda a, b: can_manage_project(a, b))
 register.filter('can_manage_org')(lambda a, b: can_manage_org(a, b))
 register.filter('can_remove_team')(lambda a, b: can_remove_team(a, b))
 register.filter('can_remove_project')(lambda a, b: can_remove_project(a, b))
