commit 24e9d229e009561195f4600651c6f483bd675d91
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Jan 5 13:31:55 2013 -0800

    Ensure user_email is automatically tagged (tests)

diff --git a/tests/sentry/manager/tests.py b/tests/sentry/manager/tests.py
index db652c2284..7144c77882 100644
--- a/tests/sentry/manager/tests.py
+++ b/tests/sentry/manager/tests.py
@@ -134,6 +134,17 @@ class SentryManagerTest(TestCase):
         group = event.group
         add_tags.assert_called_once_with(group, [('foo', 'bar'), ('logger', 'root'), ('level', 'error')])
 
+    @mock.patch('sentry.manager.send_group_processors', mock.Mock())
+    @mock.patch('sentry.manager.GroupManager.add_tags')
+    def test_does_tag_user_email(self, add_tags):
+        event = Group.objects.from_kwargs(1, message='foo', **{
+            'sentry.interfaces.User': {
+                'email': 'foo@example.com',
+            },
+        })
+        group = event.group
+        add_tags.assert_called_once_with(group, [('logger', 'root'), ('level', 'error'), ('user_email', 'foo@example.com')])
+
     @mock.patch('sentry.manager.send_group_processors', mock.Mock())
     @mock.patch('sentry.manager.GroupManager.add_tags')
     def test_tags_as_dict(self, add_tags):
