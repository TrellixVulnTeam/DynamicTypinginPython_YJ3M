commit 7d3e89d071f74ba21a7fb00a8ed32726c382b3ca
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Wed May 18 02:37:48 2016 +0200

    Redirect to recovery page to people remember to keep the codes.

diff --git a/src/sentry/models/authenticator.py b/src/sentry/models/authenticator.py
index ab340595a0..ab59e07159 100644
--- a/src/sentry/models/authenticator.py
+++ b/src/sentry/models/authenticator.py
@@ -71,10 +71,10 @@ class AuthenticatorManager(BaseManager):
 
         return _sort(rv)
 
-    def auto_enroll_backup_interface(self, user, force=False):
-        """This automatically enrolls the recovery code backup interface
-        in case no backup interface is currently set for the user.
-        Returns the interface that was added.
+    def auto_add_recovery_codes(self, user, force=False):
+        """This automatically adds the recovery code backup interface in
+        case no backup interface is currently set for the user.  Returns
+        the interface that was added.
         """
         has_authenticators = False
         for authenticator in Authenticator.objects.filter(user=user):
diff --git a/src/sentry/templates/sentry/account/twofactor/configure_recovery.html b/src/sentry/templates/sentry/account/twofactor/configure_recovery.html
index afc1b1ef5d..9fa08ef4dd 100644
--- a/src/sentry/templates/sentry/account/twofactor/configure_recovery.html
+++ b/src/sentry/templates/sentry/account/twofactor/configure_recovery.html
@@ -7,6 +7,8 @@
   {{ block.super }}
 
   {% if auth.is_enrolled %}
+  <p><strong>Make sure to keep a copy of these codes to recovery your
+    account if you lose your authenticator.</strong></p>
   <h4>Unused Codes</h4>
   <pre>{% for code in auth.get_unused_codes %}{{ code }}
 {% endfor %}</pre>
diff --git a/src/sentry/web/frontend/accounts_twofactor.py b/src/sentry/web/frontend/accounts_twofactor.py
index c4d6c4c66d..a1d64ed1d4 100644
--- a/src/sentry/web/frontend/accounts_twofactor.py
+++ b/src/sentry/web/frontend/accounts_twofactor.py
@@ -91,6 +91,7 @@ class TwoFactorSettingsView(BaseView):
                                   context, request)
 
     def enroll(self, request, interface, insecure=False):
+        next = request.path
         # Only enroll if it's either not an insecure enrollment or we are
         # enrolling a backup interface when we already had a primary one.
         if not insecure \
@@ -98,8 +99,9 @@ class TwoFactorSettingsView(BaseView):
                Authenticator.objects.user_has_2fa(request.user,
                                                   ignore_backup=True)):
             interface.enroll(request.user)
-            Authenticator.objects.auto_enroll_backup_interface(request.user)
-        return HttpResponseRedirect(request.path)
+            if Authenticator.objects.auto_add_recovery_codes(request.user):
+                next = reverse('sentry-account-settings-2fa-recovery')
+        return HttpResponseRedirect(next)
 
     def configure(self, request, interface):
         if 'enroll' in request.POST or \
