commit 9d5dba39f62e293b22b8f1d3928f2c59aabc01f1
Author: Max Bittker <maxbittker@gmail.com>
Date:   Tue Mar 13 09:53:50 2018 -0700

    fix(assigneeSelector): fix styles and errors (#7536)
    
    * fix(assigneeSelector): fix styles and errors
    
    * fix misclick hazard
    
    * refactor assigneeSelector

diff --git a/src/sentry/static/sentry/app/components/assigneeSelector.jsx b/src/sentry/static/sentry/app/components/assigneeSelector.jsx
index b2801df167..c760628282 100644
--- a/src/sentry/static/sentry/app/components/assigneeSelector.jsx
+++ b/src/sentry/static/sentry/app/components/assigneeSelector.jsx
@@ -79,8 +79,8 @@ const AssigneeSelector = createReactClass({
     if (nextProps.id != this.props.id || loading != this.state.loading) {
       let group = GroupStore.get(this.props.id);
       this.setState({
-        assignedTo: group.assignedTo,
         loading,
+        assignedTo: group && group.assignedTo,
       });
     }
   },
@@ -209,41 +209,35 @@ const AssigneeSelector = createReactClass({
     );
   },
 
-  render() {
-    let {loading, assignedTo, filter, memberList} = this.state;
-    let memberListLoading = this.state.memberList === null;
-
-    let className = classNames('assignee-selector anchor-right ', {
-      unassigned: !assignedTo,
-    });
-
+  renderMemberNodes() {
+    let {filter, memberList} = this.state;
     let members = AssigneeSelector.filterMembers(memberList, filter);
     members = AssigneeSelector.putSessionUserFirst(members);
 
-    let memberNodes =
-      members && members.length ? (
-        members.map(item => {
-          return (
-            <MenuItem
-              key={buildUserId(item.id)}
-              disabled={loading}
-              onSelect={this.assignToUser.bind(this, item)}
-            >
-              <Avatar user={item} className="avatar" size={48} />
-              {this.highlight(item.name || item.email, filter)}
-            </MenuItem>
-          );
-        })
-      ) : (
-        <li className="not-found">
-          <span>{t('No matching users found.')}</span>
-        </li>
-      );
+    return members && members.length ? (
+      members.map(item => {
+        return (
+          <MenuItem
+            key={buildUserId(item.id)}
+            onSelect={this.assignToUser.bind(this, item)}
+          >
+            <Avatar user={item} className="avatar" size={48} />
+            {this.highlight(item.name || item.email, filter)}
+          </MenuItem>
+        );
+      })
+    ) : (
+      <li className="not-found">
+        <span>{t('No matching users found.')}</span>
+      </li>
+    );
+  },
 
+  renderTeamNodes() {
+    let {filter} = this.state;
     let teamNodes = [];
     let org = this.context.organization;
     let features = new Set(org.features);
-    let access = new Set(org.access);
 
     if (features.has('internal-catchall')) {
       teamNodes = AssigneeSelector.filterMembers(
@@ -251,11 +245,7 @@ const AssigneeSelector = createReactClass({
         filter
       ).map(({id, display, team}) => {
         return (
-          <MenuItem
-            key={id}
-            disabled={loading}
-            onSelect={this.assignToTeam.bind(this, team)}
-          >
+          <MenuItem key={id} onSelect={this.assignToTeam.bind(this, team)}>
             <TeamAvatar team={team} className="avatar" size={48} />
             {this.highlight(display, filter)}
           </MenuItem>
@@ -265,28 +255,58 @@ const AssigneeSelector = createReactClass({
         teamNodes = [...teamNodes, <hr key="divider" style={{margin: 0}} />];
       }
     }
+    return teamNodes;
+  },
+
+  render() {
+    let {loading, assignedTo} = this.state;
+    let group = GroupStore.get(this.props.id);
+
+    let org = this.context.organization;
+    let features = new Set(org.features);
+    let access = new Set(org.access);
+
+    let assigneeListLoading = this.state.memberList === null || !group;
+
+    if (loading) {
+      return (
+        <div>
+          <div className="assignee-selector anchor-right">
+            <LoadingIndicator mini style={{marginRight: '10px'}} />
+          </div>
+        </div>
+      );
+    }
+
+    let className = classNames('assignee-selector anchor-right', {
+      unassigned: !assignedTo,
+    });
 
     return (
       <div>
         <div className={className}>
-          {loading ? (
-            <LoadingIndicator mini style={{float: 'left'}} />
-          ) : (
-            <DropdownLink
-              className="assignee-selector-toggle"
-              onOpen={this.onDropdownOpen}
-              onClose={this.onDropdownClose}
-              isOpen={this.state.isOpen}
-              alwaysRenderMenu={false}
-              title={
-                assignedTo ? (
-                  <ActorAvatar actor={assignedTo} className="avatar" size={48} />
-                ) : (
-                  <span className="icon-user" />
-                )
-              }
-            >
-              {!memberListLoading && (
+          <DropdownLink
+            className="assignee-selector-toggle"
+            onOpen={this.onDropdownOpen}
+            onClose={this.onDropdownClose}
+            isOpen={this.state.isOpen}
+            alwaysRenderMenu={false}
+            title={
+              assignedTo ? (
+                <ActorAvatar actor={assignedTo} className="avatar" size={48} />
+              ) : (
+                <span className="icon-user" />
+              )
+            }
+          >
+            {assigneeListLoading ? (
+              <li>
+                <FlowLayout center className="list-loading-container">
+                  <LoadingIndicator mini />
+                </FlowLayout>
+              </li>
+            ) : (
+              <React.Fragment>
                 <MenuItem noAnchor>
                   <input
                     type="text"
@@ -302,10 +322,8 @@ const AssigneeSelector = createReactClass({
                     onKeyUp={this.onFilterKeyUp}
                   />
                 </MenuItem>
-              )}
 
-              {!memberListLoading &&
-                assignedTo && (
+                {assignedTo && (
                   <MenuItem
                     className="clear-assignee"
                     disabled={!loading}
@@ -315,33 +333,24 @@ const AssigneeSelector = createReactClass({
                   </MenuItem>
                 )}
 
-              {!memberListLoading && (
                 <li>
-                  <ul>{[...teamNodes, ...memberNodes]}</ul>
-                </li>
-              )}
-
-              {ConfigStore.get('invitesEnabled') &&
-                access.has('org:write') && (
-                  <MenuItem
-                    className="invite-member"
-                    disabled={!loading}
-                    to={`/settings/organization/${this.context.organization
-                      .slug}/members/new/`}
-                  >
-                    <span className="icon-plus" /> {t('Invite Member')}
-                  </MenuItem>
-                )}
-
-              {memberListLoading && (
-                <li>
-                  <FlowLayout center className="list-loading-container">
-                    <LoadingIndicator mini />
-                  </FlowLayout>
+                  <ul>{[...this.renderTeamNodes(), ...this.renderMemberNodes()]}</ul>
                 </li>
+              </React.Fragment>
+            )}
+
+            {ConfigStore.get('invitesEnabled') &&
+              access.has('org:write') && (
+                <MenuItem
+                  className="invite-member"
+                  disabled={!loading}
+                  to={`/settings/organization/${this.context.organization
+                    .slug}/members/new/`}
+                >
+                  <span className="icon-plus" /> {t('Invite Member')}
+                </MenuItem>
               )}
-            </DropdownLink>
-          )}
+          </DropdownLink>
         </div>
       </div>
     );
diff --git a/src/sentry/static/sentry/less/group-detail.less b/src/sentry/static/sentry/less/group-detail.less
index 09bce21093..622cf28293 100644
--- a/src/sentry/static/sentry/less/group-detail.less
+++ b/src/sentry/static/sentry/less/group-detail.less
@@ -28,7 +28,6 @@
   .short-id {
     font-size: 17px !important;
     font-family: @font-family-code;
-    margin-top: 11px;
   }
 
   .event-message,
@@ -75,7 +74,7 @@
 
   .count span {
     font-size: 22px;
-    display: block;
+    display: inline-block;
     line-height: 1.2;
   }
 
diff --git a/src/sentry/static/sentry/less/shared-components.less b/src/sentry/static/sentry/less/shared-components.less
index 870d7deb11..5111b9199d 100644
--- a/src/sentry/static/sentry/less/shared-components.less
+++ b/src/sentry/static/sentry/less/shared-components.less
@@ -1803,6 +1803,8 @@ ul.faces {
 
 .assignee-selector {
   height: 24px;
+  display: flex;
+  justify-content: flex-end;
 
   .loading {
     display: inline-block;
