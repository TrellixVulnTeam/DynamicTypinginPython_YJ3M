commit df6ab293d1712c72ecfda01edf63fe09fa9a94f0
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Tue May 17 21:30:37 2016 +0200

    Fixed url prefix setting

diff --git a/src/sentry/models/authenticator.py b/src/sentry/models/authenticator.py
index 780085157d..831d8e463f 100644
--- a/src/sentry/models/authenticator.py
+++ b/src/sentry/models/authenticator.py
@@ -16,11 +16,11 @@ from u2flib_server import u2f
 from u2flib_server import jsapi as u2f_jsapi
 
 from django.db import models
-from django.conf import settings
 from django.utils import timezone
 from django.utils.translation import ugettext_lazy as _
 from django.utils.functional import cached_property
 
+from sentry import options
 from sentry.db.models import BaseManager, BaseModel, BoundedAutoField, \
     FlexibleForeignKey, BoundedPositiveIntegerField, UnicodePickledObjectField
 from sentry.utils.otp import generate_secret_key, TOTP
@@ -391,7 +391,7 @@ class U2fInterface(AuthenticatorInterface):
                     'a browser which supports this system (like Google '
                     'Chrome).')
 
-    u2f_app_id = settings.SENTRY_URL_PREFIX
+    u2f_app_id = options.get('system.url-prefix')
     u2f_facets = [u2f_app_id]
 
     def generate_new_config(self):
