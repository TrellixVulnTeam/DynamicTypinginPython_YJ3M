commit 3cf8fc3b8a87ac5db8bd77d07399ed98728aba00
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Feb 10 10:48:24 2016 -0800

    Add user organizations endpoint

diff --git a/src/sentry/api/endpoints/user_organizations.py b/src/sentry/api/endpoints/user_organizations.py
new file mode 100644
index 0000000000..a23a3a6e62
--- /dev/null
+++ b/src/sentry/api/endpoints/user_organizations.py
@@ -0,0 +1,34 @@
+from __future__ import absolute_import
+
+from django.db.models import Q
+
+from sentry.api.bases.user import UserEndpoint
+from sentry.api.paginator import OffsetPaginator
+from sentry.api.serializers import serialize
+from sentry.models import (
+    Organization, OrganizationMember, OrganizationStatus
+)
+
+
+class UserOrganizationsEndpoint(UserEndpoint):
+    def get(self, request, user):
+        queryset = Organization.objects.filter(
+            status=OrganizationStatus.VISIBLE,
+            id__in=OrganizationMember.objects.filter(
+                user=user,
+            ).values('organization'),
+        )
+
+        query = request.GET.get('query')
+        if query:
+            queryset = queryset.filter(
+                Q(name__icontains=query) | Q(slug__icontains=query),
+            )
+
+        return self.paginate(
+            request=request,
+            queryset=queryset,
+            order_by='name',
+            on_results=lambda x: serialize(x, request.user),
+            paginator_cls=OffsetPaginator,
+        )
diff --git a/src/sentry/api/urls.py b/src/sentry/api/urls.py
index 67e60b3152..23a0dd7bc7 100644
--- a/src/sentry/api/urls.py
+++ b/src/sentry/api/urls.py
@@ -69,6 +69,7 @@ from .endpoints.team_project_index import TeamProjectIndexEndpoint
 from .endpoints.team_stats import TeamStatsEndpoint
 from .endpoints.user_index import UserIndexEndpoint
 from .endpoints.user_details import UserDetailsEndpoint
+from .endpoints.user_organizations import UserOrganizationsEndpoint
 
 
 urlpatterns = patterns(
@@ -91,6 +92,9 @@ urlpatterns = patterns(
     url(r'^users/(?P<user_id>[^\/]+)/$',
         UserDetailsEndpoint.as_view(),
         name='sentry-api-0-user-details'),
+    url(r'^users/(?P<user_id>[^\/]+)/organizations/$',
+        UserOrganizationsEndpoint.as_view(),
+        name='sentry-api-0-user-organizations'),
 
     # Organizations
     url(r'^organizations/$',
diff --git a/tests/sentry/api/endpoints/test_user_organizations.py b/tests/sentry/api/endpoints/test_user_organizations.py
new file mode 100644
index 0000000000..3418eb0031
--- /dev/null
+++ b/tests/sentry/api/endpoints/test_user_organizations.py
@@ -0,0 +1,24 @@
+from __future__ import absolute_import
+
+from django.core.urlresolvers import reverse
+
+from sentry.testutils import APITestCase
+
+
+class UserOrganizationsTest(APITestCase):
+    def test_simple(self):
+        user = self.create_user(email='a@example.com')
+        org = self.create_organization(name='foo')
+        self.create_organization(name='bar')
+        self.create_member(organization=org, user=user)
+
+        self.login_as(user=user)
+
+        url = reverse('sentry-api-0-user-organizations', kwargs={
+            'user_id': 'me',
+        })
+        response = self.client.get(url, format='json')
+
+        assert response.status_code == 200, response.content
+        assert len(response.data) == 1
+        assert response.data[0]['id'] == str(org.id)
