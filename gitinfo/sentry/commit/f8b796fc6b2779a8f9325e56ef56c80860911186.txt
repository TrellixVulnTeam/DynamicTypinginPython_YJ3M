commit f8b796fc6b2779a8f9325e56ef56c80860911186
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jan 12 11:55:17 2016 -0800

    Add Node refs on events in test fixtures

diff --git a/src/sentry/testutils/fixtures.py b/src/sentry/testutils/fixtures.py
index 8629987d79..305d520ab8 100644
--- a/src/sentry/testutils/fixtures.py
+++ b/src/sentry/testutils/fixtures.py
@@ -155,12 +155,12 @@ class Fixtures(object):
         return user
 
     def create_event(self, event_id=None, **kwargs):
+        if event_id is None:
+            event_id = uuid4().hex
         if 'group' not in kwargs:
             kwargs['group'] = self.group
         kwargs.setdefault('project', kwargs['group'].project)
         kwargs.setdefault('message', kwargs['group'].message)
-        if event_id is None:
-            event_id = uuid4().hex
         kwargs.setdefault('data', LEGACY_DATA.copy())
         if kwargs.get('tags'):
             tags = kwargs.pop('tags')
@@ -168,10 +168,14 @@ class Fixtures(object):
                 tags = tags.items()
             kwargs['data']['tags'] = tags
 
-        return Event.objects.create(
+        event = Event(
             event_id=event_id,
             **kwargs
         )
+        # emulate EventManager refs
+        event.data.bind_ref(event)
+        event.save()
+        return event
 
     def create_group(self, project=None, checksum=None, **kwargs):
         if checksum:
