commit 1c3f7e6c9d2ce413d692b98b6764c0839a21a381
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Jul 31 18:04:14 2015 -0700

    Initial work on release email (refs GH-1670)

diff --git a/src/sentry/templates/sentry/emails/new-release.html b/src/sentry/templates/sentry/emails/new-release.html
new file mode 100644
index 0000000000..0f93099725
--- /dev/null
+++ b/src/sentry/templates/sentry/emails/new-release.html
@@ -0,0 +1,15 @@
+{% extends "sentry/emails/base.html" %}
+
+{% load sentry_helpers %}
+
+{% block header %}
+    <a href="{{ release_link }}" class="btn">View Release</a>
+    <h1>Sentry <small>New Release of <a href="{{ project_link }}">{{ project.name }}</a></small></h1>
+{% endblock %}
+
+{% block main %}
+    <h2>
+        Version {{ release.short_version }}
+    </h2>
+    <p><a href="{{ release_link }}" class="highlight">{{ release.short_version }}</a> was released for <a href="{{ project_link }}">{{ project.name }}</a> on {{ release.date_added }}</p>
+{% endblock %}
diff --git a/src/sentry/templates/sentry/emails/new-release.txt b/src/sentry/templates/sentry/emails/new-release.txt
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/src/sentry/web/frontend/debug/debug_new_release_email.py b/src/sentry/web/frontend/debug/debug_new_release_email.py
new file mode 100644
index 0000000000..b18cf7d324
--- /dev/null
+++ b/src/sentry/web/frontend/debug/debug_new_release_email.py
@@ -0,0 +1,64 @@
+from __future__ import absolute_import
+
+from django.core.urlresolvers import reverse
+from django.views.generic import View
+from hashlib import sha1
+from uuid import uuid4
+
+from sentry.models import Organization, Team, Project, Release
+from sentry.utils.http import absolute_uri
+from sentry.web.helpers import render_to_response
+
+from .mail import MailPreview
+
+
+class DebugNewReleaseEmailView(View):
+    def get(self, request):
+        org = Organization(
+            id=1,
+            slug='organization',
+            name='My Company',
+        )
+        team = Team(
+            id=1,
+            slug='team',
+            name='My Team',
+            organization=org,
+        )
+        project = Project(
+            id=1,
+            organization=org,
+            team=team,
+            slug='project',
+            name='My Project',
+        )
+        release = Release(
+            project=project,
+            version=sha1(uuid4().hex).hexdigest(),
+        )
+
+        release_link = absolute_uri(reverse('sentry-release-details', kwargs={
+            'organization_slug': org.slug,
+            'project_id': project.slug,
+            'version': release.version,
+        }))
+
+        project_link = absolute_uri(reverse('sentry-stream', kwargs={
+            'organization_slug': org.slug,
+            'project_id': project.slug,
+        }))
+
+        preview = MailPreview(
+            html_template='sentry/emails/new-release.html',
+            text_template='sentry/emails/new-release.txt',
+            context={
+                'release': release,
+                'project': project,
+                'release_link': release_link,
+                'project_link': project_link,
+            },
+        )
+
+        return render_to_response('sentry/debug/mail/preview.html', {
+            'preview': preview,
+        })
diff --git a/src/sentry/web/frontend/debug/mail.py b/src/sentry/web/frontend/debug/mail.py
index a00eaddb4a..5f0720cd41 100644
--- a/src/sentry/web/frontend/debug/mail.py
+++ b/src/sentry/web/frontend/debug/mail.py
@@ -1,6 +1,7 @@
 from __future__ import absolute_import, print_function
 
 import logging
+import traceback
 
 from django.core.urlresolvers import reverse
 from django.utils.safestring import mark_safe
@@ -26,7 +27,11 @@ class MailPreview(object):
         return render_to_string(self.text_template, self.context)
 
     def html_body(self):
-        return inline_css(render_to_string(self.html_template, self.context))
+        try:
+            return inline_css(render_to_string(self.html_template, self.context))
+        except Exception:
+            traceback.print_exc()
+            raise
 
 
 @login_required
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index 1b8756e8ba..b9dda540c3 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -88,12 +88,15 @@ if settings.DEBUG:
     import sentry.web.frontend.debug.mail
     from sentry.web.frontend.debug.debug_trigger_error import DebugTriggerErrorView
     from sentry.web.frontend.debug.debug_error_embed import DebugErrorPageEmbedView
+    from sentry.web.frontend.debug.debug_new_release_email import DebugNewReleaseEmailView
 
     urlpatterns += patterns('',
         url(r'^debug/mail/new-event/$',
             sentry.web.frontend.debug.mail.new_event),
         url(r'^debug/mail/new-note/$',
             sentry.web.frontend.debug.mail.new_note),
+        url(r'^debug/mail/new-release/$',
+            DebugNewReleaseEmailView.as_view()),
         url(r'^debug/mail/request-access/$',
             sentry.web.frontend.debug.mail.request_access),
         url(r'^debug/mail/access-approved/$',
