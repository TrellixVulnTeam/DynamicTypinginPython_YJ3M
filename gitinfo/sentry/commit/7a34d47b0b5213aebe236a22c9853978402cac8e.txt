commit 7a34d47b0b5213aebe236a22c9853978402cac8e
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jun 3 00:41:26 2014 -0700

    Rely on can_admin_team filter for permission testing

diff --git a/src/sentry/templates/sentry/bases/explore.html b/src/sentry/templates/sentry/bases/explore.html
index b4f891db36..468066bde8 100644
--- a/src/sentry/templates/sentry/bases/explore.html
+++ b/src/sentry/templates/sentry/bases/explore.html
@@ -1,6 +1,7 @@
 {% extends "sentry/layout.html" %}
 
 {% load i18n %}
+{% load sentry_helpers %}
 
 {% block title %}{{ project.name }} | {{ block.super }}{% endblock %}
 
@@ -13,7 +14,7 @@
         <li class="active">
             <a href="{% url 'sentry-explore' project.team.slug project.slug %}">{% trans "Explore" %}</a>
         </li>
-        {% if can_admin_team %}
+        {% if team and request.user|can_admin_team:team %}
             <li>
                 <a href="{% url 'sentry-manage-project' project.team.slug project.slug %}">{% trans "Settings" %}</a>
             </li>
diff --git a/src/sentry/web/helpers.py b/src/sentry/web/helpers.py
index 443a90e268..bebc9ab849 100644
--- a/src/sentry/web/helpers.py
+++ b/src/sentry/web/helpers.py
@@ -16,7 +16,7 @@ from django.template import loader, RequestContext, Context
 from django.utils.datastructures import SortedDict
 from django.utils.safestring import mark_safe
 
-from sentry.constants import MEMBER_OWNER, EVENTS_PER_PAGE, STATUS_HIDDEN
+from sentry.constants import EVENTS_PER_PAGE, STATUS_HIDDEN
 from sentry.models import Project, Team, Option, ProjectOption, ProjectKey
 
 logger = logging.getLogger('sentry.errors')
@@ -112,11 +112,6 @@ def get_default_context(request, existing_context=None, team=None):
         context.update({
             'request': request,
         })
-        if team:
-            # TODO: remove this extra query
-            context.update({
-                'can_admin_team': [team in Team.objects.get_for_user(request.user, MEMBER_OWNER)],
-            })
 
         if not existing_context or 'TEAM_LIST' not in existing_context:
             context['TEAM_LIST'] = Team.objects.get_for_user(
