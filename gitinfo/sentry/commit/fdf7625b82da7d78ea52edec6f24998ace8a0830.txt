commit fdf7625b82da7d78ea52edec6f24998ace8a0830
Author: Matte Noble <me@mattenoble.com>
Date:   Wed Apr 24 08:20:59 2019 -0700

    fix(commands): Delete old ApiTokens (#12903)
    
    * fix(commands): Delete old ApiTokens
    
    The ApiToken cleanup was deleting tokens immediately, instead of
    honoring the --days argument to the script.
    
    This was causing integrations to not be able to refresh tokens since
    they didn't exist when they tried to.
    
    * Fix chromedriver Travis install

diff --git a/.travis.yml b/.travis.yml
index 6c8f2e58a9..07f07b2303 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -99,7 +99,7 @@ base_acceptance: &acceptance_default
     - yarn install --pure-lockfile
     - python setup.py install_egg_info
     - pip install -e ".[dev,tests,optional]"
-    - wget -N "https://chromedriver.storage.googleapis.com/2.45/chromedriver_linux64.zip" -P ~/
+    - wget -N "https://chromedriver.storage.googleapis.com/$(curl https://chromedriver.storage.googleapis.com/LATEST_RELEASE_74)/chromedriver_linux64.zip" -P ~/
     - unzip ~/chromedriver_linux64.zip -d ~/
     - rm ~/chromedriver_linux64.zip
     - sudo install -m755 ~/chromedriver /usr/local/bin/
diff --git a/src/sentry/runner/commands/cleanup.py b/src/sentry/runner/commands/cleanup.py
index f7e7aa0c56..924b7e60a9 100644
--- a/src/sentry/runner/commands/cleanup.py
+++ b/src/sentry/runner/commands/cleanup.py
@@ -221,7 +221,9 @@ def cleanup(days, project, concurrency, silent, model, router, timed):
             if not silent:
                 click.echo(u'>> Skipping {}'.format(model.__name__))
         else:
-            model.objects.filter(expires_at__lt=timezone.now()).delete()
+            model.objects.filter(
+                expires_at__lt=(timezone.now() - timedelta(days=days)),
+            ).delete()
 
     project_id = None
     if project:
