commit cdf57db02a2e84e1293a699c09d57c17dd1bfba3
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Tue Sep 1 22:53:53 2015 +0200

    Switch from postgres to sqlite for api docs

diff --git a/api-docs/generator.py b/api-docs/generator.py
index 0e13b55ff9..00ccdb1289 100644
--- a/api-docs/generator.py
+++ b/api-docs/generator.py
@@ -75,28 +75,18 @@ def spawn_sentry():
 
 @contextmanager
 def management_connection():
-    from psycopg2 import connect
+    from sqlite3 import connect
     cfg = settings.DATABASES['default']
-    con = connect(host=cfg['HOST'],
-                  port=cfg['PORT'] or None,
-                  password=cfg['PASSWORD'] or None,
-                  user=cfg['USER'],
-                  database='postgres')
+    con = connect(cfg['NAME'])
     try:
-        con.cursor().execute('COMMIT')
+        con.cursor()
         yield con
     finally:
         con.close()
 
 
 def init_db():
-    report('db', 'Dropping old database')
-    cfg = settings.DATABASES['default']
-    with management_connection() as con:
-        con.cursor().execute('DROP DATABASE IF EXISTS "%s"' % cfg['NAME'])
-    report('db', 'Creating new database')
-    with management_connection() as con:
-        con.cursor().execute('CREATE DATABASE "%s"' % cfg['NAME'])
+    drop_db()
     report('db', 'Migrating database (this can time some time)')
     call_command('syncdb', migrate=True, interactive=False,
                  traceback=True, verbosity=0)
@@ -104,12 +94,14 @@ def init_db():
 
 def drop_db():
     report('db', 'Dropping database')
-    cfg = settings.DATABASES['default']
-    with management_connection() as con:
-        con.cursor().execute('DROP DATABASE "%s"' % cfg['NAME'])
+    try:
+        os.remove(settings.DATABASES['default']['NAME'])
+    except (OSError, IOError):
+        pass
 
 
 def forcefully_disconnect_clients():
+    return
     report('db', 'Disconnecting database connections')
     cfg = settings.DATABASES['default']
     with management_connection() as con:
diff --git a/api-docs/sentry.conf.py b/api-docs/sentry.conf.py
index 51cea900da..7de3f2c596 100644
--- a/api-docs/sentry.conf.py
+++ b/api-docs/sentry.conf.py
@@ -34,12 +34,8 @@ SENTRY_ADMIN_EMAIL = 'admin@getsentry.com'
 
 DATABASES = {
     'default': {
-        'ENGINE': 'django.db.backends.postgresql_psycopg2',
-        'NAME': '_sentry_apidocs',
-        'USER': getpass.getuser(),
-        'PASSWORD': '',
-        'HOST': '127.0.0.1',
-        'PORT': '',
+        'ENGINE': 'django.db.backends.sqlite3',
+        'NAME': '/tmp/sentry_apidocs.db',
     }
 }
 SENTRY_USE_BIG_INTS = True
