commit c8a7b3290979dfe50f3f7ca09637edd4bd7e8efa
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 26 00:19:19 2011 -0800

    Clean up pagination and maintain backwards compatibility

diff --git a/sentry/plugins/sentry_servers/templates/sentry/plugins/sentry_servers/index.html b/sentry/plugins/sentry_servers/templates/sentry/plugins/sentry_servers/index.html
index 4bde028d9c..b5a5a47c18 100644
--- a/sentry/plugins/sentry_servers/templates/sentry/plugins/sentry_servers/index.html
+++ b/sentry/plugins/sentry_servers/templates/sentry/plugins/sentry_servers/index.html
@@ -1,23 +1,22 @@
 {% extends "sentry/groups/details.html" %}
 
+{% load i18n %}
 {% load sentry_helpers %}
 
 {% block inner %}
-    <h2>Server List</h2>
     {% paginate group.unique_servers from request as server_list per_page 25 %}
-    <div class="paging-wrap">
-        <div class="clearfix">
-            {{ server_list.paging }}
-        </div>
-    </div>
-    <ul class="server-list">
-        {% for server_name, times_seen in server_list.objects %}
-            <li><span class="count">{{ times_seen|small_count }}</span> <a href="{% url sentry group.project_id %}?server_name={{ server_name }}">{{ server_name }}</a></li>
-        {% endfor %}
-    </ul>
-    <div class="paging-wrap">
-        <div class="clearfix">
-            {{ server_list.paging }}
-        </div>
-    </div>
+
+    {% if server_list.objects %}
+        {{ server_list.paging }}
+
+        <ul class="server-list">
+            {% for server_name, times_seen in server_list.objects %}
+                <li><span class="count">{{ times_seen|small_count }}</span> <a href="{% url sentry group.project_id %}?server_name={{ server_name }}">{{ server_name }}</a></li>
+            {% endfor %}
+        </ul>
+
+        {{ server_list.paging }}
+    {% else %}
+        <p class="alert-message notice">{% trans "There are no records recorded for this event." %}</p>
+    {% endif %}
 {% endblock %}
\ No newline at end of file
diff --git a/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/index.html b/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/index.html
index 2f7570046c..b4985fb163 100644
--- a/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/index.html
+++ b/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/index.html
@@ -1,23 +1,22 @@
 {% extends "sentry/groups/details.html" %}
 
+{% load i18n %}
 {% load sentry_helpers %}
 
 {% block inner %}
-    <h2>Site List</h2>
     {% paginate group.unique_sites from request as site_list per_page 25 %}
-    <div class="paging-wrap">
-        <div class="clearfix">
-            {{ site_list.paging }}
-        </div>
-    </div>
-    <ul class="server-list">
-        {% for site, times_seen in site_list.objects %}
-            <li><span class="count">{{ times_seen|small_count }}</span> <a href="{% url sentry group.project_id %}?site={{ site }}">{{ site }}</a></li>
-        {% endfor %}
-    </ul>
-    <div class="paging-wrap">
-        <div class="clearfix">
-            {{ site_list.paging }}
-        </div>
-    </div>
+
+    {% if site_list.objects %}
+        {{ site_list.paging }}
+
+        <ul class="site-list unstyled">
+            {% for site, times_seen in site_list.objects %}
+                <li><span class="count">{{ times_seen|small_count }}</span> <a href="{% url sentry group.project_id %}?site={{ site }}">{{ site }}</a></li>
+            {% endfor %}
+        </ul>
+
+        {{ site_list.paging }}
+    {% else %}
+        <p class="alert-message notice">{% trans "There are no records recorded for this event." %}</p>
+    {% endif %}
 {% endblock %}
\ No newline at end of file
diff --git a/sentry/plugins/sentry_urls/templates/sentry/plugins/sentry_urls/index.html b/sentry/plugins/sentry_urls/templates/sentry/plugins/sentry_urls/index.html
index 97aef4125b..7cf9b3a020 100644
--- a/sentry/plugins/sentry_urls/templates/sentry/plugins/sentry_urls/index.html
+++ b/sentry/plugins/sentry_urls/templates/sentry/plugins/sentry_urls/index.html
@@ -1,23 +1,22 @@
 {% extends "sentry/groups/details.html" %}
 
+{% load i18n %}
 {% load sentry_helpers %}
 
 {% block inner %}
-    <h2>URL List</h2>
     {% paginate group.unique_urls from request as url_list per_page 25 %}
-    <div class="paging-wrap">
-        <div class="clearfix">
-            {{ url_list.paging }}
-        </div>
-    </div>
-    <ul class="url-list">
-        {% for url, times_seen in url_list.objects %}
-            <li><span class="count">{{ times_seen|small_count }}</span> <a href="{{ url }}">{{ url }}</a></li>
-        {% endfor %}
-    </ul>
-    <div class="paging-wrap">
-        <div class="clearfix">
-            {{ url_list.paging }}
-        </div>
-    </div>
+
+    {% if url_list.objects %}
+        {{ url_list.paging }}
+
+        <ul class="url-list">
+            {% for url, times_seen in url_list.objects %}
+                <li><span class="count">{{ times_seen|small_count }}</span> <a href="{{ url }}">{{ url }}</a></li>
+            {% endfor %}
+        </ul>
+
+        {{ url_list.paging }}
+    {% else %}
+        <p class="alert-message notice">{% trans "There are no records recorded for this event." %}</p>
+    {% endif %}
 {% endblock %}
\ No newline at end of file
diff --git a/sentry/static/styles/global.css b/sentry/static/styles/global.css
index c0e093c797..a673086b7a 100644
--- a/sentry/static/styles/global.css
+++ b/sentry/static/styles/global.css
@@ -393,91 +393,6 @@ dl.flat dd {
 
 .no-messages { font-size: 1.1em; padding: 10px 0; }
 
-.paging-wrap {
-    display: inline;
-    float: left;
-    width: 100%;
-    margin-bottom: 10px;
-}
-.paging ul {
-    margin-bottom: 0;
-}
-.paging-wrap form { margin-bottom: 0; }
-.paging-meta, .sort-by, .realtime {
-    display: inline;
-    float: right;
-    margin: 0 0 0 10px;
-    font-size: 14px;
-    line-height: 17px;
-    color: #aaa;
-    font-weight: bold;
-}
-.paging-meta {
-    padding: 6px 8px;
-}
-.paging-endless {
-    display: inline;
-    float: left;
-    margin-left: 0;
-}
-
-.paging-endless li {
-    float: left; display: inline;
-    margin-right: 15px;
-}
-
-.paging-endless li span {
-    display: inline-block;
-    padding: 6px 8px 6px 8px;
-    color: #aaa;
-    font-size: 12px;
-    line-height: 17px;
-    border:1px solid #ddd;
-    text-decoration: none;
-    -webkit-border-radius: 5px;
-    -moz-border-radius: 5px;
-    border-radius: 5px;
-    opacity: 0.75;
-    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFF', endColorstr='#DCDCDC'); /* for IE */
-    background: -webkit-gradient(linear, left top, left bottom, from(#FFF), to(#DCDCDC)); /* for webkit browsers */
-    background:-moz-linear-gradient(center top , #FFFFFF 0pt, #DCDCDC 100%) repeat scroll 0 0 transparent;
-}
-
-.paging-endless li a,
-.sort-by, .realtime {
-    display: inline-block;
-    text-decoration: none;
-    color: #888;
-    padding: 6px 8px 6px 8px;
-    font-size: 12px;
-    line-height: 17px;
-    border:1px solid #C5C5C5;
-    text-decoration: none;
-    -webkit-border-radius: 5px;
-    -moz-border-radius: 5px;
-    border-radius: 5px;
-    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFF', endColorstr='#DCDCDC'); /* for IE */
-    background: -webkit-gradient(linear, left top, left bottom, from(#FFF), to(#DCDCDC)); /* for webkit browsers */
-    background:-moz-linear-gradient(center top , #FFFFFF 0pt, #DCDCDC 100%) repeat scroll 0 0 transparent;
-}
-
-.paging-endless li a:hover,
-.realtime:hover {
-    cursor: pointer;
-    border:1px solid #3079d0;
-    color: #fff;
-    text-shadow: 0 -1px 0 #3079d0;
-    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#4da2e5', endColorstr='#3079d0'); /* for IE */
-    background: -webkit-gradient(linear, left top, left bottom, from(#4da2e5), to(#3079d0)); /* for webkit browsers */
-    background: -moz-linear-gradient(top,  #4da2e5,  #3079d0); /* for firefox 3.6+ */
-}
-
-.sort-by select {
-    border: 0;
-    margin-left: 4px;
-    background: inherit;
-}
-
 .login-area {
     width: 300px;
     margin: 50px auto;
diff --git a/sentry/templates/sentry/groups/event_list.html b/sentry/templates/sentry/groups/event_list.html
index e96f14b2e1..6755b981f0 100644
--- a/sentry/templates/sentry/groups/event_list.html
+++ b/sentry/templates/sentry/groups/event_list.html
@@ -4,10 +4,10 @@
 {% load sentry_helpers %}
 
 {% block inner %}
-    {% paginate event_list from request as event_list per_page MESSAGES_PER_PAGE %}
+    {% paginate event_list from request contextual as event_list per_page MESSAGES_PER_PAGE %}
 
     {% if event_list.paginator.objects %}
-        <p class="alert-message notice">This list only contains a portion of all events seen. For more information about how Sentry samples events, see the <a href="#">documentation</a>.</p>
+        <p class="alert-message info">This list only contains a portion of all events seen. For more information about how Sentry samples events, see the <a href="#">documentation</a>.</p>
         <div class="pagination">
             <ul>
                 <li class="prev{% if not event_list.paginator.has_previous %} disabled{% endif %}">
@@ -52,9 +52,7 @@
             </ul>
         </div>
     {% else %}
-        <ul class="messages">
-            <li class="no-messages" id="no_messages">{% trans "No messages match your filters." %}</li>
-        </ul>
+        <p class="alert-message notice">{% trans "There are no records recorded for this event." %}</p>
     {% endif %}
 
 {% endblock %}
\ No newline at end of file
diff --git a/sentry/templates/sentry/groups/group_list.html b/sentry/templates/sentry/groups/group_list.html
index dd9c0fe345..328ad90cf6 100644
--- a/sentry/templates/sentry/groups/group_list.html
+++ b/sentry/templates/sentry/groups/group_list.html
@@ -24,7 +24,7 @@
 {% endblock %}
 
 {% block main %}
-    {% paginate event_list from request as event_list per_page MESSAGES_PER_PAGE %}
+    {% paginate event_list from request contextual as event_list per_page MESSAGES_PER_PAGE %}
 
     <ul class="options">
         <li class="prev{% if not event_list.paginator.has_previous %} disabled{% endif %}">
diff --git a/sentry/templatetags/sentry_helpers.py b/sentry/templatetags/sentry_helpers.py
index 255f534573..ab45d16df6 100644
--- a/sentry/templatetags/sentry_helpers.py
+++ b/sentry/templatetags/sentry_helpers.py
@@ -190,13 +190,20 @@ truncatechars.is_safe = True
 #      a custom template, and not worry about INSTALLED_APPS
 @tag(register, [Variable('queryset_or_list'),
                 Constant('from'), Variable('request'),
+                Optional([Name('contextual')]),
                 Optional([Constant('as'), Name('asvar')]),
                 Optional([Constant('per_page'), Variable('per_page')]),
                 Optional([Variable('is_endless')])])
-def paginate(context, queryset_or_list, request, asvar, per_page=25, is_endless=True):
+def paginate(context, queryset_or_list, request, contextual=False, asvar=None, per_page=25, is_endless=True):
     """{% paginate queryset_or_list from request as foo[ per_page 25][ is_endless False %}"""
     result = paginate_func(request, queryset_or_list, per_page, endless=is_endless)
 
+    if not contextual:
+        context_instance = RequestContext(request)
+        paging = mark_safe(render_to_string('sentry/partial/_pager.html', result, context_instance))
+
+        result = dict(objects=result['paginator'].get('objects', []), paging=paging)
+
     if asvar:
         context[asvar] = result
         return ''
