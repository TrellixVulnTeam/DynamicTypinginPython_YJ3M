commit 5fe57f0a33d115ca6cb062dde492e0637c6d6371
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Wed Sep 23 23:20:05 2015 +0200

    Added projects:plugins feature

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index fd16f886fa..2c1e745c4c 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -561,6 +561,7 @@ SENTRY_FEATURES = {
     'organizations:sso': False,
     'projects:quotas': True,
     'projects:user-reports': True,
+    'projects:plugins': True,
 }
 
 # Default time zone for localization in the UI.
diff --git a/src/sentry/features/__init__.py b/src/sentry/features/__init__.py
index ec92af10f6..adb8524635 100644
--- a/src/sentry/features/__init__.py
+++ b/src/sentry/features/__init__.py
@@ -11,6 +11,7 @@ default_manager.add('organizations:create')
 default_manager.add('organizations:sso', OrganizationFeature)
 default_manager.add('projects:quotas', ProjectFeature)
 default_manager.add('projects:user-reports', ProjectFeature)
+default_manager.add('projects:plugins', ProjectPluginFeature)
 
 # expose public api
 add = default_manager.add
diff --git a/src/sentry/features/base.py b/src/sentry/features/base.py
index 8f232e8b7d..440e48036f 100644
--- a/src/sentry/features/base.py
+++ b/src/sentry/features/base.py
@@ -1,6 +1,7 @@
 from __future__ import absolute_import
 
-__all__ = ['Feature', 'OrganizationFeature', 'ProjectFeature']
+__all__ = ['Feature', 'OrganizationFeature', 'ProjectFeature',
+           'ProjectPluginFeature']
 
 
 class Feature(object):
@@ -20,11 +21,17 @@ class Feature(object):
 
 class OrganizationFeature(Feature):
     def __init__(self, name, organization):
-        self.name = name
+        Feature.__init__(self, name)
         self.organization = organization
 
 
 class ProjectFeature(Feature):
     def __init__(self, name, project):
-        self.name = name
+        Feature.__init__(self, name)
         self.project = project
+
+
+class ProjectPluginFeature(ProjectFeature):
+    def __init__(self, name, project, plugin):
+        ProjectFeature.__init__(self, name, project)
+        self.plugin = plugin
diff --git a/src/sentry/plugins/base/v1.py b/src/sentry/plugins/base/v1.py
index 7fe54a6e11..465735f3c2 100644
--- a/src/sentry/plugins/base/v1.py
+++ b/src/sentry/plugins/base/v1.py
@@ -98,6 +98,10 @@ class IPlugin(local, PluggableViewMixin):
             return True
         if not self.can_enable_for_projects():
             return True
+        if project is not None:
+            from sentry import features
+            if not features.has('projects:plugins', project, self, actor=None):
+                return False
 
         if project:
             project_enabled = self.get_option('enabled', project)
diff --git a/src/sentry/plugins/base/v2.py b/src/sentry/plugins/base/v2.py
index 5fe5a61224..b7477119b3 100644
--- a/src/sentry/plugins/base/v2.py
+++ b/src/sentry/plugins/base/v2.py
@@ -92,6 +92,10 @@ class IPlugin2(local):
             return True
         if not self.can_enable_for_projects():
             return True
+        if project is not None:
+            from sentry import features
+            if not features.has('projects:plugins', project, self, actor=None):
+                return False
 
         if project:
             project_enabled = self.get_option('enabled', project)
