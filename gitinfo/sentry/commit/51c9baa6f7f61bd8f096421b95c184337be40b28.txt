commit 51c9baa6f7f61bd8f096421b95c184337be40b28
Author: Jan Michael Auer <jan.auer@sentry.io>
Date:   Thu Apr 25 01:02:10 2019 +0200

    fix(assemble): Update outdated test, change status (#12928)

diff --git a/src/sentry/api/endpoints/debug_files.py b/src/sentry/api/endpoints/debug_files.py
index f9b6029099..52a3fd208f 100644
--- a/src/sentry/api/endpoints/debug_files.py
+++ b/src/sentry/api/endpoints/debug_files.py
@@ -337,7 +337,7 @@ class DifAssembleEndpoint(ProjectEndpoint):
 
             # We don't have a state yet, this means we can now start
             # an assemble job in the background.
-            set_assemble_status(project, checksum, ChunkFileState.ASSEMBLING)
+            set_assemble_status(project, checksum, ChunkFileState.CREATED)
             assemble_dif.apply_async(
                 kwargs={
                     'project_id': project.id,
diff --git a/tests/sentry/api/endpoints/test_dif_assemble.py b/tests/sentry/api/endpoints/test_dif_assemble.py
index b0b8a03a61..20ce0dcf09 100644
--- a/tests/sentry/api/endpoints/test_dif_assemble.py
+++ b/tests/sentry/api/endpoints/test_dif_assemble.py
@@ -8,7 +8,7 @@ from django.core.files.base import ContentFile
 
 from sentry.models import ApiToken, FileBlob, File, FileBlobIndex, FileBlobOwner
 from sentry.models.file import ChunkFileState
-from sentry.models.debugfile import get_assemble_status, ProjectDebugFile
+from sentry.models.debugfile import get_assemble_status, set_assemble_status, ProjectDebugFile
 from sentry.testutils import APITestCase
 from sentry.tasks.assemble import assemble_dif, assemble_file
 
@@ -141,6 +141,7 @@ class DifAssembleEndpoint(APITestCase):
             debug_id='df449af8-0dcd-4320-9943-ec192134d593',
             code_id='DF449AF80DCD43209943EC192134D593',
         )
+        set_assemble_status(self.project, checksum, None)
 
         # Request now tells us that everything is alright
         response = self.client.post(
