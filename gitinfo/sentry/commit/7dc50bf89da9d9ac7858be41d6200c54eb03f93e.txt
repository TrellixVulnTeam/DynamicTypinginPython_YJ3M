commit 7dc50bf89da9d9ac7858be41d6200c54eb03f93e
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Jan 20 16:28:52 2013 -0800

    Annotate frame data with original state when derived from sourcemap

diff --git a/src/sentry/interfaces.py b/src/sentry/interfaces.py
index 3345775b5b..3055dde7fa 100644
--- a/src/sentry/interfaces.py
+++ b/src/sentry/interfaces.py
@@ -228,6 +228,10 @@ class Stacktrace(Interface):
       Signifies whether this frame is related to the execution of the relevant code in this stacktrace. For example,
       the frames that might power the framework's webserver of your app are probably not relevant, however calls to
       the framework's library once you start handling code likely are.
+    ``vars``
+      A mapping of variables which were available within this frame (usually context-locals).
+    ``extra``
+      A mapping of arbitrary annotated data. Platform-specific.
 
     >>> {
     >>>     "frames": [{
diff --git a/src/sentry/tasks/fetch_source.py b/src/sentry/tasks/fetch_source.py
index efcf50f277..79e32498e1 100644
--- a/src/sentry/tasks/fetch_source.py
+++ b/src/sentry/tasks/fetch_source.py
@@ -192,10 +192,20 @@ def fetch_javascript_source(event, **kwargs):
             except KeyError:
                 pass
             else:
+                # Store original data in annotation
+                frame['data'] = {
+                    'orig_lineno': frame['lineno'],
+                    'orig_colno': frame['colno'],
+                    'orig_function': frame['function'],
+                    'orig_abs_path': frame['abs_path'],
+                    'orig_filename': frame['filename'],
+                    'sourcemap': sourcemap,
+                }
+
                 # SourceMap's return zero-indexed lineno's
                 frame['lineno'] = state.src_line + 1
                 frame['colno'] = state.src_col
-                frame['name'] = state.name
+                frame['function'] = state.name
                 frame['abs_path'] = abs_path
                 frame['filename'] = state.src
 
