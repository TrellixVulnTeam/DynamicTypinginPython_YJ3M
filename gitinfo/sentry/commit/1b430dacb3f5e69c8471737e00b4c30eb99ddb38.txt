commit 1b430dacb3f5e69c8471737e00b4c30eb99ddb38
Author: ted kaemming <ted@kaemming.com>
Date:   Tue Jun 20 10:27:36 2017 -0700

    Fix behavior of `first_seen` and `last_seen` for GroupTagValue during merge. (#5582)
    
    Fixes GH-5581.

diff --git a/src/sentry/tasks/merge.py b/src/sentry/tasks/merge.py
index 9242b5d631..b8b9d42995 100644
--- a/src/sentry/tasks/merge.py
+++ b/src/sentry/tasks/merge.py
@@ -257,11 +257,16 @@ def merge_objects(models, group, new_group, limit=1000,
                             )
                     elif model == GroupTagValue:
                         with transaction.atomic(using=router.db_for_write(model)):
-                            model.objects.filter(
+                            new_obj = model.objects.get(
                                 group_id=new_group.id,
                                 key=obj.key,
                                 value=obj.value,
-                            ).update(times_seen=F('times_seen') + obj.times_seen)
+                            )
+                            new_obj.update(
+                                first_seen=min(new_obj.first_seen, obj.first_seen),
+                                last_seen=max(new_obj.last_seen, obj.last_seen),
+                                times_seen=new_obj.times_seen + obj.times_seen,
+                            )
                 except DataError:
                     # it's possible to hit an out of range value for counters
                     pass
