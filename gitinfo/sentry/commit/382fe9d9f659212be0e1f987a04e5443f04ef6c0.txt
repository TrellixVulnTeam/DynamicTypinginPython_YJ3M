commit 382fe9d9f659212be0e1f987a04e5443f04ef6c0
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Fri Oct 18 20:29:38 2019 +0000

    feat: Remove custom event_id formatting for transactions dataset (#15128)
    
    This responsibility is moving into Snuba with
    https://github.com/getsentry/snuba/pull/525. Snuba will always expose
    event_ids as hexadecimal strings.

diff --git a/src/sentry/utils/snuba.py b/src/sentry/utils/snuba.py
index bd9a9c607c..223ae259eb 100644
--- a/src/sentry/utils/snuba.py
+++ b/src/sentry/utils/snuba.py
@@ -12,7 +12,6 @@ import re
 import six
 import time
 import urllib3
-import uuid
 
 from concurrent.futures import ThreadPoolExecutor
 from django.conf import settings
@@ -1042,12 +1041,6 @@ def constrain_condition_to_dataset(cond, dataset):
             if name is None:
                 return None
             cond[0] = name
-            # Reformat 32 byte uuids to 36 byte variants.
-            # The transactions dataset requires properly formatted uuid values.
-            # But the rest of sentry isn't aware of that requirement.
-            if dataset == Dataset.Transactions and name == "event_id" and len(cond[2]) == 32:
-                cond[2] = six.text_type(uuid.UUID(cond[2]))
-
             return cond
         if isinstance(cond[0], (list, tuple)):
             if get_function_index(cond[0]) is not None:
diff --git a/tests/sentry/utils/test_snuba.py b/tests/sentry/utils/test_snuba.py
index 63671a4b7d..bd2fb99152 100644
--- a/tests/sentry/utils/test_snuba.py
+++ b/tests/sentry/utils/test_snuba.py
@@ -527,63 +527,6 @@ class TransformAliasesAndQueryTransactionsTest(TestCase):
             orderby=None,
         )
 
-    @patch("sentry.utils.snuba.raw_query")
-    def test_condition_reformat_event_id_condition(self, mock_query):
-        mock_query.return_value = {
-            "meta": [{"name": "id"}, {"name": "duration"}],
-            "data": [{"event_id": "a" * 32, "duration": 200}],
-        }
-        transform_aliases_and_query(
-            skip_conditions=True,
-            selected_columns=["id", "transaction.duration"],
-            conditions=[["id", "=", "a" * 32]],
-            filter_keys={"project_id": [self.project.id]},
-        )
-        mock_query.assert_called_with(
-            selected_columns=["event_id", "duration"],
-            conditions=[["event_id", "=", "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa"]],
-            filter_keys={"project_id": [self.project.id]},
-            dataset=Dataset.Transactions,
-            aggregations=None,
-            arrayjoin=None,
-            end=None,
-            start=None,
-            having=None,
-            orderby=None,
-            groupby=None,
-        )
-
-    @patch("sentry.utils.snuba.raw_query")
-    def test_condition_reformat_nested_conditions(self, mock_query):
-        mock_query.return_value = {
-            "meta": [{"name": "id"}, {"name": "duration"}],
-            "data": [{"id": "a" * 32, "duration": 200}],
-        }
-        transform_aliases_and_query(
-            skip_conditions=True,
-            selected_columns=["id", "transaction.duration"],
-            conditions=[[["timestamp", ">", "2019-09-26T12:13:14"], ["id", "=", "a" * 32]]],
-            filter_keys={"project_id": [self.project.id]},
-        )
-        mock_query.assert_called_with(
-            selected_columns=["event_id", "duration"],
-            conditions=[
-                [
-                    ["finish_ts", ">", "2019-09-26T12:13:14"],
-                    ["event_id", "=", "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa"],
-                ]
-            ],
-            filter_keys={"project_id": [self.project.id]},
-            dataset=Dataset.Transactions,
-            aggregations=None,
-            arrayjoin=None,
-            end=None,
-            start=None,
-            having=None,
-            orderby=None,
-            groupby=None,
-        )
-
 
 class DetectDatasetTest(TestCase):
     def test_dataset_key(self):
diff --git a/tests/snuba/api/endpoints/test_organization_event_details.py b/tests/snuba/api/endpoints/test_organization_event_details.py
index e5f7d9b71a..289f04bc78 100644
--- a/tests/snuba/api/endpoints/test_organization_event_details.py
+++ b/tests/snuba/api/endpoints/test_organization_event_details.py
@@ -281,5 +281,5 @@ class OrganizationEventDetailsEndpointTest(APITestCase, SnubaTestCase):
                 data={"field": ["important", "count()"], "query": "transaction.duration:>2"},
             )
         assert response.status_code == 200
-        assert response.data["nextEventID"].replace("-", "") == "d" * 32
-        assert response.data["previousEventID"].replace("-", "") == "f" * 32
+        assert response.data["nextEventID"] == "d" * 32
+        assert response.data["previousEventID"] == "f" * 32
