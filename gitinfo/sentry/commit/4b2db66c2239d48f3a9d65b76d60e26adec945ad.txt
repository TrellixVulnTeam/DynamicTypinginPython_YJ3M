commit 4b2db66c2239d48f3a9d65b76d60e26adec945ad
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Mar 23 13:00:20 2015 -0700

    Unbreak to_json; introduce get_api_context

diff --git a/src/sentry/api/serializers/models/event.py b/src/sentry/api/serializers/models/event.py
index 6430fcf570..b0dfdf7292 100644
--- a/src/sentry/api/serializers/models/event.py
+++ b/src/sentry/api/serializers/models/event.py
@@ -13,7 +13,7 @@ class EventSerializer(Serializer):
             if key == 'user':
                 continue
             entry = {
-                'data': interface.to_json(),
+                'data': interface.get_api_context(),
                 'type': interface.get_alias(),
             }
             interface_list.append((interface, entry))
diff --git a/src/sentry/interfaces/base.py b/src/sentry/interfaces/base.py
index c08e820cda..2145e1214b 100644
--- a/src/sentry/interfaces/base.py
+++ b/src/sentry/interfaces/base.py
@@ -65,6 +65,9 @@ class Interface(object):
     def to_python(cls, data):
         return cls(data)
 
+    def get_api_context(self):
+        return self.to_json()
+
     def to_json(self):
         # eliminate empty values for serialization to compress the keyspace
         # and save (seriously) ridiculous amounts of bytes
diff --git a/src/sentry/interfaces/stacktrace.py b/src/sentry/interfaces/stacktrace.py
index cd6da349f9..4d4892936c 100644
--- a/src/sentry/interfaces/stacktrace.py
+++ b/src/sentry/interfaces/stacktrace.py
@@ -195,7 +195,7 @@ class Frame(Interface):
 
         return cls(**kwargs)
 
-    def to_json(self):
+    def get_api_context(self):
         return {
             'filename': self.filename,
             'absPath': self.abs_path,
@@ -454,12 +454,18 @@ class Stacktrace(Interface):
 
         return cls(**kwargs)
 
-    def to_json(self):
+    def get_api_context(self):
         return {
             'frames': [f.to_json() for f in self.frames],
             'framesOmitted': self.frames_omitted,
         }
 
+    def to_json(self):
+        return {
+            'frames': [f.to_json() for f in self.frames],
+            'frames_omitted': self.frames_omitted,
+        }
+
     def get_path(self):
         return 'sentry.interfaces.Stacktrace'
 
diff --git a/src/sentry/interfaces/user.py b/src/sentry/interfaces/user.py
index 3a33c2111d..ce99e1ff37 100644
--- a/src/sentry/interfaces/user.py
+++ b/src/sentry/interfaces/user.py
@@ -58,7 +58,7 @@ class User(Interface):
         kwargs['data'] = trim_dict(extra_data)
         return cls(**kwargs)
 
-    def to_json(self):
+    def get_api_context(self):
         return {
             'id': self.id,
             'email': self.email,
