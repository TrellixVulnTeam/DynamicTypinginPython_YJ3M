commit 237a150e253918c5c4b6231221f2ccfab82f6f92
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Sep 25 14:32:25 2011 -0700

    Some initial design cleanup

diff --git a/sentry/static/styles/global.css b/sentry/static/styles/global.css
index bd03586e08..ca817283c8 100644
--- a/sentry/static/styles/global.css
+++ b/sentry/static/styles/global.css
@@ -26,8 +26,8 @@ h1, h2, h3, h4, h5, h6 {
 }
 
 h1, h2, h3, h4, h5, h6, p, ul,
-table, form, pre, ol { margin-bottom: 20px; }
-ul { margin: 0 0 20px 20px; }
+table, form, pre, ol { margin-bottom: 15px; }
+ul { margin: 0 0 15px 20px; }
 
 a { color: #333; }
 a:visited { color: inherit; }
@@ -97,6 +97,37 @@ pre {
     text-decoration: none;
 }
 
+.module {
+    margin-bottom: 10px;
+    overflow: auto;
+}
+.module h2 {
+    color: #fff;
+    margin: 0;
+    padding: 5px 10px;
+    font-size: 1.1em;
+    border-radius: 5px 5px 0 0;
+    -moz-border-radius: 5px 5px 0 0;
+    -webkit-border-radius: 5px 5px 0 0;
+    -moz-box-shadow: inset 0 0 1px #22579b, 0 1px 0 #fff;
+    -webkit-box-shadow: inset 0 0 1px #22579b, 0 1px 0 #fff;
+    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#4da2e5', endColorstr='#3079d0'); /* for IE */
+    background: -webkit-gradient(linear, left top, left bottom, from(#4da2e5), to(#3079d0)); /* for webkit browsers */
+    background: -moz-linear-gradient(top,  #4da2e5,  #3079d0); /* for firefox 3.6+ */
+}
+.module-content {
+    -moz-box-shadow: inset 0 0 1px #22579b, 0 1px 0 #fff;
+    -webkit-box-shadow: inset 0 0 1px #22579b, 0 1px 0 #fff;
+    overflow: auto;
+    border-radius: 0 0 5px 5px;
+    -moz-border-radius: 0 0 5px 5px;
+    -webkit-border-radius: 0 0 5px 5px;
+    -moz-box-shadow: inset 0 0 1px #22579b, 0 1px 0 #fff;
+    -webkit-box-shadow: inset 0 0 1px #22579b, 0 1px 0 #fff;
+    padding: 10px 10px 0;
+}
+.module table, .module form, .module pre, .module ol, .module ul { margin-bottom: 10px; }
+
 #account {
     position: absolute;
     right: 35px;
@@ -307,7 +338,7 @@ pre {
     cursor: pointer;
 }
 
-#chart { margin-bottom: 20px; }
+#chart { margin-bottom: 15px; }
 
 /* tracebacks */
 .frame table.vars { margin:5px 0 2px 40px; }
@@ -323,23 +354,28 @@ table.vars thead th { padding:3px 6px 3px 3px; background:#eee; text-align:left;
 
 table.source th { color:#666; }
 table.source td { font-family:monospace; white-space:pre; border-bottom:1px solid #eee; }
-ul.traceback { list-style-type:none; }
-ul.traceback li.frame { margin-bottom:1em; overflow: hidden; position: relative; }
+ul.traceback { list-style-type: none; margin-left: 0;}
+ul.traceback li.frame { margin-bottom: 1em; overflow: hidden; position: relative; }
 div.context { margin: 10px 0; }
-div.context ol { padding-left:30px; margin:0 10px; list-style-position: inside; }
+div.context ol { padding-left: 20px; margin:0 0px; list-style-position: inside; }
 div.context ol li { font-family:monospace; white-space:pre; color:#666; cursor:pointer; }
 div.context ol.context-line li { color:black; background-color:#ccc; }
 div.context ol.context-line li span { float: right; }
-div.commands { margin-left: 40px; }
+div.commands { margin-left: 20px; }
 div.commands a { color:black; text-decoration:none; }
 #template, #template-not-exist { overflow: hidden; }
+#template li {
+    margin-left: 38px;
+    line-height: 1.5em;
+    font-family: monospace;
+}
 #template pre {
+    color: #000;
     margin-bottom: 0;
 }
 #template-not-exist ul { margin: 0 0 0 20px; }
 #unicode-hint { background:#eee; }
-#traceback { }
-#summary, #traceback, #unicode-hint, #template, #requestinfo, #versioninfo { margin-bottom: 20px; }
+#summary { margin-bottom: 15px; }
 #summary table, #summary pre { margin-bottom: 0; }
 #summary pre {
     line-height: 16px;
@@ -351,7 +387,7 @@ div.commands a { color:black; text-decoration:none; }
 /** variables **/
 #requestinfo { overflow: hidden; }
 #requestinfo > table { border: 0; width: 100%; margin-bottom: 0; }
-#requestinfo th.key, #requestinfo td.values { padding: 0 0 20px; position: relative; }
+#requestinfo th.key, #requestinfo td.values { padding: 0 0 15px; position: relative; }
 #requestinfo th.key { vertical-align: top; font-size: 1.1em; text-align: left; padding-right: 30px; }
 #requestinfo td.values td { }
 #requestinfo td.values th { text-align: left; }
diff --git a/sentry/templates/sentry/group/details.html b/sentry/templates/sentry/group/details.html
index 455a66cf30..3de962780a 100644
--- a/sentry/templates/sentry/group/details.html
+++ b/sentry/templates/sentry/group/details.html
@@ -106,132 +106,123 @@
             </div>
 
             {% if version_data %}
-                <div id="versioninfo">
+                <div id="versioninfo" class="module">
                     <h2>{% trans "Module Versions" %}</h2>
-                    <table class="inline">
-                        {% for k, v in version_data %}
-                            <tr>
-                                <th class="key">{{ k }}</th>
-                                <td class="values">{{ v }}</td>
-                            </tr>
-                        {% endfor %}
-                    </table>
+                    <div class="module-content">
+                        <table class="inline">
+                            {% for k, v in version_data %}
+                                <tr>
+                                    <th class="key">{{ k }}</th>
+                                    <td class="values">{{ v }}</td>
+                                </tr>
+                            {% endfor %}
+                        </table>
+                    </div>
                 </div>
             {% endif %}
 
             {% if template_info %}
-                <div id="template">
+                <div id="template" class="module">
                     <h2>Template error</h2>
-                    <p>In template <code>{{ template_info.name }}</code>, error at line <strong>{{ template_info.line }}</strong></p>
-                    <h3>{{ template_info.message }}</h3>
-                    <ol>
-                    {% for source_line in template_info.source_lines %}
-                        <li class="{% if source_line.0 == template_info.line %} selected{% endif %}" value="{{ source_line.0 }}">
-                        {% if source_line.0 == template_info.line %}
-                            <pre>{{ template_info.before }}<span class="specific">{{ template_info.during }}</span>{{ template_info.after }}</pre>
-                        {% else %}
-                            <pre>{{ source_line.1 }}</pre>
-                        {% endif %}
-                    {% endfor %}
-                    </table>
+                    <div class="module-content">
+                        <p>In template <code>{{ template_info.name }}</code>, error at line <strong>{{ template_info.line }}</strong></p>
+                        <h3>{{ template_info.message }}</h3>
+                        <ol>
+                        {% for source_line in template_info.source_lines %}
+                            <li class="{% if source_line.0 == template_info.line %} selected{% endif %}" value="{{ source_line.0 }}">
+                            {% if source_line.0 == template_info.line %}
+                                <pre>{{ template_info.before }}<span class="specific">{{ template_info.during }}</span>{{ template_info.after }}</pre>
+                            {% else %}
+                                <pre>{{ source_line.1 }}</pre>
+                            {% endif %}
+                        {% endfor %}
+                        </table>
+                    </div>
                 </div>
             {% endif %}
 
             {% if frames %}
-                <div id="traceback">
-                  <h2>Traceback</h2>
-                  {% autoescape off %}
-                  <div id="browserTraceback">
-                    <ul class="traceback">
-                      {% for frame in frames %}
-                        <li class="frame">
-                          <code>{{ frame.filename|escape }}</code> in <code>{{ frame.function|escape }}</code>
+                <div id="traceback" class="module">
+                    <h2>Traceback</h2>
+                    <div class="module-content">
+                        {% autoescape off %}
+                        <div id="browserTraceback">
+                        <ul class="traceback">
+                          {% for frame in frames %}
+                            <li class="frame">
+                              <code>{{ frame.filename|escape }}</code> in <code>{{ frame.function|escape }}</code>
 
-                          {% if frame.context_line %}
-                            <div class="context" id="c{{ frame.id }}">
-                              {% if frame.pre_context %}
-                                <ol start="{{ frame.pre_context_lineno }}" class="pre-context" id="pre{{ frame.id }}">{% for line in frame.pre_context %}<li onclick="toggle('pre{{ frame.id }}', 'post{{ frame.id }}')">{{ line|escape }}</li>{% endfor %}</ol>
-                              {% endif %}
-                              <ol start="{{ frame.lineno }}" class="context-line"><li onclick="toggle('pre{{ frame.id }}', 'post{{ frame.id }}')">{{ frame.context_line|escape }} <span>...</span></li></ol>
-                              {% if frame.post_context %}
-                                <ol start='{{ frame.lineno|plus:1 }}' class="post-context" id="post{{ frame.id }}">{% for line in frame.post_context %}<li onclick="toggle('pre{{ frame.id }}', 'post{{ frame.id }}')">{{ line|escape }}</li>{% endfor %}</ol>
+                              {% if frame.context_line %}
+                                <div class="context" id="c{{ frame.id }}">
+                                  {% if frame.pre_context %}
+                                    <ol start="{{ frame.pre_context_lineno }}" class="pre-context" id="pre{{ frame.id }}">{% for line in frame.pre_context %}<li onclick="toggle('pre{{ frame.id }}', 'post{{ frame.id }}')">{{ line|escape }}</li>{% endfor %}</ol>
+                                  {% endif %}
+                                  <ol start="{{ frame.lineno }}" class="context-line"><li onclick="toggle('pre{{ frame.id }}', 'post{{ frame.id }}')">{{ frame.context_line|escape }} <span>...</span></li></ol>
+                                  {% if frame.post_context %}
+                                    <ol start='{{ frame.lineno|plus:1 }}' class="post-context" id="post{{ frame.id }}">{% for line in frame.post_context %}<li onclick="toggle('pre{{ frame.id }}', 'post{{ frame.id }}')">{{ line|escape }}</li>{% endfor %}</ol>
+                                  {% endif %}
+                                </div>
                               {% endif %}
-                            </div>
-                          {% endif %}
 
-                          {% if frame.vars %}
-                            <div class="commands">
-                                <a href="#" onclick="return varToggle(this, '{{ frame.id }}')"><span>&#x25b6;</span> Local vars</a>
-                            </div>
-                            <table class="vars" id="v{{ frame.id }}">
-                              <thead>
-                                <tr>
-                                  <th>Variable</th>
-                                  <th>Value</th>
-                                </tr>
-                              </thead>
-                              <tbody>
-                              {% for var in frame.vars|dictsort:"0" %}
-                                <tr>
-                                  <td>{{ var.0|escape }}</td>
-                                  <td class="code"><pre>{{ var.1|pprint|escape }}</pre></td>
-                                </tr>
-                              {% endfor %}
-                              </tbody>
-                            </table>
-                          {% endif %}
-                        </li>
-                      {% endfor %}
-                    </ul>
-                  </div>
-                  {% endautoescape %}
+                              {% if frame.vars %}
+                                <div class="commands">
+                                    <a href="#" onclick="return varToggle(this, '{{ frame.id }}')"><span>&#x25b6;</span> Local vars</a>
+                                </div>
+                                <table class="vars" id="v{{ frame.id }}">
+                                  <thead>
+                                    <tr>
+                                      <th>Variable</th>
+                                      <th>Value</th>
+                                    </tr>
+                                  </thead>
+                                  <tbody>
+                                  {% for var in frame.vars|dictsort:"0" %}
+                                    <tr>
+                                      <td>{{ var.0|escape }}</td>
+                                      <td class="code"><pre>{{ var.1|pprint|escape }}</pre></td>
+                                    </tr>
+                                  {% endfor %}
+                                  </tbody>
+                                </table>
+                              {% endif %}
+                            </li>
+                          {% endfor %}
+                        </ul>
+                        </div>
+                        {% endautoescape %}
+                    </div>
                 </div>
             {% else %}
-                {% if group.traceback %}
-                    <pre>{{ group.traceback }}</pre>
-                {% endif %}
+                <div id="traceback" class="module">
+                    <h2>Traceback</h2>
+                    <div class="module-content">
+                        {% if group.traceback %}
+                            <pre>{{ group.traceback }}</pre>
+                        {% endif %}
+                    </div>
+                </div>
             {% endif %}
 
             {% if group|has_charts %}
-                <h2>{% trans "Frequency" %}</h2>
-                <div id="chart">
-                    <noscript>{% trans "Get yourself some JavaScripts dood" %}</noscript>
-                    <p>Loading...</p>
+                <div class="module">
+                    <h2>{% trans "Frequency" %}</h2>
+                    <div class="module-content">
+                        <div id="chart">
+                            <noscript>{% trans "Get yourself some JavaScripts dood" %}</noscript>
+                            <p>Loading...</p>
+                        </div>
+                    </div>
                 </div>
             {% endif %}
 
-            <div id="requestinfo">
+            <div id="requestinfo" class="module">
                 <h2>{% trans "Additional Data" %}</h2>
-                <table>
-                    {% if user_data %}
-                        <tr>
-                            <th class="key">USER</th>
-                            <td class="values">
-                                <table class="vars">
-                                    <thead>
-                                        <tr>
-                                            <th>{% trans "Variable" %}</th>
-                                            <th>{% trans "Value" %}</th>
-                                        </tr>
-                                    </thead>
-                                    <tbody>
-                                        {% for k_, v_ in user_data.iteritems|as_sorted %}
-                                        <tr>
-                                            <td>{{ k_ }}</td>
-                                            <td class="code"><pre>{{ v_|pprint }}</pre></td>
-                                        </tr>
-                                        {% endfor %}
-                                    </tbody>
-                                </table>
-                            </td>
-                        </tr>
-                    {% endif %}
-                    {% for k, v in json_data %}
-                        <tr>
-                            <th class="key">{{ k }}</th>
-                            <td class="values">
-                            {% if v %}
-                                {% if v|is_dict %}
+                <div class="module-content">
+                    <table>
+                        {% if user_data %}
+                            <tr>
+                                <th class="key">USER</th>
+                                <td class="values">
                                     <table class="vars">
                                         <thead>
                                             <tr>
@@ -240,7 +231,7 @@
                                             </tr>
                                         </thead>
                                         <tbody>
-                                            {% for k_, v_ in v.iteritems|as_sorted %}
+                                            {% for k_, v_ in user_data.iteritems|as_sorted %}
                                             <tr>
                                                 <td>{{ k_ }}</td>
                                                 <td class="code"><pre>{{ v_|pprint }}</pre></td>
@@ -248,16 +239,42 @@
                                             {% endfor %}
                                         </tbody>
                                     </table>
+                                </td>
+                            </tr>
+                        {% endif %}
+                        {% for k, v in json_data %}
+                            <tr>
+                                <th class="key">{{ k }}</th>
+                                <td class="values">
+                                {% if v %}
+                                    {% if v|is_dict %}
+                                        <table class="vars">
+                                            <thead>
+                                                <tr>
+                                                    <th>{% trans "Variable" %}</th>
+                                                    <th>{% trans "Value" %}</th>
+                                                </tr>
+                                            </thead>
+                                            <tbody>
+                                                {% for k_, v_ in v.iteritems|as_sorted %}
+                                                <tr>
+                                                    <td>{{ k_ }}</td>
+                                                    <td class="code"><pre>{{ v_|pprint }}</pre></td>
+                                                </tr>
+                                                {% endfor %}
+                                            </tbody>
+                                        </table>
+                                    {% else %}
+                                        <pre>{{ v|pprint }}</pre>
+                                    {% endif %}
                                 {% else %}
-                                    <pre>{{ v|pprint }}</pre>
+                                    <p>{% blocktrans with k as varname %}No data for {{ varname }}{% endblocktrans %}</p>
                                 {% endif %}
-                            {% else %}
-                                <p>{% blocktrans with k as varname %}No data for {{ varname }}{% endblocktrans %}</p>
-                            {% endif %}
-                            </td>
-                        </tr>
-                    {% endfor %}
-                </table>
+                                </td>
+                            </tr>
+                        {% endfor %}
+                    </table>
+                </div>
             </div>
         </div>
     {% endblock %}
diff --git a/sentry/web/views.py b/sentry/web/views.py
index 6ba7bee86c..8f4aa67a9d 100644
--- a/sentry/web/views.py
+++ b/sentry/web/views.py
@@ -366,8 +366,8 @@ def group(request, group_id):
 
         if module and args:
             # We fake the exception class due to many issues with imports/builtins/etc
-            exc_type = type(str(obj.class_name), (Exception,), {})
-            exc_value = exc_type(obj.message)
+            exc_type = obj.class_name
+            exc_value = type(str(obj.class_name), (Exception,), {})(obj.message)
             exc_value.args = args
 
         if 'template' in sentry_data:
@@ -442,8 +442,8 @@ def group_message_details(request, group_id, message_id):
 
         if module and args:
             # We fake the exception class due to many issues with imports/builtins/etc
-            exc_type = type(str(message.class_name), (Exception,), {})
-            exc_value = exc_type(message.message)
+            exc_type = message.class_name
+            exc_value = type(str(message.class_name), (Exception,), {})(message.message)
             exc_value.args = args
 
         if 'template' in sentry_data:
