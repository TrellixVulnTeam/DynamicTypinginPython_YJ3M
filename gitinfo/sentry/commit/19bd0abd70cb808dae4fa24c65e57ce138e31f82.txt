commit 19bd0abd70cb808dae4fa24c65e57ce138e31f82
Author: josh <josh@jrl.ninja>
Date:   Thu Dec 19 10:59:32 2019 -0800

    fix: sentry now installs via pep517-enabled pip (#16184)

diff --git a/.travis.yml b/.travis.yml
index 33f8f70ecb..eda53672af 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -28,7 +28,6 @@ env:
     # PIP_VERSION causes issues because: https://github.com/pypa/pip/issues/4528
     # Note: this has to be synced with the pip version in the Makefile.
     - PYTHON_PIP_VERSION=19.2.3
-    - PIP_USE_PEP517=off
     - PIP_DISABLE_PIP_VERSION_CHECK=on
     - PIP_QUIET=1
     - SENTRY_LIGHT_BUILD=1
diff --git a/Makefile b/Makefile
index 15915c2ea7..0433eb7a73 100644
--- a/Makefile
+++ b/Makefile
@@ -10,7 +10,7 @@ endif
 PIP := LDFLAGS="$(LDFLAGS)" python -m pip
 # Note: this has to be synced with the pip version in .travis.yml.
 PIP_VERSION := 19.2.3
-PIP_OPTS := --no-use-pep517 --disable-pip-version-check
+PIP_OPTS := --disable-pip-version-check
 WEBPACK := NODE_ENV=production ./bin/yarn webpack
 YARN := ./bin/yarn
 
diff --git a/docker/Dockerfile b/docker/Dockerfile
index af7f679d1d..0933c90f19 100644
--- a/docker/Dockerfile
+++ b/docker/Dockerfile
@@ -101,7 +101,6 @@ COPY --from=sdist /usr/local/bin/gosu /usr/local/bin/tini /usr/local/bin/
 # Sane defaults for pip
 ENV PIP_NO_CACHE_DIR=off \
     PIP_DISABLE_PIP_VERSION_CHECK=1 \
-    PIP_USE_PEP517=off \
     # Sentry config params
     SENTRY_CONF=/etc/sentry \
     SENTRY_FILESTORE_DIR=/var/lib/sentry/files \
diff --git a/setup.py b/setup.py
index 942f8bf49a..e1d0818f45 100755
--- a/setup.py
+++ b/setup.py
@@ -14,7 +14,7 @@ from setuptools import setup, find_packages
 from setuptools.command.sdist import sdist as SDistCommand
 from setuptools.command.develop import develop as DevelopCommand
 
-ROOT = os.path.realpath(os.path.join(os.path.dirname(sys.modules["__main__"].__file__)))
+ROOT = os.path.dirname(os.path.abspath(__file__))
 
 # add sentry to path so we can import distutils
 # XXX: consequentially, this means sentry must be pip installed with --no-use-pep517
