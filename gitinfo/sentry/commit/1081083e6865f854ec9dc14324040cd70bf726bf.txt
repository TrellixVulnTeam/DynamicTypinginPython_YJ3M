commit 1081083e6865f854ec9dc14324040cd70bf726bf
Author: Mark Story <mark@sentry.io>
Date:   Mon Jul 6 14:34:32 2020 -0400

    ref(ui) Replace icon-open with SVG icon. (#19716)
    
    * ref(ui) Replace icon-open with SVG icon.
    * Fix frame title icon positioning.
    * Fix context data positioning.

diff --git a/src/sentry/static/sentry/app/components/contextData.jsx b/src/sentry/static/sentry/app/components/contextData.jsx
index de0ba35dd2..890971e253 100644
--- a/src/sentry/static/sentry/app/components/contextData.jsx
+++ b/src/sentry/static/sentry/app/components/contextData.jsx
@@ -3,8 +3,10 @@ import React from 'react';
 import isString from 'lodash/isString';
 import isNumber from 'lodash/isNumber';
 import isArray from 'lodash/isArray';
+import styled from '@emotion/styled';
 
 import AnnotatedText from 'app/components/events/meta/annotatedText';
+import {IconOpen} from 'app/icons';
 import {isUrl} from 'app/utils';
 
 function looksLikeObjectRepr(value) {
@@ -164,7 +166,7 @@ class ContextData extends React.Component {
         if (valueInfo.isString && isUrl(value)) {
           out.push(
             <a key="external" href={value} className="external-icon">
-              <em className="icon-open" />
+              <StyledIconOpen size="xs" />
             </a>
           );
         }
@@ -251,4 +253,9 @@ class ContextData extends React.Component {
 
 ContextData.displayName = 'ContextData';
 
+const StyledIconOpen = styled(IconOpen)`
+  position: relative;
+  top: 1px;
+`;
+
 export default ContextData;
diff --git a/src/sentry/static/sentry/app/components/events/interfaces/cspHelp.jsx b/src/sentry/static/sentry/app/components/events/interfaces/cspHelp.jsx
index baabf22761..1b0449ca5d 100644
--- a/src/sentry/static/sentry/app/components/events/interfaces/cspHelp.jsx
+++ b/src/sentry/static/sentry/app/components/events/interfaces/cspHelp.jsx
@@ -2,6 +2,7 @@ import PropTypes from 'prop-types';
 import React from 'react';
 
 import {t} from 'app/locale';
+import {IconOpen} from 'app/icons';
 
 const help = {
   'base-uri': t(
@@ -133,7 +134,7 @@ function getLink(key) {
     <span>
       <a href={href}>developer.mozilla.org</a>
       <a href={href} className="external-icon">
-        <em className="icon-open" />
+        <IconOpen size="xs" />
       </a>
     </span>
   );
diff --git a/src/sentry/static/sentry/app/components/events/interfaces/exceptionMechanism.jsx b/src/sentry/static/sentry/app/components/events/interfaces/exceptionMechanism.jsx
index 227cb78c8c..f6b50c0d2a 100644
--- a/src/sentry/static/sentry/app/components/events/interfaces/exceptionMechanism.jsx
+++ b/src/sentry/static/sentry/app/components/events/interfaces/exceptionMechanism.jsx
@@ -9,8 +9,8 @@ import space from 'app/styles/space';
 import Pills from 'app/components/pills';
 import Pill from 'app/components/pill';
 import Hovercard from 'app/components/hovercard';
-import InlineSvg from 'app/components/inlineSvg';
 import {t} from 'app/locale';
+import {IconInfo, IconOpen} from 'app/icons';
 import {isUrl} from 'app/utils';
 
 class ExceptionMechanism extends React.Component {
@@ -49,7 +49,7 @@ class ExceptionMechanism extends React.Component {
 
     const linkElement = help_link && isUrl(help_link) && (
       <a href={help_link} className="external-icon">
-        <em className="icon-open" />
+        <IconOpen size="xs" />
       </a>
     );
 
@@ -63,7 +63,7 @@ class ExceptionMechanism extends React.Component {
         body={description}
         containerClassName="pill-icon"
       >
-        <InlineSvg src="icon-circle-info" size="14px" />
+        <IconInfo isCircled size="14px" />
       </Hovercard>
     );
 
diff --git a/src/sentry/static/sentry/app/components/events/interfaces/frame/frameDefaultTitle.tsx b/src/sentry/static/sentry/app/components/events/interfaces/frame/frameDefaultTitle.tsx
index cc7f2135b5..969348f352 100644
--- a/src/sentry/static/sentry/app/components/events/interfaces/frame/frameDefaultTitle.tsx
+++ b/src/sentry/static/sentry/app/components/events/interfaces/frame/frameDefaultTitle.tsx
@@ -1,14 +1,16 @@
 import React from 'react';
+import styled from '@emotion/styled';
 
 import {Meta} from 'app/types';
 import {defined, isUrl} from 'app/utils';
 import Tooltip from 'app/components/tooltip';
 import Truncate from 'app/components/truncate';
-import {IconQuestion} from 'app/icons';
+import {IconQuestion, IconOpen} from 'app/icons';
 import ExternalLink from 'app/components/links/externalLink';
 import AnnotatedText from 'app/components/events/meta/annotatedText';
 import {t} from 'app/locale';
 import {getMeta} from 'app/components/events/meta/metaProxy';
+import space from 'app/styles/space';
 
 import FrameFunctionName from './frameFunctionName';
 import {getPlatform, trimPackage} from './utils';
@@ -96,12 +98,9 @@ const FrameDefaultTitle = ({frame, platform}: Props) => {
 
     if (frame.absPath && isUrl(frame.absPath)) {
       title.push(
-        <ExternalLink
-          href={frame.absPath}
-          className="icon-open"
-          key="share"
-          onClick={handleExternalLink}
-        />
+        <StyledExternalLink href={frame.absPath} key="share" onClick={handleExternalLink}>
+          <IconOpen size="xs" />
+        </StyledExternalLink>
       );
     }
 
@@ -165,4 +164,10 @@ const FrameDefaultTitle = ({frame, platform}: Props) => {
   return title;
 };
 
+const StyledExternalLink = styled(ExternalLink)`
+  position: relative;
+  top: 2px;
+  margin-left: ${space(0.5)};
+`;
+
 export default FrameDefaultTitle;
diff --git a/src/sentry/static/sentry/app/views/releases/detail/releaseAllEvents.jsx b/src/sentry/static/sentry/app/views/releases/detail/releaseAllEvents.jsx
index b20611c46d..a55aa25b5c 100644
--- a/src/sentry/static/sentry/app/views/releases/detail/releaseAllEvents.jsx
+++ b/src/sentry/static/sentry/app/views/releases/detail/releaseAllEvents.jsx
@@ -5,12 +5,13 @@ import SentryTypes from 'app/sentryTypes';
 import Alert from 'app/components/alert';
 import GroupList from 'app/components/issues/groupList';
 import {t} from 'app/locale';
+import {IconOpen} from 'app/icons';
 
 const ReleaseAllEvents = ({release, params}) => {
   const {orgId} = params;
   return (
     <div>
-      <Alert icon="icon-open" iconSize="14px" type="warning">
+      <Alert icon={<IconOpen size="14px" />} type="warning">
         <Link
           to={{
             pathname: `/organizations/${orgId}/issues/`,
diff --git a/src/sentry/static/sentry/app/views/releases/detail/releaseArtifacts.jsx b/src/sentry/static/sentry/app/views/releases/detail/releaseArtifacts.jsx
index 8c751e99ce..9ed6019ac2 100644
--- a/src/sentry/static/sentry/app/views/releases/detail/releaseArtifacts.jsx
+++ b/src/sentry/static/sentry/app/views/releases/detail/releaseArtifacts.jsx
@@ -11,6 +11,7 @@ import {
   addSuccessMessage,
 } from 'app/actionCreators/indicator';
 import {t} from 'app/locale';
+import Button from 'app/components/button';
 import EmptyStateWarning from 'app/components/emptyStateWarning';
 import FileSize from 'app/components/fileSize';
 import LinkWithConfirmation from 'app/components/links/linkWithConfirmation';
@@ -18,11 +19,10 @@ import LoadingError from 'app/components/loadingError';
 import LoadingIndicator from 'app/components/loadingIndicator';
 import Pagination from 'app/components/pagination';
 import SentryTypes from 'app/sentryTypes';
-import Tooltip from 'app/components/tooltip';
 import withApi from 'app/utils/withApi';
 import withOrganization from 'app/utils/withOrganization';
 import space from 'app/styles/space';
-import {IconDelete} from 'app/icons';
+import {IconDelete, IconOpen} from 'app/icons';
 
 class ReleaseArtifacts extends React.Component {
   static propTypes = {
@@ -144,26 +144,26 @@ class ReleaseArtifacts extends React.Component {
                   <FileSize bytes={file.size} />
                   <AlignCenter>
                     {access.has('project:write') ? (
-                      <a
+                      <Button
+                        data-test-id="artifact-download"
                         href={
                           this.props.api.baseUrl +
                           this.getFilesEndpoint() +
                           `${file.id}/?download=1`
                         }
-                        className="btn btn-sm btn-default"
-                      >
-                        <span className="icon icon-open" />
-                      </a>
+                        size="small"
+                        icon={<IconOpen size="xs" />}
+                      />
                     ) : (
-                      <Tooltip
+                      <Button
+                        data-test-id="artifact-download"
                         title={t(
                           'You do not have the required permission to download this artifact.'
                         )}
-                      >
-                        <div className="btn btn-sm btn-default disabled">
-                          <span className="icon icon-open" />
-                        </div>
-                      </Tooltip>
+                        disabled
+                        size="small"
+                        icon={<IconOpen size="xs" />}
+                      />
                     )}
                     <div style={{marginLeft: 5}}>
                       <LinkWithConfirmation
diff --git a/src/sentry/static/sentry/app/views/releases/detail/releaseDeploys.jsx b/src/sentry/static/sentry/app/views/releases/detail/releaseDeploys.jsx
index 62587e58f7..e0be3d0f5c 100644
--- a/src/sentry/static/sentry/app/views/releases/detail/releaseDeploys.jsx
+++ b/src/sentry/static/sentry/app/views/releases/detail/releaseDeploys.jsx
@@ -3,7 +3,7 @@ import React from 'react';
 import styled from '@emotion/styled';
 
 import {t} from 'app/locale';
-import InlineSvg from 'app/components/inlineSvg';
+import {IconOpen} from 'app/icons';
 import Link from 'app/components/links/link';
 import RepoLabel from 'app/components/repoLabel';
 import TimeSince from 'app/components/timeSince';
@@ -39,7 +39,7 @@ export default class ReleaseDeploys extends React.Component {
                         <div className="col-xs-6">
                           <ReleaseRepoLabel>
                             {deploy.environment}
-                            <InlineSvg src="icon-open" style={{marginLeft: 6}} />
+                            <StyledIconOpen size="xs" />
                           </ReleaseRepoLabel>
                         </div>
                         <div className="col-xs-6 align-right">
@@ -58,6 +58,10 @@ export default class ReleaseDeploys extends React.Component {
   }
 }
 
+const StyledIconOpen = styled(IconOpen)`
+  margin-left: 6px;
+`;
+
 const ReleaseRepoLabel = styled(RepoLabel)`
   padding: 5px 8px;
   vertical-align: bottom;
diff --git a/src/sentry/static/sentry/app/views/releases/detail/releaseNewEvents.jsx b/src/sentry/static/sentry/app/views/releases/detail/releaseNewEvents.jsx
index 1bd6f99cc4..5b8db6fc3d 100644
--- a/src/sentry/static/sentry/app/views/releases/detail/releaseNewEvents.jsx
+++ b/src/sentry/static/sentry/app/views/releases/detail/releaseNewEvents.jsx
@@ -5,6 +5,7 @@ import SentryTypes from 'app/sentryTypes';
 import Alert from 'app/components/alert';
 import GroupList from 'app/components/issues//groupList';
 import {t} from 'app/locale';
+import {IconOpen} from 'app/icons';
 
 const ReleaseNewEvents = props => {
   const {release} = props;
@@ -12,7 +13,7 @@ const ReleaseNewEvents = props => {
 
   return (
     <div>
-      <Alert icon="icon-open" iconSize="14px" type="warning">
+      <Alert icon={<IconOpen size="14px" />} type="warning">
         <Link
           to={{
             pathname: `/organizations/${orgId}/issues/`,
diff --git a/src/sentry/static/sentry/app/views/settings/organizationDeveloperSettings/sentryApplicationDashboard/requestLog.tsx b/src/sentry/static/sentry/app/views/settings/organizationDeveloperSettings/sentryApplicationDashboard/requestLog.tsx
index 003f9cb3d9..2de2945e1a 100644
--- a/src/sentry/static/sentry/app/views/settings/organizationDeveloperSettings/sentryApplicationDashboard/requestLog.tsx
+++ b/src/sentry/static/sentry/app/views/settings/organizationDeveloperSettings/sentryApplicationDashboard/requestLog.tsx
@@ -14,9 +14,8 @@ import ExternalLink from 'app/components/links/externalLink';
 import LoadingIndicator from 'app/components/loadingIndicator';
 import Checkbox from 'app/components/checkbox';
 import Button from 'app/components/button';
-import InlineSvg from 'app/components/inlineSvg';
 import space from 'app/styles/space';
-import {IconChevron} from 'app/icons';
+import {IconChevron, IconOpen} from 'app/icons';
 import {t} from 'app/locale';
 import {SentryApp, SentryAppWebhookRequest, SentryAppSchemaIssueLink} from 'app/types';
 import {Theme} from 'app/utils/theme';
@@ -89,7 +88,7 @@ const TimestampLink = ({date, link}: {date: moment.MomentInput; link?: string})
   link ? (
     <ExternalLink href={link}>
       <DateTime date={date} />
-      <StyledInlineSvg src="icon-open" size="12px" />
+      <StyledIconOpen size="12px" />
     </ExternalLink>
   ) : (
     <DateTime date={date} />
@@ -347,7 +346,7 @@ const StyledErrorsOnlyButton = styled(Button)`
   border-bottom-left-radius: 0;
 `;
 
-const StyledInlineSvg = styled(InlineSvg)`
+const StyledIconOpen = styled(IconOpen)`
   margin-left: 6px;
   color: ${p => p.theme.gray600};
 `;
diff --git a/tests/js/spec/components/events/interfaces/__snapshots__/exceptionMechanism.spec.jsx.snap b/tests/js/spec/components/events/interfaces/__snapshots__/exceptionMechanism.spec.jsx.snap
index 3c78b4af48..8591485eb6 100644
--- a/tests/js/spec/components/events/interfaces/__snapshots__/exceptionMechanism.spec.jsx.snap
+++ b/tests/js/spec/components/events/interfaces/__snapshots__/exceptionMechanism.spec.jsx.snap
@@ -49,17 +49,17 @@ exports[`ExceptionMechanism basic attributes should add the help_link to the des
               className="external-icon"
               href="https://example.org/help"
             >
-              <em
-                className="icon-open"
+              <ForwardRef(IconOpen)
+                size="xs"
               />
             </a>
           </span>
         }
         position="top"
       >
-        <InlineSvg
+        <IconInfo
+          isCircled={true}
           size="14px"
-          src="icon-circle-info"
         />
       </Hovercard>
     </Pill>
@@ -87,9 +87,9 @@ exports[`ExceptionMechanism basic attributes should not add the help_link if not
         }
         position="top"
       >
-        <InlineSvg
+        <IconInfo
+          isCircled={true}
           size="14px"
-          src="icon-circle-info"
         />
       </Hovercard>
     </Pill>
@@ -117,9 +117,9 @@ exports[`ExceptionMechanism basic attributes should render a description hoverca
         }
         position="top"
       >
-        <InlineSvg
+        <IconInfo
+          isCircled={true}
           size="14px"
-          src="icon-circle-info"
         />
       </Hovercard>
     </Pill>
@@ -139,8 +139,8 @@ exports[`ExceptionMechanism basic attributes should render a help_link icon 1`]
         className="external-icon"
         href="https://example.org/help"
       >
-        <em
-          className="icon-open"
+        <IconOpen
+          size="xs"
         />
       </a>
     </Pill>
diff --git a/tests/js/spec/views/releases/detail/releaseArtifacts.spec.jsx b/tests/js/spec/views/releases/detail/releaseArtifacts.spec.jsx
index a0129fd3b1..a0b30b291e 100644
--- a/tests/js/spec/views/releases/detail/releaseArtifacts.spec.jsx
+++ b/tests/js/spec/views/releases/detail/releaseArtifacts.spec.jsx
@@ -1,6 +1,6 @@
 import React from 'react';
 
-import {shallow, mount} from 'sentry-test/enzyme';
+import {mountWithTheme} from 'sentry-test/enzyme';
 
 import {Client} from 'app/api';
 import {ReleaseArtifacts} from 'app/views/releases/detail/releaseArtifacts';
@@ -42,7 +42,7 @@ describe('ReleaseArtifacts', function() {
       method: 'DELETE',
     });
 
-    wrapper = mount(
+    wrapper = mountWithTheme(
       <ReleaseArtifacts
         location={{query: {cursor: '0:0:100'}}}
         params={{orgId: '123', projectId: '456', release: 'abcdef'}}
@@ -51,7 +51,7 @@ describe('ReleaseArtifacts', function() {
       />
     );
 
-    wrapperWithPermission = shallow(
+    wrapperWithPermission = mountWithTheme(
       <ReleaseArtifacts
         location={{query: {cursor: '0:0:100'}}}
         params={{orgId: '123', projectId: '456', release: 'abcdef'}}
@@ -73,7 +73,9 @@ describe('ReleaseArtifacts', function() {
     });
 
     it('should have no permission to download', function() {
-      expect(wrapper.find('div.btn > .icon-open')).toHaveLength(2);
+      const buttons = wrapper.find('Button[data-test-id="artifact-download"]');
+      expect(buttons).toHaveLength(2);
+      expect(buttons.first().props().disabled).toBe(true);
     });
 
     it('should have permission to download', function() {
@@ -94,7 +96,9 @@ describe('ReleaseArtifacts', function() {
         ],
       });
 
-      expect(wrapper.find('a.btn > .icon-open')).toHaveLength(2);
+      const buttons = wrapper.find('Button[data-test-id="artifact-download"]');
+      expect(buttons).toHaveLength(2);
+      expect(buttons.first().props().disabled).toBe(false);
     });
   });
 
