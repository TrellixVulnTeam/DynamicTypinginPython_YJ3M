commit 0d212ef241fc832ed452ea6f2c5452ed55a564ba
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Oct 14 20:45:57 2014 +0100

    Correct keying for sourcemaps

diff --git a/src/sentry/tasks/fetch_source.py b/src/sentry/tasks/fetch_source.py
index aba65def10..1524561f91 100644
--- a/src/sentry/tasks/fetch_source.py
+++ b/src/sentry/tasks/fetch_source.py
@@ -299,13 +299,13 @@ def expand_javascript_source(data, **kwargs):
         else:
             logger.debug('Found sourcemap %r for minified script %r', sourcemap[:256], result.url)
 
-        sourcemap_key = hashlib.md5(sourcemap).hexdigest()
-
         if is_data_uri(sourcemap):
             sourcemap_url = result.url
         else:
             sourcemap_url = sourcemap_url
 
+        sourcemap_key = hashlib.md5(sourcemap_url).hexdigest()
+
         source_code[filename] = (result.body.splitlines(), sourcemap_url, sourcemap_key)
 
         if sourcemap in sourmap_idxs:
