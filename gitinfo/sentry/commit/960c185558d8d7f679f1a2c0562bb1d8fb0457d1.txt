commit 960c185558d8d7f679f1a2c0562bb1d8fb0457d1
Author: Jess MacQueen <jessmacqueen@gmail.com>
Date:   Mon Apr 3 11:41:34 2017 -0700

    don't assume release request will finish before repo request - fixes JAVASCRIPT-1YC (#5162)
    
    * don't assume release request will finish before repo request - fixes JAVASCRIPT-1YC
    
    * use after
    
    * move done into fetch data

diff --git a/src/sentry/static/sentry/app/components/versionHoverCard.jsx b/src/sentry/static/sentry/app/components/versionHoverCard.jsx
index 5bada3758f..c139a8cfcf 100644
--- a/src/sentry/static/sentry/app/components/versionHoverCard.jsx
+++ b/src/sentry/static/sentry/app/components/versionHoverCard.jsx
@@ -1,4 +1,5 @@
 import React from 'react';
+import _ from 'underscore';
 
 import Avatar from './avatar';
 
@@ -31,12 +32,20 @@ const VersionHoverCard = React.createClass({
   },
 
   componentDidMount() {
+    this.fetchData();
+  },
+
+  fetchData() {
     let {orgId, projectId, version} = this.props;
+    let done = _.after(2, () => {
+      this.setState({loading: false});
+    });
 
-    let path = `/projects/${orgId}/${projectId}/releases/${version}/`;
-    this.api.request(path, {
+    // releases
+    let releasePath = `/projects/${orgId}/${projectId}/releases/${version}/`;
+    this.api.request(releasePath, {
       method: 'GET',
-      success: (data, _, jqXHR) => {
+      success: (data) => {
         this.setState({
           release: data,
         });
@@ -44,30 +53,26 @@ const VersionHoverCard = React.createClass({
       error: () => {
         this.setState({
           error: true,
-          loading: false,
         });
-      }
+      },
+      complete: done
     });
-    this.getRepos();
-  },
 
-  getRepos() {
-    let {orgId} = this.props;
-    let path = `/organizations/${orgId}/repos/`;
-    this.api.request(path, {
+    // repos
+    let repoPath = `/organizations/${orgId}/repos/`;
+    this.api.request(repoPath, {
       method: 'GET',
-      success: (data, _, jqXHR) => {
+      success: (data) => {
         this.setState({
           hasRepos: data.length > 0,
-          loading:false,
         });
       },
       error: () => {
         this.setState({
           error: true,
-          loading: false,
         });
-      }
+      },
+      complete: done
     });
   },
 
