commit afed236ad257ae30614456b0ac1762f12735e8b5
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Nov 7 10:37:58 2018 -0800

    feat: Add python helper for formatting bytes

diff --git a/src/sentry/utils/numbers.py b/src/sentry/utils/numbers.py
index 710f8bacd7..ab38b40f21 100644
--- a/src/sentry/utils/numbers.py
+++ b/src/sentry/utils/numbers.py
@@ -62,3 +62,19 @@ def base36_encode(number):
 
 def base36_decode(s):
     return int(s, 36)
+
+
+DEFAULT_UNITS = ('B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB')
+
+
+def format_bytes(number, units=DEFAULT_UNITS, decimal_places=2):
+    block = 1024.0
+    if number < block:
+        return '{} {}'.format(number, units[0])
+
+    u = 0
+    max_unit = len(units) - 1
+    while number >= block and u < max_unit:
+        number /= block
+        u += 1
+    return (u'{:.%df} {}' % (decimal_places,)).format(number, units[u])
diff --git a/tests/sentry/utils/test_numbers.py b/tests/sentry/utils/test_numbers.py
index e194e3fef6..19532b0aab 100644
--- a/tests/sentry/utils/test_numbers.py
+++ b/tests/sentry/utils/test_numbers.py
@@ -1,7 +1,7 @@
 from __future__ import absolute_import
 
 from sentry.utils.numbers import base36_encode, base36_decode, \
-    base32_encode, base32_decode
+    base32_encode, base32_decode, format_bytes
 
 
 def test_base36():
@@ -34,3 +34,15 @@ def test_base32():
     ]
 
     assert [base32_decode(base32_encode(x)) for x in range(128)] == list(map(int, range(128)))
+
+
+def test_format_bytes():
+    assert format_bytes(50) == '50 B'
+    assert format_bytes(1024) == '1.00 KB'
+    assert format_bytes(3000) == '2.93 KB'
+    assert format_bytes(30000) == '29.30 KB'
+    assert format_bytes(3000000) == '2.86 MB'
+    assert format_bytes(3000000000) == '2.79 GB'
+    assert format_bytes(3000000000000) == '2.73 TB'
+
+    assert format_bytes(3000000000000, units=['B', 'KB', 'MB', 'GB']) == '2793.97 GB'
