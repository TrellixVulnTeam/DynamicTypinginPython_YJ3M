commit 2678f178be23f9815f67026d8d7b70b2688b4300
Author: Markus Unterwaditzer <markus@unterwaditzer.net>
Date:   Thu Jan 24 12:08:12 2019 +0100

    fix: More instances where we have to skip over nulls (#11682)

diff --git a/src/sentry/interfaces/http.py b/src/sentry/interfaces/http.py
index 8bf990ce0f..c16dd672a0 100644
--- a/src/sentry/interfaces/http.py
+++ b/src/sentry/interfaces/http.py
@@ -22,7 +22,7 @@ from sentry.interfaces.base import Interface, InterfaceValidationError, prune_em
 from sentry.interfaces.schemas import validate_and_default_interface
 from sentry.utils import json
 from sentry.utils.strings import to_unicode
-from sentry.utils.safe import trim, trim_dict, trim_pairs
+from sentry.utils.safe import trim, trim_dict, trim_pairs, get_path
 from sentry.utils.http import heuristic_decode
 from sentry.utils.validators import validate_ip
 from sentry.web.helpers import render_to_string
@@ -184,9 +184,8 @@ class Http(Interface):
         cookies = data.get('cookies')
         # if cookies were [also] included in headers we
         # strip them out
-        headers = data.get('headers')
-        if headers:
-            headers, cookie_header = format_headers(headers)
+        if data.get("headers"):
+            headers, cookie_header = format_headers(get_path(data, "headers", filter=True))
             if not cookies and cookie_header:
                 cookies = cookie_header
         else:
diff --git a/src/sentry/models/event.py b/src/sentry/models/event.py
index c7365b9908..d1d6ebb2ec 100644
--- a/src/sentry/models/event.py
+++ b/src/sentry/models/event.py
@@ -216,7 +216,7 @@ class Event(Model):
     tags = property(get_tags)
 
     def get_tag(self, key):
-        for t, v in (self.data.get('tags') or ()):
+        for t, v in self.get_tags():
             if t == key:
                 return v
         return None
