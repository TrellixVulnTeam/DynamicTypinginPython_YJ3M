commit eb3fef4cdc1445d4275832803f5f57c6c67b4521
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Aug 4 15:19:58 2016 -0700

    Add generate_reset_password_link

diff --git a/src/sentry/management/commands/generate_reset_password_link.py b/src/sentry/management/commands/generate_reset_password_link.py
new file mode 100644
index 0000000000..89e8f218ab
--- /dev/null
+++ b/src/sentry/management/commands/generate_reset_password_link.py
@@ -0,0 +1,39 @@
+
+from __future__ import absolute_import, print_function
+
+import sys
+
+from django.core.management.base import BaseCommand, make_option
+from django.utils import timezone
+
+from sentry.models import LostPasswordHash
+from sentry.utils.auth import find_users
+
+
+class Command(BaseCommand):
+    help = 'Generate a link for a user to reset their password'
+
+    option_list = BaseCommand.option_list + (
+        make_option('--noinput', dest='noinput', action='store_true', default=False,
+                    help='Dont ask for confirmation before merging accounts.'),
+    )
+
+    def handle(self, username, **options):
+        users = find_users(username, with_valid_password=False)
+        if not users:
+            sys.stdout.write("No account found with given username.\n")
+            return
+
+        for user in users:
+            password_hash, created = LostPasswordHash.objects.get_or_create(
+                user=user,
+            )
+            if not password_hash.is_valid():
+                password_hash.date_added = timezone.now()
+                password_hash.set_hash()
+                password_hash.save()
+            print('{} ({}) - {}'.format(
+                user.username,
+                user.email,
+                password_hash.get_absolute_url(),
+            ))
