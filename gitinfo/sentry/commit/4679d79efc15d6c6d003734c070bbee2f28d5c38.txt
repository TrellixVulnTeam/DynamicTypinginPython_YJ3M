commit 4679d79efc15d6c6d003734c070bbee2f28d5c38
Author: David Cramer <dcramer@gmail.com>
Date:   Tue May 20 01:15:18 2014 -0700

    Use iterator on queryset deletion

diff --git a/src/sentry/tasks/cleanup.py b/src/sentry/tasks/cleanup.py
index a32999ae14..68a4005e5f 100644
--- a/src/sentry/tasks/cleanup.py
+++ b/src/sentry/tasks/cleanup.py
@@ -77,13 +77,13 @@ def cleanup(days=30, project=None, chunk_size=1000, concurrency=1, **kwargs):
             log.info("Removing %s chunk %d", model.__name__, count)
             if concurrency > 1:
                 worker_pool = ThreadPool(workers=concurrency)
-                for obj in list(qs[:chunk_size]):
+                for obj in qs[:chunk_size].iterator():
                     worker_pool.add(obj.id, delete_object, [obj])
                     count += 1
                 worker_pool.join()
                 del worker_pool
             else:
-                for obj in list(qs[:chunk_size]):
+                for obj in qs[:chunk_size].iterator():
                     delete_object(obj)
 
     # EventMapping is fairly expensive and is special cased as it's likely you
