commit 18689c41020fd3fa960578d09a7fb2637821564f
Author: Megan Heskett <meg.heskett@gmail.com>
Date:   Wed Oct 24 09:47:42 2018 -0700

    fix(ui): Add logout to Create a New Organization prompt (#10214)

diff --git a/src/sentry/static/sentry/app/components/narrowLayout.jsx b/src/sentry/static/sentry/app/components/narrowLayout.jsx
index 0c632571db..f09ced8b4f 100644
--- a/src/sentry/static/sentry/app/components/narrowLayout.jsx
+++ b/src/sentry/static/sentry/app/components/narrowLayout.jsx
@@ -1,15 +1,35 @@
 import jQuery from 'jquery';
 import React from 'react';
+import PropTypes from 'prop-types';
+
+import {t} from 'app/locale';
+import {Client} from 'app/api';
+import styled from 'react-emotion';
 
 class NarrowLayout extends React.Component {
+  static propTypes = {
+    showLogout: PropTypes.bool,
+  };
+
   componentWillMount() {
+    this.api = new Client();
     jQuery(document.body).addClass('narrow');
   }
 
   componentWillUnmount() {
+    this.api.clear();
     jQuery(document.body).removeClass('narrow');
   }
 
+  handleLogout = () => {
+    this.api.request('/auth/', {
+      method: 'DELETE',
+      success: () => {
+        window.location = '/auth/login';
+      },
+    });
+  };
+
   render() {
     return (
       <div className="app">
@@ -20,6 +40,11 @@ class NarrowLayout extends React.Component {
               <a href="/">
                 <span className="icon-sentry-logo" />
               </a>
+              {this.props.showLogout && (
+                <a className="logout pull-right" onClick={this.handleLogout}>
+                  <Logout>{t('Sign out')}</Logout>
+                </a>
+              )}
             </div>
             <div className="box-content with-padding">{this.props.children}</div>
           </div>
@@ -29,4 +54,8 @@ class NarrowLayout extends React.Component {
   }
 }
 
+const Logout = styled.span`
+  font-size: 16px;
+`;
+
 export default NarrowLayout;
diff --git a/src/sentry/static/sentry/app/views/organizationCreate.jsx b/src/sentry/static/sentry/app/views/organizationCreate.jsx
index 3682fd7d0c..73955083ac 100644
--- a/src/sentry/static/sentry/app/views/organizationCreate.jsx
+++ b/src/sentry/static/sentry/app/views/organizationCreate.jsx
@@ -26,7 +26,7 @@ export default class OrganizationCreate extends AsyncView {
     let privacyUrl = ConfigStore.get('privacyUrl');
 
     return (
-      <NarrowLayout>
+      <NarrowLayout showLogout>
         <h3>{t('Create a New Organization')}</h3>
 
         <p>
diff --git a/tests/js/spec/components/narrowLayout.spec.jsx b/tests/js/spec/components/narrowLayout.spec.jsx
new file mode 100644
index 0000000000..62389fc359
--- /dev/null
+++ b/tests/js/spec/components/narrowLayout.spec.jsx
@@ -0,0 +1,26 @@
+import React from 'react';
+import {mount} from 'enzyme';
+
+import NarrowLayout from 'app/components/narrowLayout';
+
+describe('NarrowLayout', function() {
+  it('renders without logout', function() {
+    let wrapper = mount(<NarrowLayout />);
+    expect(wrapper.find('a.logout')).toHaveLength(0);
+  });
+  it('renders with logout', function() {
+    let wrapper = mount(<NarrowLayout showLogout />);
+    expect(wrapper.find('a.logout')).toHaveLength(1);
+  });
+  it('can logout', function() {
+    let mock = MockApiClient.addMockResponse({
+      url: '/auth/',
+      method: 'DELETE',
+      status: 204,
+    });
+    let wrapper = mount(<NarrowLayout showLogout />);
+
+    wrapper.find('a.logout').simulate('click');
+    expect(mock).toHaveBeenCalled();
+  });
+});
diff --git a/tests/js/spec/views/__snapshots__/organizationCreate.spec.jsx.snap b/tests/js/spec/views/__snapshots__/organizationCreate.spec.jsx.snap
index 4f02085a0f..65eddefc11 100644
--- a/tests/js/spec/views/__snapshots__/organizationCreate.spec.jsx.snap
+++ b/tests/js/spec/views/__snapshots__/organizationCreate.spec.jsx.snap
@@ -4,7 +4,9 @@ exports[`OrganizationCreate render() renders with terms 1`] = `
 <SideEffect(DocumentTitle)
   title="Create Organization - Sentry"
 >
-  <NarrowLayout>
+  <NarrowLayout
+    showLogout={true}
+  >
     <h3>
       Create a New Organization
     </h3>
@@ -80,7 +82,9 @@ exports[`OrganizationCreate render() renders without terms 1`] = `
 <SideEffect(DocumentTitle)
   title="Create Organization - Sentry"
 >
-  <NarrowLayout>
+  <NarrowLayout
+    showLogout={true}
+  >
     <h3>
       Create a New Organization
     </h3>
