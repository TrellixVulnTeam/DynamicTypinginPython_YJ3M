commit 8aa7af46a3b9589d60cea2054e5f73844d5be1d7
Author: Dena Mwangi <dena@getsentry.com>
Date:   Mon Apr 22 10:15:54 2019 -0700

    feat(broadcasts): Use new url (#12848)

diff --git a/src/sentry/api/urls.py b/src/sentry/api/urls.py
index 8b090e4394..265ff86e7c 100644
--- a/src/sentry/api/urls.py
+++ b/src/sentry/api/urls.py
@@ -793,6 +793,11 @@ urlpatterns = patterns(
         OrganizationEnvironmentsEndpoint.as_view(),
         name='sentry-api-0-organization-environments',
     ),
+    url(
+        r'^organizations/(?P<organization_slug>[^\/]+)/broadcasts/$',
+        BroadcastIndexEndpoint.as_view(),
+        name='sentry-api-0-organization-broadcasts'
+    ),
 
     # Teams
     url(
diff --git a/src/sentry/static/sentry/app/actionCreators/broadcasts.jsx b/src/sentry/static/sentry/app/actionCreators/broadcasts.jsx
index beb51e36a1..92b94eddbd 100644
--- a/src/sentry/static/sentry/app/actionCreators/broadcasts.jsx
+++ b/src/sentry/static/sentry/app/actionCreators/broadcasts.jsx
@@ -1,5 +1,5 @@
-export function getAllBroadcasts(api) {
-  return api.requestPromise('/broadcasts/', {method: 'GET'});
+export function getAllBroadcasts(api, orgSlug) {
+  return api.requestPromise(`/organizations/${orgSlug}/broadcasts/`, {method: 'GET'});
 }
 
 export function markBroadcastsAsSeen(api, idList) {
diff --git a/src/sentry/static/sentry/app/components/sidebar/broadcasts.jsx b/src/sentry/static/sentry/app/components/sidebar/broadcasts.jsx
index f616f2903a..652a0af18e 100644
--- a/src/sentry/static/sentry/app/components/sidebar/broadcasts.jsx
+++ b/src/sentry/static/sentry/app/components/sidebar/broadcasts.jsx
@@ -5,6 +5,7 @@ import {getAllBroadcasts, markBroadcastsAsSeen} from 'app/actionCreators/broadca
 import {t} from 'app/locale';
 import InlineSvg from 'app/components/inlineSvg';
 import LoadingIndicator from 'app/components/loadingIndicator';
+import SentryTypes from 'app/sentryTypes';
 import SidebarItem from 'app/components/sidebar/sidebarItem';
 import SidebarPanel from 'app/components/sidebar/sidebarPanel';
 import SidebarPanelEmpty from 'app/components/sidebar/sidebarPanelEmpty';
@@ -23,6 +24,7 @@ class Broadcasts extends React.Component {
     hidePanel: PropTypes.func,
     onShowPanel: PropTypes.func.isRequired,
     api: PropTypes.object.isRequired,
+    organization: SentryTypes.Organization.isRequired,
   };
 
   state = {
@@ -67,7 +69,7 @@ class Broadcasts extends React.Component {
       this.stopPoll();
     }
 
-    return getAllBroadcasts(this.props.api)
+    return getAllBroadcasts(this.props.api, this.props.organization.slug)
       .then(data => {
         this.setState({
           broadcasts: data || [],
diff --git a/src/sentry/static/sentry/app/components/sidebar/index.jsx b/src/sentry/static/sentry/app/components/sidebar/index.jsx
index e6b8779617..ceb7187757 100644
--- a/src/sentry/static/sentry/app/components/sidebar/index.jsx
+++ b/src/sentry/static/sentry/app/components/sidebar/index.jsx
@@ -474,6 +474,7 @@ class Sidebar extends React.Component {
                 currentPanel={currentPanel}
                 onShowPanel={() => this.togglePanel('broadcasts')}
                 hidePanel={this.hidePanel}
+                organization={organization}
               />
               <Incidents
                 orientation={orientation}
diff --git a/tests/js/spec/components/sidebar/index.spec.jsx b/tests/js/spec/components/sidebar/index.spec.jsx
index e80dca31cc..7711cdfe02 100644
--- a/tests/js/spec/components/sidebar/index.spec.jsx
+++ b/tests/js/spec/components/sidebar/index.spec.jsx
@@ -26,7 +26,7 @@ describe('Sidebar', function() {
 
   beforeEach(function() {
     apiMocks.broadcasts = MockApiClient.addMockResponse({
-      url: '/broadcasts/',
+      url: `/organizations/${organization.slug}/broadcasts/`,
       body: [TestStubs.Broadcast()],
     });
     apiMocks.broadcastsMarkAsSeen = MockApiClient.addMockResponse({
@@ -175,7 +175,7 @@ describe('Sidebar', function() {
   describe('SidebarPanel', function() {
     it('displays empty panel when there are no Broadcasts', async function() {
       MockApiClient.addMockResponse({
-        url: '/broadcasts/',
+        url: `/organizations/${organization.slug}/broadcasts/`,
         body: [],
       });
       wrapper = createWrapper();
