commit 32dc56b5702ce86e34b102e69eb2d30402b14608
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Apr 16 10:21:21 2015 -0700

    Correct location of tokens

diff --git a/src/sentry/auth/providers/oauth2.py b/src/sentry/auth/providers/oauth2.py
index c5ab173238..16e5574b45 100644
--- a/src/sentry/auth/providers/oauth2.py
+++ b/src/sentry/auth/providers/oauth2.py
@@ -174,8 +174,7 @@ class OAuth2Provider(Provider):
         raise NotImplementedError
 
     def refresh_identity(self, auth_identity):
-        data = auth_identity.data.get('data', {})
-        refresh_token = data.get('refresh_token')
+        refresh_token = auth_identity.data.get('refresh_token')
 
         if not refresh_token:
             raise IdentityNotValid('Missing refresh token')
diff --git a/tests/sentry/auth/providers/test_oauth2.py b/tests/sentry/auth/providers/test_oauth2.py
index bee8c84386..ece182cb99 100644
--- a/tests/sentry/auth/providers/test_oauth2.py
+++ b/tests/sentry/auth/providers/test_oauth2.py
@@ -29,7 +29,7 @@ class OAuth2ProviderTest(TestCase):
             auth_provider=self.auth_provider,
             user=self.user,
             data={
-                'data': {'access_token': 'access_token'},
+                'access_token': 'access_token',
             }
         )
 
