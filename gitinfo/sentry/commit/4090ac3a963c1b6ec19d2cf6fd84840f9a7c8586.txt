commit 4090ac3a963c1b6ec19d2cf6fd84840f9a7c8586
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Oct 20 09:10:21 2014 +0200

    Migrate team projects view

diff --git a/src/sentry/web/frontend/team_projects.py b/src/sentry/web/frontend/team_projects.py
new file mode 100644
index 0000000000..bcc9f1d536
--- /dev/null
+++ b/src/sentry/web/frontend/team_projects.py
@@ -0,0 +1,20 @@
+from __future__ import absolute_import
+
+from sentry.models import TeamMemberType
+from sentry.web.frontend.base import TeamView
+
+
+class TeamProjectsView(TeamView):
+    required_access = TeamMemberType.MEMBER
+
+    def get(self, request, organization, team):
+        project_list = team.project_set.all()
+        project_list = sorted(project_list, key=lambda o: o.slug)
+        for project in project_list:
+            project.team = team
+
+        context = {
+            'project_list': project_list,
+        }
+
+        return self.respond('sentry/teams/projects/index.html', context)
diff --git a/src/sentry/web/frontend/teams.py b/src/sentry/web/frontend/teams.py
index f42b5f2d24..b3dfbf3e5a 100644
--- a/src/sentry/web/frontend/teams.py
+++ b/src/sentry/web/frontend/teams.py
@@ -14,7 +14,7 @@ from django.http import HttpResponseRedirect
 from django.views.decorators.csrf import csrf_protect
 from django.utils.translation import ugettext as _
 
-from sentry.constants import MEMBER_USER, MEMBER_OWNER, STATUS_VISIBLE
+from sentry.constants import MEMBER_USER, MEMBER_OWNER
 from sentry.models import PendingTeamMember, TeamMember, AccessGroup, User
 from sentry.permissions import (
     can_add_team_member, can_create_projects,
@@ -41,52 +41,6 @@ def render_with_team_context(team, template, context, request=None):
     return render_to_response(template, context, request)
 
 
-@has_access(MEMBER_OWNER)
-@csrf_protect
-def manage_team_projects(request, team):
-    result = plugins.first('has_perm', request.user, 'edit_team', team)
-    if result is False and not request.user.is_superuser:
-        return HttpResponseRedirect(reverse('sentry'))
-
-    project_list = team.project_set.all()
-    if not request.user.is_superuser:
-        project_list = project_list.filter(status=STATUS_VISIBLE)
-    project_list = sorted(project_list, key=lambda o: o.slug)
-    for project in project_list:
-        project.team = team
-
-    context = csrf(request)
-    context.update({
-        'page': 'projects',
-        'team': team,
-        'project_list': project_list,
-        'SUBSECTION': 'projects',
-    })
-
-    return render_with_team_context(team, 'sentry/teams/projects/index.html', context, request)
-
-
-@has_access(MEMBER_OWNER)
-@csrf_protect
-def manage_team_members(request, team):
-    result = plugins.first('has_perm', request.user, 'edit_team', team)
-    if result is False and not request.user.is_superuser:
-        return HttpResponseRedirect(reverse('sentry'))
-
-    member_list = [(pm, pm.user) for pm in team.member_set.select_related('user').order_by('user__username')]
-    pending_member_list = [(pm, pm.email) for pm in team.pending_member_set.all().order_by('email')]
-
-    context = csrf(request)
-    context.update({
-        'page': 'members',
-        'member_list': member_list,
-        'pending_member_list': pending_member_list,
-        'SUBSECTION': 'members',
-    })
-
-    return render_with_team_context(team, 'sentry/teams/members/index.html', context, request)
-
-
 @csrf_protect
 @has_access(MEMBER_OWNER)
 def new_team_member(request, team):
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index 971a0e0edb..bd77ca1ff6 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -42,6 +42,7 @@ from sentry.web.frontend.organization_teams import OrganizationTeamsView
 from sentry.web.frontend.create_team import CreateTeamView
 from sentry.web.frontend.remove_team import RemoveTeamView
 from sentry.web.frontend.team_members import TeamMembersView
+from sentry.web.frontend.team_projects import TeamProjectsView
 from sentry.web.frontend.team_settings import TeamSettingsView
 
 
@@ -155,7 +156,7 @@ urlpatterns += patterns('',
         name='sentry-remove-pending-team-member'),
     url(r'^account/teams/(?P<team_slug>[\w_-]+)/members/pending/(?P<member_id>\d+)/reinvite/$', teams.reinvite_pending_team_member,
         name='sentry-reinvite-pending-team-member'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/projects/$', teams.manage_team_projects,
+    url(r'^account/teams/(?P<team_slug>[\w_-]+)/projects/$', TeamProjectsView.as_view(),
         name='sentry-manage-team-projects'),
     url(r'^account/teams/(?P<team_slug>[\w_-]+)/projects/new/$', teams.create_new_team_project,
         name='sentry-new-project'),
