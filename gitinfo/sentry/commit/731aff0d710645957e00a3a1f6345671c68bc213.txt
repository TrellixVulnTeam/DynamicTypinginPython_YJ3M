commit 731aff0d710645957e00a3a1f6345671c68bc213
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Wed Aug 17 18:56:39 2016 -0700

    Stop trying to use system.url-prefix for url generation on the frontend
    
    In theory, this is a nice idea, but in practice at best, we're 100%
    inconsistent on usage here. Even within the same file, the usage is
    mismatched, which results in some urls being right and some being wrong.
    
    Let's just assume for now that we can't begin to operate on a subpath.
    There are too many manual urls being generated both in the app and in
    React that don't leverage url-prefix to even be close.

diff --git a/src/sentry/static/sentry/app/components/footer.jsx b/src/sentry/static/sentry/app/components/footer.jsx
index ae1414b434..a209c52ab6 100644
--- a/src/sentry/static/sentry/app/components/footer.jsx
+++ b/src/sentry/static/sentry/app/components/footer.jsx
@@ -22,11 +22,11 @@ const Footer = React.createClass({
       <footer>
         <div className="container">
           <div className="pull-right">
-            <a href={config.urlPrefix + '/api/'}>{t('API')}</a>
-            <a href={config.urlPrefix + '/docs/'}>{t('Docs')}</a>
+            <a href="/api/">{t('API')}</a>
+            <a href="/docs/">{t('Docs')}</a>
             <a href="https://github.com/getsentry/sentry" rel="noreferrer">{t('Contribute')}</a>
             {config.isOnPremise &&
-              <a href={config.urlPrefix + '/out/'}>{t('Migrate to SaaS')}</a>
+              <a href="/out/">{t('Migrate to SaaS')}</a>
             }
           </div>
           <div className="version pull-left">
diff --git a/src/sentry/static/sentry/app/components/header/organizationSelector.jsx b/src/sentry/static/sentry/app/components/header/organizationSelector.jsx
index 4a50a75aca..d67d6c7682 100644
--- a/src/sentry/static/sentry/app/components/header/organizationSelector.jsx
+++ b/src/sentry/static/sentry/app/components/header/organizationSelector.jsx
@@ -28,7 +28,6 @@ const OrganizationSelector = React.createClass({
       return null;
     }
 
-    let urlPrefix = ConfigStore.get('urlPrefix');
     let features = ConfigStore.get('features');
 
     return (
@@ -44,11 +43,11 @@ const OrganizationSelector = React.createClass({
             </MenuItem>
           );
         })}
-        {features.has('organizations:create') && OrganizationStore.getAll().length && 
+        {features.has('organizations:create') && OrganizationStore.getAll().length &&
           <MenuItem divider={true} />
         }
         {features.has('organizations:create') &&
-          <MenuItem href={urlPrefix + '/organizations/new/'}>{t('New Organization')}</MenuItem>
+          <MenuItem href="/organizations/new/">{t('New Organization')}</MenuItem>
         }
       </DropdownLink>
     );
diff --git a/src/sentry/static/sentry/app/components/header/userNav.jsx b/src/sentry/static/sentry/app/components/header/userNav.jsx
index 56dbcc407c..37d42dd2d9 100644
--- a/src/sentry/static/sentry/app/components/header/userNav.jsx
+++ b/src/sentry/static/sentry/app/components/header/userNav.jsx
@@ -11,7 +11,6 @@ const UserNav = React.createClass({
   },
 
   render() {
-    let urlPrefix = ConfigStore.get('urlPrefix');
     let user = ConfigStore.get('user');
 
     if (!user) {
@@ -28,12 +27,12 @@ const UserNav = React.createClass({
           topLevelClasses={this.props.className}
           menuClasses="dropdown-menu-right"
           title={title}>
-        <MenuItem href={urlPrefix + '/account/settings/'}>{t('Account')}</MenuItem>
+        <MenuItem href="/account/settings/">{t('Account')}</MenuItem>
         <MenuItem to="/api/">{t('API')}</MenuItem>
         {user.isSuperuser &&
           <MenuItem to="/manage/">{t('Admin')}</MenuItem>
         }
-        <MenuItem href={urlPrefix + '/auth/logout/'}>{t('Sign out')}</MenuItem>
+        <MenuItem href="/auth/logout/">{t('Sign out')}</MenuItem>
       </DropdownLink>
     );
   }
diff --git a/src/sentry/static/sentry/app/components/organizations/homeContainer.jsx b/src/sentry/static/sentry/app/components/organizations/homeContainer.jsx
index ff7331c2cb..ac87262821 100644
--- a/src/sentry/static/sentry/app/components/organizations/homeContainer.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/homeContainer.jsx
@@ -3,7 +3,6 @@ import OrganizationHomeSidebar from './homeSidebar';
 import OrganizationState from '../../mixins/organizationState';
 import ProjectSelector from '../projectHeader/projectSelector';
 import TooltipMixin from '../../mixins/tooltip';
-import ConfigStore from '../../stores/configStore';
 import {Link} from 'react-router';
 import {t} from '../../locale';
 
@@ -18,7 +17,6 @@ const HomeContainer = React.createClass({
   render() {
     let org = this.getOrganization();
     let access = this.getAccess();
-    let urlPrefix = ConfigStore.get('urlPrefix') + '/organizations/' + org.slug;
 
     return (
       <div className="organization-home">
@@ -26,7 +24,7 @@ const HomeContainer = React.createClass({
           <div className="container">
             <div className="pull-right">
               {access.has('project:write') ?
-                <a href={urlPrefix + '/projects/new/'} className="btn btn-primary"
+                <a href={`/organizations/${org.slug}/projects/new/`} className="btn btn-primary"
                    style={{marginRight: 5}}>
                   {t('New Project')}
                 </a>
@@ -38,7 +36,7 @@ const HomeContainer = React.createClass({
                 </a>
               }
               {access.has('team:write') ?
-                <a href={urlPrefix + '/teams/new/'} className="btn btn-primary">
+                <a href={`/organizations/${org.slug}/teams/new/`} className="btn btn-primary">
                   {t('New Team')}
                 </a>
               :
diff --git a/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx b/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx
index 0aa51ca716..b6d0eeeed8 100644
--- a/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/homeSidebar.jsx
@@ -1,7 +1,6 @@
 import React from 'react';
 import ListLink from '../listLink';
 import OrganizationState from '../../mixins/organizationState';
-import ConfigStore from '../../stores/configStore';
 import HookStore from '../../stores/hookStore';
 import {t} from '../../locale';
 
@@ -29,7 +28,6 @@ const HomeSidebar = React.createClass({
     let access = this.getAccess();
     let features = this.getFeatures();
     let org = this.getOrganization();
-    let urlPrefix = ConfigStore.get('urlPrefix') + '/organizations/' + org.slug;
 
     let orgId = org.slug;
     return (
@@ -62,7 +60,7 @@ const HomeSidebar = React.createClass({
             <ul className="nav nav-stacked">
               {access.has('org:read') &&
                 <li>
-                  <a href={urlPrefix + '/members/'}>
+                  <a href={`/organizations/${orgId}/members/`}>
                     {t('Members')}&nbsp;
                     {access.has('org:write') && org.pendingAccessRequests > 0 &&
                       <span className="badge" style={{marginLeft: 5}}>{org.pendingAccessRequests}</span>
@@ -71,10 +69,10 @@ const HomeSidebar = React.createClass({
                 </li>
               }
               {features.has('sso') && access.has('org:delete') &&
-                <li><a href={urlPrefix + '/auth/'}>{t('Auth')}</a></li>
+                <li><a href={`/organizations/${orgId}/auth/`}>{t('Auth')}</a></li>
               }
               {access.has('org:delete') && features.has('api-keys') &&
-                <li><a href={urlPrefix + '/api-keys/'}>{t('API Keys')}</a></li>
+                <li><a href={`/organizations/${orgId}/api-keys/`}>{t('API Keys')}</a></li>
               }
               {access.has('org:write') &&
                 <ListLink to={`/organizations/${orgId}/audit-log/`}>{t('Audit Log')}</ListLink>
@@ -83,7 +81,7 @@ const HomeSidebar = React.createClass({
                 <ListLink to={`/organizations/${orgId}/rate-limits/`}>{t('Rate Limits')}</ListLink>
               }
               {access.has('org:write') &&
-                <li><a href={urlPrefix + '/settings/'}>{t('Settings')}</a></li>
+                <li><a href={`/organizations/${orgId}/settings/`}>{t('Settings')}</a></li>
               }
             </ul>
           </div>
diff --git a/src/sentry/static/sentry/app/components/projectHeader/index.jsx b/src/sentry/static/sentry/app/components/projectHeader/index.jsx
index 0cd9190817..a5a36b55d9 100644
--- a/src/sentry/static/sentry/app/components/projectHeader/index.jsx
+++ b/src/sentry/static/sentry/app/components/projectHeader/index.jsx
@@ -1,6 +1,5 @@
 import React from 'react';
 import {Link} from 'react-router';
-import ConfigStore from '../../stores/configStore';
 
 import ProjectSelector from './projectSelector';
 import {t} from '../../locale';
@@ -14,7 +13,6 @@ const ProjectHeader = React.createClass({
 
   render() {
     let navSection = this.props.activeSection;
-    let urlPrefix = ConfigStore.get('urlPrefix');
     let project = this.props.project;
     let org = this.props.organization;
     let features = new Set(project.features);
@@ -55,7 +53,7 @@ const ProjectHeader = React.createClass({
                 </li>
                 {access.has('project:write') &&
                   <li className={navSection == 'settings' ? 'active' : ''}>
-                    <a href={urlPrefix + `/${org.slug}/${project.slug}/settings/`}>
+                    <a href={`/${org.slug}/${project.slug}/settings/`}>
                       {t('Settings')}
                     </a>
                   </li>
diff --git a/src/sentry/static/sentry/app/components/projectHeader/projectSelector.jsx b/src/sentry/static/sentry/app/components/projectHeader/projectSelector.jsx
index 907f01e4a0..69fd945073 100644
--- a/src/sentry/static/sentry/app/components/projectHeader/projectSelector.jsx
+++ b/src/sentry/static/sentry/app/components/projectHeader/projectSelector.jsx
@@ -4,7 +4,6 @@ import {History} from 'react-router';
 import {Link} from 'react-router';
 import jQuery from 'jquery';
 
-import ConfigStore from '../../stores/configStore';
 import {update as projectUpdate} from '../../actionCreators/projects';
 import ApiMixin from '../../mixins/apiMixin';
 
@@ -188,7 +187,7 @@ const ProjectSelector = React.createClass({
     if (this.context.location) {
       return {to: path};
     } else {
-      return {href: ConfigStore.get('urlPrefix') + path};
+      return {href: path};
     }
   },
 
diff --git a/src/sentry/static/sentry/app/views/admin/index.jsx b/src/sentry/static/sentry/app/views/admin/index.jsx
index c016761a45..6af61fee5f 100644
--- a/src/sentry/static/sentry/app/views/admin/index.jsx
+++ b/src/sentry/static/sentry/app/views/admin/index.jsx
@@ -2,7 +2,6 @@
 import DocumentTitle from 'react-document-title';
 import React from 'react';
 
-import ConfigStore from '../../stores/configStore';
 import Footer from '../../components/footer';
 import Header from '../../components/header';
 import HookStore from '../../stores/hookStore';
@@ -26,8 +25,6 @@ const Admin = React.createClass({
   },
 
   render() {
-    let urlPrefix = ConfigStore.get('urlPrefix');
-
     return (
       <DocumentTitle title={this.getTitle()}>
         <div className="app">
@@ -40,12 +37,12 @@ const Admin = React.createClass({
                   <ul className="nav nav-stacked">
                     <ListLink index={true} to="/manage/">Overview</ListLink>
                     <ListLink index={true} to="/manage/buffer/">Buffer</ListLink>
-                    <li><a href={`${urlPrefix}/manage/queue/`}>Queue</a></li>
-                    <li><a href={`${urlPrefix}/manage/status/environment/`}>Environment</a></li>
-                    <li><a href={`${urlPrefix}/manage/status/packages/`}>Packages</a></li>
-                    <li><a href={`${urlPrefix}/manage/status/mail/`}>Mail</a></li>
+                    <li><a href="/manage/queue/">Queue</a></li>
+                    <li><a href="/manage/status/environment/">Environment</a></li>
+                    <li><a href="/manage/status/packages/">Packages</a></li>
+                    <li><a href="/manage/status/mail/">Mail</a></li>
                     <ListLink to="/manage/settings/">Settings</ListLink>
-                    <li><a href={`${urlPrefix}/manage/status/warnings/`}>Warnings</a></li>
+                    <li><a href="/manage/status/warnings/">Warnings</a></li>
                   </ul>
 
                   <h6 className="nav-header">Manage</h6>
diff --git a/src/sentry/static/sentry/app/views/organizationTeams/allTeamsList.jsx b/src/sentry/static/sentry/app/views/organizationTeams/allTeamsList.jsx
index 1be34e4f78..ea6849fa9d 100644
--- a/src/sentry/static/sentry/app/views/organizationTeams/allTeamsList.jsx
+++ b/src/sentry/static/sentry/app/views/organizationTeams/allTeamsList.jsx
@@ -1,6 +1,5 @@
 import React from 'react';
 
-import ConfigStore from '../../stores/configStore';
 import PropTypes from '../../proptypes';
 
 import AllTeamsRow from './allTeamsRow';
@@ -39,10 +38,9 @@ const AllTeamsList = React.createClass({
       );
     }
 
-    let urlPrefix = `${ConfigStore.get('urlPrefix')}/organizations/${organization.slug}`;
     return tct('You don\'t have any teams for this organization yet. Get started by [link:creating your first team].', {
       root: <p />,
-      link: <a href={`${urlPrefix}/teams/new/`} />
+      link: <a href={`/organizations/${organization.slug}/teams/new/`} />
     });
   }
 });
diff --git a/src/sentry/static/sentry/app/views/organizationTeams/expandedTeamList.jsx b/src/sentry/static/sentry/app/views/organizationTeams/expandedTeamList.jsx
index af75c10740..3c1bb7e664 100644
--- a/src/sentry/static/sentry/app/views/organizationTeams/expandedTeamList.jsx
+++ b/src/sentry/static/sentry/app/views/organizationTeams/expandedTeamList.jsx
@@ -6,7 +6,6 @@ import ApiMixin from '../../mixins/apiMixin';
 import {update as projectUpdate} from '../../actionCreators/projects';
 import BarChart from '../../components/barChart';
 import ProjectLabel from '../../components/projectLabel';
-import ConfigStore from '../../stores/configStore';
 import PropTypes from '../../proptypes';
 import TooltipMixin from '../../mixins/tooltip';
 import {sortArray} from '../../utils';
@@ -44,7 +43,7 @@ const ExpandedTeamList = React.createClass({
 
   urlPrefix() {
     let org = this.props.organization;
-    return ConfigStore.get('urlPrefix') + '/organizations/' + org.slug;
+    return `/organizations/${org.slug}`;
   },
 
   renderProjectList(team) {
diff --git a/src/sentry/static/sentry/app/views/projectSettings/index.jsx b/src/sentry/static/sentry/app/views/projectSettings/index.jsx
index f46e41fb4e..975cb2d8b7 100644
--- a/src/sentry/static/sentry/app/views/projectSettings/index.jsx
+++ b/src/sentry/static/sentry/app/views/projectSettings/index.jsx
@@ -1,7 +1,6 @@
 import React from 'react';
 
 import ApiMixin from '../../mixins/apiMixin';
-import ConfigStore from '../../stores/configStore';
 import ListLink from '../../components/listLink';
 import LoadingError from '../../components/loadingError';
 import LoadingIndicator from '../../components/loadingIndicator';
@@ -72,9 +71,8 @@ const ProjectSettings = React.createClass({
     else if (this.state.error)
       return <LoadingError onRetry={this.fetchData} />;
 
-    let urlPrefix = ConfigStore.get('urlPrefix');
     let {orgId, projectId} = this.props.params;
-    let settingsUrlRoot = `${urlPrefix}/${orgId}/${projectId}/settings`;
+    let settingsUrlRoot = `/${orgId}/${projectId}/settings`;
     let project = this.state.project;
     let features = new Set(project.features);
     let rootInstallPath = `/${orgId}/${projectId}/settings/install/`;
