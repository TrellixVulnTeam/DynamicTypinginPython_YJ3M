commit 65b6dbdad7bb2f1f66b2f808d55aae768091f444
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jan 3 17:52:23 2011 -0800

    Ensure we grab all possible modules

diff --git a/sentry/helpers.py b/sentry/helpers.py
index fcc4ffce04..692fc0373c 100644
--- a/sentry/helpers.py
+++ b/sentry/helpers.py
@@ -179,11 +179,16 @@ def urlread(url, get={}, post={}, headers={}, timeout=None):
 def get_versions(module_list=None):
     if not module_list:
         module_list = settings.INSTALLED_APPS + ['django']
+
+    ext_module_list = set()
+    for m in module_list:
+        parts = m.split('.')
+        ext_module_list.update('.'.join(parts[:idx]) for idx in xrange(1, len(parts)+1))
+
     versions = {}
-    for app in module_list:
-        name = app.split('.')[-1].replace('_', ' ').capitalize()
-        __import__(app)
-        app = sys.modules[app]
+    for module_name in ext_module_list:
+        __import__(module_name)
+        app = sys.modules[module_name]
         if hasattr(app, 'get_version'):
             get_version = app.get_version
             if callable(get_version):
@@ -198,5 +203,5 @@ def get_versions(module_list=None):
             continue
         if isinstance(version, (list, tuple)):
             version = '.'.join(str(o) for o in version)
-        versions[name] = version
+        versions[module_name] = version
     return versions
\ No newline at end of file
diff --git a/sentry/tests/tests.py b/sentry/tests/tests.py
index 1f3b4bcd49..21e4864f21 100644
--- a/sentry/tests/tests.py
+++ b/sentry/tests/tests.py
@@ -619,7 +619,7 @@ class SentryTestCase(TestCase):
         self.assertEquals(Message.objects.count(), 1)
         self.assertEquals(GroupedMessage.objects.count(), 1)
         last = Message.objects.get()
-        self.assertEquals(last.data['__sentry__']['versions']['Sentry'], sentry.VERSION)
+        self.assertEquals(last.data['__sentry__']['versions']['sentry'], sentry.VERSION, last.data['__sentry__']['versions'])
 
 class SentryViewsTest(TestCase):
     urls = 'sentry.tests.urls'
@@ -930,7 +930,9 @@ class SentryHelpersTest(TestCase):
         import sentry
         from sentry.helpers import get_versions
         versions = get_versions(['sentry'])
-        self.assertEquals(versions['Sentry'], sentry.VERSION)
+        self.assertEquals(versions.get('sentry'), sentry.VERSION)
+        versions = get_versions(['sentry.client'])
+        self.assertEquals(versions.get('sentry'), sentry.VERSION)
 
 class SentryClientTest(TestCase):
     urls = 'sentry.tests.urls'
