commit 7c3ee7fe5d5652310ac401841ac9f3077682b4db
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Tue Jan 5 15:18:11 2016 -0800

    Fix cases where middleware didn't fully run

diff --git a/src/sentry/middleware/locale.py b/src/sentry/middleware/locale.py
index 13d4e9edb3..8a69899f91 100644
--- a/src/sentry/middleware/locale.py
+++ b/src/sentry/middleware/locale.py
@@ -49,6 +49,11 @@ class SentryLocaleMiddleware(LocaleMiddleware):
         # If static bound, we don't want to run the normal process_response since this
         # adds an extra `Vary: Accept-Language`. Static files don't need this and is
         # less effective for caching.
-        if self.__is_static:
-            return response
+        try:
+            if self.__is_static:
+                return response
+        except AttributeError:
+            # catch ourselves in case __is_static never got set.
+            # It's possible that process_request never ran.
+            pass
         return super(SentryLocaleMiddleware, self).process_response(request, response)
diff --git a/src/sentry/web/frontend/error_500.py b/src/sentry/web/frontend/error_500.py
index c20753fefb..9c7f6581a5 100644
--- a/src/sentry/web/frontend/error_500.py
+++ b/src/sentry/web/frontend/error_500.py
@@ -29,7 +29,7 @@ class Error500View(View):
             'dsn': projectkey.dsn_public,
             'eventId': request.sentry['id'],
         }
-        if request.user.is_authenticated():
+        if hasattr(request, 'user') and request.user.is_authenticated():
             try:
                 result.update({
                     'userName': request.user.name,
