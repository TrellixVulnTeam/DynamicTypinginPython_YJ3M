commit 8ec4a935b5d370852dfd05181370da94abb80596
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Fri Apr 14 09:41:11 2017 -0700

    Improved upload script

diff --git a/src/sentry/api/endpoints/project_processingissues.py b/src/sentry/api/endpoints/project_processingissues.py
index f7d98efe2f..de0cf94e76 100644
--- a/src/sentry/api/endpoints/project_processingissues.py
+++ b/src/sentry/api/endpoints/project_processingissues.py
@@ -18,9 +18,12 @@ class ProjectProcessingIssuesFixEndpoint(ProjectEndpoint):
             user=request.user
         ).all() if 'project:releases' in x.get_scopes()]
         resp = render_to_response('sentry/reprocessing-script.sh', {
-            'issues': ProcessingIssue.objects.filter(
+            'issues': [{
+                'uuid': issue.data.get('image_uuid'),
+                'name': (issue.data.get('image_path') or '').split('/')[-1]
+            } for issue in ProcessingIssue.objects.filter(
                 project=project
-            ).all(),
+            )],
             'project': project,
             'token': tokens and tokens[0] or None,
             'server_url': absolute_uri('/'),
diff --git a/src/sentry/templates/sentry/reprocessing-script.sh b/src/sentry/templates/sentry/reprocessing-script.sh
index c1ef6b8e06..eb5be87ac2 100644
--- a/src/sentry/templates/sentry/reprocessing-script.sh
+++ b/src/sentry/templates/sentry/reprocessing-script.sh
@@ -1,31 +1,35 @@
 {% autoescape off %}#!/bin/sh
 set -eu
 
-DOWNLOAD_URL="https://github.com/getsentry/sentry-cli/releases/download/1.5.0/sentry-cli-Darwin-x86_64"
+{% if issues %}
+echo "There are currently {{ issues|length }} missing debug symbols:"
+{% for issue in issues %}
+  echo "   - {{ issue.uuid }}  [{{ issue.name }}]"
+{% endfor %}
 
-if hash sentry-cli 2> /dev/null; then
-  CLI=sentry-cli
-else
-  if ! hash curl 2> /dev/null; then
-    echo "error: you do not have 'curl' installed which is required for this script."
-    exit 1
-  fi
-  TEMP_FILE=`mktemp "${TMPDIR:-/tmp}/.sentrycli.XXXXXXXX"`
-  cleanup() {
-    rm -f "$TEMP_FILE"
-  }
-  trap cleanup EXIT
-  echo "🔗  Downloading sentry-cli to upload"
-  curl -SL --progress-bar "$DOWNLOAD_URL" > "$TEMP_FILE"
-  chmod +x "$TEMP_FILE"
-  CLI="$TEMP_FILE"
-fi
+DOWNLOAD_URL="https://github.com/getsentry/sentry-cli/releases/download/1.5.0/sentry-cli-Darwin-x86_64"
+TEMP_FILE=`mktemp "${TMPDIR:-/tmp}/.sentrycli.XXXXXXXX"`
+cleanup() {
+  rm -f "$TEMP_FILE"
+}
+trap cleanup EXIT
+echo "🔗  Fetching sentry-cli utility"
+curl -SL --progress-bar "$DOWNLOAD_URL" > "$TEMP_FILE"
+chmod +x "$TEMP_FILE"
+CLI="$TEMP_FILE"
+echo -n $'\033[2A\033[K'
+echo "⚙️  Fetched sentry-cli utility"
+echo -n $'\033[K'
+echo "👀  Looking for debug symbols"
 
 {% if token %}export SENTRY_AUTH_TOKEN="{{ token }}"{% endif %}
 export SENTRY_URL="{{ server_url }}"
 export SENTRY_ORG="{{ project.organization.slug }}"
 export SENTRY_PROJECT="{{ project.slug }}"
 
-"$CLI" upload-dsym --derived-data --no-zips{% for issue in issues %} --uuid {{ issue.data.image_uuid }}{% endfor %}
+"$CLI" upload-dsym --derived-data --no-zips{% for issue in issues %} --uuid {{ issue.uuid }}{% endfor %}
 echo '🌟  Done!'
+{% else %}
+echo '🎉  Good news. No missing debug symbols!  Nothing to do here.'
+{% endif %}
 {% endautoescape %}
