commit 59e30cc649a7bfb66d19212511086cc61611646a
Author: Lauryn Brown <lauryndbrown@gmail.com>
Date:   Mon Nov 19 14:17:20 2018 -0800

    fix(integrations): Fix IntegrationEndpoint error handling. (#10640)
    
    * Added tests for IntegrationEndpoint error handling.
    
    * small change
    
    * small change
    
    * Added an init for api bases tests

diff --git a/src/sentry/api/bases/integration.py b/src/sentry/api/bases/integration.py
index 784387559a..1847e9c1ee 100644
--- a/src/sentry/api/bases/integration.py
+++ b/src/sentry/api/bases/integration.py
@@ -24,4 +24,4 @@ class IntegrationEndpoint(OrganizationEndpoint):
             response = Response(context, status=503)
             response.exception = True
             return response
-        return super(IntegrationEndpoint, self).handle_exception(exc)
+        return super(IntegrationEndpoint, self).handle_exception(request, exc)
diff --git a/tests/sentry/api/bases/__init__.py b/tests/sentry/api/bases/__init__.py
new file mode 100644
index 0000000000..c3961685ab
--- /dev/null
+++ b/tests/sentry/api/bases/__init__.py
@@ -0,0 +1 @@
+from __future__ import absolute_import
diff --git a/tests/sentry/api/bases/test_integration.py b/tests/sentry/api/bases/test_integration.py
new file mode 100644
index 0000000000..31af942992
--- /dev/null
+++ b/tests/sentry/api/bases/test_integration.py
@@ -0,0 +1,27 @@
+from __future__ import absolute_import
+
+from django.http import HttpRequest
+
+from sentry.api.bases.integration import IntegrationEndpoint
+from rest_framework.exceptions import APIException
+from sentry.integrations.exceptions import ApiError
+from sentry.testutils import APITestCase
+
+
+class IntegrationEndpointTest(APITestCase):
+
+    def setUp(self):
+        self.endpoint = IntegrationEndpoint()
+
+    def test_handle_exception(self):
+        exc = APIException('There was a problem!')
+        exc.status_code = 400  # set the status code to 400 not possible to set in init
+        exc.code = 400  # rest framework APIError is not compatible with integration APIError exception type
+        resp = self.endpoint.handle_exception(HttpRequest(), exc)
+        assert resp.status_code == 400
+        assert resp.exception is True
+
+    def test_handle_exception_503(self):
+        resp = IntegrationEndpoint().handle_exception(HttpRequest(), ApiError('This is an error', code=503))
+        assert resp.status_code == 503
+        assert resp.exception is True
