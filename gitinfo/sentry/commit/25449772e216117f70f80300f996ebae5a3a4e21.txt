commit 25449772e216117f70f80300f996ebae5a3a4e21
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Aug 6 20:34:05 2012 -0700

    Allow disabling of social auth for signup via SENTRY_ALLOW_SIGNUP_VIA_SOCIAL_AUTH

diff --git a/sentry/conf/defaults.py b/sentry/conf/defaults.py
index 605bd3d503..986414f529 100644
--- a/sentry/conf/defaults.py
+++ b/sentry/conf/defaults.py
@@ -170,3 +170,7 @@ MAX_JSON_RESULTS = 1000
 # Buffer backend to use
 BUFFER = 'sentry.buffer.Buffer'
 BUFFER_OPTIONS = {}
+
+# If disabled, users will only be able to associate existing accounts with
+# social identities.
+ALLOW_SIGNUP_VIA_SOCIAL_AUTH = True
diff --git a/sentry/web/frontend/accounts.py b/sentry/web/frontend/accounts.py
index 8a211ec8fb..09e3d1a82c 100644
--- a/sentry/web/frontend/accounts.py
+++ b/sentry/web/frontend/accounts.py
@@ -36,6 +36,7 @@ def get_auth_engines():
 
 @csrf_protect
 def login(request):
+    from sentry.conf import settings
     from django.contrib.auth import login as login_
     from django.contrib.auth.forms import AuthenticationForm
 
@@ -46,7 +47,10 @@ def login(request):
     else:
         request.session.set_test_cookie()
 
-    auth_engines = get_auth_engines()
+    if settings.ALLOW_SIGNUP_VIA_SOCIAL_AUTH:
+        auth_engines = get_auth_engines()
+    else:
+        auth_engines = None
 
     context = csrf(request)
     context.update({
