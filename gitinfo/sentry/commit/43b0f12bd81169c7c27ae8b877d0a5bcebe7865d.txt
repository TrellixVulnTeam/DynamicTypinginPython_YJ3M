commit 43b0f12bd81169c7c27ae8b877d0a5bcebe7865d
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Aug 4 14:47:19 2013 -0700

    Revert "Correct sourcemap check for existing index"
    
    This reverts commit 5579be4d0439a524f402253e4106712e0bbec115.

diff --git a/src/sentry/tasks/fetch_source.py b/src/sentry/tasks/fetch_source.py
index 4441d89b67..bc25d2184d 100644
--- a/src/sentry/tasks/fetch_source.py
+++ b/src/sentry/tasks/fetch_source.py
@@ -221,15 +221,12 @@ def expand_javascript_source(data, **kwargs):
         source_code[filename] = (result.body.splitlines(), map_path)
         if map_path:
             logger.debug('Found sourcemap %r for minified script %r', map_path, result.url)
-        # If we've already fetched this sourcemap, move along
-        elif map_path in sourcemap_idxs:
-            continue
-        else:
+
+        if not map_path or map_path not in sourcemap_idxs:
             continue
 
         index = fetch_sourcemap(map_path, logger=logger)
         if not index:
-            sourcemap_idxs[sourcemap] = None
             continue
 
         sourcemap_idxs[sourcemap] = sourcemap.load(index)
@@ -248,7 +245,7 @@ def expand_javascript_source(data, **kwargs):
             continue
 
         # may have had a failure pulling down the sourcemap previously
-        if sourcemap_idxs.get(map_path) and frame.colno is not None:
+        if map_path in sourcemap_idxs and frame.colno is not None:
             token = sourcemap_idxs[map_path].lookup(frame.lineno, frame.colno)
             # TODO: is this urljoin right? (is it relative to the sourcemap or the originating file)
             abs_path = urljoin(map_path, token.src)
