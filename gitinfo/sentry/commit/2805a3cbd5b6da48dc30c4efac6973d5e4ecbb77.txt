commit 2805a3cbd5b6da48dc30c4efac6973d5e4ecbb77
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Feb 2 03:20:21 2012 -0800

    Improve the project page to include your DSN and member status

diff --git a/sentry/templates/sentry/projects/list.html b/sentry/templates/sentry/projects/list.html
index b2f563a66a..3a8a140375 100644
--- a/sentry/templates/sentry/projects/list.html
+++ b/sentry/templates/sentry/projects/list.html
@@ -18,26 +18,38 @@
 {% block content %}
     <section class="body">
         {% if project_list %}
-            <p>You have access to the following projects:</p>
+            <p>The following is a list of projects that you are a member of.</p>
             <table class="table table-zebra table-bordered">
                 <colgroup>
                     <col>
+                    <col style="width:100px;">
                     <col style="width:150px;">
                     <col style="width:100px;">
                 </colgroup>
                 <thead>
                     <tr>
                         <th>Name</th>
-                        <th>Owner</th>
-                        <th>Status</th>
+                        <th style="text-align:center;">Membership</th>
+                        <th style="text-align:center;">Owner</th>
+                        <th style="text-align:center;">Status</th>
                     </tr>
                 </thead>
                 <tbody>
                     {% for project in project_list %}
                         <tr>
-                            <td><a href="{% url sentry-manage-project project.pk %}">{{ project.name }}</a></td>
-                            <td>{% if project.owner %}{{ project.owner.username }}{% else %}<em>no owner</em>{% endif %}</td>
-                            <td>{{ project.get_status_display }}</td>
+                            <td>
+                                <a href="{% url sentry-manage-project project.pk %}">{{ project.name }}</a><br/>
+                                {% if project.member_dsn %}<small>{{ project.member_dsn }}</small>{% endif %}
+                            </td>
+                            <td style="text-align:center;vertical-align:middle;">{{ project.member_type }}</td>
+                            <td style="text-align:center;vertical-align:middle;">
+                                {% if project.owner %}
+                                    {{ project.owner.username }}
+                                {% else %}
+                                    <em>no owner</em>
+                                {% endif %}
+                            </td>
+                            <td style="text-align:center;vertical-align:middle;">{{ project.get_status_display }}</td>
                         </tr>
                     {% endfor %}
                 </tbody>
diff --git a/sentry/web/frontend/projects.py b/sentry/web/frontend/projects.py
index 41b61cd736..9d01bb1760 100644
--- a/sentry/web/frontend/projects.py
+++ b/sentry/web/frontend/projects.py
@@ -4,7 +4,7 @@ from django.http import HttpResponseRedirect
 from django.views.decorators.csrf import csrf_protect
 
 from sentry.conf import settings
-from sentry.models import MEMBER_USER, MEMBER_OWNER
+from sentry.models import ProjectMember, MEMBER_USER, MEMBER_OWNER
 from sentry.plugins import plugins
 from sentry.web.decorators import login_required, has_access
 from sentry.web.forms import EditProjectForm, NewProjectForm, \
@@ -16,8 +16,17 @@ from sentry.web.helpers import render_to_response, get_project_list, \
 
 @login_required
 def project_list(request):
+    project_list = get_project_list(request.user, hidden=True)
+    memberships = dict(
+        (p.project_id, p)
+        for p in ProjectMember.objects.filter(user=request.user, project__in=project_list)
+    )
+    for project_id, member in memberships.iteritems():
+        project_list[project_id].member_dsn = member.get_dsn(request.get_host(), secure=request.is_secure())
+        project_list[project_id].member_type = member.get_type_display()
+
     return render_to_response('sentry/projects/list.html', {
-        'project_list': get_project_list(request.user, hidden=True).values(),
+        'project_list': project_list.values(),
     }, request)
 
 
