commit e1d5c1fa8a752b0126857781e2e8ec9dbc04b086
Author: evanh <evanh@users.noreply.github.com>
Date:   Fri Mar 20 13:43:27 2020 -0400

    fix(search) Trailing backslash in wildcard search (#17790)
    
    Having a trailing backslash on a wildcard search would cause an exception.

diff --git a/src/sentry/api/event_search.py b/src/sentry/api/event_search.py
index 4a3e6502a0..96b31856ae 100644
--- a/src/sentry/api/event_search.py
+++ b/src/sentry/api/event_search.py
@@ -46,7 +46,7 @@ def translate(pat):
         # fnmatch.translate has no way to handle escaping metacharacters.
         # Applied this basic patch to handle it:
         # https://bugs.python.org/file27570/issue8402.1.patch
-        if c == "\\":
+        if c == "\\" and i < n:
             res += re.escape(pat[i])
             i += 1
         elif c == "*":
diff --git a/tests/sentry/api/test_event_search.py b/tests/sentry/api/test_event_search.py
index 4b51945a44..d01b13ddb6 100644
--- a/tests/sentry/api/test_event_search.py
+++ b/tests/sentry/api/test_event_search.py
@@ -1049,6 +1049,10 @@ class GetSnubaQueryArgsTest(TestCase):
         ]
         assert _filter.filter_keys == {}
 
+    def test_wildcard_with_trailing_backslash(self):
+        results = get_filter("title:*misgegaan\\")
+        assert results.conditions == [[["match", ["title", u"'(?i)^.*misgegaan\\\\$'"]], "=", 1]]
+
     def test_has(self):
         assert get_filter("has:release").conditions == [[["isNull", ["release"]], "!=", 1]]
 
