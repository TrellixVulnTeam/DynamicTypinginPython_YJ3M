commit 52506e386e1d55b610b2a9eceaaabb4bf4ce09de
Author: Ben Vinegar <ben@benv.ca>
Date:   Thu Sep 22 15:47:33 2016 -0700

    Fix sidebar org list on Django-rendered views

diff --git a/src/sentry/static/sentry/app/components/organizations/organizationsLoader.jsx b/src/sentry/static/sentry/app/components/organizations/organizationsLoader.jsx
new file mode 100644
index 0000000000..d27ae5a352
--- /dev/null
+++ b/src/sentry/static/sentry/app/components/organizations/organizationsLoader.jsx
@@ -0,0 +1,38 @@
+import React from 'react';
+
+import ApiMixin from '../../mixins/apiMixin';
+import OrganizationStore from '../../stores/organizationStore';
+
+const OrganizationsLoader = React.createClass({
+  mixins: [ApiMixin],
+
+  componentWillMount() {
+    this.api.request('/organizations/', {
+      query: {
+        'member': '1'
+      },
+      success: (data) => {
+        OrganizationStore.load(data);
+        this.setState({
+          loading: false,
+        });
+      },
+      error: () => {
+        this.setState({
+          loading: false,
+          error: true
+        });
+      }
+    });
+  },
+
+  componentWillUnmount() {
+    OrganizationStore.load([]);
+  },
+
+  render() {
+    return <div>{this.props.children}</div>;
+  }
+});
+
+export default OrganizationsLoader;
diff --git a/src/sentry/static/sentry/app/index.js b/src/sentry/static/sentry/app/index.js
index 325b7fd740..7c07c8c77a 100644
--- a/src/sentry/static/sentry/app/index.js
+++ b/src/sentry/static/sentry/app/index.js
@@ -75,6 +75,7 @@ export default {
     ListLink: require('./components/listLink'),
     MenuItem: require('./components/menuItem'),
     OrganizationHomeContainer: require('./components/organizations/homeContainer'),
+    OrganizationsLoader: require('./components/organizations/organizationsLoader'),
     Pagination: require('./components/pagination'),
     PluginConfig: require('./components/pluginConfig'),
     ProjectIssueTracking: require('./views/projectIssueTracking'),
diff --git a/src/sentry/static/sentry/app/views/app.jsx b/src/sentry/static/sentry/app/views/app.jsx
index e7ba5f4052..9001d19ee8 100644
--- a/src/sentry/static/sentry/app/views/app.jsx
+++ b/src/sentry/static/sentry/app/views/app.jsx
@@ -4,12 +4,14 @@ import Cookies from 'js-cookie';
 
 import ApiMixin from '../mixins/apiMixin';
 import Alerts from '../components/alerts';
-import AlertActions from '../actions/alertActions.jsx';
+import AlertActions from '../actions/alertActions';
 import ConfigStore from '../stores/configStore';
 import Indicators from '../components/indicators';
 import InstallWizard from './installWizard';
 import LoadingIndicator from '../components/loadingIndicator';
+import OrganizationsLoader from '../components/organizations/organizationsLoader';
 import OrganizationStore from '../stores/organizationStore';
+
 import {t} from '../locale';
 
 function getAlertTypeForProblem(problem) {
@@ -119,11 +121,11 @@ const App = React.createClass({
     }
 
     return (
-      <div>
+      <OrganizationsLoader>
         <Alerts className="messages-container" />
         <Indicators className="indicators-container" />
         {this.props.children}
-      </div>
+      </OrganizationsLoader>
     );
   }
 });
diff --git a/src/sentry/templates/sentry/layout.html b/src/sentry/templates/sentry/layout.html
index 1c6c19a934..210ca2be1a 100644
--- a/src/sentry/templates/sentry/layout.html
+++ b/src/sentry/templates/sentry/layout.html
@@ -85,7 +85,8 @@
           }
         },
         render: function () {
-          return React.createElement(Sentry.Sidebar);
+          return React.createElement(Sentry.OrganizationsLoader, {},
+            React.createElement(Sentry.Sidebar));
         }
       });
       SidebarWrapper.childContextTypes = {
