commit 5df4636ecb7d1e97ff4aed547aa50c323cd8c337
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Wed Oct 30 13:24:57 2019 -0700

    feat(hooks): Add log experiment analytics hook (#15338)

diff --git a/src/sentry/static/sentry/app/stores/hookStore.tsx b/src/sentry/static/sentry/app/stores/hookStore.tsx
index 5639614f64..238c7bf1f1 100644
--- a/src/sentry/static/sentry/app/stores/hookStore.tsx
+++ b/src/sentry/static/sentry/app/stores/hookStore.tsx
@@ -13,6 +13,7 @@ const validHookNames = new Set<HookName>([
   'analytics:init-user',
   'analytics:track-adhoc-event',
   'analytics:track-event',
+  'analytics:log-experiment',
   'component:header-date-range',
   'component:header-selector-items',
   'component:org-members-view',
diff --git a/src/sentry/static/sentry/app/types/hooks.ts b/src/sentry/static/sentry/app/types/hooks.ts
index 329aaabeb8..6152cbd1a3 100644
--- a/src/sentry/static/sentry/app/types/hooks.ts
+++ b/src/sentry/static/sentry/app/types/hooks.ts
@@ -68,6 +68,7 @@ export type AnalyticsHooks = {
   'analytics:init-user': AnalyticsInitUser;
   'analytics:track-event': AnalyticsTrackEvent;
   'analytics:track-adhoc-event': AnalyticsTrackAdhocEvent;
+  'analytics:log-experiment': AnalyticsLogExperiment;
   'metrics:event': MetricsEvent;
 
   // TODO(epurkhiser): This is deprecated and should be replaced
@@ -191,6 +192,32 @@ type AnalyticsTrackAdhocEvent = (
   opts: Omit<Parameters<AnalyticsTrackEvent>[0], 'eventName'>
 ) => void;
 
+/**
+ * Trigger experiment observed logging.
+ */
+type AnalyticsLogExperiment = (opts: {
+  /**
+   * The organiation with the experiment
+   */
+  organization: Organization;
+  /**
+   * The experiment key
+   */
+  key: string;
+  /**
+   * The name of the exposed unit
+   */
+  unitName: string;
+  /**
+   * The value of the unit to group by
+   */
+  unitId: string | number;
+  /**
+   * The parameter name used for the exposed key
+   */
+  param: string;
+}) => void;
+
 /**
  * Trigger analytics tracking in the hook store.
  *
diff --git a/src/sentry/static/sentry/app/utils/analytics.tsx b/src/sentry/static/sentry/app/utils/analytics.tsx
index ee66c1cbb1..c4c0976ec1 100644
--- a/src/sentry/static/sentry/app/utils/analytics.tsx
+++ b/src/sentry/static/sentry/app/utils/analytics.tsx
@@ -43,6 +43,16 @@ export const trackAnalyticsEvent: Hooks['analytics:track-event'] = options =>
 export const trackAdhocEvent: Hooks['analytics:track-adhoc-event'] = options =>
   HookStore.get('analytics:track-adhoc-event').forEach(cb => cb(options));
 
+/**
+ * This should be used to log when a `organization.experiments` experiment
+ * variant is checked in the application.
+ *
+ * Refer for the backend implementation provided through HookStore for more
+ * details.
+ */
+export const logExperiment: Hooks['analytics:log-experiment'] = options =>
+  HookStore.get('analytics:track-adhoc-event').forEach(cb => cb(options));
+
 /**
  * Legacy analytics tracking.
  *
