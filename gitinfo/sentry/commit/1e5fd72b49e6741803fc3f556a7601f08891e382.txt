commit 1e5fd72b49e6741803fc3f556a7601f08891e382
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Tue Jun 25 12:53:29 2019 -0700

    ref(discover): Remove grid-emotion from Discover code (#13815)
    
    grid-emotion is deprecated

diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/aggregation.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/aggregation.jsx
index afa6781995..9ff5f54c70 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/aggregation.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/aggregation.jsx
@@ -1,8 +1,7 @@
 import React from 'react';
-
 import {Value} from 'react-select';
 import PropTypes from 'prop-types';
-import {Box} from 'grid-emotion';
+
 import SelectControl from 'app/components/forms/selectControl';
 import {t} from 'app/locale';
 
@@ -122,7 +121,7 @@ export default class Aggregation extends React.Component {
 
   render() {
     return (
-      <Box w={1}>
+      <div>
         <SelectControl
           innerRef={ref => (this.select = ref)}
           value={getInternal(this.props.value)}
@@ -144,7 +143,7 @@ export default class Aggregation extends React.Component {
           onInputChange={this.handleInputChange}
           disabled={this.props.disabled}
         />
-      </Box>
+      </div>
     );
   }
 }
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/index.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/index.jsx
index 63591ae99c..2a9051e29f 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/index.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/index.jsx
@@ -1,6 +1,5 @@
 import React from 'react';
 import PropTypes from 'prop-types';
-import {Box} from 'grid-emotion';
 
 import Link from 'app/components/links/link';
 import InlineSvg from 'app/components/inlineSvg';
@@ -59,11 +58,11 @@ export default class Aggregations extends React.Component {
               columns={columns}
               disabled={disabled}
             />
-            <Box ml={1}>
+            <div>
               <a onClick={() => this.removeRow(idx)}>
                 <InlineSvg src="icon-circle-close" height="38px" />
               </a>
-            </Box>
+            </div>
           </SelectListItem>
         ))}
       </div>
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/conditions/condition.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/conditions/condition.jsx
index 22417874ec..0aed806923 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/conditions/condition.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/conditions/condition.jsx
@@ -1,9 +1,10 @@
 import React from 'react';
 import {Value} from 'react-select';
 import PropTypes from 'prop-types';
-import {Box} from 'grid-emotion';
+import styled from 'react-emotion';
 import {t} from 'app/locale';
 import SelectControl from 'app/components/forms/selectControl';
+import space from 'app/styles/space';
 
 import {getInternal, getExternal, isValidCondition, ignoreCase} from './utils';
 import {CONDITION_OPERATORS, ARRAY_FIELD_PREFIXES} from '../data';
@@ -196,7 +197,7 @@ export default class Condition extends React.Component {
 
   render() {
     return (
-      <Box w={1}>
+      <Box>
         <SelectControl
           innerRef={ref => (this.select = ref)}
           value={getInternal(this.props.value)}
@@ -226,3 +227,8 @@ export default class Condition extends React.Component {
     );
   }
 }
+
+const Box = styled('div')`
+  width: 100%;
+  margin-right: ${space(1)};
+`;
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/conditions/index.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/conditions/index.jsx
index 371f4fe49f..7ffd80c05b 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/conditions/index.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/conditions/index.jsx
@@ -1,6 +1,5 @@
 import React from 'react';
 import PropTypes from 'prop-types';
-import {Box} from 'grid-emotion';
 
 import Link from 'app/components/links/link';
 import InlineSvg from 'app/components/inlineSvg';
@@ -59,11 +58,11 @@ export default class Conditions extends React.Component {
               columns={columns}
               disabled={disabled}
             />
-            <Box ml={1}>
+            <div>
               <a onClick={() => this.removeRow(idx)}>
                 <InlineSvg src="icon-circle-close" height="38px" />
               </a>
-            </Box>
+            </div>
           </SelectListItem>
         ))}
       </div>
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/intro.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/intro.jsx
index 1528cee035..5fc3aabddd 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/intro.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/intro.jsx
@@ -1,7 +1,6 @@
 import React from 'react';
 import PropTypes from 'prop-types';
 import styled from 'react-emotion';
-import {Box} from 'grid-emotion';
 
 import {tct, t} from 'app/locale';
 
@@ -53,7 +52,7 @@ export default class Intro extends React.Component {
   render() {
     return (
       <IntroContainer>
-        <Box w={560}>
+        <Content>
           <Heading>{t('Discover lets you query raw event data in Sentry')}</Heading>
           <TextBlock>
             {tct(
@@ -79,7 +78,7 @@ export default class Intro extends React.Component {
               </ExampleQuery>
             ))}
           </TextBlock>
-        </Box>
+        </Content>
       </IntroContainer>
     );
   }
@@ -97,6 +96,10 @@ const IntroContainer = styled('div')`
   min-width: 500px;
 `;
 
+const Content = styled('div')`
+  max-width: 560px;
+`;
+
 const Heading = styled('div')`
   font-size: ${p => p.theme.fontSizeExtraLarge};
   font-weight: 700;
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/result/pagination.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/result/pagination.jsx
index 0cdab9f3e2..32e475baab 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/result/pagination.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/result/pagination.jsx
@@ -1,7 +1,6 @@
 import React from 'react';
 import PropTypes from 'prop-types';
 import styled from 'react-emotion';
-import {Flex} from 'grid-emotion';
 
 import Button from 'app/components/button';
 
@@ -37,6 +36,7 @@ export default class Pagination extends React.Component {
   }
 }
 
-const PaginationButtons = styled(Flex)`
+const PaginationButtons = styled('div')`
+  display: flex;
   justify-content: flex-end;
 `;
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/editSavedQuery.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/editSavedQuery.jsx
index 136c634e15..6218b99caa 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/editSavedQuery.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/editSavedQuery.jsx
@@ -1,6 +1,5 @@
 import PropTypes from 'prop-types';
 import React from 'react';
-import {Flex, Box} from 'grid-emotion';
 import {isEqual} from 'lodash';
 
 import SentryTypes from 'app/sentryTypes';
@@ -10,7 +9,12 @@ import InlineSvg from 'app/components/inlineSvg';
 
 import QueryFields from './queryFields';
 import {parseSavedQuery} from '../utils';
-import {ButtonSpinner, SavedQueryAction} from '../styles';
+import {
+  ButtonSpinner,
+  QueryActions,
+  QueryActionsGroup,
+  SavedQueryAction,
+} from '../styles';
 
 export default class EditSavedQuery extends React.Component {
   static propTypes = {
@@ -67,9 +71,9 @@ export default class EditSavedQuery extends React.Component {
         savedQueryName={this.state.savedQueryName}
         onUpdateName={name => this.handleUpdateName(name)}
         actions={
-          <Flex justify="space-between">
-            <Flex>
-              <Box mr={1}>
+          <QueryActions>
+            <QueryActionsGroup>
+              <div>
                 <Button
                   size="xsmall"
                   onClick={onRunQuery}
@@ -79,8 +83,8 @@ export default class EditSavedQuery extends React.Component {
                   {t('Run')}
                   {isFetchingQuery && <ButtonSpinner />}
                 </Button>
-              </Box>
-              <Box>
+              </div>
+              <div>
                 <Button
                   size="xsmall"
                   onClick={() => onSaveQuery(savedQueryName)}
@@ -88,14 +92,14 @@ export default class EditSavedQuery extends React.Component {
                 >
                   {t('Save')}
                 </Button>
-              </Box>
-            </Flex>
-            <Box>
+              </div>
+            </QueryActionsGroup>
+            <div>
               <SavedQueryAction data-test-id="delete" onClick={onDeleteQuery}>
                 <InlineSvg src="icon-trash" />
               </SavedQueryAction>
-            </Box>
-          </Flex>
+            </div>
+          </QueryActions>
         }
       />
     );
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/newQuery.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/newQuery.jsx
index a28e828297..6f99b24023 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/newQuery.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/newQuery.jsx
@@ -1,6 +1,5 @@
 import PropTypes from 'prop-types';
 import React from 'react';
-import {Flex, Box} from 'grid-emotion';
 import {browserHistory} from 'react-router';
 
 import Button from 'app/components/button';
@@ -10,7 +9,12 @@ import SentryTypes from 'app/sentryTypes';
 
 import QueryFields from './queryFields';
 import {createSavedQuery, generateQueryName} from '../utils';
-import {ButtonSpinner, QueryFieldsContainer} from '../styles';
+import {
+  ButtonSpinner,
+  QueryActions,
+  QueryActionsGroup,
+  QueryFieldsContainer,
+} from '../styles';
 
 export default class NewQuery extends React.Component {
   static propTypes = {
@@ -60,9 +64,9 @@ export default class NewQuery extends React.Component {
           onUpdateField={onUpdateField}
           isLoading={isLoading}
           actions={
-            <Flex justify="space-between">
-              <Flex>
-                <Box mr={1}>
+            <QueryActions>
+              <QueryActionsGroup>
+                <div>
                   <Button
                     size="xsmall"
                     onClick={onRunQuery}
@@ -72,19 +76,19 @@ export default class NewQuery extends React.Component {
                     {t('Run')}
                     {isFetchingQuery && <ButtonSpinner />}
                   </Button>
-                </Box>
-                <Box>
+                </div>
+                <div>
                   <Button size="xsmall" onClick={() => this.saveQuery()}>
                     {t('Save')}
                   </Button>
-                </Box>
-              </Flex>
-              <Box>
+                </div>
+              </QueryActionsGroup>
+              <div>
                 <Button size="xsmall" onClick={onReset}>
                   {t('Reset')}
                 </Button>
-              </Box>
-            </Flex>
+              </div>
+            </QueryActions>
           }
         />
       </QueryFieldsContainer>
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/orderby.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/orderby.jsx
index 95c10af0e6..2fed5f8982 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/orderby.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/orderby.jsx
@@ -1,7 +1,6 @@
 import PropTypes from 'prop-types';
 import React from 'react';
 import styled from 'react-emotion';
-import {Flex} from 'grid-emotion';
 
 import {t} from 'app/locale';
 import SelectControl from 'app/components/forms/selectControl';
@@ -57,7 +56,7 @@ export default class Orderby extends React.Component {
     return (
       <React.Fragment>
         <SidebarLabel className="control-label">{t('Order by')}</SidebarLabel>
-        <Flex>
+        <Container>
           <OrderbyField>
             <SelectControl
               name="orderbyField"
@@ -76,12 +75,16 @@ export default class Orderby extends React.Component {
               disabled={disabled}
             />
           </OrderbyValue>
-        </Flex>
+        </Container>
       </React.Fragment>
     );
   }
 }
 
+const Container = styled('div')`
+  display: flex;
+`;
+
 const OrderbyField = styled('div')`
   width: calc(100% / 3 * 2);
   padding-right: ${space(1)};
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/queryFields.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/queryFields.jsx
index d65f42991e..dd64a0ab76 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/queryFields.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/queryFields.jsx
@@ -1,6 +1,6 @@
 import PropTypes from 'prop-types';
 import React from 'react';
-import {Flex} from 'grid-emotion';
+import styled from 'react-emotion';
 
 import SentryTypes from 'app/sentryTypes';
 import {t} from 'app/locale';
@@ -16,7 +16,6 @@ import {
   Fieldset,
   PlaceholderText,
   SidebarLabel,
-  QueryFieldsSidebar,
   DocsSeparator,
   StyledInlineSvg,
   DiscoverDocs,
@@ -52,10 +51,10 @@ export default class QueryFields extends React.Component {
 
   optionRenderer = ({label, isTag}) => {
     return (
-      <Flex align="center">
+      <Option>
         {label}
         {isTag && <Badge text="tag" />}
-      </Flex>
+      </Option>
     );
   };
 
@@ -84,7 +83,7 @@ export default class QueryFields extends React.Component {
     }));
 
     return (
-      <QueryFieldsSidebar>
+      <div>
         {savedQuery && (
           <Fieldset>
             <React.Fragment>
@@ -159,7 +158,12 @@ export default class QueryFields extends React.Component {
             <StyledInlineSvg src="icon-chevron-right" size="1em" />
           </DiscoverDocs>
         </DocsLink>
-      </QueryFieldsSidebar>
+      </div>
     );
   }
 }
+
+const Option = styled('div')`
+  display: flex;
+  align-items: center;
+`;
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/savedQueryList.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/savedQueryList.jsx
index 3d707a22d6..4ea125585e 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/savedQueryList.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/sidebar/savedQueryList.jsx
@@ -1,6 +1,5 @@
 import React from 'react';
 import moment from 'moment';
-import {Flex} from 'grid-emotion';
 
 import SentryTypes from 'app/sentryTypes';
 import getDynamicText from 'app/utils/getDynamicText';
@@ -11,6 +10,7 @@ import {t, tct} from 'app/locale';
 import {fetchSavedQueries} from '../utils';
 import {
   Fieldset,
+  LoadingContainer,
   SavedQueryList,
   SavedQueryListItem,
   SavedQueryLink,
@@ -72,9 +72,9 @@ export default class SavedQueries extends React.Component {
   renderLoading() {
     return (
       <Fieldset>
-        <Flex justify="center">
+        <LoadingContainer>
           <LoadingIndicator mini />
-        </Flex>
+        </LoadingContainer>
       </Fieldset>
     );
   }
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/styles.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/styles.jsx
index a1ab6c9a39..1e3ea9a897 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/styles.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/styles.jsx
@@ -1,4 +1,3 @@
-import {Flex, Box} from 'grid-emotion';
 import {keyframes} from 'emotion';
 import React from 'react';
 import styled from 'react-emotion';
@@ -16,11 +15,13 @@ import ExternalLink from 'app/components/links/externalLink';
 
 const HEADER_HEIGHT = 60;
 
-export const DiscoverWrapper = styled(Flex)`
+export const DiscoverWrapper = styled('div')`
+  display: flex;
   flex: 1;
 `;
 
-export const DiscoverContainer = styled(Flex)`
+export const DiscoverContainer = styled('div')`
+  display: flex;
   width: 100%;
   height: 100vh;
   position: relative;
@@ -84,20 +85,17 @@ export const DownloadCsvButton = styled(Button)`
   }
 `;
 
-export const Sidebar = styled(props => (
-  <Flex {...props} direction="column" w={[300, 300, 300, 360]} />
-))`
+export const Sidebar = styled('div')`
+  display: flex;
+  flex-direction: column;
   border-right: 1px solid ${p => p.theme.borderDark};
   background: #fff;
   min-width: 320px;
   position: relative;
   padding-top: ${HEADER_HEIGHT}px;
-`;
-
-export const QueryFieldsSidebar = styled(Flex)`
-  height: 100%;
-  flex-direction: column;
-  justify-content: flex-start;
+  @media (min-width: ${theme.breakpoints[2]}) {
+    width: 360px;
+  }
 `;
 
 export const DocsSeparator = styled('div')`
@@ -135,14 +133,16 @@ export const DocsIcon = styled(InlineSvg)`
   margin-right: 8px;
 `;
 
-export const Body = styled(Flex)`
+export const Body = styled('div')`
+  display: flex;
   flex: 1;
   flex-direction: column;
   overflow: hidden;
   padding-top: ${HEADER_HEIGHT}px;
 `;
 
-export const BodyContent = styled(Flex)`
+export const BodyContent = styled('div')`
+  display: flex;
   flex: 1;
   flex-direction: column;
   padding: ${space(3)} ${space(4)} ${space(4)} ${space(4)};
@@ -151,7 +151,8 @@ export const BodyContent = styled(Flex)`
   background: ${p => p.theme.whiteDark};
 `;
 
-export const LoadingContainer = styled(Flex)`
+export const LoadingContainer = styled('div')`
+  display: flex;
   flex: 1;
   align-items: center;
   height: 100%;
@@ -167,7 +168,8 @@ export const PlaceholderText = styled('div')`
   font-size: 15px;
 `;
 
-export const HeadingContainer = styled(Flex)`
+export const HeadingContainer = styled('div')`
+  display: flex;
   min-width: 70px;
   margin: ${space(1)} 0 ${space(2)};
   align-items: center;
@@ -177,7 +179,10 @@ export const Fieldset = styled('fieldset')`
   margin: ${space(2)} ${space(3)};
 `;
 
-export const SelectListItem = styled(Flex)`
+export const SelectListItem = styled('div')`
+  display: grid;
+  grid-template-columns: auto ${space(2)};
+  grid-gap: ${space(1)};
   margin-top: ${space(0.5)};
 `;
 
@@ -222,12 +227,13 @@ export const ButtonSpinner = styled('div')`
   margin-left: 4px;
 `;
 
-export const ResultSummary = styled(Box)`
+export const ResultSummary = styled('div')`
   color: ${p => p.theme.gray6};
   font-size: ${p => p.theme.fontSizeSmall};
 `;
 
-export const ResultSummaryAndButtons = styled(Flex)`
+export const ResultSummaryAndButtons = styled('div')`
+  display: flex;
   justify-content: space-between;
 `;
 
@@ -246,7 +252,7 @@ export const ChartWrapper = styled(Panel)`
   padding: ${space(3)} ${space(2)};
 `;
 
-export const ChartNote = styled(Box)`
+export const ChartNote = styled('div')`
   text-align: center;
   font-size: ${p => p.theme.fontSizeMedium};
   color: ${p => p.theme.gray3};
@@ -299,7 +305,8 @@ export const QueryPanelContainer = styled('div')`
   overflow-y: scroll;
 `;
 
-export const QueryPanelTitle = styled(Flex)`
+export const QueryPanelTitle = styled('div')`
+  display: flex;
   justify-content: space-between;
   align-items: center;
   padding: 0 ${space(4)};
@@ -310,3 +317,15 @@ export const QueryPanelTitle = styled(Flex)`
 export const QueryPanelCloseLink = styled(Link)`
   color: ${p => p.theme.gray6};
 `;
+
+export const QueryActions = styled('div')`
+  display: grid;
+  grid-auto-flow: column;
+  justify-content: space-between;
+`;
+
+export const QueryActionsGroup = styled('div')`
+  display: grid;
+  grid-auto-flow: column;
+  grid-gap: ${space(1)};
+`;
