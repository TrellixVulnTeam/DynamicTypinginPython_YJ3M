commit 38b283fd96901dcd15ddb12bab1ec416ea2782f9
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Sun Aug 24 22:18:07 2014 +0000

    Don't raise an AssertionError if the column is out of bounds

diff --git a/src/sentry/tasks/fetch_source.py b/src/sentry/tasks/fetch_source.py
index 293d0d742b..83b074b4f0 100644
--- a/src/sentry/tasks/fetch_source.py
+++ b/src/sentry/tasks/fetch_source.py
@@ -59,7 +59,8 @@ def trim_line(line, column=0):
     """
     line = line.strip('\n')
     ll = len(line)
-    assert column < ll
+    if column > ll:
+        column = ll
     if ll <= 150:
         return line
     start = max(column - 60, 0)
diff --git a/tests/sentry/tasks/fetch_source/tests.py b/tests/sentry/tasks/fetch_source/tests.py
index 508cd64e05..463d5c2a7b 100644
--- a/tests/sentry/tasks/fetch_source/tests.py
+++ b/tests/sentry/tasks/fetch_source/tests.py
@@ -228,3 +228,4 @@ class TrimLineTest(TestCase):
         assert trim_line(self.long_line, column=10) == 'The public is more familiar with bad design than good design. It is, in effect, conditioned to prefer bad design, because that is what it li {snip}'
         assert trim_line(self.long_line, column=66) == '{snip} blic is more familiar with bad design than good design. It is, in effect, conditioned to prefer bad design, because that is what it lives wi {snip}'
         assert trim_line(self.long_line, column=190) == '{snip} gn. It is, in effect, conditioned to prefer bad design, because that is what it lives with. The new becomes threatening, the old reassuring.'
+        assert trim_line(self.long_line, column=9999) == '{snip} gn. It is, in effect, conditioned to prefer bad design, because that is what it lives with. The new becomes threatening, the old reassuring.'
