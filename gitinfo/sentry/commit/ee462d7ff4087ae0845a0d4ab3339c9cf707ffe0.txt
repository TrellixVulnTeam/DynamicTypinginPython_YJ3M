commit ee462d7ff4087ae0845a0d4ab3339c9cf707ffe0
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Jan 26 16:35:42 2013 -0800

    Correct select2 behavior

diff --git a/src/sentry/filters/widgets.py b/src/sentry/filters/widgets.py
index 84ad63c34d..00a73ca2b1 100644
--- a/src/sentry/filters/widgets.py
+++ b/src/sentry/filters/widgets.py
@@ -26,7 +26,7 @@ class TextWidget(Widget):
     def render(self, value, placeholder='', **kwargs):
         return mark_safe(u'''
             <div class="filter-text">
-                <input type="text" name="%(name)s" value="%(value)s" data-placeholder="Search for a %(label)s"/>
+                <input type="text" name="%(name)s" value="%(value)s" data-allowClear="true" data-placeholder="Search for a %(label)s"/>
             </div>''' % dict(
             name=self.filter.get_query_param(),
             value=escape(value),
@@ -47,7 +47,7 @@ class ChoiceWidget(TextWidget):
         column = self.filter.get_query_param()
         choices = choices.items()
 
-        output = [u'<select name="%(column)s" class="filter-list" rel="%(column)s" data-placeholder="Select a %(label)s">' % dict(
+        output = [u'<select name="%(column)s" class="filter-list" rel="%(column)s" data-allowClear="true" data-placeholder="Select a %(label)s">' % dict(
             column=column,
             label=self.filter.label.lower(),
         )]
diff --git a/src/sentry/static/sentry/less/sentry.less b/src/sentry/static/sentry/less/sentry.less
index 3ee653041b..522ca5c13b 100644
--- a/src/sentry/static/sentry/less/sentry.less
+++ b/src/sentry/static/sentry/less/sentry.less
@@ -571,8 +571,14 @@ h3 {
         background-color: #56AFE8;
       }
     }
+
     .filter {
       margin-bottom: 17px;
+
+      select {
+        width: 240px;
+      }
+
       .select2-container {
         display: block;
       }
diff --git a/src/sentry/static/sentry/scripts/sentry.core.js b/src/sentry/static/sentry/scripts/sentry.core.js
index 16ff76a19b..ce82326a5a 100644
--- a/src/sentry/static/sentry/scripts/sentry.core.js
+++ b/src/sentry/static/sentry/scripts/sentry.core.js
@@ -60,7 +60,7 @@ if (Sentry === undefined) {
                     allowClear: true
                 });
             }
-            if ($input.length) {
+            if ($input.length > 0) {
                 $input.on('change', function(e){
                     var query = app.utils.getQueryParams();
                     query[e.target.name] = e.val;
diff --git a/src/sentry/static/sentry/scripts/utils.js b/src/sentry/static/sentry/scripts/utils.js
index 66e90a37b8..1bd315c79f 100644
--- a/src/sentry/static/sentry/scripts/utils.js
+++ b/src/sentry/static/sentry/scripts/utils.js
@@ -126,7 +126,19 @@
 
     $(function(){
         // Change all select boxes to select2 elements.
-        $('select').select2({width: 'element'});
+        $('.body select, .toolbar select').each(function(){
+            var $this = $(this),
+                options = {
+                    width: 'element',
+                    allowClear: false
+                };
+
+            if ($this.attr('data-allowClear')) {
+                options.allowClear = $this.attr('data-allowClear');
+            }
+
+            $this.select2(options);
+        });
 
         // Update date strings periodically
         setInterval(function() {
