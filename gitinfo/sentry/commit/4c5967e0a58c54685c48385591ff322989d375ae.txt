commit 4c5967e0a58c54685c48385591ff322989d375ae
Author: Jess MacQueen <macqueen@users.noreply.github.com>
Date:   Wed Nov 16 15:30:24 2016 -0800

    fix roles when adding members to orgs (#4535)

diff --git a/src/sentry/web/forms/add_organization_member.py b/src/sentry/web/forms/add_organization_member.py
index b1a7649737..7056207320 100644
--- a/src/sentry/web/forms/add_organization_member.py
+++ b/src/sentry/web/forms/add_organization_member.py
@@ -15,7 +15,7 @@ class AddOrganizationMemberForm(BaseOrganizationMemberForm):
     user = UserField()
 
     class Meta:
-        fields = ('user',)
+        fields = ('user', 'role')
         model = OrganizationMember
 
     def save(self, actor, organization, ip_address):
diff --git a/src/sentry/web/forms/invite_organization_member.py b/src/sentry/web/forms/invite_organization_member.py
index 456beaf138..fe2787979f 100644
--- a/src/sentry/web/forms/invite_organization_member.py
+++ b/src/sentry/web/forms/invite_organization_member.py
@@ -17,7 +17,7 @@ class InviteOrganizationMemberForm(BaseOrganizationMemberForm):
     email = forms.EmailField()
 
     class Meta:
-        fields = ('email',)
+        fields = ('email', 'role')
         model = OrganizationMember
 
     def save(self, actor, organization, ip_address):
diff --git a/tests/sentry/web/frontend/test_create_organization_member.py b/tests/sentry/web/frontend/test_create_organization_member.py
index 16ccf72859..6d4db467be 100644
--- a/tests/sentry/web/frontend/test_create_organization_member.py
+++ b/tests/sentry/web/frontend/test_create_organization_member.py
@@ -60,7 +60,7 @@ class CreateOrganizationMemberTest(TestCase):
         with self.settings(SENTRY_ENABLE_INVITES=True), self.tasks():
             resp = self.client.post(path, {
                 'email': 'foo@example.com',
-                'role': 'member',
+                'role': 'admin',
                 'teams': [team.id, ]
             })
         assert resp.status_code == 302
@@ -71,7 +71,7 @@ class CreateOrganizationMemberTest(TestCase):
         )
 
         assert member.user is None
-        assert member.role == 'member'
+        assert member.role == 'admin'
 
         om_teams = OrganizationMemberTeam.objects.filter(
             organizationmember=member
@@ -126,7 +126,7 @@ class CreateOrganizationMemberTest(TestCase):
         with self.settings(SENTRY_ENABLE_INVITES=False):
             resp = self.client.post(path, {
                 'user': 'foo@example.com',
-                'role': 'member'
+                'role': 'admin'
             })
         assert resp.status_code == 302
 
@@ -136,6 +136,7 @@ class CreateOrganizationMemberTest(TestCase):
         )
 
         assert member.email is None
+        assert member.role == 'admin'
 
         redirect_uri = reverse('sentry-organization-members', args=[organization.slug])
         assert resp['Location'] == 'http://testserver' + redirect_uri
