commit 34ab947234ef730a61d07fd83f0485eebbe9c2e5
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Mar 17 22:30:20 2014 -0700

    Correctly handle errors in RiakNodeStorage.get_multi

diff --git a/src/sentry/nodestore/riak/backend.py b/src/sentry/nodestore/riak/backend.py
index c83cc624d9..d2dcd991a1 100644
--- a/src/sentry/nodestore/riak/backend.py
+++ b/src/sentry/nodestore/riak/backend.py
@@ -57,10 +57,15 @@ class RiakNodeStorage(NodeStorage):
 
     def get_multi(self, id_list, r=1):
         result = self.bucket.multiget(id_list)
-        return dict(
-            (obj.key, obj.data)
-            for obj in result
-        )
+
+        results = {}
+        for obj in result:
+            # errors return a tuple of (bucket, key, err)
+            if not isinstance(obj, tuple):
+                err = obj[2]
+                raise type(err), err, None
+            results[obj.key] = obj.data
+        return results
 
     def set(self, id, data):
         obj = self.bucket.new(key=id, data=data)
diff --git a/src/sentry/plugins/bases/notify.py b/src/sentry/plugins/bases/notify.py
index d49821d175..4d976107e6 100644
--- a/src/sentry/plugins/bases/notify.py
+++ b/src/sentry/plugins/bases/notify.py
@@ -50,7 +50,7 @@ class NotificationPlugin(Plugin):
         conf_key = self.get_conf_key()
 
         alert_settings = dict(
-            (o.user_id, o.value)
+            (o.user_id, int(o.value))
             for o in UserOption.objects.filter(
                 project=project,
                 key='%s:alert' % conf_key,
