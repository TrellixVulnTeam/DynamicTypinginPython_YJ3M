commit 0dda693284a6c6afdb2347825fef09d9a051e004
Author: Mark Story <mark@sentry.io>
Date:   Mon Jan 6 09:16:06 2020 -0500

    fix(discover2) Fix apdex and impact column aliases (#16257)
    
    When an aggregate takes no column names it must use None instead of ''
    in the discover API. This lets us more easily detect tags and optional
    values. I missed these aliases earlier.

diff --git a/src/sentry/api/event_search.py b/src/sentry/api/event_search.py
index 8bb62fea25..3e190f12ef 100644
--- a/src/sentry/api/event_search.py
+++ b/src/sentry/api/event_search.py
@@ -701,13 +701,13 @@ FIELD_ALIASES = {
     "user": {"fields": ["user.id", "user.username", "user.email", "user.ip"]},
     # Long term these will become more complex functions but these are
     # field aliases.
-    "apdex": {"result_type": "number", "aggregations": [["apdex(duration, 300)", "", "apdex"]]},
+    "apdex": {"result_type": "number", "aggregations": [["apdex(duration, 300)", None, "apdex"]]},
     "impact": {
         "result_type": "number",
         "aggregations": [
             [
                 "(1 - ((countIf(duration < 300) + (countIf((duration > 300) AND (duration < 1200)) / 2)) / count())) + ((1 - 1 / sqrt(uniq(user))) * 3)",
-                "",
+                None,
                 "impact",
             ]
         ],
diff --git a/tests/sentry/api/test_event_search.py b/tests/sentry/api/test_event_search.py
index d8521dfde8..2c465ff6b5 100644
--- a/tests/sentry/api/test_event_search.py
+++ b/tests/sentry/api/test_event_search.py
@@ -1112,10 +1112,10 @@ class ResolveFieldListTest(unittest.TestCase):
         assert result["selected_columns"] == []
         assert result["aggregations"] == [
             ["avg", "transaction.duration", "avg_transaction_duration"],
-            ["apdex(duration, 300)", "", "apdex"],
+            ["apdex(duration, 300)", None, "apdex"],
             [
                 "(1 - ((countIf(duration < 300) + (countIf((duration > 300) AND (duration < 1200)) / 2)) / count())) + ((1 - 1 / sqrt(uniq(user))) * 3)",
-                "",
+                None,
                 "impact",
             ],
             ["quantile(0.75)(duration)", None, "p75"],
