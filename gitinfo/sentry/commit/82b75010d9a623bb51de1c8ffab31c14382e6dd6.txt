commit 82b75010d9a623bb51de1c8ffab31c14382e6dd6
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Feb 17 02:37:59 2012 -0800

    Add clippy shortcut on project list for DSN

diff --git a/bootstrap/sentry.less b/bootstrap/sentry.less
index 1148a62096..816dabeb9b 100644
--- a/bootstrap/sentry.less
+++ b/bootstrap/sentry.less
@@ -438,6 +438,9 @@ code {
 .table th {
   vertical-align: top;
 }
+.clippy {
+  vertical-align: middle;
+}
 
 // Code styles
 
diff --git a/sentry/conf/server.py b/sentry/conf/server.py
index 91b6b8eba6..4b59679173 100644
--- a/sentry/conf/server.py
+++ b/sentry/conf/server.py
@@ -128,5 +128,10 @@ import logging
 logger = logging.getLogger()
 logger.setLevel(logging.ERROR)
 
+# Disable django.request as it's generally useless
+logger = logging.getLogger('django.request')
+logger.propagate = False
+
+
 # Configure default sentry logging
 setup_logging(SentryHandler())
diff --git a/sentry/models.py b/sentry/models.py
index 3738da3810..58a3023ac8 100644
--- a/sentry/models.py
+++ b/sentry/models.py
@@ -170,6 +170,9 @@ class ProjectOption(Model):
         db_table = 'sentry_projectoptions'
         unique_together = (('project', 'key',),)
 
+    def __unicode__(self):
+        return u'project=%s, key=%s, value=%s' % (self.project_id, self.key, self.value)
+
 
 class ProjectMember(Model):
     """
@@ -186,6 +189,9 @@ class ProjectMember(Model):
     class Meta:
         unique_together = (('project', 'user'),)
 
+    def __unicode__(self):
+        return u'project=%s, user=%s, type=%s' % (self.project_id, self.user_id, self.get_type_display())
+
     def save(self, *args, **kwargs):
         if not self.public_key:
             self.public_key = ProjectMember.generate_api_key()
@@ -217,6 +223,9 @@ class ProjectDomain(Model):
     class Meta:
         unique_together = (('project', 'domain'),)
 
+    def __unicode__(self):
+        return u'project=%s, domain=%s' % (self.project_id, self.domain)
+
     @classmethod
     def test(cls, project, url, strict=False):
         """
@@ -250,6 +259,9 @@ class View(Model):
     verbose_name = models.CharField(max_length=200, null=True)
     verbose_name_plural = models.CharField(max_length=200, null=True)
 
+    def __unicode__(self):
+        return self.path
+
 
 class MessageBase(Model):
     """
diff --git a/sentry/static/clippy.swf b/sentry/static/clippy.swf
new file mode 100755
index 0000000000..e46886cd11
Binary files /dev/null and b/sentry/static/clippy.swf differ
diff --git a/sentry/static/scripts/jquery.clippy.min.js b/sentry/static/scripts/jquery.clippy.min.js
new file mode 100644
index 0000000000..fcdf26fd35
--- /dev/null
+++ b/sentry/static/scripts/jquery.clippy.min.js
@@ -0,0 +1 @@
+(function(a){a.fn.clippy=function(b){_opts={width:"14",height:"14",color:"#ffffff",clippy_path:"clippy.swf",keep_text:false};b=a.extend(_opts,b);params={movie:b.clippy_path,allowScriptAccess:"always",quality:"high",scale:"noscale",bgcolor:b.color};embed_params=a.extend({},params,{width:b.width,height:b.height});embed_params.src=embed_params.movie;delete embed_params.movie;this.each(function(c,d){if(b.text&&b.text!=""){text=b.text}else{if(a(d).data("text")&&a(d).data("text")!=""){text=a(d).data("text")}else{text=a(d).html()}}text=encodeURIComponent(text);params.FlashVars="text="+text;embed_params.FlashVars="text="+text;dom=a("<object />").attr({classid:"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000",width:b.width,height:b.height});a.each(params,function(e,f){dom.append(a("<param />").attr({name:e,value:f}))});embed=a("<embed />").attr(embed_params);dom.append(embed);if(b.keep_text){a(d).html(dom).append(decodeURIComponent(text))}else{a(d).html(dom)}})}})(jQuery);
diff --git a/sentry/static/styles/global.css b/sentry/static/styles/global.css
index 5ef2515310..9828877eb8 100644
--- a/sentry/static/styles/global.css
+++ b/sentry/static/styles/global.css
@@ -2543,6 +2543,9 @@ code {
 .table th {
   vertical-align: top;
 }
+.clippy {
+  vertical-align: middle;
+}
 ol.context {
   margin: 0;
   list-style-position: inside;
diff --git a/sentry/static/styles/global.min.css b/sentry/static/styles/global.min.css
index 8467603354..bfc46dc1a4 100644
--- a/sentry/static/styles/global.min.css
+++ b/sentry/static/styles/global.min.css
@@ -400,6 +400,7 @@ pre span,code span{display:inline-block;}
 code{border:0;background-color:inherit;color:#666666;}
 .nav-tabs>li.pull-right{float:right;}
 .table th{vertical-align:top;}
+.clippy{vertical-align:middle;}
 ol.context{margin:0;list-style-position:inside;border:1px solid #ccc;border:1px solid rgba(0, 0, 0, 0.15);-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;}ol.context>li{padding-left:20px;font-family:monospace;white-space:pre;color:rgba(0, 0, 0, 0.75);background-color:#f5f5f5;}ol.context>li>pre{background-color:inherit;color:rgba(0, 0, 0, 0.5);margin:0;padding:0;border:0;display:block;line-height:18px;font-size:12px;white-space:pre;white-space:pre-wrap;word-wrap:break-word;}
 ol.context>li.active{background-color:#ddd;}ol.context>li.active pre{color:#000000;}
 ol.context-line>li>span{float:right;}
diff --git a/sentry/templates/sentry/layout.html b/sentry/templates/sentry/layout.html
index 75de87abc3..46e30cd361 100644
--- a/sentry/templates/sentry/layout.html
+++ b/sentry/templates/sentry/layout.html
@@ -23,6 +23,7 @@
         </script>
 
         <script type="text/javascript" src="{% url sentry-media "scripts/jquery.js" %}"></script>
+        <script type="text/javascript" src="{% url sentry-media "scripts/jquery.clippy.min.js" %}"></script>
         <script type="text/javascript" src="{% url sentry-media "scripts/jquery.flot.min.js" %}"></script>
         <script type="text/javascript" src="{% url sentry-media "scripts/jquery.animate-colors-min.js" %}"></script>
         <script type="text/javascript" src="{% url sentry-media "scripts/global.min.js" %}"></script>
@@ -93,7 +94,13 @@
             </div>
         </footer>
         {% endblock %}
-
         <script type="text/javascript" src="{% url sentry-media "scripts/bootstrap.min.js" %}"></script>
+        <script type="text/javascript">
+        $(function(){
+            $('.clippy').clippy({
+                clippy_path: '{% url sentry-media "clippy.swf" %}'
+            });
+        });
+        </script>
     </body>
 </html>
diff --git a/sentry/templates/sentry/projects/list.html b/sentry/templates/sentry/projects/list.html
index 3a8a140375..db0df21454 100644
--- a/sentry/templates/sentry/projects/list.html
+++ b/sentry/templates/sentry/projects/list.html
@@ -39,7 +39,9 @@
                         <tr>
                             <td>
                                 <a href="{% url sentry-manage-project project.pk %}">{{ project.name }}</a><br/>
-                                {% if project.member_dsn %}<small>{{ project.member_dsn }}</small>{% endif %}
+                                {% if project.member_dsn %}
+                                    <small>{{ project.member_dsn }} <span class="clippy">{{ project.member_dsn }}</span></small>
+                                {% endif %}
                             </td>
                             <td style="text-align:center;vertical-align:middle;">{{ project.member_type }}</td>
                             <td style="text-align:center;vertical-align:middle;">
diff --git a/sentry/web/frontend/projects.py b/sentry/web/frontend/projects.py
index fb009ea038..3d8fc4928a 100644
--- a/sentry/web/frontend/projects.py
+++ b/sentry/web/frontend/projects.py
@@ -18,11 +18,10 @@ from sentry.web.helpers import render_to_response, get_project_list, \
 @login_required
 def project_list(request):
     project_list = get_project_list(request.user, hidden=True)
-    memberships = dict(
-        (p.project_id, p)
-        for p in ProjectMember.objects.filter(user=request.user, project__in=project_list)
-    )
-    for project_id, member in memberships.iteritems():
+    memberships = list(ProjectMember.objects.filter(user=request.user, project__in=project_list))
+
+    for member in memberships:
+        project_id = member.project_id
         project_list[project_id].member_dsn = member.get_dsn(request.get_host(), secure=request.is_secure())
         project_list[project_id].member_type = member.get_type_display()
 
