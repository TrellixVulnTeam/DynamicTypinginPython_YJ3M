commit c334f99ee5a75aede07ca952d8fbe51ccffd0d86
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jan 12 14:14:38 2011 -0800

    Store module for version information

diff --git a/sentry/client/base.py b/sentry/client/base.py
index 1291e7f35f..615cfca155 100644
--- a/sentry/client/base.py
+++ b/sentry/client/base.py
@@ -40,13 +40,18 @@ class SentryClient(object):
             parts = kwargs['view'].split('.')
             module_list = ['.'.join(parts[:idx]) for idx in xrange(1, len(parts)+1)][::-1]
             version = None
+            module = None
             for m in module_list:
                 if m in versions:
+                    module = m
                     version = versions[m]
 
             # store our "best guess" for application version
             if version:
-                kwargs['data']['__sentry__']['version'] = version
+                kwargs['data']['__sentry__'].update({
+                    'version': version,
+                    'module': module,
+                })
 
         if 'checksum' not in kwargs:
             checksum = construct_checksum(**kwargs)
diff --git a/sentry/manager.py b/sentry/manager.py
index 7481e6c750..f9597a2f07 100644
--- a/sentry/manager.py
+++ b/sentry/manager.py
@@ -52,6 +52,8 @@ class SentryManager(models.Manager):
                 kwargs['data']['url'] = data['url']
             if 'version' in data.get('__sentry__', {}):
                 kwargs['data']['version'] = data['__sentry__']['version']
+            if 'module' in data.get('__sentry__', {}):
+                kwargs['data']['module'] = data['__sentry__']['module']
 
             group, created = GroupedMessage.objects.get_or_create(
                 view=view,
diff --git a/sentry/models.py b/sentry/models.py
index c8b8edc14e..b517a085f7 100644
--- a/sentry/models.py
+++ b/sentry/models.py
@@ -230,7 +230,8 @@ class GroupedMessage(MessageBase):
             return
         if 'version' not in self.data:
             return
-        return self.data['version']
+        module = self.data.get('module', 'ver')
+        return module, self.data['version']
 
 class Message(MessageBase):
     message_id      = models.CharField(max_length=32, null=True, unique=True)
diff --git a/sentry/templates/sentry/group/details.html b/sentry/templates/sentry/group/details.html
index 584c7c3c07..9aeb5e8cff 100644
--- a/sentry/templates/sentry/group/details.html
+++ b/sentry/templates/sentry/group/details.html
@@ -46,7 +46,7 @@
                     <span class="tag tag-logger">{{ group.logger }}</span> 
                     {% with group.get_version as version %}
                         {% if version %}
-                            <span class="tag tag-version">ver {{ version }}</span> 
+                            <span class="tag tag-version">{{ version.0 }} {{ version.1 }}</span> 
                         {% endif %}
                     {% endwith %}
                     {% for tag in group|get_tags:request %}<span class="tag">{{ tag }}</span> {% endfor %}
diff --git a/sentry/templates/sentry/group/message.html b/sentry/templates/sentry/group/message.html
index 8452c10a67..52f4eea186 100644
--- a/sentry/templates/sentry/group/message.html
+++ b/sentry/templates/sentry/group/message.html
@@ -15,7 +15,7 @@
                 <span class="tag tag-server">{{ message.server_name }}</span>
                 {% with message.get_version as version %}
                     {% if version %}
-                        <span class="tag tag-version">ver {{ version }}</span> 
+                        <span class="tag tag-version">{{ version.0 }} {{ version.1 }}</span> 
                     {% endif %}
                 {% endwith %}
                 <span class="last_seen">{{ message.datetime|timesince }}</span>
diff --git a/sentry/templates/sentry/partial/_group.html b/sentry/templates/sentry/partial/_group.html
index 344dcc839e..c4b3716d7e 100644
--- a/sentry/templates/sentry/partial/_group.html
+++ b/sentry/templates/sentry/partial/_group.html
@@ -10,7 +10,7 @@
         <span class="tag tag-logger">{{ group.logger }}</span> 
         {% with group.get_version as version %}
             {% if version %}
-                <span class="tag tag-version">ver {{ version }}</span> 
+                <span class="tag tag-version">{{ version.0 }} {{ version.1 }}</span> 
             {% endif %}
         {% endwith %}
         {% for tag in group|get_tags:request %}<span class="tag">{{ tag }}</span> {% endfor %}
diff --git a/sentry/templates/sentry/partial/_message.html b/sentry/templates/sentry/partial/_message.html
index 19036fd69d..8a78c913a6 100644
--- a/sentry/templates/sentry/partial/_message.html
+++ b/sentry/templates/sentry/partial/_message.html
@@ -8,7 +8,7 @@
         <span class="tag tag-server">{{ message.server_name }}</span>
         {% with message.get_version as version %}
             {% if version %}
-                <span class="tag tag-version">ver {{ version }}</span> 
+                <span class="tag tag-version">{{ version.0 }} {{ version.1 }}</span> 
             {% endif %}
         {% endwith %}
         <span class="last_seen">{{ message.datetime|timesince }}</span>
