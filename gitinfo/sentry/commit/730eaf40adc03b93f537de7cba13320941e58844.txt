commit 730eaf40adc03b93f537de7cba13320941e58844
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Aug 5 18:03:30 2015 -0700

    Add system health endpoint

diff --git a/src/sentry/api/endpoints/system_health.py b/src/sentry/api/endpoints/system_health.py
new file mode 100644
index 0000000000..a490ad23dd
--- /dev/null
+++ b/src/sentry/api/endpoints/system_health.py
@@ -0,0 +1,19 @@
+from __future__ import absolute_import
+
+from rest_framework.response import Response
+
+from sentry import status_checks
+from sentry.api.base import Endpoint
+from sentry.api.permissions import SuperuserPermission
+
+
+class SystemHealthEndpoint(Endpoint):
+    permission_classes = (SuperuserPermission,)
+
+    def get(self, request):
+        problems, checks = status_checks.check_all()
+
+        return Response({
+            'problems': map(unicode, problems),
+            'healthy': checks,
+        })
diff --git a/src/sentry/api/urls.py b/src/sentry/api/urls.py
index b52a8e6fb7..d9fc1ae54d 100644
--- a/src/sentry/api/urls.py
+++ b/src/sentry/api/urls.py
@@ -45,6 +45,7 @@ from .endpoints.release_details import ReleaseDetailsEndpoint
 from .endpoints.release_files import ReleaseFilesEndpoint
 from .endpoints.release_file_details import ReleaseFileDetailsEndpoint
 from .endpoints.shared_group_details import SharedGroupDetailsEndpoint
+from .endpoints.system_health import SystemHealthEndpoint
 from .endpoints.team_details import TeamDetailsEndpoint
 from .endpoints.team_groups_new import TeamGroupsNewEndpoint
 from .endpoints.team_groups_trending import TeamGroupsTrendingEndpoint
@@ -214,6 +215,9 @@ urlpatterns = patterns(
         name='sentry-api-0-event-details'),
 
     # Internal
+    url(r'^internal/health/$',
+        SystemHealthEndpoint.as_view(),
+        name='sentry-api-0-system-health'),
     url(r'^internal/stats/$',
         InternalStatsEndpoint.as_view(),
         name='sentry-api-0-internal-stats'),
diff --git a/tests/sentry/api/endpoints/test_system_health.py b/tests/sentry/api/endpoints/test_system_health.py
new file mode 100644
index 0000000000..caf8345f46
--- /dev/null
+++ b/tests/sentry/api/endpoints/test_system_health.py
@@ -0,0 +1,15 @@
+from __future__ import absolute_import
+
+from django.core.urlresolvers import reverse
+
+from sentry.testutils import APITestCase
+
+
+class SystemHealthTest(APITestCase):
+    def test_simple(self):
+        self.login_as(user=self.user)
+        url = reverse('sentry-api-0-system-health')
+        response = self.client.get(url)
+        assert response.status_code == 200
+        assert 'problems' in response.data
+        assert 'healthy' in response.data
