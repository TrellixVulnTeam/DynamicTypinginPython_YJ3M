commit 186c5909f77ae2de58edf2a76a06da9bbb2a76ef
Author: David Cramer <dcramer@David-Cramers-MacBook.local>
Date:   Mon Nov 16 13:00:08 2009 -0600

    Pop class_name out of unique index as it creates an index which is too long for utf8 charsets

diff --git a/djangodblog/manager.py b/djangodblog/manager.py
index 3c35456cb2..d53436634e 100644
--- a/djangodblog/manager.py
+++ b/djangodblog/manager.py
@@ -131,7 +131,6 @@ class DBLogManager(models.Manager):
                 **defaults
             )
             batch, created = ErrorBatch.objects.get_or_create(
-                class_name = class_name,
                 server_name = server_name,
                 checksum = checksum,
                 defaults = defaults
diff --git a/djangodblog/models.py b/djangodblog/models.py
index bda10f2cb5..a0d4761ea9 100644
--- a/djangodblog/models.py
+++ b/djangodblog/models.py
@@ -31,7 +31,7 @@ STATUS_LEVELS = (
 
 class ErrorBatch(Model):
     logger          = models.CharField(max_length=64, blank=True, default='root', db_index=True)
-    class_name      = models.CharField(_('type'), max_length=128, blank=True, null=True)
+    class_name      = models.CharField(_('type'), max_length=128, blank=True, null=True, db_index=True)
     level           = models.PositiveIntegerField(choices=LOG_LEVELS, default=logging.ERROR, blank=True, db_index=True)
     message         = models.TextField()
     traceback       = models.TextField(blank=True, null=True)
@@ -47,7 +47,7 @@ class ErrorBatch(Model):
     objects         = DBLogManager()
 
     class Meta:
-        unique_together = (('logger', 'class_name', 'server_name', 'checksum'),)
+        unique_together = (('logger', 'server_name', 'checksum'),)
         verbose_name_plural = 'Error batches'
     
     def __unicode__(self):
