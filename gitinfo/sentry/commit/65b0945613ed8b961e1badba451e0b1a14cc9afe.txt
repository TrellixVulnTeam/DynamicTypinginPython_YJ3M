commit 65b0945613ed8b961e1badba451e0b1a14cc9afe
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Sep 3 17:35:35 2011 -0700

    Add a setting for sampling

diff --git a/sentry/conf/defaults.py b/sentry/conf/defaults.py
index 45070729c6..50624d240f 100644
--- a/sentry/conf/defaults.py
+++ b/sentry/conf/defaults.py
@@ -84,6 +84,9 @@ LOGIN_URL = None
 # Automatically log frame stacks from all ``logging`` messages
 AUTO_LOG_STACKS = False
 
+# Only store a portion of all messages per unique group
+SAMPLE_DATA = True
+
 ## The following settings refer to the built-in webserver
 
 WEB_HOST = 'localhost'
diff --git a/sentry/utils/manager.py b/sentry/utils/manager.py
index 74f16133b5..bc117b246f 100644
--- a/sentry/utils/manager.py
+++ b/sentry/utils/manager.py
@@ -144,8 +144,6 @@ class SentryManager(models.Manager):
                 silence = 0
                 mail = True
 
-            sample_rate = min(count_limit(group.times_seen), time_limit(silence))
-
             instance = Message(
                 message_id=message_id,
                 view=view,
@@ -160,7 +158,7 @@ class SentryManager(models.Manager):
                 **kwargs
             )
 
-            if group.times_seen % sample_rate == 0:
+            if not settings.SAMPLE_DATA or group.times_seen % min(count_limit(group.times_seen), time_limit(silence)) == 0:
                 instance.save()
 
             normalized_to_hour = now.replace(second=0, microsecond=0)
