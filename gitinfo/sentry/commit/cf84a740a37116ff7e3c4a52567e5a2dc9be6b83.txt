commit cf84a740a37116ff7e3c4a52567e5a2dc9be6b83
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Wed Oct 14 15:00:04 2015 -0700

    Reject blocked-uri == 'data' because not actionable

diff --git a/src/sentry/interfaces/csp.py b/src/sentry/interfaces/csp.py
index 3a82d1e67f..df1edfd1c6 100644
--- a/src/sentry/interfaces/csp.py
+++ b/src/sentry/interfaces/csp.py
@@ -101,7 +101,7 @@ class Csp(Interface):
         # Some reports from Chrome report blocked-uri as just 'about'.
         # In this case, this is not actionable and is just noisy.
         # Observed in Chrome 45 and 46.
-        if kwargs['blocked_uri'] == 'about':
+        if kwargs['blocked_uri'] in ('about', 'data'):
             raise InterfaceValidationError("Invalid value for 'blocked-uri'")
 
         # Anything resulting from an "inline" whatever violation is either sent
diff --git a/tests/sentry/interfaces/test_csp.py b/tests/sentry/interfaces/test_csp.py
index 955dc1d925..29788d4868 100644
--- a/tests/sentry/interfaces/test_csp.py
+++ b/tests/sentry/interfaces/test_csp.py
@@ -162,3 +162,10 @@ class CspTest(TestCase):
             violated_directive="script-src example.com",
         ))
         assert result.get_message() == "Blocked unsafe 'script'"
+
+        result = Csp.to_python(dict(
+            document_uri='http://example.com/foo',
+            effective_directive='script-src',
+            blocked_uri='data:text/plain;base64,SGVsbG8sIFdvcmxkIQ%3D%3D',
+        ))
+        assert result.get_message() == "Blocked 'script' from 'data:'"
