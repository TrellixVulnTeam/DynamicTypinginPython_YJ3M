commit 1e8e2613aa32c21c3cf4123d8156d7d6bd20429d
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jan 4 10:52:43 2016 -0800

    Retain File.size column

diff --git a/src/sentry/models/file.py b/src/sentry/models/file.py
index 892fd14518..32b4f25348 100644
--- a/src/sentry/models/file.py
+++ b/src/sentry/models/file.py
@@ -134,12 +134,12 @@ class File(Model):
     timestamp = models.DateTimeField(default=timezone.now, db_index=True)
     headers = JSONField()
     blobs = models.ManyToManyField('sentry.FileBlob', through='sentry.FileBlobIndex')
+    size = BoundedPositiveIntegerField(null=True)
 
     # <Legacy fields>
     # Remove in 8.1
     blob = FlexibleForeignKey('sentry.FileBlob', null=True, related_name='legacy_blob')
     path = models.TextField(null=True)
-    size = BoundedPositiveIntegerField(null=True)
     checksum = models.CharField(max_length=40, null=True)
     # </Legacy fields>
 
@@ -161,7 +161,7 @@ class File(Model):
             file=self,
         ).select_related('blob').order_by('offset')), 'rb')
 
-    def putfile(self, fileobj, blob_size=DEFAULT_BLOB_SIZE):
+    def putfile(self, fileobj, blob_size=DEFAULT_BLOB_SIZE, commit=True):
         """
         Save a fileobj into a number of chunks.
 
@@ -187,8 +187,10 @@ class File(Model):
                 )
             )
             offset += blob.size
-
+        self.size = offset
         metrics.timing('filestore.file-size', offset)
+        if commit:
+            self.save()
         return results
 
 
