commit c5ae253cb85340b9f3ef7fbd9080c5187f88c3c7
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Feb 23 14:05:10 2017 -0800

    [admin] override User forms to support correct username length

diff --git a/src/sentry/admin.py b/src/sentry/admin.py
index 65daebe98e..d38334bcd2 100644
--- a/src/sentry/admin.py
+++ b/src/sentry/admin.py
@@ -1,5 +1,6 @@
 from __future__ import absolute_import
 
+from django import forms
 from django.conf import settings
 from django.contrib import admin, messages
 from django.contrib.auth.forms import (
@@ -157,6 +158,28 @@ class TeamAdmin(admin.ModelAdmin):
 admin.site.register(Team, TeamAdmin)
 
 
+class UserChangeForm(UserChangeForm):
+    username = forms.RegexField(
+        label=_("Username"), max_length=128, regex=r"^[\w.@+-]+$",
+        help_text=_("Required. 128 characters or fewer. Letters, digits and "
+                    "@/./+/-/_ only."),
+        error_messages={
+            'invalid': _("This value may contain only letters, numbers and "
+                         "@/./+/-/_ characters.")},
+    )
+
+
+class UserCreationForm(UserCreationForm):
+    username = forms.RegexField(
+        label=_("Username"), max_length=128, regex=r"^[\w.@+-]+$",
+        help_text=_("Required. 128 characters or fewer. Letters, digits and "
+                    "@/./+/-/_ only."),
+        error_messages={
+            'invalid': _("This value may contain only letters, numbers and "
+                         "@/./+/-/_ characters.")}
+    )
+
+
 class UserAdmin(admin.ModelAdmin):
     add_form_template = 'admin/auth/user/add_form.html'
     change_user_password_template = None
