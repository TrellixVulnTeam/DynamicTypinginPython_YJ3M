commit 9d5bb1ceb0b6620925b33f5db36406ece8244817
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Feb 22 21:30:59 2012 -0800

    Make logging not suck, specifically for kombu

diff --git a/sentry/conf/server.py b/sentry/conf/server.py
index 72383b7204..b60892f568 100644
--- a/sentry/conf/server.py
+++ b/sentry/conf/server.py
@@ -126,12 +126,18 @@ import logging
 
 # Configure root logger
 logger = logging.getLogger()
-logger.setLevel(logging.ERROR)
+logger.setLevel(logging.INFO)
+
+handler = logging.StreamHandler()
+handler.setLevel(logging.INFO)
+logger.addHandler(handler)
 
 # Disable django.request as it's generally useless
 logger = logging.getLogger('django.request')
 logger.propagate = False
-
+logger.addHandler(handler)
 
 # Configure default sentry logging
-setup_logging(SentryHandler())
+sentry_handler = SentryHandler()
+sentry_handler.setLevel(logging.ERROR)
+setup_logging(sentry_handler)
diff --git a/sentry/queue/worker.py b/sentry/queue/worker.py
index 38ad8a41b6..5f672aa157 100644
--- a/sentry/queue/worker.py
+++ b/sentry/queue/worker.py
@@ -6,14 +6,17 @@ sentry.queue.worker
 :license: BSD, see LICENSE for more details.
 """
 from kombu.mixins import ConsumerMixin
-from kombu.utils import kwdict, reprcall
+from kombu.utils import kwdict
 
 from sentry.queue.queues import task_queues
 
+import logging
+
 
 class Worker(ConsumerMixin):
     def __init__(self, connection):
         self.connection = connection
+        self.logger = logging.getLogger(__name__)
 
     def get_consumers(self, Consumer, channel):
         return [Consumer(queues=task_queues,
@@ -23,10 +26,10 @@ class Worker(ConsumerMixin):
         func = body["func"]
         args = body["args"]
         kwargs = body["kwargs"]
-        self.info("Got task: %s", reprcall(func.__name__, args, kwargs))
+        self.logger.info("Got task: %r", func.__name__)
         try:
             func(*args, **kwdict(kwargs))
         except Exception, exc:
-            self.error("task raised exception: %r", exc)
+            self.logger.error("task raised exception: %r", exc)
         message.ack()
 
diff --git a/sentry/services/worker.py b/sentry/services/worker.py
index 8592ebb895..054ff8e658 100644
--- a/sentry/services/worker.py
+++ b/sentry/services/worker.py
@@ -12,12 +12,11 @@ class SentryWorker(Service):
     name = 'worker'
 
     def run(self):
+        import eventlet
+        eventlet.patcher.monkey_patch()
         from sentry.queue.client import broker
         from sentry.queue.worker import Worker
 
-        from kombu.utils.debug import setup_logging
-        setup_logging(loglevel="INFO")
-
         try:
             Worker(broker.connection).run()
         except KeyboardInterrupt:
