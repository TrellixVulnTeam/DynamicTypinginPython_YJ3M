commit 42175a30f5ea72ca217a07f97bf8bc89fc0e4272
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Mon Nov 30 01:01:34 2015 +0100

    Automatically mark catalogs good if they have more than 80%
    translations.

diff --git a/Makefile b/Makefile
index df7b6ddfae..d019dbebe7 100644
--- a/Makefile
+++ b/Makefile
@@ -56,6 +56,7 @@ build-js-po:
 locale: build-js-po
 	cd src/sentry && sentry makemessages -i static -l en
 	./bin/merge-catalogs en
+	./bin/find-good-catalogs > src/sentry/locale/catalogs.json
 	cd src/sentry && sentry compilemessages
 
 update-transifex: build-js-po
diff --git a/bin/find-good-catalogs b/bin/find-good-catalogs
new file mode 100755
index 0000000000..19af013543
--- /dev/null
+++ b/bin/find-good-catalogs
@@ -0,0 +1,52 @@
+#!/usr/bin/env python
+
+import os
+import json
+import click
+
+from babel.messages.pofile import read_po
+
+
+MINIMUM = 80
+
+
+def is_translated(msg):
+    if isinstance(msg.string, basestring):
+        return bool(msg.string)
+    for item in msg.string:
+        if not item:
+            return False
+    return True
+
+
+@click.command()
+def cli():
+    rv = []
+    base = 'src/sentry/locale'
+    for locale in os.listdir(base):
+        fn = os.path.join(base, locale, 'LC_MESSAGES', 'django.po')
+        if not os.path.isfile(fn):
+            continue
+
+        total_count = 0
+        translated_count = 0
+        with open(fn) as f:
+            catalog = read_po(f)
+            for msg in catalog:
+                total_count += 1
+                if is_translated(msg):
+                    translated_count += 1
+        pct = translated_count / float(total_count) * 100
+        click.echo('% -7s % 2d%%' % (
+            locale,
+            pct,
+        ), err=True)
+        if pct >= MINIMUM:
+            rv.append(locale)
+    click.echo(json.dumps({
+        'supported_locales': sorted(rv)
+    }, indent=2))
+
+
+if __name__ == '__main__':
+    cli()
diff --git a/src/sentry/locale/catalogs.json b/src/sentry/locale/catalogs.json
new file mode 100644
index 0000000000..ca954b5999
--- /dev/null
+++ b/src/sentry/locale/catalogs.json
@@ -0,0 +1,11 @@
+{
+  "supported_locales": [
+    "cs", 
+    "de", 
+    "fi", 
+    "fr", 
+    "ja", 
+    "ru", 
+    "zh_CN"
+  ]
+}
diff --git a/src/sentry/static/sentry/app/translations.jsx b/src/sentry/static/sentry/app/translations.jsx
index dc17356dee..41614dcdef 100644
--- a/src/sentry/static/sentry/app/translations.jsx
+++ b/src/sentry/static/sentry/app/translations.jsx
@@ -1,9 +1,16 @@
+const catalogs = (function() {
+  var info = require('../../../locale/catalogs.json');
+  return info.supported_catalogs;
+})();
+
 const translations = (function() {
   var ctx = require.context('../../../locale/', true, /\.po$/);
   var rv = {};
   ctx.keys().forEach((translation) => {
     var langCode = translation.match(/([a-zA-Z_]+)/)[1];
-    rv[langCode] = ctx(translation);
+    if (catalogs.indexOf(langCode) >= 0) {
+      rv[langCode] = ctx(translation);
+    }
   });
   return rv;
 })();
