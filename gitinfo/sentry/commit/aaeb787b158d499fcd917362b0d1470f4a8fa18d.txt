commit aaeb787b158d499fcd917362b0d1470f4a8fa18d
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Mon Apr 9 14:06:20 2018 -0700

    fix(auth): Initialize state data if necessary
    
    In this case the users request will likely error out later, since their
    auth state has expired, but at least we won't 500 here.
    
    Fixes SENTRY-525

diff --git a/src/sentry/auth/helper.py b/src/sentry/auth/helper.py
index b174260e92..7b321166c1 100644
--- a/src/sentry/auth/helper.py
+++ b/src/sentry/auth/helper.py
@@ -785,7 +785,7 @@ class AuthHelper(object):
         return HttpResponseRedirect(redirect_uri)
 
     def bind_state(self, key, value):
-        data = self.state.data
+        data = self.state.data or {}
         data[key] = value
 
         self.state.data = data
