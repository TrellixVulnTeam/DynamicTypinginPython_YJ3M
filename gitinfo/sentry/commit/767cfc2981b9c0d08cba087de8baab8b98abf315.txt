commit 767cfc2981b9c0d08cba087de8baab8b98abf315
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Wed May 23 17:11:45 2018 -0700

    feat(dashboard): More condensed version of project card (#8531)

diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/deploys.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/deploys.jsx
index 6f312e0f3e..1845730d32 100644
--- a/src/sentry/static/sentry/app/views/organizationDashboard/deploys.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDashboard/deploys.jsx
@@ -9,6 +9,7 @@ import Button from 'app/components/buttons/button';
 import Link from 'app/components/link';
 import {t} from 'app/locale';
 import TextOverflow from 'app/components/textOverflow';
+import {getShortVersion} from 'app/utils';
 
 const DEPLOY_COUNT = 2;
 
@@ -35,18 +36,15 @@ export default class Deploys extends React.Component {
 
     if (deploys.length) {
       return (
-        <DeployBox p={2} pb={0}>
-          <Heading>{t('Latest deploys')}</Heading>
-          <div>
-            {deploys.map(deploy => (
-              <Deploy
-                key={deploy.version}
-                deploy={deploy}
-                projectId={projectId}
-                orgId={orgId}
-              />
-            ))}
-          </div>
+        <DeployBox p={2} pt={1}>
+          {deploys.map(deploy => (
+            <Deploy
+              key={deploy.version}
+              deploy={deploy}
+              projectId={projectId}
+              orgId={orgId}
+            />
+          ))}
         </DeployBox>
       );
     } else {
@@ -55,12 +53,6 @@ export default class Deploys extends React.Component {
   }
 }
 
-const Heading = styled.div`
-  color: ${p => p.theme.gray2};
-  text-transform: uppercase;
-  font-size: 14px;
-`;
-
 class Deploy extends React.Component {
   static propTypes = {
     deploy: SentryTypes.Deploy.isRequired,
@@ -75,10 +67,12 @@ class Deploy extends React.Component {
         <Environment>{deploy.environment}</Environment>
         <Version>
           <StyledLink to={`/${orgId}/${projectId}/releases/${deploy.version}/`}>
-            {deploy.version}
+            {getShortVersion(deploy.version)}
           </StyledLink>
         </Version>
-        <Box w={100}>{moment(deploy.dateFinished).fromNow()}</Box>
+        <Flex w={90} justify="flex-end">
+          {moment(deploy.dateFinished).fromNow()}
+        </Flex>
       </DeployRow>
     );
   }
@@ -86,7 +80,7 @@ class Deploy extends React.Component {
 
 const DeployRow = styled(Flex)`
   color: ${p => p.theme.gray2};
-  font-size: 13px;
+  font-size: 12px;
   margin-top: 8px;
 `;
 
@@ -116,7 +110,7 @@ const StyledLink = styled(Link)`
 class NoDeploys extends React.Component {
   render() {
     return (
-      <DeployBox p={2} pb={0}>
+      <DeployBox p={2}>
         <Background align="center" justify="center">
           <Button
             size="xsmall"
@@ -132,7 +126,7 @@ class NoDeploys extends React.Component {
 }
 
 const DeployBox = styled(Box)`
-  height: 108px;
+  height: 92px;
 `;
 
 const Background = styled(Flex)`
diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/projectCard.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/projectCard.jsx
index 69901d95dc..94f324b7e1 100644
--- a/src/sentry/static/sentry/app/views/organizationDashboard/projectCard.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDashboard/projectCard.jsx
@@ -16,8 +16,8 @@ import {t} from 'app/locale';
 import {update, loadStatsForProject} from 'app/actionCreators/projects';
 import ProjectsStatsStore from 'app/stores/projectsStatsStore';
 import overflowEllipsis from 'app/styles/overflowEllipsis';
+import Platformicon from 'app/components/platformicon';
 
-import PlatformList from './platformList';
 import Chart from './chart';
 import NoEvents from './noEvents';
 import Deploys from './deploys';
@@ -66,6 +66,9 @@ class ProjectCard extends React.Component {
         {stats ? (
           <StyledProjectCard>
             <Flex justify="space-between" align="center">
+              <Box ml={2}>
+                <StyledPlatformicon size="24" platform={project.platform || 'generic'} />
+              </Box>
               <StyledLink to={`/${params.orgId}/${slug}/`}>
                 <strong>{slug}</strong>
               </StyledLink>
@@ -82,7 +85,6 @@ class ProjectCard extends React.Component {
               {!firstEvent && <NoEvents />}
             </ChartContainer>
             <Deploys project={project} orgId={params.orgId} />
-            <PlatformList project={project} orgId={params.orgId} />
           </StyledProjectCard>
         ) : (
           <LoadingCard />
@@ -92,6 +94,13 @@ class ProjectCard extends React.Component {
   }
 }
 
+const StyledPlatformicon = styled(Platformicon)`
+  display: block;
+  color: white;
+  border-radius: 3px;
+  max-width: 24px;
+`;
+
 const ProjectCardContainer = createReactClass({
   propTypes: {
     project: SentryTypes.Project,
@@ -138,7 +147,7 @@ const ChartContainer = styled.div`
 
 const StyledLink = styled(Link)`
   ${overflowEllipsis};
-  padding: 16px;
+  padding: 16px 8px;
 `;
 
 const ProjectCardWrapper = styled(Box)`
@@ -164,7 +173,7 @@ const Star = styled.a`
 const LoadingCard = styled('div')`
   border: 1px solid transparent;
   background-color: ${p => p.theme.offWhite};
-  height: 290px;
+  height: 210px;
 `;
 
 export {ProjectCard};
diff --git a/tests/js/spec/views/organizationDashboard/__snapshots__/projectCard.spec.jsx.snap b/tests/js/spec/views/organizationDashboard/__snapshots__/projectCard.spec.jsx.snap
index 5324df3988..e1ef82fa75 100644
--- a/tests/js/spec/views/organizationDashboard/__snapshots__/projectCard.spec.jsx.snap
+++ b/tests/js/spec/views/organizationDashboard/__snapshots__/projectCard.spec.jsx.snap
@@ -14,9 +14,7 @@ exports[`ProjectCard renders 1`] = `
       "isBookmarked": false,
       "isMember": true,
       "name": "Project Name",
-      "platforms": Array [
-        "javascript",
-      ],
+      "platform": "javascript",
       "slug": "project-slug",
       "stats": Array [
         Array [
@@ -44,7 +42,7 @@ exports[`ProjectCard renders 1`] = `
     }
   >
     <Base
-      className="css-3jemnr-ProjectCardWrapper efesc7i2"
+      className="css-3jemnr-ProjectCardWrapper efesc7i3"
       data-test-id="project-slug"
       width={
         Array [
@@ -56,13 +54,13 @@ exports[`ProjectCard renders 1`] = `
       }
     >
       <div
-        className="css-3jemnr-ProjectCardWrapper efesc7i2"
+        className="css-3jemnr-ProjectCardWrapper efesc7i3"
         data-test-id="project-slug"
         is={null}
       >
         <StyledProjectCard>
           <div
-            className="css-18be1td-StyledProjectCard efesc7i3"
+            className="css-18be1td-StyledProjectCard efesc7i4"
           >
             <Flex
               align="center"
@@ -77,21 +75,59 @@ exports[`ProjectCard renders 1`] = `
                   className="css-v7pzd9"
                   is={null}
                 >
+                  <Box
+                    ml={2}
+                  >
+                    <Base
+                      className="css-1dvsqd3"
+                      ml={2}
+                    >
+                      <div
+                        className="css-1dvsqd3"
+                        is={null}
+                      >
+                        <StyledPlatformicon
+                          platform="javascript"
+                          size="24"
+                        >
+                          <Platformicon
+                            className="css-12pxqdy-StyledPlatformicon efesc7i0"
+                            platform="javascript"
+                            size="24"
+                          >
+                            <img
+                              className="css-12pxqdy-StyledPlatformicon efesc7i0"
+                              height="24"
+                              src={
+                                Object {
+                                  "default": Object {
+                                    "id": "test",
+                                    "viewBox": Object {},
+                                  },
+                                }
+                              }
+                              width="24"
+                            />
+                          </Platformicon>
+                        </StyledPlatformicon>
+                      </div>
+                    </Base>
+                  </Box>
                   <StyledLink
                     to="/org-slug/project-slug/"
                   >
                     <Link
-                      className="css-1vw4sd8-StyledLink efesc7i1"
+                      className="css-1c2wmv-StyledLink efesc7i2"
                       to="/org-slug/project-slug/"
                     >
                       <Link
-                        className="css-1vw4sd8-StyledLink efesc7i1"
+                        className="css-1c2wmv-StyledLink efesc7i2"
                         onlyActiveOnIndex={false}
                         style={Object {}}
                         to="/org-slug/project-slug/"
                       >
                         <a
-                          className="css-1vw4sd8-StyledLink efesc7i1"
+                          className="css-1c2wmv-StyledLink efesc7i2"
                           onClick={[Function]}
                           style={Object {}}
                         >
@@ -112,7 +148,7 @@ exports[`ProjectCard renders 1`] = `
                       title="Add to bookmarks"
                     >
                       <a
-                        className="tip project-select-bookmark icon icon-star-solid css-31kf5u-Star efesc7i4"
+                        className="tip project-select-bookmark icon icon-star-solid css-31kf5u-Star efesc7i5"
                         onClick={[Function]}
                         title="Add to bookmarks"
                       />
@@ -123,7 +159,7 @@ exports[`ProjectCard renders 1`] = `
             </Flex>
             <ChartContainer>
               <div
-                className="css-1s8o1vf-ChartContainer efesc7i0"
+                className="css-1s8o1vf-ChartContainer efesc7i1"
               >
                 <Chart
                   noEvents={true}
@@ -342,9 +378,7 @@ exports[`ProjectCard renders 1`] = `
                   "isBookmarked": false,
                   "isMember": true,
                   "name": "Project Name",
-                  "platforms": Array [
-                    "javascript",
-                  ],
+                  "platform": "javascript",
                   "slug": "project-slug",
                   "stats": Array [
                     Array [
@@ -363,15 +397,13 @@ exports[`ProjectCard renders 1`] = `
               <NoDeploys>
                 <DeployBox
                   p={2}
-                  pb={0}
                 >
                   <Base
-                    className="css-tt0qjv-DeployBox eltxe6c5"
+                    className="css-1y6xtyw-DeployBox eltxe6c4"
                     p={2}
-                    pb={0}
                   >
                     <div
-                      className="css-tt0qjv-DeployBox eltxe6c5"
+                      className="css-1y6xtyw-DeployBox eltxe6c4"
                       is={null}
                     >
                       <Background
@@ -380,11 +412,11 @@ exports[`ProjectCard renders 1`] = `
                       >
                         <Base
                           align="center"
-                          className="css-itelel-Background eltxe6c6"
+                          className="css-itelel-Background eltxe6c5"
                           justify="center"
                         >
                           <div
-                            className="css-itelel-Background eltxe6c6"
+                            className="css-itelel-Background eltxe6c5"
                             is={null}
                           >
                             <Button
@@ -475,162 +507,6 @@ exports[`ProjectCard renders 1`] = `
                 </DeployBox>
               </NoDeploys>
             </Deploys>
-            <withRouter(PlatformList)
-              orgId="org-slug"
-              project={
-                Object {
-                  "hasAccess": true,
-                  "id": "2",
-                  "isBookmarked": false,
-                  "isMember": true,
-                  "name": "Project Name",
-                  "platforms": Array [
-                    "javascript",
-                  ],
-                  "slug": "project-slug",
-                  "stats": Array [
-                    Array [
-                      1525042800,
-                      1,
-                    ],
-                    Array [
-                      1525046400,
-                      2,
-                    ],
-                  ],
-                  "teams": Array [],
-                }
-              }
-            >
-              <PlatformList
-                location={
-                  Object {
-                    "query": Object {},
-                  }
-                }
-                orgId="org-slug"
-                project={
-                  Object {
-                    "hasAccess": true,
-                    "id": "2",
-                    "isBookmarked": false,
-                    "isMember": true,
-                    "name": "Project Name",
-                    "platforms": Array [
-                      "javascript",
-                    ],
-                    "slug": "project-slug",
-                    "stats": Array [
-                      Array [
-                        1525042800,
-                        1,
-                      ],
-                      Array [
-                        1525046400,
-                        2,
-                      ],
-                    ],
-                    "teams": Array [],
-                  }
-                }
-                router={
-                  Object {
-                    "createHref": [MockFunction] {
-                      "calls": Array [
-                        Array [
-                          "/org-slug/project-slug/",
-                        ],
-                      ],
-                    },
-                    "go": [MockFunction],
-                    "goBack": [MockFunction],
-                    "goForward": [MockFunction],
-                    "isActive": [MockFunction],
-                    "listen": [MockFunction],
-                    "location": Object {
-                      "query": Object {},
-                    },
-                    "push": [MockFunction],
-                    "replace": [MockFunction],
-                    "setRouteLeaveHook": [MockFunction],
-                  }
-                }
-              >
-                <Flex
-                  align="center"
-                >
-                  <Base
-                    align="center"
-                    className="css-5ipae5"
-                  >
-                    <div
-                      className="css-5ipae5"
-                      is={null}
-                    >
-                      <div
-                        className="org-dashboard-platform-list"
-                      >
-                        <Flex
-                          direction="row-reverse"
-                          p={2}
-                        >
-                          <Base
-                            className="css-1tznizk"
-                            direction="row-reverse"
-                            p={2}
-                          >
-                            <div
-                              className="css-1tznizk"
-                              is={null}
-                            >
-                              <StyledPlatformiconWrapper
-                                key="javascript"
-                              >
-                                <span
-                                  className="css-sxusd0-StyledPlatformiconWrapper e1mca4c60"
-                                >
-                                  <StyledPlatformicon
-                                    platform="javascript"
-                                    size="24"
-                                  >
-                                    <Platformicon
-                                      className="css-950w8s-StyledPlatformicon e1mca4c61"
-                                      platform="javascript"
-                                      size="24"
-                                    >
-                                      <img
-                                        className="css-950w8s-StyledPlatformicon e1mca4c61"
-                                        height="24"
-                                        src={
-                                          Object {
-                                            "default": Object {
-                                              "id": "test",
-                                              "viewBox": Object {},
-                                            },
-                                          }
-                                        }
-                                        width="24"
-                                      />
-                                    </Platformicon>
-                                  </StyledPlatformicon>
-                                </span>
-                              </StyledPlatformiconWrapper>
-                            </div>
-                          </Base>
-                        </Flex>
-                      </div>
-                      <PlatformText>
-                        <div
-                          className="css-1oyd7ep-PlatformText e1mca4c62"
-                        >
-                          javascript
-                        </div>
-                      </PlatformText>
-                    </div>
-                  </Base>
-                </Flex>
-              </PlatformList>
-            </withRouter(PlatformList)>
           </div>
         </StyledProjectCard>
       </div>
diff --git a/tests/js/spec/views/organizationDashboard/projectCard.spec.jsx b/tests/js/spec/views/organizationDashboard/projectCard.spec.jsx
index 1d4d97fdfe..f1ec2ddfd2 100644
--- a/tests/js/spec/views/organizationDashboard/projectCard.spec.jsx
+++ b/tests/js/spec/views/organizationDashboard/projectCard.spec.jsx
@@ -14,7 +14,7 @@ describe('ProjectCard', function() {
       <ProjectCard
         project={TestStubs.Project({
           stats: [[1525042800, 1], [1525046400, 2]],
-          platforms: ['javascript'],
+          platform: 'javascript',
         })}
         params={{orgId: 'org-slug'}}
       />,
@@ -24,7 +24,7 @@ describe('ProjectCard', function() {
     projectMock = MockApiClient.addMockResponse({
       url: '/projects/org-slug/project-slug/',
       method: 'PUT',
-      data: TestStubs.Project({isBookmarked: false, platforms: ['javascript']}),
+      data: TestStubs.Project({isBookmarked: false, platform: 'javascript'}),
     });
   });
 
@@ -74,7 +74,7 @@ describe('ProjectCard', function() {
       <ProjectCard
         project={TestStubs.Project({
           stats: [[1525042800, 1], [1525046400, 2]],
-          platforms: ['javascript'],
+          platform: 'javascript',
           latestDeploys,
         })}
         params={{orgId: 'org-slug'}}
@@ -93,11 +93,8 @@ describe('ProjectCard', function() {
     expect(wrapper.find('NoDeploys')).toHaveLength(1);
   });
 
-  it('renders with one platform', function() {
-    const platformList = wrapper.find('PlatformList');
-    expect(platformList.find('StyledPlatformicon[platform="javascript"]')).toHaveLength(
-      1
-    );
+  it('renders with platform', function() {
+    expect(wrapper.find('Platformicon[platform="javascript"]')).toHaveLength(1);
   });
 
   it('renders loading placeholder card if there are no stats', function() {
@@ -108,23 +105,4 @@ describe('ProjectCard', function() {
 
     expect(wrapper.find('LoadingCard')).toHaveLength(1);
   });
-
-  it('renders empty platform state if no event has ever been sent', function() {
-    wrapper = mount(
-      <ProjectCard
-        project={TestStubs.Project({
-          platforms: [],
-          firstEvent: null,
-          platform: 'csharp',
-          stats: [],
-        })}
-        params={{orgId: 'org-slug'}}
-      />,
-      TestStubs.routerContext()
-    );
-
-    expect(wrapper.find('NoEvents')).toHaveLength(1);
-    const button = wrapper.find('Button[children="Install an SDK"]');
-    expect(button.prop('to')).toBe('/org-slug/project-slug/getting-started/csharp/');
-  });
 });
