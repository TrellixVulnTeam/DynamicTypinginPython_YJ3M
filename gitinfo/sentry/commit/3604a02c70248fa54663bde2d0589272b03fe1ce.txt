commit 3604a02c70248fa54663bde2d0589272b03fe1ce
Author: mikellykels <kelly@sentry.io>
Date:   Thu Jun 21 11:51:09 2018 -0700

    fix(auditlog): Properly display org.restore in audit log (#8782)
    
    * fix(auditlog): Properly display org.restore in audit log
    
    This should now properly display in the audit log when an organization is restored.
    
    * fix snapshot

diff --git a/src/sentry/api/endpoints/organization_details.py b/src/sentry/api/endpoints/organization_details.py
index 3d3e6836d9..42e859dfbd 100644
--- a/src/sentry/api/endpoints/organization_details.py
+++ b/src/sentry/api/endpoints/organization_details.py
@@ -309,14 +309,6 @@ class OrganizationDetailsEndpoint(OrganizationEndpoint):
                         'model': Organization.__name__,
                     }
                 )
-            else:
-                self.create_audit_entry(
-                    request=request,
-                    organization=organization,
-                    target_object=organization.id,
-                    event=AuditLogEntryEvent.ORG_EDIT,
-                    data=changed_data
-                )
 
             return self.respond(
                 serialize(
diff --git a/src/sentry/static/sentry/app/views/settings/organizationAuditLog/index.jsx b/src/sentry/static/sentry/app/views/settings/organizationAuditLog/index.jsx
index f2522c0a61..9d45eb5698 100644
--- a/src/sentry/static/sentry/app/views/settings/organizationAuditLog/index.jsx
+++ b/src/sentry/static/sentry/app/views/settings/organizationAuditLog/index.jsx
@@ -25,6 +25,7 @@ const EVENT_TYPES = [
   'project.set-private',
   'org.create',
   'org.edit',
+  'org.restore',
   'org.remove',
   'tagkey.remove',
   'projectkey.create',
diff --git a/src/sentry/web/frontend/restore_organization.py b/src/sentry/web/frontend/restore_organization.py
index f4dda0723a..2db88aa870 100644
--- a/src/sentry/web/frontend/restore_organization.py
+++ b/src/sentry/web/frontend/restore_organization.py
@@ -8,7 +8,7 @@ from django.core.urlresolvers import reverse
 from django.utils.translation import ugettext_lazy as _
 
 from sentry.api import client
-from sentry.models import Organization, OrganizationStatus
+from sentry.models import AuditLogEntryEvent, Organization, OrganizationStatus
 from sentry.web.frontend.base import OrganizationView
 from sentry.web.helpers import render_to_response
 
@@ -72,4 +72,12 @@ class RestoreOrganizationView(OrganizationView):
                 'cancelDeletion': True,
             }, request=request)
             messages.add_message(request, messages.SUCCESS, MSG_RESTORE_SUCCESS)
+            if organization.status == OrganizationStatus.PENDING_DELETION:
+                self.create_audit_entry(
+                    request=request,
+                    organization=organization,
+                    target_object=organization.id,
+                    event=AuditLogEntryEvent.ORG_RESTORE,
+                    data=organization.get_audit_log_data(),
+                )
         return self.redirect(reverse('sentry-organization-home', args=[organization.slug]))
diff --git a/tests/js/spec/views/settings/__snapshots__/auditLogView.spec.jsx.snap b/tests/js/spec/views/settings/__snapshots__/auditLogView.spec.jsx.snap
index d40bb7a380..c5c9e32e4d 100644
--- a/tests/js/spec/views/settings/__snapshots__/auditLogView.spec.jsx.snap
+++ b/tests/js/spec/views/settings/__snapshots__/auditLogView.spec.jsx.snap
@@ -188,6 +188,7 @@ exports[`OrganizationAuditLog renders 1`] = `
         "org.create",
         "org.edit",
         "org.remove",
+        "org.restore",
         "project.create",
         "project.edit",
         "project.remove",
