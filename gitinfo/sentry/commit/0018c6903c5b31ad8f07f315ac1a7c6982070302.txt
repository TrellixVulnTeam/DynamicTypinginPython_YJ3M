commit 0018c6903c5b31ad8f07f315ac1a7c6982070302
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jan 28 23:21:50 2013 -0800

    Hide project cog if missing access

diff --git a/src/sentry/templates/sentry/layout.html b/src/sentry/templates/sentry/layout.html
index 4d07d10db6..dea0f5f01e 100644
--- a/src/sentry/templates/sentry/layout.html
+++ b/src/sentry/templates/sentry/layout.html
@@ -102,7 +102,7 @@
                                     {% endfor %}
                                 </select>
                             </li>
-                            {% if project %}
+                            {% if project and can_admin_team %}
                                 <li class="project-settings"><a href="{% url sentry-manage-project project.team.slug project.slug %}" class="{% trans "Settings" %}"><i aria-hidden="true" class="icon-cog"></i></a></li>
                             {% endif %}
                             {% block breadcrumb %}
diff --git a/src/sentry/web/helpers.py b/src/sentry/web/helpers.py
index b1fde57ab8..8deee81247 100644
--- a/src/sentry/web/helpers.py
+++ b/src/sentry/web/helpers.py
@@ -18,6 +18,7 @@ from django.utils.datastructures import SortedDict
 from django.utils.safestring import mark_safe
 
 from sentry.conf import settings
+from sentry.constants import MEMBER_OWNER
 from sentry.models import Project, Team, Option, ProjectOption, ProjectKey
 from sentry.permissions import can_create_projects, can_create_teams
 
@@ -126,6 +127,11 @@ def get_default_context(request, existing_context=None, team=None):
             'can_create_projects': can_create_projects(request.user),
             'can_create_teams': can_create_teams(request.user),
         })
+        if team:
+            context.update({
+                'can_admin_team': Team.objects.get_for_user(request.user, MEMBER_OWNER)
+            })
+
         if not existing_context or 'PROJECT_LIST' not in existing_context:
             if team:
                 context['PROJECT_LIST'] = Project.objects.filter(team=team)
