commit 93f04827dd8917c5404a21e6131053b23e0024d9
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Mon Sep 10 10:32:18 2018 -0700

    tests(js): Dynamically load fixtures (#9677)
    
    So we do not have to manually import every fixture. Currently does NOT support subdirectories.

diff --git a/tests/js/fixtures/health.js b/tests/js/fixtures/health.js
index 862d7c1426..44806676c0 100644
--- a/tests/js/fixtures/health.js
+++ b/tests/js/fixtures/health.js
@@ -6,7 +6,7 @@ const COUNT_OBJ = tag => ({
   },
 });
 
-export function Top(tag = 'release', params) {
+export function HealthTop(tag = 'release', params) {
   const countObject = COUNT_OBJ(tag);
   return {
     data: [countObject],
@@ -17,7 +17,7 @@ export function Top(tag = 'release', params) {
   };
 }
 
-export function Graph(tag = 'release', params) {
+export function HealthGraph(tag = 'release', params) {
   const countObject = COUNT_OBJ(tag);
 
   return {
diff --git a/tests/js/fixtures/release.js b/tests/js/fixtures/release.js
index 1babf79ea2..5e96a61b25 100644
--- a/tests/js/fixtures/release.js
+++ b/tests/js/fixtures/release.js
@@ -1,4 +1,4 @@
-export default function Release(params) {
+export function Release(params) {
   return {
     dateReleased: null,
     commitCount: null,
diff --git a/tests/js/fixtures/roleList.js b/tests/js/fixtures/roleList.js
index 3569f45111..f3d7f53647 100644
--- a/tests/js/fixtures/roleList.js
+++ b/tests/js/fixtures/roleList.js
@@ -1,4 +1,4 @@
-export default function RoleList(params = [], fullAccess = false) {
+export function RoleList(params = [], fullAccess = false) {
   return [
     {
       scopes: [
diff --git a/tests/js/setup.js b/tests/js/setup.js
index 968bf67747..6cd7a9c303 100644
--- a/tests/js/setup.js
+++ b/tests/js/setup.js
@@ -1,3 +1,7 @@
+/* global __dirname */
+/* eslint import/no-nodejs-modules:0 */
+import fs from 'fs';
+
 import {channel, createBroadcast} from 'emotion-theming';
 import jQuery from 'jquery';
 import sinon from 'sinon';
@@ -9,17 +13,6 @@ import PropTypes from 'prop-types';
 import ConfigStore from 'app/stores/configStore';
 import theme from 'app/utils/theme';
 
-import RoleList from './fixtures/roleList';
-import Release from './fixtures/release';
-import {AsanaPlugin, AsanaCreate, AsanaAutocomplete} from './fixtures/asana';
-import {Graph, Top} from './fixtures/health';
-import {
-  PhabricatorPlugin,
-  PhabricatorCreate,
-  PhabricatorAutocomplete,
-} from './fixtures/phabricator';
-import {VstsPlugin, VstsCreate} from './fixtures/vsts-old';
-
 jest.mock('lodash/debounce', () => jest.fn(fn => fn));
 jest.mock('app/utils/recreateRoute');
 jest.mock('app/translations');
@@ -86,6 +79,26 @@ window.scrollTo = jest.fn();
 // emotion context broadcast
 const broadcast = createBroadcast(theme);
 
+// Dynamically load fixtures
+const fixturesPath = `${__dirname}/fixtures`;
+const modules = fs
+  .readdirSync(fixturesPath)
+  .map(filename => require(`${fixturesPath}/${filename}`));
+
+modules.forEach(exports => {
+  if (Object.keys(exports).includes('default')) {
+    throw new Error('Javascript fixtures cannot use default export');
+  }
+});
+
+const fixtures = modules.reduce(
+  (acc, exports) => ({
+    ...acc,
+    ...exports,
+  }),
+  {}
+);
+
 window.TestStubs = {
   // react-router's 'router' context
   router: (params = {}) => ({
@@ -552,9 +565,6 @@ window.TestStubs = {
     };
   },
 
-  HealthGraph: Graph,
-  HealthTop: Top,
-
   JiraIntegrationProvider: params => {
     return {
       key: 'jira',
@@ -967,10 +977,6 @@ window.TestStubs = {
     };
   },
 
-  Release,
-
-  RoleList,
-
   Searches: params => [
     {
       name: 'Needs Triage',
@@ -1166,17 +1172,7 @@ window.TestStubs = {
     issue: TestStubs.Group(),
   }),
 
-  /**
-   * Plugins
-   */
-  AsanaPlugin,
-  AsanaCreate,
-  AsanaAutocomplete,
-  PhabricatorPlugin,
-  PhabricatorCreate,
-  PhabricatorAutocomplete,
-  VstsPlugin,
-  VstsCreate,
+  ...fixtures,
 };
 
 // this is very commonly used, so expose it globally
