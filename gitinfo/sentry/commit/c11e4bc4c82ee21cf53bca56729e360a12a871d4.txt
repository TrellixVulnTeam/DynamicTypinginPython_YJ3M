commit c11e4bc4c82ee21cf53bca56729e360a12a871d4
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Feb 13 21:12:38 2013 -0800

    Use shared helper for can_create_projects

diff --git a/src/sentry/web/frontend/teams.py b/src/sentry/web/frontend/teams.py
index 08a567c0bf..e26fb21341 100644
--- a/src/sentry/web/frontend/teams.py
+++ b/src/sentry/web/frontend/teams.py
@@ -35,7 +35,6 @@ def team_list(request):
 def render_with_team_context(team, template, context, request=None):
     context.update({
         'team': team,
-        'can_create_projects': can_create_projects(request.user, team),
         'SECTION': 'team',
     })
 
diff --git a/src/sentry/web/helpers.py b/src/sentry/web/helpers.py
index 808cd18733..b6d8b5576c 100644
--- a/src/sentry/web/helpers.py
+++ b/src/sentry/web/helpers.py
@@ -118,13 +118,15 @@ def get_default_context(request, existing_context=None, team=None):
     if request:
         context.update({
             'request': request,
-            'can_create_projects': can_create_projects(request.user),
             'can_create_teams': can_create_teams(request.user),
         })
         if team:
             context.update({
-                'can_admin_team': Team.objects.get_for_user(request.user, MEMBER_OWNER)
+                'can_admin_team': Team.objects.get_for_user(request.user, MEMBER_OWNER),
+                'can_create_projects': can_create_projects(request.user, team=team),
             })
+        else:
+            context['can_create_projects'] = can_create_projects(request.user)
 
         if not existing_context or 'PROJECT_LIST' not in existing_context:
             project_list = Project.objects.get_for_user(request.user, team=team)
