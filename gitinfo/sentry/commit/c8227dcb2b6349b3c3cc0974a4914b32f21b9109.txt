commit c8227dcb2b6349b3c3cc0974a4914b32f21b9109
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Sat May 6 00:59:59 2017 +0200

    Fixed VersionDSymFile associations
    
    This fixes SENTRY-34T

diff --git a/src/sentry/api/endpoints/dsym_files.py b/src/sentry/api/endpoints/dsym_files.py
index b3437b7f82..35ed2e21dd 100644
--- a/src/sentry/api/endpoints/dsym_files.py
+++ b/src/sentry/api/endpoints/dsym_files.py
@@ -139,9 +139,9 @@ class AssociateDSymFilesEndpoint(ProjectEndpoint):
         for dsym_file in dsym_files:
             version_dsym_file, created = VersionDSymFile.objects.get_or_create(
                 dsym_file=dsym_file,
-                dsym_app=dsym_app,
                 version=data['version'],
                 build=data['build'],
+                defaults=dict(dsym_app=dsym_app),
             )
             if created:
                 associated.append(dsym_file)
diff --git a/src/sentry/lang/native/plugin.py b/src/sentry/lang/native/plugin.py
index e59deb58fb..8d38e2faef 100644
--- a/src/sentry/lang/native/plugin.py
+++ b/src/sentry/lang/native/plugin.py
@@ -464,9 +464,9 @@ class NativeStacktraceProcessor(StacktraceProcessor):
                     with transaction.atomic():
                         version_dsym_file, created = VersionDSymFile.objects.get_or_create(
                             dsym_file=dsym_file,
-                            dsym_app=dsym_app,
                             version=app_info.version,
                             build=app_info.build,
+                            defaults=dict(dsym_app=dsym_app),
                         )
                 except IntegrityError:
                     # XXX: this can currently happen because we only
