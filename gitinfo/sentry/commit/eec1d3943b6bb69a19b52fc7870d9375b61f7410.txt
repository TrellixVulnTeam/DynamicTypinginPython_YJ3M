commit eec1d3943b6bb69a19b52fc7870d9375b61f7410
Author: Tobias von Klipstein <tobias@uxebu.com>
Date:   Wed Sep 15 21:20:22 2010 +0200

    fixed my previous commit (it's a dict not an object)

diff --git a/sentry/management/commands/cleanup_sentry.py b/sentry/management/commands/cleanup_sentry.py
index c99f624297..b7d1a7ba69 100644
--- a/sentry/management/commands/cleanup_sentry.py
+++ b/sentry/management/commands/cleanup_sentry.py
@@ -15,11 +15,14 @@ class Command(BaseCommand):
     help = 'Cleans up old entries in the log.'
 
     def handle(self, *args, **options):
-        ts = datetime.datetime.now() - datetime.timedelta(days=int(getattr(options, 'days', 30)))
+        days = 30
+        if options.get('days'): # options always contain the days key
+            days = int(options['days'])
+        ts = datetime.datetime.now() - datetime.timedelta(days=days)
         
         base_kwargs = {}
         if options.get('logger'):
             base_kwargs['logger'] = options['logger']
         
         GroupedMessage.objects.filter(last_seen__lte=ts, **base_kwargs).delete()
-        Message.objects.filter(datetime__lte=ts, **base_kwargs).delete()
\ No newline at end of file
+        Message.objects.filter(datetime__lte=ts, **base_kwargs).delete()
