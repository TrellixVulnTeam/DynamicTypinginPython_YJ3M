commit b63037aa7df8bac03d111d275f3f587d55aded10
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 1 10:17:59 2014 -0800

    Expand org member tests

diff --git a/tests/sentry/web/frontend/test_create_organization_member.py b/tests/sentry/web/frontend/test_create_organization_member.py
index 14475989f0..aa67183dde 100644
--- a/tests/sentry/web/frontend/test_create_organization_member.py
+++ b/tests/sentry/web/frontend/test_create_organization_member.py
@@ -1,5 +1,6 @@
 from __future__ import absolute_import
 
+from django.core import mail
 from django.core.urlresolvers import reverse
 
 from sentry.models import OrganizationMember, OrganizationMemberType
@@ -18,7 +19,7 @@ class CreateOrganizationMemberTest(TestCase):
         assert resp.context['form']
 
     def test_valid_for_invites(self):
-        organization = self.create_organization()
+        organization = self.create_organization(name='Default')
         path = reverse('sentry-create-organization-member', args=[organization.id])
         self.login_as(self.user)
 
@@ -40,6 +41,10 @@ class CreateOrganizationMemberTest(TestCase):
         redirect_uri = reverse('sentry-organization-member-settings', args=[organization.id, member.id])
         assert resp['Location'] == 'http://testserver' + redirect_uri
 
+        assert len(mail.outbox) == 1
+        assert mail.outbox[0].to == ['foo@example.com']
+        assert mail.outbox[0].subject == 'Invite to join organization: Default'
+
     def test_existing_user_for_invite(self):
         organization = self.create_organization()
         path = reverse('sentry-create-organization-member', args=[organization.id])
diff --git a/tests/sentry/web/frontend/test_organization_member_settings.py b/tests/sentry/web/frontend/test_organization_member_settings.py
index 629be94793..7b8bc44339 100644
--- a/tests/sentry/web/frontend/test_organization_member_settings.py
+++ b/tests/sentry/web/frontend/test_organization_member_settings.py
@@ -1,5 +1,6 @@
 from __future__ import absolute_import
 
+from django.core import mail
 from django.core.urlresolvers import reverse
 
 from sentry.models import (
@@ -126,3 +127,31 @@ class OrganizationMemberSettingsTest(TestCase):
         assert ale.target_object == member.id
         assert ale.target_user == user
         assert ale.data
+
+    def test_reinvite(self):
+        organization = self.create_organization(name='foo', owner=self.user)
+        team_1 = self.create_team(name='foo', organization=organization)
+        team_2 = self.create_team(name='bar', organization=organization)
+
+        user = self.create_user('bar@example.com')
+        member = OrganizationMember.objects.create(
+            organization=organization,
+            email='bar@example.com',
+        )
+
+        path = reverse('sentry-organization-member-settings',
+                       args=[organization.id, member.id])
+
+        self.login_as(self.user)
+
+        resp = self.client.post(path, {
+            'op': 'reinvite',
+            'teams': [team_1.id, team_2.id],
+            'type': OrganizationMemberType.ADMIN,
+        })
+
+        assert resp.status_code == 302
+
+        assert len(mail.outbox) == 1
+        assert mail.outbox[0].to == ['bar@example.com']
+        assert mail.outbox[0].subject == 'Invite to join organization: foo'
