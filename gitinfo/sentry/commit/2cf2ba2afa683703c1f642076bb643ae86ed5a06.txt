commit 2cf2ba2afa683703c1f642076bb643ae86ed5a06
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Dec 2 12:45:34 2012 -0800

    Correct tests for changes in default public state

diff --git a/tests/sentry/web/api/tests.py b/tests/sentry/web/api/tests.py
index 875b30669f..7c7baeb54f 100644
--- a/tests/sentry/web/api/tests.py
+++ b/tests/sentry/web/api/tests.py
@@ -54,7 +54,7 @@ class StoreViewTest(TestCase):
 class CrossDomainXmlTest(TestCase):
     @fixture
     def project(self):
-        return Project.objects.create(name='foo', slug='foo')
+        return Project.objects.create(name='foo', slug='foo', public=True)
 
     @fixture
     def path(self):
diff --git a/tests/sentry/web/frontend/tests.py b/tests/sentry/web/frontend/tests.py
index 67bfcc1f62..3403516558 100644
--- a/tests/sentry/web/frontend/tests.py
+++ b/tests/sentry/web/frontend/tests.py
@@ -415,6 +415,20 @@ class RemoveTeamMemberTest(PermissionBase):
 
 
 class SentrySearchTest(TestCase):
+    def setUp(self):
+        self.client.login(username=self.user.username, password='password')
+
+    @fixture
+    def user(self):
+        user = User(username="admin", email="admin@localhost", is_staff=True, is_superuser=True)
+        user.set_password('password')
+        user.save()
+        return user
+
+    @fixture
+    def path(self):
+        return reverse('sentry-search', kwargs={'project_id': 1})
+
     def test_checksum_query(self):
         checksum = 'a' * 32
         g = Group.objects.create(
@@ -425,10 +439,9 @@ class SentrySearchTest(TestCase):
             message='hi',
         )
 
-        with self.Settings(SENTRY_PUBLIC=True):
-            response = self.client.get(reverse('sentry-search', kwargs={'project_id': 1}), {'q': '%s$%s' % (checksum, checksum)})
-            self.assertEquals(response.status_code, 302)
-            self.assertEquals(response['Location'], 'http://testserver%s' % (g.get_absolute_url(),))
+        response = self.client.get(self.path, {'q': '%s$%s' % (checksum, checksum)})
+        self.assertEquals(response.status_code, 302)
+        self.assertEquals(response['Location'], 'http://testserver%s' % (g.get_absolute_url(),))
 
     def test_dupe_checksum(self):
         checksum = 'a' * 32
@@ -447,8 +460,8 @@ class SentrySearchTest(TestCase):
             message='hi',
         )
 
-        with self.Settings(SENTRY_PUBLIC=True, SENTRY_USE_SEARCH=False):
-            response = self.client.get(reverse('sentry-search', kwargs={'project_id': 1}), {'q': '%s$%s' % (checksum, checksum)})
+        with self.Settings(SENTRY_USE_SEARCH=False):
+            response = self.client.get(self.path, {'q': '%s$%s' % (checksum, checksum)})
             self.assertEquals(response.status_code, 200)
             self.assertTemplateUsed(response, 'sentry/search.html')
             context = response.context
diff --git a/tests/sentry/web/helpers/tests.py b/tests/sentry/web/helpers/tests.py
index 3a712af9ad..d71d911ab9 100644
--- a/tests/sentry/web/helpers/tests.py
+++ b/tests/sentry/web/helpers/tests.py
@@ -16,7 +16,7 @@ class GetProjectListTEst(TestCase):
     def setUp(self):
         self.user = User.objects.create(username="admin", email="admin@localhost")
         self.project = Project.objects.get()
-        assert self.project.public is True
+        self.project.update(public=True)
         self.project2 = Project.objects.create(name='Test', slug='test', owner=self.user, public=False)
 
     @mock.patch('sentry.models.Team.objects.get_for_user', mock.Mock(return_value={}))
