commit a571e5539c89e7f5b815df40cc51520c38eeb670
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jul 15 11:03:28 2013 -0700

    Correct user return value

diff --git a/src/sentry/utils/social_auth.py b/src/sentry/utils/social_auth.py
index 52d13e4591..233a143743 100644
--- a/src/sentry/utils/social_auth.py
+++ b/src/sentry/utils/social_auth.py
@@ -24,8 +24,8 @@ def create_user_if_enabled(*args, **kwargs):
     """
     if not settings.SOCIAL_AUTH_CREATE_USERS:
         user = kwargs.get('user')
-        if not user:
-            raise AuthNotAllowed('You must create an account before associating an identity.')
-        return user
+        if user:
+            return {'user': user}
+        raise AuthNotAllowed('You must create an account before associating an identity.')
 
     return create_user(*args, **kwargs)
