commit 5d54ae59cca3cff544590e9f8bf063d0c1101946
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jan 10 15:45:11 2012 -0800

    Several JS fixes including resolve feed and polling

diff --git a/sentry/static/scripts/global.js b/sentry/static/scripts/global.js
index e2e573c82b..201c7c86f1 100644
--- a/sentry/static/scripts/global.js
+++ b/sentry/static/scripts/global.js
@@ -88,7 +88,6 @@ if (Sentry === undefined) {
                     return;
                 }
                 var $el = $(el);
-                console.log($el);
                 if (data.bookmarked) {
                     $el.addClass('checked');
                 } else {
@@ -112,17 +111,27 @@ if (Sentry === undefined) {
 
     Sentry.realtime.status = false;
 
+    Sentry.realtime.toggle = function(){
+        if (Sentry.realtime.status) {
+            Sentry.realtime.enable();
+        } else {
+            Sentry.realtime.disable();
+        }
+    };
+
     Sentry.realtime.enable = function(){
-        $('#sentry_realtime').removeClass('realtime-play');
-        $('#sentry_realtime').addClass('realtime-pause');
-        $('#sentry_realtime').text('Pause Feed');
+        var $el = $('#sentry_realtime');
+        $el.removeClass('realtime-play');
+        $el.addClass('realtime-pause');
+        $el.text('Pause Feed');
         Sentry.realtime.status = true;
     };
 
     Sentry.realtime.disable = function(){
-        $('#sentry_realtime').addClass('realtime-play');
-        $('#sentry_realtime').removeClass('realtime-pause');
-        $('#sentry_realtime').text('Go Live');
+        var $el = $('#sentry_realtime');
+        $el.addClass('realtime-play');
+        $el.removeClass('realtime-pause');
+        $el.text('Go Live');
         Sentry.realtime.status = false;
     };
 
@@ -151,17 +160,16 @@ if (Sentry === undefined) {
                         level: data.level,
                         logger: data.logger
                     });
-                    if ((row = $('#group_' + id))) {
-                        // TODO: move this to the correct position
-                        //row.remove();
-                        //$('#event_list').prepend(data.html);
+                    if ((row = $('#group_' + id)).length) {
                         if (row.attr('data-sentry-count') != data.count) {
+                            row.attr('data-sentry-count', data.count);
+                            row.find('.count').html(data.count);
                             $('#group_' + id).addClass('fresh');
                         }
                     } else {
                         $('#event_list').prepend(data.html);
                         $('#group_' + id).addClass('fresh');
-                        Sentry.notifications.show({'type': 'html', 'url': url});
+                        //Sentry.notifications.show({'type': 'html', 'url': url});
                     }
                 }
                 $('#event_list .fresh').css('background-color', '#ccc').animate({backgroundColor: '#fff'}, 1200, function() {
diff --git a/sentry/templates/sentry/groups/group_list.html b/sentry/templates/sentry/groups/group_list.html
index 863672f283..93211605f9 100644
--- a/sentry/templates/sentry/groups/group_list.html
+++ b/sentry/templates/sentry/groups/group_list.html
@@ -90,10 +90,10 @@
             </ul>
         </li>
         <li class="pull-right">
-            <a href="javascript:void(0)" onclick="Sentry.stream.clear();">{% trans "Resolve Feed" %}</a>
+            <a href="javascript:void(0)" onclick="Sentry.stream.clear({{ project.id }});">{% trans "Resolve Feed" %}</a>
         </li>
         <li class="pull-right">
-            <a href="javascript:void(0)" id="sentry_realtime" class="realtime-play" onclick="Sentry.realtime.pause();">{% trans "Pause Feed" %}</a>
+            <a href="javascript:void(0)" id="sentry_realtime" class="realtime-play" onclick="Sentry.realtime.toggle();">{% trans "Pause Feed" %}</a>
         </li>
     </ul>
 
