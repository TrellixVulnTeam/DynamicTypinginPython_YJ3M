commit 315e00d34c43a6365e2d58a804b4dcd951c744e5
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Mon Jul 9 12:11:18 2018 -0700

    fix(discover): Fix placeholder rendering for conditions and aggregations (#8982)
    
    The placeholder text 'Select...' was not being correctly rendered on the
    conditions and aggregations dropdowns

diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/aggregation.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/aggregation.jsx
index 9b3137337a..5e3116cf69 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/aggregation.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/aggregations/aggregation.jsx
@@ -22,7 +22,8 @@ export default class Aggregation extends React.Component {
 
   getOptions() {
     const currentValue = getInternal(this.props.value);
-    return [{label: currentValue, value: currentValue}];
+    const shouldDisplayValue = currentValue || this.state.selectedFunction;
+    return shouldDisplayValue ? [{label: currentValue, value: currentValue}] : [];
   }
 
   filterOptions = (_options, input, _value) => {
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/conditions/condition.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/conditions/condition.jsx
index 27c20d3777..f261525ffb 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/conditions/condition.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/conditions/condition.jsx
@@ -51,7 +51,8 @@ export default class Condition extends React.Component {
 
   getOptions() {
     const currentValue = getInternal(this.props.value);
-    return [{label: currentValue, value: currentValue}];
+    const shouldDisplayValue = currentValue || this.state.selectedColumn;
+    return shouldDisplayValue ? [{label: currentValue, value: currentValue}] : [];
   }
 
   getConditionsForColumn(colName) {
diff --git a/tests/js/spec/views/organizationDiscover/aggregations/aggregation.spec.jsx b/tests/js/spec/views/organizationDiscover/aggregations/aggregation.spec.jsx
index 47dca8b104..7150a3ad59 100644
--- a/tests/js/spec/views/organizationDiscover/aggregations/aggregation.spec.jsx
+++ b/tests/js/spec/views/organizationDiscover/aggregations/aggregation.spec.jsx
@@ -7,7 +7,7 @@ describe('Aggregation', function() {
   describe('render()', function() {
     it('renders empty, count, topK, uniq and avg', function() {
       const data = [
-        {value: [null, null, null], expectedTextValue: ''},
+        {value: [null, null, null], expectedTextValue: 'Select...'},
         {value: ['count', null, 'count'], expectedTextValue: 'count'},
         {
           value: ['uniq', 'environment', 'uniq_environment'],
diff --git a/tests/js/spec/views/organizationDiscover/conditions/condition.spec.jsx b/tests/js/spec/views/organizationDiscover/conditions/condition.spec.jsx
index 8fcca95312..c031ff32e8 100644
--- a/tests/js/spec/views/organizationDiscover/conditions/condition.spec.jsx
+++ b/tests/js/spec/views/organizationDiscover/conditions/condition.spec.jsx
@@ -6,7 +6,8 @@ import Condition from 'app/views/organizationDiscover/conditions/condition';
 describe('Condition', function() {
   describe('render()', function() {
     it('renders text', function() {
-      const conditionsList = [
+      const data = [
+        {value: [null, null, null], expectedText: 'Select...'},
         {value: ['device_name', '=', 'test'], expectedText: 'device_name = test'},
         {value: ['device_name', 'IS NULL', null], expectedText: 'device_name IS NULL'},
         {
@@ -14,7 +15,7 @@ describe('Condition', function() {
           expectedText: 'device_battery_level > 5',
         },
       ];
-      conditionsList.forEach(function(condition) {
+      data.forEach(function(condition) {
         const wrapper = mount(
           <Condition value={condition.value} onChange={jest.fn()} columns={[]} />
         );
