commit 3e7de710e0b527cfd13697b9733d46d525babfbe
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Oct 5 02:19:40 2015 -0700

    Enforce ident/username as strings

diff --git a/src/sentry/interfaces/user.py b/src/sentry/interfaces/user.py
index 3116bf8a90..d5e053d2e0 100644
--- a/src/sentry/interfaces/user.py
+++ b/src/sentry/interfaces/user.py
@@ -63,8 +63,12 @@ class User(Interface):
             extra_data = {}
 
         ident = trim(data.pop('id', None), 128)
+        if ident:
+            ident = unicode(ident)
         email = trim(validate_email(data.pop('email', None), False), 128)
         username = trim(data.pop('username', None), 128)
+        if username:
+            username = unicode(username)
         ip_address = validate_ip(data.pop('ip_address', None), False)
 
         # TODO(dcramer): patch in fix to deal w/ old data but not allow new
diff --git a/src/sentry/tasks/post_process.py b/src/sentry/tasks/post_process.py
index fd9b239e4b..b4d482720a 100644
--- a/src/sentry/tasks/post_process.py
+++ b/src/sentry/tasks/post_process.py
@@ -102,7 +102,7 @@ def record_affected_user(event, **kwargs):
 
     euser = EventUser(
         project=event.project,
-        ident=unicode(user_data.get('id')) if user_data.get('id') else None,
+        ident=user_data.get('id'),
         email=user_data.get('email'),
         username=user_data.get('username'),
         ip_address=user_data.get('ip_address'),
