commit 03e4dcc544192e12aa55547d4cc2e8cd4b237290
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Aug 4 14:47:18 2013 -0700

    Revert "Remove logger injection"
    
    This reverts commit 129ca03b07e02e0053072e83df3591e0ca864815.

diff --git a/src/sentry/tasks/fetch_source.py b/src/sentry/tasks/fetch_source.py
index a9e5fb6347..cfe4523187 100644
--- a/src/sentry/tasks/fetch_source.py
+++ b/src/sentry/tasks/fetch_source.py
@@ -79,7 +79,7 @@ def discover_sourcemap(result):
     return map_path
 
 
-def fetch_url_content(url):
+def fetch_url_content(url, logger=None):
     """
     Pull down a URL, returning a tuple (url, headers, body).
     """
@@ -98,12 +98,14 @@ def fetch_url_content(url):
             body = zlib.decompress(body, 16 + zlib.MAX_WBITS)
         body = body.rstrip('\n')
     except Exception:
+        if logger:
+            logger.error('Unable to fetch remote source for %r', url, exc_info=True)
         return BAD_SOURCE
 
     return (url, headers, body)
 
 
-def fetch_url(url):
+def fetch_url(url, logger=None):
     """
     Pull down a URL, returning a UrlResult object.
 
@@ -114,7 +116,7 @@ def fetch_url(url):
         hashlib.md5(url.encode('utf-8')).hexdigest(),)
     result = cache.get(cache_key)
     if result is None:
-        result = fetch_url_content(url)
+        result = fetch_url_content(url, logger)
 
         cache.set(cache_key, result, 60 * 5)
 
@@ -124,8 +126,8 @@ def fetch_url(url):
     return UrlResult(*result)
 
 
-def fetch_sourcemap(url):
-    result = fetch_url(url)
+def fetch_sourcemap(url, logger=None):
+    result = fetch_url(url, logger=logger)
     if result == BAD_SOURCE:
         return
 
@@ -227,7 +229,7 @@ def expand_javascript_source(data, **kwargs):
             logger.debug('No sourcemap found for %r', filename)
             continue
 
-        index = fetch_sourcemap(map_path)
+        index = fetch_sourcemap(map_path, logger=logger)
         if not index:
             sourcemap_idxs[sourcemap] = None
             continue
