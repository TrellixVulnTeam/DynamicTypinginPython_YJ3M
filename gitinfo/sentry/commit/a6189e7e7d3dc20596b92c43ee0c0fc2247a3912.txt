commit a6189e7e7d3dc20596b92c43ee0c0fc2247a3912
Author: ted kaemming <ted@kaemming.com>
Date:   Wed Nov 14 15:36:37 2018 -0800

    fix(search): Use subselect to avoid sequence scanning GroupAssignee (#10598)

diff --git a/src/sentry/search/django/backend.py b/src/sentry/search/django/backend.py
index 30b4698396..44681ce2d1 100644
--- a/src/sentry/search/django/backend.py
+++ b/src/sentry/search/django/backend.py
@@ -210,7 +210,7 @@ class DjangoSearchBackend(SearchBackend):
     def query(self, project, tags=None, environment=None, sort_by='date', limit=100,
               cursor=None, count_hits=False, paginator_options=None, **parameters):
 
-        from sentry.models import Group, GroupStatus, GroupSubscription, Release
+        from sentry.models import Group, GroupAssignee, GroupStatus, GroupSubscription, Release
 
         if paginator_options is None:
             paginator_options = {}
@@ -247,8 +247,10 @@ class DjangoSearchBackend(SearchBackend):
                 functools.partial(assigned_to_filter, project=project),
             ),
             'unassigned': CallbackCondition(
-                lambda queryset, unassigned: queryset.filter(
-                    assignee_set__isnull=unassigned,
+                lambda queryset, unassigned: (queryset.exclude if unassigned else queryset.filter)(
+                    id__in=GroupAssignee.objects.filter(
+                        project_id=project.id,
+                    ).values_list('group_id', flat=True),
                 ),
             ),
             'subscribed_by': CallbackCondition(
