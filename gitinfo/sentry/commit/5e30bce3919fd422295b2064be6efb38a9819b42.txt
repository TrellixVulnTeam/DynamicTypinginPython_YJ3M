commit 5e30bce3919fd422295b2064be6efb38a9819b42
Author: Stephen Cefali <scefali@sentry.io>
Date:   Mon May 18 14:21:07 2020 -0700

    check for org before analytics event (#18891)

diff --git a/src/sentry/pipeline/__init__.py b/src/sentry/pipeline/__init__.py
index a47c8595af..8aeba1c4c5 100644
--- a/src/sentry/pipeline/__init__.py
+++ b/src/sentry/pipeline/__init__.py
@@ -233,14 +233,15 @@ class Pipeline(object):
         Render the next step.
         """
         self.state.step_index += step_size
-        analytics.record(
-            "integrations.pipeline_step",
-            user_id=self.request.user.id,
-            organization_id=self.organization.id,
-            integration=self.provider.key,
-            step_index=self.state.step_index,
-            pipeline_type="reauth" if self.fetch_state("integration_id") else "install",
-        )
+        if self.organization:
+            analytics.record(
+                "integrations.pipeline_step",
+                user_id=self.request.user.id,
+                organization_id=self.organization.id,
+                integration=self.provider.key,
+                step_index=self.state.step_index,
+                pipeline_type="reauth" if self.fetch_state("integration_id") else "install",
+            )
         return self.current_step()
 
     def finish_pipeline(self):
