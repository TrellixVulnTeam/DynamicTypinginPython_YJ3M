commit 9398f6abb0412dbdc0c5deed01bc7c2ff5dc3d4e
Author: Zygmunt Krynicki <zyga@fx.(none)>
Date:   Wed Mar 7 18:15:10 2012 +0100

    Fix Interface.__setstate__() to set args
    
    __setstate__() is called when deserializing objects with pickle.
    Since this path is never invoking __init__() args would be left unset.

diff --git a/sentry/interfaces.py b/sentry/interfaces.py
index 30a5a112f4..473ad0ab7c 100644
--- a/sentry/interfaces.py
+++ b/sentry/interfaces.py
@@ -67,7 +67,9 @@ class Interface(object):
         self.__dict__.update(kwargs)
 
     def __setstate__(self, data):
-        self.__dict__.update(self.unserialize(data))
+        kwargs = self.unserialize(data)
+        self.attrs = kwargs.keys()
+        self.__dict__.update(kwargs)
 
     def __getstate__(self):
         return self.serialize()
diff --git a/tests/sentry/interfaces/__init__.py b/tests/sentry/interfaces/__init__.py
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/tests/sentry/interfaces/tests.py b/tests/sentry/interfaces/tests.py
new file mode 100644
index 0000000000..4c32888d82
--- /dev/null
+++ b/tests/sentry/interfaces/tests.py
@@ -0,0 +1,21 @@
+# -*- coding: utf-8 -*-
+
+from __future__ import absolute_import
+
+import pickle
+
+from sentry.interfaces import Interface
+
+from tests.base import TestCase
+
+
+class InterfaceTests(TestCase):
+
+    def test_init_sets_attrs(self):
+        obj = Interface(foo=1)
+        self.assertEqual(obj.attrs, ['foo'])
+
+    def test_setstate_sets_attrs(self):
+        data = pickle.dumps(Interface(foo=1))
+        obj = pickle.loads(data)
+        self.assertEqual(obj.attrs, ['foo'])
