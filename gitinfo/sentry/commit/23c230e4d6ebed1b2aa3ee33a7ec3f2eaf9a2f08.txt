commit 23c230e4d6ebed1b2aa3ee33a7ec3f2eaf9a2f08
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jul 22 17:42:22 2015 +0200

    Allow status checks in health endpoint

diff --git a/src/sentry/conf/urls.py b/src/sentry/conf/urls.py
index 7ba489766a..504943802c 100644
--- a/src/sentry/conf/urls.py
+++ b/src/sentry/conf/urls.py
@@ -20,6 +20,8 @@ from django.contrib import admin
 from django.views.defaults import page_not_found
 from django.http import HttpResponse
 
+from sentry import status_checks
+from sentry.utils import json
 from sentry.web.urls import urlpatterns as web_urlpatterns
 from sentry.web.frontend.csrf_failure import CsrfFailureView
 from sentry.web.frontend.error_500 import Error500View
@@ -32,6 +34,13 @@ handler500 = Error500View.as_view()
 
 
 def handler_healthcheck(request):
+    if request.GET.get('full'):
+
+        problems = status_checks.check_all()
+        if problems:
+            return HttpResponse(json.dumps({
+                'problems': map(unicode, problems),
+            }), content_type='application/json', status=500)
     return HttpResponse('ok')
 
 
