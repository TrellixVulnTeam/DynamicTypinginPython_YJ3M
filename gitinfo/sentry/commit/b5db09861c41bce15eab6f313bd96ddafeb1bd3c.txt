commit b5db09861c41bce15eab6f313bd96ddafeb1bd3c
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Dec 24 11:32:12 2014 -0800

    Ensure correct autocommit defaults

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 6c3cd60a64..725777600c 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -53,6 +53,7 @@ DATABASES = {
         'PASSWORD': '',
         'HOST': '',
         'PORT': '',
+        'AUTOCOMMIT': True,
     }
 }
 
diff --git a/src/sentry/migrations/0143_fill_project_orgs.py b/src/sentry/migrations/0143_fill_project_orgs.py
index c6e08c9684..a860bbc971 100644
--- a/src/sentry/migrations/0143_fill_project_orgs.py
+++ b/src/sentry/migrations/0143_fill_project_orgs.py
@@ -6,7 +6,6 @@ from django.db import IntegrityError, models, transaction
 
 class Migration(DataMigration):
 
-    @transaction.autocommit
     def forwards(self, orm):
         from sentry.constants import RESERVED_ORGANIZATION_SLUGS
         from sentry.db.models.utils import slugify_instance
@@ -21,18 +20,15 @@ class Migration(DataMigration):
         for project in RangeQuerySetWrapperWithProgressBar(queryset):
             project.organization = project.team.organization
 
-            sid = transaction.savepoint()
             try:
-                project.save()
+                with transaction.atomic():
+                    project.save()
             except IntegrityError:
-                transaction.savepoint_rollback(sid)
                 # we also need to update the slug here based on the new constraints
                 slugify_instance(project, project.name, (
                     models.Q(organization=project.organization) | models.Q(team=project.team),
                 ))
                 project.save()
-            else:
-                transaction.savepoint_commit(sid)
 
     def backwards(self, orm):
         pass
