commit 8d05a927d3a0a00b643f632b2d49aff1a85dbf86
Author: MeredithAnya <meredith.a.heller@gmail.com>
Date:   Tue Aug 28 09:35:47 2018 -0700

    ref(integrations): Validate GitHub repo (#9531)
    
    * ref(integrations): Validate GitHub repo

diff --git a/src/sentry/integrations/github/client.py b/src/sentry/integrations/github/client.py
index 278eff3db6..5da2d35561 100644
--- a/src/sentry/integrations/github/client.py
+++ b/src/sentry/integrations/github/client.py
@@ -42,6 +42,9 @@ class GitHubClientMixin(ApiClient):
             num
         ))
 
+    def repo_hooks(self, repo):
+        return self.get('/repos/{}/hooks'.format(repo))
+
     def get_commits(self, repo):
         return self.get('/repos/{}/commits'.format(repo))
 
diff --git a/src/sentry/integrations/github/repository.py b/src/sentry/integrations/github/repository.py
index a6a54ddaf8..d050a8832e 100644
--- a/src/sentry/integrations/github/repository.py
+++ b/src/sentry/integrations/github/repository.py
@@ -3,6 +3,7 @@ from __future__ import absolute_import
 import logging
 import six
 
+from sentry.integrations.exceptions import ApiError, IntegrationError
 from sentry.models import Integration
 from sentry.plugins import providers
 
@@ -22,9 +23,9 @@ class GitHubRepositoryProvider(providers.IntegrationRepositoryProvider):
 
         try:
             # make sure installation has access to this specific repo
-            client.get_commits(repo)
-        except Exception as e:
-            installation.raise_error(e)
+            client.repo_hooks(repo)
+        except ApiError as e:
+            raise IntegrationError('You must grant Sentry access to {}'.format(repo))
 
         return repo_data
 
diff --git a/src/sentry/static/sentry/app/views/organizationIntegrations/integrationRepos.jsx b/src/sentry/static/sentry/app/views/organizationIntegrations/integrationRepos.jsx
index 3c710df368..f5397d55be 100644
--- a/src/sentry/static/sentry/app/views/organizationIntegrations/integrationRepos.jsx
+++ b/src/sentry/static/sentry/app/views/organizationIntegrations/integrationRepos.jsx
@@ -117,7 +117,12 @@ export default class IntegrationRepos extends AsyncComponent {
           })
         );
       },
-      error: () => IndicatorStore.addError(t('Unable to add repository.')),
+      error: data => {
+        let text = data.responseJSON.errors
+          ? data.responseJSON.errors.__all__
+          : t('Unable to add repository.');
+        IndicatorStore.addError(text);
+      },
       complete: () => {
         IndicatorStore.remove(saveIndicator);
         this.setState({adding: false});
