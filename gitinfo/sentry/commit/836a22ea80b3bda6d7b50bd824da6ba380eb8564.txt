commit 836a22ea80b3bda6d7b50bd824da6ba380eb8564
Author: Mark Story <mark@sentry.io>
Date:   Thu Sep 6 20:59:07 2018 -0400

    feat(auth) Fix up lint errors and review feedback

diff --git a/src/sentry/static/sentry/app/views/settings/account/accountSecurity/index.jsx b/src/sentry/static/sentry/app/views/settings/account/accountSecurity/index.jsx
index 0d7348ee0e..77892368ef 100644
--- a/src/sentry/static/sentry/app/views/settings/account/accountSecurity/index.jsx
+++ b/src/sentry/static/sentry/app/views/settings/account/accountSecurity/index.jsx
@@ -11,9 +11,8 @@ import AsyncView from 'app/views/asyncView';
 import Button from 'app/components/button';
 import CircleIndicator from 'app/components/circleIndicator';
 import EmptyMessage from 'app/views/settings/components/emptyMessage';
+import Field from 'app/views/settings/components/forms/field';
 import ListLink from 'app/components/listLink';
-import FieldLabel from 'app/views/settings/components/forms/field/fieldLabel.jsx';
-import FieldHelp from 'app/views/settings/components/forms/field/fieldHelp.jsx';
 import {Panel, PanelBody, PanelHeader, PanelItem} from 'app/components/panels';
 import SettingsPageHeader from 'app/views/settings/components/settingsPageHeader';
 import TextBlock from 'app/views/settings/components/text/textBlock';
@@ -27,7 +26,6 @@ const AuthenticatorName = styled.span`
   font-size: 1.2em;
 `;
 
-
 class AccountSecurity extends AsyncView {
   static PropTypes = {
     authenticators: PropTypes.arrayOf(PropTypes.object).isRequired,
@@ -50,8 +48,8 @@ class AccountSecurity extends AsyncView {
       method: 'DELETE',
       data: {all: true},
       success: () => {
-        window.location = '/auth/login'
-      }
+        window.location = '/auth/login/';
+      },
     });
   };
 
@@ -84,17 +82,18 @@ class AccountSecurity extends AsyncView {
         <Panel>
           <PanelHeader>{t('Sessions')}</PanelHeader>
           <PanelBody>
-            <PanelItem>
-              <Flex w={1} justify="space-between">
-                <Box>
-                  <FieldLabel>{t('Sign out of all devices')}</FieldLabel>
-                  <FieldHelp>
-                    {t('Signing out of all devices will sign you out of this device as well.')}
-                  </FieldHelp>
-                </Box>
-                <Button onClick={this.handleSessionClose}>{t('Sign out of all devices')}</Button>
-              </Flex>
-            </PanelItem>
+            <Field
+              alignRight={true}
+              flexibleControlStateSize={true}
+              label={t('Sign out of all devices')}
+              help={t(
+                'Signing out of all devices will sign you out of this device as well.'
+              )}
+            >
+              <Button data-test-id="signoutAll" onClick={this.handleSessionClose}>
+                {t('Sign out of all devices')}
+              </Button>
+            </Field>
           </PanelBody>
         </Panel>
 
diff --git a/tests/js/spec/views/accountSecurity.spec.jsx b/tests/js/spec/views/accountSecurity.spec.jsx
index 75e9ee9a05..4598577f33 100644
--- a/tests/js/spec/views/accountSecurity.spec.jsx
+++ b/tests/js/spec/views/accountSecurity.spec.jsx
@@ -7,6 +7,7 @@ import AccountSecurityWrapper from 'app/views/settings/account/accountSecurity/a
 
 const ENDPOINT = '/users/me/authenticators/';
 const ORG_ENDPOINT = '/organizations/';
+const AUTH_ENDPOINT = '/auth/';
 
 describe('AccountSecurity', function() {
   beforeEach(function() {
@@ -341,4 +342,28 @@ describe('AccountSecurity', function() {
     // user is not 2fa enrolled
     expect(wrapper.find('TwoFactorRequired')).toHaveLength(1);
   });
+
+  it('can expire all sessions', function() {
+    Client.addMockResponse({
+      url: ENDPOINT,
+      body: [TestStubs.Authenticators().Recovery({isEnrolled: false})],
+    });
+    let mock = Client.addMockResponse({
+      url: AUTH_ENDPOINT,
+      body: {all: true},
+      method: 'DELETE',
+      status: 204,
+    });
+
+    let wrapper = mount(
+      <AccountSecurityWrapper>
+        <AccountSecurity />
+      </AccountSecurityWrapper>,
+      TestStubs.routerContext()
+    );
+
+    wrapper.find('Button[data-test-id="signoutAll"]').simulate('click');
+
+    expect(mock).toHaveBeenCalled();
+  });
 });
