commit 455e755407e40d395900f73b8186c8973e8f8f84
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Jun 24 14:45:38 2016 -0700

    Initial work on context summaries abstraction

diff --git a/src/sentry/static/sentry/app/components/events/contextSummary.jsx b/src/sentry/static/sentry/app/components/events/contextSummary.jsx
new file mode 100644
index 0000000000..aa56d117e6
--- /dev/null
+++ b/src/sentry/static/sentry/app/components/events/contextSummary.jsx
@@ -0,0 +1,53 @@
+import React from 'react';
+
+import PropTypes from '../../proptypes';
+import {objectIsEmpty} from '../../utils';
+
+const EventContextSummary = React.createClass({
+  propTypes: {
+    group: PropTypes.Group.isRequired,
+    event: PropTypes.Event.isRequired,
+  },
+
+  render() {
+    let evt = this.props.event;
+    let user = evt.user;
+
+    let userTitle = (!objectIsEmpty(user) && user.email ?
+      user.email :
+      user.ipAddress || user.id || user.username);
+
+    return (
+      <div className="context-summary">
+        {userTitle ?
+          <div className="context-item">
+            <span className="icon" />
+            <h3>{userTitle}</h3>
+            {user.id && user.id !== userTitle ?
+              <p><strong>ID:</strong> {user.id}</p>
+            : (user.username && user.username !== userTitle &&
+              <p><strong>Username:</strong> {user.username}</p>
+            )}
+          </div>
+        :
+          <div className="context-item">
+            <span className="icon" />
+            <h3>Unknown User</h3>
+          </div>
+        }
+        <div className="context-item">
+          <span className="icon" />
+          <h3>iPod 5 (n78ap)</h3>
+          <p><strong>Architecture:</strong> armv7f</p>
+        </div>
+        <div className="context-item">
+          <span className="icon" />
+          <h3>iOS 8.3 (12F69)</h3>
+          <p>Darwin Kernel Version 14.0.0</p>
+        </div>
+      </div>
+    );
+  }
+});
+
+export default EventContextSummary;
diff --git a/src/sentry/static/sentry/app/components/events/eventEntries.jsx b/src/sentry/static/sentry/app/components/events/eventEntries.jsx
index 0e87e57d41..dfbb99663c 100644
--- a/src/sentry/static/sentry/app/components/events/eventEntries.jsx
+++ b/src/sentry/static/sentry/app/components/events/eventEntries.jsx
@@ -2,6 +2,7 @@ import React from 'react';
 
 import {logException} from '../../utils/logging';
 import EventContexts from './contexts';
+import EventContextSummary from './contextSummary';
 import EventDataSection from './eventDataSection';
 import EventErrors from './errors';
 import EventExtraData from './extraData';
@@ -83,6 +84,10 @@ const EventEntries = React.createClass({
       }
     });
 
+    let hasContext = (
+      !(utils.objectIsEmpty(evt.user) && !utils.objectIsEmpty(evt.contexts))
+    );
+
     return (
       <div className="entries">
         {evt.userReport &&
@@ -95,13 +100,18 @@ const EventEntries = React.createClass({
             group={group}
             event={evt} />
         }
+        {hasContext &&
+          <EventContextSummary
+            group={group}
+            event={evt} />
+        }
         <EventTags
           group={group}
           event={evt}
           orgId={this.props.orgId}
           projectId={project.slug} />
         {entries}
-        {(!utils.objectIsEmpty(evt.user) || !utils.objectIsEmpty(evt.contexts)) &&
+        {hasContext &&
           <EventContexts
             group={group}
             event={evt} />
diff --git a/src/sentry/static/sentry/app/views/groupEventDetails.jsx b/src/sentry/static/sentry/app/views/groupEventDetails.jsx
index 4b97786662..2543f25e87 100644
--- a/src/sentry/static/sentry/app/views/groupEventDetails.jsx
+++ b/src/sentry/static/sentry/app/views/groupEventDetails.jsx
@@ -104,23 +104,6 @@ const GroupEventDetails = React.createClass({
                   the Auto Resolve configuration for this project.`)}</span>
               </div>
             }
-            <div className="context-summary">
-              <div className="context-item">
-                <span className="icon" />
-                <h3>armin@getsentry.com</h3>
-                <p><strong>ID:</strong> 1088</p>
-              </div>
-              <div className="context-item">
-                <span className="icon" />
-                <h3>iPod 5 (n78ap)</h3>
-                <p><strong>Architecture:</strong> armv7f</p>
-              </div>
-              <div className="context-item">
-                <span className="icon" />
-                <h3>iOS 8.3 (12F69)</h3>
-                <p>Darwin Kernel Version 14.0.0</p>
-              </div>
-            </div>
             {this.state.loading ?
               <LoadingIndicator />
             : (this.state.error ?
