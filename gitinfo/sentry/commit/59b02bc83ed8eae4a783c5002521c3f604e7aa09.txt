commit 59b02bc83ed8eae4a783c5002521c3f604e7aa09
Author: Mark Story <mark@mark-story.com>
Date:   Wed Feb 27 05:13:35 2019 -0900

    fix(commits) Fix mistake in java suspect commits (#12077)
    
    The `module` key in java stacktraces includes the class name.
    I originally thought it was the containing namespace, but after looking
    at our demo applications, spring and log4j that isn't the case. By
    replacing the terminal node with the filename we can get a probable file
    name more reliably.
    
    Fixes APP-1099

diff --git a/src/sentry/utils/committers.py b/src/sentry/utils/committers.py
index cec5be897f..b9b66e8af8 100644
--- a/src/sentry/utils/committers.py
+++ b/src/sentry/utils/committers.py
@@ -201,7 +201,11 @@ def get_event_file_committers(project, event, frame_limit=25):
             if frame.get('filename') is None:
                 continue
             if '/' not in frame.get('filename') and frame.get('module'):
-                frame['filename'] = frame['module'].replace('.', '/') + '/' + frame['filename']
+                # Replace the last module segment with the filename, as the
+                # terminal element in a module path is the class
+                module = frame['module'].split('.')
+                module[-1] = frame['filename']
+                frame['filename'] = '/'.join(module)
 
     # TODO(maxbittker) return this set instead of annotated frames
     # XXX(dcramer): frames may not define a filepath. For example, in Java its common
diff --git a/tests/sentry/utils/test_committers.py b/tests/sentry/utils/test_committers.py
index a408d931c3..6e6a5b79ff 100644
--- a/tests/sentry/utils/test_committers.py
+++ b/tests/sentry/utils/test_committers.py
@@ -272,7 +272,7 @@ class GetEventFileCommitters(CommitTestCase):
                 'message': 'i fixed a bug',
                 'patch_set': [
                     {
-                        'path': 'sentry/example/Application/Application.java',
+                        'path': 'src/main/java/io/sentry/example/Application.java',
                         'type': 'M',
                     },
                 ]
