commit e7499c4a55a1f08be50e8de2b62e3c6091d15cde
Author: ted kaemming <ted@kaemming.com>
Date:   Thu Oct 27 10:35:12 2016 -0700

    Allow coercing `chunked` iterator to a list. (#4441)

diff --git a/src/sentry/utils/iterators.py b/src/sentry/utils/iterators.py
index 0b423def3a..215c85d1ba 100644
--- a/src/sentry/utils/iterators.py
+++ b/src/sentry/utils/iterators.py
@@ -7,5 +7,7 @@ def chunked(iterator, size):
         chunk.append(item)
         if len(chunk) == size:
             yield chunk
-            del chunk[:]
-    yield chunk
+            chunk = []
+
+    if chunk:
+        yield chunk
diff --git a/tests/sentry/utils/test_iterators.py b/tests/sentry/utils/test_iterators.py
new file mode 100644
index 0000000000..5f7c529090
--- /dev/null
+++ b/tests/sentry/utils/test_iterators.py
@@ -0,0 +1,15 @@
+from __future__ import absolute_import
+
+from sentry.utils.iterators import chunked
+
+
+def test_chunked():
+    assert list(chunked(range(5), 5)) == [
+        [0, 1, 2, 3, 4],
+    ]
+
+    assert list(chunked(range(10), 4)) == [
+        [0, 1, 2, 3],
+        [4, 5, 6, 7],
+        [8, 9],
+    ]
