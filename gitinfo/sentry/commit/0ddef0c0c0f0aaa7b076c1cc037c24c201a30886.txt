commit 0ddef0c0c0f0aaa7b076c1cc037c24c201a30886
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Tue Aug 28 17:56:16 2018 -0700

    feat: Expose EventUser.hash_from_tag (#9546)

diff --git a/src/sentry/models/eventuser.py b/src/sentry/models/eventuser.py
index 7f1903e2df..fd89b817a3 100644
--- a/src/sentry/models/eventuser.py
+++ b/src/sentry/models/eventuser.py
@@ -53,6 +53,10 @@ class EventUser(Model):
     def attr_from_keyword(cls, keyword):
         return KEYWORD_MAP.get_key(keyword)
 
+    @classmethod
+    def hash_from_tag(cls, value):
+        return md5_text(value.split(':', 1)[-1]).hexdigest()
+
     @classmethod
     def for_tags(cls, project_id, values):
         """
@@ -60,7 +64,7 @@ class EventUser(Model):
 
         Return a dictionary of {tag_value: event_user}.
         """
-        hashes = [md5_text(v.split(':', 1)[-1]).hexdigest() for v in values]
+        hashes = [cls.hash_from_tag(v) for v in values]
         return {e.tag_value: e for e in cls.objects.filter(
             project_id=project_id,
             hash__in=hashes,
diff --git a/tests/sentry/models/test_eventuser.py b/tests/sentry/models/test_eventuser.py
index 5f43c735b6..5f3b493897 100644
--- a/tests/sentry/models/test_eventuser.py
+++ b/tests/sentry/models/test_eventuser.py
@@ -1,5 +1,6 @@
 from __future__ import absolute_import
 
+from hashlib import md5
 from sentry.testutils import TestCase
 from sentry.models import EventUser
 
@@ -36,3 +37,15 @@ class EventUserTestCase(TestCase):
         ]
         for keyword, attr in cases:
             assert EventUser.attr_from_keyword(keyword) == attr
+
+    def test_hash_from_tag(self):
+        assert EventUser.hash_from_tag('foo:bar:baz') == md5('bar:baz').hexdigest()
+
+    def test_for_tags(self):
+        eu = EventUser.objects.create(
+            project_id=1,
+            ident='matt',
+        )
+        assert EventUser.for_tags(1, ['id:matt']) == {'id:matt': eu}
+        assert EventUser.for_tags(1, ['id:doesnotexist']) == {}
+        assert EventUser.for_tags(1, ['id:matt', 'id:doesnotexist']) == {'id:matt': eu}
