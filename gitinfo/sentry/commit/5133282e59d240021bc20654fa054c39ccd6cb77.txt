commit 5133282e59d240021bc20654fa054c39ccd6cb77
Author: Daniel Griesser <daniel.griesser.86@gmail.com>
Date:   Thu Apr 20 14:54:22 2017 +0200

    Remove dist query parameter for api with file id

diff --git a/src/sentry/api/endpoints/organization_release_file_details.py b/src/sentry/api/endpoints/organization_release_file_details.py
index 139d24bc33..f7125ef841 100644
--- a/src/sentry/api/endpoints/organization_release_file_details.py
+++ b/src/sentry/api/endpoints/organization_release_file_details.py
@@ -9,7 +9,7 @@ from sentry.api.base import DocSection
 from sentry.api.bases.organization import OrganizationReleasesBaseEndpoint
 from sentry.api.exceptions import ResourceDoesNotExist
 from sentry.api.serializers import serialize
-from sentry.models import Release, ReleaseFile, Distribution
+from sentry.models import Release, ReleaseFile
 try:
     from django.http import (
         CompatibleStreamingHttpResponse as StreamingHttpResponse
@@ -49,7 +49,6 @@ class OrganizationReleaseFileDetailsEndpoint(OrganizationReleasesBaseEndpoint):
                                           release belongs to.
         :pparam string version: the version identifier of the release.
         :pparam string file_id: the ID of the file to retrieve.
-        :qparam string dist: the name of the dist.
         :auth: required
         """
         try:
@@ -63,22 +62,10 @@ class OrganizationReleaseFileDetailsEndpoint(OrganizationReleasesBaseEndpoint):
         if not self.has_release_permission(request, organization, release):
             raise PermissionDenied
 
-        dist_name = request.GET.get('dist')
-        dist = None
-        if dist_name:
-            try:
-                dist = Distribution.objects.get(
-                    release=release,
-                    name=dist_name,
-                )
-            except Distribution.DoesNotExist:
-                raise ResourceDoesNotExist
-
         try:
             releasefile = ReleaseFile.objects.get(
                 release=release,
                 id=file_id,
-                dist=dist,
             )
         except ReleaseFile.DoesNotExist:
             raise ResourceDoesNotExist
@@ -118,16 +105,10 @@ class OrganizationReleaseFileDetailsEndpoint(OrganizationReleasesBaseEndpoint):
         if not self.has_release_permission(request, organization, release):
             raise PermissionDenied
 
-        dist_name = request.DATA.get('dist')
-        dist = None
-        if dist_name:
-            dist = release.add_dist(dist_name)
-
         try:
             releasefile = ReleaseFile.objects.get(
                 release=release,
                 id=file_id,
-                dist=dist,
             )
         except ReleaseFile.DoesNotExist:
             raise ResourceDoesNotExist
@@ -158,7 +139,6 @@ class OrganizationReleaseFileDetailsEndpoint(OrganizationReleasesBaseEndpoint):
                                           release belongs to.
         :pparam string version: the version identifier of the release.
         :pparam string file_id: the ID of the file to delete.
-        :qparam string dist: the name of the dist.
         :auth: required
         """
         try:
@@ -172,22 +152,10 @@ class OrganizationReleaseFileDetailsEndpoint(OrganizationReleasesBaseEndpoint):
         if not self.has_release_permission(request, organization, release):
             raise PermissionDenied
 
-        dist_name = request.GET.get('dist')
-        dist = None
-        if dist_name:
-            try:
-                dist = Distribution.objects.get(
-                    release=release,
-                    name=dist_name,
-                )
-            except Distribution.DoesNotExist:
-                raise ResourceDoesNotExist
-
         try:
             releasefile = ReleaseFile.objects.get(
                 release=release,
                 id=file_id,
-                dist=dist,
             )
         except ReleaseFile.DoesNotExist:
             raise ResourceDoesNotExist
diff --git a/src/sentry/api/endpoints/project_release_file_details.py b/src/sentry/api/endpoints/project_release_file_details.py
index 48db68e857..708d8698e5 100644
--- a/src/sentry/api/endpoints/project_release_file_details.py
+++ b/src/sentry/api/endpoints/project_release_file_details.py
@@ -8,7 +8,7 @@ from sentry.api.base import DocSection
 from sentry.api.bases.project import ProjectEndpoint, ProjectReleasePermission
 from sentry.api.exceptions import ResourceDoesNotExist
 from sentry.api.serializers import serialize
-from sentry.models import Release, ReleaseFile, Distribution
+from sentry.models import Release, ReleaseFile
 from sentry.utils.apidocs import scenario, attach_scenarios
 try:
     from django.http import (
@@ -104,7 +104,6 @@ class ProjectReleaseFileDetailsEndpoint(ProjectEndpoint):
                                      file of.
         :pparam string version: the version identifier of the release.
         :pparam string file_id: the ID of the file to retrieve.
-        :qparam string dist: the name of the dist.
         :auth: required
         """
         try:
@@ -116,22 +115,10 @@ class ProjectReleaseFileDetailsEndpoint(ProjectEndpoint):
         except Release.DoesNotExist:
             raise ResourceDoesNotExist
 
-        dist_name = request.GET.get('dist')
-        dist = None
-        if dist_name:
-            try:
-                dist = Distribution.objects.get(
-                    release=release,
-                    name=dist_name,
-                )
-            except Distribution.DoesNotExist:
-                raise ResourceDoesNotExist
-
         try:
             releasefile = ReleaseFile.objects.get(
                 release=release,
                 id=file_id,
-                dist=dist,
             )
         except ReleaseFile.DoesNotExist:
             raise ResourceDoesNotExist
@@ -160,7 +147,6 @@ class ProjectReleaseFileDetailsEndpoint(ProjectEndpoint):
         :pparam string version: the version identifier of the release.
         :pparam string file_id: the ID of the file to update.
         :param string name: the new name of the file.
-        :param string dist: the name of the dist.
         :auth: required
         """
         try:
@@ -172,16 +158,10 @@ class ProjectReleaseFileDetailsEndpoint(ProjectEndpoint):
         except Release.DoesNotExist:
             raise ResourceDoesNotExist
 
-        dist_name = request.DATA.get('dist')
-        dist = None
-        if dist_name:
-            dist = release.add_dist(dist_name)
-
         try:
             releasefile = ReleaseFile.objects.get(
                 release=release,
                 id=file_id,
-                dist=dist,
             )
         except ReleaseFile.DoesNotExist:
             raise ResourceDoesNotExist
@@ -215,7 +195,6 @@ class ProjectReleaseFileDetailsEndpoint(ProjectEndpoint):
                                      file of.
         :pparam string version: the version identifier of the release.
         :pparam string file_id: the ID of the file to delete.
-        :qparam string dist: the name of the dist.
         :auth: required
         """
         try:
@@ -227,22 +206,10 @@ class ProjectReleaseFileDetailsEndpoint(ProjectEndpoint):
         except Release.DoesNotExist:
             raise ResourceDoesNotExist
 
-        dist_name = request.GET.get('dist')
-        dist = None
-        if dist_name:
-            try:
-                dist = Distribution.objects.get(
-                    release=release,
-                    name=dist_name,
-                )
-            except Distribution.DoesNotExist:
-                raise ResourceDoesNotExist
-
         try:
             releasefile = ReleaseFile.objects.get(
                 release=release,
                 id=file_id,
-                dist=dist,
             )
         except ReleaseFile.DoesNotExist:
             raise ResourceDoesNotExist
