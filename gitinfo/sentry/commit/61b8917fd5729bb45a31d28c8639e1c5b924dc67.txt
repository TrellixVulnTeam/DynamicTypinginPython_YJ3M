commit 61b8917fd5729bb45a31d28c8639e1c5b924dc67
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Mon Feb 25 16:51:04 2019 +0100

    fix: Fix an error where slack integration directly accesses metadata and fails for new metadata code (#12186)

diff --git a/src/sentry/eventtypes/error.py b/src/sentry/eventtypes/error.py
index 7c1a378196..6d969c6d5c 100644
--- a/src/sentry/eventtypes/error.py
+++ b/src/sentry/eventtypes/error.py
@@ -61,7 +61,7 @@ class ErrorEvent(BaseEvent):
         ty = metadata.get('type')
         if ty is None:
             return metadata.get('function') or '<unknown>'
-        if not metadata['value']:
+        if not metadata.get('value'):
             return ty
         return u'{}: {}'.format(
             ty,
diff --git a/src/sentry/integrations/slack/utils.py b/src/sentry/integrations/slack/utils.py
index 7845925276..703a3fd4ab 100644
--- a/src/sentry/integrations/slack/utils.py
+++ b/src/sentry/integrations/slack/utils.py
@@ -82,7 +82,7 @@ def build_attachment_text(group, event=None):
     ev_metadata = group.get_event_metadata()
     ev_type = group.get_event_type()
     if ev_type == 'error':
-        return ev_metadata['value']
+        return ev_metadata.get('value') or ev_metadata.get('function')
     else:
         return None
 
