commit 3265e89088dcb3a131f989e6de38a0cb3b7468ae
Author: David Cramer <dcramer@gmail.com>
Date:   Tue May 20 00:19:03 2014 -0700

    Dont store any empty value in serialization

diff --git a/src/sentry/interfaces/base.py b/src/sentry/interfaces/base.py
index 0df8a5bbb7..ec88d44abe 100644
--- a/src/sentry/interfaces/base.py
+++ b/src/sentry/interfaces/base.py
@@ -38,9 +38,10 @@ class Interface(object):
         return cls(data)
 
     def to_json(self):
+        # eliminate empty values for serialization to compress the keyspace
+        # and save (seriously) ridiculous amounts of bytes
         return dict(
-            (k, v) for k, v in self._data.iteritems()
-            if v is not None
+            (k, v) for k, v in self._data.iteritems() if v
         )
 
     def get_alias(self):
diff --git a/tests/sentry/tasks/fetch_source/tests.py b/tests/sentry/tasks/fetch_source/tests.py
index 10ebd102cd..5f3ad1fd8d 100644
--- a/tests/sentry/tasks/fetch_source/tests.py
+++ b/tests/sentry/tasks/fetch_source/tests.py
@@ -85,7 +85,7 @@ class ExpandJavascriptSourceTest(TestCase):
         assert frame['post_context'] == ['o', ' ', 'w', 'o', 'r']
 
         frame = frame_list[1]
-        assert frame['pre_context'] == []
+        assert not frame.get('pre_context')
         assert frame['context_line'] == 'h'
         assert frame['post_context'] == ['e', 'l', 'l', 'o', ' ']
 
@@ -117,9 +117,9 @@ class ExpandJavascriptSourceTest(TestCase):
 
         frame_list = data['sentry.interfaces.Exception']['values'][0]['stacktrace']['frames']
         frame = frame_list[0]
-        assert frame['pre_context'] == []
+        assert not frame.get('pre_context')
         assert frame['context_line'] == 'console.log("hello, World!")'
-        assert frame['post_context'] == []
+        assert not frame.get('post_context')
 
 
 class GenerateModuleTest(TestCase):
