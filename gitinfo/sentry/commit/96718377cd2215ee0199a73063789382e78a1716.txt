commit 96718377cd2215ee0199a73063789382e78a1716
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Nov 23 12:34:36 2012 -0800

    Add X-Sentry-Error header

diff --git a/src/sentry/web/api.py b/src/sentry/web/api.py
index ceb57f0481..fc389d8127 100644
--- a/src/sentry/web/api.py
+++ b/src/sentry/web/api.py
@@ -98,6 +98,13 @@ class APIView(BaseView):
 
     @csrf_exempt
     def dispatch(self, request, project_id=None, *args, **kwargs):
+        response = self._dispatch(request, project_id=project_id, *args, **kwargs)
+        # Set X-Sentry-Error as in many cases it is easier to inspect the headers
+        if response.status_code != 200:
+            response['X-Sentry-Error'] = response.content[:200]  # safety net on content length
+        return response
+
+    def _dispatch(self, request, project_id=None, *args, **kwargs):
         try:
             project = self._get_project_from_id(project_id)
         except APIError, e:
