commit 249571412f962cc2cc4c2ed3f6afa54f7682e0dc
Author: Megan Heskett <meg.heskett@gmail.com>
Date:   Thu May 24 12:10:14 2018 -0700

    fix(ui): Add recovery options modal to sms enroll (#8535)
    
    * Open modal after sms enroll success
    
    * Add tests

diff --git a/src/sentry/static/sentry/app/components/modals/recoveryOptionsModal.jsx b/src/sentry/static/sentry/app/components/modals/recoveryOptionsModal.jsx
index e08371a9ad..e077297147 100644
--- a/src/sentry/static/sentry/app/components/modals/recoveryOptionsModal.jsx
+++ b/src/sentry/static/sentry/app/components/modals/recoveryOptionsModal.jsx
@@ -52,7 +52,7 @@ class RecoveryOptionsModal extends AsyncComponent {
 
         <Body>
           <TextBlock>
-            {t(`Two factor authentication via ${authenticatorName} has been enabled`)}
+            {t(`Two factor authentication via ${authenticatorName} has been enabled.`)}
           </TextBlock>
           <TextBlock>
             {t('You should now set up recovery options to secure your account.')}
diff --git a/src/sentry/static/sentry/app/views/settings/account/accountSecurity/accountSecurityEnroll.jsx b/src/sentry/static/sentry/app/views/settings/account/accountSecurity/accountSecurityEnroll.jsx
index 3614d3e87a..6532c8bc20 100644
--- a/src/sentry/static/sentry/app/views/settings/account/accountSecurity/accountSecurityEnroll.jsx
+++ b/src/sentry/static/sentry/app/views/settings/account/accountSecurity/accountSecurityEnroll.jsx
@@ -178,7 +178,9 @@ class AccountSecurityEnroll extends AsyncView {
           } else {
             // OTP was accepted and SMS was added as a 2fa method
             this.props.router.push('/settings/account/security/');
-            addSuccessMessage(t('Added authenticator %s', authenticator.name));
+            openRecoveryOptions({
+              authenticatorName: authenticator.name,
+            });
           }
         },
         error => {
diff --git a/src/sentry/static/sentry/app/views/settings/account/accountSecurity/components/recoveryCodes.jsx b/src/sentry/static/sentry/app/views/settings/account/accountSecurity/components/recoveryCodes.jsx
index d08f45a428..7f88990fd3 100644
--- a/src/sentry/static/sentry/app/views/settings/account/accountSecurity/components/recoveryCodes.jsx
+++ b/src/sentry/static/sentry/app/views/settings/account/accountSecurity/components/recoveryCodes.jsx
@@ -40,7 +40,7 @@ class RecoveryCodes extends React.Component {
 
     if (!isEnrolled || !codes) return null;
 
-    let formattedCodes = codes.join('\n');
+    let formattedCodes = codes.join(' \n');
 
     return (
       <Panel css={{marginTop: 30}}>
diff --git a/tests/js/setup.js b/tests/js/setup.js
index 4c7cd80856..392688597e 100644
--- a/tests/js/setup.js
+++ b/tests/js/setup.js
@@ -337,6 +337,7 @@ window.TestStubs = {
         authId: '16',
         canValidateOtp: true,
         isBackupInterface: true,
+        codes: ['ABCD-1234', 'EFGH-5678'],
         ...params,
       }),
     };
diff --git a/tests/js/spec/views/accountSecurityDetails.spec.jsx b/tests/js/spec/views/accountSecurityDetails.spec.jsx
index f6ccc80706..577f274131 100644
--- a/tests/js/spec/views/accountSecurityDetails.spec.jsx
+++ b/tests/js/spec/views/accountSecurityDetails.spec.jsx
@@ -99,5 +99,17 @@ describe('AccountSecurityDetails', function() {
 
       expect(deleteMock).toHaveBeenCalled();
     });
+
+    it('has copy, print and download buttons', function() {
+      let codes = 'ABCD-1234 \nEFGH-5678';
+
+      let downloadCodes = `Button[href="data:text/plain;charset=utf-8,${codes}"]`;
+      expect(wrapper.find(downloadCodes)).toHaveLength(1);
+      wrapper.find(downloadCodes).simulate('click');
+
+      expect(wrapper.find('Button InlineSvg[src="icon-print"]')).toHaveLength(1);
+      expect(wrapper.find('iframe[name="printable"]')).toHaveLength(1);
+      expect(wrapper.find(`Clipboard[value="${codes}"]`)).toHaveLength(1);
+    });
   });
 });
