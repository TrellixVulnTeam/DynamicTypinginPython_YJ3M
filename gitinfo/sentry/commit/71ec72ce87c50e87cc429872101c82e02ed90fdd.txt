commit 71ec72ce87c50e87cc429872101c82e02ed90fdd
Author: David Cramer <dcramer@gmail.com>
Date:   Thu May 1 17:10:07 2014 -0300

    Bind has_more in outer scope

diff --git a/src/sentry/tasks/deletion.py b/src/sentry/tasks/deletion.py
index d8e4b15c24..071a9fedc9 100644
--- a/src/sentry/tasks/deletion.py
+++ b/src/sentry/tasks/deletion.py
@@ -122,13 +122,14 @@ def delete_group(object_id, **kwargs):
 def delete_objects(models, relation, limit=1000, logger=None):
     # This handles cascades properly
     # TODO: this doesn't clean up the index
+    has_more = False
     for model in models:
         if logger is not None:
             logger.info('Removing %r objects where %r', model, relation)
-        has_more = False
         for obj in model.objects.filter(**relation)[:limit]:
             obj.delete()
             has_more = True
 
         if has_more:
             return True
+    return has_more
