commit 55e11d34366f4d3a7da1916ced4066417dd891d4
Author: Daniel Griesser <daniel.griesser.86@gmail.com>
Date:   Wed Feb 8 10:28:24 2017 +0100

    Fixed migration, Fix reprocessing query check

diff --git a/src/sentry/models/processingissue.py b/src/sentry/models/processingissue.py
index 26ddbeb86c..f27de38fbe 100644
--- a/src/sentry/models/processingissue.py
+++ b/src/sentry/models/processingissue.py
@@ -39,7 +39,7 @@ class ProcessingIssueManager(BaseManager):
         )
         if type is not None:
             q = q.filter(type=type)
-        probably_resolved = q[:1].first() is not None
+        probably_resolved = bool(q[:1].all())
         q.delete()
         return probably_resolved
 
diff --git a/src/sentry/south_migrations/0291_auto__add_rawevent__add_unique_rawevent_project_event_id__add_processi.py b/src/sentry/south_migrations/0292_auto__add_processingissue__add_unique_processingissue_project_checksum.py
similarity index 99%
rename from src/sentry/south_migrations/0291_auto__add_rawevent__add_unique_rawevent_project_event_id__add_processi.py
rename to src/sentry/south_migrations/0292_auto__add_processingissue__add_unique_processingissue_project_checksum.py
index af0d57063f..9194b49993 100644
--- a/src/sentry/south_migrations/0291_auto__add_rawevent__add_unique_rawevent_project_event_id__add_processi.py
+++ b/src/sentry/south_migrations/0292_auto__add_processingissue__add_unique_processingissue_project_checksum.py
@@ -8,19 +8,6 @@ from django.db import models
 class Migration(SchemaMigration):
 
     def forwards(self, orm):
-        # Adding model 'RawEvent'
-        db.create_table('sentry_rawevent', (
-            ('id', self.gf('sentry.db.models.fields.bounded.BoundedBigAutoField')(primary_key=True)),
-            ('project', self.gf('sentry.db.models.fields.foreignkey.FlexibleForeignKey')(to=orm['sentry.Project'])),
-            ('event_id', self.gf('django.db.models.fields.CharField')(max_length=32, null=True)),
-            ('datetime', self.gf('django.db.models.fields.DateTimeField')(default=datetime.datetime.now)),
-            ('data', self.gf('sentry.db.models.fields.node.NodeField')(null=True, blank=True)),
-        ))
-        db.send_create_signal('sentry', ['RawEvent'])
-
-        # Adding unique constraint on 'RawEvent', fields ['project', 'event_id']
-        db.create_unique('sentry_rawevent', ['project_id', 'event_id'])
-
         # Adding model 'ProcessingIssue'
         db.create_table('sentry_processingissue', (
             ('id', self.gf('sentry.db.models.fields.bounded.BoundedBigAutoField')(primary_key=True)),
@@ -28,12 +15,26 @@ class Migration(SchemaMigration):
             ('checksum', self.gf('django.db.models.fields.CharField')(max_length=40, db_index=True)),
             ('type', self.gf('django.db.models.fields.CharField')(max_length=30)),
             ('data', self.gf('sentry.db.models.fields.gzippeddict.GzippedDictField')()),
+            ('datetime', self.gf('django.db.models.fields.DateTimeField')(default=datetime.datetime.now)),
         ))
         db.send_create_signal('sentry', ['ProcessingIssue'])
 
         # Adding unique constraint on 'ProcessingIssue', fields ['project', 'checksum', 'type']
         db.create_unique('sentry_processingissue', ['project_id', 'checksum', 'type'])
 
+        # Adding model 'RawEvent'
+        db.create_table('sentry_rawevent', (
+            ('id', self.gf('sentry.db.models.fields.bounded.BoundedBigAutoField')(primary_key=True)),
+            ('project', self.gf('sentry.db.models.fields.foreignkey.FlexibleForeignKey')(to=orm['sentry.Project'])),
+            ('event_id', self.gf('django.db.models.fields.CharField')(max_length=32, null=True)),
+            ('datetime', self.gf('django.db.models.fields.DateTimeField')(default=datetime.datetime.now)),
+            ('data', self.gf('sentry.db.models.fields.node.NodeField')(null=True, blank=True)),
+        ))
+        db.send_create_signal('sentry', ['RawEvent'])
+
+        # Adding unique constraint on 'RawEvent', fields ['project', 'event_id']
+        db.create_unique('sentry_rawevent', ['project_id', 'event_id'])
+
         # Adding model 'EventProcessingIssue'
         db.create_table('sentry_eventprocessingissue', (
             ('id', self.gf('sentry.db.models.fields.bounded.BoundedBigAutoField')(primary_key=True)),
@@ -50,18 +51,18 @@ class Migration(SchemaMigration):
         # Removing unique constraint on 'EventProcessingIssue', fields ['raw_event', 'processing_issue']
         db.delete_unique('sentry_eventprocessingissue', ['raw_event_id', 'processing_issue_id'])
 
-        # Removing unique constraint on 'ProcessingIssue', fields ['project', 'checksum', 'type']
-        db.delete_unique('sentry_processingissue', ['project_id', 'checksum', 'type'])
-
         # Removing unique constraint on 'RawEvent', fields ['project', 'event_id']
         db.delete_unique('sentry_rawevent', ['project_id', 'event_id'])
 
-        # Deleting model 'RawEvent'
-        db.delete_table('sentry_rawevent')
+        # Removing unique constraint on 'ProcessingIssue', fields ['project', 'checksum', 'type']
+        db.delete_unique('sentry_processingissue', ['project_id', 'checksum', 'type'])
 
         # Deleting model 'ProcessingIssue'
         db.delete_table('sentry_processingissue')
 
+        # Deleting model 'RawEvent'
+        db.delete_table('sentry_rawevent')
+
         # Deleting model 'EventProcessingIssue'
         db.delete_table('sentry_eventprocessingissue')
 
@@ -149,7 +150,7 @@ class Migration(SchemaMigration):
         'sentry.broadcast': {
             'Meta': {'object_name': 'Broadcast'},
             'date_added': ('django.db.models.fields.DateTimeField', [], {'default': 'datetime.datetime.now'}),
-            'date_expires': ('django.db.models.fields.DateTimeField', [], {'default': 'datetime.datetime(2017, 2, 13, 0, 0)', 'null': 'True', 'blank': 'True'}),
+            'date_expires': ('django.db.models.fields.DateTimeField', [], {'default': 'datetime.datetime(2017, 2, 15, 0, 0)', 'null': 'True', 'blank': 'True'}),
             'id': ('sentry.db.models.fields.bounded.BoundedBigAutoField', [], {'primary_key': 'True'}),
             'is_active': ('django.db.models.fields.BooleanField', [], {'default': 'True', 'db_index': 'True'}),
             'link': ('django.db.models.fields.URLField', [], {'max_length': '200', 'null': 'True', 'blank': 'True'}),
@@ -539,6 +540,7 @@ class Migration(SchemaMigration):
             'Meta': {'unique_together': "(('project', 'checksum', 'type'),)", 'object_name': 'ProcessingIssue'},
             'checksum': ('django.db.models.fields.CharField', [], {'max_length': '40', 'db_index': 'True'}),
             'data': ('sentry.db.models.fields.gzippeddict.GzippedDictField', [], {}),
+            'datetime': ('django.db.models.fields.DateTimeField', [], {'default': 'datetime.datetime.now'}),
             'id': ('sentry.db.models.fields.bounded.BoundedBigAutoField', [], {'primary_key': 'True'}),
             'project': ('sentry.db.models.fields.foreignkey.FlexibleForeignKey', [], {'to': "orm['sentry.Project']"}),
             'type': ('django.db.models.fields.CharField', [], {'max_length': '30'})
@@ -756,7 +758,7 @@ class Migration(SchemaMigration):
             'id': ('sentry.db.models.fields.bounded.BoundedBigAutoField', [], {'primary_key': 'True'}),
             'is_verified': ('django.db.models.fields.BooleanField', [], {'default': 'False'}),
             'user': ('sentry.db.models.fields.foreignkey.FlexibleForeignKey', [], {'related_name': "'emails'", 'to': "orm['sentry.User']"}),
-            'validation_hash': ('django.db.models.fields.CharField', [], {'default': "u'HHA0QD94XqBrRTBi2Uh5KYhfzoRpsFzv'", 'max_length': '32'})
+            'validation_hash': ('django.db.models.fields.CharField', [], {'default': "u'Ai364FIgjA5fHLxpJDcbN17YOiaTLafc'", 'max_length': '32'})
         },
         'sentry.useroption': {
             'Meta': {'unique_together': "(('user', 'project', 'key'),)", 'object_name': 'UserOption'},
