commit 4c1aa987cd547505188fb152b2a92b3fd5461ce9
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Oct 14 10:51:54 2015 -0700

    Add test for deleting higher tier members

diff --git a/tests/sentry/api/endpoints/test_organization_member_details.py b/tests/sentry/api/endpoints/test_organization_member_details.py
index 55a1ba8f50..3ad9b60a39 100644
--- a/tests/sentry/api/endpoints/test_organization_member_details.py
+++ b/tests/sentry/api/endpoints/test_organization_member_details.py
@@ -96,6 +96,36 @@ class DeleteOrganizationMemberTest(APITestCase):
 
         assert not OrganizationMember.objects.filter(id=member_om.id).exists()
 
+    def test_cannot_delete_member_with_higher_access(self):
+        self.login_as(user=self.user)
+
+        organization = self.create_organization(name='foo', owner=self.user)
+
+        other_user = self.create_user('bar@example.com')
+
+        self.create_member(
+            organization=organization,
+            role='manager',
+            user=other_user,
+        )
+
+        owner_om = OrganizationMember.objects.get(
+            organization=organization,
+            user=self.user,
+        )
+
+        assert owner_om.role == 'owner'
+
+        path = reverse('sentry-api-0-organization-member-details', args=[organization.slug, owner_om.id])
+
+        self.login_as(other_user)
+
+        resp = self.client.delete(path)
+
+        assert resp.status_code == 400
+
+        assert OrganizationMember.objects.filter(id=owner_om.id).exists()
+
     def test_cannot_delete_only_owner(self):
         self.login_as(user=self.user)
 
