commit 685810fce5d8e9489ffa1dfd464be698be07c7de
Author: Megan Heskett <meg.heskett@gmail.com>
Date:   Wed Oct 30 17:28:47 2019 -0700

    Filter results with join requests disabled (#15362)

diff --git a/src/sentry/api/endpoints/organization_invite_request_index.py b/src/sentry/api/endpoints/organization_invite_request_index.py
index 076566f23d..bff73921fa 100644
--- a/src/sentry/api/endpoints/organization_invite_request_index.py
+++ b/src/sentry/api/endpoints/organization_invite_request_index.py
@@ -33,6 +33,9 @@ class OrganizationInviteRequestIndexEndpoint(OrganizationEndpoint):
             organization=organization,
         ).order_by("invite_status", "email")
 
+        if organization.get_option("sentry:join_requests") is False:
+            queryset = queryset.filter(invite_status=InviteStatus.REQUESTED_TO_BE_INVITED.value)
+
         return self.paginate(
             request=request,
             queryset=queryset,
diff --git a/tests/sentry/api/endpoints/test_organization_invite_request_index.py b/tests/sentry/api/endpoints/test_organization_invite_request_index.py
index 33209cab87..65e57cb663 100644
--- a/tests/sentry/api/endpoints/test_organization_invite_request_index.py
+++ b/tests/sentry/api/endpoints/test_organization_invite_request_index.py
@@ -6,7 +6,12 @@ from exam import fixture
 from mock import patch
 
 from sentry.testutils import APITestCase
-from sentry.models import OrganizationMember, OrganizationMemberTeam, InviteStatus
+from sentry.models import (
+    OrganizationMember,
+    OrganizationMemberTeam,
+    OrganizationOption,
+    InviteStatus,
+)
 
 
 class OrganizationInviteRequestListTest(APITestCase):
@@ -41,6 +46,19 @@ class OrganizationInviteRequestListTest(APITestCase):
         assert resp.data[1]["email"] == self.request_to_join.email
         assert resp.data[1]["inviteStatus"] == "requested_to_join"
 
+    def test_join_requests_disabled(self):
+        OrganizationOption.objects.create(
+            organization_id=self.org.id, key="sentry:join_requests", value=False
+        )
+
+        self.login_as(user=self.user)
+        resp = self.get_response(self.org.slug)
+
+        assert resp.status_code == 200
+        assert len(resp.data) == 1
+        assert resp.data[0]["email"] == self.invite_request.email
+        assert resp.data[0]["inviteStatus"] == "requested_to_be_invited"
+
 
 class OrganizationInviteRequestCreateTest(APITestCase):
     def setUp(self):
