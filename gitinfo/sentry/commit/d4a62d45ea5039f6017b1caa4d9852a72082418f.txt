commit d4a62d45ea5039f6017b1caa4d9852a72082418f
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Sep 10 15:56:53 2015 -0500

    Clean up AuthIdentity on member removal

diff --git a/src/sentry/api/endpoints/organization_member_details.py b/src/sentry/api/endpoints/organization_member_details.py
index 21c7bd394a..fb354f4971 100644
--- a/src/sentry/api/endpoints/organization_member_details.py
+++ b/src/sentry/api/endpoints/organization_member_details.py
@@ -1,5 +1,6 @@
 from __future__ import absolute_import
 
+from django.db import transaction
 from rest_framework import serializers
 from rest_framework.response import Response
 
@@ -8,7 +9,7 @@ from sentry.api.bases.organization import (
 )
 from sentry.api.exceptions import ResourceDoesNotExist
 from sentry.models import (
-    AuditLogEntryEvent, AuthProvider, OrganizationMember,
+    AuditLogEntryEvent, AuthIdentity, AuthProvider, OrganizationMember,
     OrganizationMemberType
 )
 
@@ -127,8 +128,13 @@ class OrganizationMemberDetailsEndpoint(OrganizationEndpoint):
 
         audit_data = om.get_audit_log_data()
 
-        # TODO(dcramer): we should probably clean up AuthIdentity here
-        om.delete()
+        with transaction.atomic():
+            AuthIdentity.objects.filter(
+                user=om.user,
+                auth_provider__organization=organization,
+            ).delete()
+
+            om.delete()
 
         self.create_audit_entry(
             request=request,
