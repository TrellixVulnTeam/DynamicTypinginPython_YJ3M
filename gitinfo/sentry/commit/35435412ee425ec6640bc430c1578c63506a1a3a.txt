commit 35435412ee425ec6640bc430c1578c63506a1a3a
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Apr 22 19:24:37 2013 -0700

    Eliminate dupes in activity stream and trim to 5

diff --git a/src/sentry/web/frontend/groups.py b/src/sentry/web/frontend/groups.py
index 92ab857899..21b5888b1e 100644
--- a/src/sentry/web/frontend/groups.py
+++ b/src/sentry/web/frontend/groups.py
@@ -379,9 +379,17 @@ def group(request, team, project, group, event_id=None):
     event.group = group
     event.project = project
 
-    activity = list(activity_qs.filter(
-        group=group,
-    )[:10])
+    # filter out dupes
+    activity_items = set()
+    activity = []
+    for item in activity_qs.filter(group=group)[:10]:
+        sig = (item.event_id, item.type, item.ident, item.user_id)
+        if sig not in activity_items:
+            activity_items.add(sig)
+            activity.append(item)
+
+    # trim to latest 5
+    activity = activity[:5]
 
     context = {
         'page': 'details',
