commit 27983b7a4d6a7fe3bba3af3db35e78600344e0ec
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jan 26 15:20:47 2015 -0800

    Improve test extensions
    
    - Remove warnings-as-errors from extension
    - Move middleware into testutils

diff --git a/conftest.py b/conftest.py
index ac4da4a6fa..14ed7744bf 100644
--- a/conftest.py
+++ b/conftest.py
@@ -1,10 +1,10 @@
 from __future__ import absolute_import
 
-import sys
-import os.path
-
-sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))
-
 pytest_plugins = [
     'sentry.utils.pytest'
 ]
+
+
+def pytest_configure(config):
+    import warnings
+    warnings.filterwarnings('error', '', Warning, r'(sentry|raven)')
diff --git a/tests/middleware.py b/src/sentry/testutils/middleware.py
similarity index 100%
rename from tests/middleware.py
rename to src/sentry/testutils/middleware.py
diff --git a/src/sentry/utils/pytest.py b/src/sentry/utils/pytest.py
index 47d22790ba..74db61cb93 100644
--- a/src/sentry/utils/pytest.py
+++ b/src/sentry/utils/pytest.py
@@ -7,9 +7,6 @@ from django.conf import settings
 
 
 def pytest_configure(config):
-    import warnings
-    warnings.filterwarnings('error', '', Warning, r'(sentry|raven)')
-
     if not settings.configured:
         os.environ['DJANGO_SETTINGS_MODULE'] = 'sentry.conf.server'
 
@@ -70,7 +67,7 @@ def pytest_configure(config):
     # to assert that the user is always in sudo mode
     middleware = list(settings.MIDDLEWARE_CLASSES)
     sudo = middleware.index('sentry.middleware.sudo.SudoMiddleware')
-    middleware[sudo] = 'tests.middleware.SudoMiddleware'
+    middleware[sudo] = 'sentry.testutils.middleware.SudoMiddleware'
     settings.MIDDLEWARE_CLASSES = tuple(middleware)
 
     # enable draft features
