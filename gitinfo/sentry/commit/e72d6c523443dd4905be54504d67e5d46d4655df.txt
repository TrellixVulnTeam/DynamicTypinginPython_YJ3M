commit e72d6c523443dd4905be54504d67e5d46d4655df
Author: Katie Lundsgaard <katie@getsentry.com>
Date:   Tue Jun 27 10:34:11 2017 -0700

    Update scope and permissions of `GroupTombstoneEndpoint`

diff --git a/src/sentry/api/endpoints/group_tombstone.py b/src/sentry/api/endpoints/group_tombstone.py
index 582b2db3e7..181b016e19 100644
--- a/src/sentry/api/endpoints/group_tombstone.py
+++ b/src/sentry/api/endpoints/group_tombstone.py
@@ -1,7 +1,6 @@
 from __future__ import absolute_import
 
-from sentry.api.bases import Endpoint
-from sentry.api.bases.group import GroupPermission
+from sentry.api.bases.project import ProjectEndpoint
 from sentry.api.paginator import OffsetPaginator
 from sentry.api.serializers import serialize
 
@@ -10,10 +9,10 @@ from sentry.models import (
 )
 
 
-class GroupTombstoneEndpoint(Endpoint):
-    permission_classes = (GroupPermission,)
+class GroupTombstoneEndpoint(ProjectEndpoint):
+    # TODO (katie): figure out correct permissions
 
-    def get(self, request, organization_id, project_id):
+    def get(self, request, project):
         """
         Retrieve a Project's GroupTombstones
         ```````````````
@@ -26,7 +25,7 @@ class GroupTombstoneEndpoint(Endpoint):
         """
         queryset = GroupTombstone.objects.filter(
             id__in=GroupHash.objects.filter(
-                project=project_id
+                project=project
             ).values_list('group_tombstone', flat=True)
         )
 
diff --git a/src/sentry/api/urls.py b/src/sentry/api/urls.py
index 040555eee2..2b4581b764 100644
--- a/src/sentry/api/urls.py
+++ b/src/sentry/api/urls.py
@@ -481,7 +481,7 @@ urlpatterns = patterns(
         name='sentry-api-0-shared-group-details'),
 
     # Tombstone
-    url(r'^projects/(?P<organization_id>[^\/]+)/(?P<project_id>[^\/]+)/tombstone/$',
+    url(r'^projects/(?P<organization_slug>[^\/]+)/(?P<project_slug>[^\/]+)/tombstone/$',
         GroupTombstoneEndpoint.as_view(),
         name='sentry-api-0-group-tombstone'),
     url(r'^tombstone/(?P<tombstone_id>\d+)/$',
diff --git a/tests/sentry/api/endpoints/test_group_tombstone.py b/tests/sentry/api/endpoints/test_group_tombstone.py
index 081a3850c5..dde959ef3d 100644
--- a/tests/sentry/api/endpoints/test_group_tombstone.py
+++ b/tests/sentry/api/endpoints/test_group_tombstone.py
@@ -1,5 +1,7 @@
 from __future__ import absolute_import, print_function
 
+from django.core.urlresolvers import reverse
+
 from sentry.models import GroupHash, GroupTombstone
 from sentry.testutils import APITestCase
 
@@ -7,16 +9,22 @@ from sentry.testutils import APITestCase
 class GroupTombstoneTest(APITestCase):
 
     def test_simple(self):
-        # import pdb; pdb.set_trace()
-        self.login_as(user=self.user)
-        org = self.create_organization(
+        self.user = self.create_user('foo@example.com')
+        self.org = self.create_organization(
             owner=self.user,
+            name='Rowdy Tiger'
+        )
+        self.team = self.create_team(
+            organization=self.org,
+            name='Mariachi Band'
         )
-        project = self.create_project(
-            organization=org,
-            name='CoolProj',
+        self.project = self.create_project(
+            organization=self.org,
+            team=self.team,
+            name='Bengal',
         )
-        group = self.create_group(project=project)
+        self.login_as(self.user)
+        group = self.create_group(project=self.project)
         tombstone = GroupTombstone.objects.create(
             project_id=group.project_id,
             level=group.level,
@@ -31,9 +39,14 @@ class GroupTombstoneTest(APITestCase):
             group_tombstone=tombstone
         )
 
-        path = '/api/0/projects/{}/{}/tombstone/'.format(org.id, project.id)
-        response = self.client.get(path)
+        path = reverse('sentry-api-0-group-tombstone',
+            kwargs={
+                'organization_slug': self.org.slug,
+                'project_slug': self.project.slug,
+            }
+        )
 
+        response = self.client.get(path)
         assert response.status_code == 200, response
         assert response.data[0]['message'] == group.message
-        assert response.data[0]['project']['name'] == project.name
+        assert response.data[0]['project']['name'] == self.project.name
