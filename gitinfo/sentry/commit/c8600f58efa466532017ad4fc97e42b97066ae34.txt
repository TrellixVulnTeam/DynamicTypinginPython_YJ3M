commit c8600f58efa466532017ad4fc97e42b97066ae34
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Apr 14 16:15:00 2015 -0700

    Correct oauth data location

diff --git a/src/sentry/auth/providers/oauth2.py b/src/sentry/auth/providers/oauth2.py
index afc6c881c1..b2cb358749 100644
--- a/src/sentry/auth/providers/oauth2.py
+++ b/src/sentry/auth/providers/oauth2.py
@@ -174,7 +174,8 @@ class OAuth2Provider(Provider):
         raise NotImplementedError
 
     def refresh_identity(self, auth_identity):
-        refresh_token = auth_identity.data.get('refresh_token')
+        data = auth_identity.data.get('data')
+        refresh_token = data.get('refresh_token')
 
         if not refresh_token:
             raise IdentityNotValid('Missing refresh token')
@@ -209,7 +210,7 @@ class OAuth2Provider(Provider):
         if req.status_code != 200:
             raise Exception(formatted_error)
 
-        auth_identity.data.update(self.get_oauth_data(payload))
+        auth_identity.data['data'].update(self.get_oauth_data(payload))
         auth_identity.update(data=auth_identity.data)
 
         return True
