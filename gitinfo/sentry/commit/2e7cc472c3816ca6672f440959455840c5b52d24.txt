commit 2e7cc472c3816ca6672f440959455840c5b52d24
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Fri Aug 24 16:07:10 2018 -0700

    feat(discover): Improve error messages (#9513)
    
    Improve error messages for invalid limits, clear indicators upon next
    query run

diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/discover.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/discover.jsx
index 0400bf78ce..de1af5c9d0 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/discover.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/discover.jsx
@@ -4,7 +4,7 @@ import React from 'react';
 import styled from 'react-emotion';
 import {browserHistory} from 'react-router';
 
-import {addErrorMessage} from 'app/actionCreators/indicator';
+import {addErrorMessage, clearIndicators} from 'app/actionCreators/indicator';
 import {t} from 'app/locale';
 import Button from 'app/components/buttons/button';
 import HeaderSeparator from 'app/components/organizations/headerSeparator';
@@ -76,6 +76,8 @@ export default class OrganizationDiscover extends React.Component {
 
     this.setState({isFetchingQuery: true});
 
+    clearIndicators();
+
     queryBuilder.fetch().then(
       result => {
         const query = queryBuilder.getInternal();
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/queryBuilder.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/queryBuilder.jsx
index 07568da55f..3dc7354c08 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/queryBuilder.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/queryBuilder.jsx
@@ -178,6 +178,12 @@ export default function createQueryBuilder(initial = {}, organization) {
       return Promise.reject(new Error(t('No projects selected')));
     }
 
+    if (typeof data.limit === 'number') {
+      if (data.limit < 1 || data.limit > 1000) {
+        return Promise.reject(new Error(t('Invalid limit parameter')));
+      }
+    }
+
     return api
       .requestPromise(endpoint, {
         method: 'POST',
