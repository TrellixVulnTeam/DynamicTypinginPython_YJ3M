commit 229c2709149dd96331363eb8c779606791bcbb0f
Author: Alex Koshelev <daevaorn@gmail.com>
Date:   Mon Aug 5 02:54:32 2013 +0400

    Restore db state for objects taken from cache

diff --git a/src/sentry/manager.py b/src/sentry/manager.py
index fe4387d078..bf9e98ab4f 100644
--- a/src/sentry/manager.py
+++ b/src/sentry/manager.py
@@ -24,7 +24,7 @@ from celery.signals import task_postrun
 from django.conf import settings
 from django.contrib.auth.models import UserManager
 from django.core.signals import request_finished
-from django.db import models, transaction, IntegrityError
+from django.db import models, router, transaction, IntegrityError
 from django.db.models import Sum
 from django.db.models.signals import post_save, post_delete, post_init, class_prepared
 from django.utils import timezone
@@ -216,6 +216,8 @@ class BaseManager(models.Manager):
                 logger.error('Cache response returned invalid value %r', retval)
                 return self.get(**kwargs)
 
+            retval._state.db = router.db_for_read(self.model, **kwargs)
+
             return retval
         else:
             return self.get(**kwargs)
