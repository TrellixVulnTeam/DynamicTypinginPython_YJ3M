commit 8399c7b2ac3638d989a15673d1ccd8cfa6207a13
Author: Markus Unterwaditzer <markus@unterwaditzer.net>
Date:   Mon May 18 15:18:59 2020 +0200

    fix(store): Get organization from cache instead of db (#18878)

diff --git a/src/sentry/tasks/store.py b/src/sentry/tasks/store.py
index cf597dba3d..fb74941d08 100644
--- a/src/sentry/tasks/store.py
+++ b/src/sentry/tasks/store.py
@@ -25,7 +25,7 @@ from sentry.stacktraces.processing import process_stacktraces, should_process_fo
 from sentry.utils.canonical import CanonicalKeyDict, CANONICAL_TYPES
 from sentry.utils.dates import to_datetime
 from sentry.utils.sdk import set_current_project
-from sentry.models import ProjectOption, Activity, Project
+from sentry.models import ProjectOption, Activity, Project, Organization
 
 error_logger = logging.getLogger("sentry.errors.events")
 info_logger = logging.getLogger("sentry.store")
@@ -409,6 +409,11 @@ def _do_process_event(
     with sentry_sdk.start_span(op="tasks.store.process_event.get_project_from_cache"):
         project = Project.objects.get_from_cache(id=project_id)
 
+    with metrics.timer("tasks.store.process_event.organization.get_from_cache"):
+        project._organization_cache = Organization.objects.get_from_cache(
+            id=project.organization_id
+        )
+
     has_changed = bool(data_has_changed)
 
     with sentry_sdk.start_span(op="tasks.store.process_event.get_reprocessing_revision"):
