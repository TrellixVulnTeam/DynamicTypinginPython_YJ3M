commit 026539a92c3eaaba6815a738a67bc5d431efa700
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Fri Jun 5 11:31:38 2020 -0700

    build(github): Add pytest matcher for Github Actions (#19038)
    
    This adds a matcher for pytest failures so that they are annotated in GitHub

diff --git a/.github/pytest.json b/.github/pytest.json
new file mode 100644
index 0000000000..a5dc988f5e
--- /dev/null
+++ b/.github/pytest.json
@@ -0,0 +1,25 @@
+{
+  "problemMatcher": [
+    {
+      "owner": "pytest",
+      "pattern": [
+        {
+          "regexp": "^Traceback"
+        },
+        {
+          "regexp": "^\\s+File\\s\"(.*)\",\\sline\\s(\\d+),\\sin\\s(.*)$",
+          "file": 1,
+          "line": 2
+        },
+        {
+          "regexp": "^\\s+.*"
+        },
+        {
+          "regexp": "^(\\w+Error:.*)",
+          "message": 1,
+          "loop": true
+        }
+      ]
+    }
+  ]
+}
diff --git a/.github/workflows/acceptance.yml b/.github/workflows/acceptance.yml
index 373eda9565..69cb2a942a 100644
--- a/.github/workflows/acceptance.yml
+++ b/.github/workflows/acceptance.yml
@@ -206,6 +206,13 @@ jobs:
           run: |
             yarn webpack --display errors-only
 
+        # Setup custom pytest matcher, see https://github.com/actions/setup-node/issues/97
+        - name: Add pytest log matcher
+          if: always()
+          run: |
+            echo "::remove-matcher owner=pytest::"
+            echo "::add-matcher::.github/pytest.json"
+
         - name: Run acceptance tests (#${{ steps.config.outputs.matrix-instance-number }} of ${{ strategy.job-total }})
           if: always()
           uses: percy/exec-action@v0.3.0
