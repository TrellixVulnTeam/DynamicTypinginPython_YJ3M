commit 457041e1ca33e23a4f847fdbe9e91e4d3cb025cb
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Tue Feb 4 02:43:29 2014 -0800

    Don't assume that origin is formatted correctly
    
    Fixes https://app.getsentry.com/sentry/sentry/group/7454804/

diff --git a/src/sentry/utils/http.py b/src/sentry/utils/http.py
index 7999aa6e67..bc5827bced 100644
--- a/src/sentry/utils/http.py
+++ b/src/sentry/utils/http.py
@@ -108,6 +108,10 @@ def is_valid_origin(origin, project=None):
 
     parsed = urlparse(origin)
 
+    # There is no hostname, so the header is probably invalid
+    if parsed.hostname is None:
+        return False
+
     for valid in allowed:
         if '://' in valid:
             # Support partial uri matches that may include path
