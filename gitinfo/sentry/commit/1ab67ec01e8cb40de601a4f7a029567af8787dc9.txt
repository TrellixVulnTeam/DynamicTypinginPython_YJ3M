commit 1ab67ec01e8cb40de601a4f7a029567af8787dc9
Author: Alberto Leal <mail4alberto@gmail.com>
Date:   Thu Feb 27 11:28:41 2020 -0500

    feat(globalheader): Add allowClearTimeRange prop. (#17311)
    
    Enable or disable the ability for the user to clear the time range selection.

diff --git a/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/index.jsx b/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/index.jsx
index 99ce4858c2..415bf6d88f 100644
--- a/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/index.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/index.jsx
@@ -120,6 +120,11 @@ class GlobalSelectionHeader extends React.Component {
      */
     showRelative: PropTypes.bool,
 
+    /**
+     * Allow user to clear the time range selection
+     */
+    allowClearTimeRange: PropTypes.bool,
+
     // Callbacks //
     onChangeProjects: PropTypes.func,
     onUpdateProjects: PropTypes.func,
@@ -559,6 +564,7 @@ class GlobalSelectionHeader extends React.Component {
       showRelative,
       showDateSelector,
       showEnvironmentSelector,
+      allowClearTimeRange,
     } = this.props;
     const {period, start, end, utc} = this.props.selection.datetime || {};
 
@@ -645,6 +651,7 @@ class GlobalSelectionHeader extends React.Component {
                 onChange={this.handleChangeTime}
                 onUpdate={this.handleUpdateTime}
                 organization={organization}
+                allowClearTimeRange={allowClearTimeRange}
               />
             </HeaderItemPosition>
           </React.Fragment>
diff --git a/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx b/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx
index d4a013bfc1..e0ceeca9d4 100644
--- a/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx
@@ -111,6 +111,11 @@ class TimeRangeSelector extends React.PureComponent {
      * Just used for metrics
      */
     organization: SentryTypes.Organization,
+
+    /**
+     * Allow user to clear the time range selection
+     */
+    allowClearTimeRange: PropTypes.bool,
   };
 
   static defaultProps = {
@@ -229,6 +234,7 @@ class TimeRangeSelector extends React.PureComponent {
 
   handleClear = () => {
     const {onChange} = this.props;
+
     const newDateTime = {
       relative: null,
       start: null,
@@ -294,7 +300,7 @@ class TimeRangeSelector extends React.PureComponent {
   };
 
   render() {
-    const {showAbsolute, showRelative, organization} = this.props;
+    const {showAbsolute, showRelative, organization, allowClearTimeRange} = this.props;
     const {start, end, relative} = this.state;
 
     const shouldShowAbsolute = showAbsolute;
@@ -309,6 +315,9 @@ class TimeRangeSelector extends React.PureComponent {
 
     const relativeSelected = isAbsoluteSelected ? null : relative || DEFAULT_STATS_PERIOD;
 
+    const allowClear =
+      typeof allowClearTimeRange === 'boolean' ? allowClearTimeRange : true;
+
     return (
       <DropdownMenu
         isOpen={this.state.isOpen}
@@ -328,7 +337,7 @@ class TimeRangeSelector extends React.PureComponent {
               }
               hasChanges={this.state.hasChanges}
               onClear={this.handleClear}
-              allowClear
+              allowClear={allowClear}
               {...getActorProps()}
             >
               {getDynamicText({value: summary, fixed: 'start to end'})}
