commit 44bac2962d80039d94d6eef52c8e6e9efb7dd9ce
Author: Ted Kaemming <ted@kaemming.com>
Date:   Thu Feb 25 18:47:21 2016 -0800

    Only warn on bad rollup ranges for now.

diff --git a/dump.rdb b/dump.rdb
new file mode 100644
index 0000000000..eded7507d4
Binary files /dev/null and b/dump.rdb differ
diff --git a/src/sentry/tsdb/base.py b/src/sentry/tsdb/base.py
index e12738e558..c386e3ceb5 100644
--- a/src/sentry/tsdb/base.py
+++ b/src/sentry/tsdb/base.py
@@ -7,6 +7,7 @@ sentry.tsdb.base
 """
 from __future__ import absolute_import
 
+import logging
 from collections import OrderedDict
 from datetime import timedelta
 from django.conf import settings
@@ -15,6 +16,9 @@ from enum import Enum
 
 from sentry.utils.dates import to_timestamp
 
+
+logger = logging.getLogger(__name__)
+
 ONE_MINUTE = 60
 ONE_HOUR = ONE_MINUTE * 60
 ONE_DAY = ONE_HOUR * 24
@@ -119,12 +123,16 @@ class BaseTSDB(object):
 
         if rollup is None:
             rollups = filter(satisfies_range, self.rollups.items())
-            assert rollups, 'could not find rollup that satisfies range'
-            rollup = rollups[0][0]
+            if not rollups:
+                logger.warning('Could not find rollup that satisfies range: %r to %r', start_timestamp, end_timestamp)
+                rollup = rollups.keys()[-1]
+            else:
+                rollup = rollups[-1][0]
         else:
             samples = self.rollups.get(rollup)
             assert samples is not None, 'invalid rollup: {}'.format(rollup)
-            assert satisfies_range((rollup, samples))
+            if not satisfies_range((rollup, samples)):
+                logger.warning('Rollup %r does not satisfy range: %r to %r', rollup, start_timestamp, end_timestamp)
 
         return rollup
 
