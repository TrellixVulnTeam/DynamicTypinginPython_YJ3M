commit 7733ff641a0f4595910a42192b404499557ff515
Author: Mark Story <mark@mark-story.com>
Date:   Fri Apr 12 14:02:24 2019 -0400

    fix(ui) Update design of stream sort options (#12739)
    
    Make the stream sort options match the latest mockups. I've converted
    this component over to a styled component. This will unlock the
    potential to refactor this + savedsearch components to use common
    style/behavior components.
    
    Remove bottom border from dropdownbutton when it has focus. Make
    buttons fixed height to solve problems in percy.
    
    Fixes SEN-478

diff --git a/src/sentry/static/sentry/app/components/dropdownButton.jsx b/src/sentry/static/sentry/app/components/dropdownButton.jsx
index f9f2541b87..0d6d548b05 100644
--- a/src/sentry/static/sentry/app/components/dropdownButton.jsx
+++ b/src/sentry/static/sentry/app/components/dropdownButton.jsx
@@ -31,7 +31,7 @@ const StyledButton = styled(({isOpen, ...props}) => <Button {...props} />)`
   z-index: 2;
   box-shadow: ${p => (p.isOpen || p.disabled ? 'none' : p.theme.dropShadowLight)};
 
-  &,
+  &:focus,
   &:hover {
     border-bottom-color: ${p => (p.isOpen ? 'transparent' : p.theme.borderDark)};
   }
diff --git a/src/sentry/static/sentry/app/utils/theme.jsx b/src/sentry/static/sentry/app/utils/theme.jsx
index eeb5e59eff..1aafd3efa7 100644
--- a/src/sentry/static/sentry/app/utils/theme.jsx
+++ b/src/sentry/static/sentry/app/utils/theme.jsx
@@ -8,6 +8,7 @@ const theme = {
   offWhite2: '#E7E1EC',
   whiteDark: '#fbfbfc',
   white: '#FFFFFF',
+  foreground: '#493E54',
 
   gray1: '#BDB4C7',
   gray2: '#9585A3',
diff --git a/src/sentry/static/sentry/app/views/stream/filters.jsx b/src/sentry/static/sentry/app/views/stream/filters.jsx
index 3b1f782be8..621352500f 100644
--- a/src/sentry/static/sentry/app/views/stream/filters.jsx
+++ b/src/sentry/static/sentry/app/views/stream/filters.jsx
@@ -98,9 +98,7 @@ class StreamFilters extends React.Component {
           </PageHeading>
         </Feature>
         <div className="search-container">
-          <div className="stream-dropdown">
-            <SortOptions sort={sort} onSelect={onSortChange} />
-          </div>
+          <SortOptions sort={sort} onSelect={onSortChange} />
 
           <Feature features={['org-saved-searches']}>
             <OrganizationSavedSearchSelector
diff --git a/src/sentry/static/sentry/app/views/stream/sortOptions.jsx b/src/sentry/static/sentry/app/views/stream/sortOptions.jsx
index 471d940eaf..141ba3329b 100644
--- a/src/sentry/static/sentry/app/views/stream/sortOptions.jsx
+++ b/src/sentry/static/sentry/app/views/stream/sortOptions.jsx
@@ -1,8 +1,11 @@
 import PropTypes from 'prop-types';
 import React from 'react';
-import DropdownLink from 'app/components/dropdownLink';
+import styled from 'react-emotion';
+import DropdownButton from 'app/components/dropdownButton';
+import DropdownMenu from 'app/components/dropdownMenu';
 import MenuItem from 'app/components/menuItem';
 import {t} from 'app/locale';
+import space from 'app/styles/space';
 
 class SortOptions extends React.PureComponent {
   static propTypes = {
@@ -25,13 +28,13 @@ class SortOptions extends React.PureComponent {
 
   getMenuItem = key => {
     return (
-      <MenuItem
+      <StyledMenuItem
         onSelect={this.onSelect}
         eventKey={key}
         isActive={this.state.sortKey === key}
       >
         {this.getSortLabel(key)}
-      </MenuItem>
+      </StyledMenuItem>
     );
   };
 
@@ -57,22 +60,88 @@ class SortOptions extends React.PureComponent {
   };
 
   render() {
-    const dropdownTitle = (
-      <span>
-        <strong>{t('Sort by')}:</strong>
-        &nbsp; {this.getSortLabel(this.state.sortKey)}
-      </span>
-    );
-
     return (
-      <DropdownLink btnGroup={true} title={dropdownTitle}>
-        {this.getMenuItem('priority')}
-        {this.getMenuItem('date')}
-        {this.getMenuItem('new')}
-        {this.getMenuItem('freq')}
-      </DropdownLink>
+      <Container>
+        <DropdownMenu>
+          {({isOpen, getMenuProps, getActorProps}) => {
+            return (
+              <React.Fragment>
+                <StyledDropdownButton {...getActorProps()} isOpen={isOpen}>
+                  <em>{t('Sort by')}: &nbsp; </em>
+                  {this.getSortLabel(this.state.sortKey)}
+                </StyledDropdownButton>
+                <MenuContainer {...getMenuProps({isStyled: true})} isOpen={isOpen}>
+                  {this.getMenuItem('priority')}
+                  {this.getMenuItem('date')}
+                  {this.getMenuItem('new')}
+                  {this.getMenuItem('freq')}
+                </MenuContainer>
+              </React.Fragment>
+            );
+          }}
+        </DropdownMenu>
+      </Container>
     );
   }
 }
 
+const Container = styled.div`
+  position: relative;
+  margin-right: ${space(0.5)};
+`;
+
+const StyledDropdownButton = styled(DropdownButton)`
+  z-index: ${p => p.theme.zIndex.dropdownAutocomplete.actor};
+  white-space: nowrap;
+  font-weight: normal;
+
+  /* Hack but search input, and sort dropdown are not standard size buttons yet */
+  height: 38px;
+  & > span {
+    padding: 11px 16px;
+    font-size: ${p => p.theme.fontSizeMedium};
+  }
+  & em {
+    font-style: normal;
+    color: ${p => p.theme.gray2};
+  }
+`;
+
+const StyledMenuItem = styled(MenuItem)`
+  font-size: ${p => p.theme.fontSizeMedium};
+  & a {
+    color: ${p => p.theme.foreground};
+    display: block;
+    padding: ${space(0.5)} ${space(2)};
+  }
+  & a:hover {
+    background: ${p => p.theme.offWhite};
+  }
+  &.active a,
+  &.active a:hover {
+    color: ${p => p.theme.white};
+    background: ${p => p.theme.purple};
+  }
+`;
+
+const MenuContainer = styled.ul`
+  list-style: none;
+  width: 100%;
+
+  position: absolute;
+  /* Buttons are 38px tall, this has to be -1 to get button overlapping the menu */
+  top: 37px;
+  padding: 0 0 ${space(0.5)} 0;
+  margin: 0;
+  z-index: ${p => p.theme.zIndex.dropdownAutocomplete.menu};
+
+  background: ${p => p.theme.background};
+  border-radius: 0 0 ${p => p.theme.borderRadius} ${p => p.theme.borderRadius};
+  box-shadow: 0 1px 3px rgba(70, 82, 98, 0.25);
+  border: 1px solid ${p => p.theme.borderDark};
+  background-clip: padding-box;
+
+  display: ${p => (p.isOpen ? 'block' : 'none')};
+`;
+
 export default SortOptions;
diff --git a/tests/js/spec/views/__snapshots__/organizationTeamProjects.spec.jsx.snap b/tests/js/spec/views/__snapshots__/organizationTeamProjects.spec.jsx.snap
index e145b1d00b..a646941c79 100644
--- a/tests/js/spec/views/__snapshots__/organizationTeamProjects.spec.jsx.snap
+++ b/tests/js/spec/views/__snapshots__/organizationTeamProjects.spec.jsx.snap
@@ -164,18 +164,18 @@ exports[`OrganizationTeamProjects Should render 1`] = `
                                           size="xsmall"
                                         >
                                           <Component
-                                            className="css-o27a2e-StyledButton e1yghndz1"
+                                            className="css-qfyoa0-StyledButton e1yghndz1"
                                             isOpen={false}
                                             size="xsmall"
                                           >
                                             <Button
-                                              className="css-o27a2e-StyledButton e1yghndz1"
+                                              className="css-qfyoa0-StyledButton e1yghndz1"
                                               disabled={false}
                                               size="xsmall"
                                             >
                                               <StyledButton
                                                 aria-disabled={false}
-                                                className="css-o27a2e-StyledButton e1yghndz1"
+                                                className="css-qfyoa0-StyledButton e1yghndz1"
                                                 disabled={false}
                                                 onClick={[Function]}
                                                 role="button"
@@ -183,14 +183,14 @@ exports[`OrganizationTeamProjects Should render 1`] = `
                                               >
                                                 <Component
                                                   aria-disabled={false}
-                                                  className="e1yghndz1 css-108zzii-StyledButton-getColors-StyledButton eqrebog0"
+                                                  className="e1yghndz1 css-1momm09-StyledButton-getColors-StyledButton eqrebog0"
                                                   onClick={[Function]}
                                                   role="button"
                                                   size="xsmall"
                                                 >
                                                   <button
                                                     aria-disabled={false}
-                                                    className="e1yghndz1 css-108zzii-StyledButton-getColors-StyledButton eqrebog0"
+                                                    className="e1yghndz1 css-1momm09-StyledButton-getColors-StyledButton eqrebog0"
                                                     onClick={[Function]}
                                                     role="button"
                                                     size="xsmall"
diff --git a/tests/js/spec/views/inviteMember/__snapshots__/inviteMember.spec.jsx.snap b/tests/js/spec/views/inviteMember/__snapshots__/inviteMember.spec.jsx.snap
index 743325a219..1a024a9181 100644
--- a/tests/js/spec/views/inviteMember/__snapshots__/inviteMember.spec.jsx.snap
+++ b/tests/js/spec/views/inviteMember/__snapshots__/inviteMember.spec.jsx.snap
@@ -510,21 +510,21 @@ exports[`InviteMember should render roles when available and allowed, and handle
                                               >
                                                 <Component
                                                   aria-label="Add Team"
-                                                  className="css-w99oc4-StyledButton e1yghndz1"
+                                                  className="css-t6oz6z-StyledButton e1yghndz1"
                                                   disabled={true}
                                                   isOpen={false}
                                                   size="xsmall"
                                                 >
                                                   <Button
                                                     aria-label="Add Team"
-                                                    className="css-w99oc4-StyledButton e1yghndz1"
+                                                    className="css-t6oz6z-StyledButton e1yghndz1"
                                                     disabled={true}
                                                     size="xsmall"
                                                   >
                                                     <StyledButton
                                                       aria-disabled={true}
                                                       aria-label="Add Team"
-                                                      className="css-w99oc4-StyledButton e1yghndz1"
+                                                      className="css-t6oz6z-StyledButton e1yghndz1"
                                                       disabled={true}
                                                       href={null}
                                                       onClick={[Function]}
@@ -535,7 +535,7 @@ exports[`InviteMember should render roles when available and allowed, and handle
                                                       <Component
                                                         aria-disabled={true}
                                                         aria-label="Add Team"
-                                                        className="e1yghndz1 css-10lmrhm-StyledButton-getColors-StyledButton eqrebog0"
+                                                        className="e1yghndz1 css-a1a4aj-StyledButton-getColors-StyledButton eqrebog0"
                                                         href={null}
                                                         onClick={[Function]}
                                                         role="button"
@@ -545,7 +545,7 @@ exports[`InviteMember should render roles when available and allowed, and handle
                                                         <button
                                                           aria-disabled={true}
                                                           aria-label="Add Team"
-                                                          className="e1yghndz1 css-10lmrhm-StyledButton-getColors-StyledButton eqrebog0"
+                                                          className="e1yghndz1 css-a1a4aj-StyledButton-getColors-StyledButton eqrebog0"
                                                           href={null}
                                                           onClick={[Function]}
                                                           role="button"
diff --git a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap
index 027248e378..abd1184e10 100644
--- a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap
+++ b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/index.spec.jsx.snap
@@ -661,6 +661,7 @@ exports[`OrganizationIntegrations render() with installed integrations Displays
                                                 "fontSizeLarge": "16px",
                                                 "fontSizeMedium": "14px",
                                                 "fontSizeSmall": "12px",
+                                                "foreground": "#493E54",
                                                 "gray1": "#BDB4C7",
                                                 "gray2": "#9585A3",
                                                 "gray3": "#645574",
@@ -929,6 +930,7 @@ exports[`OrganizationIntegrations render() with installed integrations Displays
                                                         "fontSizeLarge": "16px",
                                                         "fontSizeMedium": "14px",
                                                         "fontSizeSmall": "12px",
+                                                        "foreground": "#493E54",
                                                         "gray1": "#BDB4C7",
                                                         "gray2": "#9585A3",
                                                         "gray3": "#645574",
@@ -2126,6 +2128,7 @@ exports[`OrganizationIntegrations render() with installed integrations Displays
                                                 "fontSizeLarge": "16px",
                                                 "fontSizeMedium": "14px",
                                                 "fontSizeSmall": "12px",
+                                                "foreground": "#493E54",
                                                 "gray1": "#BDB4C7",
                                                 "gray2": "#9585A3",
                                                 "gray3": "#645574",
@@ -2394,6 +2397,7 @@ exports[`OrganizationIntegrations render() with installed integrations Displays
                                                         "fontSizeLarge": "16px",
                                                         "fontSizeMedium": "14px",
                                                         "fontSizeSmall": "12px",
+                                                        "foreground": "#493E54",
                                                         "gray1": "#BDB4C7",
                                                         "gray2": "#9585A3",
                                                         "gray3": "#645574",
@@ -3881,6 +3885,7 @@ exports[`OrganizationIntegrations render() without integrations Displays integra
                                                 "fontSizeLarge": "16px",
                                                 "fontSizeMedium": "14px",
                                                 "fontSizeSmall": "12px",
+                                                "foreground": "#493E54",
                                                 "gray1": "#BDB4C7",
                                                 "gray2": "#9585A3",
                                                 "gray3": "#645574",
@@ -4149,6 +4154,7 @@ exports[`OrganizationIntegrations render() without integrations Displays integra
                                                         "fontSizeLarge": "16px",
                                                         "fontSizeMedium": "14px",
                                                         "fontSizeSmall": "12px",
+                                                        "foreground": "#493E54",
                                                         "gray1": "#BDB4C7",
                                                         "gray2": "#9585A3",
                                                         "gray3": "#645574",
@@ -4645,6 +4651,7 @@ exports[`OrganizationIntegrations render() without integrations Displays integra
                                                 "fontSizeLarge": "16px",
                                                 "fontSizeMedium": "14px",
                                                 "fontSizeSmall": "12px",
+                                                "foreground": "#493E54",
                                                 "gray1": "#BDB4C7",
                                                 "gray2": "#9585A3",
                                                 "gray3": "#645574",
@@ -4913,6 +4920,7 @@ exports[`OrganizationIntegrations render() without integrations Displays integra
                                                         "fontSizeLarge": "16px",
                                                         "fontSizeMedium": "14px",
                                                         "fontSizeSmall": "12px",
+                                                        "foreground": "#493E54",
                                                         "gray1": "#BDB4C7",
                                                         "gray2": "#9585A3",
                                                         "gray3": "#645574",
diff --git a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/sentryAppInstallations.spec.jsx.snap b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/sentryAppInstallations.spec.jsx.snap
index af49d78a46..62de4338a9 100644
--- a/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/sentryAppInstallations.spec.jsx.snap
+++ b/tests/js/spec/views/settings/organizationIntegrations/__snapshots__/sentryAppInstallations.spec.jsx.snap
@@ -339,6 +339,7 @@ exports[`Sentry App Installations when Apps exist displays all Apps owned by the
                                       "fontSizeLarge": "16px",
                                       "fontSizeMedium": "14px",
                                       "fontSizeSmall": "12px",
+                                      "foreground": "#493E54",
                                       "gray1": "#BDB4C7",
                                       "gray2": "#9585A3",
                                       "gray3": "#645574",
@@ -607,6 +608,7 @@ exports[`Sentry App Installations when Apps exist displays all Apps owned by the
                                               "fontSizeLarge": "16px",
                                               "fontSizeMedium": "14px",
                                               "fontSizeSmall": "12px",
+                                              "foreground": "#493E54",
                                               "gray1": "#BDB4C7",
                                               "gray2": "#9585A3",
                                               "gray3": "#645574",
