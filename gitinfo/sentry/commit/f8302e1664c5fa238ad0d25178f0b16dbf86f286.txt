commit f8302e1664c5fa238ad0d25178f0b16dbf86f286
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Thu May 17 15:14:20 2018 -0700

    ref(settings): Redirect the rest of org settings (#8472)

diff --git a/src/sentry/static/sentry/app/routes.jsx b/src/sentry/static/sentry/app/routes.jsx
index 03d33ae400..8ac7495b4d 100644
--- a/src/sentry/static/sentry/app/routes.jsx
+++ b/src/sentry/static/sentry/app/routes.jsx
@@ -764,7 +764,17 @@ function routes() {
               path="teams/:teamId/settings/"
               to="/settings/:orgId/teams/:teamId/settings/"
             />
-            {orgSettingsRoutes}
+            <Redirect path="settings/" to="/settings/:orgId/" />
+            <Redirect path="api-keys/" to="/settings/:orgId/api-keys/" />
+            <Redirect path="api-keys/:apiKey/" to="/settings/:orgId/api-keys/:apiKey/" />
+            <Redirect path="members/" to="/settings/:orgId/members/" />
+            <Redirect path="members/new/" to="/settings/:orgId/members/new/" />
+            <Redirect
+              path="members/:memberId/"
+              to="/settings/:orgId/members/:memberId/"
+            />
+            <Redirect path="rate-limits/" to="/settings/:orgId/rate-limits/" />
+            <Redirect path="repos/" to="/settings/:orgId/repos/" />
             <Route path="stats/" component={errorHandler(OrganizationStats)} />
           </Route>
 
diff --git a/src/sentry/static/sentry/app/views/settings/components/forms/form.jsx b/src/sentry/static/sentry/app/views/settings/components/forms/form.jsx
index a361f15b0b..de405e240f 100644
--- a/src/sentry/static/sentry/app/views/settings/components/forms/form.jsx
+++ b/src/sentry/static/sentry/app/views/settings/components/forms/form.jsx
@@ -34,6 +34,7 @@ export default class Form extends React.Component {
     model: PropTypes.object,
     apiMethod: PropTypes.string,
     apiEndpoint: PropTypes.string,
+    'data-test-id': PropTypes.string,
   };
 
   static defaultProps = {
@@ -144,7 +145,11 @@ export default class Form extends React.Component {
     let shouldShowFooter = typeof hideFooter !== 'undefined' ? !hideFooter : !saveOnBlur;
 
     return (
-      <form onSubmit={this.onSubmit} className={className}>
+      <form
+        onSubmit={this.onSubmit}
+        className={className}
+        data-test-id={this.props['data-test-id']}
+      >
         <div>{children}</div>
 
         {shouldShowFooter && (
diff --git a/src/sentry/static/sentry/app/views/settings/organizationRateLimits/organizationRateLimits.jsx b/src/sentry/static/sentry/app/views/settings/organizationRateLimits/organizationRateLimits.jsx
index 92fff2f15f..13f5d34384 100644
--- a/src/sentry/static/sentry/app/views/settings/organizationRateLimits/organizationRateLimits.jsx
+++ b/src/sentry/static/sentry/app/views/settings/organizationRateLimits/organizationRateLimits.jsx
@@ -65,7 +65,7 @@ export default class OrganizationRateLimit extends React.Component {
             </PanelAlert>
 
             <Form
-              className="ref-rate-limit-editor"
+              data-test-id="rate-limit-editor"
               saveOnBlur
               allowUndo
               apiMethod="PUT"
diff --git a/tests/acceptance/test_dashboard.py b/tests/acceptance/test_dashboard.py
index 0f4c6d0b7d..6b60f40668 100644
--- a/tests/acceptance/test_dashboard.py
+++ b/tests/acceptance/test_dashboard.py
@@ -56,6 +56,7 @@ class DashboardTest(AcceptanceTestCase):
         self.project.update(first_event=timezone.now())
         self.browser.get(self.path)
         self.browser.wait_until_not('.loading-indicator')
+        self.browser.wait_until('[data-test-id] figure')
         self.browser.snapshot('org dash one issue')
 
 
diff --git a/tests/acceptance/test_issue_details.py b/tests/acceptance/test_issue_details.py
index 6a5ef2eb9f..363bb5fb4f 100644
--- a/tests/acceptance/test_issue_details.py
+++ b/tests/acceptance/test_issue_details.py
@@ -65,6 +65,7 @@ class IssueDetailsTest(AcceptanceTestCase):
             '/{}/{}/issues/{}/events/{}/'.format(self.org.slug, self.project.slug, event.group.id, event.id)
         )
         self.browser.wait_until('.event-details-container')
+        self.browser.wait_until_not('.loading-indicator')
         self.browser.snapshot('issue details javascript - event details')
 
     def test_rust_event(self):
diff --git a/tests/acceptance/test_organization_rate_limits.py b/tests/acceptance/test_organization_rate_limits.py
index 5891b0c24c..c0c63e956e 100644
--- a/tests/acceptance/test_organization_rate_limits.py
+++ b/tests/acceptance/test_organization_rate_limits.py
@@ -33,16 +33,16 @@ class OrganizationRateLimitsTest(AcceptanceTestCase):
     def test_with_rate_limits(self):
         self.project.update(first_event=timezone.now())
         self.browser.get(self.path)
-        self.browser.wait_until('.organization-home')
         self.browser.wait_until_not('.loading-indicator')
+        self.browser.wait_until('[data-test-id="rate-limit-editor"]')
         self.browser.snapshot('organization rate limits with quota')
-        assert self.browser.element_exists('.ref-rate-limit-editor')
+        assert self.browser.element_exists('[data-test-id="rate-limit-editor"]')
 
     @patch('sentry.app.quotas.get_maximum_quota', Mock(return_value=(0, 60)))
     def test_without_rate_limits(self):
         self.project.update(first_event=timezone.now())
         self.browser.get(self.path)
-        self.browser.wait_until('.organization-home')
         self.browser.wait_until_not('.loading-indicator')
+        self.browser.wait_until('[data-test-id="rate-limit-editor"]')
         self.browser.snapshot('organization rate limits without quota')
-        assert self.browser.element_exists('.ref-rate-limit-editor')
+        assert self.browser.element_exists('[data-test-id="rate-limit-editor"]')
diff --git a/tests/acceptance/test_organization_settings.py b/tests/acceptance/test_organization_settings.py
index 4c0ef735ee..717e44460c 100644
--- a/tests/acceptance/test_organization_settings.py
+++ b/tests/acceptance/test_organization_settings.py
@@ -26,19 +26,15 @@ class OrganizationSettingsTest(AcceptanceTestCase):
         self.login_as(self.user)
         self.path = '/organizations/{}/settings/'.format(self.org.slug)
 
-    def load_organization_helper(self, snapshot_name):
-        self.browser.wait_until('.organization-home')
+    def load_organization_helper(self, snapshot_name=None):
         self.browser.wait_until_not('.loading-indicator')
-        self.browser.snapshot('organization settings -- ' + snapshot_name)
+        if snapshot_name is not None:
+            self.browser.snapshot('organization settings -- ' + snapshot_name)
         assert self.browser.element_exists('.ref-organization-settings')
 
     def renders_2fa_setting(self):
         return self.browser.element_exists('#require2FA')
 
-    def test_simple(self):
-        self.browser.get(self.path)
-        self.load_organization_helper("Simple")
-
     def test_disabled_2fa_feature(self):
         user_owner = self.create_user('owner@example.com')
         organization = self.create_organization(name="Example", owner=user_owner)
@@ -46,7 +42,7 @@ class OrganizationSettingsTest(AcceptanceTestCase):
         path = '/organizations/%s/settings/' % organization.slug
 
         self.browser.get(path)
-        self.load_organization_helper("disabled 2fa feature")
+        self.load_organization_helper()
         assert not self.renders_2fa_setting()
 
     def test_renders_2fa_setting_for_owner(self):
@@ -57,7 +53,7 @@ class OrganizationSettingsTest(AcceptanceTestCase):
 
         with self.feature('organizations:require-2fa'):
             self.browser.get(path)
-            self.load_organization_helper("renders 2fa setting for organization owner")
+            self.load_organization_helper()
             assert self.renders_2fa_setting()
 
     def test_renders_2fa_setting_for_manager(self):
@@ -70,7 +66,7 @@ class OrganizationSettingsTest(AcceptanceTestCase):
 
         with self.feature('organizations:require-2fa'):
             self.browser.get(path)
-            self.load_organization_helper("renders 2fa setting for organization manager")
+            self.load_organization_helper()
             assert self.renders_2fa_setting()
 
     def test_setting_2fa_without_2fa_enabled(self):
