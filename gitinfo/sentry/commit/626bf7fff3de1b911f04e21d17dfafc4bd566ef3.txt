commit 626bf7fff3de1b911f04e21d17dfafc4bd566ef3
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Jan 31 12:23:01 2019 -0800

    fix(monitors): Correct portless API root

diff --git a/src/sentry/utils/monitors.py b/src/sentry/utils/monitors.py
index e7e3b05c8d..f617d21012 100644
--- a/src/sentry/utils/monitors.py
+++ b/src/sentry/utils/monitors.py
@@ -15,7 +15,9 @@ def get_api_root_from_dsn(dsn):
     if not dsn:
         return
     parsed = urlparse(dsn)
-    return u'{}://{}:{}'.format(parsed.scheme, parsed.hostname, parsed.port)
+    if parsed.port:
+        return u'{}://{}:{}'.format(parsed.scheme, parsed.hostname, parsed.port)
+    return u'{}://{}'.format(parsed.scheme, parsed.hostname)
 
 
 SENTRY_DSN = settings.SENTRY_MONITOR_DSN
diff --git a/tests/sentry/utils/test_monitors.py b/tests/sentry/utils/test_monitors.py
new file mode 100644
index 0000000000..3e81d835ef
--- /dev/null
+++ b/tests/sentry/utils/test_monitors.py
@@ -0,0 +1,13 @@
+from __future__ import absolute_import
+
+from sentry.utils.monitors import get_api_root_from_dsn
+
+
+def test_get_api_root_from_dsn_with_port():
+    rv = get_api_root_from_dsn('https://apikey@sentry.io:8080')
+    assert rv == 'https://sentry.io:8080'
+
+
+def test_get_api_root_from_dsn_without_port():
+    rv = get_api_root_from_dsn('https://apikey@sentry.io')
+    assert rv == 'https://sentry.io'
