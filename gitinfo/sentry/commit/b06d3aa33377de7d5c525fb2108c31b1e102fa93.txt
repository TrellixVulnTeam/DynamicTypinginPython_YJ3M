commit b06d3aa33377de7d5c525fb2108c31b1e102fa93
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Thu Aug 23 16:08:21 2018 -0700

    feat(discover): Add sidebar icon behind feature flag (#9492)
    
    Add organization:discover feature flag and sidebar icon

diff --git a/src/sentry/api/serializers/models/organization.py b/src/sentry/api/serializers/models/organization.py
index 743ee86180..1159510086 100644
--- a/src/sentry/api/serializers/models/organization.py
+++ b/src/sentry/api/serializers/models/organization.py
@@ -137,6 +137,8 @@ class DetailedOrganizationSerializer(OrganizationSerializer):
             feature_list.append('relay')
         if features.has('organizations:health', obj, actor=user):
             feature_list.append('health')
+        if features.has('organizations:discover', obj, actor=user):
+            feature_list.append('discover')
         if OrganizationOption.objects.filter(
                 organization=obj, key__in=LEGACY_RATE_LIMIT_OPTIONS).exists():
             feature_list.append('legacy-rate-limits')
diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 08b1234bae..2416ab29d6 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -782,6 +782,7 @@ SENTRY_FEATURES = {
     'organizations:suggested-commits': True,
     'organizations:relay': False,
     'organizations:health': False,
+    'organizations:discover': False,
     'projects:global-events': False,
     'projects:plugins': True,
     'projects:dsym': False,
diff --git a/src/sentry/features/__init__.py b/src/sentry/features/__init__.py
index f83548a54a..b5807547c6 100644
--- a/src/sentry/features/__init__.py
+++ b/src/sentry/features/__init__.py
@@ -31,6 +31,7 @@ default_manager.add('organizations:unreleased-changes', OrganizationFeature)  #
 default_manager.add('organizations:environments', OrganizationFeature)  # NOQA
 default_manager.add('organizations:relay', OrganizationFeature)  # NOQA
 default_manager.add('organizations:health', OrganizationFeature)  # NOQA
+default_manager.add('organizations:discover', OrganizationFeature)  # NOQA
 default_manager.add('projects:similarity-view', ProjectFeature)  # NOQA
 default_manager.add('projects:global-events', ProjectFeature)  # NOQA
 default_manager.add('projects:plugins', ProjectPluginFeature)  # NOQA
diff --git a/src/sentry/static/sentry/app/components/sidebar/index.jsx b/src/sentry/static/sentry/app/components/sidebar/index.jsx
index c7113dc606..33abc5b2c3 100644
--- a/src/sentry/static/sentry/app/components/sidebar/index.jsx
+++ b/src/sentry/static/sentry/app/components/sidebar/index.jsx
@@ -12,6 +12,7 @@ import {load as loadIncidents} from 'app/actionCreators/incidents';
 import {t} from 'app/locale';
 import ConfigStore from 'app/stores/configStore';
 import InlineSvg from 'app/components/inlineSvg';
+import Feature from 'app/components/feature';
 import SentryTypes from 'app/sentryTypes';
 import PreferencesStore from 'app/stores/preferencesStore';
 import theme from 'app/utils/theme';
@@ -194,6 +195,15 @@ class Sidebar extends React.Component {
                   label={t('Projects')}
                   to={`/${organization.slug}/`}
                 />
+                <Feature feature={['discover']}>
+                  <SidebarItem
+                    {...sidebarItemProps}
+                    onClick={this.hidePanel}
+                    icon={<InlineSvg src="icon-search" />}
+                    label={t('Discover')}
+                    to={`/organizations/${organization.slug}/discover/`}
+                  />
+                </Feature>
               </SidebarSection>
 
               <SidebarSection>
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/index.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/index.jsx
index 4f41e80475..7b2a60b3bf 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/index.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/index.jsx
@@ -49,7 +49,7 @@ const OrganizationDiscoverContainer = createReactClass({
 
   render() {
     const {isLoading} = this.state;
-    const hasFeature = this.getFeatures().has('internal-catchall');
+    const hasFeature = this.getFeatures().has('discover');
 
     if (!hasFeature) return this.renderComingSoon();
 
