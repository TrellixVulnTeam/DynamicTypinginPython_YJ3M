commit a0a41341ec78d96c55ba04224411319c1faa2478
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 10 21:29:38 2012 -0800

    Use select2 on appearance settings

diff --git a/src/sentry/templates/sentry/account/appearance.html b/src/sentry/templates/sentry/account/appearance.html
index 188cb984a3..ca4f65be6d 100644
--- a/src/sentry/templates/sentry/account/appearance.html
+++ b/src/sentry/templates/sentry/account/appearance.html
@@ -17,7 +17,7 @@
 {% endblock %}
 
 {% block inner %}
-    <form action="" method="post">
+    <form class="form-stacked" action="" method="post" id="appearance_form">
         {% csrf_token %}
 
         {{ form|as_crispy_errors }}
@@ -43,4 +43,10 @@
             <button type="submit" class="btn btn-primary">{% trans "Save Changes" %}</button>
         </fieldset>
     </form>
+
+    <script>
+    $('#appearance_form select').select2({
+        width: 'element'
+    });
+    </script>
 {% endblock %}
diff --git a/src/sentry/web/forms/accounts.py b/src/sentry/web/forms/accounts.py
index 9d1be64aba..bbceb23df0 100644
--- a/src/sentry/web/forms/accounts.py
+++ b/src/sentry/web/forms/accounts.py
@@ -107,11 +107,11 @@ class AccountSettingsForm(forms.Form):
 
 class AppearanceSettingsForm(forms.Form):
     language = forms.ChoiceField(label=_('Language'), choices=settings.LANGUAGES, required=False)
-    stacktrace_order = forms.ChoiceField(label=_('Stacktrace order'), choices=(
-        ('', 'Default'),
-        ('1', 'Most recent call last'),
-        ('2', 'Most recent call first'),
-    ), required=False)
+    stacktrace_order = forms.TypedChoiceField(label=_('Stacktrace order'), choices=(
+        (-1, 'Default (let Sentry decide)'),
+        (1, 'Most recent call last'),
+        (2, 'Most recent call first'),
+    ), help_text='Choose the default ordering of frames in stacktraces.', required=False, coerce=int)
 
     def __init__(self, user, *args, **kwargs):
         self.user = user
diff --git a/src/sentry/web/frontend/accounts.py b/src/sentry/web/frontend/accounts.py
index 2d006c51ee..4698633d9b 100644
--- a/src/sentry/web/frontend/accounts.py
+++ b/src/sentry/web/frontend/accounts.py
@@ -135,7 +135,7 @@ def appearance_settings(request):
 
     form = AppearanceSettingsForm(request.user, request.POST or None, initial={
         'language': options.get('language') or request.LANGUAGE_CODE,
-        'stacktrace_order': options.get('stacktrace_order'),
+        'stacktrace_order': int(options.get('stacktrace_order', -1) or -1),
     })
     if form.is_valid():
         form.save()
