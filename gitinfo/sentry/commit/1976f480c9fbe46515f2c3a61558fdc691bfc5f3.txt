commit 1976f480c9fbe46515f2c3a61558fdc691bfc5f3
Author: Jan Michael Auer <account@jauer.org>
Date:   Wed Oct 3 08:42:21 2018 +0200

    fix: Remaining potential for race in DIF upload (#9974)

diff --git a/src/sentry/models/dsymfile.py b/src/sentry/models/dsymfile.py
index 97bc3dc8d5..1bbfe1598c 100644
--- a/src/sentry/models/dsymfile.py
+++ b/src/sentry/models/dsymfile.py
@@ -293,7 +293,8 @@ def create_dsym_from_id(project, dsym_type, cpu_name, debug_id,
         fileobj.seek(0, 0)
 
         try:
-            rv = ProjectDSymFile.objects.get(debug_id=debug_id, project=project)
+            rv = ProjectDSymFile.objects.select_related('file') \
+                .get(debug_id=debug_id, project=project)
             if rv.file.checksum == checksum:
                 return rv, False
         except ProjectDSymFile.DoesNotExist:
