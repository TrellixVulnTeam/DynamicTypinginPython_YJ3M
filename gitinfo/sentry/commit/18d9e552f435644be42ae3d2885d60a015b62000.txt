commit 18d9e552f435644be42ae3d2885d60a015b62000
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Tue Nov 15 13:21:32 2016 -0800

    api: prevent blowing up from a TypeError in BrowserExtensionFilter with garbage input (#4532)

diff --git a/src/sentry/filters/browser_extensions.py b/src/sentry/filters/browser_extensions.py
index 0ef64817d7..75253fe109 100644
--- a/src/sentry/filters/browser_extensions.py
+++ b/src/sentry/filters/browser_extensions.py
@@ -54,13 +54,13 @@ class BrowserExtensionsFilter(Filter):
     def get_exception_value(self, data):
         try:
             return data['sentry.interfaces.Exception']['values'][0]['value']
-        except LookupError:
+        except (LookupError, TypeError):
             return ''
 
     def get_exception_source(self, data):
         try:
             return data['sentry.interfaces.Exception']['values'][0]['stacktrace']['frames'][-1]['abs_path']
-        except LookupError:
+        except (LookupError, TypeError):
             return ''
 
     def test(self, data):
diff --git a/tests/sentry/filters/test_browser_extensions.py b/tests/sentry/filters/test_browser_extensions.py
index 14f810a6f8..9c8f507b0a 100644
--- a/tests/sentry/filters/test_browser_extensions.py
+++ b/tests/sentry/filters/test_browser_extensions.py
@@ -54,3 +54,8 @@ class BrowserExtensionsFilterTest(TestCase):
     def test_does_not_filter_generic_data(self):
         data = self.get_mock_data()
         assert not self.apply_filter(data)
+
+    def test_filters_malformed_data(self):
+        data = self.get_mock_data()
+        data['sentry.interfaces.Exception'] = None
+        assert not self.apply_filter(data)
