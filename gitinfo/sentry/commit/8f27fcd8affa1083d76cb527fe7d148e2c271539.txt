commit 8f27fcd8affa1083d76cb527fe7d148e2c271539
Author: Brett Hoerner <brett@bretthoerner.com>
Date:   Tue Mar 20 11:52:44 2018 -0500

    fix(tagstore): Add partition_key to Project delete relations (#7711)
    
    Fixes SENTRY-61M
    Fixes SENTRY-645

diff --git a/src/sentry/tagstore/base.py b/src/sentry/tagstore/base.py
index d84868d227..bf499ca0d8 100644
--- a/src/sentry/tagstore/base.py
+++ b/src/sentry/tagstore/base.py
@@ -130,11 +130,14 @@ class TagStorage(Service):
             lambda instance: ModelRelation(tagkey_model,
                                            query={'project_id': instance.id}),
             lambda instance: ModelRelation(tagvalue_model,
-                                           query={'project_id': instance.id}),
+                                           query={'project_id': instance.id},
+                                           partition_key={'project_id': instance.id}),
             lambda instance: ModelRelation(grouptagkey_model,
-                                           query={'project_id': instance.id}),
+                                           query={'project_id': instance.id},
+                                           partition_key={'project_id': instance.id}),
             lambda instance: ModelRelation(grouptagvalue_model,
-                                           query={'project_id': instance.id}),
+                                           query={'project_id': instance.id},
+                                           partition_key={'project_id': instance.id}),
         ])
 
     def setup_cleanup(self, tagvalue_model, grouptagvalue_model, eventtag_model):
