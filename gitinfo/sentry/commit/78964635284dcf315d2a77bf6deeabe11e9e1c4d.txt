commit 78964635284dcf315d2a77bf6deeabe11e9e1c4d
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Fri May 3 12:35:38 2019 -0700

    feat(yarn): Add extra step to `make install-yarn` to verify fs tree (#13045)
    
    A common problem is with node packages not existing in `node_modules`, even though `yarn install`
    says everything is up to date.  This adds an additional step to check packages against what exists
    in `node_modules` and run `yarn install --check-files` if check fails.
    This should install the packages missing from `node_modules`.

diff --git a/Makefile b/Makefile
index 8a23cf7efa..3924f5d3dc 100644
--- a/Makefile
+++ b/Makefile
@@ -78,6 +78,11 @@ install-yarn-pkgs:
 	@command -v yarn 2>&1 > /dev/null || (echo 'yarn not found. Please install it before proceeding.'; exit 1)
 	# Use NODE_ENV=development so that yarn installs both dependencies + devDependencies
 	NODE_ENV=development yarn install --pure-lockfile
+	# A common problem is with node packages not existing in `node_modules` even though `yarn install`
+	# says everything is up to date. Even though `yarn install` is run already, it doesn't take into
+	# account the state of the current filesystem (it only checks .yarn-integrity).
+	# Add an additional check against `node_modules`
+	yarn check --verify-tree || yarn install --check-files
 
 install-sentry-dev:
 	@echo "--> Installing Sentry (for development)"
