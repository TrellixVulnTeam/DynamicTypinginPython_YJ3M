commit 6a3d274062afea6c17e3562322b283f0adc1c759
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Thu Feb 21 15:11:45 2019 -0800

    feat(superuser): Do not store global selection for non org members (#12160)
    
    Do not store any global selection values in local storage for users
    who are not org members. This currently only affects superusers.

diff --git a/src/sentry/static/sentry/app/stores/globalSelectionStore.jsx b/src/sentry/static/sentry/app/stores/globalSelectionStore.jsx
index 180a9b7079..d114d5cb5a 100644
--- a/src/sentry/static/sentry/app/stores/globalSelectionStore.jsx
+++ b/src/sentry/static/sentry/app/stores/globalSelectionStore.jsx
@@ -10,6 +10,7 @@ import {getStateFromQuery} from 'app/components/organizations/globalSelectionHea
 import {DEFAULT_STATS_PERIOD} from 'app/constants';
 import {isEqualWithDates} from 'app/utils/isEqualWithDates';
 import ConfigStore from 'app/stores/configStore';
+import OrganizationsStore from 'app/stores/organizationsStore';
 import GlobalSelectionActions from 'app/actions/globalSelectionActions';
 import localStorage from 'app/utils/localStorage';
 
@@ -139,10 +140,14 @@ const GlobalSelectionStore = Reflux.createStore({
   },
 
   updateLocalStorage() {
+    // Do nothing if no org is loaded or user is not an org member. Only
+    // organizations that a user has membership in will be available via the
+    // organizations store
+    if (!this.organization || OrganizationsStore.get(this.organization.slug)) {
+      return;
+    }
+
     try {
-      if (!this.organization) {
-        throw new Error('No organization loaded');
-      }
       const localStorageKey = `${LOCAL_STORAGE_KEY}:${this.organization.slug}`;
       localStorage.setItem(localStorageKey, JSON.stringify(this.selection));
     } catch (ex) {
