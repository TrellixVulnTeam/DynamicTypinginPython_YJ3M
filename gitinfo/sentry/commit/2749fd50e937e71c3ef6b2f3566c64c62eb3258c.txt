commit 2749fd50e937e71c3ef6b2f3566c64c62eb3258c
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Tue Jun 28 15:30:13 2016 -0700

    Avoid surfacing other errors during login when showing captcha (#3607)

diff --git a/src/sentry/web/frontend/auth_login.py b/src/sentry/web/frontend/auth_login.py
index d73161815a..3285be032b 100644
--- a/src/sentry/web/frontend/auth_login.py
+++ b/src/sentry/web/frontend/auth_login.py
@@ -106,6 +106,13 @@ class AuthLoginView(BaseView):
                 register_form = self.get_register_form(request)
                 register_form.errors.pop('captcha', None)
 
+        # When the captcha fails, hide any other errors
+        # to prevent brute force attempts.
+        if 'captcha' in login_form.errors:
+            for k in login_form.errors.keys():
+                if k != 'captcha':
+                    login_form.errors.pop(k)
+
         request.session.set_test_cookie()
 
         context = {
diff --git a/src/sentry/web/frontend/auth_organization_login.py b/src/sentry/web/frontend/auth_organization_login.py
index 98f473618b..93bb4223d9 100644
--- a/src/sentry/web/frontend/auth_organization_login.py
+++ b/src/sentry/web/frontend/auth_organization_login.py
@@ -84,6 +84,13 @@ class AuthOrganizationLoginView(BaseView):
                 register_form = self.get_register_form(request)
                 register_form.errors.pop('captcha', None)
 
+        # When the captcha fails, hide any other errors
+        # to prevent brute force attempts.
+        if 'captcha' in login_form.errors:
+            for k in login_form.errors.keys():
+                if k != 'captcha':
+                    login_form.errors.pop(k)
+
         request.session.set_test_cookie()
 
         context = {
