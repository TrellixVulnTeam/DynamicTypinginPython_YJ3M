commit 257098d6e9e500b0590da423fafee8b018467e54
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jun 1 23:34:20 2015 +0100

    Yet another fix member_set

diff --git a/src/sentry/models/project.py b/src/sentry/models/project.py
index 82e918a37a..7754e363bf 100644
--- a/src/sentry/models/project.py
+++ b/src/sentry/models/project.py
@@ -197,12 +197,16 @@ class Project(Model):
 
     @property
     def member_set(self):
+        from sentry.models import OrganizationMember
         return self.organization.member_set.filter(
             Q(organizationmemberteam__team=self.team) |
             Q(has_global_access=True),
-            ~Q(organizationmemberteam__is_active=False,
-               organizationmemberteam__team=self.team),
             user__is_active=True,
+        ).exclude(
+            id__in=OrganizationMember.objects.filter(
+                organizationmemberteam__is_active=False,
+                organizationmemberteam__team=self.team,
+            ).values('id')
         ).distinct()
 
     def has_access(self, user, access=None):
diff --git a/src/sentry/models/team.py b/src/sentry/models/team.py
index 6ea01fa240..bb5c2a209d 100644
--- a/src/sentry/models/team.py
+++ b/src/sentry/models/team.py
@@ -176,12 +176,16 @@ class Team(Model):
 
     @property
     def member_set(self):
+        from sentry.models import OrganizationMember
         return self.organization.member_set.filter(
             Q(organizationmemberteam__team=self) |
             Q(has_global_access=True),
-            ~Q(organizationmemberteam__is_active=False,
-               organizationmemberteam__team=self),
             user__is_active=True,
+        ).exclude(
+            id__in=OrganizationMember.objects.filter(
+                organizationmemberteam__is_active=False,
+                organizationmemberteam__team=self,
+            ).values('id')
         ).distinct()
 
     def has_access(self, user, access=None):
