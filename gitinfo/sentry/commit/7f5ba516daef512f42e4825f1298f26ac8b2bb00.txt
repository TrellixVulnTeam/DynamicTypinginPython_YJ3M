commit 7f5ba516daef512f42e4825f1298f26ac8b2bb00
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Dec 19 16:21:05 2014 -0800

    Add organization serializer

diff --git a/src/sentry/api/serializers/models/organization.py b/src/sentry/api/serializers/models/organization.py
new file mode 100644
index 0000000000..f3ef500575
--- /dev/null
+++ b/src/sentry/api/serializers/models/organization.py
@@ -0,0 +1,53 @@
+from __future__ import absolute_import
+
+from sentry.api.serializers import Serializer, register
+from sentry.models import (
+    Organization, OrganizationMember, OrganizationMemberType
+)
+
+
+@register(Organization)
+class OrganizationSerializer(Serializer):
+    def get_attrs(self, item_list, user):
+        member_map = dict(
+            (om.organization_id, om)
+            for om in OrganizationMember.objects.filter(
+                organization__in=item_list,
+                user=user,
+            )
+        )
+
+        result = {}
+        for organization in item_list:
+            try:
+                om = member_map[organization.id]
+            except KeyError:
+                if user.is_superuser:
+                    is_global = True
+                    access_type = OrganizationMemberType.OWNER
+                else:
+                    is_global = False
+                    access_type = None
+            else:
+                is_global = om.has_global_access
+                access_type = om.type
+
+            result[organization] = {
+                'is_global': is_global,
+                'access_type': access_type,
+            }
+        return result
+
+    def serialize(self, obj, attrs, user):
+        d = {
+            'id': str(obj.id),
+            'slug': obj.slug,
+            'name': obj.name,
+            'dateCreated': obj.date_added,
+            'isGlobal': attrs['is_global'],
+            'permission': {
+                'owner': attrs['access_type'] <= OrganizationMemberType.OWNER,
+                'admin': attrs['access_type'] <= OrganizationMemberType.ADMIN,
+            }
+        }
+        return d
diff --git a/tests/sentry/api/serializers/__init__.py b/tests/sentry/api/serializers/__init__.py
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/tests/sentry/api/serializers/test_organization.py b/tests/sentry/api/serializers/test_organization.py
new file mode 100644
index 0000000000..7d13669a60
--- /dev/null
+++ b/tests/sentry/api/serializers/test_organization.py
@@ -0,0 +1,15 @@
+# -*- coding: utf-8 -*-
+
+from __future__ import absolute_import
+
+from sentry.api.serializers import serialize
+from sentry.testutils import TestCase
+
+
+class OrganizationSerializerTest(TestCase):
+    def test_simple(self):
+        user = self.create_user()
+        organization = self.create_organization(owner=user)
+
+        result = serialize(organization, user)
+        assert result['id'] == str(organization.id)
