commit 6c418177885c5a18076e6d56a6a03c90697528e7
Author: Russell Davis <russell@stripe.com>
Date:   Mon Dec 2 14:01:31 2013 -0800

    Mapped source URLs should be relative to the sourcemap.
    
    The old code made it relative to the original source URL, which may not
    be in the same location.

diff --git a/src/sentry/tasks/fetch_source.py b/src/sentry/tasks/fetch_source.py
index 7d0fd2c769..058895eb5d 100644
--- a/src/sentry/tasks/fetch_source.py
+++ b/src/sentry/tasks/fetch_source.py
@@ -287,7 +287,7 @@ def expand_javascript_source(data, **kwargs):
 
         # queue up additional source files for download
         for source in index.sources:
-            next_filename = urljoin(result.url, source)
+            next_filename = urljoin(sourcemap, source)
             if next_filename not in done_file_list:
                 if index.content:
                     source_code[next_filename] = (index.content[source], None)
