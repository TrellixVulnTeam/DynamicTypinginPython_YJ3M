commit 2bdbd34e9e540a804287c9fe4144a2e68e2697b9
Author: ted kaemming <ted@kaemming.com>
Date:   Fri Jun 22 10:56:51 2018 -0700

    ref(reports): Avoid passing ValuesListQuerySet to TSDB method (#8797)
    
    References SNS-109

diff --git a/src/sentry/tasks/reports.py b/src/sentry/tasks/reports.py
index 65ef048f31..ef028814c8 100644
--- a/src/sentry/tasks/reports.py
+++ b/src/sentry/tasks/reports.py
@@ -554,21 +554,21 @@ def prepare_organization_report(timestamp, duration, organization_id, dry_run=Fa
 
 def fetch_personal_statistics(start__stop, organization, user):
     start, stop = start__stop
-    resolved_issue_ids = Activity.objects.filter(
-        project__organization_id=organization.id,
-        user_id=user.id,
-        type__in=(Activity.SET_RESOLVED, Activity.SET_RESOLVED_IN_RELEASE, ),
-        datetime__gte=start,
-        datetime__lt=stop,
-        group__status=GroupStatus.RESOLVED,  # only count if the issue is still resolved
-    ).distinct().values_list(
-        'group_id', flat=True
+    resolved_issue_ids = set(
+        Activity.objects.filter(
+            project__organization_id=organization.id,
+            user_id=user.id,
+            type__in=(Activity.SET_RESOLVED, Activity.SET_RESOLVED_IN_RELEASE, ),
+            datetime__gte=start,
+            datetime__lt=stop,
+            group__status=GroupStatus.RESOLVED,  # only count if the issue is still resolved
+        ).distinct().values_list(
+            'group_id', flat=True
+        )
     )
     return {
-        'resolved':
-        len(resolved_issue_ids),
-        'users':
-        tsdb.get_distinct_counts_union(
+        'resolved': len(resolved_issue_ids),
+        'users': tsdb.get_distinct_counts_union(
             tsdb.models.users_affected_by_group,
             resolved_issue_ids,
             start,
