commit efe21acc4423546bbbc2f38f0e21924444f08a8e
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jun 24 15:49:32 2015 -0700

    Tests for HomeView

diff --git a/src/sentry/web/frontend/home.py b/src/sentry/web/frontend/home.py
index 562bd1c2f3..41d71f2ab3 100644
--- a/src/sentry/web/frontend/home.py
+++ b/src/sentry/web/frontend/home.py
@@ -14,7 +14,7 @@ class HomeView(BaseView):
         if organization:
             url = reverse('sentry-organization-home', args=[organization.slug])
         elif not features.has('organizations:create'):
-            return self.respond('sentry/no-organization-access.html')
+            return self.respond('sentry/no-organization-access.html', status=403)
         else:
             url = reverse('sentry-create-organization')
         return HttpResponseRedirect(url)
diff --git a/tests/sentry/web/frontend/test_home.py b/tests/sentry/web/frontend/test_home.py
new file mode 100644
index 0000000000..2d1bd89954
--- /dev/null
+++ b/tests/sentry/web/frontend/test_home.py
@@ -0,0 +1,46 @@
+from __future__ import absolute_import
+
+from django.core.urlresolvers import reverse
+from exam import fixture
+
+from sentry.testutils import TestCase
+
+
+class HomeTest(TestCase):
+    @fixture
+    def path(self):
+        return reverse('sentry')
+
+    def test_redirects_to_login(self):
+        resp = self.client.get(self.path)
+
+        assert resp.status_code == 302
+        assert resp['Location'] == 'http://testserver' + reverse('sentry-login')
+
+    def test_redirects_to_create_org(self):
+        self.login_as(self.user)
+
+        with self.feature('organizations:create'):
+            resp = self.client.get(self.path)
+
+        assert resp.status_code == 302
+        assert resp['Location'] == 'http://testserver' + reverse('sentry-create-organization')
+
+    def test_shows_no_access(self):
+        self.login_as(self.user)
+
+        with self.feature('organizations:create', False):
+            resp = self.client.get(self.path)
+
+        assert resp.status_code == 403
+        self.assertTemplateUsed('sentry/no-organization-access.html')
+
+    def test_redirects_to_org_home(self):
+        self.login_as(self.user)
+        org = self.create_organization(owner=self.user)
+
+        with self.feature('organizations:create'):
+            resp = self.client.get(self.path)
+
+        assert resp.status_code == 302
+        assert resp['Location'] == 'http://testserver' + reverse('sentry-organization-home', args=[org.slug])
