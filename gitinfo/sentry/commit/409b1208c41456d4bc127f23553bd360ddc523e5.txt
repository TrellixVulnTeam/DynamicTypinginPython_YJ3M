commit 409b1208c41456d4bc127f23553bd360ddc523e5
Author: ted kaemming <ted@kaemming.com>
Date:   Thu Feb 14 15:05:09 2019 -0800

    fix(redis): Reset Redis Cluster state on KeyError (#12080)
    
    This seems to happen every once in a while when the cluster gets into a
    broken state and starts to death spiral. Catching `KeyError` here isn't
    ideal, but it's the only real signal we have when this happens.
    
    Fixes SENTRY-5YG.

diff --git a/src/sentry/utils/redis.py b/src/sentry/utils/redis.py
index d8f9b02530..a9dc74d994 100644
--- a/src/sentry/utils/redis.py
+++ b/src/sentry/utils/redis.py
@@ -88,7 +88,11 @@ class RetryingStrictRedisCluster(StrictRedisCluster):
     def execute_command(self, *args, **kwargs):
         try:
             return super(self.__class__, self).execute_command(*args, **kwargs)
-        except (ConnectionError, BusyLoadingError):
+        except (
+            ConnectionError,
+            BusyLoadingError,
+            KeyError,  # see: https://github.com/Grokzen/redis-py-cluster/issues/287
+        ):
             self.connection_pool.nodes.reset()
             return super(self.__class__, self).execute_command(*args, **kwargs)
 
