commit f1544190f92dc85c68d3352a9dea183cbafbb5d8
Author: Jess MacQueen <jessmacqueen@gmail.com>
Date:   Mon Jul 30 18:38:57 2018 -0700

    fix(integrations): Return an error when vsts repo fetching fails

diff --git a/src/sentry/api/endpoints/organization_integration_repos.py b/src/sentry/api/endpoints/organization_integration_repos.py
index 11d8edae0a..ac6573d639 100644
--- a/src/sentry/api/endpoints/organization_integration_repos.py
+++ b/src/sentry/api/endpoints/organization_integration_repos.py
@@ -6,6 +6,7 @@ from sentry.constants import ObjectStatus
 from sentry.api.bases.organization import (
     OrganizationEndpoint, OrganizationIntegrationsPermission
 )
+from sentry.integrations.exceptions import IntegrationError
 from sentry.integrations.repositories import RepositoryMixin
 from sentry.models import Integration
 
@@ -26,7 +27,11 @@ class OrganizationIntegrationReposEndpoint(OrganizationEndpoint):
 
         install = integration.get_installation(organization.id)
         if isinstance(install, RepositoryMixin):
-            repositories = install.get_repositories()
+            try:
+                repositories = install.get_repositories()
+            except IntegrationError as e:
+                return self.respond({'detail': e.message}, status=400)
+
             context = {'repos': repositories}
             return self.respond(context)
 
diff --git a/src/sentry/integrations/vsts/integration.py b/src/sentry/integrations/vsts/integration.py
index 1f41802061..7c62e60004 100644
--- a/src/sentry/integrations/vsts/integration.py
+++ b/src/sentry/integrations/vsts/integration.py
@@ -59,8 +59,8 @@ class VstsIntegration(Integration, RepositoryMixin, VstsIssueSync):
     def get_repositories(self):
         try:
             repos = self.get_client().get_repos(self.instance)
-        except ApiError:
-            repos = []
+        except ApiError as e:
+            raise IntegrationError(self.message_from_error(e))
         data = []
         for repo in repos['value']:
             data.append({
