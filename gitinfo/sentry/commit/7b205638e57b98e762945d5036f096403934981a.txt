commit 7b205638e57b98e762945d5036f096403934981a
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Tue Aug 21 16:09:16 2018 -0700

    fix(analytics): Log when Google credentials can't be found
    
    This allows process to boot up if there are no credentials passed in

diff --git a/src/sentry/analytics/pubsub.py b/src/sentry/analytics/pubsub.py
index 0e840a9763..53f9090506 100644
--- a/src/sentry/analytics/pubsub.py
+++ b/src/sentry/analytics/pubsub.py
@@ -2,11 +2,16 @@ from __future__ import absolute_import
 
 __all__ = ('PubSubAnalytics',)
 
+import logging
+
 from sentry.utils.json import dumps
+from google.auth.exceptions import GoogleAuthError
 from google.cloud import pubsub_v1
 
 from .base import Analytics
 
+logger = logging.getLogger(__name__)
+
 
 class PubSubAnalytics(Analytics):
     def __init__(self, project, topic, batch_max_bytes=1024 * 1024 *
@@ -16,11 +21,17 @@ class PubSubAnalytics(Analytics):
             max_latency=batch_max_latency,
             max_messages=batch_max_messages,
         )
-        self.publisher = pubsub_v1.PublisherClient(settings)
-        self.topic = self.publisher.topic_path(project, topic)
+        try:
+            self.publisher = pubsub_v1.PublisherClient(settings)
+        except GoogleAuthError:
+            logger.warn('Unable to initialize PubSubAnalytics, no auth found')
+            self.publisher = None
+        else:
+            self.topic = self.publisher.topic_path(project, topic)
 
     def record_event(self, event):
-        self.publisher.publish(
-            self.topic,
-            data=dumps(event.serialize()),
-        )
+        if self.publisher is not None:
+            self.publisher.publish(
+                self.topic,
+                data=dumps(event.serialize()),
+            )
