commit 1e516a69c90f6d5a9139a091f6a552285b26e9c6
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Mon Jan 25 21:27:47 2016 -0800

    Ensure that urlencoding key/value pairs from objects encodes to bytes first.

diff --git a/src/sentry/interfaces/http.py b/src/sentry/interfaces/http.py
index 833a45fc85..3cea2dafcb 100644
--- a/src/sentry/interfaces/http.py
+++ b/src/sentry/interfaces/http.py
@@ -22,6 +22,12 @@ from sentry.utils.safe import trim, trim_dict, trim_pairs
 from sentry.web.helpers import render_to_string
 
 
+def to_bytes(value):
+    if isinstance(value, unicode):
+        return value.encode('utf-8')
+    return str(value)
+
+
 def format_headers(value):
     if not value:
         return ()
@@ -120,7 +126,8 @@ class Http(Interface):
         if query_string:
             # if querystring was a dict, convert it to a string
             if isinstance(query_string, dict):
-                query_string = urlencode(query_string.items())
+                query_string = urlencode([(to_bytes(k), to_bytes(v))
+                                          for k, v in query_string.items()])
             else:
                 query_string = query_string
                 if query_string[0] == '?':
