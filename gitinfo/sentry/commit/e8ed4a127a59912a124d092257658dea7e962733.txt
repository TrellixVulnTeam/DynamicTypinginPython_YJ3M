commit e8ed4a127a59912a124d092257658dea7e962733
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Oct 15 18:08:39 2013 +0100

    Basic test for MessageBuilder

diff --git a/tests/sentry/utils/email/__init__.py b/tests/sentry/utils/email/__init__.py
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/tests/sentry/utils/email/tests.py b/tests/sentry/utils/email/tests.py
new file mode 100644
index 0000000000..5249a7699f
--- /dev/null
+++ b/tests/sentry/utils/email/tests.py
@@ -0,0 +1,29 @@
+from django.core import mail
+
+from sentry.testutils import TestCase
+from sentry.utils.email import MessageBuilder
+
+
+class MessageBuilderTest(TestCase):
+    def test_raw_content(self):
+        msg = MessageBuilder(
+            subject='Test',
+            body='hello world',
+            html_body='<b>hello world</b>',
+            headers={'X-Test': 'foo'},
+        )
+        msg.send(['foo@example.com'])
+
+        assert len(mail.outbox) == 1
+
+        out = mail.outbox[0]
+        assert out.to == ['foo@example.com']
+        assert out.subject == 'Test'
+        assert out.extra_headers['X-Test'] == 'foo'
+        assert out.extra_headers['Reply-To'] == 'foo@example.com'
+        assert out.body == 'hello world'
+        assert len(out.alternatives) == 1
+        assert out.alternatives[0] == (
+            '<b>hello world</b>',
+            'text/html',
+        )
