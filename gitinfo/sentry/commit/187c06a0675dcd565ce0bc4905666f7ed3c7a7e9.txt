commit 187c06a0675dcd565ce0bc4905666f7ed3c7a7e9
Author: Jan Michael Auer <jan.auer@sentry.io>
Date:   Tue Jun 9 13:34:12 2020 +0200

    ref(quotas): Scope project and key quotas to events (#19219)
    
    Scopes the existing project and key quotas to event types to
    specifically exclude attachments and sessions. While events are counted
    per instance, attachments are counted in bytes and sessions in batches,
    so they are not comparable.
    
    Relay will soon begin to enforce attachment quotas based on the
    attachment size, and it is important that it does not increment the
    event counters for that.

diff --git a/src/sentry/constants.py b/src/sentry/constants.py
index 2ff8e33a0a..6823f823c3 100644
--- a/src/sentry/constants.py
+++ b/src/sentry/constants.py
@@ -519,6 +519,19 @@ class DataCategory(IntEnum):
             return DataCategory.SECURITY
         return DataCategory.DEFAULT
 
+    @classmethod
+    def event_categories(cls):
+        return [
+            DataCategory.DEFAULT,
+            DataCategory.ERROR,
+            DataCategory.TRANSACTION,
+            DataCategory.SECURITY,
+        ]
+
+    @classmethod
+    def error_categories(cls):
+        return [DataCategory.DEFAULT, DataCategory.ERROR]
+
     def api_name(self):
         return self.name.lower()
 
diff --git a/src/sentry/quotas/redis.py b/src/sentry/quotas/redis.py
index 99703034fd..53dcf5ea99 100644
--- a/src/sentry/quotas/redis.py
+++ b/src/sentry/quotas/redis.py
@@ -84,6 +84,7 @@ class RedisQuota(Quota):
                     id="p",
                     scope=QuotaScope.PROJECT,
                     scope_id=project.id,
+                    categories=DataCategory.event_categories(),
                     limit=pquota[0],
                     window=pquota[1],
                     reason_code="project_quota",
@@ -97,6 +98,7 @@ class RedisQuota(Quota):
                     id="o",
                     scope=QuotaScope.ORGANIZATION,
                     scope_id=project.organization.id,
+                    categories=DataCategory.event_categories(),
                     limit=oquota[0],
                     window=oquota[1],
                     reason_code="org_quota",
@@ -116,6 +118,7 @@ class RedisQuota(Quota):
                         id="k",
                         scope=QuotaScope.KEY,
                         scope_id=key.id,
+                        categories=DataCategory.event_categories(),
                         limit=kquota[0],
                         window=kquota[1],
                         reason_code="key_quota",
