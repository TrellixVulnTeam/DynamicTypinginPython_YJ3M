commit 51fb5d4226a81cd1f94d65d5b02f9dd9a91940b5
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Wed May 2 16:25:59 2018 -0700

    feat(dashboard): Add favorite section to top of org dashboard (#8287)

diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/index.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/index.jsx
index 68acd5fb18..e1d11b352a 100644
--- a/src/sentry/static/sentry/app/views/organizationDashboard/index.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDashboard/index.jsx
@@ -6,14 +6,16 @@ import styled from 'react-emotion';
 
 import AsyncComponent from 'app/components/asyncComponent';
 import OrganizationState from 'app/mixins/organizationState';
-import OldDashboard from 'app/views/organizationDashboard/oldDashboard';
-import ProjectNav from 'app/views/organizationDashboard/projectNav';
-import TeamMembers from 'app/views/organizationDashboard/teamMembers';
-import ProjectCard from 'app/views/organizationDashboard/projectCard';
-import EmptyState from 'app/views/organizationDashboard/emptyState';
 import getProjectsByTeams from 'app/utils/getProjectsByTeams';
 import withTeams from 'app/utils/withTeams';
 import withProjects from 'app/utils/withProjects';
+import {t} from 'app/locale';
+
+import OldDashboard from './oldDashboard';
+import ProjectNav from './projectNav';
+import TeamMembers from './teamMembers';
+import ProjectCard from './projectCard';
+import EmptyState from './emptyState';
 
 class Dashboard extends AsyncComponent {
   static propTypes = {
@@ -35,16 +37,40 @@ class Dashboard extends AsyncComponent {
     return [['projectsWithStats', `/organizations/${orgId}/projects/?statsPeriod=24h`]];
   }
 
+  renderProjectCard(project) {
+    const {projectsWithStats} = this.state;
+
+    const getStats = id => projectsWithStats.find(p => id === p.id).stats;
+
+    return (
+      <ProjectCardWrapper key={project.id} width={['100%', '50%', '33%', '25%']}>
+        <ProjectCard project={project} stats={getStats(project.id)} />
+      </ProjectCardWrapper>
+    );
+  }
+
   renderBody() {
     const {teams, projects, params} = this.props;
     const {projectsByTeam} = getProjectsByTeams(teams, projects);
     const projectKeys = Object.keys(projectsByTeam);
 
-    const {projectsWithStats} = this.state;
-    const getStats = id => projectsWithStats.find(project => id === project.id).stats;
+    const favorites = projects.filter(project => project.isBookmarked);
 
     return (
       <React.Fragment>
+        {favorites.length > 0 && (
+          <div data-test-id="favorites">
+            <TeamSection>
+              <TeamTitleBar>
+                <TeamName>{t('Favorites')}</TeamName>
+              </TeamTitleBar>
+            </TeamSection>
+            <ProjectCards>
+              {favorites.map(project => this.renderProjectCard(project))}
+            </ProjectCards>
+          </div>
+        )}
+
         {projectKeys.map((slug, index) => {
           const showBorder = index !== projectKeys.length - 1;
           return (
@@ -54,16 +80,7 @@ class Dashboard extends AsyncComponent {
                 <TeamMembers teamId={slug} orgId={params.orgId} />
               </TeamTitleBar>
               <ProjectCards>
-                {projectsByTeam[slug].map(project => {
-                  return (
-                    <ProjectCardWrapper
-                      key={project.id}
-                      width={['100%', '50%', '33%', '25%']}
-                    >
-                      <ProjectCard project={project} stats={getStats(project.id)} />
-                    </ProjectCardWrapper>
-                  );
-                })}
+                {projectsByTeam[slug].map(project => this.renderProjectCard(project))}
               </ProjectCards>
             </TeamSection>
           );
diff --git a/tests/js/spec/views/organizationDashboard/index.spec.jsx b/tests/js/spec/views/organizationDashboard/index.spec.jsx
index 713ade94cd..4a02473018 100644
--- a/tests/js/spec/views/organizationDashboard/index.spec.jsx
+++ b/tests/js/spec/views/organizationDashboard/index.spec.jsx
@@ -51,8 +51,23 @@ describe('OrganizationDashboard', function() {
         TestStubs.routerContext()
       );
       const emptyState = wrapper.find('EmptyState');
+      const favorites = wrapper.find('[data-test-id="favorites"]');
       const projectCard = wrapper.find('ProjectCardWrapper');
       expect(emptyState).toHaveLength(0);
+      expect(favorites).toHaveLength(0);
+      expect(projectCard).toHaveLength(1);
+    });
+
+    it('renders favorited project in favorites section ', function() {
+      const teams = [TestStubs.Team()];
+      const projects = [TestStubs.Project({teams, isBookmarked: true})];
+
+      const wrapper = shallow(
+        <Dashboard teams={teams} projects={projects} params={{orgId: 'org-slug'}} />,
+        TestStubs.routerContext()
+      );
+      const favorites = wrapper.find('[data-test-id="favorites"]');
+      const projectCard = favorites.find('ProjectCardWrapper');
       expect(projectCard).toHaveLength(1);
     });
   });
