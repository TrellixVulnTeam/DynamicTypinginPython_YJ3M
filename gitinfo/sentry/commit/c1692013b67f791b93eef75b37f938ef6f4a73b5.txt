commit c1692013b67f791b93eef75b37f938ef6f4a73b5
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Nov 29 13:20:18 2014 -0800

    Form basics for migration wizard

diff --git a/src/sentry/templates/sentry/access-group-migration.html b/src/sentry/templates/sentry/access-group-migration.html
index 99a26cac6a..e00aa2fcbf 100644
--- a/src/sentry/templates/sentry/access-group-migration.html
+++ b/src/sentry/templates/sentry/access-group-migration.html
@@ -5,21 +5,78 @@
 {% block title %}{% trans "Access Group Migration" %} | {{ block.super }}{% endblock %}
 
 {% block inner %}
-    <div class="page-header">
-        <h2>{% trans "Access Group Migration" %}</h2>
-    </div>
-
-    {% if member_list %}
-        <p>Below is a list of all members who are part of an access group within this organization. You'll need to select which team(s) they should gain access to. Alternatively you can choose to remove the user if they no longer need access.</p>
-
-        <p>Note: Unlike access groups, organization membership cannot be restricted per-project. If you need to refine access to that level you should create additional teams and move to the projects where applicable.</p>
-
-        <ul>
-            {% for member, project_list in member_list %}
-                <li>{{ member.get_display_name }}</li>
-            {% endfor %}
-        </ul>
-    {% else %}
-        <p>Your work is done here! There are no access groups which need migrated.</p>
-    {% endif %}
+  <div class="page-header">
+    <h2>{% trans "Access Group Migration" %}</h2>
+  </div>
+
+  {% if member_list %}
+    <p>Below is a list of all members who are part of an access group within this organization. You'll need to select which team(s) they should gain access to. Alternatively you can choose to remove the user if they no longer need access.</p>
+
+    <p>Note: Unlike access groups, organization membership cannot be restricted per-project. If you need to refine access to that level you should create additional teams and move to the projects where applicable.</p>
+
+    <table class="table table-striped access-group-migration">
+      {% for member, project_list in member_list %}
+        <tr>
+          <td>
+            <h4>{{ member.get_display_name }}</h4>
+            <label class="checkbox">
+              <input type="checkbox" name="global_access" value="1" class="checkboxinput">
+              <strong>All Teams</strong>
+            </label>
+            <fieldset class="team-choices">
+              {% for team in team_list %}
+                <label class="checkbox">
+                  <input type="checkbox" name="team" value="{{ team.slug }}" class="checkboxinput">
+                  {{ team.slug }}
+                </label>
+              {% endfor %}
+            </fieldset>
+          </td>
+          <td style="text-align:center;width:150px;vertical-align:top">
+            <a class="tip" title="{% for project in project_list %}{{ project.slug }}{% if not forloop.last %}, {% endif %}{% endfor %}">{{ project_list|length }} project(s)</a>
+          </td>
+        </tr>
+      {% endfor %}
+    </table>
+  {% else %}
+    <p>Your work is done here! There are no access groups which need migrated.</p>
+  {% endif %}
+
+  <style>
+  .access-group-migration td > h4 {
+    margin-bottom: 10px;
+    display: block;
+  }
+  .access-group-migration fieldset {
+    margin-left: 20px;
+  }
+  .access-group-migration label {
+    font-weight: normal;
+  }
+  </style>
+
+  <script>
+  $(function(){
+    var selectedTeams = [];
+    $('input[name="global_access"]').change(function(){
+      var $this = $(this);
+      var $parent = $this.parent().parent();
+      var checked = $this.is(':checked');
+      var selector = $parent.find('.team-choices input[type=checkbox]');
+
+      if (checked) {
+        selectedTeams = $parent.find('.team-choices input[type=checkbox]:checked').slice(0, selector.length);
+        selector.prop('checked', true);
+      } else {
+        selector.prop('checked', false);
+        $(selectedTeams).prop('checked', true);
+        selectedTeams = [];
+      }
+
+      $('.team-choices').prop('disabled', checked);
+
+    }).change();
+  });
+  </script>
+
 {% endblock %}
diff --git a/src/sentry/web/frontend/access_group_migration.py b/src/sentry/web/frontend/access_group_migration.py
index a8f5ed8d6b..53da852e1b 100644
--- a/src/sentry/web/frontend/access_group_migration.py
+++ b/src/sentry/web/frontend/access_group_migration.py
@@ -16,6 +16,8 @@ class AccessGroupMigrationView(OrganizationView):
 
         group_list = set(m.accessgroup for m in member_list)
 
+        team_list = organization.team_set.all()
+
         project_list = list(AccessGroup.projects.through.objects.filter(
             accessgroup__in=group_list,
         ).select_related('project'))
@@ -39,6 +41,7 @@ class AccessGroupMigrationView(OrganizationView):
         context = {
             'member_list': results,
             'group_list': group_list,
+            'team_list': team_list,
         }
 
         return self.respond('sentry/access-group-migration.html', context)
