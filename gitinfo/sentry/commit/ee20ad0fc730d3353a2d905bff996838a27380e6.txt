commit ee20ad0fc730d3353a2d905bff996838a27380e6
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Sep 16 10:58:35 2010 -0700

    Render arbitrary data for request information

diff --git a/sentry/__init__.py b/sentry/__init__.py
index bb9aa513f5..6d58f639bd 100644
--- a/sentry/__init__.py
+++ b/sentry/__init__.py
@@ -1 +1 @@
-__version__ = (1, 0, 8)
\ No newline at end of file
+__version__ = (1, 0, 9)
\ No newline at end of file
diff --git a/sentry/reporter.py b/sentry/reporter.py
index 3aa1f1bc99..8dc4c17fc2 100644
--- a/sentry/reporter.py
+++ b/sentry/reporter.py
@@ -244,97 +244,4 @@ Exception Value: {{ exception_value|escape }}
 </textarea>
   </div>
 </div>
-{% if request %}
-<div id="requestinfo">
-  <h2>Request information</h2>
-
-  <h3 id="get-info">GET</h3>
-  {% if request.GET %}
-    <table class="req">
-      <thead>
-        <tr>
-          <th>Variable</th>
-          <th>Value</th>
-        </tr>
-      </thead>
-      <tbody>
-        {% for var in request.GET.items %}
-          <tr>
-            <td>{{ var.0 }}</td>
-            <td class="code"><div>{{ var.1|pprint }}</div></td>
-          </tr>
-        {% endfor %}
-      </tbody>
-    </table>
-  {% else %}
-    <p>No GET data</p>
-  {% endif %}
-
-  <h3 id="post-info">POST</h3>
-  {% if request.POST %}
-    <table class="req">
-      <thead>
-        <tr>
-          <th>Variable</th>
-          <th>Value</th>
-        </tr>
-      </thead>
-      <tbody>
-        {% for var in request.POST.items %}
-          <tr>
-            <td>{{ var.0 }}</td>
-            <td class="code"><div>{{ var.1|pprint }}</div></td>
-          </tr>
-        {% endfor %}
-      </tbody>
-    </table>
-  {% else %}
-    <p>No POST data</p>
-  {% endif %}
-
-  <h3 id="cookie-info">COOKIES</h3>
-  {% if request.COOKIES %}
-    <table class="req">
-      <thead>
-        <tr>
-          <th>Variable</th>
-          <th>Value</th>
-        </tr>
-      </thead>
-      <tbody>
-        {% for var in request.COOKIES.items %}
-          <tr>
-            <td>{{ var.0 }}</td>
-            <td class="code"><div>{{ var.1|pprint }}</div></td>
-          </tr>
-        {% endfor %}
-      </tbody>
-    </table>
-  {% else %}
-    <p>No cookie data</p>
-  {% endif %}
-
-  <h3 id="meta-info">META</h3>
-  {% if request.META %}
-  <table class="req">
-    <thead>
-      <tr>
-        <th>Variable</th>
-        <th>Value</th>
-      </tr>
-    </thead>
-    <tbody>
-      {% for var in request.META.items|dictsort:"0" %}
-        <tr>
-          <td>{{ var.0 }}</td>
-          <td class="code"><div>{{ var.1|pprint }}</div></td>
-        </tr>
-      {% endfor %}
-    </tbody>
-  </table>
-  {% else %}
-    <p>No META data</p>
-  {% endif %}
-</div>
-{% endif %}
 """
\ No newline at end of file
diff --git a/sentry/templates/sentry/group.html b/sentry/templates/sentry/group.html
index 2b2177228a..1ec8e5b6db 100644
--- a/sentry/templates/sentry/group.html
+++ b/sentry/templates/sentry/group.html
@@ -75,6 +75,38 @@
 					{{ traceback }}
 
 				{% endif %}
+				
+				<div id="requestinfo">
+					<h2>Request information</h2>
+				  
+					{% for k, v in json_data %}
+						<h3 id="get-info">{{ k }}</h3>
+						{% if v %}
+							{% if v|is_dict %}
+								<table class="req">
+									<thead>
+										<tr>
+											<th>Variable</th>
+											<th>Value</th>
+										</tr>
+									</thead>
+									<tbody>
+										{% for k_, v_ in v.iteritems %}
+										<tr>
+											<td>{{ k_ }}</td>
+											<td class="code"><div>{{ v_|pprint }}</div></td>
+										</tr>
+										{% endfor %}
+									</tbody>
+								</table>
+							{% else %}
+								{{ v|pprint }}
+							{% endif %}
+						{% else %}
+							<p>No data for {{ k }}</p>
+						{% endif %}
+					{% endfor %}
+				</div>
 			</div>
 		</div>
 	</div>
diff --git a/sentry/templatetags/sentry_helpers.py b/sentry/templatetags/sentry_helpers.py
index 68ed4cc931..d6c0dfe8d9 100644
--- a/sentry/templatetags/sentry_helpers.py
+++ b/sentry/templatetags/sentry_helpers.py
@@ -1,6 +1,12 @@
 from django import template
+from django.utils import simplejson
+
 register = template.Library()
 
+def is_dict(value):
+    return isinstance(value, dict)
+is_dict = register.filter(is_dict)
+
 def with_priority(result_list, key='score'):
     if result_list:
         if isinstance(result_list[0], dict):
diff --git a/sentry/views.py b/sentry/views.py
index a84f66753e..9e992c370c 100644
--- a/sentry/views.py
+++ b/sentry/views.py
@@ -217,6 +217,14 @@ def group(request, group_id):
     unique_urls = message_list.filter(url__isnull=False).values_list('url', 'logger', 'view', 'checksum').annotate(times_seen=Count('url')).values('url', 'times_seen').order_by('-times_seen')
     
     unique_servers = message_list.filter(server_name__isnull=False).values_list('server_name', 'logger', 'view', 'checksum').annotate(times_seen=Count('server_name')).values('server_name', 'times_seen').order_by('-times_seen')
+
+    def iter_data(obj):
+        for k, v in obj.data.iteritems():
+            if k.startswith('_') or k in ['url']:
+                continue
+            yield k, v
+    
+    json_data = iter_data(obj)
     
     engine = get_db_engine()
     if SimpleLineChart and not engine.startswith('sqlite'):
