commit 2f08dbdf5a73a605c10d144148c2960c5f14aa18
Author: Priscila Oliveira <priscilawebdev@gmail.com>
Date:   Fri Jul 10 16:09:43 2020 +0200

    fix(debugMeta): Fix List size when back from empty (#19812)

diff --git a/src/sentry/static/sentry/app/components/clippedBox.tsx b/src/sentry/static/sentry/app/components/clippedBox.tsx
index a6bbbbbd0a..188dc1a8d3 100644
--- a/src/sentry/static/sentry/app/components/clippedBox.tsx
+++ b/src/sentry/static/sentry/app/components/clippedBox.tsx
@@ -58,11 +58,13 @@ class ClippedBox extends React.PureComponent<Props, State> {
       return;
     }
 
-    // eslint-disable-next-line react/no-find-dom-node
-    const renderedHeight = (ReactDOM.findDOMNode(this) as HTMLElement).offsetHeight;
+    if (!this.props.renderedHeight) {
+      // eslint-disable-next-line react/no-find-dom-node
+      const renderedHeight = (ReactDOM.findDOMNode(this) as HTMLElement).offsetHeight;
 
-    if (renderedHeight < this.props.clipHeight) {
-      this.reveal();
+      if (renderedHeight < this.props.clipHeight) {
+        this.reveal();
+      }
     }
   }
 
diff --git a/src/sentry/static/sentry/app/components/events/interfaces/debugMeta/index.tsx b/src/sentry/static/sentry/app/components/events/interfaces/debugMeta/index.tsx
index ad48c2a8df..6b23ab776f 100644
--- a/src/sentry/static/sentry/app/components/events/interfaces/debugMeta/index.tsx
+++ b/src/sentry/static/sentry/app/components/events/interfaces/debugMeta/index.tsx
@@ -1,6 +1,7 @@
 import isNil from 'lodash/isNil';
 import React from 'react';
 import styled from '@emotion/styled';
+import isEqual from 'lodash/isEqual';
 import {
   List,
   ListRowProps,
@@ -91,7 +92,7 @@ class DebugMeta extends React.PureComponent<Props, State> {
     }
 
     if (
-      prevState.foundFrame !== this.state.foundFrame ||
+      !isEqual(prevState.foundFrame, this.state.foundFrame) ||
       this.state.showDetails !== prevState.showDetails
     ) {
       this.updateGrid();
@@ -119,9 +120,13 @@ class DebugMeta extends React.PureComponent<Props, State> {
   }
 
   getPanelBodyHeight() {
-    this.setState({
-      panelBodyHeight: this.panelBodyRef?.current?.offsetHeight,
-    });
+    const panelBodyHeight = this.panelBodyRef?.current?.offsetHeight;
+
+    if (!panelBodyHeight) {
+      return;
+    }
+
+    this.setState({panelBodyHeight});
   }
 
   onStoreChange = (store: {filter: string}) => {
@@ -395,27 +400,27 @@ class DebugMeta extends React.PureComponent<Props, State> {
         isCentered
       >
         <DebugImagesPanel>
-          <ClippedBox
-            clipHeight={clipHeight}
-            renderedHeight={panelBodyHeight}
-            onReveal={this.handleOnReveal}
-          >
-            <PanelBody forwardRef={this.panelBodyRef}>
+          {filteredImages.length > 0 ? (
+            <ClippedBox
+              clipHeight={clipHeight}
+              renderedHeight={panelBodyHeight}
+              onReveal={this.handleOnReveal}
+            >
               {foundFrame && (
                 <ImageForBar
                   frame={foundFrame}
                   onShowAllImages={this.handleChangeFilter}
                 />
               )}
-              {filteredImages.length > 0 ? (
-                this.renderImageList()
-              ) : (
-                <EmptyMessage icon={<IconWarning size="xl" />}>
-                  {this.getNoImagesMessage()}
-                </EmptyMessage>
-              )}
-            </PanelBody>
-          </ClippedBox>
+              <PanelBody forwardRef={this.panelBodyRef}>
+                {this.renderImageList()}
+              </PanelBody>
+            </ClippedBox>
+          ) : (
+            <EmptyMessage icon={<IconWarning size="xl" />}>
+              {this.getNoImagesMessage()}
+            </EmptyMessage>
+          )}
         </DebugImagesPanel>
       </StyledEventDataSection>
     );
