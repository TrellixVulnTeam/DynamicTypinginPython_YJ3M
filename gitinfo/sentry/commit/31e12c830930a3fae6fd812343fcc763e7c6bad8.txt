commit 31e12c830930a3fae6fd812343fcc763e7c6bad8
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Oct 14 23:05:27 2013 +0100

    Convert send_recover_mail to MessageBuilder

diff --git a/src/sentry/models.py b/src/sentry/models.py
index 1d68ed1a20..7d0a16403f 100644
--- a/src/sentry/models.py
+++ b/src/sentry/models.py
@@ -1050,8 +1050,7 @@ class LostPasswordHash(Model):
         return self.date_added > timezone.now() - timedelta(days=1)
 
     def send_recover_mail(self):
-        from django.core.mail import send_mail
-        from sentry.web.helpers import render_to_string
+        from sentry.utils.email import MessageBuilder
 
         context = {
             'user': self.user,
@@ -1061,14 +1060,14 @@ class LostPasswordHash(Model):
                 args=[self.user.id, self.hash]
             )),
         }
-        body = render_to_string('sentry/emails/recover_account.txt', context)
+        msg = MessageBuilder(
+            subject='%sPassword Recovery' % (settings.EMAIL_SUBJECT_PREFIX,),
+            template='sentry/emails/recover_account.txt',
+            context=context,
+        )
 
         try:
-            send_mail(
-                '%sPassword Recovery' % (settings.EMAIL_SUBJECT_PREFIX,),
-                body, settings.SERVER_EMAIL, [self.user.email],
-                fail_silently=False
-            )
+            msg.send([self.user.email])
         except Exception, e:
             logger = logging.getLogger('sentry.mail.errors')
             logger.exception(e)
