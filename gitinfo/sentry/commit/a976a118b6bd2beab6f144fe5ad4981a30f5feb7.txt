commit a976a118b6bd2beab6f144fe5ad4981a30f5feb7
Author: Markus Unterwaditzer <markus@unterwaditzer.net>
Date:   Mon Jul 15 13:51:00 2019 +0200

    feat: Measure volume of transaction events (#13954)
    
    * feat: Measure volume of transaction events
    
    * doc: Add code comment

diff --git a/src/sentry/utils/sdk.py b/src/sentry/utils/sdk.py
index e5bdd3d4ec..9d29e724cc 100644
--- a/src/sentry/utils/sdk.py
+++ b/src/sentry/utils/sdk.py
@@ -90,6 +90,10 @@ def configure_sdk():
         upstream_transport = make_transport(get_options(options))
 
     def capture_event(event):
+        if event.get('type') == 'transaction':
+            metrics.incr('internal.apm.events', skip_internal=False)
+            return
+
         # Make sure we log to upstream when available first
         if upstream_transport is not None:
             # TODO(mattrobenolt): Bring this back safely.
@@ -109,6 +113,10 @@ def configure_sdk():
             RustInfoIntegration(),
         ],
         transport=capture_event,
+
+        # We use `capture_event` to discard all transaction events and just
+        # make a statsd metric. Figure out how much we would send.
+        traces_sample_rate=1.0,
         **options
     )
 
