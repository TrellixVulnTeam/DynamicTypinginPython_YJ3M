commit 230f7ba089c82f6ae6bdf14971c4e906021d819c
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Apr 29 00:55:52 2013 -0700

    Really really prevent the stampede

diff --git a/src/sentry/buffer/redis.py b/src/sentry/buffer/redis.py
index df4215c428..569a86901a 100644
--- a/src/sentry/buffer/redis.py
+++ b/src/sentry/buffer/redis.py
@@ -96,7 +96,8 @@ class RedisBuffer(Buffer):
         # prevent a stampede due to the way we use celery etas + duplicate
         # tasks
         if not self.conn.setnx(lock_key, '1'):
-            self.conn.expire(lock_key, self.delay)
+            return
+        self.conn.expire(lock_key, self.delay)
 
         results = {}
         with self.conn.map() as conn:
