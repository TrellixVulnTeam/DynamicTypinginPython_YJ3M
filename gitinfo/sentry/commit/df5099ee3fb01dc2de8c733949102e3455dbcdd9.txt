commit df5099ee3fb01dc2de8c733949102e3455dbcdd9
Author: Lauryn Brown <lauryndbrown@gmail.com>
Date:   Fri Apr 26 14:12:56 2019 -0700

    Added search analytics (#12877)

diff --git a/src/sentry/api/analytics.py b/src/sentry/api/analytics.py
index f19c71d76c..47af2163d8 100644
--- a/src/sentry/api/analytics.py
+++ b/src/sentry/api/analytics.py
@@ -7,10 +7,9 @@ class OrganizationSavedSearchCreatedEvent(analytics.Event):
     type = 'organization_saved_search.created'
 
     attributes = (
-        analytics.Attribute('organization_id'),
+        analytics.Attribute('org_id'),
         analytics.Attribute('search_type'),
-        analytics.Attribute('id'),
-        analytics.Attribute('user_id'),
+        analytics.Attribute('query'),
     )
 
 
@@ -18,10 +17,9 @@ class OrganizationSavedSearchDeletedEvent(analytics.Event):
     type = 'organization_saved_search.deleted'
 
     attributes = (
-        analytics.Attribute('organization_id'),
+        analytics.Attribute('org_id'),
         analytics.Attribute('search_type'),
-        analytics.Attribute('id'),
-        analytics.Attribute('user_id'),
+        analytics.Attribute('query'),
     )
 
 
diff --git a/src/sentry/api/endpoints/organization_search_details.py b/src/sentry/api/endpoints/organization_search_details.py
index 1f07c12a0b..1e7a01bd27 100644
--- a/src/sentry/api/endpoints/organization_search_details.py
+++ b/src/sentry/api/endpoints/organization_search_details.py
@@ -9,6 +9,7 @@ from sentry.api.bases.organization import (
 )
 from sentry.api.exceptions import ResourceDoesNotExist
 from sentry.models import SavedSearch
+from sentry.models.search_common import SearchType
 
 
 class OrganizationSearchDetailsEndpoint(OrganizationEndpoint):
@@ -35,9 +36,8 @@ class OrganizationSearchDetailsEndpoint(OrganizationEndpoint):
         search.delete()
         analytics.record(
             'organization_saved_search.deleted',
-            search_type=search.type,
-            organization_id=organization.id,
-            id=search_id,
-            user_id=request.user.id,
+            search_type=SearchType(search.type).name,
+            org_id=organization.id,
+            query=search.query,
         )
         return Response(status=204)
diff --git a/src/sentry/api/endpoints/organization_searches.py b/src/sentry/api/endpoints/organization_searches.py
index 6e60ae2436..75b5459ab9 100644
--- a/src/sentry/api/endpoints/organization_searches.py
+++ b/src/sentry/api/endpoints/organization_searches.py
@@ -111,10 +111,9 @@ class OrganizationSearchesEndpoint(OrganizationEndpoint):
             )
             analytics.record(
                 'organization_saved_search.created',
-                search_type=saved_search.type,
-                organization_id=organization.id,
-                id=saved_search.id,
-                user_id=request.user.id,
+                search_type=SearchType(saved_search.type).name,
+                org_id=organization.id,
+                query=saved_search.query,
             )
             return Response(serialize(saved_search, request.user))
         return Response(serializer.errors, status=400)
