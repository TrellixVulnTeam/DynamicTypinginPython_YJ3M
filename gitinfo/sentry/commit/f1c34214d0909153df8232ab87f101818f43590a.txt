commit f1c34214d0909153df8232ab87f101818f43590a
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Tue May 15 15:43:00 2018 -0700

    feat(settings): Remove beta notice for org/projects (#8454)

diff --git a/src/sentry/static/sentry/app/views/settings/account/accountEmails.jsx b/src/sentry/static/sentry/app/views/settings/account/accountEmails.jsx
index c6f99079cb..044128c29c 100644
--- a/src/sentry/static/sentry/app/views/settings/account/accountEmails.jsx
+++ b/src/sentry/static/sentry/app/views/settings/account/accountEmails.jsx
@@ -1,7 +1,6 @@
 import {Flex, Box} from 'grid-emotion';
 import PropTypes from 'prop-types';
 import React from 'react';
-import styled from 'react-emotion';
 
 import {addErrorMessage} from 'app/actionCreators/indicator';
 import {t} from 'app/locale';
@@ -17,14 +16,6 @@ import accountEmailsFields from 'app/data/forms/accountEmails';
 
 const ENDPOINT = '/users/me/emails/';
 
-const RemoveButton = styled(({hidden, ...props}) => (
-  <Button priority="danger" size="small" {...props}>
-    <span className="icon-trash" />
-  </Button>
-))`
-  ${p => (p.hidden ? 'opacity: 0' : '')};
-`;
-
 class EmailRow extends React.Component {
   static propTypes = {
     email: PropTypes.string.isRequired,
@@ -72,14 +63,18 @@ class EmailRow extends React.Component {
               {t('Resend verification')}
             </Button>
           )}
-          {!hideRemove && (
-            <Box ml={1}>
-              <RemoveButton
-                onClick={this.handleRemove}
-                hidden={isPrimary || hideRemove}
-              />
-            </Box>
-          )}
+          {!hideRemove &&
+            !isPrimary && (
+              <Box ml={1}>
+                <Button
+                  data-test-id="remove"
+                  priority="danger"
+                  size="small"
+                  icon="icon-trash"
+                  onClick={this.handleRemove}
+                />
+              </Box>
+            )}
         </Flex>
       </PanelItem>
     );
diff --git a/src/sentry/static/sentry/app/views/settings/account/accountSettingsLayout.jsx b/src/sentry/static/sentry/app/views/settings/account/accountSettingsLayout.jsx
index cac66de596..445df9cfe3 100644
--- a/src/sentry/static/sentry/app/views/settings/account/accountSettingsLayout.jsx
+++ b/src/sentry/static/sentry/app/views/settings/account/accountSettingsLayout.jsx
@@ -6,12 +6,14 @@ import SettingsLayout from 'app/views/settings/components/settingsLayout';
 class AccountSettingsLayout extends React.Component {
   render() {
     return (
-      <SettingsLayout
-        {...this.props}
-        renderNavigation={() => <AccountSettingsNavigation {...this.props} />}
-      >
-        {this.props.children}
-      </SettingsLayout>
+      <div className="app">
+        <SettingsLayout
+          {...this.props}
+          renderNavigation={() => <AccountSettingsNavigation {...this.props} />}
+        >
+          {this.props.children}
+        </SettingsLayout>
+      </div>
     );
   }
 }
diff --git a/src/sentry/static/sentry/app/views/settings/components/settingsLayout.jsx b/src/sentry/static/sentry/app/views/settings/components/settingsLayout.jsx
index cf597f55e9..b05c600ea7 100644
--- a/src/sentry/static/sentry/app/views/settings/components/settingsLayout.jsx
+++ b/src/sentry/static/sentry/app/views/settings/components/settingsLayout.jsx
@@ -38,15 +38,8 @@ let NewSettingsWarning = ({location = {}}) => {
       .replace('settings/close-account/', 'remove/')
       .replace('account/settings/api/', 'api/')
       .replace('auth-tokens/', '');
-  } else if (isOrgIndex) {
-    oldLocation = location.pathname.replace(
-      orgSettingsIndex,
-      '/organizations/$1/settings/'
-    );
-  } else if (isOrg) {
-    oldLocation = location.pathname.replace(orgRegex, '/organizations/$1/$2/');
-  } else if (isProject) {
-    oldLocation = location.pathname.replace(projectRegex, '/$1/$2/settings/');
+  } else if (isOrgIndex || isOrg || isProject) {
+    return null;
   }
 
   // original org auth view and account settings are django views so we can't use react router navigation
@@ -71,6 +64,11 @@ const Container = styled(Flex)`
   padding: 0 ${p => p.theme.grid * 2}px;
 `;
 
+// this wrapper is required, else content won't stretch horizontally
+const ContentContainerWrapper = styled(Box)`
+  flex: 1; /* so this stretches vertically so that footer is fixed at bottom */
+`;
+
 const SidebarWrapper = styled(Box)`
   flex-shrink: 0;
   width: ${p => p.theme.settings.sidebarWidth};
@@ -129,15 +127,19 @@ class SettingsLayout extends React.Component {
             </Flex>
           </Container>
         </SettingsHeader>
-        <Container flex="1">
-          {typeof renderNavigation === 'function' && (
-            <SidebarWrapper>{renderNavigation()}</SidebarWrapper>
-          )}
-          <Content>
-            {children}
-            <NewSettingsWarning location={this.props.location} />
-          </Content>
-        </Container>
+
+        {/* this is div wrapper is required, else content won't stretch horizontally */}
+        <ContentContainerWrapper>
+          <Container>
+            {typeof renderNavigation === 'function' && (
+              <SidebarWrapper>{renderNavigation()}</SidebarWrapper>
+            )}
+            <Content>
+              {children}
+              <NewSettingsWarning location={this.props.location} />
+            </Content>
+          </Container>
+        </ContentContainerWrapper>
         <Footer />
       </React.Fragment>
     );
diff --git a/tests/js/spec/components/__snapshots__/settingsLayout.spec.jsx.snap b/tests/js/spec/components/__snapshots__/settingsLayout.spec.jsx.snap
index ce06971436..4ec573ee0c 100644
--- a/tests/js/spec/components/__snapshots__/settingsLayout.spec.jsx.snap
+++ b/tests/js/spec/components/__snapshots__/settingsLayout.spec.jsx.snap
@@ -27,13 +27,13 @@ exports[`SettingsLayout renders 1`] = `
       </Flex>
     </Container>
   </SettingsHeader>
-  <Container
-    flex="1"
-  >
-    <Content>
-      <NewSettingsWarning />
-    </Content>
-  </Container>
+  <ContentContainerWrapper>
+    <Container>
+      <Content>
+        <NewSettingsWarning />
+      </Content>
+    </Container>
+  </ContentContainerWrapper>
   <Footer />
 </React.Fragment>
 `;
diff --git a/tests/js/spec/views/accountEmails.spec.jsx b/tests/js/spec/views/accountEmails.spec.jsx
index bf051f7491..2ab6efec94 100644
--- a/tests/js/spec/views/accountEmails.spec.jsx
+++ b/tests/js/spec/views/accountEmails.spec.jsx
@@ -36,7 +36,7 @@ describe('AccountEmails', function() {
 
     // The first Button should be delete button for first secondary email (NOT primary)
     wrapper
-      .find('RemoveButton')
+      .find('[data-test-id="remove"]')
       .at(1)
       .simulate('click');
 
