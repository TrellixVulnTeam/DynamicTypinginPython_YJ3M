commit f2014c26338fd87185dcb60904f46ff01087ae5d
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Jul 29 11:49:38 2010 -0700

    Support disabling of thrashing limits

diff --git a/djangodblog/manager.py b/djangodblog/manager.py
index 5d0fd64254..b0e84daa28 100644
--- a/djangodblog/manager.py
+++ b/djangodblog/manager.py
@@ -56,10 +56,11 @@ class DBLogManager(models.Manager):
         )
         instance.checksum = construct_checksum(instance)
         
-        cache_key = 'djangodblog:%s:%s' % (instance.class_name, instance.checksum)
-        added = cache.add(cache_key, 1, settings.THRASHING_TIMEOUT)
-        if not added and cache.incr(cache_key) > settings.THRASHING_LIMIT:
-            return
+        if settings.THRASHING_TIMEOUT and settings.THRASHING_LIMIT:
+            cache_key = 'djangodblog:%s:%s' % (instance.class_name, instance.checksum)
+            added = cache.add(cache_key, 1, settings.THRASHING_TIMEOUT)
+            if not added and cache.incr(cache_key) > settings.THRASHING_LIMIT:
+                return
 
         try:
             instance.save()
