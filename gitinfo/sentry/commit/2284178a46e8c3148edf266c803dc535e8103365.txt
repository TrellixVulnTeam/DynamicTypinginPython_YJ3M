commit 2284178a46e8c3148edf266c803dc535e8103365
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Oct 30 02:09:28 2015 -0700

    Enforce org:write permission on create member

diff --git a/src/sentry/web/frontend/create_organization_member.py b/src/sentry/web/frontend/create_organization_member.py
index cb17df9f22..f4b898bdfc 100644
--- a/src/sentry/web/frontend/create_organization_member.py
+++ b/src/sentry/web/frontend/create_organization_member.py
@@ -13,6 +13,8 @@ from sentry.web.forms.add_organization_member import AddOrganizationMemberForm
 
 
 class CreateOrganizationMemberView(OrganizationView):
+    required_scope = 'org:write'
+
     def get_form(self, request, organization):
         initial = {
             'role': organization.default_role,
diff --git a/tests/sentry/web/frontend/test_create_organization_member.py b/tests/sentry/web/frontend/test_create_organization_member.py
index 84b3a0959d..a978132041 100644
--- a/tests/sentry/web/frontend/test_create_organization_member.py
+++ b/tests/sentry/web/frontend/test_create_organization_member.py
@@ -4,7 +4,22 @@ from django.core import mail
 from django.core.urlresolvers import reverse
 
 from sentry.models import OrganizationMember
-from sentry.testutils import TestCase
+from sentry.testutils import PermissionTestCase, TestCase
+
+
+class CreateOrganizationMemberPermissionTest(PermissionTestCase):
+    def setUp(self):
+        super(CreateOrganizationMemberPermissionTest, self).setUp()
+        self.path = reverse('sentry-create-organization-member', args=[self.organization.slug])
+
+    def test_teamless_admin_cannot_load(self):
+        self.assert_teamless_admin_cannot_access(self.path)
+
+    def test_owner_can_load(self):
+        self.assert_owner_can_access(self.path)
+
+    def test_member_cannot_load(self):
+        self.assert_member_cannot_access(self.path)
 
 
 class CreateOrganizationMemberTest(TestCase):
