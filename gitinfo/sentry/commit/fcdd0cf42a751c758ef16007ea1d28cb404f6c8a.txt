commit fcdd0cf42a751c758ef16007ea1d28cb404f6c8a
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jun 8 16:26:34 2016 -0700

    Ensure a message is always available

diff --git a/src/sentry/event_manager.py b/src/sentry/event_manager.py
index c5af984a85..03c9fa483b 100644
--- a/src/sentry/event_manager.py
+++ b/src/sentry/event_manager.py
@@ -478,6 +478,8 @@ class EventManager(object):
                     data['sentry.interfaces.Message']['message'],
                 )
 
+        if not message:
+            message = ''
         for value in event_metadata.itervalues():
             value_u = unicode(value)
             if value_u not in message:
diff --git a/tests/sentry/test_event_manager.py b/tests/sentry/test_event_manager.py
index 719f590c1b..ee6d6342e8 100644
--- a/tests/sentry/test_event_manager.py
+++ b/tests/sentry/test_event_manager.py
@@ -584,6 +584,19 @@ class EventManagerTest(TransactionTestCase):
             'version': '1.0',
         }
 
+    def test_no_message(self):
+        # test that the message is handled gracefully
+        manager = EventManager(self.make_event(**{
+            'message': '',
+            'sentry.interfaces.Message': {
+                'message': 'hello world',
+            },
+        }))
+        manager.normalize()
+        event = manager.save(self.project.id)
+
+        assert event.message == 'hello world'
+
 
 class GetHashesFromEventTest(TestCase):
     @patch('sentry.interfaces.stacktrace.Stacktrace.compute_hashes')
