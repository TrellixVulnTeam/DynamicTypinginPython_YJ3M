commit bb40c84f51ee69ff1a130ba7c46fe5873ef94dac
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jan 15 22:15:33 2013 -0800

    Remove silly incorrect project optimization

diff --git a/src/sentry/tasks/cleanup.py b/src/sentry/tasks/cleanup.py
index a1b69c8be8..3dd7462109 100644
--- a/src/sentry/tasks/cleanup.py
+++ b/src/sentry/tasks/cleanup.py
@@ -60,23 +60,19 @@ def cleanup(days=30, project=None, **kwargs):
     qs = FilterKey.objects.all()
     if project:
         qs = qs.filter(project=project)
-        qs.delete()
-    else:
-        for obj in RangeQuerySetWrapper(qs):
-            if not mqs.filter(key=obj.key).exists():
-                log.info("Removing filters for unused filter %s=*", obj.key,)
-                qs.filter(key=obj.key).delete()
-                obj.delete()
+    for obj in RangeQuerySetWrapper(qs):
+        if not mqs.filter(key=obj.key).exists():
+            log.info("Removing unused filter %s=*", obj.key,)
+            qs.filter(key=obj.key).delete()
+            obj.delete()
 
     # FilterValue
     log.info("Removing %r for days=%s project=%r" % (FilterValue, days, project))
     qs = FilterValue.objects.all()
     if project:
         qs = qs.filter(project=project)
-        qs.delete()
-    else:
-        for obj in RangeQuerySetWrapper(qs):
-            if not mqs.filter(key=obj.key, value=obj.value).exists():
-                log.info("Removing filters for unused filter %s=%s", obj.key, obj.value)
-                qs.filter(key=obj.key, value=obj.value).delete()
-                obj.delete()
+    for obj in RangeQuerySetWrapper(qs):
+        if not mqs.filter(key=obj.key, value=obj.value).exists():
+            log.info("Removing unused filter %s=%s", obj.key, obj.value)
+            qs.filter(key=obj.key, value=obj.value).delete()
+            obj.delete()
