commit 206c4489e707d03312265446195b64859e213d0a
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Dec 10 14:40:34 2015 -0800

    Add merge activity (fixes GH-2445)

diff --git a/src/sentry/api/endpoints/project_group_index.py b/src/sentry/api/endpoints/project_group_index.py
index 2ff579c976..eb8888d9bc 100644
--- a/src/sentry/api/endpoints/project_group_index.py
+++ b/src/sentry/api/endpoints/project_group_index.py
@@ -542,6 +542,17 @@ class ProjectGroupIndexEndpoint(ProjectEndpoint):
                     from_object_id=group.id,
                     to_object_id=primary_group.id,
                 )
+
+            Activity.objects.create(
+                project=primary_group.project,
+                group=primary_group,
+                type=Activity.MERGE,
+                user=acting_user,
+                data={
+                    'issues': [{'id': c.id} for c in children],
+                },
+            )
+
             result['merge'] = {
                 'parent': str(primary_group.id),
                 'children': [str(g.id) for g in children],
diff --git a/src/sentry/models/activity.py b/src/sentry/models/activity.py
index 5de39fe57d..d71964edd6 100644
--- a/src/sentry/models/activity.py
+++ b/src/sentry/models/activity.py
@@ -35,6 +35,7 @@ class Activity(Model):
     ASSIGNED = 11
     UNASSIGNED = 12
     SET_RESOLVED_IN_RELEASE = 13
+    MERGE = 14
 
     TYPE = (
         # (TYPE, verb-slug)
@@ -51,6 +52,7 @@ class Activity(Model):
         (RELEASE, 'release'),
         (ASSIGNED, 'assigned'),
         (UNASSIGNED, 'unassigned'),
+        (MERGE, 'merge'),
     )
 
     project = FlexibleForeignKey('sentry.Project')
diff --git a/src/sentry/static/sentry/app/views/groupActivity/index.jsx b/src/sentry/static/sentry/app/views/groupActivity/index.jsx
index 13a1ccf37c..3b1ab7bfdd 100644
--- a/src/sentry/static/sentry/app/views/groupActivity/index.jsx
+++ b/src/sentry/static/sentry/app/views/groupActivity/index.jsx
@@ -10,7 +10,7 @@ import Version from '../../components/version';
 
 import NoteContainer from './noteContainer';
 import NoteInput from './noteInput';
-import {t} from '../../locale';
+import {t, tn} from '../../locale';
 
 
 const GroupActivity = React.createClass({
@@ -88,6 +88,11 @@ const GroupActivity = React.createClass({
         });
       case 'unassigned':
         return t('%s unassigned this issue', author);
+      case 'merge':
+        return tn('%2$s merged %1$d issue into this isssue',
+                  '%2$s merged %1$d issues into this isssue',
+                  data.issues.length,
+                  author);
       default:
         return ''; // should never hit (?)
     }
