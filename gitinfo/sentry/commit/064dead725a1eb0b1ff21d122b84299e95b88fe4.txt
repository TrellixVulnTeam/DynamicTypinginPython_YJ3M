commit 064dead725a1eb0b1ff21d122b84299e95b88fe4
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Tue Oct 27 11:36:26 2015 -0700

    Make sure a numeric org slug hits the right route
    
    fixes gh-2236

diff --git a/src/sentry/api/urls.py b/src/sentry/api/urls.py
index 44f5147d5b..daf5241c96 100644
--- a/src/sentry/api/urls.py
+++ b/src/sentry/api/urls.py
@@ -128,7 +128,7 @@ urlpatterns = patterns(
 
     # Handles redirecting project_id => org_slug/project_slug
     # TODO(dcramer): remove this after a reasonable period of time
-    url(r'^projects/(?P<project_id>\d+)/(?P<path>(?:groups|releases|stats|tags)/.+)?',
+    url(r'^projects/(?P<project_id>\d+)/(?P<path>(?:groups|releases|stats|tags)/.*)$',
         LegacyProjectRedirectEndpoint.as_view()),
 
     # Projects
diff --git a/tests/sentry/api/endpoints/test_legacy_project_redirect.py b/tests/sentry/api/endpoints/test_legacy_project_redirect.py
new file mode 100644
index 0000000000..29b8aab896
--- /dev/null
+++ b/tests/sentry/api/endpoints/test_legacy_project_redirect.py
@@ -0,0 +1,15 @@
+from __future__ import absolute_import
+
+from sentry.testutils import APITestCase
+
+
+class LegacyProjectRedirectTest(APITestCase):
+    def test_simple(self):
+        self.login_as(user=self.user)
+
+        # Explicitly test against the url pattern
+        url = '/api/0/projects/%d/stats/' % self.project.pk
+        response = self.client.get(url, format='json')
+
+        assert response.status_code == 302, response.content
+        assert response['Location'] == 'http://example.com/api/0/projects/baz/bar/stats/'
diff --git a/tests/sentry/api/endpoints/test_project_details.py b/tests/sentry/api/endpoints/test_project_details.py
index b1b6bc6fcf..acdaaa6f2a 100644
--- a/tests/sentry/api/endpoints/test_project_details.py
+++ b/tests/sentry/api/endpoints/test_project_details.py
@@ -20,6 +20,30 @@ class ProjectDetailsTest(APITestCase):
         assert response.status_code == 200
         assert response.data['id'] == str(project.id)
 
+    def test_numeric_org_slug(self):
+        # Regression test for https://github.com/getsentry/sentry/issues/2236
+        self.login_as(user=self.user)
+        org = self.create_organization(
+            name='baz',
+            slug='1',
+            owner=self.user,
+        )
+        team = self.create_team(
+            organization=org,
+            name='foo',
+            slug='foo',
+        )
+        project = self.create_project(
+            name='Bar',
+            slug='bar',
+            team=team,
+        )
+        # We want to make sure we don't hit the LegacyProjectRedirect view at all.
+        url = '/api/0/projects/%s/%s/' % (org.slug, project.slug)
+        response = self.client.get(url)
+        assert response.status_code == 200
+        assert response.data['id'] == str(project.id)
+
 
 class ProjectUpdateTest(APITestCase):
     def test_simple(self):
