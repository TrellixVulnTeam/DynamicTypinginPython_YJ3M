commit 23f470acfdd1191823ba8f6631cd52524565df85
Author: Ben Vinegar <ben@benv.ca>
Date:   Thu Aug 27 13:30:21 2015 -0700

    Fix project picker issues ... (fixes #1854)
    
    * "Esc" key now closes picker
    * Tabbing away from input also closes
    * Choosing a project, or closing picker, resets search query

diff --git a/src/sentry/static/sentry/app/components/dropdownLink.jsx b/src/sentry/static/sentry/app/components/dropdownLink.jsx
index 707f6ad22a..8b68399894 100644
--- a/src/sentry/static/sentry/app/components/dropdownLink.jsx
+++ b/src/sentry/static/sentry/app/components/dropdownLink.jsx
@@ -24,6 +24,10 @@ var DropdownLink = React.createClass({
     return this.getDOMNode().classList.contains("open");
   },
 
+  close() {
+    this.getDOMNode().classList.remove("open");
+  },
+
   onToggle(e) {
     if (this.isOpen()) {
       if (this.props.onOpen) {
diff --git a/src/sentry/static/sentry/app/components/projectHeader.jsx b/src/sentry/static/sentry/app/components/projectHeader.jsx
index daffa79318..6f27d04822 100644
--- a/src/sentry/static/sentry/app/components/projectHeader.jsx
+++ b/src/sentry/static/sentry/app/components/projectHeader.jsx
@@ -28,6 +28,26 @@ var ProjectSelector = React.createClass({
     });
   },
 
+  onKeyUp(e) {
+    if (event.key === 'Escape' || event.keyCode === 27) {
+      // blur handler should additionally hide dropdown
+      this.close();
+    }
+  },
+
+  onFilterBlur() {
+    // HACK: setTimeout because blur might be caused by clicking
+    // project link; in which case, will close dropdown before
+    // link click is processed. Why 200ms? Decently short time
+    // period that seemed to work in all browsers.
+    setTimeout(() => this.close(), 200);
+  },
+
+  close() {
+    this.setState({ filter: '' });
+    this.refs.dropdownLink.close();
+  },
+
   highlight(text, highlightText) {
     if (!highlightText) {
       return text;
@@ -64,14 +84,13 @@ var ProjectSelector = React.createClass({
   },
 
   onOpen(event) {
-    jQuery(this.refs.filter.getDOMNode()).focus();
+    this.refs.filter.getDOMNode().focus();
   },
 
-  onClose(event) {
+  onClose() {
     this.setState({
       filter: ''
     });
-    jQuery(this.refs.filter.getDOMNode()).val('');
   },
 
   componentDidUpdate(prevProps, prevState) {
@@ -128,11 +147,17 @@ var ProjectSelector = React.createClass({
     return (
       <div className="project-select" ref="container">
         <Router.Link to="stream" params={projectRouteParams}>{activeProjectName}</Router.Link>
-        <DropdownLink title="" topLevelClasses="project-dropdown"
+        <DropdownLink ref="dropdownLink" title="" topLevelClasses="project-dropdown"
             onOpen={this.onOpen} onClose={this.onClose}>
           <li className="project-filter" key="_filter">
-            <input type="text" placeholder="Filter projects"
-                   onKeyUp={this.onFilterChange} ref="filter" />
+            <input
+              value={this.state.filter}
+              type="text"
+              placeholder="Filter projects"
+              onChange={this.onFilterChange}
+              onKeyUp={this.onKeyUp}
+              onBlur={this.onFilterBlur}
+              ref="filter" />
           </li>
           {children}
         </DropdownLink>
