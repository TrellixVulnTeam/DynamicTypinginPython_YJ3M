commit 6daadd92b363fadc675bdf7b86283cefb0519402
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Feb 22 05:16:01 2013 -0800

    Better make coverage

diff --git a/.coveragerc b/.coveragerc
new file mode 100644
index 0000000000..57573af250
--- /dev/null
+++ b/.coveragerc
@@ -0,0 +1,2 @@
+[report]
+omit=src/sentry/migrations/*
\ No newline at end of file
diff --git a/Makefile b/Makefile
index 9d1fdf710c..796666af62 100644
--- a/Makefile
+++ b/Makefile
@@ -58,9 +58,8 @@ lint-js:
 	@${NPM_ROOT}/jshint/bin/hint src/sentry/ || exit 1
 	@echo ""
 
-coverage:
-	coverage run --include=src/sentry/* setup.py test
-	coverage html --omit=src/sentry/migrations/* -d htmlcov
+coverage: install-test-requirements
+	py.test --cov=src/sentry --cov-report=html
 
 
 .PHONY: build
diff --git a/setup.py b/setup.py
index c2744be787..16eb2de951 100755
--- a/setup.py
+++ b/setup.py
@@ -36,6 +36,7 @@ for m in ('multiprocessing', 'billiard'):
 
 dev_requires = [
     'flake8>=1.7.0',
+    'pytest-cov>=1.4',
 ]
 
 tests_require = [
