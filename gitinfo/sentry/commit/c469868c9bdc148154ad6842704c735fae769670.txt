commit c469868c9bdc148154ad6842704c735fae769670
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jan 14 10:18:49 2015 -0800

    Send X-Forwarded-For as actual client ip

diff --git a/docs/quickstart/nginx.rst b/docs/quickstart/nginx.rst
index ab38a673c3..af1d80eae9 100644
--- a/docs/quickstart/nginx.rst
+++ b/docs/quickstart/nginx.rst
@@ -49,6 +49,7 @@ Below is a sample production ready configuration for Nginx with Sentry:
 
         proxy_set_header   Host                 $http_host;
         proxy_set_header   X-Forwarded-Proto    $scheme;
+        proxy_set_header   X-Forwarded-For      $remote_addr;
         proxy_redirect     off;
 
         # keepalive + raven.js is a disaster
@@ -112,6 +113,7 @@ Create a uWSGI configuration which references the Sentry configuration:
     enable-threads = true
     single-interpreter = true
     lazy-apps = true
+    log-x-forwarded-for = true
 
 
 Finally, re-configure supervisor to run uwsgi instead of 'sentry start':
diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 9e71e52fe5..f3276e1ef9 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -118,6 +118,7 @@ TEMPLATE_LOADERS = (
 
 MIDDLEWARE_CLASSES = (
     'sentry.middleware.maintenance.ServicesUnavailableMiddleware',
+    'sentry.middleware.proxy.SetRemoteAddrFromForwardedFor',
     'sentry.middleware.debug.NoIfModifiedSinceMiddleware',
     'django.middleware.common.CommonMiddleware',
     'django.contrib.sessions.middleware.SessionMiddleware',
