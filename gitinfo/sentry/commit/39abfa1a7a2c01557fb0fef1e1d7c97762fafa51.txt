commit 39abfa1a7a2c01557fb0fef1e1d7c97762fafa51
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jul 15 10:48:59 2013 -0700

    Set ALLOWED_HOSTS autoamtically based on SENTRY_URL_PREFIX

diff --git a/src/sentry/utils/runner.py b/src/sentry/utils/runner.py
index c6a13dd97d..e413b2e667 100644
--- a/src/sentry/utils/runner.py
+++ b/src/sentry/utils/runner.py
@@ -227,6 +227,12 @@ def apply_legacy_settings(config):
                       'See http://sentry.readthedocs.org/en/latest/queue/index.html for more information.')
         settings.CELERY_ALWAYS_EAGER = (not settings.SENTRY_USE_QUEUE)
 
+    # Set ALLOWED_HOSTS if it's not already available
+    if not settings.ALLOWED_HOSTS and settings.SENTRY_URL_PREFIX:
+        from urlparse import urlparse
+        urlbits = urlparse(settings.SENTRY_URL_PREFIX)
+        if urlbits.hostname:
+            settings.ALLOWED_HOSTS = (urlbits.hostname,)
 
 def table_exists(name):
     from django.db import connections
