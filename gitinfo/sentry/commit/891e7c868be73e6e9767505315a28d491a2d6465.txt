commit 891e7c868be73e6e9767505315a28d491a2d6465
Author: ted kaemming <t.kaemming+github@gmail.com>
Date:   Fri Aug 12 16:40:38 2016 -0700

    Add weekly reports to Celery schedule. (#3934)

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 00e3c5396d..9edffc7bad 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -430,6 +430,8 @@ def create_partitioned_queues(name):
 create_partitioned_queues('counters')
 create_partitioned_queues('triggers')
 
+from celery.schedules import crontab
+
 CELERYBEAT_SCHEDULE_FILENAME = os.path.join(tempfile.gettempdir(), 'sentry-celerybeat')
 CELERYBEAT_SCHEDULE = {
     'check-auth': {
@@ -506,6 +508,17 @@ CELERYBEAT_SCHEDULE = {
             'expires': 60 * 25,
         },
     },
+    'schedule-weekly-organization-reports': {
+        'task': 'sentry.tasks.reports.prepare_reports',
+        'schedule': crontab(
+            minute=0,
+            hour=12,  # 05:00 PDT, 09:00 EDT, 12:00 UTC
+            day_of_week='monday',
+        ),
+        'options': {
+            'expires': 60 * 60 * 3,
+        },
+    },
 }
 
 # Sentry logs to two major places: stdout, and it's internal project.
