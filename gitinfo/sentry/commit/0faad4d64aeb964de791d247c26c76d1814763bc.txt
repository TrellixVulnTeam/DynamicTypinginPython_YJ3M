commit 0faad4d64aeb964de791d247c26c76d1814763bc
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Nov 23 04:39:16 2014 -0800

    Quick fix for account notification settings

diff --git a/src/sentry/web/frontend/accounts.py b/src/sentry/web/frontend/accounts.py
index 2b2071ae8a..9cb31d2f67 100644
--- a/src/sentry/web/frontend/accounts.py
+++ b/src/sentry/web/frontend/accounts.py
@@ -20,8 +20,9 @@ from django.views.decorators.csrf import csrf_protect
 from django.utils import timezone
 from sudo.decorators import sudo_required
 
-from sentry.constants import MEMBER_USER
-from sentry.models import Project, UserOption, LostPasswordHash
+from sentry.models import (
+    LostPasswordHash, Organization, Project, Team, UserOption
+)
 from sentry.plugins import plugins
 from sentry.web.decorators import login_required
 from sentry.web.forms.accounts import (
@@ -260,11 +261,25 @@ def appearance_settings(request):
 def notification_settings(request):
     settings_form = NotificationSettingsForm(request.user, request.POST or None)
 
-    # TODO(dcramer): we need to list out all projects by org/team
-    project_list = Project.objects.get_for_user(
+    # TODO(dcramer): this is an extremely bad pattern and we need a more optimal
+    # solution for rendering this (that ideally plays well with the org data)
+    project_list = []
+    organization_list = Organization.objects.get_for_user(
         user=request.user,
-        access=MEMBER_USER,
     )
+    for organization in organization_list:
+        team_list = Team.objects.get_for_user(
+            user=request.user,
+            organization=organization,
+        )
+        for team in team_list:
+            project_list.extend(
+                Project.objects.get_for_user(
+                    user=request.user,
+                    team=team,
+                )
+            )
+
     project_forms = [
         (project, ProjectEmailOptionsForm(
             project, request.user,
