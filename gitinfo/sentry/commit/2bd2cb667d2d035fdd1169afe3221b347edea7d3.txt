commit 2bd2cb667d2d035fdd1169afe3221b347edea7d3
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Wed Jul 6 16:14:21 2016 -0700

    Filter out None's when cleaning up nodestore (#3659)

diff --git a/src/sentry/nodestore/django/backend.py b/src/sentry/nodestore/django/backend.py
index a9bbef4180..8aee44e3c7 100644
--- a/src/sentry/nodestore/django/backend.py
+++ b/src/sentry/nodestore/django/backend.py
@@ -30,10 +30,13 @@ class DjangoNodeStorage(NodeStorage):
             return None
 
     def get_multi(self, id_list):
-        return dict(
-            (n.id, n.data)
+        return {
+            n.id: n.data
             for n in Node.objects.filter(id__in=id_list)
-        )
+        }
+
+    def delete_multi(self, id_list):
+        Node.objects.filter(id__in=id_list).delete()
 
     def set(self, id, data):
         create_or_update(
diff --git a/src/sentry/tasks/deletion.py b/src/sentry/tasks/deletion.py
index c4229fcbbe..88cb6bdc0d 100644
--- a/src/sentry/tasks/deletion.py
+++ b/src/sentry/tasks/deletion.py
@@ -238,8 +238,9 @@ def delete_events(relation, limit=100, logger=None):
     has_more = bool(result_set)
     if has_more:
         # delete objects from nodestore first
-        node_ids = set(r.data.id for r in result_set)
-        nodestore.delete_multi(node_ids)
+        node_ids = set(r.data.id for r in result_set if r.data.id)
+        if node_ids:
+            nodestore.delete_multi(node_ids)
 
         event_ids = [r.id for r in result_set]
 
