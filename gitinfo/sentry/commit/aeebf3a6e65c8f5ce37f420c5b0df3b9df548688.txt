commit aeebf3a6e65c8f5ce37f420c5b0df3b9df548688
Author: Daniel Griesser <daniel.griesser.86@gmail.com>
Date:   Wed Feb 8 13:37:04 2017 +0100

    Added badge to show processing issues

diff --git a/src/sentry/api/serializers/models/project.py b/src/sentry/api/serializers/models/project.py
index f281aea5a2..c146b2726b 100644
--- a/src/sentry/api/serializers/models/project.py
+++ b/src/sentry/api/serializers/models/project.py
@@ -4,6 +4,7 @@ import six
 
 from collections import defaultdict
 from django.db.models import Q
+from django.db.models.aggregates import Count
 
 from sentry.api.serializers import register, serialize, Serializer
 from sentry.models import (
@@ -67,6 +68,15 @@ class ProjectSerializer(Serializer):
         for project_id, platform in platforms:
             platforms_by_project[project_id].append(platform)
 
+        num_issues_projects = Project.objects.filter(
+            id__in=project_ids
+        ).annotate(num_issues=Count('processingissue')) \
+            .values_list('id', 'num_issues')
+
+        processing_issues_by_project = {}
+        for project_id, num_issues in num_issues_projects:
+            processing_issues_by_project[project_id] = num_issues
+
         result = {}
         for item in item_list:
             result[item] = {
@@ -78,6 +88,7 @@ class ProjectSerializer(Serializer):
                 'default_environment': default_environments.get(item.id),
                 'reviewed-callsign': reviewed_callsigns.get(item.id),
                 'platforms': platforms_by_project[item.id],
+                'processing_issues': processing_issues_by_project.get(item.id, 0),
             }
         return result
 
@@ -108,6 +119,7 @@ class ProjectSerializer(Serializer):
             'features': feature_list,
             'status': status_label,
             'platforms': attrs['platforms'],
+            'processingIssues': attrs['processing_issues'],
         }
 
 
diff --git a/src/sentry/static/sentry/app/views/projectSettings/index.jsx b/src/sentry/static/sentry/app/views/projectSettings/index.jsx
index ea49ee1149..1227b5e857 100644
--- a/src/sentry/static/sentry/app/views/projectSettings/index.jsx
+++ b/src/sentry/static/sentry/app/views/projectSettings/index.jsx
@@ -78,6 +78,7 @@ const ProjectSettings = React.createClass({
     let rootInstallPath = `/${orgId}/${projectId}/settings/install/`;
     let isEarlyAdopter = this.context.organization.isEarlyAdopter;
     let path = this.props.location.pathname;
+    let processingIssues = this.state.project.processingIssues;
 
     return (
       <div className="row">
@@ -95,7 +96,12 @@ const ProjectSettings = React.createClass({
             <li><a href={`${settingsUrlRoot}/release-tracking/`}>{t('Release Tracking')}</a></li>
             <ListLink to={`/${orgId}/${projectId}/settings/saved-searches/`}>{t('Saved Searches')}</ListLink>
             <ListLink to={`/${orgId}/${projectId}/settings/debug-symbols/`}>{t('Debug Symbols')}</ListLink>
-            <ListLink to={`/${orgId}/${projectId}/settings/processing-issues/`}>{t('Processing Issues')}</ListLink>
+            <ListLink className="badged" to={`/${orgId}/${projectId}/settings/processing-issues/`}>
+              {t('Processing Issues')}
+              {processingIssues > 0 &&
+                <span className="badge new">{processingIssues > 99 ? '99+' : processingIssues}</span>
+              }
+            </ListLink>
           </ul>
           <h6 className="nav-header">{t('Data')}</h6>
           <ul className="nav nav-stacked">
diff --git a/src/sentry/static/sentry/app/views/stream.jsx b/src/sentry/static/sentry/app/views/stream.jsx
index 27cfb80188..a94cd77f81 100644
--- a/src/sentry/static/sentry/app/views/stream.jsx
+++ b/src/sentry/static/sentry/app/views/stream.jsx
@@ -520,13 +520,13 @@ const Stream = React.createClass({
     return (
       <div className="processing-issues">
         <strong>{t('Unprocessed Issues: ')}</strong>
-        {tct('there [issues].', {
+        {tct('there [issues]', {
           issues: issues
         })}
         {' '}
         <span className="last-seen">({t('last issue')}: <TimeSince date={pi.lastSeen}/>)</span>
         {' '}
-        <Link to={`/${orgId}/${projectId}/settings/processing-issues/`}>{t('show issues')}</Link>
+        <Link to={`/${orgId}/${projectId}/settings/processing-issues/`}>{t('show details')}</Link>
       </div>
     );
   },
diff --git a/src/sentry/static/sentry/less/shared-components.less b/src/sentry/static/sentry/less/shared-components.less
index 5f69293e31..1250802f8f 100644
--- a/src/sentry/static/sentry/less/shared-components.less
+++ b/src/sentry/static/sentry/less/shared-components.less
@@ -2505,6 +2505,10 @@ ul.faces {
 .nav-stacked li  {
   margin-bottom: 6px;
 
+  &.badged {
+    white-space: nowrap;
+  }
+
   > a {
     font-size: 16px;
     line-height: 1.5;
