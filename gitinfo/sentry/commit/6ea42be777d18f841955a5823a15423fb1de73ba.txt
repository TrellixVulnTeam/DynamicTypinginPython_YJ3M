commit 6ea42be777d18f841955a5823a15423fb1de73ba
Author: ted kaemming <ted@kaemming.com>
Date:   Mon May 8 17:10:13 2017 -0700

    Add `InMemoryTSDB.get_most_frequent_series`. (#5353)

diff --git a/src/sentry/tsdb/inmemory.py b/src/sentry/tsdb/inmemory.py
index 5937df71f4..5e55045a7a 100644
--- a/src/sentry/tsdb/inmemory.py
+++ b/src/sentry/tsdb/inmemory.py
@@ -192,6 +192,19 @@ class InMemoryTSDB(BaseTSDB):
 
         return results
 
+    def get_most_frequent_series(self, model, keys, start, end=None, rollup=None, limit=None):
+        rollup, series = self.get_optimal_rollup_series(start, end, rollup)
+
+        results = {}
+        for key in keys:
+            result = results[key] = []
+            source = self.frequencies[model][key]
+            for timestamp in series:
+                data = source[self.normalize_ts_to_rollup(timestamp, rollup)]
+                result.append((timestamp, dict(data.most_common(limit))))
+
+        return results
+
     def get_frequency_series(self, model, items, start, end=None, rollup=None):
         rollup, series = self.get_optimal_rollup_series(start, end, rollup)
 
