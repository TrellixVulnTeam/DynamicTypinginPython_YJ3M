commit b0494908f693f6d30ee63bd6e7fe4736b2923880
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Tue May 24 22:51:01 2016 +0200

    Record public ip for objc

diff --git a/src/sentry/coreapi.py b/src/sentry/coreapi.py
index 99c5ccddf3..f64f8b3c6c 100644
--- a/src/sentry/coreapi.py
+++ b/src/sentry/coreapi.py
@@ -602,6 +602,9 @@ class ClientApiHelper(object):
 
         return data
 
+    def wants_public_ip(self, data):
+        return data.get('platform') in ('javascript', 'cocoa', 'objc')
+
     def ensure_does_not_have_ip(self, data):
         if 'sentry.interfaces.Http' in data:
             if 'env' in data['sentry.interfaces.Http']:
diff --git a/src/sentry/web/api.py b/src/sentry/web/api.py
index f69d263d1a..648fbb9a6f 100644
--- a/src/sentry/web/api.py
+++ b/src/sentry/web/api.py
@@ -355,8 +355,9 @@ class StoreView(APIView):
         else:
             scrub_ip_address = project.get_option('sentry:scrub_ip_address', False)
 
-        # insert IP address if not available
-        if auth.is_public and not scrub_ip_address:
+        # insert IP address if not available and wanted
+        if (auth.is_public or helper.wants_public_ip(data)) \
+           and not scrub_ip_address:
             helper.ensure_has_ip(data, remote_addr)
 
         event_id = data['event_id']
