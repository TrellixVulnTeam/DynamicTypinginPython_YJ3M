commit 2caeb0ee4e5703cc6158b82162ea51f21127d990
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Fri Nov 13 21:48:57 2015 +0100

    Saner fix for ENHANCED functions. This leaves more for the hash

diff --git a/src/sentry/interfaces/stacktrace.py b/src/sentry/interfaces/stacktrace.py
index b9b12dc500..110d46c3ff 100644
--- a/src/sentry/interfaces/stacktrace.py
+++ b/src/sentry/interfaces/stacktrace.py
@@ -36,7 +36,7 @@ _filename_version_re = re.compile(r"""(?:
 # Java Spring specific anonymous classes.
 # see: http://mydailyjava.blogspot.co.at/2013/11/cglib-missing-manual.html
 _java_enhancer_re = re.compile(r'''
-\$\$[\w_]+?CGLIB\$\$[a-fA-F0-9]+
+(\$\$[\w_]+?CGLIB\$\$)[a-fA-F0-9]+
 ''', re.X)
 
 
@@ -124,7 +124,7 @@ def remove_filename_outliers(filename):
 
 def remove_module_outliers(module):
     """Remove things that augment the module but really should not."""
-    return _java_enhancer_re.sub('', module)
+    return _java_enhancer_re.sub(r'\1<auto>', module)
 
 
 def slim_frame_data(stacktrace,
diff --git a/tests/sentry/interfaces/test_stacktrace.py b/tests/sentry/interfaces/test_stacktrace.py
index 6ea3aa2814..a4fda25840 100644
--- a/tests/sentry/interfaces/test_stacktrace.py
+++ b/tests/sentry/interfaces/test_stacktrace.py
@@ -197,7 +197,8 @@ class StacktraceTest(TestCase):
         })
         result = interface.get_hash()
         self.assertEquals(result, [
-            'invalid.gruml.talkytalkyhub.common.config.JipJipConfig',
+            'invalid.gruml.talkytalkyhub.common.config.JipJipConfig'
+            '$$EnhancerBySpringCGLIB$$<auto>',
             'jipJipManagementApplication',
         ])
 
@@ -211,7 +212,9 @@ class StacktraceTest(TestCase):
         })
         result = interface.get_hash()
         self.assertEquals(result, [
-            'invalid.gruml.talkytalkyhub.common.config.JipJipConfig',
+            'invalid.gruml.talkytalkyhub.common.config.JipJipConfig'
+            '$$EnhancerBySpringCGLIB$$<auto>$$EnhancerBySpringCGLIB$$<auto>'
+            '$$FastClassBySpringCGLIB$$<auto>',
             'jipJipManagementApplication',
         ])
 
