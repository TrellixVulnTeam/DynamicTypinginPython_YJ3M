commit ff87912ad629279591c0d4453ed2834550a5fcac
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Sep 28 15:44:03 2015 -0700

    Dont allow user interfaces without identifier

diff --git a/src/sentry/interfaces/user.py b/src/sentry/interfaces/user.py
index a4f56f8d29..7188ef70f9 100644
--- a/src/sentry/interfaces/user.py
+++ b/src/sentry/interfaces/user.py
@@ -62,11 +62,18 @@ class User(Interface):
         if not isinstance(extra_data, dict):
             extra_data = {}
 
+        ident = trim(data.pop('id', None), 128)
+        email = trim(validate_email(data.pop('email', None), False), 128)
+        username = trim(data.pop('username', None), 128)
+        ip_address = validate_ip(data.pop('ip_address', None), False)
+
+        assert ident or email or username or ip_address
+
         kwargs = {
-            'id': trim(data.pop('id', None), 128),
-            'email': trim(validate_email(data.pop('email', None), False), 128),
-            'username': trim(data.pop('username', None), 128),
-            'ip_address': validate_ip(data.pop('ip_address', None), False),
+            'id': ident,
+            'email': email,
+            'username': username,
+            'ip_address': ip_address,
         }
 
         kwargs['data'] = trim_dict(extra_data)
