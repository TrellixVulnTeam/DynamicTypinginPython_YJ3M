commit 61447bee199ef6fc13b15b1f8374d0769ad58689
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 29 23:41:25 2014 -0800

    Move search bar into react components

diff --git a/src/sentry/static/sentry/app-react/components/stream.jsx b/src/sentry/static/sentry/app-react/components/stream.jsx
index da75233128..2ee442cf74 100644
--- a/src/sentry/static/sentry/app-react/components/stream.jsx
+++ b/src/sentry/static/sentry/app-react/components/stream.jsx
@@ -1,9 +1,121 @@
 /*** @jsx React.DOM */
 var React = require("react");
 
+var utils = require("../utils");
+
 var Count = require("./count");
 var TimeSince = require("./timeSince");
 
+var SearchDropdown = React.createClass({
+  componentDidMount: function(){
+    $('.filter-nav .search-input').focus(function(){
+      $('.search-dropdown').show();
+    }).blur(function(){
+      $('.search-dropdown').hide();
+    });
+  },
+
+  render: function() {
+    return (
+      <div className="search-dropdown" style={{display:"none"}}>
+        <ul className="search-helper search-autocomplete-list">
+          <li className="search-autocomplete-item">
+            <span className="icon icon-tag"></span>
+            <h4>Tag - <span className="search-description">key/value pair associated to an event</span></h4>
+            <p className="search-example">browser:"Chrome 34"</p>
+          </li>
+          <li className="search-autocomplete-item">
+            <span className="icon icon-toggle"></span>
+            <h4>Status - <span className="search-description">State of an event</span></h4>
+            <p className="search-example">is:resolved, unresolved, muted</p>
+          </li>
+          <li className="search-autocomplete-item">
+            <span className="icon icon-user"></span>
+            <h4>Assigned - <span className="search-description">team member assigned to an event</span></h4>
+            <p className="search-example">assigned:[me|user@example.com]</p>
+          </li>
+        </ul>
+      </div>
+    );
+  }
+});
+
+var SearchBar = React.createClass({
+  render: function() {
+    return (
+      <div className="search">
+        <form className="form-horizontal" action="." method="GET">
+          <div>
+            <input type="text" className="search-input form-control"
+                   placeholder="Search for events, users, tags, and everything else."
+                   name="query" />
+            <span className="icon-search"></span>
+          </div>
+          <SearchDropdown />
+        </form>
+      </div>
+    );
+  }
+});
+
+var FilterSelectLink = React.createClass({
+  render: function() {
+    var className = this.props.extraClass;
+    className += ' btn btn-default';
+
+    if (this.props.isActive) {
+      className += ' btn-active';
+    }
+
+    var queryString = '?' + this.props.query;
+
+    return (
+      <a href={queryString}
+          className={className}>{this.props.label}</a>
+    );
+  }
+});
+
+var FilterSelect = React.createClass({
+  render: function() {
+    var params = utils.getQueryParams();
+    var activeButton;
+    if (params.bookmarks) {
+      activeButton = 'bookmarks';
+    } else if (params.assigned) {
+      activeButton = 'assigned';
+    } else {
+      activeButton = 'all';
+    }
+
+    return (
+      <div className="filter-nav" ng-controller="ProjectStreamControlsCtrl">
+        <div className="row">
+          <div className="col-sm-4 primary-filters">
+            <div className="btn-group btn-group-justified">
+              <FilterSelectLink label="All Events"
+                                query=""
+                                isActive={activeButton === 'all'}
+                                extraClass="btn-all-events" />
+              <FilterSelectLink label="Bookmarks"
+                                query="bookmarks=1"
+                                isActive={activeButton === 'bookmarks'}
+                                extraClass="btn-middle btn-bookmarks" />
+              <FilterSelectLink label="Assigned"
+                                query="assigned=1"
+                                isActive={activeButton === 'assigned'}
+                                extraClass="btn-assigned" />
+            </div>
+          </div>
+          <div className="col-sm-8">
+            <SearchBar />
+          </div>
+        </div>
+      </div>
+    );
+  }
+});
+
 var Actions = React.createClass({
   render: function() {
     return (
@@ -14,10 +126,10 @@ var Actions = React.createClass({
           </div>
           <div className="btn-group">
             <a href="javascript:void(0)" className="btn btn-default btn-sm action action-resolve">
-                <i aria-hidden="true" className="icon-checkmark"></i>
+              <i aria-hidden="true" className="icon-checkmark"></i>
             </a>
             <a href="javascript:void(0)" className="btn btn-default btn-sm action action-bookmark">
-                <span className="icon icon-bookmark"></span>
+              <span className="icon icon-bookmark"></span>
             </a>
             <a className="btn btn-default btn-sm hidden-xs action action-more dropdown-toggle" data-toggle="dropdown">
               <span className="icon-ellipsis"></span>
@@ -165,6 +277,7 @@ var Stream = React.createClass({
   render: function() {
     return (
       <div>
+        <FilterSelect />
         <div className="group-header-container" data-spy="affix" data-offset-top="134">
           <div className="container">
             <div className="group-header">
diff --git a/src/sentry/static/sentry/app-react/utils.jsx b/src/sentry/static/sentry/app-react/utils.jsx
new file mode 100644
index 0000000000..58469882b1
--- /dev/null
+++ b/src/sentry/static/sentry/app-react/utils.jsx
@@ -0,0 +1,26 @@
+var getQueryParams = function() {
+  var vars = {},
+      href = window.location.href,
+      hashes, hash;
+
+  if (href.indexOf('?') == -1)
+    return vars;
+
+  hashes = href.slice(
+    href.indexOf('?') + 1,
+    (href.indexOf('#') != -1 ? href.indexOf('#') : href.length)
+  ).split('&');
+  for (var i = 0, chunk; (chunk = hashes[i]); i++) {
+    hash = chunk.split('=');
+    if (!hash[0] && !hash[1])
+      return;
+
+    vars[decodeURIComponent(hash[0])] = (hash[1] ? decodeURIComponent(hash[1]).replace(/\+/, ' ') : '');
+  };
+
+  return vars;
+};
+
+module.exports = {
+  getQueryParams: getQueryParams
+};
diff --git a/src/sentry/templates/sentry/bases/stream.html b/src/sentry/templates/sentry/bases/stream.html
index 1cd15da757..2cdb7a567a 100644
--- a/src/sentry/templates/sentry/bases/stream.html
+++ b/src/sentry/templates/sentry/bases/stream.html
@@ -25,48 +25,4 @@
             <broadcast></broadcast>
         </li>
     </ul>
-
-    <div class="filter-nav" ng-controller="ProjectStreamControlsCtrl">
-        <div class="row">
-            <div class="col-sm-4 primary-filters">
-              <div class="btn-group btn-group-justified">
-                <a href="?" class="btn btn-default btn-all-events">All Events</a>
-                <a href="?bookmarks=1" class="btn btn-default btn-middle btn-bookmarks">Bookmarks</a>
-                <a href="?assigned=1" class="btn btn-default btn-assigned">Assigned</a>
-              </div>
-            </div>
-            <div class="col-sm-8">
-              <div class="search">
-                  <form class="form-horizontal" action="." method="GET">
-                      <div>
-                          <input type="text" class="search-input form-control"
-                                 placeholder="Search for events, users, tags, and everything else."
-                                 name="query"
-                                 value="{% if query %}{{query}}{% endif %}">
-                          <span class="icon-search"></span>
-                      </div>
-                      <div class="search-dropdown" style="display:none">
-                        <ul class="search-helper search-autocomplete-list">
-                          <li class="search-autocomplete-item">
-                            <span class="icon icon-tag"></span>
-                            <h4>Tag - <span class="search-description">key/value pair associated to an event</span></h4>
-                            <p class="search-example">browser:"Chrome 34"</p>
-                          </li>
-                          <li class="search-autocomplete-item">
-                            <span class="icon icon-toggle"></span>
-                            <h4>Status - <span class="search-description">State of an event</span></h4>
-                            <p class="search-example">is:resolved, unresolved, muted</p>
-                          </li>
-                          <li class="search-autocomplete-item">
-                            <span class="icon icon-user"></span>
-                            <h4>Assigned - <span class="search-description">team member assigned to an event</span></h4>
-                            <p class="search-example">assigned:[me|user@example.com]</p>
-                          </li>
-                        </ul>
-                      </div>
-                  </form>
-              </div>
-            </div>
-        </div>
-    </div>
 {% endblock %}
