commit c845bd1596da77e9a8a727ece9e52ccd6ef1c1a8
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Jan 27 17:00:50 2013 -0800

    Validate culprit length

diff --git a/src/sentry/coreapi.py b/src/sentry/coreapi.py
index 15a54bf9d7..4ed964d472 100644
--- a/src/sentry/coreapi.py
+++ b/src/sentry/coreapi.py
@@ -30,6 +30,7 @@ from sentry.utils.queue import maybe_delay
 
 logger = logging.getLogger('sentry.errors.coreapi')
 
+MAX_CULPRIT_LENGTH = 200
 MAX_MESSAGE_LENGTH = 1000
 
 RESERVED_FIELDS = (
@@ -265,9 +266,13 @@ def validate_data(project, data, client=None):
     if not data.get('message'):
         data['message'] = '<no message value>'
     elif len(data['message']) > MAX_MESSAGE_LENGTH:
-        raise InvalidData('Value \'message\' is too long. At %d chars, max is %s.' % (
+        raise InvalidData('Value \'message\' is too long. Input is %d chars, max is %s.' % (
             len(data['message']), MAX_MESSAGE_LENGTH))
 
+    if data.get('culprit') and len(data['culprit']) > 200:
+        raise InvalidData('Value \'culprit\' is too long. Input is %d chars, max is %s.' % (
+            len(data['culprit']), MAX_CULPRIT_LENGTH))
+
     if not data.get('event_id'):
         data['event_id'] = uuid.uuid4().hex
     elif len(data['event_id']) > 32:
