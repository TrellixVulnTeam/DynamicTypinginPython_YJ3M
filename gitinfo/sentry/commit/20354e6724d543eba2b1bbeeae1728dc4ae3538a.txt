commit 20354e6724d543eba2b1bbeeae1728dc4ae3538a
Author: Dena Mwangi <dena@getsentry.com>
Date:   Mon Sep 10 10:25:40 2018 -0700

    feat(experiment): Sample event experiment (#9383)

diff --git a/src/sentry/static/sentry/app/stores/hookStore.jsx b/src/sentry/static/sentry/app/stores/hookStore.jsx
index 7418ffc64c..257aa13222 100644
--- a/src/sentry/static/sentry/app/stores/hookStore.jsx
+++ b/src/sentry/static/sentry/app/stores/hookStore.jsx
@@ -4,6 +4,7 @@ import _ from 'lodash';
 let validHookNames = new Set([
   'component:org-members-view',
   'component:org-auth-view',
+  'component:sample-event',
   'footer',
   'settings:organization-navigation',
   'settings:organization-navigation-config',
diff --git a/src/sentry/static/sentry/app/views/onboarding/configure/index.jsx b/src/sentry/static/sentry/app/views/onboarding/configure/index.jsx
index af4b833267..152d6eff22 100644
--- a/src/sentry/static/sentry/app/views/onboarding/configure/index.jsx
+++ b/src/sentry/static/sentry/app/views/onboarding/configure/index.jsx
@@ -4,15 +4,19 @@ import {browserHistory} from 'react-router';
 
 import sdk from 'app/utils/sdk';
 import analytics from 'app/utils/analytics';
-import Waiting from 'app/views/onboarding/configure/waiting';
 import ApiMixin from 'app/mixins/apiMixin';
+import HookStore from 'app/stores/hookStore';
 import ProjectContext from 'app/views/projects/projectContext';
 import ProjectDocsContext from 'app/views/projectInstall/docsContext';
 import ProjectInstallPlatform from 'app/views/projectInstall/platform';
-import HookStore from 'app/stores/hookStore';
+import SentryTypes from 'app/sentryTypes';
+import Waiting from 'app/views/onboarding/configure/waiting';
 
 const Configure = createReactClass({
   displayName: 'Configure',
+  contextTypes: {
+    organization: SentryTypes.Organization,
+  },
   mixins: [ApiMixin],
 
   getInitialState() {
@@ -28,7 +32,6 @@ const Configure = createReactClass({
     if (!platform || platform === 'other') {
       this.redirectToNeutralDocs();
     }
-
     this.fetchEventData();
     this.timer = setInterval(() => {
       this.fetchEventData();
@@ -118,7 +121,12 @@ const Configure = createReactClass({
               />
             </ProjectDocsContext>
           </ProjectContext>
-          <Waiting skip={this.submit} hasEvent={this.state.hasSentRealEvent} />
+          <Waiting
+            skip={this.submit}
+            hasEvent={this.state.hasSentRealEvent}
+            params={this.props.params}
+            organization={this.context.organization}
+          />
         </div>
       </div>
     );
diff --git a/src/sentry/static/sentry/app/views/onboarding/configure/waiting.jsx b/src/sentry/static/sentry/app/views/onboarding/configure/waiting.jsx
index c60a0a766a..b5da5b3a36 100644
--- a/src/sentry/static/sentry/app/views/onboarding/configure/waiting.jsx
+++ b/src/sentry/static/sentry/app/views/onboarding/configure/waiting.jsx
@@ -1,34 +1,79 @@
 import PropTypes from 'prop-types';
 import React from 'react';
 import {t} from 'app/locale';
+import styled from 'react-emotion';
+
+import Button from 'app/components/button';
+import HookStore from 'app/stores/hookStore';
+import SentryTypes from 'app/sentryTypes';
 
 class Waiting extends React.Component {
   static propTypes = {
     skip: PropTypes.func,
     hasEvent: PropTypes.bool.isRequired,
+    params: PropTypes.object,
+    organization: SentryTypes.Organization,
   };
 
+  constructor(...args) {
+    super(...args);
+    this.state = {
+      component: null,
+    };
+  }
+
+  componentDidMount() {
+    this.getHookComponent();
+  }
+
+  getHookComponent() {
+    let component =
+      HookStore.get('component:sample-event').length && !this.props.hasEvent
+        ? HookStore.get('component:sample-event')[0](
+            this.props.params,
+            this.props.organization
+          )
+        : undefined;
+
+    this.setState({component});
+  }
+
   render() {
     return (
       <div className="awaiting-event">
-        <div className="pull-right">
-          <div className="btn btn-primary" onClick={this.props.skip}>
-            {t('All done!')}
-          </div>
-        </div>
-        <div className="wrap waiting-text">
-          {!this.props.hasEvent ? (
-            <h3 className="animated-ellipsis">{t('Waiting to receive an error')}</h3>
-          ) : (
-            <h3>{t("You've successfully sent an error")}</h3>
-          )}
-          <div className="robot">
-            <span className="eye" />
+        <div className="row">
+          <div className="col-sm-10">
+            <div className="wrap waiting-text">
+              {!this.props.hasEvent ? (
+                <h3 className="animated-ellipsis">{t('Waiting to receive an error')}</h3>
+              ) : (
+                <h3>{t("You've successfully sent an error")}</h3>
+              )}
+              <div className="robot">
+                <span className="eye" />
+              </div>
+            </div>
           </div>
+          <CenteredButtons className="col-sm-2">
+            <div className="pull-right">
+              <Button
+                priority="primary"
+                data-test-id="configure-done"
+                onClick={this.props.skip}
+              >
+                {t('All done!')}
+              </Button>
+              {this.state.component}
+            </div>
+          </CenteredButtons>
         </div>
       </div>
     );
   }
 }
 
+const CenteredButtons = styled('div')`
+  text-align: center;
+`;
+
 export default Waiting;
diff --git a/tests/acceptance/test_onboarding.py b/tests/acceptance/test_onboarding.py
index 32d565da43..8f531e328f 100644
--- a/tests/acceptance/test_onboarding.py
+++ b/tests/acceptance/test_onboarding.py
@@ -43,7 +43,7 @@ class OrganizationOnboardingTest(AcceptanceTestCase):
         assert project.platform == 'javascript-angular'
 
         self.browser.snapshot(name='onboarding-configure-project')
-        self.browser.click('.btn-primary')
+        self.browser.click('[data-test-id="configure-done"]')
         self.browser.wait_until_not('.loading')
 
         assert self.browser.element_exists('.robot')
diff --git a/tests/js/spec/views/onboarding/configure/__snapshots__/index.spec.jsx.snap b/tests/js/spec/views/onboarding/configure/__snapshots__/index.spec.jsx.snap
index ddcb44ae88..7aac226a6e 100644
--- a/tests/js/spec/views/onboarding/configure/__snapshots__/index.spec.jsx.snap
+++ b/tests/js/spec/views/onboarding/configure/__snapshots__/index.spec.jsx.snap
@@ -43,6 +43,24 @@ exports[`Configure should render correctly render() should redirect to if no mat
     </withProjects(withRouter(ProjectContext))>
     <Waiting
       hasEvent={false}
+      organization={
+        Object {
+          "id": "1337",
+          "slug": "testOrg",
+          "teams": Array [
+            Array [
+              "project-slug",
+            ],
+          ],
+        }
+      }
+      params={
+        Object {
+          "orgId": "testOrg",
+          "platform": "other",
+          "projectId": "project-slug",
+        }
+      }
       skip={[Function]}
     />
   </div>
@@ -494,36 +512,156 @@ exports[`Configure should render correctly render() should render platform docs
       </withProjects(withRouter(ProjectContext))>
       <Waiting
         hasEvent={false}
+        organization={
+          Object {
+            "id": "1337",
+            "projects": Array [
+              Object {
+                "hasAccess": true,
+                "id": "testProject",
+                "isBookmarked": false,
+                "isMember": true,
+                "name": "Test Project",
+                "slug": "project-slug",
+                "teams": Array [
+                  Object {
+                    "hasAccess": true,
+                    "id": "coolteam",
+                    "slug": "coolteam",
+                  },
+                ],
+              },
+            ],
+            "slug": "testOrg",
+            "teams": Array [
+              Object {
+                "hasAccess": true,
+                "id": "coolteam",
+                "projects": Array [
+                  Object {
+                    "id": "testProject",
+                    "name": "Test Project",
+                    "slug": "project-slug",
+                  },
+                ],
+                "slug": "coolteam",
+              },
+            ],
+          }
+        }
+        params={
+          Object {
+            "orgId": "testOrg",
+            "platform": "node",
+            "projectId": "project-slug",
+          }
+        }
         skip={[Function]}
       >
         <div
           className="awaiting-event"
         >
           <div
-            className="pull-right"
+            className="row"
           >
             <div
-              className="btn btn-primary"
-              onClick={[Function]}
+              className="col-sm-10"
             >
-              All done!
+              <div
+                className="wrap waiting-text"
+              >
+                <h3
+                  className="animated-ellipsis"
+                >
+                  Waiting to receive an error
+                </h3>
+                <div
+                  className="robot"
+                >
+                  <span
+                    className="eye"
+                  />
+                </div>
+              </div>
             </div>
-          </div>
-          <div
-            className="wrap waiting-text"
-          >
-            <h3
-              className="animated-ellipsis"
-            >
-              Waiting to receive an error
-            </h3>
-            <div
-              className="robot"
+            <CenteredButtons
+              className="col-sm-2"
             >
-              <span
-                className="eye"
-              />
-            </div>
+              <div
+                className="col-sm-2 css-mm32tp-CenteredButtons e1p80ulz0"
+              >
+                <div
+                  className="pull-right"
+                >
+                  <Button
+                    alignLabel="left"
+                    data-test-id="configure-done"
+                    disabled={false}
+                    onClick={[Function]}
+                    priority="primary"
+                  >
+                    <StyledButton
+                      aria-label="All done!"
+                      data-test-id="configure-done"
+                      disabled={false}
+                      onClick={[Function]}
+                      priority="primary"
+                      role="button"
+                    >
+                      <Component
+                        aria-label="All done!"
+                        className="css-1msljz8-StyledButton-getColors eqrebog0"
+                        data-test-id="configure-done"
+                        disabled={false}
+                        onClick={[Function]}
+                        priority="primary"
+                        role="button"
+                      >
+                        <button
+                          aria-label="All done!"
+                          className="css-1msljz8-StyledButton-getColors eqrebog0"
+                          data-test-id="configure-done"
+                          disabled={false}
+                          onClick={[Function]}
+                          priority="primary"
+                          role="button"
+                        >
+                          <ButtonLabel
+                            justify="flex-start"
+                            priority="primary"
+                          >
+                            <Component
+                              className="css-1emshjx-ButtonLabel eqrebog1"
+                              justify="flex-start"
+                              priority="primary"
+                            >
+                              <Flex
+                                align="center"
+                                className="css-1emshjx-ButtonLabel eqrebog1"
+                                justify="flex-start"
+                              >
+                                <Base
+                                  align="center"
+                                  className="eqrebog1 css-11rqwwm-ButtonLabel"
+                                  justify="flex-start"
+                                >
+                                  <div
+                                    className="eqrebog1 css-11rqwwm-ButtonLabel"
+                                    is={null}
+                                  >
+                                    All done!
+                                  </div>
+                                </Base>
+                              </Flex>
+                            </Component>
+                          </ButtonLabel>
+                        </button>
+                      </Component>
+                    </StyledButton>
+                  </Button>
+                </div>
+              </div>
+            </CenteredButtons>
           </div>
         </div>
       </Waiting>
@@ -575,6 +713,24 @@ exports[`Configure should render correctly render() shouldn't redirect for a fou
     </withProjects(withRouter(ProjectContext))>
     <Waiting
       hasEvent={false}
+      organization={
+        Object {
+          "id": "1337",
+          "slug": "testOrg",
+          "teams": Array [
+            Array [
+              "project-slug",
+            ],
+          ],
+        }
+      }
+      params={
+        Object {
+          "orgId": "testOrg",
+          "platform": "node",
+          "projectId": "project-slug",
+        }
+      }
       skip={[Function]}
     />
   </div>
