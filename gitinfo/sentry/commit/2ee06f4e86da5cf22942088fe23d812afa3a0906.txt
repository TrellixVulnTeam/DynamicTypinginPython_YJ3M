commit 2ee06f4e86da5cf22942088fe23d812afa3a0906
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jun 26 16:15:17 2013 -0700

    Add values_seen to tag list

diff --git a/src/sentry/templates/sentry/explore/tag_list.html b/src/sentry/templates/sentry/explore/tag_list.html
index def48fb7f8..8888a6408e 100644
--- a/src/sentry/templates/sentry/explore/tag_list.html
+++ b/src/sentry/templates/sentry/explore/tag_list.html
@@ -7,7 +7,7 @@
 {% block inner %}
     {% if tag_list %}
 
-        {% for tag_name, tag_values in tag_list %}
+        {% for tag_key, tag_values in tag_list %}
             {% if not forloop.counter|divisibleby:2 %}
                 {% if not forloop.first %}
                     </div>
@@ -16,15 +16,15 @@
             {% endif %}
             <div class="span6">
                 <div class="page-header">
-                    <span class="pull-right"><a href="{% url 'sentry-explore-tag' project.team.slug project.slug tag_name|urlquote %}">More Details</a></span>
+                    <span class="pull-right"><a href="{% url 'sentry-explore-tag' project.team.slug project.slug tag_key.key|urlquote %}">More Details</a></span>
 
-                    <h4>{{ tag_name|titlize }}</h4>
+                    <h4>{{ tag_key.get_label }} <small>({{ tag_key.values_seen|small_count }})</small></h4>
                 </div>
 
                 <ul class="tag-list">
                     {% for value_id, tag_value, times_seen in tag_values %}
                         <li>
-                            <a href="{% url 'sentry-explore-tag-value' project.team.slug project.slug tag_name|urlquote value_id %}">
+                            <a href="{% url 'sentry-explore-tag-value' project.team.slug project.slug tag_key.key|urlquote value_id %}">
                                 {{ tag_value }}
                                 <span>{{ times_seen|small_count }}</span>
                             </a>
diff --git a/src/sentry/web/frontend/explore.py b/src/sentry/web/frontend/explore.py
index f6e7f936de..6633c9ac55 100644
--- a/src/sentry/web/frontend/explore.py
+++ b/src/sentry/web/frontend/explore.py
@@ -23,21 +23,21 @@ SORT_OPTIONS = {
 
 @has_access
 def tag_list(request, team, project):
-    tag_name_qs = sorted(TagKey.objects.filter(
+    tag_key_qs = sorted(TagKey.objects.filter(
         project=project
-    ).values_list('key', flat=True))
+    ), key=lambda x: x.get_label())
 
     tag_value_qs = TagValue.objects.filter(
         project=project).order_by('-times_seen')
 
     # O(N) db access
     tag_list = []
-    for tag_name in tag_name_qs:
-        tag_list.append((tag_name, [
+    for tag_key in tag_key_qs:
+        tag_list.append((tag_key, [
             (id, value, times_seen)
             for (id, value, times_seen)
             in tag_value_qs.filter(
-                key=tag_name).values_list('id', 'value', 'times_seen')[:5]
+                key=tag_key.key).values_list('id', 'value', 'times_seen')[:5]
         ]))
 
     return render_to_response('sentry/explore/tag_list.html', {
