commit 9eb88adfa3544c4b43d63e5888bf3bd10e56191b
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jan 9 16:52:45 2012 -0800

    Dont allow deletion of default project (SENTRY_PROJECT)

diff --git a/sentry/templates/sentry/projects/manage.html b/sentry/templates/sentry/projects/manage.html
index da060dcbb9..33f38f1d76 100644
--- a/sentry/templates/sentry/projects/manage.html
+++ b/sentry/templates/sentry/projects/manage.html
@@ -49,7 +49,11 @@
         </fieldset>
         <p class="actions">
             <button type="submit" class="btn primary">{% trans "Save Changes" %}</button>
-            <a href="{% url sentry-remove-project project.pk %}" class="btn danger">{% trans "Remove Project" %}</a>
+            {% if PROJECT_ID != project.pk %}
+                <a href="{% url sentry-remove-project project.pk %}" class="btn danger">{% trans "Remove Project" %}</a>
+            {% else %}
+                <a href="#" class="btn disabled danger">{% trans "Cannot remove default project" %}</a>
+            {% endif %}
         </p>
     </form>
     <div class="page-header">
diff --git a/sentry/web/frontend/projects.py b/sentry/web/frontend/projects.py
index 2112b60a03..cb82d1680c 100644
--- a/sentry/web/frontend/projects.py
+++ b/sentry/web/frontend/projects.py
@@ -48,6 +48,9 @@ def new_project(request):
 @has_access(MEMBER_OWNER)
 @csrf_protect
 def remove_project(request, project):
+    if str(project.id) == str(settings.PROJECT):
+        return HttpResponseRedirect(reverse('sentry-project-list'))
+
     project_list = filter(lambda x: x != project, get_project_list(request.user).itervalues())
 
     form = RemoveProjectForm(project_list, request.POST or None)
diff --git a/sentry/web/helpers.py b/sentry/web/helpers.py
index 4470c54a5c..6b69af6055 100644
--- a/sentry/web/helpers.py
+++ b/sentry/web/helpers.py
@@ -83,7 +83,7 @@ def render_to_string(template, context=None, request=None):
     context.update({
         'has_search': False,
         'MESSAGES_PER_PAGE': settings.MESSAGES_PER_PAGE,
-        'PROJECT_ID': settings.PROJECT,
+        'PROJECT_ID': int(settings.PROJECT),
         'VIEWS': list(View.objects.all()),
         'URL_PREFIX': settings.URL_PREFIX,
     })
