commit a672525f708f9c0226a7d873950a1662b53a7ec4
Author: Mikhail Denisenko <denisenk@ncbi.nlm.nih.gov>
Date:   Thu Mar 7 14:49:29 2013 -0500

    support for mssql server

diff --git a/src/sentry/constants.py b/src/sentry/constants.py
index 48cc97f165..7e80bd2feb 100644
--- a/src/sentry/constants.py
+++ b/src/sentry/constants.py
@@ -57,6 +57,12 @@ ORACLE_SORT_CLAUSES.update({
 })
 ORACLE_SCORE_CLAUSES = ORACLE_SORT_CLAUSES.copy()
 
+MSSQL_SORT_CLAUSES = SCORE_CLAUSES.copy()
+MSSQL_SORT_CLAUSES.update({
+    'date': "DATEDIFF(s, '1970-01-01T00:00:00', sentry_groupedmessage.last_seen)",
+    'new': "DATEDIFF(s, '1970-01-01T00:00:00', sentry_groupedmessage.first_seen)",
+})
+MSSQL_SCORE_CLAUSES = MSSQL_SORT_CLAUSES.copy()
 
 SEARCH_SORT_OPTIONS = SortedDict((
     ('score', _('Score')),
diff --git a/src/sentry/web/frontend/groups.py b/src/sentry/web/frontend/groups.py
index f81072e2f0..7f06e2e0dc 100644
--- a/src/sentry/web/frontend/groups.py
+++ b/src/sentry/web/frontend/groups.py
@@ -25,7 +25,8 @@ from sentry.conf import settings
 from sentry.constants import (SORT_OPTIONS, SEARCH_SORT_OPTIONS,
     SORT_CLAUSES, MYSQL_SORT_CLAUSES, SQLITE_SORT_CLAUSES, MEMBER_USER,
     SCORE_CLAUSES, MYSQL_SCORE_CLAUSES, SQLITE_SCORE_CLAUSES,
-    ORACLE_SORT_CLAUSES, ORACLE_SCORE_CLAUSES)
+    ORACLE_SORT_CLAUSES, ORACLE_SCORE_CLAUSES,
+    MSSQL_SORT_CLAUSES, MSSQL_SCORE_CLAUSES)
 from sentry.filters import get_filters
 from sentry.models import Project, Group, Event, SearchDocument, Activity
 from sentry.permissions import can_admin_group, can_create_projects
@@ -112,6 +113,9 @@ def _get_group_list(request, project):
     elif engine.startswith('oracle'):
         score_clause = ORACLE_SORT_CLAUSES.get(sort)
         filter_clause = ORACLE_SCORE_CLAUSES.get(sort)
+    elif engine in ('django_pytds', 'sqlserver_ado', 'sql_server.pyodbc'):
+        score_clause = MSSQL_SORT_CLAUSES.get(sort)
+        filter_clause = MSSQL_SCORE_CLAUSES.get(sort)
     else:
         score_clause = SORT_CLAUSES.get(sort)
         filter_clause = SCORE_CLAUSES.get(sort)
