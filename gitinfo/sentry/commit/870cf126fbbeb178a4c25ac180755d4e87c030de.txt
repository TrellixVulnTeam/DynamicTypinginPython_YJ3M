commit 870cf126fbbeb178a4c25ac180755d4e87c030de
Author: Mark Story <mark@sentry.io>
Date:   Tue Aug 27 15:07:31 2019 -0400

    feat(discover2) Show interface tabs for transaction events (#14516)
    
    Interface tabs were removed to allow the user to focus on just the
    transaction, but now they are back! As feedback was that the http and
    request context tabs have lots of useful stuff in them that we want
    exposed on transaction events.
    
    Refs SEN-974

diff --git a/src/sentry/api/serializers/models/event.py b/src/sentry/api/serializers/models/event.py
index dfcd09fc41..fdb9ef3a0c 100644
--- a/src/sentry/api/serializers/models/event.py
+++ b/src/sentry/api/serializers/models/event.py
@@ -46,7 +46,8 @@ class EventSerializer(Serializer):
 
             data = interface.get_api_context(is_public=is_public, platform=platform)
             # data might not be returned for e.g. a public HTTP repr
-            if not data:
+            # However, spans can be an empty list and should still be included.
+            if not data and interface.path != "spans":
                 continue
 
             entry = {"data": data, "type": interface.external_type}
diff --git a/src/sentry/static/sentry/app/components/events/eventEntries.jsx b/src/sentry/static/sentry/app/components/events/eventEntries.jsx
index d13dbccc17..8dc649f045 100644
--- a/src/sentry/static/sentry/app/components/events/eventEntries.jsx
+++ b/src/sentry/static/sentry/app/components/events/eventEntries.jsx
@@ -29,6 +29,7 @@ import Hook from 'app/components/hook';
 import MessageInterface from 'app/components/events/interfaces/message';
 import RequestInterface from 'app/components/events/interfaces/request';
 import SentryTypes from 'app/sentryTypes';
+import SpansInterface from 'app/components/events/interfaces/spans';
 import StacktraceInterface from 'app/components/events/interfaces/stacktrace';
 import TemplateInterface from 'app/components/events/interfaces/template';
 import ThreadsInterface from 'app/components/events/interfaces/threads';
@@ -48,6 +49,7 @@ export const INTERFACES = {
   breadcrumbs: BreadcrumbsInterface,
   threads: ThreadsInterface,
   debugmeta: DebugMetaInterface,
+  spans: SpansInterface,
 };
 
 class EventEntries extends React.Component {
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/cursorGuideHandler.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/cursorGuideHandler.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/cursorGuideHandler.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/cursorGuideHandler.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/dividerHandlerManager.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/dividerHandlerManager.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/dividerHandlerManager.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/dividerHandlerManager.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/dragManager.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/dragManager.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/dragManager.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/dragManager.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/index.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/index.tsx
similarity index 88%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/index.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/index.tsx
index 71a531abe3..aae1bf9232 100644
--- a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/index.tsx
+++ b/src/sentry/static/sentry/app/components/events/interfaces/spans/index.tsx
@@ -12,7 +12,7 @@ type PropType = {
   event: SentryTransactionEvent;
 };
 
-class TransanctionView extends React.Component<PropType> {
+class SpansInterface extends React.Component<PropType> {
   static propTypes = {
     event: SentryTypes.Event.isRequired,
   };
@@ -32,4 +32,4 @@ class TransanctionView extends React.Component<PropType> {
   }
 }
 
-export default TransanctionView;
+export default SpansInterface;
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/minimap.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/minimap.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/minimap.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/minimap.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/spanBar.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/spanBar.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/spanBar.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/spanBar.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/spanDetail.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/spanDetail.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/spanDetail.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/spanDetail.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/spanGroup.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/spanGroup.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/spanGroup.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/spanGroup.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/spanTree.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/spanTree.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/spanTree.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/spanTree.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/styles.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/styles.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/styles.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/styles.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/traceView.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/traceView.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/traceView.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/traceView.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/types.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/types.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/types.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/types.tsx
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/utils.tsx b/src/sentry/static/sentry/app/components/events/interfaces/spans/utils.tsx
similarity index 100%
rename from src/sentry/static/sentry/app/views/organizationEventsV2/transactionView/utils.tsx
rename to src/sentry/static/sentry/app/components/events/interfaces/spans/utils.tsx
diff --git a/src/sentry/static/sentry/app/types/index.tsx b/src/sentry/static/sentry/app/types/index.tsx
index d69c678351..220d12238d 100644
--- a/src/sentry/static/sentry/app/types/index.tsx
+++ b/src/sentry/static/sentry/app/types/index.tsx
@@ -1,4 +1,4 @@
-import {SpanEntry} from 'app/views/organizationEventsV2/transactionView/types';
+import {SpanEntry} from 'app/components/events/interfaces/spans/types';
 
 export type Organization = {
   id: string;
diff --git a/src/sentry/static/sentry/app/views/organizationEventsV2/eventModalContent.tsx b/src/sentry/static/sentry/app/views/organizationEventsV2/eventModalContent.tsx
index eee8eb7e84..c5635e784d 100644
--- a/src/sentry/static/sentry/app/views/organizationEventsV2/eventModalContent.tsx
+++ b/src/sentry/static/sentry/app/views/organizationEventsV2/eventModalContent.tsx
@@ -19,9 +19,7 @@ import ModalPagination from './modalPagination';
 import ModalLineGraph from './modalLineGraph';
 import RelatedEvents from './relatedEvents';
 import TagsTable from './tagsTable';
-import TransanctionView from './transactionView';
 import {hasAggregateField} from './utils';
-import {SentryTransactionEvent} from './transactionView/types';
 
 type EventModalContentProps = {
   event: Event;
@@ -63,11 +61,7 @@ const EventModalContent = (props: EventModalContentProps) => {
           })}
       </HeaderBox>
       <ContentColumn>
-        {event.type === 'transaction' ? (
-          <TransanctionView event={event as SentryTransactionEvent} />
-        ) : (
-          <EventInterfaces event={event} projectId={projectId} />
-        )}
+        <EventInterfaces event={event} projectId={projectId} />
       </ContentColumn>
       <SidebarColumn>
         {event.groupID && (
diff --git a/tests/sentry/api/serializers/test_event.py b/tests/sentry/api/serializers/test_event.py
index 1cfeade9d0..d70795a990 100644
--- a/tests/sentry/api/serializers/test_event.py
+++ b/tests/sentry/api/serializers/test_event.py
@@ -173,6 +173,13 @@ class EventSerializerTest(TestCase):
         assert "crashFile" not in result
         assert "fingerprints" not in result
 
+    def test_transaction_event_empty_spans(self):
+        event_data = load_data("transaction")
+        event_data["spans"] = []
+        event = self.store_event(data=event_data, project_id=self.project.id)
+        result = serialize(event)
+        assert result["entries"][0]["type"] == "spans"
+
 
 class SharedEventSerializerTest(TestCase):
     def test_simple(self):
