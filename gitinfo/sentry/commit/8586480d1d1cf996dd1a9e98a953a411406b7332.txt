commit 8586480d1d1cf996dd1a9e98a953a411406b7332
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Thu Mar 24 18:25:58 2016 -0700

    Make sure we pass along proper cwd to all subprocesses

diff --git a/src/sentry/runner/commands/devserver.py b/src/sentry/runner/commands/devserver.py
index f489ecdeb1..d6c257a9c5 100644
--- a/src/sentry/runner/commands/devserver.py
+++ b/src/sentry/runner/commands/devserver.py
@@ -27,6 +27,7 @@ def devserver(ctx, reload, watchers, workers, bind):
         host = bind
         port = None
 
+    import os
     from django.conf import settings
     from sentry.services.http import SentryHTTPServer
 
@@ -53,6 +54,8 @@ def devserver(ctx, reload, watchers, workers, bind):
             ['sentry', 'celery', 'beat', '-l', 'INFO'],
         ]
 
+    cwd = os.path.realpath(os.path.join(settings.PROJECT_ROOT, os.pardir, os.pardir))
+
     daemon_list = []
     server = None
     try:
@@ -63,7 +66,7 @@ def devserver(ctx, reload, watchers, workers, bind):
             for daemon in daemons:
                 click.secho('*** Running: {0}'.format(' '.join([os.path.basename(daemon[0])] + daemon[1:])), bold=True)
                 try:
-                    daemon_list.append(Popen(daemon, env=env))
+                    daemon_list.append(Popen(daemon, cwd=cwd, env=env))
                 except OSError:
                     raise click.ClickException('{0} not found.'.format(daemon[0]))
 
@@ -72,7 +75,7 @@ def devserver(ctx, reload, watchers, workers, bind):
             host=host,
             port=port,
             workers=1,
-        ).run_subprocess()
+        ).run_subprocess(cwd=cwd)
         server.wait()
     finally:
         if server and server.poll() is None:
diff --git a/src/sentry/services/http.py b/src/sentry/services/http.py
index 355bf377a2..a3a10c11ed 100644
--- a/src/sentry/services/http.py
+++ b/src/sentry/services/http.py
@@ -138,9 +138,7 @@ class SentryHTTPServer(Service):
         self.prepare_environment()
         os.execvp('uwsgi', ('uwsgi',))
 
-    def run_subprocess(self):
+    def run_subprocess(self, cwd=None):
         from subprocess import Popen
-        from django.conf import settings
         self.prepare_environment()
-        cwd = os.path.realpath(os.path.join(settings.PROJECT_ROOT, os.pardir, os.pardir))
         return Popen(['uwsgi'], cwd=cwd, env=os.environ.copy())
