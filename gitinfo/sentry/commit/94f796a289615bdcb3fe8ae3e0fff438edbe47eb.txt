commit 94f796a289615bdcb3fe8ae3e0fff438edbe47eb
Author: Stephen Cefali <scefali@sentry.io>
Date:   Mon Nov 18 16:51:08 2019 -0800

    add option to raise error if pluin fails to load (#15653)

diff --git a/conftest.py b/conftest.py
index 696605e10f..7dd79cecaf 100644
--- a/conftest.py
+++ b/conftest.py
@@ -36,7 +36,7 @@ def install_sentry_plugins():
 
     from sentry.runner.initializer import register_plugins
 
-    register_plugins(settings, test_plugins=True)
+    register_plugins(settings, test_plugins=True, raise_on_plugin_load_failure=True)
 
     settings.ASANA_CLIENT_ID = "abc"
     settings.ASANA_CLIENT_SECRET = "123"
diff --git a/src/sentry/runner/initializer.py b/src/sentry/runner/initializer.py
index ef9131fb72..b19c6bb4f8 100644
--- a/src/sentry/runner/initializer.py
+++ b/src/sentry/runner/initializer.py
@@ -11,7 +11,7 @@ from sentry.utils.sdk import configure_sdk
 from sentry.utils.warnings import DeprecatedSettingWarning
 
 
-def register_plugins(settings, test_plugins=False):
+def register_plugins(settings, test_plugins=False, raise_on_plugin_load_failure=False):
     from pkg_resources import iter_entry_points
     from sentry.plugins.base import plugins
 
@@ -35,6 +35,8 @@ def register_plugins(settings, test_plugins=False):
                 click.echo(
                     "Failed to load plugin %r:\n%s" % (ep.name, traceback.format_exc()), err=True
                 )
+                if raise_on_plugin_load_failure:
+                    raise
             else:
                 plugins.register(plugin)
 
