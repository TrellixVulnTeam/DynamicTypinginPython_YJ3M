commit df658cad732a2bb402719bb4572f6d91e3556ab8
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Feb 3 23:54:32 2012 -0800

    Ensure we force token values to strings (fixes GH-335)

diff --git a/sentry/manager.py b/sentry/manager.py
index 663e5e3aed..e22f6e1d98 100644
--- a/sentry/manager.py
+++ b/sentry/manager.py
@@ -16,6 +16,7 @@ import warnings
 
 from django.db import models, transaction
 from django.db.models import Sum, F
+from django.utils.encoding import force_unicode
 
 from sentry.conf import settings
 from sentry.exceptions import InvalidInterface, InvalidData
@@ -695,7 +696,7 @@ class SearchDocumentManager(models.Manager):
             field = field.lower()
             if field == 'text':
                 # we only tokenize the base text field
-                values = itertools.chain(*[self._tokenize(v) for v in values])
+                values = itertools.chain(*[self._tokenize(force_unicode(v)) for v in values])
             for value in values:
                 if not value:
                     continue
