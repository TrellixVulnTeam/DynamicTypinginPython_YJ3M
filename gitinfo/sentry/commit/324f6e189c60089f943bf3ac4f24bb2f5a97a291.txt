commit 324f6e189c60089f943bf3ac4f24bb2f5a97a291
Author: Mark Story <mark@sentry.io>
Date:   Tue Mar 31 14:18:38 2020 -0400

    ref(ui) Use ButtonBar in more places (#17972)
    
    Replace the `btn-group` LESS class in more places while also replacing
    `btn` with Button component, and LESS icons with SVG icons at the same time.
    
    Use the old LESS icons for now as the new SVG component is having
    rendering issues in percy.

diff --git a/src/sentry/static/sentry/app/components/pagination.tsx b/src/sentry/static/sentry/app/components/pagination.tsx
index e844a20ee6..1c508b2e35 100644
--- a/src/sentry/static/sentry/app/components/pagination.tsx
+++ b/src/sentry/static/sentry/app/components/pagination.tsx
@@ -5,6 +5,8 @@ import styled from '@emotion/styled';
 import {Query} from 'history';
 
 import {t} from 'app/locale';
+import Button from 'app/components/button';
+import ButtonBar from 'app/components/buttonBar';
 import parseLinkHeader from 'app/utils/parseLinkHeader';
 import {callIfFunction} from 'app/utils/callIfFunction';
 
@@ -48,39 +50,34 @@ class Pagination extends React.Component<Props> {
     const location = this.context.location;
     const path = this.props.to || location.pathname;
     const query = location.query;
-
     const links = parseLinkHeader(pageLinks);
-
-    let previousPageClassName = 'btn btn-default btn-lg prev';
-    if (links.previous.results === false) {
-      previousPageClassName += ' disabled';
-    }
-
-    let nextPageClassName = 'btn btn-default btn-lg next';
-    if (links.next.results === false) {
-      nextPageClassName += ' disabled';
-    }
+    const previousDisabled = links.previous.results === false;
+    const nextDisabled = links.next.results === false;
 
     return (
       <div className={className}>
-        <div className="btn-group">
-          <a
+        <ButtonBar merged>
+          <Button
+            aria-label={t('Previous')}
+            size="large"
+            disabled={previousDisabled}
             onClick={() => {
               callIfFunction(onCursor, links.previous.cursor, path, query, -1);
             }}
-            className={previousPageClassName}
           >
-            <span title={t('Previous')} className="icon-arrow-left" />
-          </a>
-          <a
+            <IconSpan className="icon-arrow-left" disabled={previousDisabled} />
+          </Button>
+          <Button
+            aria-label={t('Next')}
+            size="large"
+            disabled={nextDisabled}
             onClick={() => {
               callIfFunction(onCursor, links.next.cursor, path, query, 1);
             }}
-            className={nextPageClassName}
           >
-            <span title={t('Next')} className="icon-arrow-right" />
-          </a>
-        </div>
+            <IconSpan className="icon-arrow-right" disabled={nextDisabled} />
+          </Button>
+        </ButtonBar>
       </div>
     );
   }
@@ -97,3 +94,9 @@ export default styled(Pagination)`
     font-size: 20px !important;
   }
 `;
+
+// TODO this component and the icons should be replaced with IconChevron but
+// that icon has rendering issues on percy.
+const IconSpan = styled('span')<{disabled: boolean}>`
+  color: ${p => (p.disabled ? p.theme.disabled : p.theme.foreground)};
+`;
diff --git a/src/sentry/static/sentry/app/views/eventsV2/eventDetails/pagination.tsx b/src/sentry/static/sentry/app/views/eventsV2/eventDetails/pagination.tsx
index 5f7a1b7a8e..2d5085f352 100644
--- a/src/sentry/static/sentry/app/views/eventsV2/eventDetails/pagination.tsx
+++ b/src/sentry/static/sentry/app/views/eventsV2/eventDetails/pagination.tsx
@@ -1,10 +1,10 @@
 import React from 'react';
 import styled from '@emotion/styled';
-import isPropValid from '@emotion/is-prop-valid';
 
+import Button from 'app/components/button';
+import ButtonBar from 'app/components/buttonBar';
+import {IconPrevious, IconNext} from 'app/icons';
 import {t} from 'app/locale';
-import Link from 'app/components/links/link';
-import InlineSvg from 'app/components/inlineSvg';
 import space from 'app/styles/space';
 import {Event, Organization} from 'app/types';
 import EventView from 'app/utils/discover/eventView';
@@ -62,74 +62,40 @@ const Pagination = (props: Props) => {
   const links = buildTargets(event, eventView, organization);
 
   return (
-    <Paginator>
-      <StyledIconLink
+    <Paginator merged>
+      <Button
+        size="small"
         to={links.oldest || ''}
         disabled={links.previous === null || links.oldest === null}
-      >
-        <InlineSvg src="icon-prev" />
-      </StyledIconLink>
-      <StyledTextLink
+        icon={<IconPrevious size="xs" />}
+      />
+      <Button
+        size="small"
         data-test-id="older-event"
         to={links.previous}
         disabled={links.previous === null}
       >
         {t('Older')}
-      </StyledTextLink>
-      <StyledTextLink
+      </Button>
+      <Button
+        size="small"
         data-test-id="newer-event"
         to={links.next}
         disabled={links.next === null}
       >
         {t('Newer')}
-      </StyledTextLink>
-      <StyledIconLink
+      </Button>
+      <Button
+        size="small"
         to={links.latest || ''}
         disabled={links.next === null || links.latest === null}
-        isLast
-      >
-        <InlineSvg src="icon-next" />
-      </StyledIconLink>
+        icon={<IconNext size="xs" />}
+      />
     </Paginator>
   );
 };
 
-const StyledTextLink = styled(Link, {shouldForwardProp: isPropValid})<{
-  disabled?: boolean;
-  isLast?: boolean;
-}>`
-  color: ${p => (p.disabled ? p.theme.disabled : 'inherit')};
-  font-size: ${p => p.theme.fontSizeSmall};
-  font-weight: 600;
-  padding: ${space(0.25)};
-  display: flex;
-  align-items: center;
-  justify-content: center;
-  flex-grow: 2;
-  ${p => (p.isLast ? '' : `border-right: 1px solid ${p.theme.borderDark};`)}
-  ${p => (p.disabled ? 'pointer-events: none;' : '')}
-
-  &:hover,
-  &:active {
-    color: inherit;
-  }
-
-  &:active {
-    box-shadow: inset 0 2px rgba(0, 0, 0, 0.05);
-  }
-`;
-
-const StyledIconLink = styled(StyledTextLink, {shouldForwardProp: isPropValid})`
-  flex-grow: 1;
-`;
-
-const Paginator = styled('div')`
-  display: flex;
-  flex-grow: 1;
-  background: ${p => p.theme.white};
-  border: 1px solid ${p => p.theme.borderDark};
-  border-radius: ${p => p.theme.borderRadius};
-  box-shadow: 0 2px rgba(0, 0, 0, 0.05);
+const Paginator = styled(ButtonBar)`
   margin-top: ${space(2)};
 
   @media (min-width: ${p => p.theme.breakpoints[1]}) {
diff --git a/src/sentry/static/sentry/app/views/monitors/monitorHeaderActions.jsx b/src/sentry/static/sentry/app/views/monitors/monitorHeaderActions.jsx
index 35da78d6ad..f0a341a4c3 100644
--- a/src/sentry/static/sentry/app/views/monitors/monitorHeaderActions.jsx
+++ b/src/sentry/static/sentry/app/views/monitors/monitorHeaderActions.jsx
@@ -1,6 +1,7 @@
 import {browserHistory} from 'react-router';
 import PropTypes from 'prop-types';
 import React from 'react';
+import styled from '@emotion/styled';
 
 import {
   addErrorMessage,
@@ -9,11 +10,13 @@ import {
 } from 'app/actionCreators/indicator';
 import {logException} from 'app/utils/logging';
 import {t} from 'app/locale';
+import ButtonBar from 'app/components/buttonBar';
 import Button from 'app/components/button';
 import Confirm from 'app/components/confirm';
-import {IconEdit} from 'app/icons/iconEdit';
+import {IconDelete, IconEdit} from 'app/icons';
 import SentryTypes from 'app/sentryTypes';
 import withApi from 'app/utils/withApi';
+import space from 'app/styles/space';
 
 class MonitorHeaderActions extends React.Component {
   static propTypes = {
@@ -68,37 +71,39 @@ class MonitorHeaderActions extends React.Component {
   render() {
     const {monitor, orgId} = this.props;
     return (
-      <div className="m-b-1">
-        <div className="btn-group">
+      <ButtonContainer>
+        <ButtonBar gap={1}>
           <Button
             size="small"
+            icon={<IconEdit size="xs" />}
             to={`/organizations/${orgId}/monitors/${monitor.id}/edit/`}
           >
-            <IconEdit size="xs" />
             &nbsp;
             {t('Edit')}
           </Button>
-        </div>
-        <div className="btn-group" style={{marginLeft: 10}}>
           <Button size="small" onClick={this.toggleStatus}>
             {monitor.status !== 'disabled' ? t('Pause') : t('Enable')}
           </Button>
-        </div>
-        <div className="btn-group" style={{marginLeft: 10}}>
           <Confirm
             onConfirm={this.handleDelete}
             message={t(
               'Deleting this monitor is permanent. Are you sure you wish to continue?'
             )}
           >
-            <Button size="small" icon="icon-trash">
+            <Button size="small" icon={<IconDelete size="xs" />}>
               {t('Delete')}
             </Button>
           </Confirm>
-        </div>
-      </div>
+        </ButtonBar>
+      </ButtonContainer>
     );
   }
 }
 
+const ButtonContainer = styled('div')`
+  margin-bottom: ${space(3)};
+  display: flex;
+  flex-shrink: 1;
+`;
+
 export default withApi(MonitorHeaderActions);
diff --git a/src/sentry/static/sentry/app/views/organizationGroupDetails/eventToolbar.jsx b/src/sentry/static/sentry/app/views/organizationGroupDetails/eventToolbar.jsx
index 1a0f1a6168..d9f05744a3 100644
--- a/src/sentry/static/sentry/app/views/organizationGroupDetails/eventToolbar.jsx
+++ b/src/sentry/static/sentry/app/views/organizationGroupDetails/eventToolbar.jsx
@@ -5,6 +5,8 @@ import createReactClass from 'create-react-class';
 import moment from 'moment-timezone';
 
 import {t} from 'app/locale';
+import Button from 'app/components/button';
+import ButtonBar from 'app/components/buttonBar';
 import ConfigStore from 'app/stores/configStore';
 import DateTime from 'app/components/dateTime';
 import ExternalLink from 'app/components/links/externalLink';
@@ -89,63 +91,39 @@ const GroupEventToolbar = createReactClass({
     const baseEventsPath = `/organizations/${orgId}/issues/${groupId}/events/`;
 
     const eventNavNodes = [
-      evt.previousEventID ? (
-        <Link
-          key="oldest"
-          to={{pathname: `${baseEventsPath}oldest/`, query: location.query}}
-          className="btn btn-default"
-          title={t('Oldest')}
-        >
-          <span className="icon-skip-back" />
-        </Link>
-      ) : (
-        <a key="oldest" className="btn btn-default disabled">
-          <span className="icon-skip-back" />
-        </a>
-      ),
-      evt.previousEventID ? (
-        <Link
-          key="prev"
-          to={{
-            pathname: `${baseEventsPath}${evt.previousEventID}/`,
-            query: location.query,
-          }}
-          className="btn btn-default"
-        >
-          {t('Older')}
-        </Link>
-      ) : (
-        <a key="prev" className="btn btn-default disabled">
-          {t('Older')}
-        </a>
-      ),
-      evt.nextEventID ? (
-        <Link
-          key="next"
-          to={{pathname: `${baseEventsPath}${evt.nextEventID}/`, query: location.query}}
-          className="btn btn-default"
-        >
-          {t('Newer')}
-        </Link>
-      ) : (
-        <a key="next" className="btn btn-default disabled">
-          {t('Newer')}
-        </a>
-      ),
-      evt.nextEventID ? (
-        <Link
-          key="latest"
-          to={{pathname: `${baseEventsPath}latest/`, query: location.query}}
-          className="btn btn-default"
-          title={t('Newest')}
-        >
-          <span className="icon-skip-forward" />
-        </Link>
-      ) : (
-        <a key="latest" className="btn btn-default disabled">
-          <span className="icon-skip-forward" />
-        </a>
-      ),
+      <Button
+        key="oldest"
+        to={{pathname: `${baseEventsPath}oldest/`, query: location.query}}
+        disabled={!evt.previousEventID}
+        aria-label={t('Oldest')}
+      >
+        <span className="icon-skip-back" />
+      </Button>,
+      <Button
+        key="prev"
+        to={{
+          pathname: `${baseEventsPath}${evt.previousEventID}/`,
+          query: location.query,
+        }}
+        disabled={!evt.previousEventID}
+      >
+        {t('Older')}
+      </Button>,
+      <Button
+        key="next"
+        to={{pathname: `${baseEventsPath}${evt.nextEventID}/`, query: location.query}}
+        disabled={!evt.nextEventID}
+      >
+        {t('Newer')}
+      </Button>,
+      <Button
+        key="latest"
+        to={{pathname: `${baseEventsPath}latest/`, query: location.query}}
+        disabled={!evt.nextEventID}
+        aria-label={t('Newest')}
+      >
+        <span className="icon-skip-forward" />
+      </Button>,
     ];
 
     // TODO: possible to define this as a route in react-router, but without a corresponding
@@ -163,7 +141,7 @@ const GroupEventToolbar = createReactClass({
     return (
       <div className="event-toolbar">
         <div className="pull-right">
-          <div className="btn-group">{eventNavNodes}</div>
+          <ButtonBar merged>{eventNavNodes}</ButtonBar>
         </div>
         <h4>
           {t('Event')}{' '}
@@ -173,13 +151,11 @@ const GroupEventToolbar = createReactClass({
         </h4>
         <span>
           <Tooltip title={this.getDateTooltip()}>
-            <span>
-              <DateTime
-                date={getDynamicText({value: evt.dateCreated, fixed: 'Dummy timestamp'})}
-                style={style}
-              />
-              {isOverLatencyThreshold && <span className="icon-alert" />}
-            </span>
+            <DateTime
+              date={getDynamicText({value: evt.dateCreated, fixed: 'Dummy timestamp'})}
+              style={style}
+            />
+            {isOverLatencyThreshold && <span className="icon-alert" />}
           </Tooltip>
           <ExternalLink href={jsonUrl} className="json-link">
             {'JSON'} (<FileSize bytes={evt.size} />)
diff --git a/src/sentry/static/sentry/app/views/releases/detail/releaseDetailActions.jsx b/src/sentry/static/sentry/app/views/releases/detail/releaseDetailActions.jsx
index d2faeb37cf..a6831049bb 100644
--- a/src/sentry/static/sentry/app/views/releases/detail/releaseDetailActions.jsx
+++ b/src/sentry/static/sentry/app/views/releases/detail/releaseDetailActions.jsx
@@ -35,18 +35,16 @@ export default class ReleaseDetailsActions extends React.Component {
   render() {
     return (
       <div className="m-b-1">
-        <div className="btn-group">
-          <Confirm
-            onConfirm={this.handleDelete}
-            message={t(
-              'Deleting this release is permanent. Are you sure you wish to continue?'
-            )}
-          >
-            <Button size="small" icon="icon-trash">
-              {t('Delete')}
-            </Button>
-          </Confirm>
-        </div>
+        <Confirm
+          onConfirm={this.handleDelete}
+          message={t(
+            'Deleting this release is permanent. Are you sure you wish to continue?'
+          )}
+        >
+          <Button size="small" icon="icon-trash">
+            {t('Delete')}
+          </Button>
+        </Confirm>
       </div>
     );
   }
diff --git a/tests/js/spec/views/issueList/overview.spec.jsx b/tests/js/spec/views/issueList/overview.spec.jsx
index 37f3ac0185..66fa7fe745 100644
--- a/tests/js/spec/views/issueList/overview.spec.jsx
+++ b/tests/js/spec/views/issueList/overview.spec.jsx
@@ -913,10 +913,9 @@ describe('IssueList,', function() {
 
       expect(
         wrapper
-          .find('Pagination a')
+          .find('Pagination Button')
           .first()
-          .prop('className')
-          .includes('disabled')
+          .prop('disabled')
       ).toBe(true);
 
       issuesRequest = MockApiClient.addMockResponse({
@@ -930,7 +929,7 @@ describe('IssueList,', function() {
 
       // Click next
       wrapper
-        .find('Pagination a')
+        .find('Pagination Button')
         .last()
         .simulate('click');
 
@@ -953,15 +952,14 @@ describe('IssueList,', function() {
 
       expect(
         wrapper
-          .find('Pagination a')
+          .find('Pagination Button')
           .first()
-          .prop('className')
-          .includes('disabled')
+          .prop('disabled')
       ).toBe(false);
 
       // Click next again
       wrapper
-        .find('Pagination a')
+        .find('Pagination Button')
         .last()
         .simulate('click');
 
@@ -984,7 +982,7 @@ describe('IssueList,', function() {
 
       // Click previous
       wrapper
-        .find('Pagination a')
+        .find('Pagination Button')
         .first()
         .simulate('click');
 
@@ -1007,7 +1005,7 @@ describe('IssueList,', function() {
 
       // Click previous back to initial page
       wrapper
-        .find('Pagination a')
+        .find('Pagination Button')
         .first()
         .simulate('click');
       await tick();
diff --git a/tests/js/spec/views/organizationGroupDetails/groupEventDetails.spec.jsx b/tests/js/spec/views/organizationGroupDetails/groupEventDetails.spec.jsx
index ec4fba7641..895dcc3b22 100644
--- a/tests/js/spec/views/organizationGroupDetails/groupEventDetails.spec.jsx
+++ b/tests/js/spec/views/organizationGroupDetails/groupEventDetails.spec.jsx
@@ -194,8 +194,8 @@ describe('groupEventDetails', () => {
 
     const buttons = wrapper
       .find('.event-toolbar')
-      .find('.btn-group')
-      .find('Link');
+      .find('ButtonBar')
+      .find('Button');
 
     expect(buttons.at(0).prop('to')).toEqual({
       pathname: '/organizations/org-slug/issues/1/events/oldest/',
