commit ce5376d7adb22a7a14bd193083f6e614da4ba805
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jun 26 11:18:23 2012 -0700

    Correct group id behavior in various templates (fixes GH-299)

diff --git a/sentry/templates/sentry/groups/details.html b/sentry/templates/sentry/groups/details.html
index 2ad004c4ba..d8fb33e294 100644
--- a/sentry/templates/sentry/groups/details.html
+++ b/sentry/templates/sentry/groups/details.html
@@ -45,7 +45,7 @@
 {% block main %}
     {% handle_before_events request group %}
     <ul class="events" id="event_list">
-        <li class="event level-{{ group.get_level_display }}{% if group.status == 1 %} resolved{% endif %}" data-count="{{ group.times_seen }}" data-score="{{ group.sort_value }}" data-group="{{ group.id|safe }}">
+        <li class="event level-{{ group.get_level_display }}{% if group.status == 1 %} resolved{% endif %}" data-count="{{ group.times_seen|safe }}" data-score="{{ group.sort_value|safe }}" data-group="{{ group.id|safe }}">
             <div class="count"><span>{{ group.times_seen|small_count }}</span></div>
             <div class="details">
                 <h3>
@@ -74,13 +74,13 @@
                 <ul class="actions">
                     <li>
                         {% if group.status == 0 %}
-                            <a href="javascript:void(0)" class="tip" onclick="Sentry.stream.resolve('{{ group.project.slug }}', {{ group.pk }}, false);" rel="tooltip" title="{% trans "Mark as Resolved" %}">&#10003;</a>
+                            <a href="javascript:void(0)" class="tip" onclick="Sentry.stream.resolve('{{ group.project.slug }}', {{ group.id|safe }}, false);" rel="tooltip" title="{% trans "Mark as Resolved" %}">&#10003;</a>
                         {% else %}
                             <a href="javascript:void(0)" class="tip disabled" rel="tooltip" title="{% trans "Already Resolved" %}">&#10003;</a>
                         {% endif %}
                     </li>
                     {% if request.user.is_authenticated %}
-                        <li><a href="javascript:void(0)" onclick="Sentry.stream.bookmark('{{ group.project.slug }}', {{ group.pk }}, this);" class="tip bookmark{% if is_bookmarked %} checked{% endif %}" rel="tooltip" title="{% trans "Bookmark" %}">&#9829;</a></li>
+                        <li><a href="javascript:void(0)" onclick="Sentry.stream.bookmark('{{ group.project.slug }}', {{ group.id|safe }}, this);" class="tip bookmark{% if is_bookmarked %} checked{% endif %}" rel="tooltip" title="{% trans "Bookmark" %}">&#9829;</a></li>
                     {% endif %}
                 </ul>
             </div>
@@ -90,10 +90,10 @@
     <section class="body">
         <ul class="nav nav-tabs">
             <li{% ifequal page 'details' %} class="active"{% endifequal %}>
-                <a href="{% url sentry-group group.project.slug group.pk %}">{% trans "Details" %}</a>
+                <a href="{% url sentry-group group.project.slug group.id %}">{% trans "Details" %}</a>
             </li>
             <li{% ifequal page 'event_list' %} class="active"{% endifequal %}>
-                <a href="{% url sentry-group-events group.project.slug group.pk %}">{% trans "Events" %}</a>
+                <a href="{% url sentry-group-events group.project.slug group.id %}">{% trans "Events" %}</a>
             </li>
             {% for label, link, is_active in group|get_panels:request %}
                 <li{% if is_active %} class="active"{% endif %}><a href="{{ link }}">{{ label }}</a></li>
@@ -101,11 +101,11 @@
             <li class="dropdown pull-right">
                 <a class="dropdown-toggle" href="#" data-toggle="dropdown">{% trans "Actions" %} <span class="caret"></span></a>
                 <ul class="dropdown-menu">
-                    <li><a href="{% url sentry-api-remove-group project_id=project.slug group_id=group.pk %}">{% trans "Remove Event" %}</a></li>
+                    <li><a href="{% url sentry-api-remove-group project_id=project.slug group_id=group.id %}">{% trans "Remove Event" %}</a></li>
                     <li><a {% ifequal page 'event_list' %}{% if event %}
-                    href="{% url sentry-group-event-json project_id=project.slug group_id=group.pk event_id_or_latest=event.pk %}"{% else %}
-                    href="{% url sentry-group-event-json project_id=project.slug group_id=group.pk event_id_or_latest="latest" %}"{% endif %}{% else %}
-                    href="{% url sentry-group-events-json project_id=project.slug group_id=group.pk %}"{% endifequal %}
+                    href="{% url sentry-group-event-json project_id=project.slug group_id=group.id event_id_or_latest=event.id %}"{% else %}
+                    href="{% url sentry-group-event-json project_id=project.slug group_id=group.id event_id_or_latest="latest" %}"{% endif %}{% else %}
+                    href="{% url sentry-group-events-json project_id=project.slug group_id=group.id %}"{% endifequal %}
                     >{% trans "Raw JSON Data" %}</a></li>
                     {% for label, link, is_active in group|get_actions:request %}
                         {% if forloop.first %}
@@ -128,7 +128,7 @@
                         <h2>{% trans "Frequency" %}</h2>
                     </div>
                     <div class="module-content" style="height: 120px;">
-                        <div id="chart" data-api-url="{% url sentry-api-chart project_id=project.slug %}" data-group="{{ group.id }}">
+                        <div id="chart" data-api-url="{% url sentry-api-chart project_id=project.slug %}" data-group="{{ group.id|safe }}">
                             <noscript>{% trans "Get yourself some JavaScripts dood" %}</noscript>
                             <p>{% trans "Loading..." %}</p>
                         </div>
diff --git a/sentry/templates/sentry/partial/_group.html b/sentry/templates/sentry/partial/_group.html
index 3946daafff..ebdcbcd3fa 100644
--- a/sentry/templates/sentry/partial/_group.html
+++ b/sentry/templates/sentry/partial/_group.html
@@ -2,7 +2,7 @@
 {% load sentry_helpers %}
 {% load sentry_plugins %}
 
-<li class="event level-{{ group.get_level_display }}{% if group.status == 1 %} resolved{% endif %}" data-count="{{ group.times_seen }}" data-score="{{ group.sort_value }}" data-group="{{ group.id|safe }}">
+<li class="event level-{{ group.get_level_display }}{% if group.status == 1 %} resolved{% endif %}" data-count="{{ group.times_seen|safe }}" data-score="{{ group.sort_value|safe }}" data-group="{{ group.id|safe }}">
     <div class="count"><span>{{ group.times_seen|small_count }}</span></div>
     <div class="details">
         <h3>
@@ -33,13 +33,13 @@
         <ul class="actions">
             <li>
                 {% if group.status == 0 %}
-                    <a href="javascript:void(0)" class="tip" onclick="Sentry.stream.resolve('{{ group.project.slug }}', {{ group.pk }}, this);" rel="tooltip" title="{% trans "Mark as Resolved" %}">&#10003;</a>
+                    <a href="javascript:void(0)" class="tip" onclick="Sentry.stream.resolve('{{ group.project.slug }}', {{ group.id|safe }}, this);" rel="tooltip" title="{% trans "Mark as Resolved" %}">&#10003;</a>
                 {% else %}
                     <a href="javascript:void(0)" class="tip disabled" rel="tooltip" title="{% trans "Already Resolved" %}">&#10003;</a>
                 {% endif %}
             </li>
             {% if request.user.is_authenticated %}
-                <li><a href="javascript:void(0)" onclick="Sentry.stream.bookmark('{{ group.project.slug }}', {{ group.pk }}, this);" class="tip bookmark{% if is_bookmarked %} checked{% endif %}" rel="tooltip" title="{% trans "Bookmark" %}">&#9829;</a></li>
+                <li><a href="javascript:void(0)" onclick="Sentry.stream.bookmark('{{ group.project.slug }}', {{ group.id|safe }}, this);" class="tip bookmark{% if is_bookmarked %} checked{% endif %}" rel="tooltip" title="{% trans "Bookmark" %}">&#9829;</a></li>
             {% endif %}
         </ul>
     </div>
