commit a2854be28a5f12e848f84aedaac3166c96a9e4c1
Author: Meredith <meredith@getsentry.com>
Date:   Thu Jun 22 14:10:24 2017 -0700

    make localhost url actually work

diff --git a/src/sentry/filters/localhost.py b/src/sentry/filters/localhost.py
index 00f99f497b..697b2790b7 100644
--- a/src/sentry/filters/localhost.py
+++ b/src/sentry/filters/localhost.py
@@ -25,7 +25,7 @@ class LocalhostFilter(Filter):
             return ''
 
     def get_domain(self, data):
-        return urlparse(self.get_url(data)).netloc
+        return urlparse(self.get_url(data)).netloc.split(':')[0]
 
     def test(self, data):
         return self.get_ip_address(data) in LOCAL_IPS or self.get_domain(data) in LOCAL_DOMAINS
diff --git a/tests/sentry/filters/test_localhost.py b/tests/sentry/filters/test_localhost.py
index afff609c7b..2440cab104 100644
--- a/tests/sentry/filters/test_localhost.py
+++ b/tests/sentry/filters/test_localhost.py
@@ -39,6 +39,9 @@ class LocalhostFilterTest(TestCase):
         data = self.get_mock_data(url='http://localhost/something.html')
         assert self.apply_filter(data)
 
+        data = self.get_mock_data(url='http://localhost:9000/')
+        assert self.apply_filter(data)
+
         data = self.get_mock_data(url='https://localhost')
         assert self.apply_filter(data)
 
