commit a27c855d543a2246cac2aca9d4cf8de8e8439a32
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Aug 18 18:30:48 2013 -0700

    Only attempt to modify system path when VIRTUAL_ENV is set

diff --git a/hooks/pre-commit b/hooks/pre-commit
index 4ee2b72acf..d58db4d62a 100755
--- a/hooks/pre-commit
+++ b/hooks/pre-commit
@@ -10,8 +10,11 @@ os.environ['PYFLAKES_NODOCTEST'] = '1'
 sys.argv = [os.path.join(os.path.dirname(__file__), os.pardir, os.pardir)]
 
 # git usurbs your bin path for hooks and will always run system python
-site_packages = glob.glob('%s/lib/*/site-packages' % os.environ['VIRTUAL_ENV'])[0]
-sys.path.insert(0, site_packages)
+if 'VIRTUAL_ENV' in os.environ:
+    site_packages = glob.glob(
+        '%s/lib/*/site-packages' % os.environ['VIRTUAL_ENV'])[0]
+    sys.path.insert(0, site_packages)
+
 
 def main():
     from flake8.main import DEFAULT_CONFIG
