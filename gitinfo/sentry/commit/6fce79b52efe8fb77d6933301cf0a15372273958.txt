commit 6fce79b52efe8fb77d6933301cf0a15372273958
Author: Dan Fuller <dfuller@sentry.io>
Date:   Mon Oct 7 13:37:03 2019 -0700

    perf(db): Improve speed of query in `clear_expired_resolutions`
    
    This query is slow because it does an inefficient joni to `sentry_release_project`. Just fetching
    the ids separately and doing an in seems to improve things.

diff --git a/src/sentry/tasks/clear_expired_resolutions.py b/src/sentry/tasks/clear_expired_resolutions.py
index 89139cb33d..9a037e24e6 100644
--- a/src/sentry/tasks/clear_expired_resolutions.py
+++ b/src/sentry/tasks/clear_expired_resolutions.py
@@ -23,7 +23,7 @@ def clear_expired_resolutions(release_id):
     resolution_list = list(
         GroupResolution.objects.filter(
             Q(type=GroupResolution.Type.in_next_release) | Q(type__isnull=True),
-            release__projects=release.projects.all(),
+            release__projects__in=[p.id for p in release.projects.all()],
             release__date_added__lt=release.date_added,
             status=GroupResolution.Status.pending,
         ).exclude(release=release)
