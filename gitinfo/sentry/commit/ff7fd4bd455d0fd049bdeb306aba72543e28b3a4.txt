commit ff7fd4bd455d0fd049bdeb306aba72543e28b3a4
Author: Christian Clauss <cclauss@me.com>
Date:   Mon Oct 28 23:38:24 2019 +0100

    build(ci): Add basic linting on Travis for Python 3 syntax errors (#14906)

diff --git a/.travis.yml b/.travis.yml
index 758cbe14b7..a90c534512 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -130,6 +130,13 @@ matrix:
         - nvm install
         - ./bin/yarn install --pure-lockfile
 
+    # Proactive linting on 3.7 during the porting process
+    - python: 3.7
+      name: 'Linter (Python 3.7)'
+      install: pip install 'sentry-flake8>=0.2.0,<0.3.0'
+      # configuration for flake8 can be found in setup.cfg
+      script: flake8
+
     - <<: *postgres_default
       name: 'Backend [Postgres] (1/2)'
       env: TEST_SUITE=postgres DB=postgres TOTAL_TEST_GROUPS=2 TEST_GROUP=0
diff --git a/Makefile b/Makefile
index 8155cc63fe..9d0c5c2913 100644
--- a/Makefile
+++ b/Makefile
@@ -182,6 +182,7 @@ endif
 
 lint: lint-python lint-js
 
+# configuration for flake8 can be found in setup.cfg
 lint-python:
 	@echo "--> Linting python"
 	bash -eo pipefail -c "flake8 | tee .artifacts/flake8.pycodestyle.log"
diff --git a/src/sentry/__init__.py b/src/sentry/__init__.py
index ea141994aa..2b2964e279 100644
--- a/src/sentry/__init__.py
+++ b/src/sentry/__init__.py
@@ -7,7 +7,7 @@ from subprocess import check_output
 
 try:
     VERSION = __import__("pkg_resources").get_distribution("sentry").version
-except Exception as e:
+except Exception:
     VERSION = "unknown"
 
 
diff --git a/src/sentry/api/base.py b/src/sentry/api/base.py
index c843316be4..8f1dfa84ca 100644
--- a/src/sentry/api/base.py
+++ b/src/sentry/api/base.py
@@ -87,7 +87,7 @@ class Endpoint(APIView):
     def handle_exception(self, request, exc):
         try:
             response = super(Endpoint, self).handle_exception(exc)
-        except Exception as exc:
+        except Exception:
             import sys
             import traceback
 
diff --git a/src/sentry/api/endpoints/debug_files.py b/src/sentry/api/endpoints/debug_files.py
index 9f3822b18f..7a0a7b338b 100644
--- a/src/sentry/api/endpoints/debug_files.py
+++ b/src/sentry/api/endpoints/debug_files.py
@@ -266,7 +266,7 @@ class DifAssembleEndpoint(ProjectEndpoint):
             jsonschema.validate(files, schema)
         except jsonschema.ValidationError as e:
             return Response({"error": str(e).splitlines()[0]}, status=400)
-        except BaseException as e:
+        except BaseException:
             return Response({"error": "Invalid json body"}, status=400)
 
         file_response = {}
diff --git a/src/sentry/api/endpoints/organization_release_assemble.py b/src/sentry/api/endpoints/organization_release_assemble.py
index e7bb24653f..b3e6fd3b4f 100644
--- a/src/sentry/api/endpoints/organization_release_assemble.py
+++ b/src/sentry/api/endpoints/organization_release_assemble.py
@@ -50,7 +50,7 @@ class OrganizationReleaseAssembleEndpoint(OrganizationReleasesBaseEndpoint):
             jsonschema.validate(data, schema)
         except jsonschema.ValidationError as e:
             return Response({"error": str(e).splitlines()[0]}, status=400)
-        except BaseException as e:
+        except BaseException:
             return Response({"error": "Invalid json body"}, status=400)
 
         checksum = data.get("checksum", None)
diff --git a/src/sentry/integrations/github/repository.py b/src/sentry/integrations/github/repository.py
index e0e33b339f..3fb26a490b 100644
--- a/src/sentry/integrations/github/repository.py
+++ b/src/sentry/integrations/github/repository.py
@@ -27,7 +27,7 @@ class GitHubRepositoryProvider(providers.IntegrationRepositoryProvider):
             # when installing the app (commits can be accessed for public repos)
             # https://developer.github.com/v3/repos/hooks/#list-hooks
             client.repo_hooks(repo)
-        except ApiError as e:
+        except ApiError:
             raise IntegrationError(u"You must grant Sentry access to {}".format(repo))
 
         return repo_data
diff --git a/src/sentry/integrations/github_enterprise/repository.py b/src/sentry/integrations/github_enterprise/repository.py
index 5df9aa29a0..20ab88a321 100644
--- a/src/sentry/integrations/github_enterprise/repository.py
+++ b/src/sentry/integrations/github_enterprise/repository.py
@@ -24,7 +24,7 @@ class GitHubEnterpriseRepositoryProvider(GitHubRepositoryProvider):
         try:
             # make sure installation has access to this specific repo
             client.get_commits(repo)
-        except ApiError as e:
+        except ApiError:
             raise IntegrationError(u"You must grant Sentry access to {}".format(repo))
 
         return repo_data
diff --git a/src/sentry/net/http.py b/src/sentry/net/http.py
index 598583cd3d..058e81b3c8 100644
--- a/src/sentry/net/http.py
+++ b/src/sentry/net/http.py
@@ -70,7 +70,7 @@ class SafeConnectionMixin(object):
             # to establish our own connection.
             conn = safe_create_connection((self._dns_host, self.port), self.timeout, **extra_kw)
 
-        except SocketTimeout as e:
+        except SocketTimeout:
             raise ConnectTimeoutError(
                 self, "Connection to %s timed out. (connect timeout=%s)" % (self.host, self.timeout)
             )
diff --git a/tests/acceptance/conftest.py b/tests/acceptance/conftest.py
index b507ba4841..9681fd2444 100644
--- a/tests/acceptance/conftest.py
+++ b/tests/acceptance/conftest.py
@@ -1,4 +1,4 @@
-from __future__ import absolute_import
+from __future__ import absolute_import, print_function
 
 import os
 import json
@@ -28,16 +28,17 @@ def pytest_configure(config):
             last_built = int(time.time()) - data["built"]
 
             if last_built <= 3600:
-                print (  # noqa: B314
-                    """
+                print(  # noqa: B314
+                    u"""
 ###################
 #
-# Frontend assets last built %d seconds ago, skipping rebuilds for another %d seconds.
+# Frontend assets last built {} seconds ago, skipping rebuilds for another {} seconds.
 # Delete the file: `.webpack.meta` to rebuild.
 #
 ###################
-                """
-                    % (last_built, 3600 - last_built)
+                """.format(
+                        last_built, 3600 - last_built
+                    )
                 )
                 return
     except IOError:
@@ -45,7 +46,7 @@ def pytest_configure(config):
     except Exception:
         pass
 
-    print (  # noqa: B314
+    print(  # noqa: B314
         """
 ###################
 #
diff --git a/tests/sentry/api/endpoints/test_group_tagkey_details.py b/tests/sentry/api/endpoints/test_group_tagkey_details.py
index 97d65e62c8..e79710b49e 100644
--- a/tests/sentry/api/endpoints/test_group_tagkey_details.py
+++ b/tests/sentry/api/endpoints/test_group_tagkey_details.py
@@ -9,7 +9,7 @@ from sentry.testutils.helpers.datetime import iso_format, before_now
 
 class GroupTagDetailsTest(APITestCase, SnubaTestCase):
     def test_simple(self):
-        for i in xrange(3):
+        for i in range(3):
             self.store_event(
                 data={
                     "tags": {"foo": "bar"},
diff --git a/tests/sentry/api/endpoints/test_project_tagkey_details.py b/tests/sentry/api/endpoints/test_project_tagkey_details.py
index ddaef735f7..4a09ca1677 100644
--- a/tests/sentry/api/endpoints/test_project_tagkey_details.py
+++ b/tests/sentry/api/endpoints/test_project_tagkey_details.py
@@ -23,7 +23,7 @@ class ProjectTagKeyDetailsTest(APITestCase, SnubaTestCase):
                 project_id=project.id,
             )
 
-        for i in xrange(0, 16):
+        for i in range(0, 16):
             make_event(i)
 
         self.login_as(user=self.user)
diff --git a/tests/sentry/integrations/github_enterprise/testutils.py b/tests/sentry/integrations/github_enterprise/testutils.py
index e3a41e0de4..63fffef93f 100644
--- a/tests/sentry/integrations/github_enterprise/testutils.py
+++ b/tests/sentry/integrations/github_enterprise/testutils.py
@@ -212,7 +212,7 @@ PUSH_EVENT_EXAMPLE = r"""{
   }
 }"""
 
-PUSH_EVENT_EXAMPLE_INSTALLATION = b"""{
+PUSH_EVENT_EXAMPLE_INSTALLATION = r"""{
   "ref": "refs/heads/changes",
   "installation" : {
     "id": 12345
