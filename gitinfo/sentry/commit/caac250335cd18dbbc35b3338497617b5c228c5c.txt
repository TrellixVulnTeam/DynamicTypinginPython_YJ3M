commit caac250335cd18dbbc35b3338497617b5c228c5c
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Aug 2 11:52:09 2014 -0700

    Move team list JS code into controller

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 80c8ceff19..3ec7984928 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -430,6 +430,7 @@ SENTRY_STATIC_BUNDLES = {
                 "sentry/app/controllers/manageTeamSettings.js",
                 "sentry/app/controllers/projectStream.js",
                 "sentry/app/controllers/teamDashboard.js",
+                "sentry/app/controllers/teamList.js",
 
                 "sentry/app/directives/clippy.js",
                 "sentry/app/directives/count.js",
diff --git a/src/sentry/static/sentry/app/base.js b/src/sentry/static/sentry/app/base.js
index e741ca4430..d0c486d675 100644
--- a/src/sentry/static/sentry/app/base.js
+++ b/src/sentry/static/sentry/app/base.js
@@ -181,65 +181,6 @@
 
         DashboardPage: BasePage,
 
-        SelectTeamPage: BasePage.extend({
-
-            initialize: function(){
-                BasePage.prototype.initialize.apply(this, arguments);
-
-                this.refreshSparklines();
-                $(window).on('resize', this.refreshSparklines);
-            },
-
-            refreshSparklines: function(){
-                $('.chart').each(function(n, el){
-                    var $el = $(el);
-                    $.ajax({
-                        url: $el.attr('data-api-url'),
-                        type: 'get',
-                        dataType: 'json',
-                        data: {
-                            since: new Date().getTime() / 1000 - 3600 * 24,
-                            resolution: '1h'
-                        },
-                        success: _.bind(function(data){
-                            for (var i = 0; i < data.length; i++) {
-                                // set timestamp to be in millis
-                                data[i][0] = data[i][0] * 1000;
-                            }
-
-                            $.plot($el, [{
-                                    data: data,
-                                    color: '#ebeff3',
-                                    shadowSize: 0,
-                                    lines: {
-                                        lineWidth: 2,
-                                        show: true,
-                                        fill: true,
-                                        color: '#f6f8fa'
-                                }
-                                }], {
-                                    yaxis: {
-                                        min: 0
-                                    },
-                                    grid: {
-                                        show: false
-                                    },
-                                    hoverable: false,
-                                    legend: {
-                                        noColumns: 5
-                                    },
-                                    lines: {
-                                        show: false
-                                    }
-                                }
-                            );
-                        }, this)
-                    });
-                });
-            }
-
-        }),
-
         GroupDetailsPage: BasePage.extend({
 
             initialize: function(data){
diff --git a/src/sentry/static/sentry/app/controllers/teamList.js b/src/sentry/static/sentry/app/controllers/teamList.js
new file mode 100644
index 0000000000..2126f6aad2
--- /dev/null
+++ b/src/sentry/static/sentry/app/controllers/teamList.js
@@ -0,0 +1,61 @@
+(function(){
+  'use strict';
+
+  function refreshSparklines(){
+    $('.chart').each(function(_, el){
+      var $el = $(el);
+
+      $.ajax({
+        url: $el.attr('data-api-url'),
+        type: 'get',
+        dataType: 'json',
+        data: {
+          since: new Date().getTime() / 1000 - 3600 * 24,
+          resolution: '1h'
+        },
+        success: function(data){
+          for (var i = 0; i < data.length; i++) {
+            // set timestamp to be in millis
+            data[i][0] = data[i][0] * 1000;
+          }
+
+          $.plot($el, [{
+              data: data,
+              color: '#ebeff3',
+              shadowSize: 0,
+              lines: {
+                lineWidth: 2,
+                show: true,
+                fill: true,
+                color: '#f6f8fa'
+              }
+            }], {
+              yaxis: {
+                min: 0
+              },
+              grid: {
+                show: false
+              },
+              hoverable: false,
+              legend: {
+                noColumns: 5
+              },
+              lines: {
+                show: false
+              }
+            }
+          );
+        }
+      });
+    });
+  }
+
+  SentryApp.classy.controller({
+    name: 'TeamListCtrl',
+
+    init: function($window) {
+      refreshSparklines();
+      angular.element($window).bind('resize', refreshSparklines);
+    }
+  });
+}());
diff --git a/src/sentry/templates/sentry/select_team.html b/src/sentry/templates/sentry/select_team.html
index 139378da08..da817d4a69 100644
--- a/src/sentry/templates/sentry/select_team.html
+++ b/src/sentry/templates/sentry/select_team.html
@@ -6,6 +6,8 @@
 
 {% block bodyclass %}team-index {{ block.super }}{% endblock %}
 
+{% block controller %}TeamListCtrl{% endblock %}
+
 {% block heading %}Sentry{% endblock %}
 
 {% block content %}
@@ -42,8 +44,4 @@
             <div class="alert alert-info">{% trans "You are not a member of any teams." %}</div>
         {% endif %}
     </section>
-
-    <script>
-    new app.SelectTeamPage();
-    </script>
 {% endblock %}
