commit 30a4237d750dcc8538da4fb73274957a40d9367b
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Dec 10 14:12:40 2014 -0800

    Fix various project URLs

diff --git a/src/sentry/templates/sentry/admin/projects/list.html b/src/sentry/templates/sentry/admin/projects/list.html
index d41493729b..225f9e7dc7 100644
--- a/src/sentry/templates/sentry/admin/projects/list.html
+++ b/src/sentry/templates/sentry/admin/projects/list.html
@@ -46,8 +46,8 @@
                         <tr>
                             <td>
                                 {% if project.team %}
-                                    <a href="{% url 'sentry-manage-project' project.team.slug project.slug %}"><strong>{{ project.team.slug }}/{{ project.slug }}</strong></a>
-                                    <a href="{% url 'sentry-stream' project.team.slug project.slug %}">[stream]</a><br/>
+                                    <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}"><strong>{{ project.organization.slug }}/{{ project.slug }}</strong></a>
+                                    <a href="{% url 'sentry-stream' project.organization.slug project.slug %}">[stream]</a><br/>
                                 {% else %}
                                     <strong>{{ project.slug }}</strong>
                                 {% endif %}
diff --git a/src/sentry/templates/sentry/bases/explore.html b/src/sentry/templates/sentry/bases/explore.html
index 468066bde8..61cfc2282a 100644
--- a/src/sentry/templates/sentry/bases/explore.html
+++ b/src/sentry/templates/sentry/bases/explore.html
@@ -9,14 +9,14 @@
     {{ block.super }}
     <ul class="nav nav-tabs">
         <li>
-            <a href="{% url 'sentry-stream' project.team.slug project.slug %}">{% trans "Stream" %}</a>
+            <a href="{% url 'sentry-stream' project.organization.slug project.slug %}">{% trans "Stream" %}</a>
         </li>
         <li class="active">
-            <a href="{% url 'sentry-explore' project.team.slug project.slug %}">{% trans "Explore" %}</a>
+            <a href="{% url 'sentry-explore' project.organization.slug project.slug %}">{% trans "Explore" %}</a>
         </li>
         {% if team and request.user|can_admin_team:team %}
             <li>
-                <a href="{% url 'sentry-manage-project' project.team.slug project.slug %}">{% trans "Settings" %}</a>
+                <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}">{% trans "Settings" %}</a>
             </li>
         {% endif %}
     </ul>
@@ -34,5 +34,5 @@
 {% block sidebar %}
     <h6>{% trans "About Explore" %}</h6>
     <p>Explore allows you to drill into the tagged data recorded at a project level. You can drill into each tag to quickly find outliers or events which have been recorded under a specific tagged value.</p>
-    <p>To learn more about sending tags, check the <a href="{% url 'sentry-project-client-help' project.team.slug project.slug %}">client documentation</a>.</p>
+    <p>To learn more about sending tags, check the <a href="{% url 'sentry-project-client-help' project.organization.slug project.slug %}">client documentation</a>.</p>
 {% endblock %}
diff --git a/src/sentry/templates/sentry/bases/settings.html b/src/sentry/templates/sentry/bases/settings.html
index 6ece5ea94f..475ba913ca 100644
--- a/src/sentry/templates/sentry/bases/settings.html
+++ b/src/sentry/templates/sentry/bases/settings.html
@@ -8,10 +8,10 @@
     {{ block.super }}
     <ul class="nav nav-tabs">
         <li>
-            <a href="{% url 'sentry-stream' project.team.slug project.slug %}">{% trans "Stream" %}</a>
+            <a href="{% url 'sentry-stream' project.organization.slug project.slug %}">{% trans "Stream" %}</a>
         </li>
         <li class="active">
-            <a href="{% url 'sentry-manage-project' project.team.slug project.slug %}">{% trans "Settings" %}</a>
+            <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}">{% trans "Settings" %}</a>
         </li>
     </ul>
 {% endblock %}
diff --git a/src/sentry/templates/sentry/bases/stream.html b/src/sentry/templates/sentry/bases/stream.html
index 610330c612..1d7955b690 100644
--- a/src/sentry/templates/sentry/bases/stream.html
+++ b/src/sentry/templates/sentry/bases/stream.html
@@ -7,7 +7,7 @@
 
 {% block page_header %}
     <div class="pull-right">
-        <form action="{% url 'sentry-stream' project.team.slug project.slug %}" id="search">
+        <form action="{% url 'sentry-stream' project.organization.slug project.slug %}" id="search">
             <input type="text" name="query" value="{% if query %}{{ query }}{% endif %}" placeholder="{% trans "Search query or event ID" %}" />
         </form>
     </div>
@@ -15,14 +15,14 @@
     {{ block.super }}
     <ul class="nav nav-tabs">
         <li class="active">
-            <a href="{% url 'sentry-stream' project.team.slug project.slug %}">{% trans "Stream" %}</a>
+            <a href="{% url 'sentry-stream' project.organization.slug project.slug %}">{% trans "Stream" %}</a>
         </li>
         <li>
-            <a href="{% url 'sentry-explore' project.team.slug project.slug %}">{% trans "Explore" %}</a>
+            <a href="{% url 'sentry-explore' project.organization.slug project.slug %}">{% trans "Explore" %}</a>
         </li>
         {% if team and request.user|can_admin_team:team %}
             <li>
-                <a href="{% url 'sentry-manage-project' project.team.slug project.slug %}" title="{% trans "Project Settings" %}">
+                <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}" title="{% trans "Project Settings" %}">
                     {% trans "Settings" %}
                 </a>
             </li>
diff --git a/src/sentry/templates/sentry/partial/client_config/javascript.html b/src/sentry/templates/sentry/partial/client_config/javascript.html
index b95b8b2dfb..7eb907dd92 100644
--- a/src/sentry/templates/sentry/partial/client_config/javascript.html
+++ b/src/sentry/templates/sentry/partial/client_config/javascript.html
@@ -4,7 +4,7 @@
 
 <pre>&lt;script src="//{{ raven_js_url }}"&gt;&lt;/script&gt;</pre>
 
-{% url 'sentry-manage-project' project.team.slug project.slug as project_link %}
+{% url 'sentry-manage-project' project.organization.slug project.slug as project_link %}
 
 <p>{% blocktrans %}Add any URLs which will be logging errors in your project's settings under <a href="{{ project_link }}#client-security">Client Security</a>:{% endblocktrans %}</p>
 
diff --git a/src/sentry/templates/sentry/projects/manage.html b/src/sentry/templates/sentry/projects/manage.html
index 773c892b3d..aaa4ab553e 100644
--- a/src/sentry/templates/sentry/projects/manage.html
+++ b/src/sentry/templates/sentry/projects/manage.html
@@ -65,57 +65,57 @@
     <ul class="nav nav-list">
         <li class="nav-header">{% trans "Details" %}</li>
         <li{% if page == 'details' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-manage-project' project.team.slug project.slug %}">{% trans "Settings" %}</a>
+            <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}">{% trans "Settings" %}</a>
         </li>
         <li{% if page == 'notifications' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-project-notifications' project.team.slug project.slug %}">{% trans "Notifications" %}</a>
+            <a href="{% url 'sentry-project-notifications' project.organization.slug project.slug %}">{% trans "Notifications" %}</a>
         </li>
         <li{% if page == 'quotas' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-manage-project-quotas' project.team.slug project.slug %}">{% trans "Rate Limits" %}</a>
+            <a href="{% url 'sentry-manage-project-quotas' project.organization.slug project.slug %}">{% trans "Rate Limits" %}</a>
         </li>
         <li{% if page == 'rules' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-project-rules' project.team.slug project.slug %}">{% trans "Rules" %}</a>
+            <a href="{% url 'sentry-project-rules' project.organization.slug project.slug %}">{% trans "Rules" %}</a>
         </li>
         <li{% if page == 'tags' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-manage-project-tags' project.team.slug project.slug %}">{% trans "Tags" %}</a>
+            <a href="{% url 'sentry-manage-project-tags' project.organization.slug project.slug %}">{% trans "Tags" %}</a>
         </li>
         <li{% if page == 'keys' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-manage-project-keys' project.team.slug project.slug %}">{% trans "API Keys" %}</a>
+            <a href="{% url 'sentry-manage-project-keys' project.organization.slug project.slug %}">{% trans "API Keys" %}</a>
         </li>
     </ul>
     <ul class="nav nav-list">
         <li class="nav-header">{% trans "Client Configuration" %}</li>
         <li{% if page == 'client_help' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-project-client-help' project.team.slug project.slug %}">{% trans "All Platforms" %}</a>
+            <a href="{% url 'sentry-project-client-help' project.organization.slug project.slug %}">{% trans "All Platforms" %}</a>
         </li>
         <li{% if page == 'client_help_javascript' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-docs-client' project.team.slug project.slug "javascript" %}">{% trans "JavaScript" %}</a>
+            <a href="{% url 'sentry-docs-client' project.organization.slug project.slug "javascript" %}">{% trans "JavaScript" %}</a>
         </li>
         <li{% if page == 'client_help_python' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-docs-client' project.team.slug project.slug "python" %}">{% trans "Python" %}</a>
+            <a href="{% url 'sentry-docs-client' project.organization.slug project.slug "python" %}">{% trans "Python" %}</a>
         </li>
         <li{% if page == 'client_help_php' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-docs-client' project.team.slug project.slug "php" %}">{% trans "PHP" %}</a>
+            <a href="{% url 'sentry-docs-client' project.organization.slug project.slug "php" %}">{% trans "PHP" %}</a>
         </li>
         <li{% if page == 'client_help_ruby' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-docs-client' project.team.slug project.slug "ruby" %}">{% trans "Ruby" %}</a>
+            <a href="{% url 'sentry-docs-client' project.organization.slug project.slug "ruby" %}">{% trans "Ruby" %}</a>
         </li>
         <li{% if page == 'client_help_node.js' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-docs-client' project.team.slug project.slug "node.js" %}">{% trans "Node.js" %}</a>
+            <a href="{% url 'sentry-docs-client' project.organization.slug project.slug "node.js" %}">{% trans "Node.js" %}</a>
         </li>
         <li{% if page == 'client_help_java' %} class="active"{% endif %}>
-            <a href="{% url 'sentry-docs-client' project.team.slug project.slug "java" %}">{% trans "Java" %}</a>
+            <a href="{% url 'sentry-docs-client' project.organization.slug project.slug "java" %}">{% trans "Java" %}</a>
         </li>
     </ul>
     {% with project|get_plugins as plugins %}
         <ul class="nav nav-list">
             <li class="nav-header">{% trans "Integrations" %}</li>
             <li class="{% if page == 'plugins' %} active{% endif %}">
-                <a href="{% url 'sentry-manage-project-plugins' project.team.slug project.slug %}">{% trans "Manage Integrations" %} ({{ PLUGINS|length }})</a>
+                <a href="{% url 'sentry-manage-project-plugins' project.organization.slug project.slug %}">{% trans "Manage Integrations" %} ({{ PLUGINS|length }})</a>
             </li>
             {% for p in plugins %}
                 <li{% if page == 'plugin' and plugin.slug == p.slug %} class="active"{% endif %}>
-                    <a href="{% url 'sentry-configure-project-plugin' project.team.slug project.slug p.slug %}">{{ p.get_title }}</a>
+                    <a href="{% url 'sentry-configure-project-plugin' project.organization.slug project.slug p.slug %}">{{ p.get_title }}</a>
                 </li>
             {% endfor %}
         </ul>
diff --git a/src/sentry/templates/sentry/projects/remove.html b/src/sentry/templates/sentry/projects/remove.html
index 699423acb0..83022da3a2 100644
--- a/src/sentry/templates/sentry/projects/remove.html
+++ b/src/sentry/templates/sentry/projects/remove.html
@@ -15,7 +15,7 @@
                 {{ field|as_crispy_field }}
             {% endfor %}
             <fieldset class="form-actions">
-                <button type="submit" class="btn btn-danger">{% trans "Remove Project" %}</button> <a href="{% url 'sentry-manage-project' project.team.slug project.slug %}" class="btn">{% trans "Cancel" %}</a>
+                <button type="submit" class="btn btn-danger">{% trans "Remove Project" %}</button> <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}" class="btn">{% trans "Cancel" %}</a>
             </fieldset>
         </form>
         <style>
diff --git a/src/sentry/web/frontend/project_settings.py b/src/sentry/web/frontend/project_settings.py
index 8f8f7f6126..2f4bf8c2ad 100644
--- a/src/sentry/web/frontend/project_settings.py
+++ b/src/sentry/web/frontend/project_settings.py
@@ -151,7 +151,7 @@ class ProjectSettingsView(ProjectView):
         return True
 
     def get_form(self, request, project):
-        organization = project.team.organization
+        organization = project.organization
         if request.user.is_superuser:
             accessing_user = organization.owner
         else:
@@ -180,7 +180,7 @@ class ProjectSettingsView(ProjectView):
                 request, messages.SUCCESS,
                 _('Changes to your project were saved.'))
 
-            redirect = reverse('sentry-manage-project', args=[project.team.slug, project.slug])
+            redirect = reverse('sentry-manage-project', args=[project.organization.slug, project.slug])
 
             return HttpResponseRedirect(redirect)
 
diff --git a/tests/sentry/web/frontend/test_project_settings.py b/tests/sentry/web/frontend/test_project_settings.py
index aa7077b392..3dfbdcdde9 100644
--- a/tests/sentry/web/frontend/test_project_settings.py
+++ b/tests/sentry/web/frontend/test_project_settings.py
@@ -59,7 +59,7 @@ class ProjectSettingsTest(TestCase):
 
     @fixture
     def path(self):
-        return reverse('sentry-manage-project', args=[self.team.slug, self.project.slug])
+        return reverse('sentry-manage-project', args=[self.organization.slug, self.project.slug])
 
     def test_renders_with_context(self):
         self.login_as(self.organization.owner)
