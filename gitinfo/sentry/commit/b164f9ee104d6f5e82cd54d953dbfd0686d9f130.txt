commit b164f9ee104d6f5e82cd54d953dbfd0686d9f130
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Oct 20 13:40:30 2010 -0700

    Added sentry_sites plugin which acts like servers/urls except for sites (fixes GH-32)

diff --git a/README.rst b/README.rst
index 0ce5209e0a..40e5b448ba 100644
--- a/README.rst
+++ b/README.rst
@@ -256,6 +256,7 @@ Add plugins to your installed apps, and voila::
 	INSTALLED_APPS = [
 	  ...
 	  'sentry.plugins.sentry_servers',
+	  'sentry.plugins.sentry_sites',
 	  'sentry.plugins.sentry_urls',
 	]
 
diff --git a/example_project/settings.py b/example_project/settings.py
index f42f1305d4..af97c357b5 100644
--- a/example_project/settings.py
+++ b/example_project/settings.py
@@ -103,6 +103,7 @@ INSTALLED_APPS = (
     'sentry.client',
     'sentry.plugins.sentry_redmine',
     'sentry.plugins.sentry_servers',
+    'sentry.plugins.sentry_sites',
     'sentry.plugins.sentry_urls',
     'paging',
     'south',
diff --git a/sentry/plugins/sentry_sites/__init__.py b/sentry/plugins/sentry_sites/__init__.py
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/sentry/plugins/sentry_sites/models.py b/sentry/plugins/sentry_sites/models.py
new file mode 100644
index 0000000000..e1278e05f1
--- /dev/null
+++ b/sentry/plugins/sentry_sites/models.py
@@ -0,0 +1,23 @@
+from django.shortcuts import render_to_response
+from django.template.loader import render_to_string
+
+from sentry.plugins import GroupActionProvider
+
+class SiteGroupPanel(GroupActionProvider):
+    """Adds additional support for showing information about sites including:
+    
+    * A panel which shows all sites a message was seen on.
+    * A sidebar module which shows the sites most actively seen on.
+    """
+    
+    title = 'Sites'
+
+    def panels(self, request, panel_list, group):
+        panel_list.append((self.title, self.__class__.get_url(group.pk)))
+        return panel_list
+
+    def view(self, request, group):
+        return render_to_response('sentry/plugins/sentry_sites/index.html', locals())
+    
+    def widget(self, request, group):
+        return render_to_string('sentry/plugins/sentry_sites/widget.html', locals())
\ No newline at end of file
diff --git a/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/index.html b/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/index.html
new file mode 100644
index 0000000000..0fbb536743
--- /dev/null
+++ b/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/index.html
@@ -0,0 +1,19 @@
+{% extends "sentry/group/details.html" %}
+
+{% load paging_extras %}
+
+{% block inner %}
+    <h2>Site List</h2>
+    {% paginate group.unique_sites from request as site_list per_page 25 %}
+    <div class="clearfix">
+        {{ site_list.paging }}
+    </div>
+    <ul class="server-list">
+        {% for site in site_list.objects %}
+            <li><span class="count">{{ site.times_seen }}</span> {{ site.site }}</li>
+        {% endfor %}
+    </ul>
+    <div class="clearfix">
+        {{ site_list.paging }}
+    </div>
+{% endblock %}
\ No newline at end of file
diff --git a/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/widget.html b/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/widget.html
new file mode 100644
index 0000000000..df8f86beed
--- /dev/null
+++ b/sentry/plugins/sentry_sites/templates/sentry/plugins/sentry_sites/widget.html
@@ -0,0 +1,13 @@
+{% load sentry_helpers %}
+
+{% with group.unique_sites|slice:"10" as unique_sites %}
+    {% if unique_sites %}
+        <h2>Sites</h2>
+
+        <ul class="server-list">
+            {% for site, priority in unique_sites|with_priority:"times_seen" %}
+                <li class="priority-{{ priority }}"><span class="count">{{ site.times_seen }}</span> {{ site.site }}</li>
+            {% endfor %}
+        </ul>
+    {% endif %}
+{% endwith %}
\ No newline at end of file
