commit 886a1a77e34358501a1cbc9caacbf10cd03de322
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Tue May 8 09:41:09 2018 -0700

    fix(teams): Fix team members list, wrong user object (#8343)

diff --git a/src/sentry/static/sentry/app/views/settings/team/teamMembers.jsx b/src/sentry/static/sentry/app/views/settings/team/teamMembers.jsx
index ecbbc43aca..3207e82768 100644
--- a/src/sentry/static/sentry/app/views/settings/team/teamMembers.jsx
+++ b/src/sentry/static/sentry/app/views/settings/team/teamMembers.jsx
@@ -241,15 +241,20 @@ const TeamMembers = createReactClass({
           <div style={{textTransform: 'none'}}>{this.renderDropdown(access)}</div>
         </PanelHeader>
         {this.state.teamMemberList.length ? (
-          this.state.teamMemberList.map((member, i) => (
-            <StyledMemberContainer key={i}>
-              <IdBadge avatarSize={36} user={member} useLink orgId={params.orgId} />
+          this.state.teamMemberList.map(member => (
+            <StyledMemberContainer key={member.id}>
+              <IdBadge
+                avatarSize={36}
+                user={member.user || member}
+                useLink
+                orgId={params.orgId}
+              />
               {access.has('org:write') && this.removeButton(member)}
             </StyledMemberContainer>
           ))
         ) : (
           <EmptyMessage icon="icon-user" size="large">
-            Your Team is Empty
+            {t('Your Team is Empty')}
           </EmptyMessage>
         )}
       </Panel>
diff --git a/tests/js/spec/views/__snapshots__/teamMembers.spec.jsx.snap b/tests/js/spec/views/__snapshots__/teamMembers.spec.jsx.snap
index dfcbbbc1a4..b0f9451684 100644
--- a/tests/js/spec/views/__snapshots__/teamMembers.spec.jsx.snap
+++ b/tests/js/spec/views/__snapshots__/teamMembers.spec.jsx.snap
@@ -1,6 +1,6 @@
 // Jest Snapshot v1, https://goo.gl/fbAQLP
 
-exports[`TeamMembers render() renders 1`] = `
+exports[`TeamMembers renders 1`] = `
 <Panel>
   <PanelHeader
     hasButtons={true}
@@ -33,7 +33,7 @@ exports[`TeamMembers render() renders 1`] = `
     </div>
   </PanelHeader>
   <StyledMemberContainer
-    key="0"
+    key="1"
   >
     <IdBadge
       avatarSize={36}
@@ -42,21 +42,10 @@ exports[`TeamMembers render() renders 1`] = `
       user={
         Object {
           "email": "sentry1@test.com",
-          "flags": Object {
-            "sso:linked": false,
-          },
+          "has2fa": false,
           "id": "1",
           "name": "Sentry 1 Name",
-          "pending": false,
-          "role": "",
-          "roleName": "",
-          "user": Object {
-            "email": "sentry1@test.com",
-            "has2fa": false,
-            "id": "1",
-            "name": "Sentry 1 Name",
-            "username": "Sentry 1 Username",
-          },
+          "username": "Sentry 1 Username",
         }
       }
     />
@@ -78,7 +67,7 @@ exports[`TeamMembers render() renders 1`] = `
     </Button>
   </StyledMemberContainer>
   <StyledMemberContainer
-    key="1"
+    key="2"
   >
     <IdBadge
       avatarSize={36}
@@ -87,21 +76,10 @@ exports[`TeamMembers render() renders 1`] = `
       user={
         Object {
           "email": "sentry2@test.com",
-          "flags": Object {
-            "sso:linked": false,
-          },
+          "has2fa": false,
           "id": "2",
           "name": "Sentry 2 Name",
-          "pending": true,
-          "role": "",
-          "roleName": "",
-          "user": Object {
-            "email": "sentry2@test.com",
-            "has2fa": false,
-            "id": "2",
-            "name": "Sentry 2 Name",
-            "username": "Sentry 2 Username",
-          },
+          "username": "Sentry 2 Username",
         }
       }
     />
@@ -123,7 +101,7 @@ exports[`TeamMembers render() renders 1`] = `
     </Button>
   </StyledMemberContainer>
   <StyledMemberContainer
-    key="2"
+    key="3"
   >
     <IdBadge
       avatarSize={36}
@@ -132,21 +110,10 @@ exports[`TeamMembers render() renders 1`] = `
       user={
         Object {
           "email": "sentry3@test.com",
-          "flags": Object {
-            "sso:linked": true,
-          },
+          "has2fa": true,
           "id": "3",
           "name": "Sentry 3 Name",
-          "pending": false,
-          "role": "owner",
-          "roleName": "Owner",
-          "user": Object {
-            "email": "sentry3@test.com",
-            "has2fa": true,
-            "id": "3",
-            "name": "Sentry 3 Name",
-            "username": "Sentry 3 Username",
-          },
+          "username": "Sentry 3 Username",
         }
       }
     />
@@ -168,7 +135,7 @@ exports[`TeamMembers render() renders 1`] = `
     </Button>
   </StyledMemberContainer>
   <StyledMemberContainer
-    key="3"
+    key="4"
   >
     <IdBadge
       avatarSize={36}
@@ -177,21 +144,10 @@ exports[`TeamMembers render() renders 1`] = `
       user={
         Object {
           "email": "sentry4@test.com",
-          "flags": Object {
-            "sso:linked": true,
-          },
+          "has2fa": true,
           "id": "4",
           "name": "Sentry 4 Name",
-          "pending": false,
-          "role": "owner",
-          "roleName": "Owner",
-          "user": Object {
-            "email": "sentry4@test.com",
-            "has2fa": true,
-            "id": "4",
-            "name": "Sentry 4 Name",
-            "username": "Sentry 4 Username",
-          },
+          "username": "Sentry 4 Username",
         }
       }
     />
diff --git a/tests/js/spec/views/teamMembers.spec.jsx b/tests/js/spec/views/teamMembers.spec.jsx
index 774e9770ce..42c67860c0 100644
--- a/tests/js/spec/views/teamMembers.spec.jsx
+++ b/tests/js/spec/views/teamMembers.spec.jsx
@@ -24,44 +24,40 @@ describe('TeamMembers', function() {
     });
   });
 
-  describe('render()', function() {
-    it('renders', function() {
-      let wrapper = shallow(
-        <TeamMembers params={{orgId: org.slug, teamId: team.slug}} organization={org} />,
-        routerContext
-      );
-      expect(wrapper).toMatchSnapshot();
-    });
+  it('renders', function() {
+    let wrapper = shallow(
+      <TeamMembers params={{orgId: org.slug, teamId: team.slug}} organization={org} />,
+      routerContext
+    );
+    expect(wrapper).toMatchSnapshot();
   });
 
-  describe('TeamMembers.removeMember()', function() {
-    it('can remove a team', function() {
-      let endpoint = `/organizations/${org.slug}/members/${members[0]
-        .id}/teams/${team.slug}/`;
-      let mock = Client.addMockResponse({
-        url: endpoint,
-        method: 'DELETE',
-        statusCode: 200,
-      });
+  it('can remove a team', function() {
+    let endpoint = `/organizations/${org.slug}/members/${members[0]
+      .id}/teams/${team.slug}/`;
+    let mock = Client.addMockResponse({
+      url: endpoint,
+      method: 'DELETE',
+      statusCode: 200,
+    });
 
-      let wrapper = mount(
-        <TeamMembers params={{orgId: org.slug, teamId: team.slug}} organization={org} />,
-        routerContext
-      );
+    let wrapper = mount(
+      <TeamMembers params={{orgId: org.slug, teamId: team.slug}} organization={org} />,
+      routerContext
+    );
 
-      expect(mock).not.toHaveBeenCalled();
+    expect(mock).not.toHaveBeenCalled();
 
-      wrapper
-        .find('Button')
-        .at(1)
-        .simulate('click');
+    wrapper
+      .find('Button')
+      .at(1)
+      .simulate('click');
 
-      expect(mock).toHaveBeenCalledWith(
-        endpoint,
-        expect.objectContaining({
-          method: 'DELETE',
-        })
-      );
-    });
+    expect(mock).toHaveBeenCalledWith(
+      endpoint,
+      expect.objectContaining({
+        method: 'DELETE',
+      })
+    );
   });
 });
