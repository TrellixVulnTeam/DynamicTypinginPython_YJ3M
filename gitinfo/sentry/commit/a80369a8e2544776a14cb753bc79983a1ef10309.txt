commit a80369a8e2544776a14cb753bc79983a1ef10309
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Thu Nov 29 14:55:44 2018 -0800

    feat(settings): Expose disabled repositories page to members (#10833)

diff --git a/src/sentry/static/sentry/app/components/repositoryRow.jsx b/src/sentry/static/sentry/app/components/repositoryRow.jsx
index ccd0353125..8d8a5295dd 100644
--- a/src/sentry/static/sentry/app/components/repositoryRow.jsx
+++ b/src/sentry/static/sentry/app/components/repositoryRow.jsx
@@ -1,29 +1,15 @@
 import {Box, Flex} from 'grid-emotion';
+import PropTypes from 'prop-types';
 import React from 'react';
 import styled from 'react-emotion';
-import PropTypes from 'prop-types';
 
+import {Repository} from 'app/sentryTypes';
 import {deleteRepository, cancelDeleteRepository} from 'app/actionCreators/integrations';
+import {t} from 'app/locale';
+import Access from 'app/components/acl/access';
 import Button from 'app/components/button';
 import Confirm from 'app/components/confirm';
 import SpreadLayout from 'app/components/spreadLayout';
-import {Repository} from 'app/sentryTypes';
-import {t} from 'app/locale';
-
-const StyledRow = styled(SpreadLayout)`
-  border-bottom: 1px solid ${p => p.theme.borderLight};
-
-  ${p =>
-    p.status === 'disabled' &&
-    `
-    filter: grayscale(1);
-    opacity: 0.4;
-  `};
-
-  &:last-child {
-    border-bottom: none;
-  }
-`;
 
 class RepositoryRow extends React.Component {
   static propTypes = {
@@ -82,46 +68,68 @@ class RepositoryRow extends React.Component {
     let isActive = this.isActive;
 
     return (
-      <StyledRow status={repository.status}>
-        <Box p={2} flex="1">
-          <Flex direction="column">
-            <Box pb={1}>
-              <strong>{repository.name}</strong>
-              {!isActive && <small> — {this.getStatusLabel(repository)}</small>}
-              {repository.status === 'pending_deletion' && (
-                <small>
-                  {' '}
-                  (
-                  <a onClick={this.cancelDelete}>{t('Cancel')}</a>
-                  )
-                </small>
-              )}
-            </Box>
-            <Box>
-              {showProvider && (
-                <small>{repository.provider.name}&nbsp;&mdash;&nbsp;</small>
-              )}
-              {repository.url && (
-                <small>
-                  <a href={repository.url}>{repository.url.replace('https://', '')}</a>
-                </small>
-              )}
+      <Access access={['org:write']}>
+        {({hasAccess}) => (
+          <StyledRow status={repository.status}>
+            <Box p={2} flex="1">
+              <Flex direction="column">
+                <Box pb={1}>
+                  <strong>{repository.name}</strong>
+                  {!isActive && <small> — {this.getStatusLabel(repository)}</small>}
+                  {hasAccess &&
+                    repository.status === 'pending_deletion' && (
+                      <small>
+                        {' '}
+                        (
+                        <a onClick={this.cancelDelete}>{t('Cancel')}</a>
+                        )
+                      </small>
+                    )}
+                </Box>
+                <Box>
+                  {showProvider && (
+                    <small>{repository.provider.name}&nbsp;&mdash;&nbsp;</small>
+                  )}
+                  {repository.url && (
+                    <small>
+                      <a href={repository.url}>
+                        {repository.url.replace('https://', '')}
+                      </a>
+                    </small>
+                  )}
+                </Box>
+              </Flex>
             </Box>
-          </Flex>
-        </Box>
 
-        <Box p={2}>
-          <Confirm
-            disabled={!isActive && repository.status !== 'disabled'}
-            onConfirm={this.deleteRepo}
-            message={t('Are you sure you want to remove this repository?')}
-          >
-            <Button size="xsmall" icon="icon-trash" />
-          </Confirm>
-        </Box>
-      </StyledRow>
+            <Box p={2}>
+              <Confirm
+                disabled={!hasAccess || (!isActive && repository.status !== 'disabled')}
+                onConfirm={this.deleteRepo}
+                message={t('Are you sure you want to remove this repository?')}
+              >
+                <Button size="xsmall" icon="icon-trash" disabled={!hasAccess} />
+              </Confirm>
+            </Box>
+          </StyledRow>
+        )}
+      </Access>
     );
   }
 }
 
+const StyledRow = styled(SpreadLayout)`
+  border-bottom: 1px solid ${p => p.theme.borderLight};
+
+  ${p =>
+    p.status === 'disabled' &&
+    `
+    filter: grayscale(1);
+    opacity: 0.4;
+  `};
+
+  &:last-child {
+    border-bottom: none;
+  }
+`;
+
 export default RepositoryRow;
diff --git a/src/sentry/static/sentry/app/views/settings/organization/navigationConfiguration.jsx b/src/sentry/static/sentry/app/views/settings/organization/navigationConfiguration.jsx
index ca85bc2e2c..00d3b499cb 100644
--- a/src/sentry/static/sentry/app/views/settings/organization/navigationConfiguration.jsx
+++ b/src/sentry/static/sentry/app/views/settings/organization/navigationConfiguration.jsx
@@ -62,7 +62,6 @@ const organizationNavigation = [
       {
         path: `${pathPrefix}/repos/`,
         title: t('Repositories'),
-        show: ({access}) => access.has('org:write'),
         description: t('Manage repositories connected to the organization'),
       },
       {
