commit b2ef7e0269e7c8b7d98dac84662d10ff168445e8
Author: Dan Fuller <dfuller@sentry.io>
Date:   Wed Nov 13 14:37:29 2019 -0800

    fix(api): Add in more missing `__in` statements when querying across relationships.
    
    These are missing `__in` statements from the `Backend [Postgres] (1/2)` tests.

diff --git a/src/sentry/api/endpoints/project_member_index.py b/src/sentry/api/endpoints/project_member_index.py
index 248146a068..f08fece5d5 100644
--- a/src/sentry/api/endpoints/project_member_index.py
+++ b/src/sentry/api/endpoints/project_member_index.py
@@ -14,7 +14,7 @@ class ProjectMemberIndexEndpoint(ProjectEndpoint):
             OrganizationMember.objects.filter(
                 Q(user__is_active=True) | Q(user__isnull=True),
                 organization=project.organization,
-                teams=project.teams.all(),
+                teams__in=project.teams.all(),
             )
             .select_related("user")
             .distinct()
diff --git a/tests/sentry/api/endpoints/test_project_member_index.py b/tests/sentry/api/endpoints/test_project_member_index.py
index a8d585368c..c14861bafa 100644
--- a/tests/sentry/api/endpoints/test_project_member_index.py
+++ b/tests/sentry/api/endpoints/test_project_member_index.py
@@ -12,7 +12,8 @@ class ProjectMemberIndexTest(APITestCase):
         user_3 = self.create_user("baz@localhost", username="baz")
         org = self.create_organization(owner=user_1)
         team = self.create_team(organization=org, slug="baz")
-        project_1 = self.create_project(teams=[team], slug="foo")
+        team_2 = self.create_team(organization=org, slug="bazinga")
+        project_1 = self.create_project(teams=[team, team_2], slug="foo")
         self.create_project(teams=[team], slug="bar")
         self.create_member(organization=org, user=user_2, teams=[team])
         self.create_member(organization=org, user=user_3, teams=[team])
diff --git a/tests/sentry/incidents/test_tasks.py b/tests/sentry/incidents/test_tasks.py
index c10348343e..b854e2e91a 100644
--- a/tests/sentry/incidents/test_tasks.py
+++ b/tests/sentry/incidents/test_tasks.py
@@ -183,7 +183,7 @@ class CalculateIncidentSuspectsTest(TestCase):
         commit = Commit.objects.filter(releasecommit__release__in=[release])
         incident = self.create_incident(self.organization, groups=[group])
         calculate_incident_suspects(incident.id)
-        assert IncidentSuspectCommit.objects.filter(incident=incident, commit=commit).exists()
+        assert IncidentSuspectCommit.objects.filter(incident=incident, commit__in=commit).exists()
 
 
 class HandleTriggerActionTest(TestCase):
