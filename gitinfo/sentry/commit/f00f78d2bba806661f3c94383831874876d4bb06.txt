commit f00f78d2bba806661f3c94383831874876d4bb06
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Tue Jan 29 11:05:02 2019 -0800

    feat(dashboard): Reorder widgets and combine devices/browsers (#11752)
    
    * Reorder dashboard widgets
    * Combine top devices with top browsers
    * Remove a release chart
    * Change `getChartDataForWidget` to use `, ` as field separators instead of just a space
    
    
    ![image](https://user-images.githubusercontent.com/79684/51873422-f1d20580-2311-11e9-97c6-6e17ad5866bc.png)

diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/data/dashboards/overviewDashboard.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/data/dashboards/overviewDashboard.jsx
index cf72850278..b373749c34 100644
--- a/src/sentry/static/sentry/app/views/organizationDashboard/data/dashboards/overviewDashboard.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDashboard/data/dashboards/overviewDashboard.jsx
@@ -1,22 +1,18 @@
 import affectedUsers from '../widgets/affectedUsers';
 import errorsByGeo from '../widgets/errorsByGeo';
 import eventsByReleasePercent from '../widgets/eventsByReleasePercent';
-import eventsByReleaseArea from '../widgets/eventsByReleaseArea';
 import events from '../widgets/events';
 import handledVsUnhandled from '../widgets/handledVsUnhandled';
-import topBrowsers from '../widgets/topBrowsers';
-import topDevices from '../widgets/topDevices';
+import topDevicesAndBrowsers from '../widgets/topDevicesAndBrowsers';
 
 const overviewDashboard = {
   widgets: [
     events,
-    handledVsUnhandled,
-    affectedUsers,
-    topBrowsers,
-    topDevices,
     eventsByReleasePercent,
-    eventsByReleaseArea,
+    affectedUsers,
     errorsByGeo,
+    handledVsUnhandled,
+    topDevicesAndBrowsers,
   ],
 };
 
diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/data/queries/topBrowsers.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/data/queries/topBrowsers.jsx
deleted file mode 100644
index cef266d583..0000000000
--- a/src/sentry/static/sentry/app/views/organizationDashboard/data/queries/topBrowsers.jsx
+++ /dev/null
@@ -1,14 +0,0 @@
-/**
- * Top Errors by Browser
- */
-const topBrowsers = {
-  fields: ['browser.name'],
-  conditions: [],
-  aggregations: [['count()', null, 'count']],
-  limit: 10,
-
-  orderby: '-count',
-  groupby: ['browser.name'],
-};
-
-export default topBrowsers;
diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/data/queries/topDevices.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/data/queries/topDevicesAndBrowsers.jsx
similarity index 75%
rename from src/sentry/static/sentry/app/views/organizationDashboard/data/queries/topDevices.jsx
rename to src/sentry/static/sentry/app/views/organizationDashboard/data/queries/topDevicesAndBrowsers.jsx
index 59f7575e5a..f2fedf5425 100644
--- a/src/sentry/static/sentry/app/views/organizationDashboard/data/queries/topDevices.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDashboard/data/queries/topDevicesAndBrowsers.jsx
@@ -2,13 +2,12 @@
  * Top Errors by Device
  */
 const topDevices = {
-  fields: ['device.family'],
+  fields: ['device.family', 'browser.name'],
   conditions: [],
   aggregations: [['count()', null, 'count']],
   limit: 10,
-
+  groupby: [],
   orderby: '-count',
-  groupby: ['device.family'],
 };
 
 export default topDevices;
diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/eventsByReleaseArea.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/eventsByReleaseArea.jsx
deleted file mode 100644
index 896445847c..0000000000
--- a/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/eventsByReleaseArea.jsx
+++ /dev/null
@@ -1,11 +0,0 @@
-import {WIDGET_DISPLAY} from 'app/views/organizationDashboard/constants';
-
-import eventsByRelease from '../queries/eventsByRelease';
-
-const eventsByReleasePercent = {
-  type: WIDGET_DISPLAY.STACKED_AREA_CHART,
-  queries: {discover: [eventsByRelease]},
-  title: 'Events By Release',
-};
-
-export default eventsByReleasePercent;
diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/topBrowsers.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/topBrowsers.jsx
deleted file mode 100644
index 4643cb3853..0000000000
--- a/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/topBrowsers.jsx
+++ /dev/null
@@ -1,12 +0,0 @@
-import {WIDGET_DISPLAY} from 'app/views/organizationDashboard/constants';
-
-import topBrowsersQuery from '../queries/topBrowsers';
-
-const topBrowsers = {
-  type: WIDGET_DISPLAY.TABLE,
-  queries: {discover: [topBrowsersQuery]},
-
-  title: 'Browsers',
-};
-
-export default topBrowsers;
diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/topDevices.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/topDevices.jsx
deleted file mode 100644
index 807bd29cca..0000000000
--- a/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/topDevices.jsx
+++ /dev/null
@@ -1,12 +0,0 @@
-import {WIDGET_DISPLAY} from 'app/views/organizationDashboard/constants';
-
-import topDevicesQuery from '../queries/topDevices';
-
-const topDevices = {
-  type: WIDGET_DISPLAY.TABLE,
-  queries: {discover: [topDevicesQuery]},
-
-  title: 'Devices',
-};
-
-export default topDevices;
diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/topDevicesAndBrowsers.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/topDevicesAndBrowsers.jsx
new file mode 100644
index 0000000000..e442fac7fd
--- /dev/null
+++ b/src/sentry/static/sentry/app/views/organizationDashboard/data/widgets/topDevicesAndBrowsers.jsx
@@ -0,0 +1,12 @@
+import {WIDGET_DISPLAY} from 'app/views/organizationDashboard/constants';
+
+import topDevicesAndBrowsersQuery from '../queries/topDevicesAndBrowsers';
+
+const topDevicesAndBrowsers = {
+  type: WIDGET_DISPLAY.TABLE,
+  queries: {discover: [topDevicesAndBrowsersQuery]},
+
+  title: 'Devices, Browsers',
+};
+
+export default topDevicesAndBrowsers;
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/result/utils.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/result/utils.jsx
index acba7ddedf..cc8aa7d83e 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/result/utils.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/result/utils.jsx
@@ -66,7 +66,7 @@ export function getChartDataForWidget(data, query, options = {}) {
       data: data.map(res => {
         const obj = {
           value: res[aggregation[2]],
-          name: fields.map(field => `${res[field]}`).join(' '),
+          name: fields.map(field => `${res[field]}`).join(', '),
         };
 
         if (options.includePercentages && total) {
diff --git a/tests/js/spec/views/organizationDiscover/result/utils.spec.jsx b/tests/js/spec/views/organizationDiscover/result/utils.spec.jsx
index da7126a9dc..28c3cb5edc 100644
--- a/tests/js/spec/views/organizationDiscover/result/utils.spec.jsx
+++ b/tests/js/spec/views/organizationDiscover/result/utils.spec.jsx
@@ -65,19 +65,19 @@ describe('Utils', function() {
         {
           seriesName: 'count',
           data: [
-            {value: 2, percentage: 16.67, name: '5 null'},
-            {value: 2, percentage: 16.67, name: '5 staging'},
-            {value: 2, percentage: 16.67, name: '5 alpha'},
-            {value: 6, percentage: 50, name: '5 production'},
+            {value: 2, percentage: 16.67, name: '5, null'},
+            {value: 2, percentage: 16.67, name: '5, staging'},
+            {value: 2, percentage: 16.67, name: '5, alpha'},
+            {value: 6, percentage: 50, name: '5, production'},
           ],
         },
         {
           seriesName: 'uniq_id',
           data: [
-            {value: 1, percentage: 5.56, name: '5 null'},
-            {value: 3, percentage: 16.67, name: '5 staging'},
-            {value: 4, percentage: 22.22, name: '5 alpha'},
-            {value: 10, percentage: 55.56, name: '5 production'},
+            {value: 1, percentage: 5.56, name: '5, null'},
+            {value: 3, percentage: 16.67, name: '5, staging'},
+            {value: 4, percentage: 22.22, name: '5, alpha'},
+            {value: 10, percentage: 55.56, name: '5, production'},
           ],
         },
       ];
