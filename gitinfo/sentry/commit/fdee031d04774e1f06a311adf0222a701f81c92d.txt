commit fdee031d04774e1f06a311adf0222a701f81c92d
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Dec 23 23:29:44 2011 -0800

    Some general cleanup for replaying events

diff --git a/sentry/templates/sentry/events/replay_request.html b/sentry/templates/sentry/events/replay_request.html
index 257e22310a..343ffd415a 100644
--- a/sentry/templates/sentry/events/replay_request.html
+++ b/sentry/templates/sentry/events/replay_request.html
@@ -28,14 +28,14 @@
                     <td>{{ form.method.label_tag }}</td>
                     <td>{{ form.method }}</td>
                 </tr>
-                <tr>
-                    <td>{{ form.headers.label_tag }}</td>
-                    <td>{{ form.headers }}</td>
-                </tr>
                 <tr>
                     <td>{{ form.data.label_tag }}</td>
                     <td>{{ form.data }}</td>
                 </tr>
+                <tr>
+                    <td>{{ form.headers.label_tag }}</td>
+                    <td>{{ form.headers }}</td>
+                </tr>
             </table>
             <div class="submit">
                 <button type="submit" class="button">{% trans "Submit" %}</button>
diff --git a/sentry/web/forms.py b/sentry/web/forms.py
index ece979662a..dd6152921a 100644
--- a/sentry/web/forms.py
+++ b/sentry/web/forms.py
@@ -1,7 +1,7 @@
 from django import forms
 
 from sentry.models import Project
-
+from sentry.interfaces import Http
 
 class EditProjectForm(forms.ModelForm):
     class Meta:
@@ -11,12 +11,9 @@ class EditProjectForm(forms.ModelForm):
 
 class ReplayForm(forms.Form):
     url = forms.URLField()
-    method = forms.ChoiceField(choices=((k, k) for k in (
-        'POST', 'GET', 'PUT', 'DELETE', 'HEAD', 'OPTIONS',
-        'CONNECT', 'TRACE',
-    )))
-    headers = forms.CharField(required=False, widget=forms.Textarea())
+    method = forms.ChoiceField(choices=((k, k) for k in Http.METHODS))
     data = forms.CharField(required=False, widget=forms.Textarea())
+    headers = forms.CharField(required=False, widget=forms.Textarea())
 
     def clean_headers(self):
         value = self.cleaned_data.get('headers')
diff --git a/sentry/web/frontend/events.py b/sentry/web/frontend/events.py
index c9618897bc..3d6e6ee32a 100644
--- a/sentry/web/frontend/events.py
+++ b/sentry/web/frontend/events.py
@@ -1,4 +1,5 @@
 import datetime
+import urllib
 
 from django.core.context_processors import csrf
 from django.views.decorators.csrf import csrf_protect
@@ -60,12 +61,11 @@ def replay_event(request, project_id, event_id):
         # TODO: show a proper error
         raise ValueError
     http = interfaces['sentry.interfaces.Http']
-
     initial = {
         'url': http.url,
         'method': http.method,
-        'headers': '\n'.join('%s: %v' % (k, v) for k, v in http.env.iteritems()),
-        'data': http.data,
+        'headers': '\n'.join('%s: %s' % (k, v) for k, v in http.env.iteritems()),
+        'data': urllib.urlencode(http.data),
     }
 
     form = ReplayForm(request.POST or None, initial=initial)
