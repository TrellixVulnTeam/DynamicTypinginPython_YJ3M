commit e148de5f9b72f731e2ac58e6cba1bad11e533c99
Author: David Cramer <dcramer@gmail.com>
Date:   Wed May 2 12:42:48 2018 -0700

    tests

diff --git a/tests/sentry/quotas/test_base.py b/tests/sentry/quotas/test_base.py
index edc797405a..63b6800452 100644
--- a/tests/sentry/quotas/test_base.py
+++ b/tests/sentry/quotas/test_base.py
@@ -41,3 +41,31 @@ class QuotaTest(TestCase):
             project=self.project, rate_limit_window=None, rate_limit_count=None
         )
         assert self.backend.get_key_quota(key) == (0, 0)
+
+    def test_get_organization_quota_with_account_limit_and_higher_system_limit(self):
+        org = self.create_organization()
+        OrganizationOption.objects.set_value(org, 'sentry:account-rate-limit', 3600)
+        with self.options({'system.rate-limit': 61}):
+            assert self.backend.get_organization_quota(org) == (3600, 3600)
+
+    def test_get_organization_quota_with_account_limit_and_lower_system_limit(self):
+        org = self.create_organization()
+        OrganizationOption.objects.set_value(org, 'sentry:account-rate-limit', 3600)
+        with self.options({'system.rate-limit': 59}):
+            assert self.backend.get_organization_quota(org) == (59, 60)
+
+    def test_get_organization_quota_with_account_limit_and_no_system_limit(self):
+        org = self.create_organization()
+        OrganizationOption.objects.set_value(org, 'sentry:account-rate-limit', 3600)
+        with self.options({'system.rate-limit': 0}):
+            assert self.backend.get_organization_quota(org) == (3600, 3600)
+
+    def test_get_organization_quota_with_no_account_limit_and_system_limit(self):
+        org = self.create_organization()
+        with self.settings(SENTRY_DEFAULT_MAX_EVENTS_PER_MINUTE='50%', SENTRY_SINGLE_ORGANIZATION=False), self.options({'system.rate-limit': 10}):
+            assert self.backend.get_organization_quota(org) == (5, 60)
+
+    def test_get_organization_quota_with_no_account_limit_and_relative_system_limit_single_org(self):
+        org = self.create_organization()
+        with self.settings(SENTRY_DEFAULT_MAX_EVENTS_PER_MINUTE='50%', SENTRY_SINGLE_ORGANIZATION=True), self.options({'system.rate-limit': 10}):
+            assert self.backend.get_organization_quota(org) == (10, 60)
