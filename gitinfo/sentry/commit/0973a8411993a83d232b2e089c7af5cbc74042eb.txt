commit 0973a8411993a83d232b2e089c7af5cbc74042eb
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Thu Mar 21 09:38:22 2019 -0700

    feat(grouping): Ignore exception type for unknown exceptions in grouping (#12489)

diff --git a/src/sentry/grouping/strategies/exception.py b/src/sentry/grouping/strategies/exception.py
index 7616c94cbe..1e8b165d5f 100644
--- a/src/sentry/grouping/strategies/exception.py
+++ b/src/sentry/grouping/strategies/exception.py
@@ -21,6 +21,12 @@ def single_exception_v1(exception, config, **meta):
         values=[exception.type] if exception.type else [],
     )
 
+    if exception.mechanism and exception.mechanism.synthetic:
+        type_component.update(
+            contributes=False,
+            hint='ignored because exception is synthetic'
+        )
+
     return GroupingComponent(
         id='exception',
         values=[
diff --git a/tests/sentry/grouping/inputs/native-complex-function-names.json b/tests/sentry/grouping/inputs/native-complex-function-names.json
index ccd8aee47d..b6f7e5e2aa 100644
--- a/tests/sentry/grouping/inputs/native-complex-function-names.json
+++ b/tests/sentry/grouping/inputs/native-complex-function-names.json
@@ -23,7 +23,11 @@
           ]
         },
         "type": "log_demo",
-        "value": "Holy shit everything is on fire!"
+        "value": "Holy shit everything is on fire!",
+        "mechanism": {
+          "type": "minidump",
+          "synthetic": true
+        }
       }
     ]
   },
diff --git a/tests/sentry/grouping/inputs/native-no-filenames.json b/tests/sentry/grouping/inputs/native-no-filenames.json
index d22ab36d22..b4e81ab4e5 100644
--- a/tests/sentry/grouping/inputs/native-no-filenames.json
+++ b/tests/sentry/grouping/inputs/native-no-filenames.json
@@ -96,7 +96,11 @@
           ]
         },
         "type": "log_demo",
-        "value": "Holy shit everything is on fire!"
+        "value": "Holy shit everything is on fire!",
+        "mechanism": {
+          "type": "minidump",
+          "synthetic": true
+        }
       }
     ]
   },
diff --git a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/new:wip/native_complex_function_names.pysnap b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/new:wip/native_complex_function_names.pysnap
index 296f19036e..f55596f6a7 100644
--- a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/new:wip/native_complex_function_names.pysnap
+++ b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/new:wip/native_complex_function_names.pysnap
@@ -1,13 +1,13 @@
 ---
-created: '2019-03-16T14:31:51.956347Z'
+created: '2019-03-21T00:08:18.464103Z'
 creator: sentry
 source: tests/sentry/grouping/test_variants.py
 ---
 app:
-  hash: 'fed4f6eb500e04f59e97d31e8743ec8f'
+  hash: None
   component:
-    app*
-      exception*
+    app (exception of system takes precedence)
+      exception
         stacktrace
           frame (non app frame)
             function* (isolated function)
@@ -15,11 +15,11 @@ app:
           frame (non app frame)
             function* (isolated function)
               u'Scaleform::GFx::AS3::IMEManager::DispatchEvent'
-        type*
+        type (ignored because exception is synthetic)
           u'log_demo'
 --------------------------------------------------------------------------
 system:
-  hash: 'd6125002ce075cab3755011dddefe9e1'
+  hash: '9b78cced1eefcd0c655a0a3d8ce2cdd2'
   component:
     system*
       exception*
@@ -30,5 +30,5 @@ system:
           frame*
             function* (isolated function)
               u'Scaleform::GFx::AS3::IMEManager::DispatchEvent'
-        type*
+        type (ignored because exception is synthetic)
           u'log_demo'
diff --git a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/new:wip/native_no_filenames.pysnap b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/new:wip/native_no_filenames.pysnap
index 103412ab4d..d545be0b42 100644
--- a/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/new:wip/native_no_filenames.pysnap
+++ b/tests/sentry/grouping/snapshots/test_variants/test_event_hash_variant/new:wip/native_no_filenames.pysnap
@@ -1,10 +1,10 @@
 ---
-created: '2019-03-20T23:12:41.922036Z'
+created: '2019-03-21T00:08:18.476445Z'
 creator: sentry
 source: tests/sentry/grouping/test_variants.py
 ---
 app:
-  hash: '0069ba38208554530eed55f7647f7c5c'
+  hash: '418120a66f7031923031f5c52aca0724'
   component:
     app*
       exception*
@@ -51,11 +51,11 @@ app:
           frame (non app frame)
             function (ignored unknown function)
               u'<redacted>'
-        type*
+        type (ignored because exception is synthetic)
           u'log_demo'
 --------------------------------------------------------------------------
 system:
-  hash: '30f71d6ff287238ce1541e21e633a8c5'
+  hash: '06f8f02638bc75df5a5c88712055ee5f'
   component:
     system*
       exception*
@@ -102,5 +102,5 @@ system:
           frame
             function (ignored unknown function)
               u'<redacted>'
-        type*
+        type (ignored because exception is synthetic)
           u'log_demo'
