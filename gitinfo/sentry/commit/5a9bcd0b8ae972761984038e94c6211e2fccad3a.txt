commit 5a9bcd0b8ae972761984038e94c6211e2fccad3a
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Jan 1 23:46:21 2012 -0800

    Helps to use context classes correctly

diff --git a/sentry/web/helpers.py b/sentry/web/helpers.py
index dc3ede4f3f..bd53042dc7 100644
--- a/sentry/web/helpers.py
+++ b/sentry/web/helpers.py
@@ -89,11 +89,12 @@ def render_to_string(template, context=None, request=None):
         if 'project_list' not in context:
             context['project_list'] = get_project_list(request.user).values()
 
-        context_cls = RequestContext
+    if request:
+        context = RequestContext(request, context)
     else:
-        context_cls = Context
+        context = Context(context)
 
-    return loader.render_to_string(template, context_cls(context))
+    return loader.render_to_string(template, context)
 
 
 def render_to_response(template, context=None, request=None, status=200):
