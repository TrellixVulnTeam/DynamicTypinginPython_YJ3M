commit 1af94dfe2e3cfd649be9a2ff5884a73be4c137a9
Author: Jan Michael Auer <jan.auer@sentry.io>
Date:   Wed Apr 22 00:53:55 2020 +0200

    fix(dev): Increase reverse proxy body size (#18390)
    
    Debug file uploads using `sentry-cli` require requests with a payload
    size of 32MB. The legacy endpoint requires even larger requests. Since
    the default nginx limit is 1MB, it needs to be configured explicitly.
    This patch bumps it to 100MB, to leave some room for larger
    improvements.
    
    Additionally, this introduces the `/envelope/` ingestion endpoint and
    routes it to Relay, since this endpoint is not implemented in Sentry.

diff --git a/config/reverse_proxy/nginx.conf b/config/reverse_proxy/nginx.conf
index 536d2d0198..d843a33fc6 100644
--- a/config/reverse_proxy/nginx.conf
+++ b/config/reverse_proxy/nginx.conf
@@ -20,12 +20,9 @@ http {
 
     access_log  /var/log/nginx/access.log  main;
 
-    sendfile        on;
-    #tcp_nopush     on;
-
-    keepalive_timeout  65;
-
-    #gzip  on;
+    sendfile              on;
+    keepalive_timeout     65;
+    client_max_body_size  100m;
 
     upstream relay {
         server sentry_relay.sentry:3000;
@@ -42,6 +39,9 @@ http {
         location /api/store/ {
             proxy_pass http://relay;
         }
+        location ~ ^/api/\d+/envelope/$ {
+            proxy_pass http://relay;
+        }
         location ~ ^/api/\d+/store/$ {
             proxy_pass http://relay;
         }
