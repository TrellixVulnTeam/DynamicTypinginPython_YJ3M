commit db8f68166fa401ef7a33fa22d1b753b56ca154c5
Author: David Cramer <dcramer@gmail.com>
Date:   Thu May 3 09:26:27 2018 -0700

    feat(api): Return updated org details on delete

diff --git a/src/sentry/api/endpoints/organization_details.py b/src/sentry/api/endpoints/organization_details.py
index f43b7d94be..bc736324a7 100644
--- a/src/sentry/api/endpoints/organization_details.py
+++ b/src/sentry/api/endpoints/organization_details.py
@@ -4,7 +4,6 @@ import logging
 import six
 
 from rest_framework import serializers, status
-from rest_framework.response import Response
 from uuid import uuid4
 
 from sentry import roles
@@ -25,6 +24,8 @@ from sentry.utils.apidocs import scenario, attach_scenarios
 
 ERR_DEFAULT_ORG = 'You cannot remove the default organization.'
 
+ERR_NO_USER = 'This request requires an authenticated user.'
+
 ORG_OPTIONS = (
     # serializer field name, option key name, type
     ('projectRateLimit', 'sentry:project-rate-limit', int),
@@ -260,7 +261,7 @@ class OrganizationDetailsEndpoint(OrganizationEndpoint):
             request.user,
             DetailedOrganizationSerializer(),
         )
-        return Response(context)
+        return self.respond(context)
 
     @attach_scenarios([update_organization_scenario])
     def put(self, request, organization):
@@ -317,14 +318,14 @@ class OrganizationDetailsEndpoint(OrganizationEndpoint):
                     data=changed_data
                 )
 
-            return Response(
+            return self.respond(
                 serialize(
                     organization,
                     request.user,
                     DetailedOrganizationSerializer(),
                 )
             )
-        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
+        return self.respond(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
 
     @sudo_required
     def delete(self, request, organization):
@@ -346,10 +347,10 @@ class OrganizationDetailsEndpoint(OrganizationEndpoint):
         :auth: required, user-context-needed
         """
         if not request.user.is_authenticated():
-            return Response({'detail': 'This request requires a user.'}, status=401)
+            return self.respond({'detail': ERR_NO_USER}, status=401)
 
         if organization.is_default:
-            return Response({'detail': ERR_DEFAULT_ORG}, status=400)
+            return self.respond({'detail': ERR_DEFAULT_ORG}, status=400)
 
         updated = Organization.objects.filter(
             id=organization.id,
@@ -388,4 +389,9 @@ class OrganizationDetailsEndpoint(OrganizationEndpoint):
                 }
             )
 
-        return Response(status=204)
+        context = serialize(
+            organization,
+            request.user,
+            DetailedOrganizationSerializer(),
+        )
+        return self.respond(context, status=202)
diff --git a/tests/sentry/api/endpoints/test_organization_details.py b/tests/sentry/api/endpoints/test_organization_details.py
index f0ccf6df10..a38d298c27 100644
--- a/tests/sentry/api/endpoints/test_organization_details.py
+++ b/tests/sentry/api/endpoints/test_organization_details.py
@@ -398,7 +398,7 @@ class OrganizationDeleteTest(APITestCase):
 
         org = Organization.objects.get(id=org.id)
 
-        assert response.status_code == 204, response.data
+        assert response.status_code == 202, response.data
 
         assert org.status == OrganizationStatus.PENDING_DELETION
 
diff --git a/tests/sentry/api/endpoints/test_sudo.py b/tests/sentry/api/endpoints/test_sudo.py
index f54043268c..cd3a6c1549 100644
--- a/tests/sentry/api/endpoints/test_sudo.py
+++ b/tests/sentry/api/endpoints/test_sudo.py
@@ -43,4 +43,4 @@ class SudoTest(APITestCase):
 
             # This should now work
             response = self.client.delete(url, is_sudo=False)
-            assert response.status_code == 204
+            assert response.status_code == 202
