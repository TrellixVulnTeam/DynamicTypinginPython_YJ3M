commit 4b595ca7e4b5a9b36dd05d55f2448c189aa917f0
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Jan 5 13:46:33 2013 -0800

    Actually record users_seen correctly

diff --git a/src/sentry/models.py b/src/sentry/models.py
index 120946347e..f20ef57dd3 100644
--- a/src/sentry/models.py
+++ b/src/sentry/models.py
@@ -951,7 +951,14 @@ def record_user_count(columns, extra, created, **kwargs):
         # if it's not a new row, it's not a unique user
         return
 
-    app.buffer.incr(Group, {'users_seen': 1})
+    if columns.get('key') != 'user_email':
+        return
+
+    app.buffer.incr(Group, {
+        'users_seen': 1,
+    }, {
+        'id': columns['group'].id,
+    })
 
 
 # Signal registration
