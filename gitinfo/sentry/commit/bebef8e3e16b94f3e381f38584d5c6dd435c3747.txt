commit bebef8e3e16b94f3e381f38584d5c6dd435c3747
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Aug 25 22:01:36 2014 -0700

    Add doc sections for API

diff --git a/src/sentry/api/base.py b/src/sentry/api/base.py
index 55ae07afd1..d27922393a 100644
--- a/src/sentry/api/base.py
+++ b/src/sentry/api/base.py
@@ -20,6 +20,13 @@ ONE_DAY = ONE_HOUR * 24
 LINK_HEADER = '<{uri}&cursor={cursor}>; rel="{name}"'
 
 
+class DocSection(object):
+    ACCOUNTS = 'Accounts API'
+    TEAMS = 'Teams API'
+    PROJECTS = 'Projects API'
+    EVENTS = 'Events API'
+
+
 class Endpoint(APIView):
     authentication_classes = (KeyAuthentication, SessionAuthentication)
     renderer_classes = (JSONRenderer,)
diff --git a/src/sentry/api/endpoints/auth_index.py b/src/sentry/api/endpoints/auth_index.py
index 8f6de0ca98..455f45a713 100644
--- a/src/sentry/api/endpoints/auth_index.py
+++ b/src/sentry/api/endpoints/auth_index.py
@@ -2,7 +2,7 @@ from django.contrib.auth import login, logout
 from rest_framework.response import Response
 
 from sentry.api.authentication import QuietBasicAuthentication
-from sentry.api.base import Endpoint
+from sentry.api.base import DocSection, Endpoint
 
 
 class AuthIndexEndpoint(Endpoint):
@@ -16,6 +16,8 @@ class AuthIndexEndpoint(Endpoint):
 
     authentication_classes = [QuietBasicAuthentication]
 
+    doc_section = DocSection.ACCOUNTS
+
     def post(self, request):
         """
         Authenticate a user using the provided credentials (i.e. basic auth).
diff --git a/src/sentry/api/endpoints/event_details.py b/src/sentry/api/endpoints/event_details.py
index bccc7fb673..de325cb6ba 100644
--- a/src/sentry/api/endpoints/event_details.py
+++ b/src/sentry/api/endpoints/event_details.py
@@ -1,6 +1,6 @@
 from rest_framework.response import Response
 
-from sentry.api.base import Endpoint
+from sentry.api.base import DocSection, Endpoint
 from sentry.api.permissions import assert_perm
 from sentry.api.serializers import serialize
 from sentry.models import Event
@@ -8,6 +8,8 @@ from sentry.web.helpers import group_is_public
 
 
 class EventDetailsEndpoint(Endpoint):
+    doc_section = DocSection.EVENTS
+
     def _get_entries(self, request, event):
         # XXX(dcramer): These are called entries for future-proofing
         is_public = group_is_public(event.group, request.user)
diff --git a/src/sentry/api/endpoints/team_stats.py b/src/sentry/api/endpoints/team_stats.py
index 851464ec53..bba69c01ee 100644
--- a/src/sentry/api/endpoints/team_stats.py
+++ b/src/sentry/api/endpoints/team_stats.py
@@ -3,12 +3,14 @@ from rest_framework.response import Response
 from six.moves import range
 
 from sentry.app import tsdb
-from sentry.api.base import BaseStatsEndpoint
+from sentry.api.base import BaseStatsEndpoint, DocSection
 from sentry.api.permissions import assert_perm
 from sentry.models import Team, Project
 
 
 class TeamStatsEndpoint(BaseStatsEndpoint):
+    doc_section = DocSection.TEAMS
+
     def get(self, request, team_id):
         team = Team.objects.get(id=team_id)
 
diff --git a/src/sentry/api/views/help_index.py b/src/sentry/api/views/help_index.py
index 6ff1681363..f219ec3990 100644
--- a/src/sentry/api/views/help_index.py
+++ b/src/sentry/api/views/help_index.py
@@ -14,11 +14,30 @@ class ApiHelpIndexView(View):
         prefix = '/api/0/'
 
         context = {
-            'resource_list': self.get_resources(prefix),
+            'section_list': self.get_sections(prefix)
         }
 
         return render_to_response('sentry/help/api_index.html', context, request)
 
+    def get_sections(self, prefix=''):
+        resource_list = sorted(
+            (r for r in self.get_resources(prefix) if r['section']),
+            key=lambda x: x['section']
+        )
+
+        section_list = []
+        last_section = None
+        for resource in resource_list:
+            if resource['section'] != last_section:
+                section_list.append({
+                    'name': resource['section'],
+                    'resources': [],
+                })
+            section_list[-1]['resources'].append(resource)
+            last_section = resource['section']
+
+        return section_list
+
     def get_resources(self, prefix=''):
         urls = import_module('sentry.api.urls')
 
@@ -83,4 +102,5 @@ class ApiHelpIndexView(View):
             'methods': methods,
             'doc': docstring,
             'title': title,
+            'section': getattr(callback, 'doc_section', None),
         }
diff --git a/src/sentry/templates/sentry/help/api_index.html b/src/sentry/templates/sentry/help/api_index.html
index 534b16c7c6..75008b6851 100644
--- a/src/sentry/templates/sentry/help/api_index.html
+++ b/src/sentry/templates/sentry/help/api_index.html
@@ -36,27 +36,25 @@
     id: "4"
 }]</pre>
 
-    <br>
-
-    <h2>Resources</h2>
-
-    <div class="list-group">
-        {% for resource in resource_list %}
-            <a href="#" class="list-group-item">
-                <div class="pull-right">
-                    {{ resource.path }}
-                </div>
-                <h4>{{ resource.title }}</h4>
-                {% if resource.doc %}
-                    {{ resource.doc|linebreaks }}
-                {% endif %}
-                {% for method in resource.methods %}
-                    <h5>{{ method.name.upper }}</h5>
-                    {% if method.doc %}
-                        {{ method.doc|linebreaks }}
+
+    {% for section in section_list %}
+        <br>
+        <h3>{{ section.name }}</h3>
+        <div class="list-group">
+            {% for resource in section.resources %}
+                <a href="#" class="list-group-item">
+                    <h4>{{ resource.path }}</h4>
+                    {% if resource.doc %}
+                        {{ resource.doc|linebreaks }}
                     {% endif %}
-                {% endfor %}
-            </a>
-        {% endfor %}
-    </div>
+                    {% for method in resource.methods %}
+                        <h5>{{ method.name.upper }}</h5>
+                        {% if method.doc %}
+                            {{ method.doc|linebreaks }}
+                        {% endif %}
+                    {% endfor %}
+                </a>
+            {% endfor %}
+        </div>
+    {% endfor %}
 {% endblock %}
