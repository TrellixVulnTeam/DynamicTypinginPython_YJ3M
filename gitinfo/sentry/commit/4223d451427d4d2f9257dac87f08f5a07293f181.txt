commit 4223d451427d4d2f9257dac87f08f5a07293f181
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Fri Apr 24 08:59:20 2020 -0700

    fix(ui): Stop polling in `<EventWaiter>` on 404s (#17994)
    
    If a user changes/removes an org or project (or its slug), it will cause this to 404. This can result in hundreds of events an hour. This PR will stop it from polling but it would be great to have a better UX around this case.

diff --git a/src/sentry/static/sentry/app/utils/eventWaiter.tsx b/src/sentry/static/sentry/app/utils/eventWaiter.tsx
index 581170fa5b..bb44435041 100644
--- a/src/sentry/static/sentry/app/utils/eventWaiter.tsx
+++ b/src/sentry/static/sentry/app/utils/eventWaiter.tsx
@@ -1,3 +1,4 @@
+import * as Sentry from '@sentry/browser';
 import React from 'react';
 
 import {analytics} from 'app/utils/analytics';
@@ -61,10 +62,32 @@ class EventWaiter extends React.Component<Props, State> {
 
   pollHandler = async () => {
     const {api, organization, project, onIssueRecieved} = this.props;
-
-    const {firstEvent} = await api.requestPromise(
-      `/projects/${organization.slug}/${project.slug}/`
-    );
+    let firstEvent = null;
+
+    try {
+      const resp = await api.requestPromise(
+        `/projects/${organization.slug}/${project.slug}/`
+      );
+      firstEvent = resp.firstEvent;
+    } catch (resp) {
+      if (!resp) {
+        return;
+      }
+
+      // This means org or project does not exist, we need to stop polling
+      // Also stop polling on auth-related errors (403/401)
+      if ([404, 403, 401].includes(resp.status)) {
+        // TODO: Add some UX around this... redirect? error message?
+        this.stopPolling();
+        return;
+      }
+
+      Sentry.setExtras({
+        status: resp.status,
+        detail: resp.responseJSON?.detail,
+      });
+      Sentry.captureException(new Error('Error polling for first event'));
+    }
 
     if (firstEvent === null) {
       return;
