commit 3d1654755f183537277e7deff2b846656daddea3
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Tue Jun 14 15:45:04 2016 -0700

    Always set security headers (#3487)

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 22be564c07..869d509905 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -195,6 +195,7 @@ TEMPLATE_LOADERS = (
 
 MIDDLEWARE_CLASSES = (
     'sentry.middleware.proxy.ContentLengthHeaderMiddleware',
+    'sentry.middleware.security.SecurityHeadersMiddleware',
     'sentry.middleware.maintenance.ServicesUnavailableMiddleware',
     'sentry.middleware.env.SentryEnvMiddleware',
     'sentry.middleware.proxy.SetRemoteAddrFromForwardedFor',
diff --git a/src/sentry/middleware/security.py b/src/sentry/middleware/security.py
new file mode 100644
index 0000000000..1e813c4ae2
--- /dev/null
+++ b/src/sentry/middleware/security.py
@@ -0,0 +1,16 @@
+from __future__ import absolute_import
+
+
+class SecurityHeadersMiddleware(object):
+    """
+    Ensure that we have proper security headers set
+    """
+    def process_response(self, request, response):
+        # NOTE: there is no `response.setdefault()`
+        if 'X-Frame-Options' not in response:
+            response['X-Frame-Options'] = 'deny'
+        if 'X-Content-Type-Options' not in response:
+            response['X-Content-Type-Options'] = 'nosniff'
+        if 'X-XSS-Protection' not in response:
+            response['X-XSS-Protection'] = '1; mode=block'
+        return response
