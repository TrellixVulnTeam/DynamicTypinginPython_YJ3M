commit 680ce44cefe8f5f2e82447e06320ee6f6c0ea846
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Jan 2 11:06:06 2015 -0800

    Default version queries for Plugins

diff --git a/src/sentry/plugins/base/__init__.py b/src/sentry/plugins/base/__init__.py
index bc6ce6faaf..3035118d19 100644
--- a/src/sentry/plugins/base/__init__.py
+++ b/src/sentry/plugins/base/__init__.py
@@ -8,6 +8,7 @@ sentry.plugins.base
 from __future__ import absolute_import, print_function
 
 from sentry.plugins.base.manager import PluginManager
+from sentry.plugins.base.notifier import *  # NOQA
 from sentry.plugins.base.response import *  # NOQA
 from sentry.plugins.base.structs import *  # NOQA
 from sentry.plugins.base.v1 import *  # NOQA
diff --git a/src/sentry/plugins/base/manager.py b/src/sentry/plugins/base/manager.py
index 8136d38a23..7dd2eb4be4 100644
--- a/src/sentry/plugins/base/manager.py
+++ b/src/sentry/plugins/base/manager.py
@@ -22,7 +22,7 @@ class PluginManager(InstanceManager):
     def __len__(self):
         return sum(1 for i in self.all())
 
-    def all(self, version=None):
+    def all(self, version=1):
         for plugin in sorted(super(PluginManager, self).all(), key=lambda x: x.get_title()):
             if not plugin.is_enabled():
                 continue
@@ -30,13 +30,13 @@ class PluginManager(InstanceManager):
                 continue
             yield plugin
 
-    def for_project(self, project, version=None):
+    def for_project(self, project, version=1):
         for plugin in self.all(version=version):
             if not safe_execute(plugin.is_enabled, project):
                 continue
             yield plugin
 
-    def for_site(self, version=None):
+    def for_site(self, version=1):
         for plugin in self.all(version=version):
             if not plugin.has_site_conf():
                 continue
diff --git a/src/sentry/templatetags/sentry_plugins.py b/src/sentry/templatetags/sentry_plugins.py
index 9137292ad7..76ae684240 100644
--- a/src/sentry/templatetags/sentry_plugins.py
+++ b/src/sentry/templatetags/sentry_plugins.py
@@ -109,7 +109,7 @@ def handle_before_events(request, event_list):
 @register.filter
 def get_plugins(project):
     results = []
-    for plugin in plugins.for_project(project):
+    for plugin in plugins.for_project(project, version=None):
         if plugin.has_project_conf():
             results.append(plugin)
     return results
@@ -119,6 +119,6 @@ def get_plugins(project):
 def get_plugins_with_status(project):
     return [
         (plugin, safe_execute(plugin.is_enabled, project))
-        for plugin in plugins.all()
+        for plugin in plugins.all(version=None)
         if plugin.can_enable_for_projects()
     ]
diff --git a/src/sentry/web/frontend/admin.py b/src/sentry/web/frontend/admin.py
index 4245900fea..04681b5794 100644
--- a/src/sentry/web/frontend/admin.py
+++ b/src/sentry/web/frontend/admin.py
@@ -320,7 +320,10 @@ def status_packages(request):
 
     return render_to_response('sentry/admin/status/packages.html', {
         'modules': sorted([(p.project_name, p.version) for p in pkg_resources.working_set]),
-        'extensions': [(p.get_title(), '%s.%s' % (p.__module__, p.__class__.__name__)) for p in plugins.all()],
+        'extensions': [
+            (p.get_title(), '%s.%s' % (p.__module__, p.__class__.__name__))
+            for p in plugins.all(version=None)
+        ],
     }, request)
 
 
diff --git a/src/sentry/web/frontend/projects/plugins.py b/src/sentry/web/frontend/projects/plugins.py
index 5ab65c9130..84073456e2 100644
--- a/src/sentry/web/frontend/projects/plugins.py
+++ b/src/sentry/web/frontend/projects/plugins.py
@@ -29,7 +29,7 @@ def manage_plugins(request, organization, project):
 
     if request.POST:
         enabled = set(request.POST.getlist('plugin'))
-        for plugin in plugins.all():
+        for plugin in plugins.all(version=None):
             if plugin.can_enable_for_projects():
                 plugin.set_option('enabled', plugin.slug in enabled, project)
 
