commit effe098b703fc220f59954900b9af034552e766a
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Fri Jul 1 16:09:24 2016 +0300

    Fixed raw stacktaces not working in some situations

diff --git a/src/sentry/static/sentry/app/components/events/interfaces/rawStacktraceContent.jsx b/src/sentry/static/sentry/app/components/events/interfaces/rawStacktraceContent.jsx
index 9ac806b2ff..13612cee71 100644
--- a/src/sentry/static/sentry/app/components/events/interfaces/rawStacktraceContent.jsx
+++ b/src/sentry/static/sentry/app/components/events/interfaces/rawStacktraceContent.jsx
@@ -1,4 +1,5 @@
 import {defined, trim} from '../../../utils';
+import {trimPackage} from './frame';
 
 function getJavaScriptFrame(frame) {
   let result = '';
@@ -101,7 +102,7 @@ function ljust(str, len) {
 export function getCocoaFrame(frame) {
   let result = '  ';
   if (defined(frame.package)) {
-    result += ljust(frame.package, 20);
+    result += ljust(trimPackage(frame.package), 20);
   }
   if (defined(frame.instructionAddr)) {
     result += ljust(frame.instructionAddr, 12);
@@ -138,6 +139,9 @@ function getPreamble(exception, platform) {
 }
 
 function getFrame(frame, frameIdx, platform) {
+  if (frame.platform) {
+    platform = frame.platform;
+  }
   switch (platform) {
     case 'javascript':
       return getJavaScriptFrame(frame, frameIdx);
diff --git a/src/sentry/static/sentry/app/components/events/interfaces/stacktrace.jsx b/src/sentry/static/sentry/app/components/events/interfaces/stacktrace.jsx
index 23c5cad33a..65bb10a642 100644
--- a/src/sentry/static/sentry/app/components/events/interfaces/stacktrace.jsx
+++ b/src/sentry/static/sentry/app/components/events/interfaces/stacktrace.jsx
@@ -81,7 +81,7 @@ const StacktraceInterface = React.createClass({
           wrapTitle={false}>
         {stackView === 'raw' ?
           <pre className="traceback plain">
-            {rawStacktraceContent(data, this.props.platform)}
+            {rawStacktraceContent(data, evt.platform)}
           </pre>
         :
           <StacktraceContent
diff --git a/src/sentry/static/sentry/app/components/events/interfaces/threads.jsx b/src/sentry/static/sentry/app/components/events/interfaces/threads.jsx
index f0893c3ccd..d9fe92624c 100644
--- a/src/sentry/static/sentry/app/components/events/interfaces/threads.jsx
+++ b/src/sentry/static/sentry/app/components/events/interfaces/threads.jsx
@@ -97,7 +97,6 @@ const Thread = React.createClass({
   propTypes: {
     event: PropTypes.Event.isRequired,
     data: React.PropTypes.object.isRequired,
-    platform: React.PropTypes.string,
     stackView: React.PropTypes.string,
     newestFirst: React.PropTypes.bool,
     stacktrace: React.PropTypes.object,
@@ -137,7 +136,7 @@ const Thread = React.createClass({
           this.props.stackView === 'raw' ?
             <pre className="traceback plain">
               {rawStacktraceContent(
-                this.props.stacktrace, this.props.platform)}
+                this.props.stacktrace, this.props.event.platform)}
             </pre>
           :
             <StacktraceContent
