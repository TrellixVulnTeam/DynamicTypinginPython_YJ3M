commit 66db52468b2fc60be8a09c2ab118a64f96188645
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Wed May 4 11:21:18 2016 +0200

    Restrict the object_path index length for mysql
    
    This fixes #3173

diff --git a/src/sentry/migrations/0246_auto__add_dsymsymbol__add_unique_dsymsymbol_object_address__add_dsymsd.py b/src/sentry/migrations/0246_auto__add_dsymsymbol__add_unique_dsymsymbol_object_address__add_dsymsd.py
index e2086a7f4b..78ab05e1a5 100644
--- a/src/sentry/migrations/0246_auto__add_dsymsymbol__add_unique_dsymsymbol_object_address__add_dsymsd.py
+++ b/src/sentry/migrations/0246_auto__add_dsymsymbol__add_unique_dsymsymbol_object_address__add_dsymsd.py
@@ -3,6 +3,7 @@ from south.utils import datetime_utils as datetime
 from south.db import db
 from south.v2 import SchemaMigration
 from django.db import models
+from sentry.utils.db import is_mysql
 
 
 class Migration(SchemaMigration):
@@ -39,11 +40,22 @@ class Migration(SchemaMigration):
         db.create_table('sentry_dsymobject', (
             ('id', self.gf('sentry.db.models.fields.bounded.BoundedBigAutoField')(primary_key=True)),
             ('cpu_name', self.gf('django.db.models.fields.CharField')(max_length=40)),
-            ('object_path', self.gf('django.db.models.fields.TextField')(db_index=True)),
+            ('object_path', self.gf('django.db.models.fields.TextField')(db_index=not is_mysql())),
             ('uuid', self.gf('django.db.models.fields.CharField')(max_length=36, db_index=True)),
             ('vmaddr', self.gf('sentry.db.models.fields.bounded.BoundedBigIntegerField')(null=True)),
             ('vmsize', self.gf('sentry.db.models.fields.bounded.BoundedBigIntegerField')(null=True)),
         ))
+
+        # On MySQL we need to create the index here differently because
+        # the index must have a limit.  As we have the type already
+        # defined to text in the model earlier we just restrict the index
+        # to 255.  The hash matches what south would have created.
+        if is_mysql():
+            db.execute('''
+                create index sentry_dsymobject_39c06cbd
+                          on sentry_dsymobject (object_path(255))
+            ''')
+
         db.send_create_signal('sentry', ['DSymObject'])
 
         # Adding model 'DSymBundle'
@@ -627,4 +639,4 @@ class Migration(SchemaMigration):
         }
     }
 
-    complete_apps = ['sentry']
\ No newline at end of file
+    complete_apps = ['sentry']
