commit 7dd1cfd10f679f136bb9f1d5f94623d633afe495
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jan 11 18:34:13 2016 -0800

    Support routing in create_or_update transaction

diff --git a/src/sentry/db/models/query.py b/src/sentry/db/models/query.py
index 091c574308..8d3bb3cefc 100644
--- a/src/sentry/db/models/query.py
+++ b/src/sentry/db/models/query.py
@@ -85,7 +85,7 @@ def create_or_update(model, using=None, **kwargs):
             create_kwargs[k] = v
 
     try:
-        with transaction.atomic():
+        with transaction.atomic(using=using):
             return objects.create(**create_kwargs), True
     except IntegrityError:
         affected = objects.filter(**kwargs).update(**values)
