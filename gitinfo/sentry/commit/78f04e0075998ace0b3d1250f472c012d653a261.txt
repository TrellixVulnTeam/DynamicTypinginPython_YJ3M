commit 78f04e0075998ace0b3d1250f472c012d653a261
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Sep 30 11:45:41 2015 -0700

    Default culprit to URL (correctly)

diff --git a/src/sentry/event_manager.py b/src/sentry/event_manager.py
index 0b1bc15604..6ef201f35a 100644
--- a/src/sentry/event_manager.py
+++ b/src/sentry/event_manager.py
@@ -127,9 +127,11 @@ def generate_culprit(data):
         if 'sentry.interfaces.Stacktrace' in data:
             stacktraces = [data['sentry.interfaces.Stacktrace']]
         else:
-            return ''
+            stacktraces = None
 
     if not stacktraces:
+        if 'sentry.interfaces.Http' in data:
+            return data['sentry.interfaces.Http'].get('url') or ''
         return ''
 
     return truncatechars(
@@ -300,11 +302,6 @@ class EventManager(object):
             exception['values'][0]['stacktrace'] = stacktrace
             del data['sentry.interfaces.Stacktrace']
 
-        if 'sentry.interfaces.Http' in data:
-            # default the culprit to the url
-            if not data['culprit']:
-                data['culprit'] = data['sentry.interfaces.Http']['url']
-
         if data['time_spent']:
             data['time_spent'] = int(data['time_spent'])
 
@@ -319,8 +316,6 @@ class EventManager(object):
 
     @suppress_exceptions
     def save(self, project, raw=False):
-        # TODO: culprit should default to "most recent" frame in stacktraces when
-        # it's not provided.
         project = Project.objects.get_from_cache(id=project)
 
         data = self.data.copy()
