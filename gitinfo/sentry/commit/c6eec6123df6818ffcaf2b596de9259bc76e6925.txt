commit c6eec6123df6818ffcaf2b596de9259bc76e6925
Author: Ben Vinegar <ben@benv.ca>
Date:   Thu Jun 2 23:25:51 2016 -0700

    Fix bug where source map lookup fails for first line/col of minified file (#3393)

diff --git a/src/sentry/lang/javascript/sourcemaps.py b/src/sentry/lang/javascript/sourcemaps.py
index 8496b706a9..cb5920f22b 100644
--- a/src/sentry/lang/javascript/sourcemaps.py
+++ b/src/sentry/lang/javascript/sourcemaps.py
@@ -155,4 +155,5 @@ def sourcemap_to_index(sourcemap):
 def find_source(indexed_sourcemap, lineno, colno):
     # error says "line no 1, column no 56"
     assert lineno > 0, 'line numbers are 1-indexed'
-    return indexed_sourcemap.states[bisect.bisect_left(indexed_sourcemap.keys, (lineno - 1, colno)) - 1]
+
+    return indexed_sourcemap.states[bisect.bisect_right(indexed_sourcemap.keys, (lineno - 1, colno)) - 1]
diff --git a/tests/sentry/lang/javascript/test_sourcemaps.py b/tests/sentry/lang/javascript/test_sourcemaps.py
index 0994de57bc..551fc4c562 100644
--- a/tests/sentry/lang/javascript/test_sourcemaps.py
+++ b/tests/sentry/lang/javascript/test_sourcemaps.py
@@ -34,9 +34,24 @@ class FindSourceTest(TestCase):
         indexed_sourcemap = sourcemap_to_index(sourcemap)
 
         result = find_source(indexed_sourcemap, 1, 56)
-
         assert result == SourceMap(dst_line=0, dst_col=50, src='foo/file2.js', src_line=0, src_col=9, name='multiply')
 
+        # Start of minified file (exact match first line/col tuple)
+        result = find_source(indexed_sourcemap, 1, 0)
+        assert result == SourceMap(dst_line=0, dst_col=0, src='foo/file1.js', src_line=0, src_col=0, name=None)
+
+        # Last character in mapping
+        result = find_source(indexed_sourcemap, 1, 36)
+        assert result == SourceMap(dst_line=0, dst_col=30, src='foo/file1.js', src_line=2, src_col=1, name=None)
+
+        # First character in mapping (exact match line/col tuple)
+        result = find_source(indexed_sourcemap, 1, 37)
+        assert result == SourceMap(dst_line=0, dst_col=37, src='foo/file1.js', src_line=2, src_col=8, name='a')
+
+        # End of minified file (character *beyond* last line/col tuple)
+        result = find_source(indexed_sourcemap, 1, 192)
+        assert result == SourceMap(dst_line=0, dst_col=191, src='foo/file2.js', src_line=9, src_col=25, name='e')
+
 
 class ParseSourcemapTest(TestCase):
     def test_basic(self):
