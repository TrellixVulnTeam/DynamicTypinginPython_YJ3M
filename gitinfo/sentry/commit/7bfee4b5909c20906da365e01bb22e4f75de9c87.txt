commit 7bfee4b5909c20906da365e01bb22e4f75de9c87
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Wed Jun 13 10:05:16 2018 -0700

    build(js): Add eslint as a formatter (#8463)
    
    Previously, it would run prettier as a formatter, and then eslint as a linter (while additionally running `--fix`). It would not ask you to stage the formatted changes because it was in the "linting" stage. Move eslint to the formatting stage, and skip running it during "lint" phase if the `format` option is true

diff --git a/src/sentry/lint/engine.py b/src/sentry/lint/engine.py
index c696d94bc5..a4ddbdf884 100644
--- a/src/sentry/lint/engine.py
+++ b/src/sentry/lint/engine.py
@@ -231,6 +231,27 @@ def is_prettier_valid(project_root, prettier_path):
     return True
 
 
+def js_lint_format(file_list=None):
+    """
+    We only format JavaScript code as part of this pre-commit hook. It is not part
+    of the lint engine. This uses eslint's `--fix` formatting feature.
+    """
+    eslint_path = get_node_modules_bin('eslint')
+
+    if not os.path.exists(eslint_path):
+        from click import echo
+        echo('!! Skipping JavaScript linting and formatting because eslint is not installed.')
+        return False
+
+    js_file_list = get_js_files(file_list)
+
+    # manually exclude some bad files
+    js_file_list = [x for x in js_file_list if '/javascript/example-project/' not in x]
+
+    return run_formatter([eslint_path, '--fix', ],
+                         js_file_list)
+
+
 def js_format(file_list=None):
     """
     We only format JavaScript code as part of this pre-commit hook. It is not part
@@ -367,6 +388,8 @@ def run(file_list=None, format=True, lint=True, js=True, py=True,
             if py:
                 results.append(py_format(file_list))
             if js:
+                # run eslint with --fix and skip these linters down below
+                results.append(js_lint_format(file_list))
                 results.append(js_format(file_list))
             if less:
                 results.append(less_format(file_list))
@@ -379,9 +402,13 @@ def run(file_list=None, format=True, lint=True, js=True, py=True,
             if py:
                 results.append(py_lint(file_list, parseable=parseable))
             if js:
-                results.append(js_lint(file_list, parseable=parseable, format=format))
+                # stylelint `--fix` doesn't work well
                 results.append(js_stylelint(file_list, parseable=parseable, format=format))
 
+                if not format:
+                    # these tasks are called when we need to format, so skip it here
+                    results.append(js_lint(file_list, parseable=parseable, format=format))
+
         if test:
             if js:
                 results.append(js_test(file_list))
