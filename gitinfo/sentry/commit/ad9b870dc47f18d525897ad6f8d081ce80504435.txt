commit ad9b870dc47f18d525897ad6f8d081ce80504435
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Sep 30 11:13:23 2016 -0700

    [rules] expand frequency tests

diff --git a/tests/sentry/rules/test_processor.py b/tests/sentry/rules/test_processor.py
index 7abba69c31..7df4a68d0a 100644
--- a/tests/sentry/rules/test_processor.py
+++ b/tests/sentry/rules/test_processor.py
@@ -2,7 +2,10 @@
 
 from __future__ import absolute_import
 
-from sentry.models import Rule
+from datetime import timedelta
+from django.utils import timezone
+
+from sentry.models import GroupRuleStatus, Rule
 from sentry.plugins import plugins
 from sentry.testutils import TestCase
 from sentry.rules.processor import EventCompatibilityProxy, RuleProcessor
@@ -38,10 +41,19 @@ class RuleProcessorTest(TestCase):
         assert futures[0].rule == rule
         assert futures[0].kwargs == {}
 
-        # should not apply twice due to 30m default frequency
+        # should not apply twice due to default frequency
         results = list(rp.apply())
         assert len(results) == 0
 
+        # now ensure that moving the last update backwards
+        # in time causes the rule to trigger again
+        GroupRuleStatus.objects.filter(rule=rule).update(
+            last_active=timezone.now() - timedelta(minutes=Rule.DEFAULT_FREQUENCY + 1),
+        )
+
+        results = list(rp.apply())
+        assert len(results) == 1
+
 
 class EventCompatibilityProxyTest(TestCase):
     def test_simple(self):
