commit a38bffc10ce3e7c6541bc3cc7040ff89e96fe93b
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Fri Jan 11 13:34:50 2019 -0800

    ref(app): Consolidate runtime publicpath setup logic (#11478)

diff --git a/src/sentry/static/sentry/app/index.js b/src/sentry/static/sentry/app/index.js
index c40301331e..4cef00f855 100644
--- a/src/sentry/static/sentry/app/index.js
+++ b/src/sentry/static/sentry/app/index.js
@@ -4,6 +4,7 @@ import 'bootstrap/js/alert';
 import 'bootstrap/js/tab';
 import 'bootstrap/js/dropdown';
 
+import 'app/utils/statics-setup';
 import 'app/utils/emotion-setup';
 
 import {renderToStaticMarkup} from 'react-dom/server';
diff --git a/src/sentry/static/sentry/app/utils/statics-setup.js b/src/sentry/static/sentry/app/utils/statics-setup.js
new file mode 100644
index 0000000000..7458132d13
--- /dev/null
+++ b/src/sentry/static/sentry/app/utils/statics-setup.js
@@ -0,0 +1,12 @@
+/* eslint no-native-reassign:0 */
+/* global __webpack_public_path__ */
+
+/**
+ * Set the webpack public path at runtime. The __sentryGlobalStaticPrefix will
+ * be declared in layout.html.
+ *
+ * NOTE: This MUST be loaded before any other app modules in the entrypoint.
+ */
+if (window.__sentryGlobalStaticPrefix) {
+  __webpack_public_path__ = window.__sentryGlobalStaticPrefix;
+}
diff --git a/src/sentry/static/sentry/app/views/app.jsx b/src/sentry/static/sentry/app/views/app.jsx
index 542c549be5..919affd6a0 100644
--- a/src/sentry/static/sentry/app/views/app.jsx
+++ b/src/sentry/static/sentry/app/views/app.jsx
@@ -1,5 +1,3 @@
-/*global __webpack_public_path__ */
-/*eslint no-native-reassign:0 */
 import $ from 'jquery';
 import {ThemeProvider} from 'emotion-theming';
 import Cookies from 'js-cookie';
@@ -25,8 +23,6 @@ import NewsletterConsent from 'app/views/newsletterConsent';
 import OrganizationsStore from 'app/stores/organizationsStore';
 import theme from 'app/utils/theme';
 
-if (window.globalStaticUrl) __webpack_public_path__ = window.globalStaticUrl; // defined in layout.html
-
 function getAlertTypeForProblem(problem) {
   switch (problem.severity) {
     case 'critical':
diff --git a/src/sentry/templates/sentry/layout.html b/src/sentry/templates/sentry/layout.html
index 36f3c9d519..a45d41e611 100644
--- a/src/sentry/templates/sentry/layout.html
+++ b/src/sentry/templates/sentry/layout.html
@@ -35,7 +35,7 @@
 
   <script>
     window.csrfCookieName = '{{ CSRF_COOKIE_NAME }}';
-    window.globalStaticUrl = '{% asset_url "sentry" "dist/" %}';
+    window.__sentryGlobalStaticPrefix = '{% asset_url "sentry" "dist/" %}';
     window.__initialData = {% get_react_config %};
     window.__languageCode = {{ request.LANGUAGE_CODE|to_json|safe }};
   </script>
