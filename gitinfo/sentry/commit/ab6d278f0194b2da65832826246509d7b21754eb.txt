commit ab6d278f0194b2da65832826246509d7b21754eb
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jul 23 14:28:10 2014 +0200

    Initial basic (awful) auto API docs

diff --git a/src/sentry/api/endpoints/auth_index.py b/src/sentry/api/endpoints/auth_index.py
index 96df391f06..542d176c65 100644
--- a/src/sentry/api/endpoints/auth_index.py
+++ b/src/sentry/api/endpoints/auth_index.py
@@ -9,6 +9,9 @@ class AuthIndexEndpoint(Endpoint):
     authentication_classes = [QuietBasicAuthentication]
 
     def post(self, request):
+        """
+        Authenticate a user using the provided credentials (i.e. basic auth).
+        """
         if not request.user.is_authenticated():
             return Response(status=400)
 
@@ -22,5 +25,8 @@ class AuthIndexEndpoint(Endpoint):
         return response
 
     def delete(self, request, *args, **kwargs):
+        """
+        Logout the authenticated user.
+        """
         logout(request._request)
         return Response(status=204)
diff --git a/src/sentry/api/endpoints/catchall.py b/src/sentry/api/endpoints/catchall.py
index a994641aa1..be2936fac4 100644
--- a/src/sentry/api/endpoints/catchall.py
+++ b/src/sentry/api/endpoints/catchall.py
@@ -1,11 +1,10 @@
-from rest_framework.response import Response
+from django.http import HttpResponse
+from django.views.generic import View
 
-from sentry.api.base import Endpoint
 
-
-class CatchallEndpoint(Endpoint):
+class CatchallEndpoint(View):
     def get(self, request):
-        return Response(status=404)
+        return HttpResponse(status=404)
 
     post = get
     put = get
diff --git a/src/sentry/api/urls.py b/src/sentry/api/urls.py
index b9848545aa..9608c10adb 100644
--- a/src/sentry/api/urls.py
+++ b/src/sentry/api/urls.py
@@ -25,11 +25,15 @@ from .endpoints.team_project_index import TeamProjectIndexEndpoint
 from .endpoints.team_member_index import TeamMemberIndexEndpoint
 from .endpoints.team_stats import TeamStatsEndpoint
 from .endpoints.user_details import UserDetailsEndpoint
+from .views.help_index import ApiHelpIndexView
 
 
 urlpatterns = patterns(
     '',
 
+    url(r'^$', ApiHelpIndexView.as_view(),
+        name='sentry-api-0'),
+
     # Auth
     url(r'^auth/$',
         AuthIndexEndpoint.as_view(),
diff --git a/src/sentry/api/views/__init__.py b/src/sentry/api/views/__init__.py
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/src/sentry/api/views/help_index.py b/src/sentry/api/views/help_index.py
new file mode 100644
index 0000000000..3ff15dfbb4
--- /dev/null
+++ b/src/sentry/api/views/help_index.py
@@ -0,0 +1,71 @@
+from django.contrib.admindocs.views import simplify_regex
+from django.utils.importlib import import_module
+from django.views.generic import View
+
+from sentry.api.base import Endpoint
+from sentry.web.helpers import render_to_response
+
+METHODS = ('get', 'post', 'delete', 'patch')
+
+
+class ApiHelpIndexView(View):
+
+    def get(self, request):
+        prefix = '/api/0/'
+
+        context = {
+            'resource_list': self.get_resources(prefix),
+        }
+
+        return render_to_response('sentry/help/api_index.html', context, request)
+
+    def get_resources(self, prefix=''):
+        urls = import_module('sentry.api.urls')
+
+        resources = []
+        for pattern in urls.urlpatterns:
+            data = self.__get_resource_data(pattern, prefix)
+            if data is None:
+                continue
+            resources.append(data)
+        return sorted(resources, key=lambda x: x['path'])
+
+    def __strip_doc(self, doc):
+        return doc.strip()
+
+    def __get_resource_data(self, pattern, prefix):
+        if not hasattr(pattern, 'callback'):
+            return
+
+        if hasattr(pattern.callback, 'cls'):
+            callback = pattern.callback.cls
+
+            if not issubclass(callback, Endpoint):
+                return
+        elif hasattr(pattern.callback, 'cls_instance'):
+            callback = pattern.callback.cls_instance
+
+            if not isinstance(callback, Endpoint):
+                return
+        else:
+            return
+
+        path = simplify_regex(prefix + pattern.regex.pattern)
+
+        path = path.replace('<', '{').replace('>', '}')
+
+        methods = []
+        for method_name in METHODS:
+            method = getattr(callback, method_name, None)
+            if method is None:
+                continue
+            methods.append({
+                'name': method_name,
+                'doc': self.__strip_doc(method.__doc__ or ''),
+            })
+
+        return {
+            'path': path,
+            'doc': self.__strip_doc(callback.__doc__ or ''),
+            'methods': methods,
+        }
diff --git a/src/sentry/templates/sentry/help/api_index.html b/src/sentry/templates/sentry/help/api_index.html
new file mode 100644
index 0000000000..07d7cafcb8
--- /dev/null
+++ b/src/sentry/templates/sentry/help/api_index.html
@@ -0,0 +1,21 @@
+{% extends "sentry/bases/modal.html" %}
+
+{% load i18n %}
+{% load sentry_helpers %}
+
+{% block content %}
+    <h2>Web API</h2>
+
+    <ul>
+        {% for resource in resource_list %}
+            {% for method in resource.methods %}
+                <li>
+                    <h3>{{ method.name.upper }} {{ resource.path }}</h3>
+                    {% if method.doc %}
+                        <pre>{{ method.doc }}</pre>
+                    {% endif %}
+                </li>
+            {% endfor %}
+        {% endfor %}
+    </ul>
+{% endblock %}
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index 0a0796cb71..1f9b9e87f3 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -15,7 +15,7 @@ except ImportError:
     from django.conf.urls.defaults import include, patterns, url  # NOQA
 
 from django.conf import settings
-from django.views.generic import TemplateView
+from django.views.generic import RedirectView, TemplateView
 
 from sentry.web import api
 from sentry.web.frontend import (
@@ -74,6 +74,7 @@ urlpatterns += patterns('',
         name='sentry-partial-media'),
 
     # API
+    url(r'^api/$', RedirectView.as_view(url='0/')),
     url(r'^api/0/', include('sentry.api.urls')),
 
     # Account
