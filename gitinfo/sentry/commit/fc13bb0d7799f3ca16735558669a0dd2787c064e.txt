commit fc13bb0d7799f3ca16735558669a0dd2787c064e
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Wed Oct 7 03:06:11 2015 -0700

    Make full use of parallelizing tests

diff --git a/.travis.yml b/.travis.yml
index 60fb318758..9396183a2f 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -16,24 +16,18 @@ cache:
     - "$HOME/virtualenv/python2.7.9"
 env:
   matrix:
-    - DB=sqlite
-    - DB=mysql
-    - DB=postgres
+    - TEST_SUITE=sqlite
+    - TEST_SUITE=mysql
+    - TEST_SUITE=postgres
+    - TEST_SUITE=js
+    - TEST_SUITE=cli
   global:
     - SENTRY_LIGHT_BUILD=1
     - SKIP_BACKEND_VALIDATION=1
 install:
-  - python -m pip install --upgrade pip==7.1.2
-  - time make develop dev-postgres dev-mysql
-before_script:
-  - mysql -e 'create database sentry;'
-  - psql -c 'create database sentry;' -U postgres
-  - "echo \"create keyspace sentry with replication = {'class' : 'SimpleStrategy', 'replication_factor': 1};\" | cqlsh --cqlversion=3.0.3"
-  - echo 'create table nodestore (key text primary key, value blob, flags int);' | cqlsh -k sentry --cqlversion=3.0.3
+  - make travis-install-$TEST_SUITE
 script:
-  - make lint
-  - make test-js
-  - coverage run --source=src/sentry -m py.test tests
-  - make test-cli
+  - make lint-$TEST_SUITE
+  - make test-$TEST_SUITE
 after_success:
-  - codecov -e DB
+  - codecov -e TEST_SUITE
diff --git a/Makefile b/Makefile
index 01bcf9b91c..b62bc9f0ee 100644
--- a/Makefile
+++ b/Makefile
@@ -89,6 +89,15 @@ test-python:
 	py.test tests || exit 1
 	@echo ""
 
+travis-test-python:
+	@echo "--> Running Python tests"
+	coverage run --source=src/sentry -m py.test tests
+	@echo ""
+
+test-postgres: travis-test-python
+test-mysql: travis-test-python
+test-sqlite: travis-test-python
+
 lint:
 	@echo "--> Linting all the things"
 	bin/lint src/sentry tests
@@ -96,8 +105,13 @@ lint:
 
 # These are just aliases for backwards compat
 # our linter does both now
+lint-sqlite: lint-python
+lint-mysql: lint-python
+lint-postgres: lint-python
 lint-python: lint
 lint-js: lint
+lint-cli:
+	@echo "Nothing to lint :("
 
 coverage: develop
 	coverage run --source=src/sentry -m py.test
@@ -113,4 +127,24 @@ extract-api-docs:
 	rm -rf api-docs/cache/*
 	cd api-docs; python generator.py
 
+travis-install-cassandra:
+	echo "create keyspace sentry with replication = {'class' : 'SimpleStrategy', 'replication_factor': 1};" | cqlsh --cqlversion=3.0.3
+	echo 'create table nodestore (key text primary key, value blob, flags int);' | cqlsh -k sentry --cqlversion=3.0.3
+
+travis-install-python: travis-install-cassandra
+	python -m pip install --upgrade pip==7.1.2
+
+travis-install-sqlite: travis-install-python
+
+travis-install-postgres: travis-install-python dev-postgres
+	psql -c 'create database sentry;' -U postgres
+
+travis-install-mysql: travis-install-python dev-mysql
+	mysql -e 'create database sentry;'
+
+travis-install-js:
+	npm install
+
+travis-install-cli: travis-install-python develop
+
 .PHONY: develop dev-postgres dev-mysql dev-docs setup-git build clean locale update-transifex update-submodules test testloop test-cli test-js test-python lint lint-python lint-js coverage run-uwsgi publish
