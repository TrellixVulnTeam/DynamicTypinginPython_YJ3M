commit 2b97df098a07e562cb1721d9aa944a59f2c0b80c
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Jan 5 22:14:43 2013 -0800

    Allow team and project owners to change ownership

diff --git a/src/sentry/templates/sentry/projects/team.html b/src/sentry/templates/sentry/projects/team.html
index f7877a7ab2..67ba6cc427 100644
--- a/src/sentry/templates/sentry/projects/team.html
+++ b/src/sentry/templates/sentry/projects/team.html
@@ -19,9 +19,11 @@
         {% endif %}
         <h2>
             {% trans "Manage Team" %}
-            <small><a href="{% url sentry-manage-team team.slug %}">{{ team.name }}</a></small>
+            <small>{{ team.name }}</small>
         </h2>
     </div>
+    <p>To change other settings for this team, visit the  <a href="{% url sentry-manage-team team.slug %}">team management page for {{ team.name }}</a>.</p>
+    <br>
     <table class="table table-bordered table-striped">
         <colgroup>
             <col/>
diff --git a/src/sentry/web/forms/teams.py b/src/sentry/web/forms/teams.py
index ef2bc9e3d2..c2b88a124c 100644
--- a/src/sentry/web/forms/teams.py
+++ b/src/sentry/web/forms/teams.py
@@ -40,7 +40,7 @@ class EditTeamForm(forms.ModelForm):
 
 
 class EditTeamAdminForm(EditTeamForm):
-    owner = UserField(required=False)
+    owner = UserField(required=True)
 
     class Meta:
         fields = ('name', 'owner',)
diff --git a/src/sentry/web/frontend/projects.py b/src/sentry/web/frontend/projects.py
index 43561d3204..801782fa30 100644
--- a/src/sentry/web/frontend/projects.py
+++ b/src/sentry/web/frontend/projects.py
@@ -173,7 +173,9 @@ def manage_project(request, project):
     # XXX: We probably shouldnt allow changing the team unless they're the project owner
     team_list = Team.objects.get_for_user(project.owner or request.user, MEMBER_OWNER)
 
-    if request.user.has_perm('sentry.can_change_project'):
+    can_admin_project = request.user == project.owner or request.user.has_perm('sentry.can_change_project')
+
+    if can_admin_project:
         form_cls = EditProjectAdminForm
     else:
         form_cls = EditProjectForm
diff --git a/src/sentry/web/frontend/teams.py b/src/sentry/web/frontend/teams.py
index 9d03802e58..fa725c8df8 100644
--- a/src/sentry/web/frontend/teams.py
+++ b/src/sentry/web/frontend/teams.py
@@ -66,7 +66,9 @@ def manage_team(request, team):
     if result is False and not request.user.has_perm('sentry.can_change_team'):
         return HttpResponseRedirect(reverse('sentry'))
 
-    if request.user.has_perm('sentry.can_add_team'):
+    can_admin_team = request.user == team.owner or request.user.has_perm('sentry.can_add_team')
+
+    if can_admin_team:
         form_cls = EditTeamAdminForm
     else:
         form_cls = EditTeamForm
diff --git a/tests/sentry/web/frontend/teams/tests.py b/tests/sentry/web/frontend/teams/tests.py
index d0a8d9ca83..2f7cc33f41 100644
--- a/tests/sentry/web/frontend/teams/tests.py
+++ b/tests/sentry/web/frontend/teams/tests.py
@@ -112,6 +112,7 @@ class ManageTeamTest(BaseTeamTest):
         path = reverse('sentry-manage-team', args=[self.team.slug])
         resp = self.client.post(path, {
             'name': 'bar',
+            'owner': self.team.owner.username,
         })
         self.assertNotEquals(resp.status_code, 200)
         self.assertEquals(resp['Location'], 'http://testserver' + path + '?success=1')
