commit 9331c7a33991f251a60c171ec40d294bd1c19e78
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Tue Jan 23 10:29:47 2018 -0800

    feat(ui+api): Move "Account Subscriptions" to React (#6909)

diff --git a/src/sentry/api/endpoints/user_subscriptions.py b/src/sentry/api/endpoints/user_subscriptions.py
new file mode 100644
index 0000000000..65f9c48067
--- /dev/null
+++ b/src/sentry/api/endpoints/user_subscriptions.py
@@ -0,0 +1,79 @@
+from __future__ import absolute_import
+
+from django.utils import timezone
+from rest_framework.response import Response
+from rest_framework import status
+
+from sentry.app import newsletter
+from sentry.api.bases.user import UserEndpoint
+from sentry.models import UserEmail
+
+
+class UserSubscriptionsEndpoint(UserEndpoint):
+    def get(self, request, user):
+        """
+        Retrieve Account Subscriptions
+        `````````````````````````````````````
+
+        Return list of subscriptions for an account
+
+        :auth: required
+        """
+
+        # This returns a dict with `subscriber` and `subscriptions`
+        # Returns `None` if no subscriptions for user
+        sub = newsletter.get_subscriptions(user)
+
+        if sub is None or not newsletter.is_enabled:
+            return Response([])
+
+        try:
+            return Response([{
+                'listId': x['list_id'],
+                'listDescription': x['list_description'],
+                'listName': x['list_name'],
+                'email': x['email'],
+                'subscribed': x['subscribed'],
+                'subscribedDate': x['subscribed_date'],
+                'unsubscribedDate': x['unsubscribed_date'],
+            } for x in sub['subscriptions']])
+        except KeyError:
+            return Response([])
+
+    def put(self, request, user):
+        """
+        Update Account Subscriptionsoptions
+        `````````````````````````````````
+
+        Update account subscriptions to newsletter
+
+        :param int listId: id of newsletter list
+        :param boolean subscribed: should be subscribed to newsletter
+        :auth: required
+        """
+
+        email = UserEmail.get_primary_email(user)
+
+        # Can't handle subscriptions without a verified email
+        if not email.is_verified:
+            return Response({'details': 'Must have verified email to subscribe to newsletter.'},
+                            status=status.HTTP_400_BAD_REQUEST)
+
+        subscribed = request.DATA.get('subscribed')
+        try:
+            list_id = int(request.DATA.get('listId', ''))
+        except ValueError:
+            return Response(status=status.HTTP_400_BAD_REQUEST)
+
+        kwargs = {
+            'list_id': list_id,
+            'subscribed': subscribed,
+            'verified': email.is_verified,
+        }
+        if not subscribed:
+            kwargs['unsubscribed_date'] = timezone.now()
+        else:
+            kwargs['subscribed_date'] = timezone.now()
+
+        newsletter.create_or_update_subscription(user, **kwargs)
+        return Response(status=status.HTTP_204_NO_CONTENT)
diff --git a/src/sentry/api/urls.py b/src/sentry/api/urls.py
index aea01960f2..c838ecef29 100644
--- a/src/sentry/api/urls.py
+++ b/src/sentry/api/urls.py
@@ -139,6 +139,7 @@ from .endpoints.user_organizations import UserOrganizationsEndpoint
 from .endpoints.user_notification_details import UserNotificationDetailsEndpoint
 from .endpoints.user_social_identities_index import UserSocialIdentitiesIndexEndpoint
 from .endpoints.user_social_identity_details import UserSocialIdentityDetailsEndpoint
+from .endpoints.user_subscriptions import UserSubscriptionsEndpoint
 from .endpoints.event_file_committers import EventFileCommittersEndpoint
 from .endpoints.setup_wizard import SetupWizard
 
@@ -230,6 +231,11 @@ urlpatterns = patterns(
         r'^users/(?P<user_id>[^\/]+)/social-identities/(?P<identity_id>[^\/]+)/$',
         UserSocialIdentityDetailsEndpoint.as_view(),
         name='sentry-api-0-user-social-identity-details'),
+    url(
+        r'^users/(?P<user_id>[^\/]+)/subscriptions/$',
+        UserSubscriptionsEndpoint.as_view(),
+        name='sentry-api-0-user-subscriptions'
+    ),
 
     # Organizations
     url(
diff --git a/src/sentry/static/sentry/app/components/dateTime.jsx b/src/sentry/static/sentry/app/components/dateTime.jsx
index 326339281d..277c646bf0 100644
--- a/src/sentry/static/sentry/app/components/dateTime.jsx
+++ b/src/sentry/static/sentry/app/components/dateTime.jsx
@@ -9,6 +9,7 @@ class DateTime extends React.Component {
   static propTypes = {
     date: PropTypes.any.isRequired,
     dateOnly: PropTypes.bool,
+    shortDate: PropTypes.bool,
     seconds: PropTypes.bool,
   };
 
@@ -17,13 +18,17 @@ class DateTime extends React.Component {
   };
 
   getFormat = ({clock24Hours}) => {
-    let {dateOnly, seconds} = this.props;
+    let {dateOnly, seconds, shortDate} = this.props;
 
     // October 26, 2017
     if (dateOnly) {
       return 'LL';
     }
 
+    if (shortDate) {
+      return 'MM/DD/YYYY';
+    }
+
     if (clock24Hours) {
       return 'MMMM D YYYY HH:mm:ss z';
     }
@@ -42,6 +47,8 @@ class DateTime extends React.Component {
       date,
       // eslint-disable-next-line no-unused-vars
       seconds,
+      // eslint-disable-next-line no-unused-vars
+      shortDate,
       ...carriedProps
     } = this.props;
     let user = ConfigStore.get('user');
diff --git a/src/sentry/static/sentry/app/components/switch.jsx b/src/sentry/static/sentry/app/components/switch.jsx
index d1cb4f19f0..65fdfb4d4a 100644
--- a/src/sentry/static/sentry/app/components/switch.jsx
+++ b/src/sentry/static/sentry/app/components/switch.jsx
@@ -5,7 +5,7 @@ import classNames from 'classnames';
 class Switch extends React.Component {
   static propTypes = {
     id: PropTypes.string,
-    size: PropTypes.string,
+    size: PropTypes.oneOf(['sm', 'lg']).isRequired,
     isActive: PropTypes.bool,
     isLoading: PropTypes.bool,
     isDisabled: PropTypes.bool,
diff --git a/src/sentry/static/sentry/app/routes.jsx b/src/sentry/static/sentry/app/routes.jsx
index 620e834784..e4d01b11d8 100644
--- a/src/sentry/static/sentry/app/routes.jsx
+++ b/src/sentry/static/sentry/app/routes.jsx
@@ -154,14 +154,24 @@ const accountSettingsRoutes = [
     key="appearance/"
     path="appearance/"
     name="Appearance"
-    componentPromise={() => import('./views/settings/account/accountAppearance')}
+    componentPromise={() =>
+      import(/*webpackChunkName: "AccountAppearance"*/ './views/settings/account/accountAppearance')}
     component={errorHandler(LazyLoad)}
   />,
 
   <Route
     key="authorizations/"
     path="authorizations/"
-    componentPromise={() => import('./views/settings/account/accountAuthorizations')}
+    componentPromise={() =>
+      import(/*webpackChunkName: "AccountAuthorizations"*/ './views/settings/account/accountAuthorizations')}
+    component={errorHandler(LazyLoad)}
+  />,
+  <Route
+    key="subscriptions/"
+    path="subscriptions/"
+    name="Subscriptions"
+    componentPromise={() =>
+      import(/*webpackChunkName: "AccountSubscriptions"*/ './views/settings/account/accountSubscriptions')}
     component={errorHandler(LazyLoad)}
   />,
 
diff --git a/src/sentry/static/sentry/app/views/settings/account/accountSubscriptions.jsx b/src/sentry/static/sentry/app/views/settings/account/accountSubscriptions.jsx
new file mode 100644
index 0000000000..ba733886ff
--- /dev/null
+++ b/src/sentry/static/sentry/app/views/settings/account/accountSubscriptions.jsx
@@ -0,0 +1,142 @@
+import {Box, Flex} from 'grid-emotion';
+import React from 'react';
+import styled from 'react-emotion';
+
+import {t} from '../../../locale';
+import AsyncView from '../../asyncView';
+import DateTime from '../../../components/dateTime';
+import Panel from '../components/panel';
+import PanelBody from '../components/panelBody';
+import PanelHeader from '../components/panelHeader';
+import Row from '../components/row';
+import SettingsPageHeader from '../components/settingsPageHeader';
+import Switch from '../../../components/switch';
+import IndicatorStore from '../../../stores/indicatorStore';
+import TextBlock from '../components/text/textBlock';
+
+const ENDPOINT = '/users/me/subscriptions/';
+
+const SubscriptionName = styled.div`
+  font-size: 1.2em;
+`;
+const Description = styled.div`
+  font-size: 0.8em;
+  margin-top: 6px;
+  color: ${p => p.theme.gray3};
+`;
+
+const SubscribedDescription = styled(Description)`
+  text-align: right;
+`;
+
+class AccountSubscriptions extends AsyncView {
+  getEndpoints() {
+    return [['subscriptions', ENDPOINT]];
+  }
+
+  handleToggle = (subscription, index, e) => {
+    let subscribed = !subscription.subscribed;
+    let oldSubscriptions = this.state.subscriptions;
+
+    this.setState(state => {
+      let newSubscriptions = state.subscriptions.slice();
+      newSubscriptions[index] = {
+        ...subscription,
+        subscribed,
+        subscribedDate: new Date(),
+      };
+      return {
+        ...state,
+        subscriptions: newSubscriptions,
+      };
+    });
+
+    this.api.request(ENDPOINT, {
+      method: 'PUT',
+      data: {
+        listId: subscription.listId,
+        subscribed,
+      },
+      success: data => {
+        IndicatorStore.addSuccess(
+          `${subscribed ? 'Subscribed' : 'Unsubscribed'} to ${subscription.listName}`
+        );
+      },
+      error: err => {
+        IndicatorStore.addError(
+          `Unable to ${subscribed ? '' : 'un'}subscribe to ${subscription.listName}`
+        );
+        this.setState({subscriptions: oldSubscriptions});
+      },
+    });
+  };
+
+  renderBody() {
+    return (
+      <div>
+        <SettingsPageHeader title="Subscriptions" />
+        <TextBlock>
+          Sentry is committed to respecting your inbox. Our goal is to provide useful
+          content and resources that make fixing errors less painful. Enjoyable even.
+        </TextBlock>
+
+        <TextBlock>
+          As part of our compliance with the EU’s General Data Protection Regulation
+          (GDPR), starting on 25 May 2018, we’ll only email you according to the marketing
+          categories to which you’ve explicitly opted-in.
+        </TextBlock>
+
+        <Panel>
+          <PanelHeader disablePadding>
+            <Flex align="center">
+              <Box px={2} flex="1">
+                {t('Name')}
+              </Box>
+              <Box px={2}>{t('Subscribed')}</Box>
+            </Flex>
+          </PanelHeader>
+
+          <PanelBody>
+            {this.state.subscriptions.map((subscription, index) => (
+              <Row p={2} align="center" key={subscription.listId}>
+                <Box flex="1">
+                  <SubscriptionName>{subscription.listName}</SubscriptionName>
+                  {subscription.listDescription && (
+                    <Description>{subscription.listDescription}</Description>
+                  )}
+                </Box>
+                <Flex direction="column" align="flex-end">
+                  <Switch
+                    isActive={subscription.subscribed}
+                    size="lg"
+                    toggle={this.handleToggle.bind(this, subscription, index)}
+                  />
+                  {subscription.subscribed && (
+                    <SubscribedDescription>
+                      <div>{subscription.email} on </div>
+                      <div>
+                        <DateTime shortDate date={subscription.subscribedDate} />
+                      </div>
+                    </SubscribedDescription>
+                  )}
+                </Flex>
+              </Row>
+            ))}
+          </PanelBody>
+        </Panel>
+        <TextBlock>
+          We’re applying GDPR consent and privacy policies to all Sentry contacts,
+          regardless of location. You’ll be able to manage your subscriptions here and
+          from an Unsubscribe link in the footer of all marketing emails.
+        </TextBlock>
+
+        <TextBlock>
+          Please contact <a href="mailto:learn@sentry.io">learn@sentry.io</a> with any
+          questions or suggestions.
+        </TextBlock>
+      </div>
+    );
+  }
+}
+
+export default AccountSubscriptions;
diff --git a/src/sentry/static/sentry/app/views/settings/account/navigationConfiguration.jsx b/src/sentry/static/sentry/app/views/settings/account/navigationConfiguration.jsx
index 885aa06060..08798510e4 100644
--- a/src/sentry/static/sentry/app/views/settings/account/navigationConfiguration.jsx
+++ b/src/sentry/static/sentry/app/views/settings/account/navigationConfiguration.jsx
@@ -22,6 +22,10 @@ const accountNavigation = [
         path: `${pathPrefix}/emails/`,
         title: t('Emails'),
       },
+      {
+        path: `${pathPrefix}/subscriptions/`,
+        title: t('Subscriptions'),
+      },
       {
         path: `${pathPrefix}/authorizations/`,
         title: t('Authorized Applications'),
diff --git a/tests/js/setup.js b/tests/js/setup.js
index cc2b5191c9..53e7aba058 100644
--- a/tests/js/setup.js
+++ b/tests/js/setup.js
@@ -311,6 +311,31 @@ window.TestStubs = {
       },
     ];
   },
+
+  Subscriptions: () => {
+    return [
+      {
+        subscribedDate: '2018-01-08T05:14:59.102Z',
+        subscribed: true,
+        listDescription:
+          'Everything you need to know about Sentry features, integrations, partnerships, and launches.',
+        listId: 2,
+        unsubscribedDate: null,
+        listName: 'Product & Feature Updates',
+        email: 'test@sentry.io',
+      },
+      {
+        subscribedDate: null,
+        subscribed: false,
+        listDescription:
+          "Our monthly update on what's new with Sentry and the community.",
+        listId: 1,
+        unsubscribedDate: '2018-01-08T19:31:42.546Z',
+        listName: 'Sentry Newsletter',
+        email: 'test@sentry.io',
+      },
+    ];
+  },
 };
 
 // this is very commonly used, so expose it globally
diff --git a/tests/js/spec/views/__snapshots__/accountSubscriptions.spec.jsx.snap b/tests/js/spec/views/__snapshots__/accountSubscriptions.spec.jsx.snap
new file mode 100644
index 0000000000..4d70901867
--- /dev/null
+++ b/tests/js/spec/views/__snapshots__/accountSubscriptions.spec.jsx.snap
@@ -0,0 +1,535 @@
+// Jest Snapshot v1, https://goo.gl/fbAQLP
+
+exports[`AccountSubscriptions renders empty 1`] = `
+<SideEffect(DocumentTitle)
+  title="Sentry"
+>
+  <div>
+    <SettingsPageHeading
+      title="Subscriptions"
+    />
+    <Styled(div)>
+      Sentry is committed to respecting your inbox. Our goal is to provide useful content and resources that make fixing errors less painful. Enjoyable even.
+    </Styled(div)>
+    <Styled(div)>
+      As part of our compliance with the EU’s General Data Protection Regulation (GDPR), starting on 25 May 2018, we’ll only email you according to the marketing categories to which you’ve explicitly opted-in.
+    </Styled(div)>
+    <Styled(div)>
+      <PanelHeader
+        disablePadding={true}
+      >
+        <Flex
+          align="center"
+        >
+          <Box
+            flex="1"
+            px={2}
+          >
+            Name
+          </Box>
+          <Box
+            px={2}
+          >
+            Subscribed
+          </Box>
+        </Flex>
+      </PanelHeader>
+      <Styled(div) />
+    </Styled(div)>
+    <Styled(div)>
+      We’re applying GDPR consent and privacy policies to all Sentry contacts, regardless of location. You’ll be able to manage your subscriptions here and from an Unsubscribe link in the footer of all marketing emails.
+    </Styled(div)>
+    <Styled(div)>
+      Please contact 
+      <a
+        href="mailto:learn@sentry.io"
+      >
+        learn@sentry.io
+      </a>
+       with any questions or suggestions.
+    </Styled(div)>
+  </div>
+</SideEffect(DocumentTitle)>
+`;
+
+exports[`AccountSubscriptions renders list and can toggle 1`] = `
+.glamor-4 {
+  font-size: 14px;
+  box-shadow: inset 0 -1px 0;
+  margin: -20px 0 30px;
+}
+
+.glamor-2 {
+  box-sizing: border-box;
+  display: -webkit-box;
+  display: -webkit-flex;
+  display: -ms-flexbox;
+  display: flex;
+  -webkit-align-items: center;
+  -webkit-box-align: center;
+  -ms-flex-align: center;
+  align-items: center;
+}
+
+.glamor-0 {
+  font-size: 20px;
+  font-weight: bold;
+  margin: 20px 0;
+  -webkit-flex: 1;
+  -ms-flex: 1;
+  flex: 1;
+}
+
+.glamor-6 {
+  line-height: 1.5;
+  margin-bottom: 30px;
+}
+
+.glamor-53 {
+  background: #fff;
+  border: 1px solid;
+  margin-bottom: 30px;
+  position: relative;
+}
+
+.glamor-23 {
+  border-bottom: 1px solid;
+  border-radius: 0 0;
+  background: padding:15px 0;
+  text-transform: uppercase;
+  font-size: 13px;
+}
+
+.glamor-19 {
+  font-size: inherit;
+  text-transform: inherit;
+  margin: 0;
+}
+
+.glamor-17 {
+  font-size: 12px;
+  font-weight: 600;
+  text-transform: uppercase;
+  margin-bottom: 20px;
+  font-size: inherit;
+  text-transform: inherit;
+  margin: 0;
+}
+
+.glamor-10 {
+  box-sizing: border-box;
+  padding-left: 16px;
+  padding-right: 16px;
+  -webkit-flex: 1;
+  -ms-flex: 1;
+  flex: 1;
+}
+
+.glamor-12 {
+  box-sizing: border-box;
+  padding-left: 16px;
+  padding-right: 16px;
+}
+
+.glamor-35 {
+  box-sizing: border-box;
+  padding: 16px;
+  display: -webkit-box;
+  display: -webkit-flex;
+  display: -ms-flexbox;
+  display: flex;
+  -webkit-align-items: center;
+  -webkit-box-align: center;
+  -ms-flex-align: center;
+  align-items: center;
+  border-bottom: 1px solid;
+}
+
+.glamor-35:last-child {
+  border: 0;
+}
+
+.glamor-29 {
+  box-sizing: border-box;
+  -webkit-flex: 1;
+  -ms-flex: 1;
+  flex: 1;
+}
+
+.glamor-25 {
+  font-size: 1.2em;
+}
+
+.glamor-27 {
+  font-size: 0.8em;
+  margin-top: 6px;
+}
+
+.glamor-33 {
+  box-sizing: border-box;
+  display: -webkit-box;
+  display: -webkit-flex;
+  display: -ms-flexbox;
+  display: flex;
+  -webkit-flex-direction: column;
+  -ms-flex-direction: column;
+  flex-direction: column;
+  -webkit-align-items: flex-end;
+  -webkit-box-align: flex-end;
+  -ms-flex-align: flex-end;
+  align-items: flex-end;
+}
+
+.glamor-31 {
+  font-size: 0.8em;
+  margin-top: 6px;
+  text-align: right;
+}
+
+<AccountSubscriptions>
+  <SideEffect(DocumentTitle)
+    title="Sentry"
+  >
+    <DocumentTitle
+      title="Sentry"
+    >
+      <div>
+        <SettingsPageHeading
+          title="Subscriptions"
+        >
+          <Styled(div)>
+            <div
+              className="glamor-4 glamor-5"
+            >
+              <Flex
+                align="center"
+              >
+                <Base
+                  align="center"
+                  className="glamor-2"
+                >
+                  <div
+                    className="glamor-2"
+                    is={null}
+                  >
+                    <Styled(div)>
+                      <div
+                        className="glamor-0 glamor-1"
+                      >
+                        Subscriptions
+                      </div>
+                    </Styled(div)>
+                  </div>
+                </Base>
+              </Flex>
+            </div>
+          </Styled(div)>
+        </SettingsPageHeading>
+        <Styled(div)>
+          <div
+            className="glamor-6 glamor-7"
+          >
+            Sentry is committed to respecting your inbox. Our goal is to provide useful content and resources that make fixing errors less painful. Enjoyable even.
+          </div>
+        </Styled(div)>
+        <Styled(div)>
+          <div
+            className="glamor-6 glamor-7"
+          >
+            As part of our compliance with the EU’s General Data Protection Regulation (GDPR), starting on 25 May 2018, we’ll only email you according to the marketing categories to which you’ve explicitly opted-in.
+          </div>
+        </Styled(div)>
+        <Styled(div)>
+          <div
+            className="glamor-53 glamor-54"
+          >
+            <PanelHeader
+              disablePadding={true}
+            >
+              <Styled(div)
+                disablePadding={true}
+              >
+                <div
+                  className="glamor-23 glamor-24"
+                >
+                  <Styled(Component)>
+                    <Component
+                      className="glamor-19 glamor-16"
+                    >
+                      <Styled(div)
+                        className="glamor-19 glamor-16"
+                      >
+                        <div
+                          className="glamor-16 glamor-17 glamor-18"
+                        >
+                          <Flex
+                            align="center"
+                          >
+                            <Base
+                              align="center"
+                              className="glamor-2"
+                            >
+                              <div
+                                className="glamor-2"
+                                is={null}
+                              >
+                                <Box
+                                  flex="1"
+                                  px={2}
+                                >
+                                  <Base
+                                    className="glamor-10"
+                                    flex="1"
+                                    px={2}
+                                  >
+                                    <div
+                                      className="glamor-10"
+                                      is={null}
+                                    >
+                                      Name
+                                    </div>
+                                  </Base>
+                                </Box>
+                                <Box
+                                  px={2}
+                                >
+                                  <Base
+                                    className="glamor-12"
+                                    px={2}
+                                  >
+                                    <div
+                                      className="glamor-12"
+                                      is={null}
+                                    >
+                                      Subscribed
+                                    </div>
+                                  </Base>
+                                </Box>
+                              </div>
+                            </Base>
+                          </Flex>
+                        </div>
+                      </Styled(div)>
+                    </Component>
+                  </Styled(Component)>
+                </div>
+              </Styled(div)>
+            </PanelHeader>
+            <Styled(div)>
+              <div
+                className="glamor-51 glamor-52"
+              >
+                <Row
+                  align="center"
+                  key="2"
+                  p={2}
+                >
+                  <Styled(Base)
+                    align="center"
+                    p={2}
+                  >
+                    <Base
+                      align="center"
+                      className="glamor-35 glamor-36"
+                      p={2}
+                    >
+                      <div
+                        className="glamor-35 glamor-36"
+                        is={null}
+                      >
+                        <Box
+                          flex="1"
+                        >
+                          <Base
+                            className="glamor-29"
+                            flex="1"
+                          >
+                            <div
+                              className="glamor-29"
+                              is={null}
+                            >
+                              <Styled(div)>
+                                <div
+                                  className="glamor-25 glamor-26"
+                                >
+                                  Product & Feature Updates
+                                </div>
+                              </Styled(div)>
+                              <Styled(div)>
+                                <div
+                                  className="glamor-27 glamor-28"
+                                >
+                                  Everything you need to know about Sentry features, integrations, partnerships, and launches.
+                                </div>
+                              </Styled(div)>
+                            </div>
+                          </Base>
+                        </Box>
+                        <Flex
+                          align="flex-end"
+                          direction="column"
+                        >
+                          <Base
+                            align="flex-end"
+                            className="glamor-33"
+                            direction="column"
+                          >
+                            <div
+                              className="glamor-33"
+                              is={null}
+                            >
+                              <Switch
+                                isActive={true}
+                                size="lg"
+                                toggle={[Function]}
+                              >
+                                <div
+                                  aria-checked={true}
+                                  className="switch switch-lg switch-on"
+                                  onClick={[Function]}
+                                  role="checkbox"
+                                >
+                                  <span
+                                    className="switch-toggle"
+                                  />
+                                </div>
+                              </Switch>
+                              <Styled(div)>
+                                <div
+                                  className="glamor-31 glamor-32"
+                                >
+                                  <div>
+                                    test@sentry.io
+                                     on 
+                                  </div>
+                                  <div>
+                                    <DateTime
+                                      date="2018-01-08T05:14:59.102Z"
+                                      seconds={true}
+                                      shortDate={true}
+                                    >
+                                      <time>
+                                        01/08/2018
+                                      </time>
+                                    </DateTime>
+                                  </div>
+                                </div>
+                              </Styled(div)>
+                            </div>
+                          </Base>
+                        </Flex>
+                      </div>
+                    </Base>
+                  </Styled(Base)>
+                </Row>
+                <Row
+                  align="center"
+                  key="1"
+                  p={2}
+                >
+                  <Styled(Base)
+                    align="center"
+                    p={2}
+                  >
+                    <Base
+                      align="center"
+                      className="glamor-35 glamor-36"
+                      p={2}
+                    >
+                      <div
+                        className="glamor-35 glamor-36"
+                        is={null}
+                      >
+                        <Box
+                          flex="1"
+                        >
+                          <Base
+                            className="glamor-29"
+                            flex="1"
+                          >
+                            <div
+                              className="glamor-29"
+                              is={null}
+                            >
+                              <Styled(div)>
+                                <div
+                                  className="glamor-25 glamor-26"
+                                >
+                                  Sentry Newsletter
+                                </div>
+                              </Styled(div)>
+                              <Styled(div)>
+                                <div
+                                  className="glamor-27 glamor-28"
+                                >
+                                  Our monthly update on what's new with Sentry and the community.
+                                </div>
+                              </Styled(div)>
+                            </div>
+                          </Base>
+                        </Box>
+                        <Flex
+                          align="flex-end"
+                          direction="column"
+                        >
+                          <Base
+                            align="flex-end"
+                            className="glamor-33"
+                            direction="column"
+                          >
+                            <div
+                              className="glamor-33"
+                              is={null}
+                            >
+                              <Switch
+                                isActive={false}
+                                size="lg"
+                                toggle={[Function]}
+                              >
+                                <div
+                                  aria-checked={false}
+                                  className="switch switch-lg"
+                                  onClick={[Function]}
+                                  role="checkbox"
+                                >
+                                  <span
+                                    className="switch-toggle"
+                                  />
+                                </div>
+                              </Switch>
+                            </div>
+                          </Base>
+                        </Flex>
+                      </div>
+                    </Base>
+                  </Styled(Base)>
+                </Row>
+              </div>
+            </Styled(div)>
+          </div>
+        </Styled(div)>
+        <Styled(div)>
+          <div
+            className="glamor-6 glamor-7"
+          >
+            We’re applying GDPR consent and privacy policies to all Sentry contacts, regardless of location. You’ll be able to manage your subscriptions here and from an Unsubscribe link in the footer of all marketing emails.
+          </div>
+        </Styled(div)>
+        <Styled(div)>
+          <div
+            className="glamor-6 glamor-7"
+          >
+            Please contact 
+            <a
+              href="mailto:learn@sentry.io"
+            >
+              learn@sentry.io
+            </a>
+             with any questions or suggestions.
+          </div>
+        </Styled(div)>
+      </div>
+    </DocumentTitle>
+  </SideEffect(DocumentTitle)>
+</AccountSubscriptions>
+`;
diff --git a/tests/js/spec/views/accountSubscriptions.spec.jsx b/tests/js/spec/views/accountSubscriptions.spec.jsx
new file mode 100644
index 0000000000..a7111a368e
--- /dev/null
+++ b/tests/js/spec/views/accountSubscriptions.spec.jsx
@@ -0,0 +1,71 @@
+import PropTypes from 'prop-types';
+import React from 'react';
+import {shallow, mount} from 'enzyme';
+
+import {Client} from 'app/api';
+import AccountSubscriptions from 'app/views/settings/account/accountSubscriptions';
+
+const ENDPOINT = '/users/me/subscriptions/';
+
+describe('AccountSubscriptions', function() {
+  beforeEach(function() {
+    Client.clearMockResponses();
+  });
+
+  it('renders empty', function() {
+    Client.addMockResponse({
+      url: ENDPOINT,
+      body: [],
+    });
+    let wrapper = shallow(<AccountSubscriptions />, {
+      context: {
+        router: TestStubs.router(),
+      },
+      childContextTypes: {
+        router: PropTypes.object,
+      },
+    });
+
+    expect(wrapper).toMatchSnapshot();
+  });
+
+  it('renders list and can toggle', function() {
+    Client.addMockResponse({
+      url: ENDPOINT,
+      body: TestStubs.Subscriptions(),
+    });
+    let mock = Client.addMockResponse({
+      url: ENDPOINT,
+      method: 'PUT',
+    });
+
+    let wrapper = mount(<AccountSubscriptions />, {
+      context: {
+        router: TestStubs.router(),
+      },
+      childContextTypes: {
+        router: PropTypes.object,
+      },
+    });
+
+    expect(wrapper).toMatchSnapshot();
+
+    expect(mock).not.toHaveBeenCalled();
+
+    wrapper
+      .find('Switch')
+      .first()
+      .simulate('click');
+
+    expect(mock).toHaveBeenCalledWith(
+      ENDPOINT,
+      expect.objectContaining({
+        method: 'PUT',
+        data: {
+          listId: 2,
+          subscribed: false,
+        },
+      })
+    );
+  });
+});
diff --git a/tests/sentry/api/endpoints/test_user_subscriptions.py b/tests/sentry/api/endpoints/test_user_subscriptions.py
new file mode 100644
index 0000000000..0a3af12ec0
--- /dev/null
+++ b/tests/sentry/api/endpoints/test_user_subscriptions.py
@@ -0,0 +1,23 @@
+from __future__ import absolute_import
+
+from django.core.urlresolvers import reverse
+
+from sentry.testutils import APITestCase
+
+
+class UserSubscriptionsTest(APITestCase):
+    def setUp(self):
+        self.user = self.create_user(email='foo@example.com')
+        self.login_as(self.user)
+        self.url = reverse('sentry-api-0-user-subscriptions', kwargs={'user_id': self.user.id})
+
+    def test_get_subscriptions(self):
+        response = self.client.get(self.url)
+        assert response.status_code == 200, response.content
+
+    def test_update_subscriptions(self):
+        response = self.client.put(self.url, data={
+            'listId': '123',
+            'subscribed': True,
+        })
+        assert response.status_code == 204, response.content
