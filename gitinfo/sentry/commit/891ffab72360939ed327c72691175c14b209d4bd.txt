commit 891ffab72360939ed327c72691175c14b209d4bd
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Feb 7 16:32:15 2019 -0800

    fix(monitors): Correct various issues
    
    - Correct enum check for 'OK' / green status on monitors
    - Fix handling of lastCheckIn and nextCheckIn being nullable
    - Fix duplicate panel frame on recent issues
    - Fix milliseconds reported behavior

diff --git a/bin/load-mocks b/bin/load-mocks
index 4e36f20827..ffc6109457 100755
--- a/bin/load-mocks
+++ b/bin/load-mocks
@@ -416,7 +416,7 @@ def main(num_events=1, extra_events=False):
                     monitor.config = {'schedule': next(MONITOR_SCHEDULES)}
                 monitor.update(
                     config=monitor.config,
-                    status=MonitorStatus.ACTIVE if randint(0, 10) < 7 else MonitorStatus.ERROR,
+                    status=MonitorStatus.OK if randint(0, 10) < 7 else MonitorStatus.ERROR,
                     last_checkin=timezone.now(),
                     next_checkin=monitor.get_next_scheduled_checkin(timezone.now()),
                 )
@@ -424,7 +424,7 @@ def main(num_events=1, extra_events=False):
             MonitorCheckIn.objects.create(
                 project_id=monitor.project_id,
                 monitor=monitor,
-                status=CheckInStatus.OK if monitor.status == MonitorStatus.ACTIVE else CheckInStatus.ERROR,
+                status=CheckInStatus.OK if monitor.status == MonitorStatus.OK else CheckInStatus.ERROR,
             )
 
             with transaction.atomic():
diff --git a/src/sentry/static/sentry/app/views/organizationMonitors/details.jsx b/src/sentry/static/sentry/app/views/organizationMonitors/details.jsx
index 089f1d95f9..9cdd8bd2c8 100644
--- a/src/sentry/static/sentry/app/views/organizationMonitors/details.jsx
+++ b/src/sentry/static/sentry/app/views/organizationMonitors/details.jsx
@@ -1,7 +1,7 @@
 import React from 'react';
 
 import AsyncView from 'app/views/asyncView';
-import {Panel, PanelBody, PanelHeader} from 'app/components/panels';
+import {Panel, PanelHeader} from 'app/components/panels';
 import {t} from 'app/locale';
 
 import MonitorCheckIns from './monitorCheckIns';
@@ -40,9 +40,7 @@ class OrganizationMonitorDetails extends AsyncView {
         <Panel>
           <PanelHeader>{t('Related Issues')}</PanelHeader>
 
-          <PanelBody>
-            <MonitorIssues monitor={monitor} orgId={this.props.params.orgId} />
-          </PanelBody>
+          <MonitorIssues monitor={monitor} orgId={this.props.params.orgId} />
         </Panel>
 
         <Panel>
diff --git a/src/sentry/static/sentry/app/views/organizationMonitors/monitorHeader.jsx b/src/sentry/static/sentry/app/views/organizationMonitors/monitorHeader.jsx
index 0f97f915ac..2d8e69db78 100644
--- a/src/sentry/static/sentry/app/views/organizationMonitors/monitorHeader.jsx
+++ b/src/sentry/static/sentry/app/views/organizationMonitors/monitorHeader.jsx
@@ -23,19 +23,15 @@ export default class MonitorHeader extends React.Component {
           </div>
           <div className="col-sm-2 hidden-xs">
             <h6 className="nav-header">{t('Last Check-in')}</h6>
-            <TimeSince date={monitor.lastCheckIn} />
+            {monitor.lastCheckIn && <TimeSince date={monitor.lastCheckIn} />}
           </div>
           <div className="col-sm-2 hidden-xs">
             <h6 className="nav-header">{t('Next Check-in')}</h6>
-            <TimeSince date={monitor.nextCheckIn} />
+            {monitor.nextCheckIn && <TimeSince date={monitor.nextCheckIn} />}
           </div>
           <div className="col-sm-2">
             <h6 className="nav-header">{t('Status')}</h6>
-            <MonitorIcon
-              status={monitor.status}
-              lastCheckIn={monitor.lastCheckIn}
-              size={16}
-            />
+            <MonitorIcon status={monitor.status} size={16} />
           </div>
         </div>
       </div>
diff --git a/src/sentry/static/sentry/app/views/organizationMonitors/monitorIcon.jsx b/src/sentry/static/sentry/app/views/organizationMonitors/monitorIcon.jsx
index aa7958cb28..0e959ba9a6 100644
--- a/src/sentry/static/sentry/app/views/organizationMonitors/monitorIcon.jsx
+++ b/src/sentry/static/sentry/app/views/organizationMonitors/monitorIcon.jsx
@@ -5,7 +5,7 @@ const getBackgroundColor = p => {
 
   return `background: ${p.status === 'error'
     ? p.theme.error
-    : p.status === 'active' && p.lastCheckIn ? p.theme.success : p.theme.disabled};`;
+    : p.status === 'ok' ? p.theme.success : p.theme.disabled};`;
 };
 
 const getSize = p => `
diff --git a/src/sentry/static/sentry/app/views/organizationMonitors/monitors.jsx b/src/sentry/static/sentry/app/views/organizationMonitors/monitors.jsx
index b47bbe28c1..ffe70f1e62 100644
--- a/src/sentry/static/sentry/app/views/organizationMonitors/monitors.jsx
+++ b/src/sentry/static/sentry/app/views/organizationMonitors/monitors.jsx
@@ -88,11 +88,7 @@ class OrganizationMonitors extends AsyncView {
               return (
                 <PanelItem key={monitor.id}>
                   <Box style={{width: 16}} align="center" justify="center" mr={2}>
-                    <MonitorIcon
-                      status={monitor.status}
-                      lastCheckIn={monitor.lastCheckIn}
-                      size={16}
-                    />
+                    <MonitorIcon status={monitor.status} size={16} />
                   </Box>
                   <Box flex="1" mr={2}>
                     <Link
diff --git a/src/sentry/utils/monitors.py b/src/sentry/utils/monitors.py
index df8b48cd2b..95160d77e2 100644
--- a/src/sentry/utils/monitors.py
+++ b/src/sentry/utils/monitors.py
@@ -94,7 +94,7 @@ def report_monitor_complete(task, retval, **kwargs):
     except (ValueError, TypeError):
         return
 
-    duration = int(time() - start_time)
+    duration = int(time() - start_time * 1000)
 
     session = SafeSession()
     session.put(u'{}/api/0/monitors/{}/checkins/{}/'.format(API_ROOT, monitor_id, checkin_id), headers={
