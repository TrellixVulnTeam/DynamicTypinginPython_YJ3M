commit bccfda760cef46242b22f8be3d30520a1fade3ee
Author: Eric Feng <erichfeng@gmail.com>
Date:   Tue Feb 16 12:28:14 2016 -0800

    fixing sourcemaps checks

diff --git a/src/sentry/receivers/onboarding.py b/src/sentry/receivers/onboarding.py
index 8ab1936dcb..1835adfca6 100644
--- a/src/sentry/receivers/onboarding.py
+++ b/src/sentry/receivers/onboarding.py
@@ -16,10 +16,8 @@ from sentry.signals import (
     member_joined,
     plugin_enabled,
     issue_tracker_used,
-    user_context_received,
-    release_received,
-    sourcemap_received,
 )
+from sentry.utils.javascript import has_sourcemap
 
 @project_created.connect(weak=False)
 def record_new_project(project, user, **kwargs):
@@ -174,7 +172,7 @@ def record_user_context_received(project, group, event, **kwargs):
 
 @event_processed.connect(weak=False)
 def record_sourcemaps_received(project, group, event, **kwargs):
-    if event.data.get("sourcemap"):
+    if has_sourcemap(event):
         try:
             with transaction.atomic():
                 OrganizationOnboardingTask.objects.create(
diff --git a/src/sentry/signals.py b/src/sentry/signals.py
index 0b89b17514..fe48efd8eb 100644
--- a/src/sentry/signals.py
+++ b/src/sentry/signals.py
@@ -35,8 +35,5 @@ first_event_pending = BetterSignal(providing_args=["instance", "user"])
 first_event_received = BetterSignal(providing_args=["instance", "group"])
 member_invited = BetterSignal(providing_args=["member", "user"])
 member_joined = BetterSignal(providing_args=["member"])
-user_context_received = BetterSignal(providing_args=["instance"])
-release_received = BetterSignal(providing_args=["instance"])
-sourcemap_received = BetterSignal(providing_args=["instance"])
 issue_tracker_used = BetterSignal(providing_args=["plugin", "project", "user"])
 plugin_enabled = BetterSignal(providing_args=["plugin", "project", "user"])
diff --git a/src/sentry/utils/javascript.py b/src/sentry/utils/javascript.py
index 6ee4bff902..79601ac886 100644
--- a/src/sentry/utils/javascript.py
+++ b/src/sentry/utils/javascript.py
@@ -28,6 +28,26 @@ from sentry.utils.http import absolute_uri
 transformers = {}
 
 
+def has_sourcemap(event):
+    if event.platform != 'javascript':
+        return False
+
+    data = event.data
+
+    if 'sentry.interfaces.Exception' not in data:
+        return False
+
+    exception = data['sentry.interfaces.Exception']
+
+    for value in exception['values']:
+        stacktrace = value.get('stacktrace', {})
+        for frame in stacktrace.get('frames', []):
+            if 'sourcemap' in frame.get('data', {}):
+                return True
+
+    return False
+
+
 def transform(objects, request=None):
     if request is None:
         request = getattr(env, 'request', None)
