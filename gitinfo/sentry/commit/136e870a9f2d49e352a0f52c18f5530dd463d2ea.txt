commit 136e870a9f2d49e352a0f52c18f5530dd463d2ea
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Apr 21 21:06:17 2014 -0700

    Improve versioning to be more realistic

diff --git a/src/sentry/utils/javascript.py b/src/sentry/utils/javascript.py
index 8a4c6c08a5..15a13af7b4 100644
--- a/src/sentry/utils/javascript.py
+++ b/src/sentry/utils/javascript.py
@@ -5,8 +5,6 @@ sentry.utils.javascript
 :copyright: (c) 2010-2014 by the Sentry Team, see AUTHORS for more details.
 :license: BSD, see LICENSE for more details.
 """
-import time
-
 from collections import defaultdict
 
 from django.core.urlresolvers import reverse
@@ -171,7 +169,7 @@ class GroupTransformer(Transformer):
                 'name': obj.project.name,
                 'slug': obj.project.slug,
             },
-            'version': time.time(),
+            'version': int(max([obj.resolved_at, obj.last_seen]).strftime('%s')),
         }
         if hasattr(obj, 'is_bookmarked'):
             d['isBookmarked'] = obj.is_bookmarked
diff --git a/src/sentry/web/api.py b/src/sentry/web/api.py
index 05db333c1b..868ed7cd64 100644
--- a/src/sentry/web/api.py
+++ b/src/sentry/web/api.py
@@ -463,7 +463,10 @@ def resolve_group(request, team, project, group_id):
     except Group.DoesNotExist:
         return HttpResponseForbidden()
 
-    happened = group.update(status=STATUS_RESOLVED)
+    happened = group.update(
+        status=STATUS_RESOLVED,
+        resovled_at=timezone.now(),
+    )
     if happened:
         Activity.objects.create(
             project=project,
@@ -485,7 +488,10 @@ def mute_group(request, team, project, group_id):
     except Group.DoesNotExist:
         return HttpResponseForbidden()
 
-    happened = group.update(status=STATUS_MUTED)
+    happened = group.update(
+        status=STATUS_MUTED,
+        resovled_at=timezone.now(),
+    )
     if happened:
         Activity.objects.create(
             project=project,
@@ -507,7 +513,10 @@ def unresolve_group(request, team, project, group_id):
     except Group.DoesNotExist:
         return HttpResponseForbidden()
 
-    happened = group.update(status=STATUS_UNRESOLVED)
+    happened = group.update(
+        status=STATUS_UNRESOLVED,
+        active_at=timezone.now(),
+    )
     if happened:
         Activity.objects.create(
             project=project,
