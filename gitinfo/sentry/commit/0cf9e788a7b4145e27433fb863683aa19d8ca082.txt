commit 0cf9e788a7b4145e27433fb863683aa19d8ca082
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Wed Feb 28 11:28:40 2018 -0800

    feat(environments): Filter user report count by environment (#7367)
    
    User report count in group details endpoint reflects environment

diff --git a/src/sentry/api/endpoints/group_details.py b/src/sentry/api/endpoints/group_details.py
index cf0b08cd1d..817292b39b 100644
--- a/src/sentry/api/endpoints/group_details.py
+++ b/src/sentry/api/endpoints/group_details.py
@@ -208,10 +208,16 @@ class GroupDetailsEndpoint(GroupEndpoint, EnvironmentMixin):
             get_range = lambda model, keys, start, end, **kwargs: \
                 {k: tsdb.make_series(0, start, end) for k in keys}
             tags = []
+            user_reports = UserReport.objects.none()
+
         else:
             get_range = functools.partial(tsdb.get_range, environment_id=environment_id)
             tags = tagstore.get_group_tag_keys(
                 group.project_id, group.id, environment_id, limit=100)
+            if environment_id is None:
+                user_reports = UserReport.objects.filter(group=group)
+            else:
+                user_reports = UserReport.objects.filter(group=group, environment_id=environment_id)
 
         now = timezone.now()
         hourly_stats = tsdb.rollup(
@@ -248,7 +254,7 @@ class GroupDetailsEndpoint(GroupEndpoint, EnvironmentMixin):
                 'pluginActions': action_list,
                 'pluginIssues': self._get_available_issue_plugins(request, group),
                 'pluginContexts': self._get_context_plugins(request, group),
-                'userReportCount': UserReport.objects.filter(group=group).count(),
+                'userReportCount': user_reports.count(),
                 'tags': sorted(serialize(tags, request.user), key=lambda x: x['name']),
                 'stats': {
                     '24h': hourly_stats,
