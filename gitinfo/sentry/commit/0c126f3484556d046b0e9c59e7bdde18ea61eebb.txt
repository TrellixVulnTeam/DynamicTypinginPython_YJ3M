commit 0c126f3484556d046b0e9c59e7bdde18ea61eebb
Author: Lauryn Brown <lauryndbrown@gmail.com>
Date:   Thu Jun 14 16:47:43 2018 -0700

    feat(identity): Added get_provider to Identity Model (#8747)
    
    * Added get-provider but cannot get the tests to work.
    
    * fixed test identity.

diff --git a/src/sentry/models/identity.py b/src/sentry/models/identity.py
index eff6f76cc0..4fce348fd9 100644
--- a/src/sentry/models/identity.py
+++ b/src/sentry/models/identity.py
@@ -59,3 +59,7 @@ class Identity(Model):
         app_label = 'sentry'
         db_table = 'sentry_identity'
         unique_together = (('idp', 'external_id'), ('idp', 'user'))
+
+    def get_provider(self):
+        from sentry.identity import get
+        return get(self.idp.type)
diff --git a/tests/sentry/models/test_identity.py b/tests/sentry/models/test_identity.py
new file mode 100644
index 0000000000..4d2a5b57a2
--- /dev/null
+++ b/tests/sentry/models/test_identity.py
@@ -0,0 +1,34 @@
+from __future__ import absolute_import
+
+
+from sentry.identity import register
+from sentry.identity.base import Provider
+from sentry.models import Identity, IdentityProvider
+from sentry.testutils import TestCase
+
+
+class ProviderDummy(Provider):
+    name = 'Tester'
+    key = 'tester'
+
+    def build_identity(self, state):
+        pass
+
+
+class IdentityTestCase(TestCase):
+    def test_get_provider(self):
+        provider_model = IdentityProvider.objects.create(
+            type='tester',
+            external_id='tester_id',
+        )
+
+        register(ProviderDummy)
+        identity_model = Identity.objects.create(
+            idp=provider_model,
+            user=self.user,
+            external_id='identity_id',
+        )
+
+        provider = identity_model.get_provider()
+        assert provider.name == 'Tester'
+        assert provider.key == 'tester'
