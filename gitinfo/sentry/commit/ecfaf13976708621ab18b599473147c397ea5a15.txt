commit ecfaf13976708621ab18b599473147c397ea5a15
Author: Markus Unterwaditzer <markus@unterwaditzer.net>
Date:   Fri Feb 1 17:58:28 2019 +0100

    fix: Fix some null references and missing tag trimming (#11848)

diff --git a/src/sentry/event_manager.py b/src/sentry/event_manager.py
index 94a595d9bb..42f0d13942 100644
--- a/src/sentry/event_manager.py
+++ b/src/sentry/event_manager.py
@@ -90,7 +90,7 @@ def pop_tag(data, key):
 
 def set_tag(data, key, value):
     pop_tag(data, key)
-    data['tags'].append((key, value))
+    data['tags'].append((key, trim(value, MAX_TAG_VALUE_LENGTH)))
 
 
 def get_tag(data, key):
@@ -923,9 +923,9 @@ class EventManager(object):
         if logger_name:
             set_tag(data, 'logger', logger_name)
         if environment:
-            set_tag(data, 'environment', trim(environment, MAX_TAG_VALUE_LENGTH))
+            set_tag(data, 'environment', environment)
         if transaction_name:
-            set_tag(data, 'transaction', trim(transaction_name, MAX_TAG_VALUE_LENGTH))
+            set_tag(data, 'transaction', transaction_name)
 
         if release:
             # dont allow a conflicting 'release' tag
diff --git a/src/sentry/utils/contexts_normalization.py b/src/sentry/utils/contexts_normalization.py
index aa45a09cfd..b802672cff 100644
--- a/src/sentry/utils/contexts_normalization.py
+++ b/src/sentry/utils/contexts_normalization.py
@@ -53,7 +53,7 @@ def normalize_runtime(data):
     # RuntimeInformation.FrameworkDescription doesn't return a very useful value.
     # example: .NET Framework 4.7.3056.0
     # Release key dug from registry and sent as #build
-    if data.get('name').startswith('.NET Framework'):
+    if (data.get('name') or "").startswith('.NET Framework'):
         build = data.get('build')
 
         if build is not None:
