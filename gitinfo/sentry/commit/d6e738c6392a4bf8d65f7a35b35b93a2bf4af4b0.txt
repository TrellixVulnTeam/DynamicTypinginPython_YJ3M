commit d6e738c6392a4bf8d65f7a35b35b93a2bf4af4b0
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Mon May 14 16:30:12 2018 -0700

    feat(dashboard): Add team settings link to Dashboard (#8426)
    
    * Disable "Add project" and "remove" if user does not have permission
    * remove stroke color from icon-chevron-down
    * Update settings icon

diff --git a/src/sentry/static/sentry/app/icons/icon-chevron-down.svg b/src/sentry/static/sentry/app/icons/icon-chevron-down.svg
index ec654c5f06..235cf9acb7 100644
--- a/src/sentry/static/sentry/app/icons/icon-chevron-down.svg
+++ b/src/sentry/static/sentry/app/icons/icon-chevron-down.svg
@@ -5,8 +5,8 @@
     <desc>Created with Sketch.</desc>
     <defs></defs>
     <g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round">
-        <g id="icon-chevron-down" stroke="#493E54">
+        <g id="icon-chevron-down" stroke="currentColor">
             <polyline id="Shape" transform="translate(5.000000, 2.715559) rotate(-90.000000) translate(-5.000000, -2.715559) " points="6.715559 6.715559 3.284441 2.71258796 6.71186974 -1.284441"></polyline>
         </g>
     </g>
-</svg>
\ No newline at end of file
+</svg>
diff --git a/src/sentry/static/sentry/app/icons/icon-settings.svg b/src/sentry/static/sentry/app/icons/icon-settings.svg
index 38dfa2a5ff..130648462e 100644
--- a/src/sentry/static/sentry/app/icons/icon-settings.svg
+++ b/src/sentry/static/sentry/app/icons/icon-settings.svg
@@ -1,4 +1 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
-    <path d="M8.66645279,14.0183332 C8.77596639,14.0062192 8.88725691,14 9,14 L19,14 C20.6568542,14 22,15.3431458 22,17 C22,18.6568542 20.6568542,20 19,20 L9,20 C8.88725691,20 8.77596639,19.9937808 8.66645279,19.9816668 C7.95880306,20.6149395 7.02436938,21 6,21 C3.790861,21 2,19.209139 2,17 C2,14.790861 3.790861,13 6,13 C7.02436938,13 7.95880306,13.3850605 8.66645279,14.0183332 Z M6,15 C4.8954305,15 4,15.8954305 4,17 C4,18.1045695 4.8954305,19 6,19 C7.1045695,19 8,18.1045695 8,17 C8,15.8954305 7.1045695,15 6,15 Z M9.87398251,16 C9.956247,16.3196199 10,16.6547004 10,17 C10,17.3452996 9.956247,17.6803801 9.87398251,18 L19,18 C19.5522847,18 20,17.5522847 20,17 C20,16.4477153 19.5522847,16 19,16 L9.87398251,16 Z M15.3335472,4.01833324 C16.0411969,3.3850605 16.9756306,3 18,3 C20.209139,3 22,4.790861 22,7 C22,9.209139 20.209139,11 18,11 C16.9756306,11 16.0411969,10.6149395 15.3335472,9.98166676 C15.2240336,9.9937808 15.1127431,10 15,10 L5,10 C3.34314575,10 2,8.65685425 2,7 C2,5.34314575 3.34314575,4 5,4 L15,4 C15.1127431,4 15.2240336,4.0062192 15.3335472,4.01833324 Z M14,6 L4.98755508,6 C4.44214347,6 4,6.44771525 4,7 C4,7.55228475 4.44214347,8 4.98755508,8 L14,8 C13.9187593,7.68038008 13.8755508,7.34529957 13.8755508,7 C13.8755508,6.65470043 13.9187593,6.31961992 14,6 Z M18,5 C16.8954305,5 16,5.8954305 16,7 C16,8.1045695 16.8954305,9 18,9 C19.1045695,9 20,8.1045695 20,7 C20,5.8954305 19.1045695,5 18,5 Z" fill="currentColor" fill-rule="nonzero"></path>
-</svg>
+<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-settings"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
diff --git a/src/sentry/static/sentry/app/utils/theme.jsx b/src/sentry/static/sentry/app/utils/theme.jsx
index 4e0044d5d6..a602e89aaa 100644
--- a/src/sentry/static/sentry/app/utils/theme.jsx
+++ b/src/sentry/static/sentry/app/utils/theme.jsx
@@ -136,6 +136,7 @@ const theme = {
 theme.textColor = theme.gray5;
 theme.success = theme.green;
 theme.error = theme.red;
+theme.disabled = '#ced3d6';
 
 theme.alert.info.iconColor = theme.blue;
 theme.alert.info.background = theme.blue;
@@ -192,7 +193,7 @@ theme.button = {
     // borderActive: '#352b7b',
   },
   disabled: {
-    color: '#ced3d6',
+    color: theme.disabled,
     border: '#e3e5e6',
     borderActive: '#e3e5e6',
     background: theme.white,
diff --git a/src/sentry/static/sentry/app/views/onboarding/createProject.jsx b/src/sentry/static/sentry/app/views/onboarding/createProject.jsx
index 049e2785b0..91411702e4 100644
--- a/src/sentry/static/sentry/app/views/onboarding/createProject.jsx
+++ b/src/sentry/static/sentry/app/views/onboarding/createProject.jsx
@@ -106,7 +106,10 @@ const CreateProject = createReactClass({
           error: err.responseJSON.detail,
         });
 
-        if (err.status != 403) {
+        // Only log this if the error is something other than:
+        // * The user not having access to create a project, or,
+        // * A project with that slug already exists
+        if (err.status !== 403 && err.status !== 409) {
           Raven.captureMessage('Onboarding project creation failed', {
             extra: {
               err,
diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/index.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/index.jsx
index a881ef578f..62ea520439 100644
--- a/src/sentry/static/sentry/app/views/organizationDashboard/index.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDashboard/index.jsx
@@ -1,3 +1,4 @@
+import {Link} from 'react-router';
 import LazyLoad from 'react-lazyload';
 import React from 'react';
 import PropTypes from 'prop-types';
@@ -41,7 +42,8 @@ class Dashboard extends React.Component {
     const {projectsByTeam} = getProjectsByTeams(teams, sortedProjects);
     const teamSlugs = Object.keys(projectsByTeam).sort();
     const favorites = projects.filter(project => project.isBookmarked);
-    const hasTeamAccess = new Set(organization.access).has('team:read');
+    const access = new Set(organization.access);
+    const hasTeamAccess = access.has('team:read');
     const teamsMap = new Map(teams.map(teamObj => [teamObj.slug, teamObj]));
 
     return (
@@ -72,7 +74,11 @@ class Dashboard extends React.Component {
                 team={team}
                 hasTeamAccess={hasTeamAccess}
                 showBorder={showBorder}
-                title={<IdBadge team={team} />}
+                title={
+                  <TeamLink to={`/settings/${organization.slug}/teams/${team.slug}/`}>
+                    <IdBadge team={team} />
+                  </TeamLink>
+                }
                 projects={projectsByTeam[slug]}
               />
             </LazyLoad>
@@ -111,5 +117,11 @@ const OrganizationDashboard = createReactClass({
 const TeamSectionPlaceholder = styled('div')`
   height: 180px;
 `;
+
+const TeamLink = styled(Link)`
+  display: flex;
+  align-items: center;
+`;
+
 export {Dashboard};
 export default withTeams(withProjects(OrganizationDashboard));
diff --git a/src/sentry/static/sentry/app/views/organizationDashboard/teamSection.jsx b/src/sentry/static/sentry/app/views/organizationDashboard/teamSection.jsx
index 6efec99af8..aa296d5d86 100644
--- a/src/sentry/static/sentry/app/views/organizationDashboard/teamSection.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDashboard/teamSection.jsx
@@ -66,6 +66,7 @@ const TeamTitleBar = styled(Flex)`
 const TeamName = styled.h4`
   margin: 0;
   font-size: 20px;
+  line-height: 24px; /* We need this so that header doesn't flicker when lazy loading because avatarList height > this */
 `;
 
 export default TeamSection;
diff --git a/src/sentry/static/sentry/app/views/settings/team/teamProjects.jsx b/src/sentry/static/sentry/app/views/settings/team/teamProjects.jsx
index bb13bc57f6..0755c89226 100644
--- a/src/sentry/static/sentry/app/views/settings/team/teamProjects.jsx
+++ b/src/sentry/static/sentry/app/views/settings/team/teamProjects.jsx
@@ -3,6 +3,7 @@ import createReactClass from 'create-react-class';
 import Reflux from 'reflux';
 import styled from 'react-emotion';
 
+import Tooltip from 'app/components/tooltip';
 import ApiMixin from 'app/mixins/apiMixin';
 import {addErrorMessage, addSuccessMessage} from 'app/actionCreators/indicator';
 import space from 'app/styles/space';
@@ -16,7 +17,6 @@ import OrganizationState from 'app/mixins/organizationState';
 import ProjectListItem from 'app/views/settings/components/settingsProjectItem';
 import {Panel, PanelHeader, PanelBody, PanelItem} from 'app/components/panels';
 import InlineSvg from 'app/components/inlineSvg';
-
 import {sortProjects} from 'app/utils';
 import {t} from 'app/locale';
 
@@ -84,18 +84,27 @@ const TeamProjects = createReactClass({
   },
 
   projectPanelcontents(projects) {
+    let access = this.getAccess();
+    let canWrite = access.has('org:write');
+
     return projects.length ? (
       sortProjects(projects).map((project, i) => (
         <StyledPanelItem key={project.id}>
           <ProjectListItem project={project} organization={this.context.organization} />
-          <Button
-            size="small"
-            onClick={() => {
-              this.handleLinkProject(project, 'remove');
-            }}
+          <Tooltip
+            disabled={canWrite}
+            title={t('You do not have enough permission to change project association.')}
           >
-            <RemoveIcon /> {t('Remove')}
-          </Button>
+            <Button
+              size="small"
+              disabled={!canWrite}
+              onClick={() => {
+                this.handleLinkProject(project, 'remove');
+              }}
+            >
+              <RemoveIcon /> {t('Remove')}
+            </Button>
+          </Tooltip>
         </StyledPanelItem>
       ))
     ) : (
@@ -109,10 +118,10 @@ const TeamProjects = createReactClass({
     if (this.state.error) return <LoadingError onRetry={this.fetchData} />;
 
     let {projectListLinked, allProjects} = this.state;
-    let linkedProjectIds = new Set(projectListLinked.map(p => p.id));
+    let access = this.getAccess();
 
+    let linkedProjectIds = new Set(projectListLinked.map(p => p.id));
     let linkedProjects = allProjects.filter(p => linkedProjectIds.has(p.id));
-
     let otherProjects = allProjects
       .filter(p => {
         return !linkedProjectIds.has(p.id);
@@ -130,17 +139,27 @@ const TeamProjects = createReactClass({
         <PanelHeader hasButtons={true}>
           <div>{t('Projects')}</div>
           <div style={{textTransform: 'none'}}>
-            <DropdownAutoComplete
-              items={otherProjects}
-              onSelect={this.handleProjectSelected}
-              emptyMessage={t('No projects')}
-            >
-              {({isOpen, selectedItem}) => (
-                <DropdownButton isOpen={isOpen} size="xsmall">
-                  {t('Add Project')}
-                </DropdownButton>
-              )}
-            </DropdownAutoComplete>
+            {!access.has('org:write') ? (
+              <DropdownButton
+                disabled
+                title={t('You do not have enough permission to associate a project.')}
+                size="xsmall"
+              >
+                {t('Add Project')}
+              </DropdownButton>
+            ) : (
+              <DropdownAutoComplete
+                items={otherProjects}
+                onSelect={this.handleProjectSelected}
+                emptyMessage={t('No projects')}
+              >
+                {({isOpen, selectedItem}) => (
+                  <DropdownButton isOpen={isOpen} size="xsmall">
+                    {t('Add Project')}
+                  </DropdownButton>
+                )}
+              </DropdownAutoComplete>
+            )}
           </div>
         </PanelHeader>
         <PanelBody>{this.projectPanelcontents(linkedProjects)}</PanelBody>
diff --git a/tests/js/spec/views/__snapshots__/organizationTeamProjects.spec.jsx.snap b/tests/js/spec/views/__snapshots__/organizationTeamProjects.spec.jsx.snap
index f71964e453..8d76f0f7bf 100644
--- a/tests/js/spec/views/__snapshots__/organizationTeamProjects.spec.jsx.snap
+++ b/tests/js/spec/views/__snapshots__/organizationTeamProjects.spec.jsx.snap
@@ -487,93 +487,98 @@ exports[`OrganizationTeamProjects Should render 1`] = `
                           </Link>
                         </div>
                       </ProjectItem>
-                      <Button
-                        disabled={false}
-                        onClick={[Function]}
-                        size="small"
+                      <Tooltip
+                        disabled={true}
+                        title="You do not have enough permission to change project association."
                       >
-                        <StyledButton
+                        <Button
                           disabled={false}
                           onClick={[Function]}
-                          role="button"
                           size="small"
                         >
-                          <Component
-                            className="css-dkprmi-StyledButton-getColors e17811v30"
+                          <StyledButton
                             disabled={false}
                             onClick={[Function]}
                             role="button"
                             size="small"
                           >
-                            <button
+                            <Component
                               className="css-dkprmi-StyledButton-getColors e17811v30"
                               disabled={false}
                               onClick={[Function]}
                               role="button"
                               size="small"
                             >
-                              <ButtonLabel
+                              <button
+                                className="css-dkprmi-StyledButton-getColors e17811v30"
+                                disabled={false}
+                                onClick={[Function]}
+                                role="button"
                                 size="small"
                               >
-                                <Component
-                                  className="css-179w01k-ButtonLabel e17811v31"
+                                <ButtonLabel
                                   size="small"
                                 >
-                                  <Flex
-                                    align="center"
+                                  <Component
                                     className="css-179w01k-ButtonLabel e17811v31"
                                     size="small"
                                   >
-                                    <Base
+                                    <Flex
                                       align="center"
-                                      className="e17811v31 css-8mahft-ButtonLabel"
+                                      className="css-179w01k-ButtonLabel e17811v31"
                                       size="small"
                                     >
-                                      <div
+                                      <Base
+                                        align="center"
                                         className="e17811v31 css-8mahft-ButtonLabel"
-                                        is={null}
                                         size="small"
                                       >
-                                        <RemoveIcon>
-                                          <Component
-                                            className="css-1e2j5j0-RemoveIcon er5mk5i0"
-                                          >
-                                            <InlineSvg
+                                        <div
+                                          className="e17811v31 css-8mahft-ButtonLabel"
+                                          is={null}
+                                          size="small"
+                                        >
+                                          <RemoveIcon>
+                                            <Component
                                               className="css-1e2j5j0-RemoveIcon er5mk5i0"
-                                              src="icon-circle-subtract"
                                             >
-                                              <StyledSvg
+                                              <InlineSvg
                                                 className="css-1e2j5j0-RemoveIcon er5mk5i0"
-                                                height="1em"
-                                                viewBox={Object {}}
-                                                width="1em"
+                                                src="icon-circle-subtract"
                                               >
-                                                <svg
-                                                  className="er5mk5i0 css-10g0ex9-StyledSvg-RemoveIcon e2idor0"
+                                                <StyledSvg
+                                                  className="css-1e2j5j0-RemoveIcon er5mk5i0"
                                                   height="1em"
                                                   viewBox={Object {}}
                                                   width="1em"
                                                 >
-                                                  <use
-                                                    href="#test"
-                                                    xlinkHref="#test"
-                                                  />
-                                                </svg>
-                                              </StyledSvg>
-                                            </InlineSvg>
-                                          </Component>
-                                        </RemoveIcon>
-                                         
-                                        Remove
-                                      </div>
-                                    </Base>
-                                  </Flex>
-                                </Component>
-                              </ButtonLabel>
-                            </button>
-                          </Component>
-                        </StyledButton>
-                      </Button>
+                                                  <svg
+                                                    className="er5mk5i0 css-10g0ex9-StyledSvg-RemoveIcon e2idor0"
+                                                    height="1em"
+                                                    viewBox={Object {}}
+                                                    width="1em"
+                                                  >
+                                                    <use
+                                                      href="#test"
+                                                      xlinkHref="#test"
+                                                    />
+                                                  </svg>
+                                                </StyledSvg>
+                                              </InlineSvg>
+                                            </Component>
+                                          </RemoveIcon>
+                                           
+                                          Remove
+                                        </div>
+                                      </Base>
+                                    </Flex>
+                                  </Component>
+                                </ButtonLabel>
+                              </button>
+                            </Component>
+                          </StyledButton>
+                        </Button>
+                      </Tooltip>
                     </div>
                   </Base>
                 </StyledPanelItem>
