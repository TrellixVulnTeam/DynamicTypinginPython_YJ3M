commit 9c1b8b3dbfe92f636d08f6db0de58bfc852e5b36
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Jan 27 13:28:48 2013 -0800

    limit the maximum length of messages

diff --git a/src/sentry/coreapi.py b/src/sentry/coreapi.py
index 4354fb1080..15a54bf9d7 100644
--- a/src/sentry/coreapi.py
+++ b/src/sentry/coreapi.py
@@ -30,6 +30,8 @@ from sentry.utils.queue import maybe_delay
 
 logger = logging.getLogger('sentry.errors.coreapi')
 
+MAX_MESSAGE_LENGTH = 1000
+
 RESERVED_FIELDS = (
     'project',
     'event_id',
@@ -262,6 +264,9 @@ def validate_data(project, data, client=None):
 
     if not data.get('message'):
         data['message'] = '<no message value>'
+    elif len(data['message']) > MAX_MESSAGE_LENGTH:
+        raise InvalidData('Value \'message\' is too long. At %d chars, max is %s.' % (
+            len(data['message']), MAX_MESSAGE_LENGTH))
 
     if not data.get('event_id'):
         data['event_id'] = uuid.uuid4().hex
diff --git a/src/sentry/models.py b/src/sentry/models.py
index 04a5e192c4..e7681dac6b 100644
--- a/src/sentry/models.py
+++ b/src/sentry/models.py
@@ -485,6 +485,9 @@ class Group(MessageBase):
             self.first_seen = self.last_seen
         if not self.active_at:
             self.active_at = self.first_seen
+        if self.message:
+            # We limit what we store for the message body
+            self.message = self.message.splitlines()[0][:255]
         super(Group, self).save(*args, **kwargs)
 
     @property
diff --git a/src/sentry/templates/sentry/groups/details.html b/src/sentry/templates/sentry/groups/details.html
index 4d54deb503..704136da9d 100644
--- a/src/sentry/templates/sentry/groups/details.html
+++ b/src/sentry/templates/sentry/groups/details.html
@@ -104,8 +104,8 @@
             {% block inner %}
                 {% include "sentry/partial/event_nav.html" %}
 
-                {% if group.has_two_part_message %}
-                    <pre id="full-message">{{ group.message }}</pre>
+                {% if event.has_two_part_message %}
+                    <pre id="full-message">{{ event.message }}</pre>
                 {% endif %}
 
                 {% if group|has_charts %}
