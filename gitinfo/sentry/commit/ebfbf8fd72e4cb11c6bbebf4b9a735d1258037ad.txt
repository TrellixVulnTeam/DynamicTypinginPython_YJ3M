commit ebfbf8fd72e4cb11c6bbebf4b9a735d1258037ad
Author: Dan Fuller <dfuller@sentry.io>
Date:   Tue Feb 11 17:08:28 2020 -0800

    fix(incidents): Use `resolve_discover_aliases` to resolve conditions when making queries about an Incident
    
    Missed this after the fix for creating subscriptions.
    
    Fixes SENTRY-F2N

diff --git a/src/sentry/incidents/logic.py b/src/sentry/incidents/logic.py
index 1ff10ea695..736e6220d0 100644
--- a/src/sentry/incidents/logic.py
+++ b/src/sentry/incidents/logic.py
@@ -37,6 +37,7 @@ from sentry.incidents.models import (
 )
 from sentry.snuba.discover import zerofill
 from sentry.models import Integration, Project
+from sentry.snuba.discover import resolve_discover_aliases
 from sentry.snuba.models import QueryAggregations, QueryDatasets
 from sentry.snuba.subscriptions import (
     bulk_create_snuba_subscriptions,
@@ -432,16 +433,16 @@ def bulk_build_incident_query_params(incidents, start=None, end=None):
         if project_ids:
             params["project_id"] = project_ids
 
-        filter = get_filter(incident.query, params)
-
-        query_args_list.append(
-            {
-                "start": filter.start,
-                "end": filter.end,
-                "conditions": filter.conditions,
-                "filter_keys": filter.filter_keys,
-            }
-        )
+        snuba_filter = get_filter(incident.query, params)
+        snuba_args = {
+            "start": snuba_filter.start,
+            "end": snuba_filter.end,
+            "conditions": snuba_filter.conditions,
+            "filter_keys": snuba_filter.filter_keys,
+            "having": [],
+        }
+        snuba_args["conditions"] = resolve_discover_aliases(snuba_args)[0]["conditions"]
+        query_args_list.append(snuba_args)
 
     return query_args_list
 
