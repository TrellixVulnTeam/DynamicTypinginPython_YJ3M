commit 86d3cc9f6ba0e82065eb6db1c3aabe71dba81613
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Mon Dec 7 21:52:26 2015 +0100

    Checked in generated cli command docs

diff --git a/bin/dump-command-help b/bin/dump-command-help
index 4fbe9d2d1c..229fa221e9 100644
--- a/bin/dump-command-help
+++ b/bin/dump-command-help
@@ -23,7 +23,10 @@ def get_opts(param):
 
 def write_page(out, data):
     path = data['path']
-    filename = os.path.join(out, *path) + '/index.rst'
+    filename = os.path.join(out, *path[1:]) + '/index.rst'
+    if len(path) == 1:
+        filename += '.inc'
+
     dirname = os.path.dirname(filename)
     try:
         os.makedirs(dirname)
@@ -34,14 +37,14 @@ def write_page(out, data):
     title = '`%s`' % ' '.join(data['path'] + args)
     body = [
         title,
-        '=' * len(title),
+        '-' * len(title),
         '',
         data['help'] or '',
     ]
 
     body.append('')
     body.append('Options')
-    body.append('-------')
+    body.append('```````')
     body.append('')
     for opt in data['options']:
         prefix = '- `%s`: ' % opt['opt_string']
@@ -53,12 +56,13 @@ def write_page(out, data):
     if data['subcommands']:
         body.append('')
         body.append('Subcommands')
-        body.append('-----------')
+        body.append('```````````')
         body.append('')
         body.append('.. toctree::')
+        body.append(' :maxdepth: 1')
         body.append('')
         for subcmd in data['subcommands']:
-            body.append(' %s/index' % subcmd)
+            body.append(' %s <%s/index>' % (subcmd, subcmd))
         body.append('')
 
     with open(filename, 'w') as f:
diff --git a/docs/cli.rst b/docs/cli.rst
deleted file mode 100644
index 8838609b1f..0000000000
--- a/docs/cli.rst
+++ /dev/null
@@ -1,61 +0,0 @@
-Command Line Usage
-==================
-
-Sentry installs a command line script under the name ``sentry``. This will
-allow you to perform most required operations that are unachievable within
-the web UI.
-
-If you're using a non-standard configuration location make sure you to pass the
-configuration via the ``SENTRY_CONF`` environment variable::
-
-    SENTRY_CONF=/www/sentry/sentry.conf.py sentry help
-
-For a list of commands, you can also use ``sentry help``, or ``sentry
-[command] --help`` for help on a specific command.
-
-Builtin Commands
-----------------
-
-.. describe:: init [config]
-
-    Initializes the configuration file for Sentry.
-
-    Defaults to ~/.sentry/sentry.conf.py
-
-    ::
-
-        sentry init /etc/sentry.conf.py
-
-    .. note:: The init command requires you to pass the configuration
-              value as the parameter whereas other commands require you
-              to use --config for passing the location of this file.
-
-.. describe:: start
-
-    Starts the built-in Sentry webservice.
-
-.. describe:: upgrade
-
-    Performs any needed database migrations (or related operations).
-
-.. describe:: createuser
-
-    Creates a new user.
-
-.. describe:: cleanup
-
-    Performs all trim operations based on your configuration.
-
-.. describe:: repair
-
-    Performs any needed repair against the Sentry database. This will attempt to correct
-    things like missing teams, project keys, etc.
-
-.. describe:: export
-
-    Exports all system configuration tables to a JSON file. This will not export event
-    data.
-
-.. describe:: import
-
-    Imports a JSON export. Used in conjuction with ``export``.
diff --git a/docs/cli/celery/index.rst b/docs/cli/celery/index.rst
new file mode 100644
index 0000000000..8b1726ea17
--- /dev/null
+++ b/docs/cli/celery/index.rst
@@ -0,0 +1,9 @@
+`lektor celery [MANAGEMENT_ARGS]...`
+------------------------------------
+
+Start background workers.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/cleanup/index.rst b/docs/cli/cleanup/index.rst
new file mode 100644
index 0000000000..d209e5140d
--- /dev/null
+++ b/docs/cli/cleanup/index.rst
@@ -0,0 +1,12 @@
+`lektor cleanup`
+----------------
+
+Delete a portion of trailing data based on creation date.
+
+Options
+```````
+
+- `--days INTEGER`: Numbers of days to truncate on.
+- `--project INTEGER`: Limit truncation to only entries from project.
+- `--concurrency INTEGER`: The number of concurrent workers to run.
+- `--help`: print this help page.
diff --git a/docs/cli/createuser/index.rst b/docs/cli/createuser/index.rst
new file mode 100644
index 0000000000..adec0a524e
--- /dev/null
+++ b/docs/cli/createuser/index.rst
@@ -0,0 +1,9 @@
+`lektor createuser`
+-------------------
+
+Create a new user.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/devserver/index.rst b/docs/cli/devserver/index.rst
new file mode 100644
index 0000000000..dc57bdcda4
--- /dev/null
+++ b/docs/cli/devserver/index.rst
@@ -0,0 +1,9 @@
+`lektor devserver [MANAGEMENT_ARGS]...`
+---------------------------------------
+
+Start a light Web server for development.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/django/index.rst b/docs/cli/django/index.rst
new file mode 100644
index 0000000000..8c4718197f
--- /dev/null
+++ b/docs/cli/django/index.rst
@@ -0,0 +1,9 @@
+`lektor django [MANAGEMENT_ARGS]...`
+------------------------------------
+
+Execute Django subcommands.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/export/index.rst b/docs/cli/export/index.rst
new file mode 100644
index 0000000000..09eb25b59c
--- /dev/null
+++ b/docs/cli/export/index.rst
@@ -0,0 +1,9 @@
+`lektor export [DEST]`
+----------------------
+
+Exports core metadata for the Sentry installation.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/help/index.rst b/docs/cli/help/index.rst
new file mode 100644
index 0000000000..7edaf4bd44
--- /dev/null
+++ b/docs/cli/help/index.rst
@@ -0,0 +1,9 @@
+`lektor help`
+-------------
+
+Show this message and exit.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/import/index.rst b/docs/cli/import/index.rst
new file mode 100644
index 0000000000..384d6f8056
--- /dev/null
+++ b/docs/cli/import/index.rst
@@ -0,0 +1,9 @@
+`lektor import SRC`
+-------------------
+
+Imports data from a Sentry export.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/index.rst b/docs/cli/index.rst
new file mode 100644
index 0000000000..0f52b55a99
--- /dev/null
+++ b/docs/cli/index.rst
@@ -0,0 +1,16 @@
+Command Line Usage
+==================
+
+Sentry installs a command line script under the name ``sentry``. This will
+allow you to perform most required operations that are unachievable within
+the web UI.
+
+If you're using a non-standard configuration location make sure you to pass the
+configuration via the ``SENTRY_CONF`` environment variable::
+
+    SENTRY_CONF=/www/sentry/sentry.conf.py sentry help
+
+For a list of commands, you can also use ``sentry help``, or ``sentry
+[command] --help`` for help on a specific command.
+
+.. include:: index.rst.inc
diff --git a/docs/cli/index.rst.inc b/docs/cli/index.rst.inc
new file mode 100644
index 0000000000..f5352a4414
--- /dev/null
+++ b/docs/cli/index.rst.inc
@@ -0,0 +1,32 @@
+`lektor`
+--------
+
+Sentry is cross-platform crash reporting built with love.
+
+Options
+```````
+
+- `--config PATH`: Path to configuration files.
+- `--version`: Show the version and exit.
+- `--help`: print this help page.
+
+Subcommands
+```````````
+
+.. toctree::
+ :maxdepth: 1
+
+ repair <repair/index>
+ upgrade <upgrade/index>
+ help <help/index>
+ devserver <devserver/index>
+ django <django/index>
+ celery <celery/index>
+ start <start/index>
+ init <init/index>
+ cleanup <cleanup/index>
+ export <export/index>
+ createuser <createuser/index>
+ import <import/index>
+ shell <shell/index>
+
diff --git a/docs/cli/init/index.rst b/docs/cli/init/index.rst
new file mode 100644
index 0000000000..60cd7c665f
--- /dev/null
+++ b/docs/cli/init/index.rst
@@ -0,0 +1,9 @@
+`lektor init [DIRECTORY]`
+-------------------------
+
+Initialize new configuration directory.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/repair/index.rst b/docs/cli/repair/index.rst
new file mode 100644
index 0000000000..9d2703d787
--- /dev/null
+++ b/docs/cli/repair/index.rst
@@ -0,0 +1,9 @@
+`lektor repair`
+---------------
+
+Attempt to repair any invalid data.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/shell/index.rst b/docs/cli/shell/index.rst
new file mode 100644
index 0000000000..a9d94f6656
--- /dev/null
+++ b/docs/cli/shell/index.rst
@@ -0,0 +1,9 @@
+`lektor shell [MANAGEMENT_ARGS]...`
+-----------------------------------
+
+Run a Python interactive interpreter.
+
+Options
+```````
+
+- `--help`: print this help page.
diff --git a/docs/cli/start/index.rst b/docs/cli/start/index.rst
new file mode 100644
index 0000000000..ff28353ec1
--- /dev/null
+++ b/docs/cli/start/index.rst
@@ -0,0 +1,12 @@
+`lektor start [SERVICE]`
+------------------------
+
+Start running a service.
+
+Options
+```````
+
+- `-b, --bind ADDRESS`: Bind address.
+- `--upgrade`: Upgrade before starting.
+- `--noinput`: Do not prompt the user for input of any kind.
+- `--help`: print this help page.
diff --git a/docs/cli/upgrade/index.rst b/docs/cli/upgrade/index.rst
new file mode 100644
index 0000000000..3716751b09
--- /dev/null
+++ b/docs/cli/upgrade/index.rst
@@ -0,0 +1,12 @@
+`lektor upgrade`
+----------------
+
+Perform any pending database migrations and upgrades.
+
+Options
+```````
+
+- `-v, --verbosity INTEGER`: Verbosity level.
+- `--traceback`: Raise on exception.
+- `--noinput`: Do not prompt the user for input of any kind.
+- `--help`: print this help page.
diff --git a/docs/index.rst b/docs/index.rst
index e5633e8c55..17df02df73 100644
--- a/docs/index.rst
+++ b/docs/index.rst
@@ -22,7 +22,7 @@ running on your own infrastructure.
    inbound-mail
    internal-metrics
    performance
-   cli
+   cli/index
    health-checks
    beacon
    plugins
