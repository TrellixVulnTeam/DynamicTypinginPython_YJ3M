commit 6a5bb4a6a1c4d2ecb1086ff091f13a089b5c4f07
Author: Jan Michael Auer <account@jauer.org>
Date:   Fri Nov 23 15:16:26 2018 +0100

    fix(eventtypes): Restore old event message behavior (#10745)

diff --git a/src/sentry/eventtypes/base.py b/src/sentry/eventtypes/base.py
index 9cae32ece9..0211ef195d 100644
--- a/src/sentry/eventtypes/base.py
+++ b/src/sentry/eventtypes/base.py
@@ -28,13 +28,13 @@ class DefaultEvent(BaseEvent):
         return True
 
     def get_metadata(self):
-        message = get_path(self.data, 'logentry', 'formatted') \
-            or get_path(self.data, 'logentry', 'message')
+        message = strip(get_path(self.data, 'logentry', 'formatted') or
+                        get_path(self.data, 'logentry', 'message'))
 
-        if not message:
-            title = '<unlabeled event>'
+        if message:
+            title = truncatechars(message.splitlines()[0], 100)
         else:
-            title = truncatechars(strip(message).splitlines()[0], 100)
+            title = '<unlabeled event>'
 
         return {
             'title': title,
diff --git a/tests/sentry/eventtypes/test_default.py b/tests/sentry/eventtypes/test_default.py
new file mode 100644
index 0000000000..8469272600
--- /dev/null
+++ b/tests/sentry/eventtypes/test_default.py
@@ -0,0 +1,40 @@
+from __future__ import absolute_import
+
+from sentry.eventtypes import DefaultEvent
+from sentry.testutils import TestCase
+
+
+class DefaultEventTest(TestCase):
+    def test_get_metadata(self):
+        inst = DefaultEvent({})
+        assert inst.get_metadata() == {
+            'title': '<unlabeled event>'
+        }
+
+        inst = DefaultEvent({
+            'logentry': {
+                'formatted': '  ',
+            }
+        })
+        assert inst.get_metadata() == {
+            'title': '<unlabeled event>'
+        }
+
+        inst = DefaultEvent({
+            'logentry': {
+                'formatted': 'foo',
+                'message': 'bar',
+            }
+        })
+        assert inst.get_metadata() == {
+            'title': 'foo'
+        }
+
+        inst = DefaultEvent({
+            'logentry': {
+                'message': 'foo',
+            }
+        })
+        assert inst.get_metadata() == {
+            'title': 'foo'
+        }
