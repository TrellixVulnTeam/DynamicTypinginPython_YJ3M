commit 6fb7ad53cbf078fe01f671649964c92f5c360ab3
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Sep 7 16:38:02 2011 -0700

    Add a better error message for when key isnt present

diff --git a/sentry/web/views.py b/sentry/web/views.py
index d4ffbf6c93..b98f3194eb 100644
--- a/sentry/web/views.py
+++ b/sentry/web/views.py
@@ -453,6 +453,16 @@ def store(request):
         else:
             return HttpResponse('Unauthorized', status_code=401)
     else:
+        # Legacy request (deprecated as of 2.0)
+        key = request.POST.get('key')
+
+        if not key:
+            return HttpResponseForbidden('Invalid credentials')
+        
+        if key != settings.KEY:
+            warnings.warn('A client is sending the `key` parameter, which will be removed in Sentry 2.0', DeprecationWarning)
+            return HttpResponseForbidden('Invalid credentials')
+
         data = request.POST.get('data')
         if not data:
             return HttpResponseBadRequest('Missing data')
@@ -462,13 +472,6 @@ def store(request):
         if format not in ('pickle', 'json'):
             return HttpResponseBadRequest('Invalid format')
 
-        # Legacy request (deprecated as of 2.0)
-        key = request.POST.get('key')
-        
-        if key != settings.KEY:
-            warnings.warn('A client is sending the `key` parameter, which will be removed in Sentry 2.0', DeprecationWarning)
-            return HttpResponseForbidden('Invalid credentials')
-
     logger = logging.getLogger('sentry.server')
 
     try:
