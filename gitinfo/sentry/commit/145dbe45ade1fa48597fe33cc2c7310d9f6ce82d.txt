commit 145dbe45ade1fa48597fe33cc2c7310d9f6ce82d
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Nov 10 13:49:40 2011 -0800

    Added JSON raw pane

diff --git a/sentry/templates/sentry/group/details.html b/sentry/templates/sentry/group/details.html
index 2a7ec32185..f7ffb1231f 100644
--- a/sentry/templates/sentry/group/details.html
+++ b/sentry/templates/sentry/group/details.html
@@ -31,6 +31,8 @@
         <dd title="{{ group.first_seen }}">{{ group.last_seen|timesince }}</dd>
     </dl>
 
+    <p><a href="{% url sentry-group-json project_id=project.pk group_id=group.pk %}">Raw JSON Data</a></p>
+
     {% for html in group|get_widgets:request %}
         {{ html|safe }}
     {% endfor %}
diff --git a/sentry/web/urls.py b/sentry/web/urls.py
index 696261eeb4..4a92daa883 100644
--- a/sentry/web/urls.py
+++ b/sentry/web/urls.py
@@ -72,6 +72,7 @@ urlpatterns = patterns('',
     # Project specific
 
     url(r'^(?P<project_id>\d+)/group/(?P<group_id>\d+)$', views.group, name='sentry-group'),
+    url(r'^(?P<project_id>\d+)/group/(?P<group_id>\d+)/json$', views.group_json, name='sentry-group-json'),
     url(r'^(?P<project_id>\d+)/group/(?P<group_id>\d+)/messages$', views.group_message_list, name='sentry-group-messages'),
     url(r'^(?P<project_id>\d+)/group/(?P<group_id>\d+)/messages/(?P<message_id>\d+)$', views.group_message_details, name='sentry-group-message'),
     url(r'^(?P<project_id>\d+)/group/(?P<group_id>\d+)/actions/(?P<slug>[\w_-]+)', views.group_plugin_action, name='sentry-group-plugin-action'),
diff --git a/sentry/web/views.py b/sentry/web/views.py
index a23f8ae763..473a3f5f87 100644
--- a/sentry/web/views.py
+++ b/sentry/web/views.py
@@ -340,6 +340,23 @@ def index(request, project):
         'filters': filters,
     })
 
+@login_required
+@can_manage('read_message')
+def group_json(request, project, group_id):
+    group = get_object_or_404(Group, pk=group_id)
+
+    if group.project and group.project != project:
+        return HttpResponse(status_code=404)
+
+    try:
+        event = group.get_latest_event()
+    except IndexError:
+        # It's possible that a message would not be created under certain circumstances
+        # (such as a post_save signal failing)
+        event = Event(group=group)
+
+    return HttpResponse(json.dumps(event.data), mimetype='application/json')
+
 @login_required
 @can_manage('read_message')
 def group(request, project, group_id):
