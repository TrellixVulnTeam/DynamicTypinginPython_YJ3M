commit 352ce79195b21b641ef0484622a5048d507be204
Author: Stephen Cefali <scefali@sentry.io>
Date:   Fri Sep 20 09:24:04 2019 -0700

    Feat(app-platform): Adds hack for split to show installation ID after installation (#14471)

diff --git a/src/sentry/static/sentry/app/views/organizationIntegrations/SplitInstallationIdModal.tsx b/src/sentry/static/sentry/app/views/organizationIntegrations/SplitInstallationIdModal.tsx
new file mode 100644
index 0000000000..d894f9d149
--- /dev/null
+++ b/src/sentry/static/sentry/app/views/organizationIntegrations/SplitInstallationIdModal.tsx
@@ -0,0 +1,73 @@
+import PropTypes from 'prop-types';
+import React from 'react';
+import styled from 'react-emotion';
+import Button from 'app/components/button';
+
+import TextCopyInput from 'app/views/settings/components/forms/textCopyInput';
+import IndicatorStore from 'app/stores/indicatorStore';
+
+type Props = {
+  installationId: string;
+  closeModal: () => void;
+};
+
+/**
+ * This component is a short term hack for Split.
+ * It will display the installation ID after installation so users can copy it and paste it in Split's website.
+ * We also have a link for users to click so they can go to Split's website.
+ */
+export default class SplitInstallationIdModal extends React.Component<Props> {
+  static propTypes = {
+    installationId: PropTypes.string.isRequired,
+    closeModal: PropTypes.func.isRequired,
+  };
+
+  onCopy = async () => {
+    //This hack is needed because the normal copying methods with TextCopyInput do not work correctly
+    return await navigator.clipboard.writeText(this.props.installationId);
+  };
+
+  handleContinue = () => {
+    const delay = 2000;
+    this.onCopy();
+    IndicatorStore.add('Copied to clipboard', 'success', {duration: delay});
+    setTimeout(() => {
+      window.open('https://app.split.io/admin/integrations');
+    }, delay);
+  };
+
+  render() {
+    const {installationId, closeModal} = this.props;
+    //no need to translate this temporary component
+    return (
+      <div>
+        <ItemHolder>
+          Copy this Installation ID and click to continue. You will use it to finish setup
+          on Split.io.
+        </ItemHolder>
+        <ItemHolder>
+          <TextCopyInput onCopy={this.onCopy}>{installationId}</TextCopyInput>
+        </ItemHolder>
+        <ButtonHolder>
+          <Button size="small" onClick={closeModal}>
+            Close
+          </Button>
+          <Button size="small" priority="primary" onClick={this.handleContinue}>
+            Copy and Open Link
+          </Button>
+        </ButtonHolder>
+      </div>
+    );
+  }
+}
+
+const ItemHolder = styled('div')`
+  margin: 10px;
+`;
+
+const ButtonHolder = styled(ItemHolder)`
+  text-align: right;
+  & button {
+    margin: 5px;
+  }
+`;
diff --git a/src/sentry/static/sentry/app/views/organizationIntegrations/sentryAppInstallationDetail.tsx b/src/sentry/static/sentry/app/views/organizationIntegrations/sentryAppInstallationDetail.tsx
index d664d85f99..32ee64f211 100644
--- a/src/sentry/static/sentry/app/views/organizationIntegrations/sentryAppInstallationDetail.tsx
+++ b/src/sentry/static/sentry/app/views/organizationIntegrations/sentryAppInstallationDetail.tsx
@@ -12,6 +12,8 @@ import {
 import {Client} from 'app/api';
 import {addQueryParamsToExistingUrl} from 'app/utils/queryString';
 import {Organization, SentryApp, SentryAppInstallation} from 'app/types';
+import {openModal} from 'app/actionCreators/modal';
+import SplitInstallationIdModal from 'app/views/organizationIntegrations/SplitInstallationIdModal';
 
 type Props = {
   api: Client;
@@ -47,6 +49,14 @@ class SentryAppInstallationDetail extends React.Component<Props> {
       const redirectUrl = addQueryParamsToExistingUrl(app.redirectUrl, queryParams);
       window.location.assign(redirectUrl);
     }
+
+    //hack for split so we can show the install ID to users for them to copy
+    //Will remove once the proper fix is in place
+    if (app.slug === 'split') {
+      openModal(({closeModal}) => (
+        <SplitInstallationIdModal installationId={install.uuid} closeModal={closeModal} />
+      ));
+    }
   };
 
   handleInstall = () => {
