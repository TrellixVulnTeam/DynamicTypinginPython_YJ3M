commit af1fedb01c65a4a219a3a99830f6f129ede3339c
Author: Ayesha Omarali <ayesha.omarali@gmail.com>
Date:   Thu Nov 15 12:54:04 2018 -0800

    feat(echarts): Add Truncation Utils Function for Tooltip, X-Axis, and Legends (#10596)

diff --git a/src/sentry/static/sentry/app/components/charts/components/legend.jsx b/src/sentry/static/sentry/app/components/charts/components/legend.jsx
index 911f9ec9f7..7ce3527866 100644
--- a/src/sentry/static/sentry/app/components/charts/components/legend.jsx
+++ b/src/sentry/static/sentry/app/components/charts/components/legend.jsx
@@ -1,25 +1,17 @@
 import 'echarts/lib/component/legend';
 import 'echarts/lib/component/legendScroll';
-
-const DEFAULT_TRUNCATE_LENGTH = 80;
+import {truncationFormatter} from '../utils';
 
 export default function Legend({truncate, ...props} = {}) {
-  let truncateLength =
-    truncate && typeof truncate === 'number' ? truncate : DEFAULT_TRUNCATE_LENGTH;
+  const formatter = value => {
+    return truncationFormatter(value, truncate);
+  };
 
   return {
     show: true,
     type: 'scroll',
     padding: 0,
-    formatter: truncate
-      ? function(name) {
-          if (name.length > truncateLength) {
-            return name.substring(0, truncateLength) + '...';
-          } else {
-            return name;
-          }
-        }
-      : null,
+    formatter,
     ...props,
   };
 }
diff --git a/src/sentry/static/sentry/app/components/charts/components/tooltip.jsx b/src/sentry/static/sentry/app/components/charts/components/tooltip.jsx
index 6a3ccc8fe0..f3b75b6478 100644
--- a/src/sentry/static/sentry/app/components/charts/components/tooltip.jsx
+++ b/src/sentry/static/sentry/app/components/charts/components/tooltip.jsx
@@ -1,23 +1,6 @@
 import moment from 'moment';
 import 'echarts/lib/component/tooltip';
-
-const DEFAULT_TRUNCATE_LENGTH = 80;
-
-// Truncates labels for tooltip
-function truncateLabel(seriesName, truncate) {
-  if (!truncate) {
-    return seriesName;
-  }
-
-  let result = seriesName;
-  let truncateLength = typeof truncate === 'number' ? truncate : DEFAULT_TRUNCATE_LENGTH;
-  0;
-
-  if (seriesName.length > truncateLength) {
-    result = seriesName.substring(0, truncateLength) + '…';
-  }
-  return result;
-}
+import {truncationFormatter} from '../utils';
 
 function formatAxisLabel(value, isTimestamp) {
   if (!isTimestamp) {
@@ -42,12 +25,12 @@ function getFormatter({filter, isGroupedByDate, truncate}) {
       seriesParams.length &&
       formatAxisLabel(seriesParams[0].axisValueLabel, isGroupedByDate);
     return [
-      `<div>${truncateLabel(label, truncate)}</div>`,
+      `<div>${truncationFormatter(label, truncate)}</div>`,
       seriesParams
         .filter(getFilter)
         .map(
           s =>
-            `<div>${s.marker} ${truncateLabel(s.seriesName, truncate)}:  ${s
+            `<div>${s.marker} ${truncationFormatter(s.seriesName, truncate)}:  ${s
               .data[1]}</div>`
         )
         .join(''),
diff --git a/src/sentry/static/sentry/app/components/charts/components/xAxis.jsx b/src/sentry/static/sentry/app/components/charts/components/xAxis.jsx
index c4d65caab2..eff658d2f2 100644
--- a/src/sentry/static/sentry/app/components/charts/components/xAxis.jsx
+++ b/src/sentry/static/sentry/app/components/charts/components/xAxis.jsx
@@ -1,6 +1,7 @@
 import moment from 'moment';
 
 import theme from 'app/utils/theme';
+import {truncationFormatter} from '../utils';
 
 export default function XAxis({isGroupedByDate, interval, ...props} = {}) {
   const axisLabelFormatter = value => {
@@ -10,8 +11,8 @@ export default function XAxis({isGroupedByDate, interval, ...props} = {}) {
         .utc(value)
         .local()
         .format(format);
-    } else if (props.truncate && value.length > props.truncate) {
-      return value.slice(0, props.truncate) + '…';
+    } else if (props.truncate) {
+      return truncationFormatter(value, props.truncate);
     } else {
       return undefined;
     }
diff --git a/src/sentry/static/sentry/app/components/charts/utils.jsx b/src/sentry/static/sentry/app/components/charts/utils.jsx
new file mode 100644
index 0000000000..fbcf593c50
--- /dev/null
+++ b/src/sentry/static/sentry/app/components/charts/utils.jsx
@@ -0,0 +1,12 @@
+const DEFAULT_TRUNCATE_LENGTH = 80;
+
+export function truncationFormatter(value, truncate) {
+  if (!truncate) {
+    return value;
+  }
+  let truncationLength =
+    truncate && typeof truncate === 'number' ? truncate : DEFAULT_TRUNCATE_LENGTH;
+  return value.length > truncationLength
+    ? value.substring(0, truncationLength) + '…'
+    : value;
+}
