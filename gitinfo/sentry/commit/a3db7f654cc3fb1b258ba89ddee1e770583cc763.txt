commit a3db7f654cc3fb1b258ba89ddee1e770583cc763
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Fri Feb 8 10:29:13 2019 -0800

    feat(ui): Show Global Selection Header when navigating to IssueDetails (#11989)
    
    This displays global selection header while issue details is still loading

diff --git a/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/globalSelectionHeader.jsx b/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/globalSelectionHeader.jsx
index b01f9b3b79..95cb88454c 100644
--- a/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/globalSelectionHeader.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/globalSelectionHeader/globalSelectionHeader.jsx
@@ -180,6 +180,11 @@ class GlobalSelectionHeader extends React.Component {
       return true;
     }
 
+    // Update if `forceProject` changes
+    if (this.props.forceProject !== nextProps.forceProject) {
+      return true;
+    }
+
     const nonDateKeys = ['projects', 'environments'];
     // Update if selection values change
     if (
diff --git a/src/sentry/static/sentry/app/views/groupDetails/shared/groupDetails.jsx b/src/sentry/static/sentry/app/views/groupDetails/shared/groupDetails.jsx
index e0557712a3..c30e4b9c8b 100644
--- a/src/sentry/static/sentry/app/views/groupDetails/shared/groupDetails.jsx
+++ b/src/sentry/static/sentry/app/views/groupDetails/shared/groupDetails.jsx
@@ -197,10 +197,11 @@ const GroupDetails = createReactClass({
     }
   },
 
-  renderContent() {
+  renderContent(shouldShowGlobalHeader) {
     const {params} = this.props;
     const {group, project} = this.state;
-    return (
+
+    const Content = (
       <DocumentTitle title={this.getTitle()}>
         <div className={this.props.className}>
           <GroupHeader params={params} project={project} group={group} />
@@ -211,11 +212,19 @@ const GroupDetails = createReactClass({
         </div>
       </DocumentTitle>
     );
+
+    // If we are showing global header (e.g. on Organization group details)
+    // We need `<PageContent>` for padding, otherwise render content as normal
+    if (shouldShowGlobalHeader) {
+      return <PageContent>{Content}</PageContent>;
+    }
+
+    return Content;
   },
 
   render() {
     const {organization, showGlobalHeader} = this.props;
-    const {group, project} = this.state;
+    const {group, project, loading} = this.state;
 
     if (this.state.error) {
       switch (this.state.errorType) {
@@ -228,24 +237,30 @@ const GroupDetails = createReactClass({
         default:
           return <LoadingError onRetry={this.remountComponent} />;
       }
-    } else if (this.state.loading || !group) return <LoadingIndicator />;
+    }
+
+    const isLoading = loading || !group;
 
     return (
       <Feature features={['sentry10']}>
-        {({hasFeature}) => (
-          <React.Fragment>
-            {hasFeature &&
-              showGlobalHeader && (
+        {({hasFeature: hasSentry10}) => {
+          const shouldShowGlobalHeader = hasSentry10 && showGlobalHeader;
+          return (
+            <React.Fragment>
+              {shouldShowGlobalHeader && (
                 <GlobalSelectionHeader
                   organization={organization}
                   forceProject={project}
                 />
               )}
-            {hasFeature &&
-              showGlobalHeader && <PageContent>{this.renderContent()}</PageContent>}
-            {!hasFeature && this.renderContent()}
-          </React.Fragment>
-        )}
+              {isLoading ? (
+                <LoadingIndicator />
+              ) : (
+                this.renderContent(shouldShowGlobalHeader)
+              )}
+            </React.Fragment>
+          );
+        }}
       </Feature>
     );
   },
