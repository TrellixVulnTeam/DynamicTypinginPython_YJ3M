commit 97599bfff9054ff1cafb75afa64addd6a711b112
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Aug 2 11:47:19 2013 -0700

    Ensure we bind slug looksup to team

diff --git a/src/sentry/web/decorators.py b/src/sentry/web/decorators.py
index 89a5c88527..fa3dd37a6d 100644
--- a/src/sentry/web/decorators.py
+++ b/src/sentry/web/decorators.py
@@ -62,12 +62,14 @@ def has_access(access_or_func=None, team=None, access=None):
 
             if project_id:
                 # Support project id's
-                if project_id.isdigit():
-                    lookup_kwargs = {'id': int(project_id)}
-                else:
-                    lookup_kwargs = {'slug': project_id}
-
                 if request.user.is_superuser:
+                    if project_id.isdigit():
+                        lookup_kwargs = {'id': int(project_id)}
+                    elif team:
+                        lookup_kwargs = {'slug': project_id, 'team': team}
+                    else:
+                        return HttpResponseRedirect(reverse('sentry'))
+
                     try:
                         project = Project.objects.get_from_cache(**lookup_kwargs)
                     except Project.DoesNotExist:
@@ -80,9 +82,17 @@ def has_access(access_or_func=None, team=None, access=None):
                         else:
                             return HttpResponseRedirect(reverse('sentry'))
                 else:
-                    key, value = lookup_kwargs.items()[0]
                     project_list = Project.objects.get_for_user(request.user, access, team=team)
 
+                    if project_id.isdigit():
+                        key = 'id'
+                        value = int(project_id)
+                    elif team:
+                        key = 'slug'
+                        value = project_id
+                    else:
+                        return HttpResponseRedirect(reverse('sentry'))
+
                     for p in project_list:
                         if getattr(p, key) == value:
                             project = p
