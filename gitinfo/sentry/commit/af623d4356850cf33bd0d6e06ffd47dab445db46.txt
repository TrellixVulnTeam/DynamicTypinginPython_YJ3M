commit af623d4356850cf33bd0d6e06ffd47dab445db46
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jan 21 21:31:22 2013 -0800

    Fix and implement a few things around nav

diff --git a/src/sentry/templates/sentry/bases/team.html b/src/sentry/templates/sentry/bases/team.html
index b9c61d264d..178dd167be 100644
--- a/src/sentry/templates/sentry/bases/team.html
+++ b/src/sentry/templates/sentry/bases/team.html
@@ -5,6 +5,18 @@
 {% block title %}{{ team.name }} | {{ block.super }}{% endblock %}
 
 {% block page_header %}
+    <ul class="breadcrumb pull-left" style="margin-right: 5px;">
+        <li><a href="{% url sentry-manage-team team.slug %}" class="dashboard-btn" title="{% trans "Dashboard" %}"><i aria-hidden="true" class="icon-cog"></i></a></li>
+        <li class="projects">
+            <select class="project-selector" data-placeholder="{% trans "Select a Project" %}">
+                <option value=""></option>
+                {% for p in PROJECT_LIST %}
+                    <option value="{{ p.slug }}"{% if p == project %} selected="selected"{% endif %} data-url="{% url sentry-manage-project p.team.slug p.slug %}">{{ p.name }}</option>
+                {% endfor %}
+            </select>
+        </li>
+    </ul>
+
     <ul class="nav nav-tabs">
         <li{% if SUBSECTION == 'settings' %} class="active"{% endif %}>
             <a href="{% url sentry-manage-team team.slug %}">{% trans "Settings" %}</a>
diff --git a/src/sentry/templates/sentry/layout.html b/src/sentry/templates/sentry/layout.html
index b54aa02246..d55f1ba349 100644
--- a/src/sentry/templates/sentry/layout.html
+++ b/src/sentry/templates/sentry/layout.html
@@ -100,9 +100,10 @@
                     <ul class="breadcrumb">
                         <li><a href="{% url sentry %}" class="dashboard-btn" title="{% trans "Dashboard" %}"><i aria-hidden="true" class="icon-list"></i></a></li>
                         <li class="projects">
-                            <select class="project-selector">
+                            <select class="project-selector" data-placeholder="{% trans "Select a Project" %}">
+                                <option value=""></option>
                                 {% for p in PROJECT_LIST %}
-                                    <option value="{{ p.slug }}"{% if p == project %} selected="selected"{% endif %} data-url="{% url sentry p.slug %}">{{ p.name }}</option>
+                                    <option value="{{ p.slug }}"{% if p == project %} selected="selected"{% endif %} data-url="{% url sentry-stream p.team.slug p.slug %}">{{ p.name }}</option>
                                 {% endfor %}
                             </select>
                         </li>
diff --git a/src/sentry/templates/sentry/projects/manage.html b/src/sentry/templates/sentry/projects/manage.html
index 2c03bd4b8b..3317097f51 100644
--- a/src/sentry/templates/sentry/projects/manage.html
+++ b/src/sentry/templates/sentry/projects/manage.html
@@ -65,7 +65,7 @@
 
 {% block sidebar %}
     <ul class="nav nav-list">
-        <li class="nav-header">{{ project.name }}</li>
+        <li class="nav-header">{% trans "Details" %}</li>
         <li{% if page == 'details' %} class="active"{% endif %}>
             <a href="{% url sentry-manage-project project.team.slug project.slug %}">{% trans "Settings" %}</a>
         </li>
@@ -75,9 +75,6 @@
         <li{% if page == 'tags' %} class="active"{% endif %}>
             <a href="{% url sentry-manage-project-tags project.team.slug project.slug %}">{% trans "Tags" %}</a>
         </li>
-        <li class="{% if page == 'plugins' %} active{% endif %}">
-            <a href="{% url sentry-manage-project-plugins project.team.slug project.slug %}">{% trans "Manage Plugins" %} ({{ PLUGINS|length }})</a>
-        </li>
     </ul>
     <ul class="nav nav-list">
         <li class="nav-header">{% trans "Client Configuration" %}</li>
@@ -104,15 +101,16 @@
         </li>
     </ul>
     {% with project|get_plugins as plugins %}
-        {% if plugins %}
-            <ul class="nav nav-list">
-                <li class="nav-header">{% trans "Active Plugins" %}</li>
-                {% for p in plugins %}
-                    <li{% if page == 'plugin' and plugin.slug == p.slug %} class="active"{% endif %}>
-                        <a href="{% url sentry-configure-project-plugin project.team.slug project.slug p.slug %}">{{ p.get_title }}</a>
-                    </li>
-                {% endfor %}
-            </ul>
-        {% endif %}
+        <ul class="nav nav-list">
+            <li class="nav-header">{% trans "Plugins" %}</li>
+            <li class="{% if page == 'plugins' %} active{% endif %}">
+                <a href="{% url sentry-manage-project-plugins project.team.slug project.slug %}">{% trans "Manage Plugins" %} ({{ PLUGINS|length }})</a>
+            </li>
+            {% for p in plugins %}
+                <li{% if page == 'plugin' and plugin.slug == p.slug %} class="active"{% endif %}>
+                    <a href="{% url sentry-configure-project-plugin project.team.slug project.slug p.slug %}">{{ p.get_title }}</a>
+                </li>
+            {% endfor %}
+        </ul>
     {% endwith %}
 {% endblock %}
diff --git a/src/sentry/web/decorators.py b/src/sentry/web/decorators.py
index 505ac32553..a44cd6b948 100644
--- a/src/sentry/web/decorators.py
+++ b/src/sentry/web/decorators.py
@@ -39,9 +39,11 @@ def has_access(group_or_func=None):
             has_team = 'team_slug' in kwargs
             has_project = 'project_id' in kwargs
 
+            team_slug = kwargs.pop('team_slug', None)
+            project_id = kwargs.pop('project_id', None)
+
             # Pull in team if it's part of the URL arguments
-            if kwargs.get('team_slug'):
-                team_slug = kwargs.pop('team_slug')
+            if team_slug:
                 if request.user.is_superuser:
                     try:
                         team = Team.objects.get_from_cache(slug=team_slug)
@@ -57,8 +59,7 @@ def has_access(group_or_func=None):
             else:
                 team = None
 
-            if kwargs.get('project_id'):
-                project_id = kwargs.pop('project_id')
+            if project_id:
                 # Support project id's
                 if project_id.isdigit():
                     lookup_kwargs = {'id': int(project_id)}
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index a999c433c2..81b52287df 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -49,7 +49,7 @@ urlpatterns = patterns('',
     # Settings - Teams
     url(r'^account/teams/$', teams.team_list, name='sentry-team-list'),
     url(r'^account/teams/new/$', teams.create_new_team, name='sentry-new-team'),
-    url(r'^account/teams/(?P<team_slug>[\w_-]+)/edit/$', teams.manage_team,
+    url(r'^account/teams/(?P<team_slug>[\w_-]+)/settings/$', teams.manage_team,
         name='sentry-manage-team'),
     url(r'^account/teams/(?P<team_slug>[\w_-]+)/remove/$', teams.remove_team,
         name='sentry-remove-team'),
