commit 1b2f593d5d14848b75dc46980d914099d83c5605
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Wed Apr 4 18:43:01 2018 -0700

    fix(integrations): Implement pipeline error modal

diff --git a/src/sentry/identity/oauth2.py b/src/sentry/identity/oauth2.py
index 3489668448..6cb288ead3 100644
--- a/src/sentry/identity/oauth2.py
+++ b/src/sentry/identity/oauth2.py
@@ -169,7 +169,7 @@ class OAuth2CallbackView(PipelineView):
 
         if 'error' in data:
             pipeline.logger.info('identity.token-exchange-error', extra={'error': data['error']})
-            return pipeline.error('Failed to retrieve toek from the upstream service.')
+            return pipeline.error('Failed to retrieve token from the upstream service.')
 
         # we can either expect the API to be implicit and say "im looking for
         # blah within state data" or we need to pass implementation + call a
diff --git a/src/sentry/templates/sentry/pipeline-error.html b/src/sentry/templates/sentry/pipeline-error.html
new file mode 100644
index 0000000000..2f1bc48344
--- /dev/null
+++ b/src/sentry/templates/sentry/pipeline-error.html
@@ -0,0 +1,33 @@
+{% extends "sentry/bases/modal.html" %}
+
+{% load i18n %}
+
+{% block wrapperclass %}narrow auth{% endblock %}
+{% block title %}{% trans "Setup Error" %} | {{ block.super }}{% endblock %}
+
+{% block main %}
+<div class="align-center">
+  <div style="font-size:28px;margin-bottom:10px">
+    <span class="icon-exclamation"></span>
+  </div>
+
+  <p>Whoops! Looks like something went wrong! Give that another try.</p>
+
+  <pre>{{ error }}</pre>
+</div>
+{% endblock %}
+
+{% block scripts_bottom %}
+  {{ block.super }}
+  <script>
+  // Integrations often use dialog windows for the pipeline flow. If this is a
+  // dialog window, resize it to nicely fit the error modal.
+  if (window.opener) {
+    var ele = document.getElementsByClassName('container')[0];
+    var newHeight = ele.clientHeight + 180;
+    window.resizeTo(window.innerWidth, newHeight);
+    window.moveTo(window.screenX, newHeight / 2 + window.screenY);
+  }
+  </script>
+{% endblock %}
+
diff --git a/src/sentry/utils/pipeline.py b/src/sentry/utils/pipeline.py
index ddcd6b758b..ef47617c9a 100644
--- a/src/sentry/utils/pipeline.py
+++ b/src/sentry/utils/pipeline.py
@@ -4,6 +4,7 @@ from sentry.models import Organization
 from sentry.web.frontend.base import BaseView
 from sentry.utils.session_store import RedisSessionStore
 from sentry.utils.hashlib import md5_text
+from sentry.web.helpers import render_to_response
 
 
 class PipelineProvider(object):
@@ -198,8 +199,8 @@ class Pipeline(object):
         )
 
     def error(self, message):
-        # TODO: Implement this here
-        raise NotImplementedError
+        context = {'error': message}
+        return render_to_response('sentry/pipeline-error.html', context, self.request)
 
     def next_step(self):
         """
