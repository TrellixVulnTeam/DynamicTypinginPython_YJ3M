commit c5c5e8f1d184d44f96fab95556f1c8040ae44d4f
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Aug 11 13:21:43 2010 -0700

    Even better error handling for enhanced traceback failures

diff --git a/djangodblog/__init__.py b/djangodblog/__init__.py
index 53a600737d..c7fb20e6f3 100644
--- a/djangodblog/__init__.py
+++ b/djangodblog/__init__.py
@@ -1 +1 @@
-__version__ = (2, 1, 7)
\ No newline at end of file
+__version__ = (2, 1, 8)
\ No newline at end of file
diff --git a/djangodblog/admin.py b/djangodblog/admin.py
index f9bc1c3cf6..ffc16605fc 100644
--- a/djangodblog/admin.py
+++ b/djangodblog/admin.py
@@ -189,7 +189,8 @@ class ErrorAdmin(EfficientModelAdmin):
                 exc_info = sys.exc_info()
                 logger.exception(exc_info[1])
                 has_traceback = False
-                extra_context['tb_error'] = '%s: %s' % (exc_info[0].__name__, exc_info[1])
+                import traceback
+                extra_context['tb_error'] = traceback.format_exc()
         extra_context.update({
             'has_traceback': has_traceback,
             'show_traceback': show_traceback,
diff --git a/djangodblog/templates/admin/djangodblog/error/change_form.html b/djangodblog/templates/admin/djangodblog/error/change_form.html
index 8d52ae0408..ac6a776545 100644
--- a/djangodblog/templates/admin/djangodblog/error/change_form.html
+++ b/djangodblog/templates/admin/djangodblog/error/change_form.html
@@ -141,13 +141,13 @@
 						{% if has_traceback %}
 							<a href="?raw">&rsaquo; View plain traceback information</a>
 						{% else %}
-							<em><strong>Error rendering interactive traceback:</strong> {{ tb_error }}</em>
+							<em>Enhanced traceback is not available for this message</em>
 						{% endif %}
 					{% else %}
 						{% if has_traceback %}
-							<a href="./">&rsaquo; View interactive traceback information</a>
+							<a href="./">&rsaquo; View enhanced traceback information</a>
 						{% else %}
-							<em>Interactive traceback is not available for this message</em>
+							<em>Enhanced traceback is not available for this message</em>
 						{% endif %}
 					{% endif %}
 				</td>
@@ -168,6 +168,13 @@
 			</tr>
 		</tbody>
 	</table>
+	{% if tb_error %}
+		<div style="padding:10px;border-top: 1px solid #ddd; background: #eee;">
+			<p>An error occurred within DBLog while trying to render the enhanced traceback:</p>
+			<br/>
+			<pre>{{ tb_error }}</pre>
+		</div>
+	{% endif %}
 	{% if show_traceback and has_traceback %}
 		<div id="reporter_body">
 			{{ error_body }}
