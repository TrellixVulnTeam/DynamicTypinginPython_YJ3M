commit 33056b3590e6828d4c8b7e2563fbb68fab42778e
Author: ted kaemming <ted@kaemming.com>
Date:   Tue Nov 15 10:41:42 2016 -0800

    Add footer to project breakdown summary table. (#4424)

diff --git a/src/sentry/tasks/reports.py b/src/sentry/tasks/reports.py
index 65aa847eb7..79eb4744ce 100644
--- a/src/sentry/tasks/reports.py
+++ b/src/sentry/tasks/reports.py
@@ -845,10 +845,22 @@ def build_project_breakdown_series(reports):
         ],
     )
 
+    legend = [key for key, value in reversed(selections)]
     return {
         'points': [(to_datetime(timestamp), value) for timestamp, value in series],
         'maximum': max(sum(count for key, count in value) for timestamp, value in series),
-        'legend': [key for key, value in reversed(selections)],
+        'legend': {
+            'rows': legend,
+            'total': Key(
+                'Total',
+                None,
+                None,
+                reduce(
+                    merge_mappings,
+                    [key.data for key in legend]
+                ),
+            ),
+        },
     }
 
 
diff --git a/src/sentry/templates/sentry/emails/reports/body.html b/src/sentry/templates/sentry/emails/reports/body.html
index 8517c12904..9445b81ba9 100644
--- a/src/sentry/templates/sentry/emails/reports/body.html
+++ b/src/sentry/templates/sentry/emails/reports/body.html
@@ -141,9 +141,10 @@
       font-weight: 500;
     }
 
-    .project-breakdown .summary tbody td {
+    .project-breakdown .summary th,
+    .project-breakdown .summary td {
       font-size: 14px;
-      padding: 10px 0 0 0;
+      padding: 5px 0;
     }
 
     .project-breakdown .summary .numeric {
@@ -497,20 +498,37 @@
         </tr>
       </thead>
       <tbody>
-      {% for key in series.legend %}
+      {% for key in series.legend.rows %}
         <tr>
           <td>
-            <span style="background-color: {{ key.color }}; display: inline-block; height: 1em; width: 1em;">&nbsp;</span>
+              {% if key.color %}<span style="background-color: {{ key.color }}; display: inline-block; height: 1em; width: 1em;">&nbsp;</span>{% endif %}
           </td>
           <td class="numeric">{{ key.data.events|small_count:1 }}</div>
           <td>
-              {% if key.url %}<a href="{{ key.url }}" style="font-weight: bold;">{% endif %}{{ key.label }}{% if key.url %}</a>{% endif %}
+              {% if key.url %}<a href="{{ key.url }}">{% endif %}{{ key.label }}{% if key.url %}</a>{% endif %}
           </td>
           <td class="numeric col-filtered">{{ key.data.filtered|small_count:1 }}</td>
           <td class="numeric col-rate-limited">{{ key.data.rate_limited|small_count:1 }}</td>
         </tr>
       {% endfor %}
       </tbody>
+      {% if series.legend.rows|length > 1 %}
+        <tfoot>
+          {% with key=series.legend.total %}
+            <tr>
+              <td>
+                  {% if key.color %}<span style="background-color: {{ key.color }}; display: inline-block; height: 1em; width: 1em;">&nbsp;</span>{% endif %}
+              </td>
+              <td class="numeric">{{ key.data.events|small_count:1 }}</div>
+              <td>
+                  {% if key.url %}<a href="{{ key.url }}">{% endif %}{{ key.label }}{% if key.url %}</a>{% endif %}
+              </td>
+              <td class="numeric col-filtered">{{ key.data.filtered|small_count:1 }}</td>
+              <td class="numeric col-rate-limited">{{ key.data.rate_limited|small_count:1 }}</td>
+            </tr>
+          {% endwith %}
+        </tfoot>
+      {% endif %}
     </table>
     {% endwith %}
 
