commit 2b21546e37390ec035f99fee8ea72996cfa72975
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Oct 9 12:56:24 2015 -0700

    Handle API key-based bulk actions

diff --git a/src/sentry/api/endpoints/group_details.py b/src/sentry/api/endpoints/group_details.py
index e9693cfa98..0eba4ccdca 100644
--- a/src/sentry/api/endpoints/group_details.py
+++ b/src/sentry/api/endpoints/group_details.py
@@ -237,6 +237,8 @@ class GroupDetailsEndpoint(GroupEndpoint):
 
         result = serializer.object
 
+        acting_user = request.user if request.user.is_authenticated() else None
+
         # TODO(dcramer): we should allow assignment to anyone who has membership
         # even if that membership is not SSO linked
         if result.get('assignedTo') and not group.project.member_set.filter(user=result['assignedTo']).exists():
@@ -261,7 +263,7 @@ class GroupDetailsEndpoint(GroupEndpoint):
                     project=group.project,
                     group=group,
                     type=Activity.SET_RESOLVED,
-                    user=request.user,
+                    user=acting_user,
                 )
         elif result.get('status'):
             group.status = STATUS_CHOICES[result['status']]
@@ -325,7 +327,7 @@ class GroupDetailsEndpoint(GroupEndpoint):
                         project=group.project,
                         group=group,
                         type=Activity.ASSIGNED,
-                        user=request.user,
+                        user=acting_user,
                         data={
                             'assignee': result['assignedTo'].id,
                         }
@@ -345,7 +347,7 @@ class GroupDetailsEndpoint(GroupEndpoint):
                         project=group.project,
                         group=group,
                         type=Activity.UNASSIGNED,
-                        user=request.user,
+                        user=acting_user,
                     )
                     activity.send_notification()
 
