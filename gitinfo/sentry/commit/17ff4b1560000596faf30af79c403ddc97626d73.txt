commit 17ff4b1560000596faf30af79c403ddc97626d73
Author: Jess MacQueen <jessmacqueen@gmail.com>
Date:   Mon Sep 24 14:45:23 2018 -0700

    fix(integrations): Handle missing assignee email in Jira webhook
    fixes SENTRY-7S4

diff --git a/src/sentry/integrations/jira/webhooks.py b/src/sentry/integrations/jira/webhooks.py
index 7566dabb02..20357bbafa 100644
--- a/src/sentry/integrations/jira/webhooks.py
+++ b/src/sentry/integrations/jira/webhooks.py
@@ -28,6 +28,15 @@ class JiraIssueUpdatedWebhook(Endpoint):
                 integration, None, issue_key, assign=False,
             )
         else:
+            if not assignee.get('emailAddress'):
+                logger.info(
+                    'missing-assignee-email', extra={
+                        'issue_key': issue_key,
+                        'integration_id': integration.id,
+                    }
+                )
+                return
+
             sync_group_assignee_inbound(
                 integration, assignee['emailAddress'], issue_key, assign=True,
             )
diff --git a/tests/sentry/integrations/jira/test_webhooks.py b/tests/sentry/integrations/jira/test_webhooks.py
index 880e97e634..9bd33f043c 100644
--- a/tests/sentry/integrations/jira/test_webhooks.py
+++ b/tests/sentry/integrations/jira/test_webhooks.py
@@ -112,6 +112,29 @@ class JiraWebhooksTest(APITestCase):
                 integration, 'jess@sentry.io', 'APP-123', assign=True,
             )
 
+    @patch('sentry.integrations.jira.webhooks.sync_group_assignee_inbound')
+    def test_assign_missing_email(self, mock_sync_group_assignee_inbound):
+        org = self.organization
+
+        integration = Integration.objects.create(
+            provider='jira',
+            name='Example Jira',
+        )
+        integration.add_organization(org, self.user)
+
+        path = reverse('sentry-extensions-jira-issue-updated')
+
+        with patch('sentry.integrations.jira.webhooks.get_integration_from_jwt', return_value=integration):
+            data = json.loads(SAMPLE_EDIT_ISSUE_PAYLOAD_ASSIGNEE.strip())
+            data['issue']['fields']['assignee'].pop('emailAddress')
+            resp = self.client.post(
+                path,
+                data=data,
+                HTTP_AUTHORIZATION='JWT anexampletoken',
+            )
+            assert resp.status_code == 200
+            assert not mock_sync_group_assignee_inbound.called
+
     @patch('sentry.integrations.jira.webhooks.sync_group_assignee_inbound')
     def test_simple_deassign(self, mock_sync_group_assignee_inbound):
         org = self.organization
