commit 83368800e008461acf9baeba4b5b8794a9a290cf
Author: Stephen Cefali <scefali@sentry.io>
Date:   Fri Apr 3 10:06:07 2020 -0700

    remove sort by weight experiment (#18078)

diff --git a/src/sentry/static/sentry/app/data/experimentConfig.tsx b/src/sentry/static/sentry/app/data/experimentConfig.tsx
index db2786956f..d6225efd22 100644
--- a/src/sentry/static/sentry/app/data/experimentConfig.tsx
+++ b/src/sentry/static/sentry/app/data/experimentConfig.tsx
@@ -19,12 +19,6 @@ export const experimentList = [
     parameter: 'variant',
     assignments: ['controlV1', '2Optionsv1', '3OptionsV2'],
   },
-  {
-    key: 'IntegrationDirectorySortWeightExperiment',
-    type: ExperimentType.Organization,
-    parameter: 'variant',
-    assignments: ['1', '0', -1],
-  },
   {
     key: 'OnboardingSidebarV2Experiment',
     type: ExperimentType.Organization,
diff --git a/src/sentry/static/sentry/app/utils/integrationUtil.tsx b/src/sentry/static/sentry/app/utils/integrationUtil.tsx
index 8a6fc372dd..e7338daff2 100644
--- a/src/sentry/static/sentry/app/utils/integrationUtil.tsx
+++ b/src/sentry/static/sentry/app/utils/integrationUtil.tsx
@@ -15,10 +15,8 @@ import {
 } from 'app/types';
 import {Hooks} from 'app/types/hooks';
 import HookStore from 'app/stores/hookStore';
-import {ExperimentAssignment} from 'app/types/experiments';
 
 const INTEGRATIONS_ANALYTICS_SESSION_KEY = 'INTEGRATION_ANALYTICS_SESSION' as const;
-const SORT_INTEGRATIONS_BY_WEIGHT = 'SORT_INTEGRATIONS_BY_WEIGHT' as const;
 const SHOW_INTEGRATION_DIRECTORY_CATEGORY_SELECT = 'SHOW_INTEGRATION_DIRECTORY_CATEGORY_SELECT' as const;
 
 export const startAnalyticsSession = () => {
@@ -34,19 +32,6 @@ export const clearAnalyticsSession = () => {
 export const getAnalyticsSessionId = () =>
   window.sessionStorage.getItem(INTEGRATIONS_ANALYTICS_SESSION_KEY);
 
-export const getSortIntegrationsByWeightActive = (
-  experimentAssignment: ExperimentAssignment['IntegrationDirectorySortWeightExperiment']
-) => {
-  switch (localStorage.getItem(SORT_INTEGRATIONS_BY_WEIGHT)) {
-    case '1':
-      return true;
-    case '0':
-      return false;
-    default:
-      return experimentAssignment === '1';
-  }
-};
-
 export const getCategorySelectActive = () =>
   localStorage.getItem(SHOW_INTEGRATION_DIRECTORY_CATEGORY_SELECT) === '1';
 
diff --git a/src/sentry/static/sentry/app/views/organizationIntegrations/integrationListDirectory.tsx b/src/sentry/static/sentry/app/views/organizationIntegrations/integrationListDirectory.tsx
index 4f21a4c75a..b040c7dc70 100644
--- a/src/sentry/static/sentry/app/views/organizationIntegrations/integrationListDirectory.tsx
+++ b/src/sentry/static/sentry/app/views/organizationIntegrations/integrationListDirectory.tsx
@@ -19,7 +19,6 @@ import {Panel, PanelBody} from 'app/components/panels';
 import {
   trackIntegrationEvent,
   getSentryAppInstallStatus,
-  getSortIntegrationsByWeightActive,
   getCategorySelectActive,
   isSentryApp,
   isPlugin,
@@ -35,8 +34,6 @@ import SearchInput from 'app/components/forms/searchInput';
 import {createFuzzySearch} from 'app/utils/createFuzzySearch';
 import space from 'app/styles/space';
 import SelectControl from 'app/components/forms/selectControl';
-import withExperiment from 'app/utils/withExperiment';
-import {ExperimentAssignment} from 'app/types/experiments';
 
 import {POPULARITY_WEIGHT} from './constants';
 import IntegrationRow from './integrationRow';
@@ -44,7 +41,6 @@ import IntegrationRow from './integrationRow';
 type Props = RouteComponentProps<{orgId: string}, {}> & {
   organization: Organization;
   hideHeader: boolean;
-  experimentAssignment: ExperimentAssignment['IntegrationDirectorySortWeightExperiment'];
 };
 
 type State = {
@@ -220,13 +216,10 @@ export class IntegrationListDirectory extends AsyncComponent<
     this.getInstallValue(b) - this.getInstallValue(a);
 
   sortIntegrations(integrations: AppOrProviderOrPlugin[]) {
-    if (getSortIntegrationsByWeightActive(this.props.experimentAssignment)) {
-      return integrations
-        .sort(this.sortByName)
-        .sort(this.sortByPopularity)
-        .sort(this.sortByInstalled);
-    }
-    return integrations.sort(this.sortByName).sort(this.sortByInstalled);
+    return integrations
+      .sort(this.sortByName)
+      .sort(this.sortByPopularity)
+      .sort(this.sortByInstalled);
   }
 
   async componentDidUpdate(_: Props, prevState: State) {
@@ -446,8 +439,4 @@ const EmptyResultsBody = styled('div')`
   padding-bottom: ${space(2)};
 `;
 
-export default withOrganization(
-  withExperiment(IntegrationListDirectory, {
-    experiment: 'IntegrationDirectorySortWeightExperiment',
-  })
-);
+export default withOrganization(IntegrationListDirectory);
diff --git a/tests/js/spec/views/organizationIntegrations/integrationListDirectory.spec.jsx b/tests/js/spec/views/organizationIntegrations/integrationListDirectory.spec.jsx
index 073f429aa7..c26705b583 100644
--- a/tests/js/spec/views/organizationIntegrations/integrationListDirectory.spec.jsx
+++ b/tests/js/spec/views/organizationIntegrations/integrationListDirectory.spec.jsx
@@ -43,17 +43,17 @@ describe('IntegrationListDirectory', function() {
       );
     });
 
-    it('shows installed integrations at the top', async function() {
+    it('shows installed integrations at the top in order of weight', async function() {
       expect(wrapper.find('SearchInput').exists()).toBeTruthy();
       expect(wrapper.find('PanelBody').exists()).toBeTruthy();
       expect(wrapper.find('IntegrationRow')).toHaveLength(6);
 
       [
         'bitbucket',
-        'my-headband-washer-289499',
         'pagerduty',
-        'amazon-sqs',
+        'my-headband-washer-289499',
         'clickup',
+        'amazon-sqs',
         'la-croix-monitor',
       ].map((name, index) =>
         expect(
