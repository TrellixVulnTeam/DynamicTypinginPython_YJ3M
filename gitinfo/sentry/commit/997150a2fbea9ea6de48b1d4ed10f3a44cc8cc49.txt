commit 997150a2fbea9ea6de48b1d4ed10f3a44cc8cc49
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Thu Apr 23 11:45:36 2015 -0700

    js: Support .coffee files as well as ignoring querystrings

diff --git a/src/sentry/lang/javascript/processor.py b/src/sentry/lang/javascript/processor.py
index 6a6582b32b..31dd819212 100644
--- a/src/sentry/lang/javascript/processor.py
+++ b/src/sentry/lang/javascript/processor.py
@@ -333,10 +333,11 @@ def generate_module(src):
     """
     if not src:
         return UNKNOWN_MODULE
-    if not src.endswith('.js'):
+
+    filename, ext = splitext(urlsplit(src).path)
+    if ext not in ('.js', '.coffee'):
         return UNKNOWN_MODULE
 
-    filename = splitext(urlsplit(src).path)[0]
     if filename.endswith('.min'):
         filename = filename[:-4]
     return CLEAN_MODULE_RE.sub('', filename) or UNKNOWN_MODULE
diff --git a/tests/sentry/lang/javascript/test_processor.py b/tests/sentry/lang/javascript/test_processor.py
index 9b13e5f140..b3fe6a30d6 100644
--- a/tests/sentry/lang/javascript/test_processor.py
+++ b/tests/sentry/lang/javascript/test_processor.py
@@ -115,6 +115,8 @@ class GenerateModuleTest(TestCase):
         assert generate_module('http://example.com/abcdef0/foo/bar.js') == 'foo/bar'
         assert generate_module('http://example.com/92cd589eca8235e7b373bf5ae94ebf898e3b949c/foo/bar.js') == 'foo/bar'
         assert generate_module('http://example.com/7d6d00eae0ceccdc7ee689659585d95f/foo/bar.js') == 'foo/bar'
+        assert generate_module('http://example.com/foo/bar.coffee') == 'foo/bar'
+        assert generate_module('http://example.com/foo/bar.js?v=1234') == 'foo/bar'
         assert generate_module('/foo/bar.js') == 'foo/bar'
         assert generate_module('../../foo/bar.js') == 'foo/bar'
         assert generate_module('/foo/bar-7d6d00eae0ceccdc7ee689659585d95f.js') == 'foo/bar'
