commit 28bcf98f9b31c98e7a2fec5efec217555deb214e
Author: Jess MacQueen <jessmacqueen@gmail.com>
Date:   Fri Feb 1 15:26:19 2019 -0800

    fix(tagstore): Ensure environment_id is int or None not empty list

diff --git a/src/sentry/tagstore/base.py b/src/sentry/tagstore/base.py
index 1e5b9a3573..e09bcc387a 100644
--- a/src/sentry/tagstore/base.py
+++ b/src/sentry/tagstore/base.py
@@ -431,7 +431,7 @@ class TagStorage(Service):
             project_id, group_id, environment_ids, keys=keys
         )
 
-        environment_id = environment_ids and environment_ids[0]
+        environment_id = environment_ids[0] if environment_ids else None
         for tk in tag_keys:
             tk.top_values = self.get_top_group_tag_values(
                 project_id, group_id, environment_id, tk.key, limit=value_limit)
diff --git a/src/sentry/tagstore/v2/backend.py b/src/sentry/tagstore/v2/backend.py
index 6797e0d16e..42dfa2edd9 100644
--- a/src/sentry/tagstore/v2/backend.py
+++ b/src/sentry/tagstore/v2/backend.py
@@ -516,7 +516,7 @@ class V2TagStorage(TagStorage):
         if environment_ids and len(environment_ids) > 1:
             raise NotImplementedError
 
-        environment_id = environment_ids and environment_ids[0]
+        environment_id = environment_ids[0] if environment_ids else None
 
         qs = models.GroupTagKey.objects.select_related('_key').filter(
             project_id=project_id,
