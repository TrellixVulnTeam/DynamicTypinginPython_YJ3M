commit fee22af130377e2cc10e764162a2c963e58b4a28
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 14 15:11:36 2015 -0800

    Handle auth-less case

diff --git a/src/sentry/api/base.py b/src/sentry/api/base.py
index 36cfc08870..eaf92fe213 100644
--- a/src/sentry/api/base.py
+++ b/src/sentry/api/base.py
@@ -121,12 +121,8 @@ class Endpoint(APIView):
             time.sleep(settings.SENTRY_API_RESPONSE_DELAY / 1000.0)
 
         origin = request.META.get('HTTP_ORIGIN')
-        if origin:
-            if request.auth:
-                allowed_origins = request.auth.get_allowed_origins()
-            else:
-                allowed_origins = ()
-
+        if origin and request.auth:
+            allowed_origins = request.auth.get_allowed_origins()
             if not is_valid_origin(origin, allowed=allowed_origins):
                 raise Response('Invalid origin: %s' % (origin,), status=400)
 
