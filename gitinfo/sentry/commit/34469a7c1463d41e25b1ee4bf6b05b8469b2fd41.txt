commit 34469a7c1463d41e25b1ee4bf6b05b8469b2fd41
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jul 10 23:56:07 2012 +0200

    Ensure we correctly fill FilterKey

diff --git a/sentry/manager.py b/sentry/manager.py
index 76a3e1c6f3..6c87faa1e6 100644
--- a/sentry/manager.py
+++ b/sentry/manager.py
@@ -604,12 +604,18 @@ class GroupManager(BaseManager, ChartMixin):
         return group, is_new, is_sample
 
     def add_tags(self, group, tags):
-        from sentry.models import FilterValue, MessageFilterValue
+        from sentry.models import FilterValue, FilterKey, MessageFilterValue
 
         project = group.project
         date = group.last_seen
 
         for key, value in itertools.ifilter(bool, tags):
+            # TODO: FilterKey and FilterValue queries should be create's under a try/except
+            FilterKey.objects.get_or_create(
+                project=project,
+                key=key,
+            )
+
             FilterValue.objects.get_or_create(
                 project=project,
                 key=key,
