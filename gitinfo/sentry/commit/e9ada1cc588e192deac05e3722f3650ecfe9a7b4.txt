commit e9ada1cc588e192deac05e3722f3650ecfe9a7b4
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Sep 9 19:30:36 2013 -0700

    Add timeout to source fetching

diff --git a/src/sentry/constants.py b/src/sentry/constants.py
index eaa27b82ec..934b27263f 100644
--- a/src/sentry/constants.py
+++ b/src/sentry/constants.py
@@ -222,3 +222,6 @@ SEARCH_DEFAULT_SORT_OPTION = 'date'
 # Setup languages for only available locales
 LANGUAGE_MAP = dict(settings.LANGUAGES)
 LANGUAGES = [(k, LANGUAGE_MAP[k]) for k in get_all_languages() if k in LANGUAGE_MAP]
+
+# Timeout (in seconds) for fetching remote source files (e.g. JS)
+SOURCE_FETCH_TIMEOUT = 5
diff --git a/src/sentry/tasks/fetch_source.py b/src/sentry/tasks/fetch_source.py
index aa93e399f1..495281f816 100644
--- a/src/sentry/tasks/fetch_source.py
+++ b/src/sentry/tasks/fetch_source.py
@@ -16,6 +16,8 @@ from collections import namedtuple
 from urlparse import urljoin
 
 from django.utils.simplejson import JSONDecodeError
+
+from sentry.constants import SOURCE_FETCH_TIMEOUT
 from sentry.utils.cache import cache
 from sentry.utils.sourcemaps import sourcemap_to_index, find_source
 
@@ -109,7 +111,7 @@ def fetch_url_content(url):
             ('Accept-Encoding', 'gzip'),
             ('User-Agent', 'Sentry/%s' % sentry.VERSION),
         ]
-        req = opener.open(url)
+        req = opener.open(url, timeout=SOURCE_FETCH_TIMEOUT)
         headers = dict(req.headers)
         body = req.read()
         if headers.get('content-encoding') == 'gzip':
