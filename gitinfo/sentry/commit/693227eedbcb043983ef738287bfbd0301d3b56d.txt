commit 693227eedbcb043983ef738287bfbd0301d3b56d
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Thu Jul 19 11:00:31 2018 -0700

    feat(discover): Add ability to reset query builder (#9098)

diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/discover.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/discover.jsx
index 5512b60931..429d318777 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/discover.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/discover.jsx
@@ -134,6 +134,14 @@ export default class OrganizationDiscover extends React.Component {
     return <PlaceholderText>{text}</PlaceholderText>;
   };
 
+  reset = () => {
+    const {queryBuilder, organization} = this.props;
+
+    queryBuilder.reset();
+    browserHistory.push({
+      pathname: `/organizations/${organization.slug}/discover/`,
+    });
+  };
   render() {
     const {result} = this.state;
     const {queryBuilder} = this.props;
@@ -149,7 +157,7 @@ export default class OrganizationDiscover extends React.Component {
     }));
 
     return (
-      <div className="organization-home">
+      <Discover className="organization-home">
         <Header
           p={2}
           justify="space-between"
@@ -221,19 +229,30 @@ export default class OrganizationDiscover extends React.Component {
               />
             </Fieldset>
 
-            <Button onClick={this.runQuery} style={{marginTop: 8}} priority="primary">
-              {t('Run Query')}
-            </Button>
+            <Flex pt={1}>
+              <Box mr={1}>
+                <Button onClick={this.runQuery} priority="primary">
+                  {t('Run Query')}
+                </Button>
+              </Box>
+              <Button onClick={this.reset}>{t('Reset')}</Button>
+            </Flex>
           </Box>
           <Box w={[2 / 3, 2 / 3, 2 / 3, 3 / 4]} pl={2}>
             {result && <Result result={result} />}
           </Box>
         </Flex>
-      </div>
+      </Discover>
     );
   }
 }
 
+const Discover = styled('div')`
+  .control-group {
+    margin-bottom: 0; /* Do not want the global control-group margins  */
+  }
+`;
+
 const Header = styled(Flex)`
   font-size: 18px;
 `;
diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/queryBuilder.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/queryBuilder.jsx
index 162e4ede8a..0699997443 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/queryBuilder.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/queryBuilder.jsx
@@ -36,7 +36,7 @@ function applyDefaults(query) {
  * initialization.
  */
 export default function createQueryBuilder(initial = {}, organization) {
-  const query = applyDefaults(initial);
+  let query = applyDefaults(initial);
   const defaultProjects = organization.projects
     .filter(projects => projects.isMember)
     .map(project => parseInt(project.id, 10));
@@ -49,6 +49,7 @@ export default function createQueryBuilder(initial = {}, organization) {
     fetch,
     getColumns,
     load,
+    reset,
   };
 
   /**
@@ -177,4 +178,13 @@ export default function createQueryBuilder(initial = {}, organization) {
   function getColumns() {
     return [...COLUMNS, ...tags];
   }
+
+  /**
+   * Resets the query to defaults
+   *
+   * @returns {Void}
+   */
+  function reset() {
+    query = applyDefaults({});
+  }
 }
