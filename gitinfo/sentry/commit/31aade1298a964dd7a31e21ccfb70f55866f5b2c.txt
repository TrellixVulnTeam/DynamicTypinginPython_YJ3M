commit 31aade1298a964dd7a31e21ccfb70f55866f5b2c
Author: Max Bittker <maxbittker@gmail.com>
Date:   Wed Nov 15 13:43:19 2017 -0800

    stop using groupcomitresolution in tests and writing (#6554)

diff --git a/src/sentry/receivers/releases.py b/src/sentry/receivers/releases.py
index 2dd5e28a72..5da0578f76 100644
--- a/src/sentry/receivers/releases.py
+++ b/src/sentry/receivers/releases.py
@@ -4,7 +4,7 @@ from django.db import IntegrityError, transaction
 from django.db.models.signals import post_save
 
 from sentry.models import (
-    Activity, Commit, GroupAssignee, GroupCommitResolution, GroupLink, Project, Release
+    Activity, Commit, GroupAssignee, GroupLink, Project, Release
 )
 from sentry.tasks.clear_expired_resolutions import clear_expired_resolutions
 
@@ -53,12 +53,6 @@ def resolved_in_commit(instance, created, **kwargs):
     for group in groups:
         try:
             with transaction.atomic():
-                # TODO(maxbittker) remove this call after new grouplink is confirmed working
-                GroupCommitResolution.objects.create(
-                    group_id=group.id,
-                    commit_id=instance.id,
-                )
-                # dual write to prepare for data migration
                 GroupLink.objects.create(
                     group_id=group.id,
                     project_id=group.project_id,
diff --git a/tests/sentry/models/test_release.py b/tests/sentry/models/test_release.py
index 26fc19c85e..739d289bfb 100644
--- a/tests/sentry/models/test_release.py
+++ b/tests/sentry/models/test_release.py
@@ -4,7 +4,7 @@ import datetime
 import six
 
 from sentry.models import (
-    Commit, CommitAuthor, Group, GroupCommitResolution, GroupRelease, GroupResolution, GroupLink, GroupStatus,
+    Commit, CommitAuthor, Group, GroupRelease, GroupResolution, GroupLink, GroupStatus,
     Release, ReleaseCommit, ReleaseEnvironment, ReleaseProject, Repository
 )
 
@@ -142,7 +142,6 @@ class SetCommitsTestCase(TestCase):
             key='lskfslknsdkcsnlkdflksfdkls',
         )
 
-        assert GroupCommitResolution.objects.filter(group_id=group.id, commit_id=commit.id).exists()
         assert GroupLink.objects.filter(
             group_id=group.id,
             linked_type=GroupLink.LinkedType.commit,
@@ -264,14 +263,6 @@ class SetCommitsTestCase(TestCase):
             release=release,
         ).exists()
 
-        assert GroupCommitResolution.objects.filter(
-            group_id=group.id,
-            commit_id=Commit.objects.get(
-                key='c' * 40,
-                repository_id=repo.id,
-            ).id,
-        ).exists()
-
         assert GroupLink.objects.filter(
             group_id=group.id,
             linked_type=GroupLink.LinkedType.commit,
@@ -395,7 +386,6 @@ class SetCommitsTestCase(TestCase):
             'repository': repo.name,
         }])
 
-        assert GroupCommitResolution.objects.filter(group_id=group.id, commit_id=commit.id).exists()
         assert GroupLink.objects.filter(
             group_id=group.id,
             linked_type=GroupLink.LinkedType.commit,
@@ -433,7 +423,6 @@ class SetCommitsTestCase(TestCase):
             'repository': repo.name,
         }])
 
-        assert GroupCommitResolution.objects.filter(group_id=group.id, commit_id=commit.id).exists()
         assert GroupLink.objects.filter(
             group_id=group.id,
             linked_type=GroupLink.LinkedType.commit,
diff --git a/tests/sentry/receivers/test_releases.py b/tests/sentry/receivers/test_releases.py
index a2465059ea..9efc8996ad 100644
--- a/tests/sentry/receivers/test_releases.py
+++ b/tests/sentry/receivers/test_releases.py
@@ -7,7 +7,7 @@ from uuid import uuid4
 
 from sentry import tagstore
 from sentry.models import (
-    Activity, Commit, CommitAuthor, GroupAssignee, GroupCommitResolution, GroupLink, OrganizationMember,
+    Activity, Commit, CommitAuthor, GroupAssignee, GroupLink, OrganizationMember,
     Release, Repository, UserEmail
 )
 from sentry.testutils import TestCase
@@ -65,11 +65,6 @@ class ResolvedInCommitTest(TestCase):
             message='Foo Biz\n\nFixes {}'.format(group.qualified_short_id),
         )
 
-        assert GroupCommitResolution.objects.filter(
-            group_id=group.id,
-            commit_id=commit.id,
-        ).exists()
-
         assert GroupLink.objects.filter(
             group_id=group.id,
             linked_type=GroupLink.LinkedType.commit,
@@ -89,10 +84,6 @@ class ResolvedInCommitTest(TestCase):
                 self.project.slug.upper()),
         )
 
-        assert not GroupCommitResolution.objects.filter(
-            commit_id=commit.id,
-        ).exists()
-
         assert not GroupLink.objects.filter(
             linked_type=GroupLink.LinkedType.commit,
             linked_id=commit.id).exists()
@@ -117,11 +108,6 @@ class ResolvedInCommitTest(TestCase):
             )
         )
 
-        assert GroupCommitResolution.objects.filter(
-            group_id=group.id,
-            commit_id=commit.id,
-        ).exists()
-
         assert GroupLink.objects.filter(
             group_id=group.id,
             linked_type=GroupLink.LinkedType.commit,
@@ -152,11 +138,6 @@ class ResolvedInCommitTest(TestCase):
             )
         )
 
-        assert GroupCommitResolution.objects.filter(
-            group_id=group.id,
-            commit_id=commit.id,
-        ).exists()
-
         assert GroupLink.objects.filter(
             group_id=group.id,
             linked_type=GroupLink.LinkedType.commit,
