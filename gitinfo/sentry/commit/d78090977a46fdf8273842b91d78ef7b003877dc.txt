commit d78090977a46fdf8273842b91d78ef7b003877dc
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Tue Feb 12 16:24:07 2019 -0800

    ref(ui): Refactor Manage button from DropdownAutocompleteMenu (#11973)
    
    Followup to https://github.com/getsentry/sentry/pull/11922 -- this keeps `DropdownAutoCompleteMenu` generic

diff --git a/src/sentry/static/sentry/app/components/dropdownAutoCompleteMenu.jsx b/src/sentry/static/sentry/app/components/dropdownAutoCompleteMenu.jsx
index 7eb05fe15a..3824c14cd8 100644
--- a/src/sentry/static/sentry/app/components/dropdownAutoCompleteMenu.jsx
+++ b/src/sentry/static/sentry/app/components/dropdownAutoCompleteMenu.jsx
@@ -7,7 +7,6 @@ import styled, {css} from 'react-emotion';
 
 import {t} from 'app/locale';
 import AutoComplete from 'app/components/autoComplete';
-import Button from 'app/components/button';
 import Input from 'app/views/settings/components/forms/controls/input';
 import space from 'app/styles/space';
 import LoadingIndicator from 'app/components/loadingIndicator';
@@ -138,7 +137,6 @@ class DropdownAutoCompleteMenu extends React.Component {
 
     menuFooter: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),
     menuHeader: PropTypes.node,
-
     /**
      * Props to pass to menu component
      */
@@ -154,6 +152,11 @@ class DropdownAutoCompleteMenu extends React.Component {
      */
     inputProps: PropTypes.object,
 
+    /**
+     * renderProp for the end (right side) of the search input
+     */
+    inputActions: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),
+
     css: PropTypes.object,
     style: PropTypes.object,
   };
@@ -296,6 +299,7 @@ class DropdownAutoCompleteMenu extends React.Component {
       className,
       menuHeader,
       menuFooter,
+      inputActions,
       menuWithArrow,
       searchPlaceholder,
       itemSize,
@@ -356,6 +360,9 @@ class DropdownAutoCompleteMenu extends React.Component {
           const renderedFooter =
             typeof menuFooter === 'function' ? menuFooter({actions}) : menuFooter;
 
+          const renderedInputActions =
+            typeof inputActions === 'function' ? inputActions() : inputActions;
+
           return (
             <AutoCompleteRoot {...getRootProps()} className={rootClassName}>
               {children({
@@ -390,18 +397,7 @@ class DropdownAutoCompleteMenu extends React.Component {
                       <InputLoadingWrapper>
                         {busy && <LoadingIndicator size={16} mini />}
                       </InputLoadingWrapper>
-                      {menuProps &&
-                        menuProps.showSettingsLink && (
-                          <div>
-                            <StyledButton
-                              to={`/settings/${menuProps &&
-                                menuProps.organization.slug}/projects/`}
-                              size="xsmall"
-                            >
-                              {t('Manage')}
-                            </StyledButton>
-                          </div>
-                        )}
+                      {renderedInputActions}
                     </StyledInputWrapper>
                   )}
                   <div>
@@ -592,22 +588,6 @@ const GroupLabel = styled('div')`
   padding: ${space(0.25)} ${space(1)};
 `;
 
-const StyledButton = styled(Button)`
-  display: block;
-  margin: 0 ${space(1)};
-  box-shadow: none;
-  border: 0;
-  background: ${p => p.theme.offWhite2};
-
-  &:hover,
-  &:active,
-  &:focus {
-    box-shadow: none;
-    border: 0;
-    background: ${p => p.theme.gray1};
-  }
-`;
-
 const StyledMenu = styled('div')`
   background: #fff;
   border: 1px solid ${p => p.theme.borderDark};
diff --git a/src/sentry/static/sentry/app/components/projectSelector.jsx b/src/sentry/static/sentry/app/components/projectSelector.jsx
index 0c77000053..776a11c1d6 100644
--- a/src/sentry/static/sentry/app/components/projectSelector.jsx
+++ b/src/sentry/static/sentry/app/components/projectSelector.jsx
@@ -187,7 +187,13 @@ class ProjectSelector extends React.Component {
         noResultsMessage={t('No projects found')}
         virtualizedHeight={40}
         emptyHidesInput
-        menuProps={{showSettingsLink: true, organization: org}}
+        inputActions={() => (
+          <div>
+            <ManageButton to={`/settings/${org.slug}/projects/`} size="xsmall">
+              {t('Manage')}
+            </ManageButton>
+          </div>
+        )}
         menuFooter={renderProps => {
           const renderedFooter =
             typeof menuFooter === 'function' ? menuFooter(renderProps) : menuFooter;
@@ -216,7 +222,7 @@ class ProjectSelector extends React.Component {
           label: ({inputValue}) => (
             <ProjectSelectorItem
               project={project}
-              organization={this.props.organization}
+              organization={org}
               multi={multi}
               inputValue={inputValue}
               isChecked={
@@ -342,4 +348,20 @@ const MultiSelect = styled(CheckboxFancy)`
   flex-shrink: 0;
 `;
 
+const ManageButton = styled(Button)`
+  display: block;
+  margin: 0 ${space(1)};
+  box-shadow: none;
+  border: 0;
+  background: ${p => p.theme.offWhite2};
+
+  &:hover,
+  &:active,
+  &:focus {
+    box-shadow: none;
+    border: 0;
+    background: ${p => p.theme.gray1};
+  }
+`;
+
 export default ProjectSelector;
diff --git a/tests/js/spec/components/__snapshots__/dropdownAutoCompleteMenu.spec.jsx.snap b/tests/js/spec/components/__snapshots__/dropdownAutoCompleteMenu.spec.jsx.snap
index 2c5d6e1463..f25ca711be 100644
--- a/tests/js/spec/components/__snapshots__/dropdownAutoCompleteMenu.spec.jsx.snap
+++ b/tests/js/spec/components/__snapshots__/dropdownAutoCompleteMenu.spec.jsx.snap
@@ -65,7 +65,7 @@ exports[`DropdownAutoCompleteMenu renders with a group 1`] = `
               onMouseLeave={[Function]}
             >
               <div
-                className="css-1fwqu7l-StyledMenu-getMenuBorderRadius ejumqxq9"
+                className="css-1fwqu7l-StyledMenu-getMenuBorderRadius ejumqxq8"
                 onClick={[Function]}
                 onMouseDown={[Function]}
                 onMouseEnter={[Function]}
@@ -117,7 +117,7 @@ exports[`DropdownAutoCompleteMenu renders with a group 1`] = `
                     maxHeight={300}
                   >
                     <div
-                      className="css-5kh8cy-StyledItemList ejumqxq10"
+                      className="css-5kh8cy-StyledItemList ejumqxq9"
                     >
                       <LabelWithBorder
                         key="countries"
@@ -242,7 +242,7 @@ exports[`DropdownAutoCompleteMenu renders without a group 1`] = `
               onMouseLeave={[Function]}
             >
               <div
-                className="css-1fwqu7l-StyledMenu-getMenuBorderRadius ejumqxq9"
+                className="css-1fwqu7l-StyledMenu-getMenuBorderRadius ejumqxq8"
                 onClick={[Function]}
                 onMouseDown={[Function]}
                 onMouseEnter={[Function]}
@@ -294,7 +294,7 @@ exports[`DropdownAutoCompleteMenu renders without a group 1`] = `
                     maxHeight={300}
                   >
                     <div
-                      className="css-5kh8cy-StyledItemList ejumqxq10"
+                      className="css-5kh8cy-StyledItemList ejumqxq9"
                     >
                       <AutoCompleteItem
                         highlightedIndex={0}
diff --git a/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap b/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
index 2cd3761fbb..bc913dc388 100644
--- a/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
+++ b/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
@@ -723,6 +723,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                   closeOnSelect={true}
                                   emptyHidesInput={true}
                                   emptyMessage="You have no projects"
+                                  inputActions={[Function]}
                                   inputProps={
                                     Object {
                                       "style": Object {
@@ -750,48 +751,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                   }
                                   maxHeight={500}
                                   menuFooter={[Function]}
-                                  menuProps={
-                                    Object {
-                                      "organization": Object {
-                                        "access": Array [
-                                          "org:read",
-                                          "org:write",
-                                          "org:admin",
-                                          "project:read",
-                                          "project:write",
-                                          "project:admin",
-                                          "team:read",
-                                          "team:write",
-                                          "team:admin",
-                                        ],
-                                        "features": Array [
-                                          "sentry10",
-                                        ],
-                                        "id": "3",
-                                        "name": "Organization Name",
-                                        "onboardingTasks": Array [],
-                                        "projects": Array [
-                                          Object {
-                                            "hasAccess": true,
-                                            "id": "2",
-                                            "isBookmarked": false,
-                                            "isMember": true,
-                                            "name": "Project Name",
-                                            "slug": "project-slug",
-                                            "teams": Array [],
-                                          },
-                                        ],
-                                        "scrapeJavaScript": true,
-                                        "slug": "org-slug",
-                                        "status": Object {
-                                          "id": "active",
-                                          "name": "active",
-                                        },
-                                        "teams": Array [],
-                                      },
-                                      "showSettingsLink": true,
-                                    }
-                                  }
                                   noResultsMessage="No projects found"
                                   onClose={[Function]}
                                   onSelect={[Function]}
@@ -807,6 +766,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                     closeOnSelect={true}
                                     emptyHidesInput={true}
                                     emptyMessage="You have no projects"
+                                    inputActions={[Function]}
                                     inputProps={
                                       Object {
                                         "style": Object {
@@ -834,48 +794,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                     }
                                     maxHeight={500}
                                     menuFooter={[Function]}
-                                    menuProps={
-                                      Object {
-                                        "organization": Object {
-                                          "access": Array [
-                                            "org:read",
-                                            "org:write",
-                                            "org:admin",
-                                            "project:read",
-                                            "project:write",
-                                            "project:admin",
-                                            "team:read",
-                                            "team:write",
-                                            "team:admin",
-                                          ],
-                                          "features": Array [
-                                            "sentry10",
-                                          ],
-                                          "id": "3",
-                                          "name": "Organization Name",
-                                          "onboardingTasks": Array [],
-                                          "projects": Array [
-                                            Object {
-                                              "hasAccess": true,
-                                              "id": "2",
-                                              "isBookmarked": false,
-                                              "isMember": true,
-                                              "name": "Project Name",
-                                              "slug": "project-slug",
-                                              "teams": Array [],
-                                            },
-                                          ],
-                                          "scrapeJavaScript": true,
-                                          "slug": "org-slug",
-                                          "status": Object {
-                                            "id": "active",
-                                            "name": "active",
-                                          },
-                                          "teams": Array [],
-                                        },
-                                        "showSettingsLink": true,
-                                      }
-                                    }
                                     noResultsMessage="No projects found"
                                     onClose={[Function]}
                                     onSelect={[Function]}
