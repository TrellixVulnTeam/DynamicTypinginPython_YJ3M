commit 5eb65eadc9233851272c3d52fb51f8e26f4af65c
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Oct 16 16:44:59 2015 -0700

    Remove unsafe usage of _.map
    
    When a map contained a "length" property this would cause it to treat it as an array instead of a map.

diff --git a/src/sentry/static/sentry/app/components/events/extraData.jsx b/src/sentry/static/sentry/app/components/events/extraData.jsx
index 29dfc96c7f..fd211915ab 100644
--- a/src/sentry/static/sentry/app/components/events/extraData.jsx
+++ b/src/sentry/static/sentry/app/components/events/extraData.jsx
@@ -1,8 +1,7 @@
 import React from "react";
-import _ from "underscore";
 
 import PropTypes from "../../proptypes";
-
+import {objectToArray} from "../../utils";
 import EventDataSection from "./eventDataSection";
 import DefinitionList from "./interfaces/definitionList";
 
@@ -17,9 +16,7 @@ var EventExtraData = React.createClass({
   },
 
   render() {
-    let extraDataArray = _.chain(this.props.event.context)
-      .map((val, key) => [key, val])
-      .value();
+    let extraDataArray = objectToArray(this.props.event.context);
 
     return (
       <EventDataSection
@@ -27,7 +24,9 @@ var EventExtraData = React.createClass({
           event={this.props.event}
           type="extra"
           title="Additional Data">
-          <DefinitionList data={extraDataArray} isContextData={true}/>
+          <DefinitionList
+              data={extraDataArray}
+              isContextData={true}/>
       </EventDataSection>
     );
   }
diff --git a/src/sentry/static/sentry/app/components/events/interfaces/csp.jsx b/src/sentry/static/sentry/app/components/events/interfaces/csp.jsx
index c0d8187989..2e10b8b73c 100644
--- a/src/sentry/static/sentry/app/components/events/interfaces/csp.jsx
+++ b/src/sentry/static/sentry/app/components/events/interfaces/csp.jsx
@@ -1,7 +1,7 @@
 import React from "react";
-import _ from "underscore";
 import PropTypes from "../../../proptypes";
 
+import {objectToArray} from "../../../utils";
 import EventDataSection from "../eventDataSection";
 import DefinitionList from "./definitionList";
 
@@ -15,10 +15,7 @@ var CSPInterface = React.createClass({
 
   render() {
     let {group, event, data} = this.props;
-
-    let extraDataArray = _.chain(data)
-      .map((val, key) => [key.replace(/_/g, '-'), val])
-      .value();
+    let extraDataArray = objectToArray(data);
 
     return (
       <EventDataSection
diff --git a/src/sentry/static/sentry/app/utils.jsx b/src/sentry/static/sentry/app/utils.jsx
index 49bc2ecbc3..7436335853 100644
--- a/src/sentry/static/sentry/app/utils.jsx
+++ b/src/sentry/static/sentry/app/utils.jsx
@@ -64,6 +64,16 @@ var objectMatchesSubset = function(obj, other, deep){
   return true;
 };
 
+// XXX(dcramer): the previous mechanism of using _.map here failed
+// miserably if a param was named 'length'
+const objectToArray = function(obj) {
+  let result = [];
+  for (var key in obj) {
+    result.push([key, obj[key]]);
+  }
+  return result;
+};
+
 var compareArrays = function(arr1, arr2, compFunc) {
   if (arr1 === arr2) {
     return true;
@@ -189,6 +199,7 @@ export default {
   modelsEqual: modelsEqual,
   valueIsEqual: valueIsEqual,
   parseLinkHeader: require('./utils/parseLinkHeader'),
+  objectToArray: objectToArray,
 
   Collection: require('./utils/collection'),
   PendingChangeQueue: require('./utils/pendingChangeQueue'),
