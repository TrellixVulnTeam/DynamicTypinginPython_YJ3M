commit a5460d5e917b1429d42c20ddb459b662a7adc63d
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Mar 28 12:30:18 2019 -0700

    fix: Dont run sentry init as part of arbitrary commands

diff --git a/.travis.yml b/.travis.yml
index 0ca37a3b8f..3dfdbab617 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -37,6 +37,8 @@ env:
     - NODE_DIR="${HOME}/.nvm/versions/node/v$(< .nvmrc)"
     - YARN_VERSION="1.13.0"
 script:
+  # certain commands require sentry init to be run, but this is only true for
+  # running things within Travis
   - make travis-lint-$TEST_SUITE
   - make travis-test-$TEST_SUITE
   - make travis-scan-$TEST_SUITE
diff --git a/Makefile b/Makefile
index 782e72b77c..bddbd8f9e9 100644
--- a/Makefile
+++ b/Makefile
@@ -94,12 +94,10 @@ update-transifex: build-js-po
 
 build-platform-assets:
 	@echo "--> Building platform assets"
-	sentry init
 	@echo "from sentry.utils.integrationdocs import sync_docs; sync_docs(quiet=True)" | sentry exec
 
 fetch-release-registry:
 	@echo "--> Fetching release registry"
-	sentry init
 	@echo "from sentry.utils.distutils import sync_registry; sync_registry()" | sentry exec
 
 test-cli:
@@ -125,7 +123,9 @@ test-styleguide:
 	@npm run snapshot
 	@echo ""
 
-test-python: build-platform-assets
+test-python:
+	sentry init
+	make build-platform-assets
 	@echo "--> Running Python tests"
 	py.test tests/integration tests/sentry --cov . --cov-report="xml:.artifacts/python.coverage.xml" --junit-xml=".artifacts/python.junit.xml" || exit 1
 	@echo ""
@@ -135,7 +135,9 @@ test-snuba:
 	py.test tests/snuba tests/sentry/eventstream/kafka -vv --cov . --cov-report="xml:.artifacts/snuba.coverage.xml" --junit-xml=".artifacts/snuba.junit.xml"
 	@echo ""
 
-test-acceptance: build-platform-assets node-version-check
+test-acceptance: node-version-check
+	sentry init
+	make build-platform-assets
 	@echo "--> Building static assets"
 	@$(WEBPACK) --display errors-only
 	@echo "--> Running acceptance tests"
