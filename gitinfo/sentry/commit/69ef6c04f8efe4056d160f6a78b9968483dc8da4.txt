commit 69ef6c04f8efe4056d160f6a78b9968483dc8da4
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Fri Mar 22 10:22:54 2019 -0700

    feat(ui): Manipulate API error stacktrace to be at callsite (#12475)
    
    This pops off a frame from the API error stacktrace so that it will be at the callsite instead of inside of `requestPromise`

diff --git a/src/sentry/static/sentry/app/api.jsx b/src/sentry/static/sentry/app/api.jsx
index 50ce46a906..4de31c94fb 100644
--- a/src/sentry/static/sentry/app/api.jsx
+++ b/src/sentry/static/sentry/app/api.jsx
@@ -247,18 +247,24 @@ export class Client {
   }
 
   requestPromise(path, {includeAllArgs, ...options} = {}) {
-    return new Promise((resolve, reject) => {
-      // Create an error object here before we make any async calls so
-      // that we have a helpful stacktrace if it errors
-      const error = new Error('API Request Failed');
+    // Create an error object here before we make any async calls so
+    // that we have a helpful stacktrace if it errors
+    const error = new Error(`${options.method || 'GET'} "${path}"`);
 
+    return new Promise((resolve, reject) => {
       this.request(path, {
         ...options,
         success: (data, ...args) => {
           includeAllArgs ? resolve([data, ...args]) : resolve(data);
         },
         error: (resp, ...args) => {
+          // Update error message with response status code
+          error.message = `${error.message} -> ${(resp && resp.status) || 'n/a'}`;
           error.resp = resp;
+
+          // Drop the Client.requestPromise frame so stacktrace starts at `requestPromise` callsite
+          const lines = error.stack.split('\n');
+          error.stack = [lines[0], ...lines.slice(2)].join('\n');
           reject(error);
         },
       });
