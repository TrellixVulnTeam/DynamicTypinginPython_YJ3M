commit f0fe9f8ac0dacb3410acfd398137e72ceaabaddd
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Wed May 10 13:11:33 2017 -0700

    tests: add test coverage for celery beat schedule
    
    This should prevent at least two scenarios:
    
    * Malformed task names.
    * Malformed ScheduleEntry definitions.

diff --git a/tests/sentry/celery/__init__.py b/tests/sentry/celery/__init__.py
new file mode 100644
index 0000000000..c3961685ab
--- /dev/null
+++ b/tests/sentry/celery/__init__.py
@@ -0,0 +1 @@
+from __future__ import absolute_import
diff --git a/tests/sentry/celery/test_app.py b/tests/sentry/celery/test_app.py
new file mode 100644
index 0000000000..77f92f8fdd
--- /dev/null
+++ b/tests/sentry/celery/test_app.py
@@ -0,0 +1,16 @@
+from __future__ import absolute_import
+
+import pytest
+from celery.beat import ScheduleEntry
+from sentry.celery import SentryCelery
+from django.conf import settings
+
+
+@pytest.mark.parametrize('name,entry', settings.CELERYBEAT_SCHEDULE.items())
+def test_validate_celerybeat_schedule(name, entry):
+    app = SentryCelery('sentry')
+    app.config_from_object(settings)
+    app.autodiscover_tasks(lambda: settings.INSTALLED_APPS)
+    app.loader.import_default_modules()
+    entry = ScheduleEntry(name=name, app=app, **entry)
+    assert entry.task in app.tasks
