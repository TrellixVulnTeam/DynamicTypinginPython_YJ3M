commit c046b91818c08290abeb6202667553e9775f2279
Author: Jan Michael Auer <account@jauer.org>
Date:   Tue Jan 2 13:40:06 2018 +0100

     fix(minidump): Handle Temporary and InMemory uploaded files (#6845)
    
    * fix(minidump): Handle Temporary and InMemory uploaded files
    
    * build: Update symbolic

diff --git a/requirements-base.txt b/requirements-base.txt
index 30cb2480e3..1d20e5ab9b 100644
--- a/requirements-base.txt
+++ b/requirements-base.txt
@@ -48,7 +48,7 @@ setproctitle>=1.1.7,<1.2.0
 statsd>=3.1.0,<3.2.0
 structlog==16.1.0
 sqlparse>=0.1.16,<0.2.0
-symbolic>=2.0.0,<3.0.0
+symbolic>=2.0.1,<3.0.0
 toronado>=0.0.11,<0.1.0
 ua-parser>=0.6.1,<0.8.0
 urllib3>=1.22,<1.23
diff --git a/src/sentry/lang/native/utils.py b/src/sentry/lang/native/utils.py
index b5b33ee9d2..5133d5f52c 100644
--- a/src/sentry/lang/native/utils.py
+++ b/src/sentry/lang/native/utils.py
@@ -5,6 +5,7 @@ import six
 import logging
 
 from collections import namedtuple
+from django.core.files.uploadedfile import InMemoryUploadedFile, TemporaryUploadedFile
 from symbolic import parse_addr, arch_from_macho, arch_is_known, ProcessState
 
 from sentry.interfaces.contexts import DeviceContextType
@@ -156,8 +157,13 @@ def sdk_info_to_sdk_id(sdk_info):
     return rv
 
 
-def merge_minidump_event(data, minidump_path):
-    state = ProcessState.from_minidump(minidump_path)
+def merge_minidump_event(data, minidump):
+    if isinstance(minidump, InMemoryUploadedFile):
+        state = ProcessState.from_minidump_buffer(minidump.read())
+    elif isinstance(minidump, TemporaryUploadedFile):
+        state = ProcessState.from_minidump(minidump.temporary_file_path())
+    else:
+        state = ProcessState.from_minidump(minidump.name)
 
     data['level'] = 'fatal' if state.crashed else 'info'
     data['message'] = 'Assertion Error: %s' % state.assertion if state.assertion \
diff --git a/src/sentry/web/api.py b/src/sentry/web/api.py
index 1f1e9b2c9b..0ba8a6bc36 100644
--- a/src/sentry/web/api.py
+++ b/src/sentry/web/api.py
@@ -586,7 +586,7 @@ class MinidumpView(StoreView):
         except KeyError:
             raise APIError('Missing minidump upload')
 
-        merge_minidump_event(data, minidump.temporary_file_path())
+        merge_minidump_event(data, minidump)
         response_or_event_id = self.process(request, data=data, **kwargs)
         if isinstance(response_or_event_id, HttpResponse):
             return response_or_event_id
