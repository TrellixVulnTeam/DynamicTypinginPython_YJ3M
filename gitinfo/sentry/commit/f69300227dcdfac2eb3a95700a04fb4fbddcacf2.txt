commit f69300227dcdfac2eb3a95700a04fb4fbddcacf2
Author: Billy Vong <billyvg@users.noreply.github.com>
Date:   Mon Nov 18 12:17:19 2019 -0800

    build(git-hooks): Change to always suggest `make` when dependeâ€¦ (#15641)
    
    * Changes the post-merge git hook to allow users to copy a single command to update their dependencies.
    * Fixes check for migrations (was previously checking for
    `south_migrations`)
    * Add env var `SENTRY_POST_MERGE_AUTO_UPDATE` to update dependencies

diff --git a/config/hooks/post-merge b/config/hooks/post-merge
index f4004cd3ee..8a5f0e1457 100755
--- a/config/hooks/post-merge
+++ b/config/hooks/post-merge
@@ -9,26 +9,20 @@ trap "rm -f ${files_changed_upstream}" EXIT
 
 git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD > "$files_changed_upstream"
 
-grep -E --quiet 'requirements.*\.txt' "$files_changed_upstream" && py=true
-grep -E --quiet 'yarn.lock' "$files_changed_upstream"           && js=true
-grep -E --quiet 'south_migrations' "$files_changed_upstream"    && migrations=true
+grep -E --quiet 'requirements.*\.txt' "$files_changed_upstream" && py="install-sentry-dev "
+grep -E --quiet 'yarn.lock' "$files_changed_upstream"           && js="install-yarn-pkgs "
+grep -E --quiet 'migrations' "$files_changed_upstream"          && migrations="apply-migrations "
 
-[[ "$py" || "$js" || "$migrations" ]] && cat <<EOF
-
-[${red}${bold}!!!${reset}] ${red}It looks like some dependencies have changed that will require your intervention.${reset}
+update_command="make ${py}${js}${migrations}"
 
-EOF
+[[ "$py" || "$js" || "$migrations" ]] && cat <<EOF
 
-[[ "$py" ]] && cat <<EOF
-    ${red}Run "${bold}make install-sentry-dev${reset}${red}" to refresh your python virtual environment${reset}
-EOF
+[${red}${bold}!!!${reset}] ${red} It looks like some dependencies have changed that will require your intervention. Run the following to update:${reset}
 
-[[ "$js" ]] && cat <<EOF
-    ${red}Run "${bold}yarn${reset}${red}" to update your javascript dependencies${reset}
-EOF
+    ${red}${bold}${update_command}${reset}
 
-[[ "$migrations" ]] && cat <<EOF
-    ${red}Run "${bold}sentry upgrade${reset}${red}" to run database migrations${reset}
 EOF
 
-echo
+if [[ "$SENTRY_POST_MERGE_AUTO_UPDATE" ]]; then
+  $update_command
+fi
