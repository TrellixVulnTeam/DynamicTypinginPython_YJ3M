commit 35883462df1d5e852c52c3242ac70f42233115ec
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Jan 20 13:54:34 2013 -0800

    Add tests for get_buffer

diff --git a/tests/sentry/app/tests.py b/tests/sentry/app/tests.py
index 99caa74b45..e460d17fc8 100644
--- a/tests/sentry/app/tests.py
+++ b/tests/sentry/app/tests.py
@@ -2,6 +2,8 @@
 
 from __future__ import absolute_import
 
+import mock
+
 from sentry import app
 from sentry.testutils import TestCase
 
@@ -10,3 +12,21 @@ class AppTest(TestCase):
     def test_buffer_is_a_buffer(self):
         from sentry.buffer.base import Buffer
         self.assertEquals(type(app.buffer), Buffer)
+
+
+class GetBufferTest(TestCase):
+    def test_raises_import_error_on_invalid_path(self):
+        with self.assertRaises(ImportError):
+            app.get_buffer('lol.FooBar', {})
+
+    @mock.patch('sentry.app.import_string')
+    def test_instantiates_class_with_options(self, import_string):
+        options = {'hello': 'world'}
+        path = 'lol.FooBar'
+
+        result = app.get_buffer(path, options)
+
+        import_string.assert_called_once_with(path)
+        import_string.return_value.assert_called_once_with(**options)
+
+        assert result == import_string.return_value.return_value
