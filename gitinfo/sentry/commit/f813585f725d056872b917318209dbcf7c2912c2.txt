commit f813585f725d056872b917318209dbcf7c2912c2
Author: Michail Sheldyakov <evgenpioneer@gmail.com>
Date:   Mon Dec 5 16:15:08 2011 +0400

    https://github.com/bbangert/zilch/pull/1
    
    Handle Dictionary keys
    As discussed, attempt to ensure that dictionary keys in the transform()'d frame locals are safe for json encoding.
    
    Attempt to make dictionary keys safe for dumpsing.

diff --git a/sentry/utils/__init__.py b/sentry/utils/__init__.py
index b42f1e836e..d588605144 100644
--- a/sentry/utils/__init__.py
+++ b/sentry/utils/__init__.py
@@ -124,7 +124,8 @@ def transform(value, stack=[], context=None):
     elif isinstance(value, uuid.UUID):
         ret = repr(value)
     elif isinstance(value, dict):
-        ret = dict((str(k), transform_rec(v)) for k, v in value.iteritems())
+        ret = dict((k if isinstance(k, str) or isinstance(k, unicode) else repr(k),
+                    transform_rec(v)) for k, v in value.iteritems())
     elif isinstance(value, unicode):
         ret = to_unicode(value)
     elif isinstance(value, str):
