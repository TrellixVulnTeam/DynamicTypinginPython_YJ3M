commit 204bcb4adb87b23468030f519c0d91aa48393ce8
Author: Mark Story <mark@mark-story.com>
Date:   Mon Nov 26 12:49:22 2018 -0500

    fix(integrations) Give better messaging to jira users (#10714)
    
    When a user has jira-admin but not manager/owner access in sentry we
    currently display a broken looking page to them. This communicates that
    they cannot proceed more clearly and hints at how they can move
    forwards.
    
    Refs APP-784

diff --git a/src/sentry/integrations/jira/configure.py b/src/sentry/integrations/jira/configure.py
index 234e1f085e..4b62fe126e 100644
--- a/src/sentry/integrations/jira/configure.py
+++ b/src/sentry/integrations/jira/configure.py
@@ -76,7 +76,7 @@ class JiraConfigureView(View):
             ).values_list('organization_id', flat=True)
 
             form = JiraConfigForm(organizations, initial={'organizations': active_orgs})
-            return self.get_response({'form': form})
+            return self.get_response({'form': form, 'organizations': organizations})
 
         enabled_orgs = [o for o in organizations if o.id in form.cleaned_data['organizations']]
         disabled_orgs = list(set(organizations) - set(enabled_orgs))
diff --git a/src/sentry/templates/sentry/integrations/jira-config.html b/src/sentry/templates/sentry/integrations/jira-config.html
index 28f199275f..13646f9a2e 100644
--- a/src/sentry/templates/sentry/integrations/jira-config.html
+++ b/src/sentry/templates/sentry/integrations/jira-config.html
@@ -51,33 +51,40 @@
         </div>
       {% else %}
         {% if completed %}
-        <div class="aui-message aui-message-success">
-          <p class="title">
-            <strong>Saved!</strong>
-          </p>
-          <p>
-            The Sentry Jira integration is now enabled for the selected
-            organizations. Return to your sentry organization to configure the Jira
-            integration for your organization.
-          </p>
-        </div>
+          <div class="aui-message aui-message-success">
+            <p class="title">
+              <strong>Saved!</strong>
+            </p>
+            <p>
+              The Sentry Jira integration is now enabled for the selected
+              organizations. Return to your sentry organization to configure the Jira
+              integration for your organization.
+            </p>
+          </div>
         {% endif %}
 
-        <form class="aui top-label" action="" method="post">
-          {% csrf_token %}
-          {% for field in form %}
-            <div class="field-group top-label">
-              {{ field.errors }}
-              {{ field.label_tag }} {{ field }}
-              <div class="description">{{ field.help_text }}</div>
+        {% if organizations|length %}
+          <form class="aui top-label" action="" method="post">
+            {% csrf_token %}
+            {% for field in form %}
+              <div class="field-group top-label">
+                {{ field.errors }}
+                {{ field.label_tag }} {{ field }}
+                <div class="description">{{ field.help_text }}</div>
+              </div>
+            {% endfor %}
+            <div class="field-group">
+              <button class="aui-button aui-button-primary" type="submit">
+                  Save Settings
+              </button>
             </div>
-          {% endfor %}
-          <div class="field-group">
-            <button class="aui-button aui-button-primary" type="submit">
-                Save Settings
-            </button>
+          </form>
+        {% else %}
+          <div class="aui-message aui-message-warning">
+            <p>You must have Owner or Manager permissions in Sentry to complete setup.</p>
           </div>
-        </form>
+        {% endif %}
+
       {% endif %}
     {% endif %}
   </div>
