commit bccc5ffdb5eecc5b0c3d883a7093fdc6506edbe9
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Mar 9 11:48:10 2015 -0700

    Switch to using scope-based access for explore/stream links

diff --git a/src/sentry/permissions.py b/src/sentry/permissions.py
index 8264ec3a04..5f67305901 100644
--- a/src/sentry/permissions.py
+++ b/src/sentry/permissions.py
@@ -145,17 +145,6 @@ def can_manage_team(user, team):
     return False
 
 
-@requires_login
-def can_manage_project(user, project):
-    if can_manage_org(user, project.organization):
-        return True
-
-    if is_project_admin(user, project):
-        return True
-
-    return False
-
-
 @requires_login
 def can_add_organization_member(user, organization):
     # must be an owner of the team
diff --git a/src/sentry/templates/sentry/bases/explore.html b/src/sentry/templates/sentry/bases/explore.html
index 086f99874f..f9980448d7 100644
--- a/src/sentry/templates/sentry/bases/explore.html
+++ b/src/sentry/templates/sentry/bases/explore.html
@@ -14,7 +14,7 @@
         <li class="active">
             <a href="{% url 'sentry-explore' project.organization.slug project.slug %}">{% trans "Explore" %}</a>
         </li>
-        {% if request.user|can_manage_project:project %}
+        {% if ACCESS.project_write %}
         <li>
             <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}">
                 {% trans "Settings" %}
diff --git a/src/sentry/templates/sentry/bases/stream.html b/src/sentry/templates/sentry/bases/stream.html
index f93f099ff1..3cc0f470a3 100644
--- a/src/sentry/templates/sentry/bases/stream.html
+++ b/src/sentry/templates/sentry/bases/stream.html
@@ -20,7 +20,7 @@
         <li>
             <a href="{% url 'sentry-explore' project.organization.slug project.slug %}">{% trans "Explore" %}</a>
         </li>
-        {% if request.user|can_manage_project:project %}
+        {% if ACCESS.project_write %}
         <li>
             <a href="{% url 'sentry-manage-project' project.organization.slug project.slug %}">
                 {% trans "Settings" %}
diff --git a/src/sentry/templatetags/sentry_permissions.py b/src/sentry/templatetags/sentry_permissions.py
index 892e4e029c..07852a82f2 100644
--- a/src/sentry/templatetags/sentry_permissions.py
+++ b/src/sentry/templatetags/sentry_permissions.py
@@ -11,7 +11,7 @@ from django import template
 
 from sentry.permissions import (
     can_create_teams, can_create_projects,
-    can_remove_project, can_manage_project, can_manage_team, can_manage_org
+    can_remove_project, can_manage_team, can_manage_org
 )
 
 register = template.Library()
@@ -21,6 +21,5 @@ register = template.Library()
 register.filter('can_create_teams')(lambda a, b: can_create_teams(a, b))
 register.filter('can_create_projects')(lambda a, b: can_create_projects(a, b))
 register.filter('can_manage_team')(lambda a, b: can_manage_team(a, b))
-register.filter('can_manage_project')(lambda a, b: can_manage_project(a, b))
 register.filter('can_manage_org')(lambda a, b: can_manage_org(a, b))
 register.filter('can_remove_project')(lambda a, b: can_remove_project(a, b))
diff --git a/src/sentry/web/frontend/explore.py b/src/sentry/web/frontend/explore.py
index c9fc72a67e..4bfa6cc78d 100644
--- a/src/sentry/web/frontend/explore.py
+++ b/src/sentry/web/frontend/explore.py
@@ -9,6 +9,7 @@ Contains views for the "Explore" section of Sentry.
 """
 from __future__ import absolute_import, division
 
+from sentry.auth import access
 from sentry.models import TagKey, TagValue, Group
 from sentry.web.decorators import has_access
 from sentry.web.helpers import render_to_response
@@ -46,6 +47,10 @@ def tag_list(request, organization, project):
         'team': project.team,
         'organization': organization,
         'tag_list': tag_list,
+        'ACCESS': access.from_user(
+            user=request.user,
+            organization=organization,
+        ).to_django_context(),
     }, request)
 
 
@@ -76,6 +81,10 @@ def tag_value_list(request, organization, project, key):
         'sort_label': SORT_OPTIONS[sort],
         'tag_key': tag_key,
         'tag_values': tag_values_qs,
+        'ACCESS': access.from_user(
+            user=request.user,
+            organization=project.organization,
+        ).to_django_context(),
     }, request)
 
 
@@ -100,4 +109,8 @@ def tag_value_details(request, organization, project, key, value_id):
         'tag_key': tag_key,
         'tag_value': tag_value,
         'event_list': event_list,
+        'ACCESS': access.from_user(
+            user=request.user,
+            organization=organization,
+        ).to_django_context(),
     }, request)
diff --git a/src/sentry/web/frontend/groups.py b/src/sentry/web/frontend/groups.py
index 0ac9d0f981..1266bc2bbe 100644
--- a/src/sentry/web/frontend/groups.py
+++ b/src/sentry/web/frontend/groups.py
@@ -220,6 +220,10 @@ def dashboard(request, organization, team):
         'organization': team.organization,
         'team': team,
         'project_list': project_list,
+        'ACCESS': access.from_user(
+            user=request.user,
+            organization=organization,
+        ).to_django_context(),
     }, request)
 
 
@@ -235,6 +239,10 @@ def wall_display(request, organization, team):
         'team': team,
         'organization': team.organization,
         'project_list': project_list,
+        'ACCESS': access.from_user(
+            user=request.user,
+            organization=organization,
+        ).to_django_context(),
     }, request)
 
 
@@ -293,6 +301,10 @@ def group_list(request, organization, project):
         'cursorless_query_string': cursorless_query_string,
         'sort_label': sort_label,
         'SORT_OPTIONS': SORT_OPTIONS,
+        'ACCESS': access.from_user(
+            user=request.user,
+            organization=organization,
+        ).to_django_context(),
     }, request)
 
 
