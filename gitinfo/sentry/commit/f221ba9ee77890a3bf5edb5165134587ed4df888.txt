commit f221ba9ee77890a3bf5edb5165134587ed4df888
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Mon Oct 12 20:05:40 2015 -0700

    Gracefully handle a NoneType for effective-directive
    
    Fixes GH-2167

diff --git a/src/sentry/interfaces/csp.py b/src/sentry/interfaces/csp.py
index 0e7de81559..0153afc578 100644
--- a/src/sentry/interfaces/csp.py
+++ b/src/sentry/interfaces/csp.py
@@ -82,8 +82,8 @@ class Csp(Interface):
         return '%s in %r' % self.get_violated_directive()
 
     def _normalize_directive(self, directive):
-        if not directive:
-            return directive
+        if directive is None:
+            return '<unknown>'
         bits = filter(None, directive.split(' '))
         return ' '.join([bits[0]] + map(self._normalize_value, bits[1:]))
 
diff --git a/tests/sentry/interfaces/test_csp.py b/tests/sentry/interfaces/test_csp.py
index a53c214b0c..2024aee0f6 100644
--- a/tests/sentry/interfaces/test_csp.py
+++ b/tests/sentry/interfaces/test_csp.py
@@ -90,6 +90,11 @@ class CspTest(TestCase):
         ))
         assert result.get_culprit_directive() == ('blocked-uri', 'self')
 
+        result = Csp.to_python(dict(
+            document_uri='http://example.com/foo',
+        ))
+        assert result.get_culprit_directive() == ('effective-directive', '<unknown>')
+
     @patch('sentry.interfaces.csp.Csp.get_culprit_directive')
     @patch('sentry.interfaces.csp.Csp.get_violated_directive')
     def test_get_hash(self, get_culprit, get_violated):
