commit dd94b0df6055973670127306696226225314bb35
Author: Chris Clark <christopherchristopherclark@gmail.com>
Date:   Fri Apr 12 12:37:07 2019 -0700

    ref(project-selector): more obvious submit button (#12586)
    
    * more obvious submit button
    
    * snapshots
    
    * not hooked up but looks good
    
    * move functionality over to footer
    
    * snapshots
    
    * cleanup
    
    * cleanup 2
    
    * new linter
    
    * use translations
    
    * add to other header items
    
    * snapshots
    
    * remove onSubmit
    
    * snapshots
    
    * fix oopsy from rebase
    
    * snapshots
    
    * fix diff

diff --git a/src/sentry/static/sentry/app/components/dropdownAutoCompleteMenu.jsx b/src/sentry/static/sentry/app/components/dropdownAutoCompleteMenu.jsx
index 2b2f218439..d20d219983 100644
--- a/src/sentry/static/sentry/app/components/dropdownAutoCompleteMenu.jsx
+++ b/src/sentry/static/sentry/app/components/dropdownAutoCompleteMenu.jsx
@@ -227,6 +227,7 @@ class DropdownAutoCompleteMenu extends React.Component {
           {({width}) => (
             <List
               width={width}
+              style={{outline: 'none'}}
               height={Math.min(items.length * virtualizedHeight, maxHeight)}
               rowCount={items.length}
               rowHeight={virtualizedHeight}
diff --git a/src/sentry/static/sentry/app/components/globalSelectionHeaderRow.jsx b/src/sentry/static/sentry/app/components/globalSelectionHeaderRow.jsx
index a0073bf5b8..26451acb87 100644
--- a/src/sentry/static/sentry/app/components/globalSelectionHeaderRow.jsx
+++ b/src/sentry/static/sentry/app/components/globalSelectionHeaderRow.jsx
@@ -69,8 +69,8 @@ const Checkbox = styled(CheckboxFancy)`
 `;
 
 const CheckboxWrapper = styled('div')`
-  margin: 0 -${space(0.5)} 0 0; /* pushes the click box to be flush with the edge of the menu */
-  padding: 0 ${space(1.25)} 0 ${space(1)};
+  margin: 0 -${space(1)} 0 0; /* pushes the click box to be flush with the edge of the menu */
+  padding: 0 ${space(1.5)} 0 ${space(1.25)};
   height: 100%;
   display: flex;
   justify-content: flex-end;
diff --git a/src/sentry/static/sentry/app/components/organizations/headerItem.jsx b/src/sentry/static/sentry/app/components/organizations/headerItem.jsx
index 1b34d2dd64..cb0ad53e34 100644
--- a/src/sentry/static/sentry/app/components/organizations/headerItem.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/headerItem.jsx
@@ -11,7 +11,6 @@ class HeaderItem extends React.Component {
     allowClear: PropTypes.bool,
     icon: PropTypes.element,
     onClear: PropTypes.func,
-    onSubmit: PropTypes.func,
     hasChanges: PropTypes.bool,
     hasSelected: PropTypes.bool,
     isOpen: PropTypes.bool,
@@ -28,28 +27,17 @@ class HeaderItem extends React.Component {
     this.props.onClear();
   };
 
-  handleChevronClick = e => {
-    if (!this.props.hasChanges) {
-      return;
-    }
-
-    e.stopPropagation();
-    this.props.onSubmit();
-  };
-
   render() {
     const {
       className,
       children,
       isOpen,
       hasSelected,
-      hasChanges,
       allowClear,
       icon,
       locked,
       lockedMessage,
       onClear, // eslint-disable-line no-unused-vars
-      onSubmit, // eslint-disable-line no-unused-vars
       ...props
     } = this.props;
 
@@ -74,11 +62,7 @@ class HeaderItem extends React.Component {
           />
         )}
         {!locked && (
-          <StyledChevron
-            isOpen={isOpen}
-            hasChanges={hasChanges}
-            onClick={this.handleChevronClick}
-          >
+          <StyledChevron isOpen={isOpen}>
             <InlineSvg src="icon-chevron-down" />
           </StyledChevron>
         )}
@@ -143,17 +127,6 @@ const StyledChevron = styled('div')`
   display: flex;
   align-items: center;
   justify-content: center;
-  ${p =>
-    p.hasChanges
-      ? `
-    background: ${p.theme.purple};
-    border-radius: 2em;
-    width: 20px;
-    height: 20px;
-    color: #fff;
-    transform: rotate(270deg);
-  `
-      : ''};
 `;
 
 const StyledLock = styled(InlineSvg)`
diff --git a/src/sentry/static/sentry/app/components/organizations/multipleEnvironmentSelector.jsx b/src/sentry/static/sentry/app/components/organizations/multipleEnvironmentSelector.jsx
index 236899f90f..a15328aced 100644
--- a/src/sentry/static/sentry/app/components/organizations/multipleEnvironmentSelector.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/multipleEnvironmentSelector.jsx
@@ -11,6 +11,7 @@ import GlobalSelectionHeaderRow from 'app/components/globalSelectionHeaderRow';
 import HeaderItem from 'app/components/organizations/headerItem';
 import Highlight from 'app/components/highlight';
 import InlineSvg from 'app/components/inlineSvg';
+import MultipleSelectorSubmitRow from 'app/components/organizations/multipleSelectorSubmitRow';
 import SentryTypes from 'app/sentryTypes';
 import theme from 'app/utils/theme';
 import withApi from 'app/utils/withApi';
@@ -234,6 +235,11 @@ class MultipleEnvironmentSelector extends React.PureComponent {
         virtualizedHeight={theme.headerSelectorRowHeight}
         emptyHidesInput
         menuProps={{style: {position: 'relative'}}}
+        menuFooter={({actions}) =>
+          this.state.hasChanges && (
+            <MultipleSelectorSubmitRow onSubmit={() => this.handleUpdate(actions)} />
+          )
+        }
         items={environments.map(env => ({
           value: env,
           searchKey: env,
@@ -253,8 +259,6 @@ class MultipleEnvironmentSelector extends React.PureComponent {
             icon={<StyledInlineSvg src="icon-window" />}
             isOpen={isOpen}
             hasSelected={value && !!value.length}
-            hasChanges={this.state.hasChanges}
-            onSubmit={() => this.handleUpdate(actions)}
             onClear={this.handleClear}
             {...getActorProps({
               isStyled: true,
diff --git a/src/sentry/static/sentry/app/components/organizations/multipleProjectSelector.jsx b/src/sentry/static/sentry/app/components/organizations/multipleProjectSelector.jsx
index 356bf3874e..1295464129 100644
--- a/src/sentry/static/sentry/app/components/organizations/multipleProjectSelector.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/multipleProjectSelector.jsx
@@ -10,6 +10,7 @@ import ProjectSelector from 'app/components/projectSelector';
 import InlineSvg from 'app/components/inlineSvg';
 
 import HeaderItem from 'app/components/organizations/headerItem';
+import MultipleSelectorSubmitRow from 'app/components/organizations/multipleSelectorSubmitRow';
 
 const rootContainerStyles = css`
   display: flex;
@@ -152,6 +153,11 @@ export default class MultipleProjectSelector extends React.PureComponent {
         onClose={this.handleClose}
         onMultiSelect={this.handleMultiSelect}
         rootClassName={rootContainerStyles}
+        menuFooter={({actions}) =>
+          this.state.hasChanges && (
+            <MultipleSelectorSubmitRow onSubmit={() => this.handleUpdate(actions)} />
+          )
+        }
       >
         {({
           getActorProps,
@@ -173,7 +179,6 @@ export default class MultipleProjectSelector extends React.PureComponent {
               hasSelected={hasSelected}
               hasChanges={this.state.hasChanges}
               isOpen={isOpen}
-              onSubmit={() => this.handleUpdate(actions)}
               onClear={this.handleClear}
               allowClear={multi}
               {...getActorProps()}
diff --git a/src/sentry/static/sentry/app/components/organizations/multipleSelectorSubmitRow.jsx b/src/sentry/static/sentry/app/components/organizations/multipleSelectorSubmitRow.jsx
new file mode 100644
index 0000000000..7a3ccb7fc5
--- /dev/null
+++ b/src/sentry/static/sentry/app/components/organizations/multipleSelectorSubmitRow.jsx
@@ -0,0 +1,37 @@
+import PropTypes from 'prop-types';
+import React from 'react';
+import styled from 'react-emotion';
+import Button from 'app/components/button';
+import {growIn} from 'app/styles/animations';
+import space from 'app/styles/space';
+import {t} from 'app/locale';
+
+class MultipleSelectorSubmitRow extends React.Component {
+  static propTypes = {
+    onSubmit: PropTypes.func,
+  };
+
+  render() {
+    const {onSubmit} = this.props;
+
+    return (
+      <SubmitButtonContainer>
+        <SubmitButton onClick={onSubmit} size="xsmall" priority="primary">
+          {t('Apply')}
+        </SubmitButton>
+      </SubmitButtonContainer>
+    );
+  }
+}
+
+const SubmitButtonContainer = styled('div')`
+  display: flex;
+  justify-content: flex-end;
+`;
+
+const SubmitButton = styled(Button)`
+  animation: 0.1s ${growIn} ease-in;
+  margin: ${space(0.5)} 0;
+`;
+
+export default MultipleSelectorSubmitRow;
diff --git a/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx b/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx
index 3da6dce96c..8b8af061b5 100644
--- a/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx
+++ b/src/sentry/static/sentry/app/components/organizations/timeRangeSelector/index.jsx
@@ -20,9 +20,11 @@ import DateSummary from 'app/components/organizations/timeRangeSelector/dateSumm
 import DropdownMenu from 'app/components/dropdownMenu';
 import HeaderItem from 'app/components/organizations/headerItem';
 import InlineSvg from 'app/components/inlineSvg';
+import MultipleSelectorSubmitRow from 'app/components/organizations/multipleSelectorSubmitRow';
 import RelativeSelector from 'app/components/organizations/timeRangeSelector/dateRange/relativeSelector';
 import SelectorItem from 'app/components/organizations/timeRangeSelector/dateRange/selectorItem';
 import SentryTypes from 'app/sentryTypes';
+import space from 'app/styles/space';
 import getDynamicText from 'app/utils/getDynamicText';
 import getRouteStringFromRoutes from 'app/utils/getRouteStringFromRoutes';
 
@@ -315,7 +317,6 @@ class TimeRangeSelector extends React.PureComponent {
               hasChanges={this.state.hasChanges}
               onClear={this.handleClear}
               allowClear={true}
-              onSubmit={this.handleCloseMenu}
               {...getActorProps({isStyled: true})}
             >
               {getDynamicText({value: summary, fixed: 'start to end'})}
@@ -344,15 +345,24 @@ class TimeRangeSelector extends React.PureComponent {
                   )}
                 </SelectorList>
                 {isAbsoluteSelected && (
-                  <DateRange
-                    showTimePicker
-                    utc={this.state.utc}
-                    start={start}
-                    end={end}
-                    onChange={this.handleSelectDateRange}
-                    onChangeUtc={this.handleUseUtc}
-                    organization={organization}
-                  />
+                  <div>
+                    <DateRange
+                      showTimePicker
+                      utc={this.state.utc}
+                      start={start}
+                      end={end}
+                      onChange={this.handleSelectDateRange}
+                      onChangeUtc={this.handleUseUtc}
+                      organization={organization}
+                    />
+                    {this.state.hasChanges && (
+                      <SubmitRow>
+                        <MultipleSelectorSubmitRow
+                          onSubmit={() => this.handleCloseMenu()}
+                        />
+                      </SubmitRow>
+                    )}
+                  </div>
                 )}
               </Menu>
             )}
@@ -401,6 +411,12 @@ const SelectorList = styled(({isAbsoluteSelected, ...props}) => <Flex {...props}
   min-height: 305px;
 `;
 
+const SubmitRow = styled('div')`
+  padding: ${space(0.5)} ${space(1)};
+  border-top: 1px solid ${p => p.theme.borderLight};
+  border-left: 1px solid ${p => p.theme.borderLight};
+`;
+
 export default TimeRangeSelector;
 
 export {TimeRangeRoot};
diff --git a/src/sentry/static/sentry/app/styles/animations.jsx b/src/sentry/static/sentry/app/styles/animations.jsx
index 8277362fd6..4476a7eb37 100644
--- a/src/sentry/static/sentry/app/styles/animations.jsx
+++ b/src/sentry/static/sentry/app/styles/animations.jsx
@@ -4,9 +4,11 @@ import theme from 'app/utils/theme';
 
 export const growIn = keyframes`
   0% {
-    transform: scale(0);
+    opacity: 0;
+    transform: scale(0.75);
   }
   100% {
+    opacity: 1;
     transform: scale(1);
   }
 `;
diff --git a/tests/js/spec/components/forms/__snapshots__/radioGroup.spec.jsx.snap b/tests/js/spec/components/forms/__snapshots__/radioGroup.spec.jsx.snap
index 6bc98a90e2..5b45845ff0 100644
--- a/tests/js/spec/components/forms/__snapshots__/radioGroup.spec.jsx.snap
+++ b/tests/js/spec/components/forms/__snapshots__/radioGroup.spec.jsx.snap
@@ -156,11 +156,11 @@ exports[`RadioGroup render() renders disabled 1`] = `
               >
                 <Component
                   animate={true}
-                  className="css-18ziuuc-RadioLineButtonFill eeb3g7x2"
+                  className="css-14bkqla-RadioLineButtonFill eeb3g7x2"
                   disabled={true}
                 >
                   <div
-                    className="css-18ziuuc-RadioLineButtonFill eeb3g7x2"
+                    className="css-14bkqla-RadioLineButtonFill eeb3g7x2"
                   />
                 </Component>
               </RadioLineButtonFill>
diff --git a/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap b/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
index 3faa79c05d..0e89ff2f31 100644
--- a/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
+++ b/tests/js/spec/views/userFeedback/__snapshots__/organizationUserFeedback.spec.jsx.snap
@@ -684,6 +684,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                 value={Array []}
                               >
                                 <StyledProjectSelector
+                                  menuFooter={[Function]}
                                   multi={false}
                                   multiProjects={Array []}
                                   onChange={[Function]}
@@ -739,6 +740,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                 >
                                   <withProjects(ProjectSelector)
                                     className="css-iw79rr-StyledProjectSelector ewlipse0"
+                                    menuFooter={[Function]}
                                     multi={false}
                                     multiProjects={Array []}
                                     onChange={[Function]}
@@ -794,6 +796,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                   >
                                     <ProjectSelector
                                       className="css-iw79rr-StyledProjectSelector ewlipse0"
+                                      menuFooter={[Function]}
                                       multi={false}
                                       multiProjects={Array []}
                                       onChange={[Function]}
@@ -976,7 +979,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                           onKeyDown={[Function]}
                                                           onMouseEnter={[Function]}
                                                           onMouseLeave={[Function]}
-                                                          onSubmit={[Function]}
                                                           style={
                                                             Object {
                                                               "outline": "none",
@@ -1001,7 +1003,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                             onKeyDown={[Function]}
                                                             onMouseEnter={[Function]}
                                                             onMouseLeave={[Function]}
-                                                            onSubmit={[Function]}
                                                             style={
                                                               Object {
                                                                 "outline": "none",
@@ -1027,7 +1028,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                               onKeyDown={[Function]}
                                                               onMouseEnter={[Function]}
                                                               onMouseLeave={[Function]}
-                                                              onSubmit={[Function]}
                                                               style={
                                                                 Object {
                                                                   "outline": "none",
@@ -1038,6 +1038,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                               <StyledHeaderItem
                                                                 active={false}
                                                                 className="css-12jjx2u-StyledHeaderItem ewlipse1"
+                                                                hasChanges={false}
                                                                 hasSelected={false}
                                                                 innerRef={null}
                                                                 isOpen={false}
@@ -1108,13 +1109,10 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                                     </div>
                                                                   </Content>
                                                                   <StyledChevron
-                                                                    hasChanges={false}
                                                                     isOpen={false}
-                                                                    onClick={[Function]}
                                                                   >
                                                                     <div
-                                                                      className="css-ft4nwy-StyledChevron enk2k7v4"
-                                                                      onClick={[Function]}
+                                                                      className="css-1dsiezd-StyledChevron enk2k7v4"
                                                                     >
                                                                       <InlineSvg
                                                                         src="icon-chevron-down"
@@ -1285,6 +1283,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                     }
                                     items={Array []}
                                     maxHeight={500}
+                                    menuFooter={[Function]}
                                     menuProps={
                                       Object {
                                         "style": Object {
@@ -1318,6 +1317,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                       }
                                       items={Array []}
                                       maxHeight={500}
+                                      menuFooter={[Function]}
                                       menuProps={
                                         Object {
                                           "style": Object {
@@ -1350,6 +1350,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                         }
                                         items={Array []}
                                         maxHeight={500}
+                                        menuFooter={[Function]}
                                         menuProps={
                                           Object {
                                             "style": Object {
@@ -1423,7 +1424,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                       tabIndex={-1}
                                                     >
                                                       <StyledHeaderItem
-                                                        hasChanges={false}
                                                         hasSelected={false}
                                                         icon={
                                                           <StyledInlineSvg
@@ -1437,7 +1437,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                         onKeyDown={[Function]}
                                                         onMouseEnter={[Function]}
                                                         onMouseLeave={[Function]}
-                                                        onSubmit={[Function]}
                                                         style={
                                                           Object {
                                                             "outline": "none",
@@ -1447,7 +1446,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                       >
                                                         <ForwardRef
                                                           className="css-22y332-StyledHeaderItem e1gsuvme0"
-                                                          hasChanges={false}
                                                           hasSelected={false}
                                                           icon={
                                                             <StyledInlineSvg
@@ -1460,7 +1458,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                           onKeyDown={[Function]}
                                                           onMouseEnter={[Function]}
                                                           onMouseLeave={[Function]}
-                                                          onSubmit={[Function]}
                                                           style={
                                                             Object {
                                                               "outline": "none",
@@ -1471,7 +1468,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                           <HeaderItem
                                                             allowClear={true}
                                                             className="css-22y332-StyledHeaderItem e1gsuvme0"
-                                                            hasChanges={false}
                                                             hasSelected={false}
                                                             icon={
                                                               <StyledInlineSvg
@@ -1485,7 +1481,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                             onKeyDown={[Function]}
                                                             onMouseEnter={[Function]}
                                                             onMouseLeave={[Function]}
-                                                            onSubmit={[Function]}
                                                             style={
                                                               Object {
                                                                 "outline": "none",
@@ -1565,13 +1560,10 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                                   </div>
                                                                 </Content>
                                                                 <StyledChevron
-                                                                  hasChanges={false}
                                                                   isOpen={false}
-                                                                  onClick={[Function]}
                                                                 >
                                                                   <div
-                                                                    className="css-ft4nwy-StyledChevron enk2k7v4"
-                                                                    onClick={[Function]}
+                                                                    className="css-1dsiezd-StyledChevron enk2k7v4"
                                                                   >
                                                                     <InlineSvg
                                                                       src="icon-chevron-down"
@@ -1708,7 +1700,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                         onKeyDown={[Function]}
                                         onMouseEnter={[Function]}
                                         onMouseLeave={[Function]}
-                                        onSubmit={[Function]}
                                         style={
                                           Object {
                                             "outline": "none",
@@ -1732,7 +1723,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                           onKeyDown={[Function]}
                                           onMouseEnter={[Function]}
                                           onMouseLeave={[Function]}
-                                          onSubmit={[Function]}
                                           style={
                                             Object {
                                               "outline": "none",
@@ -1757,7 +1747,6 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                             onKeyDown={[Function]}
                                             onMouseEnter={[Function]}
                                             onMouseLeave={[Function]}
-                                            onSubmit={[Function]}
                                             style={
                                               Object {
                                                 "outline": "none",
@@ -1767,6 +1756,7 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                           >
                                             <StyledHeaderItem
                                               className="css-22y332-StyledHeaderItem e1u8612l1"
+                                              hasChanges={false}
                                               hasSelected={false}
                                               innerRef={[Function]}
                                               isOpen={false}
@@ -1837,13 +1827,10 @@ exports[`OrganizationUserFeedback renders 1`] = `
                                                   </div>
                                                 </Content>
                                                 <StyledChevron
-                                                  hasChanges={false}
                                                   isOpen={false}
-                                                  onClick={[Function]}
                                                 >
                                                   <div
-                                                    className="css-ft4nwy-StyledChevron enk2k7v4"
-                                                    onClick={[Function]}
+                                                    className="css-1dsiezd-StyledChevron enk2k7v4"
                                                   >
                                                     <InlineSvg
                                                       src="icon-chevron-down"
