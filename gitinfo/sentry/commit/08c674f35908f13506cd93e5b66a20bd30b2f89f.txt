commit 08c674f35908f13506cd93e5b66a20bd30b2f89f
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Fri Oct 5 14:25:08 2018 -0700

    hack(merge): Explictly don't filter project_id for Events on database

diff --git a/src/sentry/tasks/merge.py b/src/sentry/tasks/merge.py
index 542c5de99b..b6d6c591d1 100644
--- a/src/sentry/tasks/merge.py
+++ b/src/sentry/tasks/merge.py
@@ -224,8 +224,9 @@ def merge_objects(models, group, new_group, limit=1000, logger=None, transaction
 
         # not all models have a 'project' or 'project_id' field, but we make a best effort
         # to filter on one if it is available
+        # HACK(mattrobenolt): Our Event table can't handle the extra project_id bit on the query
         has_project = 'project_id' in all_fields or 'project' in all_fields
-        if has_project:
+        if has_project and model.__name__ != 'Event':
             project_qs = model.objects.filter(project_id=group.project_id)
         else:
             project_qs = model.objects.all()
@@ -237,6 +238,10 @@ def merge_objects(models, group, new_group, limit=1000, logger=None, transaction
             queryset = project_qs.filter(group_id=group.id)
 
         for obj in queryset[:limit]:
+            # HACK(mattrobenolt): The Event table can't actually be filtered
+            # on the database for unknown reasons, so filtering out in Python
+            if has_project and model.__name__ == 'Event' and obj.project_id != group.project_id:
+                continue
             try:
                 with transaction.atomic(using=router.db_for_write(model)):
                     if has_group:
