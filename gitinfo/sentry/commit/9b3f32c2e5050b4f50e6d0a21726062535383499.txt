commit 9b3f32c2e5050b4f50e6d0a21726062535383499
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jan 18 11:54:46 2012 -0800

    Added sentry_version checking for X-Sentry-Auth header, and via the version query arg

diff --git a/docs/client/index.rst b/docs/client/index.rst
index 3c008145c6..27599fc1ad 100644
--- a/docs/client/index.rst
+++ b/docs/client/index.rst
@@ -45,7 +45,8 @@ with the following structure::
 
 You must also send along the following authentication headers::
 
-    X-Sentry-Auth: Sentry sentry_signature=<hmac signature>,
+    X-Sentry-Auth: Sentry sentry_version=2.0,
+    sentry_signature=<hmac signature>,
     sentry_timestamp=<signature timestamp>[,
     sentry_key=<public api key>,[
     sentry_version=<client version, arbitrary>]]
diff --git a/sentry/web/api.py b/sentry/web/api.py
index 34b2ecedc3..9bf58fc2e7 100644
--- a/sentry/web/api.py
+++ b/sentry/web/api.py
@@ -32,6 +32,14 @@ def store(request):
         auth_vars = extract_auth_vars(request)
         data = request.raw_post_data
 
+        if auth_vars:
+            server_version = auth_vars.get('sentry_version', '1.0')
+        else:
+            server_version = request.GET.get('version', '1.0')
+
+        if server_version not in ('1.0', '2.0'):
+            raise APIError('Client/server version mismatch. Unsupported version: %r' % server_version)
+
         if auth_vars:
             project = project_from_auth_vars(auth_vars, data)
         elif request.GET.get('api_key') and request.GET.get('project_id') and request.is_secure():
diff --git a/setup.py b/setup.py
index 7f272769d5..99d3e0b3d0 100755
--- a/setup.py
+++ b/setup.py
@@ -45,7 +45,7 @@ install_requires = [
 
 setup(
     name='sentry',
-    version='2.0.0-RC5',
+    version='2.0.0-RC6',
     author='David Cramer',
     author_email='dcramer@gmail.com',
     url='http://github.com/dcramer/sentry',
