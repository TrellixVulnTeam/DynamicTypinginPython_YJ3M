commit 45da5c9d161d10af0b2d524f304edba645cc473e
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Fri May 25 16:20:58 2018 -0500

    fix(integrations): Respond w/ org integration on install (#8563)
    
    Fixes an inconsistency where we now expect more organization integration
    specific details when rendering an installed integration.

diff --git a/src/sentry/integrations/pipeline.py b/src/sentry/integrations/pipeline.py
index 095a76d436..7e8f3b2156 100644
--- a/src/sentry/integrations/pipeline.py
+++ b/src/sentry/integrations/pipeline.py
@@ -60,7 +60,8 @@ class IntegrationPipeline(Pipeline):
             )
         else:
             integration = ensure_integration(self.provider.key, data)
-        integration.add_organization(self.organization.id)
+
+        org_integration = integration.add_organization(self.organization.id)
 
         # Does this integration provide a user identity for the user setting up
         # the integration?
@@ -91,7 +92,7 @@ class IntegrationPipeline(Pipeline):
                 },
             )
 
-        return self._dialog_response(serialize(integration, self.request.user), True)
+        return self._dialog_response(serialize(org_integration, self.request.user), True)
 
     def _dialog_response(self, data, success):
         return HttpResponse(
diff --git a/src/sentry/models/integration.py b/src/sentry/models/integration.py
index 2b90a3a43e..1c6ba8886f 100644
--- a/src/sentry/models/integration.py
+++ b/src/sentry/models/integration.py
@@ -73,12 +73,11 @@ class Integration(Model):
         """
         Add an organization to this integration.
 
-        Returns True if the OrganizationIntegration was created
+        Returns False if the OrganizationIntegration was not created
         """
-
         try:
             with transaction.atomic():
-                OrganizationIntegration.objects.create(
+                return OrganizationIntegration.objects.create(
                     organization_id=organization_id,
                     integration_id=self.id,
                     default_auth_id=default_auth_id,
@@ -86,15 +85,13 @@ class Integration(Model):
                 )
         except IntegrityError:
             return False
-        else:
-            return True
 
     def add_project(self, project_id, config=None):
         """
         Add a project to this integration. Requires that a
         OrganizationIntegration must exist before the project can be added.
 
-        Returns True if the ProjectIntegration was created
+        Returns False iff the ProjectIntegration was not created
         """
         from sentry.models import Project
         org_id_queryset = Project.objects \
@@ -110,12 +107,10 @@ class Integration(Model):
 
         try:
             with transaction.atomic():
-                ProjectIntegration.objects.create(
+                return ProjectIntegration.objects.create(
                     project_id=project_id,
                     integration_id=self.id,
                     config=config or {},
                 )
         except IntegrityError:
             return False
-        else:
-            return True
