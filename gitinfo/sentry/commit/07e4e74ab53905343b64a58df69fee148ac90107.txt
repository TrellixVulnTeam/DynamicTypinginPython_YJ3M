commit 07e4e74ab53905343b64a58df69fee148ac90107
Author: NisanthanNanthakumar <nisanthan.nanthakumar@sentry.io>
Date:   Tue Feb 25 11:04:17 2020 -0800

    feat(Integration Directory): Update feature gating related to billing to match design (#17265)
    
    Objective
    Update the feature gating related to billing in the detailed integration view to match the design.

diff --git a/src/sentry/static/sentry/app/types/hooks.ts b/src/sentry/static/sentry/app/types/hooks.ts
index 9f2c14b869..52fc68f2de 100644
--- a/src/sentry/static/sentry/app/types/hooks.ts
+++ b/src/sentry/static/sentry/app/types/hooks.ts
@@ -380,10 +380,12 @@ type IntegrationsFeatureGatesHook = () => {
    * features.
    */
   IntegrationFeatures: React.ComponentType<IntegrationFeaturesProps>;
+  IntegrationDirectoryFeatures: React.ComponentType<IntegrationFeaturesProps>;
   /**
    * This component renders the list of integration features.
    */
   FeatureList: React.ComponentType<IntegrationFeatureListProps>;
+  IntegrationDirectoryFeatureList: React.ComponentType<IntegrationFeatureListProps>;
 };
 
 /**
diff --git a/src/sentry/static/sentry/app/utils/integrationUtil.tsx b/src/sentry/static/sentry/app/utils/integrationUtil.tsx
index 42a1e30be5..202a582afa 100644
--- a/src/sentry/static/sentry/app/utils/integrationUtil.tsx
+++ b/src/sentry/static/sentry/app/utils/integrationUtil.tsx
@@ -162,21 +162,27 @@ export const trackIntegrationEvent = (
  * is not registered for rendering the features list like this simply show the
  * features as a normal list.
  */
+const generateFeaturesList = p => (
+  <ul>
+    {p.features.map((f, i) => (
+      <li key={i}>{f.description}</li>
+    ))}
+  </ul>
+);
+
+const generateIntegrationFeatures = p =>
+  p.children({
+    disabled: false,
+    disabledReason: null,
+    ungatedFeatures: p.features,
+    gatedFeatureGroups: [],
+  });
+
 const defaultFeatureGateComponents = {
-  IntegrationFeatures: p =>
-    p.children({
-      disabled: false,
-      disabledReason: null,
-      ungatedFeatures: p.features,
-      gatedFeatureGroups: [],
-    }),
-  FeatureList: p => (
-    <ul>
-      {p.features.map((f, i) => (
-        <li key={i}>{f.description}</li>
-      ))}
-    </ul>
-  ),
+  IntegrationFeatures: generateIntegrationFeatures,
+  IntegrationDirectoryFeatures: generateIntegrationFeatures,
+  FeatureList: generateFeaturesList,
+  IntegrationDirectoryFeatureList: generateFeaturesList,
 } as ReturnType<Hooks['integrations:feature-gates']>;
 
 export const getIntegrationFeatureGate = () => {
diff --git a/src/sentry/static/sentry/app/views/organizationIntegrations/abstractIntegrationDetailedView.tsx b/src/sentry/static/sentry/app/views/organizationIntegrations/abstractIntegrationDetailedView.tsx
index b2c82b1cf2..e08483a3f6 100644
--- a/src/sentry/static/sentry/app/views/organizationIntegrations/abstractIntegrationDetailedView.tsx
+++ b/src/sentry/static/sentry/app/views/organizationIntegrations/abstractIntegrationDetailedView.tsx
@@ -14,7 +14,6 @@ import AsyncComponent from 'app/components/asyncComponent';
 import space from 'app/styles/space';
 import Tag from 'app/views/settings/components/tag';
 import PluginIcon from 'app/plugins/components/pluginIcon';
-import InlineSvg from 'app/components/inlineSvg';
 import Access from 'app/components/acl/access';
 import Tooltip from 'app/components/tooltip';
 import {
@@ -25,6 +24,7 @@ import {
 import Alert, {Props as AlertProps} from 'app/components/alert';
 import ExternalLink from 'app/components/links/externalLink';
 import marked, {singleLineRenderer} from 'app/utils/marked';
+import {IconClose} from 'app/icons';
 import IntegrationStatus from './integrationStatus';
 
 type Tab = 'information' | 'configurations';
@@ -212,7 +212,7 @@ class AbstractIntegrationDetailedView<
   renderTopSection() {
     const {organization} = this.props;
 
-    const {IntegrationFeatures} = getIntegrationFeatureGate();
+    const {IntegrationDirectoryFeatures} = getIntegrationFeatureGate();
     const tags = this.cleanTags();
     return (
       <Flex>
@@ -230,11 +230,9 @@ class AbstractIntegrationDetailedView<
             ))}
           </Flex>
         </NameContainer>
-        <IntegrationFeatures {...this.featureProps}>
+        <IntegrationDirectoryFeatures {...this.featureProps}>
           {({disabled, disabledReason}) => (
             <DisableWrapper>
-              {disabled && <DisabledNotice reason={disabledReason} />}
-
               <Access organization={organization} access={['org:integrations']}>
                 {({hasAccess}) => (
                   <Tooltip
@@ -247,9 +245,10 @@ class AbstractIntegrationDetailedView<
                   </Tooltip>
                 )}
               </Access>
+              {disabled && <DisabledNotice reason={disabledReason} />}
             </DisableWrapper>
           )}
-        </IntegrationFeatures>
+        </IntegrationDirectoryFeatures>
       </Flex>
     );
   }
@@ -265,7 +264,7 @@ class AbstractIntegrationDetailedView<
             className={this.state.tab === tabName ? 'active' : ''}
             onClick={() => this.onTabChange(tabName)}
           >
-            <a style={{textTransform: 'capitalize'}}>{t(this.getTabDiplay(tabName))}</a>
+            <CapitalizedLink>{t(this.getTabDiplay(tabName))}</CapitalizedLink>
           </li>
         ))}
       </ul>
@@ -274,29 +273,40 @@ class AbstractIntegrationDetailedView<
 
   //Returns the information about the integration description and features
   renderInformationCard() {
-    const {FeatureList} = getIntegrationFeatureGate();
+    const {IntegrationDirectoryFeatureList} = getIntegrationFeatureGate();
 
     return (
       <React.Fragment>
-        <Description dangerouslySetInnerHTML={{__html: marked(this.description)}} />
-        <FeatureList {...this.featureProps} provider={{key: this.integrationSlug}} />
-        {this.renderPermissions()}
-        <Metadata>
-          {!!this.author && <AuthorName>{t('By %s', this.author)}</AuthorName>}
-          <div>
+        <Flex>
+          <FlexContainer>
+            <Description dangerouslySetInnerHTML={{__html: marked(this.description)}} />
+            <IntegrationDirectoryFeatureList
+              {...this.featureProps}
+              provider={{key: this.props.params.integrationSlug}}
+            />
+            {this.renderPermissions()}
+            {this.alerts.map((alert, i) => (
+              <Alert key={i} type={alert.type} icon={alert.icon}>
+                <span
+                  dangerouslySetInnerHTML={{__html: singleLineRenderer(alert.text)}}
+                />
+              </Alert>
+            ))}
+          </FlexContainer>
+          <Metadata>
+            {!!this.author && (
+              <div>
+                <CreatedContainer>{t('Created By')}</CreatedContainer>
+                <AuthorName>{this.author}</AuthorName>
+              </div>
+            )}
             {this.resourceLinks.map(({title, url}) => (
               <ExternalLink key={url} href={url}>
                 {t(title)}
               </ExternalLink>
             ))}
-          </div>
-        </Metadata>
-
-        {this.alerts.map((alert, i) => (
-          <Alert key={i} type={alert.type} icon={alert.icon}>
-            <span dangerouslySetInnerHTML={{__html: singleLineRenderer(alert.text)}} />
-          </Alert>
-        ))}
+          </Metadata>
+        </Flex>
       </React.Fragment>
     );
   }
@@ -318,6 +328,14 @@ const Flex = styled('div')`
   display: flex;
 `;
 
+const FlexContainer = styled('div')`
+  flex: 1;
+`;
+
+const CapitalizedLink = styled('a')`
+  text-transform: 'capitalize';
+`;
+
 const StyledTag = styled(Tag)`
   &:not(:first-child) {
     margin-left: ${space(0.5)};
@@ -338,19 +356,24 @@ const Name = styled('div')`
   margin-bottom: ${space(1)};
 `;
 
+const IconCloseCircle = styled(IconClose)`
+  color: ${p => p.theme.red};
+  margin-right: ${space(1)};
+`;
+
 const DisabledNotice = styled(({reason, ...p}: {reason: React.ReactNode}) => (
   <div
     style={{
-      flex: 1,
+      display: 'flex',
       alignItems: 'center',
     }}
     {...p}
   >
-    <InlineSvg src="icon-circle-exclamation" size="1.5em" />
-    <div style={{marginLeft: `${space(1)}`}}>{reason}</div>
+    <IconCloseCircle circle />
+    <span>{reason}</span>
   </div>
 ))`
-  color: ${p => p.theme.red};
+  padding-top: ${space(0.5)};
   font-size: 0.9em;
 `;
 
@@ -369,17 +392,19 @@ const Description = styled('div')`
 `;
 
 const Metadata = styled(Flex)`
+  display: flex;
+  flex-direction: column;
   font-size: 0.9em;
-  margin-bottom: ${space(2)};
+  margin-left: ${space(4)};
+  margin-right: 100px;
 
   a {
-    margin-left: ${space(1)};
+    margin-bottom: ${space(2)};
   }
 `;
 
 const AuthorName = styled('div')`
-  color: ${p => p.theme.gray2};
-  flex: 1;
+  margin-bottom: ${space(4)};
 `;
 
 const StatusWrapper = styled('div')`
@@ -391,6 +416,16 @@ const StatusWrapper = styled('div')`
 const DisableWrapper = styled('div')`
   margin-left: auto;
   align-self: center;
+  display: flex;
+  flex-direction: column;
+  align-items: flex-end;
 `;
 
+const CreatedContainer = styled('div')`
+  text-transform: uppercase;
+  padding-bottom: ${space(1)};
+  color: ${p => p.theme.gray2};
+  font-weight: 600;
+  font-size: 12px;
+`;
 export default AbstractIntegrationDetailedView;
diff --git a/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap b/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap
index 948840e4b4..5d41b80b73 100644
--- a/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap
+++ b/tests/js/spec/components/modals/__snapshots__/integrationDetailsModal.spec.jsx.snap
@@ -143,7 +143,7 @@ exports[`IntegrationDetailsModal renders simple integration 1`] = `
       }
     />
   </Description>
-  <FeatureList
+  <generateFeaturesList
     features={
       Array [
         Object {
@@ -236,7 +236,7 @@ exports[`IntegrationDetailsModal renders simple integration 1`] = `
         />
       </li>
     </ul>
-  </FeatureList>
+  </generateFeaturesList>
   <Metadata>
     <div
       className="css-17nk6hv-Metadata exuwfuv3"
@@ -309,7 +309,7 @@ exports[`IntegrationDetailsModal renders simple integration 1`] = `
       </div>
     </Component>
   </Alert>
-  <IntegrationFeatures
+  <generateIntegrationFeatures
     features={
       Array [
         Object {
@@ -838,6 +838,6 @@ exports[`IntegrationDetailsModal renders simple integration 1`] = `
         </withConfig(Access)>
       </WithOrganizationMockWrapper>
     </div>
-  </IntegrationFeatures>
+  </generateIntegrationFeatures>
 </IntegrationDetailsModal>
 `;
