commit 17030aab654749f1244ab0f1a9a104e803be7425
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Jun 7 10:32:18 2014 -0400

    Additional handling for is_valid_url

diff --git a/src/sentry/http.py b/src/sentry/http.py
index 1b3e8c4ac9..6c6805aa71 100644
--- a/src/sentry/http.py
+++ b/src/sentry/http.py
@@ -42,13 +42,19 @@ def is_valid_url(url):
     Tests a URL to ensure it doesn't appear to be a blacklisted IP range.
     """
     parsed = urlparse(url)
-    ip_address = socket.gethostbyname(parsed.hostname)
-    if ip_address is None:
+    if not parsed.hostname:
         return False
+
+    try:
+        ip_address = socket.gethostbyname(parsed.hostname)
+    except socket.gaierror:
+        return False
+
     ip_network = IPNetwork(ip_address)
     for addr in DISALLOWED_IPS:
         if ip_network in addr:
             return False
+
     return True
 
 
