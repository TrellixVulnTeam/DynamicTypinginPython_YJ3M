commit 6b874a94ac5be77df94985683ac92f71f8e171dd
Author: ted kaemming <ted@kaemming.com>
Date:   Tue Apr 24 11:42:48 2018 -0700

    fix(services): Fix recursion detection/deadlock avoidance in delegator (#8168)

diff --git a/src/sentry/utils/services.py b/src/sentry/utils/services.py
index 9080cf437b..3658523b72 100644
--- a/src/sentry/utils/services.py
+++ b/src/sentry/utils/services.py
@@ -249,7 +249,7 @@ class ServiceDelegator(Service):
         def execute(*args, **kwargs):
             # If this thread already has an active backend for this base class,
             # we can safely call that backend synchronously without delegating.
-            if self in self.state.backends:
+            if self.__backend_base in self.state.backends:
                 backend = type(self).state.backends[self.__backend_base]
                 return getattr(backend, attribute_name)(*args, **kwargs)
 
