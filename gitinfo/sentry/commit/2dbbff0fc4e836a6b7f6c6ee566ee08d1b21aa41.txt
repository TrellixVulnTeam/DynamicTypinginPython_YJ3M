commit 2dbbff0fc4e836a6b7f6c6ee566ee08d1b21aa41
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Mar 1 02:15:59 2012 -0800

    Remove max date query as its unbelievably slow (the counter is not)

diff --git a/sentry/templates/sentry/admin/projects/list.html b/sentry/templates/sentry/admin/projects/list.html
index 4a9fabc704..53a34c2567 100644
--- a/sentry/templates/sentry/admin/projects/list.html
+++ b/sentry/templates/sentry/admin/projects/list.html
@@ -25,13 +25,11 @@
                     <col>
                     <col style="width:150px;">
                     <col style="width:150px;">
-                    <col style="width:50px;">
                 </colgroup>
                 <thead>
                     <tr>
                         <th>{% trans "Project" %}</th>
                         <th style="text-align:center;">{% trans "Daily Events" %}</th>
-                        <th style="text-align:center;">{% trans "Last Event" %}</th>
                     </tr>
                 </thead>
                 <tbody>
@@ -52,9 +50,6 @@
                             <td style="text-align:center; vertical-align:middle;">
                                 <em>~{{ project|avg_events_per_day }}</em>
                             </td>
-                            <td style="text-align:center; vertical-align:middle;">
-                                {{ project.last_event|timesince }}
-                            </td>
                         </tr>
                     {% endfor %}
                 </tbody>
diff --git a/sentry/templates/sentry/admin/users/list_projects.html b/sentry/templates/sentry/admin/users/list_projects.html
index fef21351a0..b3d1e884db 100644
--- a/sentry/templates/sentry/admin/users/list_projects.html
+++ b/sentry/templates/sentry/admin/users/list_projects.html
@@ -24,13 +24,11 @@
                     <col>
                     <col style="width:150px;">
                     <col style="width:150px;">
-                    <col style="width:50px;">
                 </colgroup>
                 <thead>
                     <tr>
                         <th>{% trans "Project" %}</th>
                         <th style="text-align:center;">{% trans "Daily Events" %}</th>
-                        <th style="text-align:center;">{% trans "Last Event" %}</th>
                     </tr>
                 </thead>
                 <tbody>
@@ -43,9 +41,6 @@
                             <td style="text-align:center; vertical-align:middle;">
                                 <em>~{{ project|avg_events_per_day }}</em>
                             </td>
-                            <td style="text-align:center; vertical-align:middle;">
-                                {{ project.last_event|timesince }}
-                            </td>
                         </tr>
                     {% endfor %}
                 </tbody>
diff --git a/sentry/web/frontend/admin.py b/sentry/web/frontend/admin.py
index 2c4e4e969e..4741cc5741 100644
--- a/sentry/web/frontend/admin.py
+++ b/sentry/web/frontend/admin.py
@@ -15,7 +15,7 @@ from django.core.context_processors import csrf
 from django.core.mail import send_mail
 from django.core.urlresolvers import reverse
 from django.db import transaction
-from django.db.models import Sum, Count, Max
+from django.db.models import Sum, Count
 from django.http import HttpResponseRedirect
 from django.views.decorators.csrf import csrf_protect
 from kombu.transport.django.models import Queue
@@ -54,7 +54,6 @@ def manage_projects(request):
     ).exclude(
         projectcountbyminute__date__lte=datetime.datetime.now() - datetime.timedelta(days=30),
     ).annotate(
-        last_event=Max('messagecountbyminute__date'),
         avg_events_per_n=Sum('projectcountbyminute__times_seen'),
         n_value=Count('projectcountbyminute__times_seen')
     ).select_related('owner').order_by('-date_added')
@@ -198,7 +197,6 @@ def list_user_projects(request, user_id):
     ).exclude(
         projectcountbyminute__date__lte=datetime.datetime.now() - datetime.timedelta(days=30),
     ).annotate(
-        last_event=Max('messagecountbyminute__date'),
         avg_events_per_n=Sum('projectcountbyminute__times_seen'),
         n_value=Count('projectcountbyminute__times_seen')
     ).order_by('-date_added')
diff --git a/setup.py b/setup.py
index a15c7522ab..413bd542b9 100755
--- a/setup.py
+++ b/setup.py
@@ -49,7 +49,7 @@ install_requires = [
 
 setup(
     name='sentry',
-    version='3.4.0',
+    version='3.4.1',
     author='David Cramer',
     author_email='dcramer@gmail.com',
     url='http://github.com/dcramer/sentry',
