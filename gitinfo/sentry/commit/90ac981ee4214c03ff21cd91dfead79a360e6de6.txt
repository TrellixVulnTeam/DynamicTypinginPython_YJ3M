commit 90ac981ee4214c03ff21cd91dfead79a360e6de6
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Jan 25 16:04:23 2016 -0800

    Correct filter

diff --git a/src/sentry/web/frontend/accounts.py b/src/sentry/web/frontend/accounts.py
index 446055e86e..12ac692d0a 100644
--- a/src/sentry/web/frontend/accounts.py
+++ b/src/sentry/web/frontend/accounts.py
@@ -176,6 +176,7 @@ def notification_settings(request):
     settings_form = NotificationSettingsForm(request.user, request.POST or None)
 
     project_list = list(Project.objects.filter(
+        team__organizationmemberteam__organizationmember__user=request.user,
         team__organizationmemberteam__is_active=True,
     ).distinct())
 
diff --git a/tests/sentry/web/frontend/accounts/tests.py b/tests/sentry/web/frontend/accounts/tests.py
index 5aeba72b68..c45bfa1f16 100644
--- a/tests/sentry/web/frontend/accounts/tests.py
+++ b/tests/sentry/web/frontend/accounts/tests.py
@@ -125,12 +125,19 @@ class NotificationSettingsTest(TestCase):
         self.assertRequiresAuthentication(self.path)
 
     def test_renders_with_required_context(self):
-        self.login_as(self.user)
-
+        user = self.create_user('foo@example.com')
+        organization = self.create_organization()
+        team = self.create_team(organization=organization)
+        project = self.create_project(organization=organization, team=team)
+        team2 = self.create_team(organization=organization)
+        self.create_project(organization=organization, team=team2)
+        self.create_member(organization=organization, user=user, teams=[project.team])
+        self.login_as(user)
         resp = self.client.get(self.path)
         assert resp.status_code == 200
         self.assertTemplateUsed('sentry/account/notifications.html')
         assert 'form' in resp.context
+        assert len(resp.context['project_forms']) == 1
 
     def test_valid_params(self):
         self.login_as(self.user)
