commit 22a73b3dcde0f1b27921950c13dfeb88b5a4bf04
Author: KKaempen <32143113+KKaempen@users.noreply.github.com>
Date:   Thu Jun 4 12:27:33 2020 -0500

    fix(github): Prevent archived repos from showing in dropdown (#19181)
    
    Keep archived repositories from appearing in the dropdown menu when configuring a Github integration. Tested manually and with a unit test modification.
    
    Fixes ISSUE-659

diff --git a/src/sentry/integrations/github/client.py b/src/sentry/integrations/github/client.py
index 847b1b7ee2..e4155836b5 100644
--- a/src/sentry/integrations/github/client.py
+++ b/src/sentry/integrations/github/client.py
@@ -40,7 +40,8 @@ class GitHubClientMixin(ApiClient):
 
     def get_repositories(self):
         repositories = self.get("/installation/repositories", params={"per_page": 100})
-        return repositories["repositories"]
+        repos = repositories["repositories"]
+        return [repo for repo in repos if not repo.get("archived")]
 
     def search_repositories(self, query):
         return self.get("/search/repositories", params={"q": query})
diff --git a/tests/sentry/integrations/github/test_issues.py b/tests/sentry/integrations/github/test_issues.py
index b211cb68d0..1050c8d5e8 100644
--- a/tests/sentry/integrations/github/test_issues.py
+++ b/tests/sentry/integrations/github/test_issues.py
@@ -178,7 +178,12 @@ class GitHubIssueBasicTest(TestCase):
         responses.add(
             responses.GET,
             "https://api.github.com/installation/repositories",
-            json={"repositories": [{"full_name": "getsentry/sentry", "name": "sentry"}]},
+            json={
+                "repositories": [
+                    {"full_name": "getsentry/sentry", "name": "sentry"},
+                    {"full_name": "getsentry/other", "name": "other", "archived": True},
+                ]
+            },
         )
 
         resp = self.integration.get_create_issue_config(group=event.group)
