commit 29bdda8a9e6c8edcbe26157cf0d7d73ac1773888
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Jul 13 09:12:25 2012 +0200

    Improve team selection on edit project pages

diff --git a/sentry/web/forms/__init__.py b/sentry/web/forms/__init__.py
index 464184e464..a81ecf3617 100644
--- a/sentry/web/forms/__init__.py
+++ b/sentry/web/forms/__init__.py
@@ -76,10 +76,13 @@ class EditProjectForm(forms.ModelForm):
         if len(team_list) == 1 and instance.team == team_list.values()[0]:
             del self.fields['team']
         else:
-            self.fields['team'].choices = [(t.pk, t) for t in sorted(self.team_list.values(), key=lambda x: x.name)]
+            team_choices = [(t.pk, t) for t in sorted(self.team_list.values(), key=lambda x: x.name)]
             if not instance.team:
-                self.fields['team'].choices.insert(0, (None, '-' * 8))
-            self.fields['team'].widget.choices = self.fields['team'].choices
+                team_choices.insert(0, ('', '-' * 8))
+            elif (instance.team.pk, instance.team) not in team_choices:
+                team_choices.insert(1, (instance.team.pk, instance.team))
+            self.fields['team'].choices = team_choices
+            self.fields['team'].widget.choices = team_choices
 
     def clean_team(self):
         value = self.cleaned_data.get('team')
@@ -99,6 +102,7 @@ class EditProjectForm(forms.ModelForm):
 
 
 class EditProjectAdminForm(EditProjectForm):
+    team = forms.ChoiceField(choices=(), required=False)
     owner = UserField(required=False)
 
     class Meta:
diff --git a/sentry/web/forms/teams.py b/sentry/web/forms/teams.py
index 0e2f49cccb..d561e98746 100644
--- a/sentry/web/forms/teams.py
+++ b/sentry/web/forms/teams.py
@@ -50,7 +50,7 @@ class SelectTeamForm(forms.Form):
         super(SelectTeamForm, self).__init__(data=data, *args, **kwargs)
         self.team_list = dict((t.pk, t) for t in team_list.itervalues())
         self.fields['team'].choices = [(t.pk, t) for t in sorted(self.team_list.values(), key=lambda x: x.name)]
-        self.fields['team'].choices.insert(0, (None, '-' * 8))
+        self.fields['team'].choices.insert(0, ('', '-' * 8))
         self.fields['team'].widget.choices = self.fields['team'].choices
 
 
