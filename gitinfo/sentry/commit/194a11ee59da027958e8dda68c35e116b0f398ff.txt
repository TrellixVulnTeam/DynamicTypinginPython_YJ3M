commit 194a11ee59da027958e8dda68c35e116b0f398ff
Author: Lovepreet Sangha <lovepreetssangha@gmail.com>
Date:   Fri Apr 27 13:35:47 2018 -0700

    feat: Continuation of Project Settings Audit Log (#8194)
    
    * feat: Continuation of Audit Log
    
    Can now view Subject Template and Auto Resolve change(s) in the audit log
    
    * potential fix for codecov

diff --git a/src/sentry/api/endpoints/project_details.py b/src/sentry/api/endpoints/project_details.py
index c060f6290f..4057bb1b05 100644
--- a/src/sentry/api/endpoints/project_details.py
+++ b/src/sentry/api/endpoints/project_details.py
@@ -339,8 +339,9 @@ class ProjectDetailsEndpoint(ProjectEndpoint):
             project.update_option(
                 'digests:mail:maximum_delay', result['digestsMaxDelay'])
         if result.get('subjectPrefix') is not None:
-            project.update_option('mail:subject_prefix',
-                                  result['subjectPrefix'])
+            if project.update_option('mail:subject_prefix',
+                                     result['subjectPrefix']):
+                changed_proj_settings['mail:subject_prefix'] = result['subjectPrefix']
         if result.get('subjectTemplate'):
             project.update_option('mail:subject_template',
                                   result['subjectTemplate'])
@@ -364,10 +365,11 @@ class ProjectDetailsEndpoint(ProjectEndpoint):
             project.update_option('sentry:safe_fields', result['safeFields'])
         # resolveAge can be None
         if 'resolveAge' in result:
-            project.update_option(
+            if project.update_option(
                 'sentry:resolve_age',
                 0 if result.get('resolveAge') is None else int(
-                    result['resolveAge']))
+                    result['resolveAge'])):
+                changed_proj_settings['sentry:resolve_age'] = result['resolveAge']
         if result.get('scrapeJavaScript') is not None:
             project.update_option('sentry:scrape_javascript', result['scrapeJavaScript'])
         if result.get('allowedDomains'):
diff --git a/tests/sentry/api/endpoints/test_project_details.py b/tests/sentry/api/endpoints/test_project_details.py
index 4517674edd..51bbf0e381 100644
--- a/tests/sentry/api/endpoints/test_project_details.py
+++ b/tests/sentry/api/endpoints/test_project_details.py
@@ -237,6 +237,8 @@ class ProjectUpdateTest(APITestCase):
             'filters:blacklisted_ips': '127.0.0.1\n198.51.100.0',
             'filters:releases': '1.*\n2.1.*',
             'filters:error_messages': 'TypeError*\n*: integer division by modulo or zero',
+            'mail:subject_prefix': '[Sentry]',
+            'sentry:resolve_age': 1
         }
         with self.feature('projects:custom-inbound-filters'):
             resp = self.client.put(self.path, data={'options': options})
@@ -258,6 +260,16 @@ class ProjectUpdateTest(APITestCase):
         assert project.get_option('sentry:error_messages') == [
             'TypeError*', '*: integer division by modulo or zero'
         ]
+        assert project.get_option('mail:subject_prefix', '[Sentry]')
+        assert AuditLogEntry.objects.filter(
+            organization=project.organization,
+            event=AuditLogEntryEvent.PROJECT_EDIT,
+        ).exists()
+        assert project.get_option('sentry:resolve_age', 1)
+        assert AuditLogEntry.objects.filter(
+            organization=project.organization,
+            event=AuditLogEntryEvent.PROJECT_EDIT,
+        ).exists()
 
     def test_bookmarks(self):
         resp = self.client.put(self.path, data={
