commit e34653cac10b63e3c5c732a5c52eaa5bf3484d5b
Author: Jan Michael Auer <account@jauer.org>
Date:   Wed Nov 14 10:51:13 2018 +0100

    ref(native): Delete debug files without ordering (#10562)

diff --git a/src/sentry/models/debugfile.py b/src/sentry/models/debugfile.py
index 46dd36d2e4..124d3c7c1e 100644
--- a/src/sentry/models/debugfile.py
+++ b/src/sentry/models/debugfile.py
@@ -216,18 +216,16 @@ class ProjectDebugFile(Model):
                 # Explicitly select referencing caches and delete them. Using
                 # the backref does not work, since `dif.id` is None after the
                 # delete.
-                symcache = ProjectSymCacheFile.objects \
+                symcaches = ProjectSymCacheFile.objects \
                     .filter(debug_file_id=dif_id) \
-                    .select_related('cache_file') \
-                    .first()
-                if symcache:
+                    .select_related('cache_file')
+                for symcache in symcaches:
                     symcache.delete()
 
-                cficache = ProjectCfiCacheFile.objects \
+                cficaches = ProjectCfiCacheFile.objects \
                     .filter(debug_file_id=dif_id) \
-                    .select_related('cache_file') \
-                    .first()
-                if cficache:
+                    .select_related('cache_file')
+                for cficache in cficaches:
                     cficache.delete()
 
         self.file.delete()
