commit 6976452a89f5696c59998eb33d9c35c2c8abe72e
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Jun 25 00:04:21 2015 -0700

    Add average rate to system chart

diff --git a/src/sentry/templates/sentry/admin/stats.html b/src/sentry/templates/sentry/admin/stats.html
index 56a491423f..0069a7fc19 100644
--- a/src/sentry/templates/sentry/admin/stats.html
+++ b/src/sentry/templates/sentry/admin/stats.html
@@ -12,7 +12,10 @@
     <h2>{% trans "System Overview" %}</h2>
   </div>
 
-  <h3>Event Throughput</h3>
+  <h3>
+    Event Throughput
+    <small id="rate" class="pull-right"></small>
+  </h3>
   <div id="chart" class="chart"></div>
 
   <script>
@@ -61,6 +64,7 @@
       var oRejected = 0;
       var sReceived = {};
       var sRejected = {};
+      var aReceived = [0, 0]; // received, points
       $.each(rawData['events.total'], function(idx, point){
         var dReceived = point[1];
         var dRejected = rawData['events.dropped'][idx][1];
@@ -74,10 +78,15 @@
         }
         oReceived += dReceived;
         oRejected += dRejected;
+        if (dReceived > 0) {
+          aReceived[0] += dReceived;
+          aReceived[1] += 1;
+        }
       });
       systemTotal.received = oReceived;
       systemTotal.rejected = oRejected;
       systemTotal.accepted = oReceived - oRejected;
+      systemTotal.avgRate = parseInt((aReceived[0] / aReceived[1]) / 60, 10);
 
       stats.rejected = $.map(sRejected, function(value, ts) { return [[ts, value || null]]; });
       stats.accepted = $.map(sReceived, function(value, ts) {
@@ -164,6 +173,8 @@
       $(window).resize(function(){
         $.plot($chart, points, options);
       });
+
+      $('#rate').text(systemTotal.avgRate + ' avg EPM');
     }
   });
   </script>
