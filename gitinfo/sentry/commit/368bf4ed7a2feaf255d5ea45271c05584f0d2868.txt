commit 368bf4ed7a2feaf255d5ea45271c05584f0d2868
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Tue May 17 22:10:56 2016 +0200

    Fixed a bug with sms sign in

diff --git a/src/sentry/web/frontend/twofactor.py b/src/sentry/web/frontend/twofactor.py
index 1435f2a726..6d824a5985 100644
--- a/src/sentry/web/frontend/twofactor.py
+++ b/src/sentry/web/frontend/twofactor.py
@@ -59,7 +59,7 @@ class TwoFactorAuthView(BaseView):
         interface = self.negotiate_interface(request, interfaces)
         if request.method == 'GET':
             activation = interface.activate(request)
-            if activation is not None:
+            if activation is not None and activation.type == 'challenge':
                 challenge = activation.challenge
         elif 'challenge' in request.POST:
             challenge = json.loads(request.POST.get('challenge'))
