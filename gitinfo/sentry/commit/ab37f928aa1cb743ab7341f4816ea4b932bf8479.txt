commit ab37f928aa1cb743ab7341f4816ea4b932bf8479
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Jul 15 08:33:47 2012 -0700

    Correct selection of existing team in new project flow

diff --git a/sentry/templates/sentry/partial/_form_field.html b/sentry/templates/sentry/partial/_form_field.html
index 9cd7c4c6ac..0bc8b7d9ee 100644
--- a/sentry/templates/sentry/partial/_form_field.html
+++ b/sentry/templates/sentry/partial/_form_field.html
@@ -1,4 +1,4 @@
-<div class="control-group{% if field.errors %} error{% endif %}">
+<div class="control-group{% if field.errors %} error{% endif %}" data-name="{{ field.name }}">
     {{ field.label_tag }}
     <div class="controls">
         {{ field }}
diff --git a/sentry/web/forms/teams.py b/sentry/web/forms/teams.py
index d561e98746..d66466bbd5 100644
--- a/sentry/web/forms/teams.py
+++ b/sentry/web/forms/teams.py
@@ -48,11 +48,17 @@ class SelectTeamForm(forms.Form):
 
     def __init__(self, team_list, data, *args, **kwargs):
         super(SelectTeamForm, self).__init__(data=data, *args, **kwargs)
-        self.team_list = dict((t.pk, t) for t in team_list.itervalues())
-        self.fields['team'].choices = [(t.pk, t) for t in sorted(self.team_list.values(), key=lambda x: x.name)]
+        self.team_list = dict((str(t.pk), t) for t in team_list.itervalues())
+        self.fields['team'].choices = [c for c in sorted(self.team_list.iteritems(), key=lambda x: x[1].name)]
         self.fields['team'].choices.insert(0, ('', '-' * 8))
         self.fields['team'].widget.choices = self.fields['team'].choices
 
+    def clean_team(self):
+        value = self.cleaned_data.get('team')
+        if not value:
+            return value
+        return self.team_list.get(value)
+
 
 class BaseTeamMemberForm(forms.ModelForm):
     class Meta:
