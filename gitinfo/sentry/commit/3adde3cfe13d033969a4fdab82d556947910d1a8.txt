commit 3adde3cfe13d033969a4fdab82d556947910d1a8
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Jan 29 12:05:30 2012 -0800

    Add search indexing behind USE_SEARCH setting

diff --git a/sentry/conf/defaults.py b/sentry/conf/defaults.py
index 492933bca6..32b1d30d24 100644
--- a/sentry/conf/defaults.py
+++ b/sentry/conf/defaults.py
@@ -106,3 +106,7 @@ ALLOW_PROJECT_CREATION = False
 # Instructs Sentry to utilize it's queue for background jobs. You will
 # need to ensure that you have workers running if you enable the queue.
 USE_QUEUE = False
+
+# Instructs Sentry to utilize it's internal search indexer on all incoming
+# events..
+USE_SEARCH = True
diff --git a/sentry/manager.py b/sentry/manager.py
index 41ff4f39a0..0e9a34ee3d 100644
--- a/sentry/manager.py
+++ b/sentry/manager.py
@@ -220,7 +220,7 @@ class GroupManager(models.Manager, ChartMixin):
         # TODO: this function is way too damn long and needs refactored
         # the inner imports also suck so let's try to move it away from
         # the objects manager
-        from sentry.models import Event, Project, View
+        from sentry.models import Event, Project, View, SearchDocument
         from sentry.views import View as ViewHandler
 
         project = Project.objects.get(pk=project)
@@ -345,6 +345,9 @@ class GroupManager(models.Manager, ChartMixin):
         if not is_sample:
             event.save()
 
+        if settings.USE_SEARCH:
+            SearchDocument.objects.index(event)
+
         regression_signal.send(sender=self.model, instance=group)
 
         send_group_processors(group=group, event=event, is_new=is_new, is_sample=is_sample)
@@ -681,4 +684,4 @@ class SearchDocumentManager(models.Manager):
                         times_seen=F('times_seen') + count,
                     )
 
-        return document
\ No newline at end of file
+        return document
