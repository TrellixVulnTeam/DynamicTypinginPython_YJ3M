commit 194969dbef6dc55f82b662d6654209af25760628
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Fri Jan 8 12:32:17 2016 -0800

    Add test

diff --git a/tests/sentry/lang/javascript/test_processor.py b/tests/sentry/lang/javascript/test_processor.py
index 2128433e95..81929ea241 100644
--- a/tests/sentry/lang/javascript/test_processor.py
+++ b/tests/sentry/lang/javascript/test_processor.py
@@ -92,8 +92,22 @@ class FetchFileTest(TestCase):
         result = fetch_file('/example.js', release=release)
         assert result.url == '/example.js'
         assert result.body == 'foo'
+        assert isinstance(result.body, unicode)
         assert result.headers == {'content-type': 'application/json'}
 
+    @patch('sentry.lang.javascript.processor.fetch_release_file')
+    def test_non_unicode_release_file(self, mock_fetch_release_file):
+        mock_fetch_release_file.return_value = (
+            {'content-type': 'application/octet-stream'},
+            '\xffff',  # This is some random binary data
+            200
+        )
+
+        release = Release.objects.create(project=self.project, version='1')
+
+        with pytest.raises(BadSource):
+            fetch_file('/example.js', release=release)
+
 
 class DiscoverSourcemapTest(TestCase):
     # discover_sourcemap(result)
