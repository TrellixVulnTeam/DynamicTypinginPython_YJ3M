commit fa310029ec7e21293d632bb672a59877bc2e5531
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Tue Mar 12 20:27:42 2019 +0100

    ref(grouping): Move grouping tests into a subfolder for versioning (#12368)

diff --git a/src/sentry/grouping/api.py b/src/sentry/grouping/api.py
index fc1bbf128c..c2327db369 100644
--- a/src/sentry/grouping/api.py
+++ b/src/sentry/grouping/api.py
@@ -3,7 +3,7 @@ from __future__ import absolute_import
 import re
 import six
 
-from sentry.grouping.strategies.base import CONFIGURATIONS
+from sentry.grouping.strategies.configurations import CONFIGURATIONS, DEFAULT_CONFIG
 from sentry.grouping.component import GroupingComponent
 from sentry.grouping.variants import ChecksumVariant, FallbackVariant, \
     ComponentVariant, CustomFingerprintVariant, SaltedComponentVariant
@@ -22,7 +22,7 @@ def get_calculated_grouping_variants_for_event(event, config_name=None):
     precedence_hint = None
     per_variant_components = {}
 
-    config = CONFIGURATIONS[config_name or 'legacy']
+    config = CONFIGURATIONS[config_name or DEFAULT_CONFIG]
 
     for strategy in config.iter_strategies():
         rv = strategy.get_grouping_component_variants(event, config=config)
@@ -56,7 +56,7 @@ def get_calculated_grouping_variants_for_event(event, config_name=None):
     return rv
 
 
-def get_grouping_variants_for_event(event):
+def get_grouping_variants_for_event(event, config_name=None):
     """Returns a dict of all grouping variants for this event."""
     # If a checksum is set the only variant that comes back from this
     # event is the checksum variant.
@@ -84,7 +84,7 @@ def get_grouping_variants_for_event(event):
 
     # At this point we need to calculate the default event values.  If the
     # fingerprint is salted we will wrap it.
-    components = get_calculated_grouping_variants_for_event(event)
+    components = get_calculated_grouping_variants_for_event(event, config_name)
     rv = {}
 
     # If the fingerprints are unsalted, we can return them right away.
diff --git a/src/sentry/grouping/strategies/base.py b/src/sentry/grouping/strategies/base.py
index 67efb6e6ac..ac265e23ce 100644
--- a/src/sentry/grouping/strategies/base.py
+++ b/src/sentry/grouping/strategies/base.py
@@ -4,7 +4,6 @@ from sentry.grouping.component import GroupingComponent
 
 
 STRATEGIES = {}
-CONFIGURATIONS = {}
 
 
 def strategy(id, variants, interfaces, name=None, score=None):
@@ -27,13 +26,6 @@ def strategy(id, variants, interfaces, name=None, score=None):
     return decorator
 
 
-def register_strategy_config(id, strategies, delegates=None):
-    """Registers a strategy config."""
-    rv = StrategyConfiguration(id, strategies, delegates)
-    CONFIGURATIONS[rv.id] = rv
-    return rv
-
-
 def lookup_strategy(strategy_id):
     """Looks up a strategy by id."""
     try:
@@ -213,4 +205,4 @@ class StrategyConfiguration(object):
 
 
 # A noop config that is passed by default
-NOTHING_CONFIG = register_strategy_config('nothing', {})
+NOTHING_CONFIG = StrategyConfiguration('nothing', {})
diff --git a/src/sentry/grouping/strategies/configurations.py b/src/sentry/grouping/strategies/configurations.py
index 3888354ea6..b1c9b599c4 100644
--- a/src/sentry/grouping/strategies/configurations.py
+++ b/src/sentry/grouping/strategies/configurations.py
@@ -1,10 +1,23 @@
 from __future__ import absolute_import
 
-from sentry.grouping.strategies.base import register_strategy_config
+from sentry.grouping.strategies.base import StrategyConfiguration
+
+
+# The latest version of th edefault config that should be used
+DEFAULT_CONFIG = 'legacy:v1'
+
+# The full mapping of all known configurations.
+CONFIGURATIONS = {}
+
+
+def register_strategy_config(id, strategies, delegates=None):
+    rv = StrategyConfiguration(id, strategies, delegates)
+    CONFIGURATIONS[rv.id] = rv
+    return rv
 
 
 register_strategy_config(
-    id='legacy',
+    id='legacy:v1',
     strategies=[
         'expect-ct:v1',
         'expect-staple:v1',
diff --git a/src/sentry/models/event.py b/src/sentry/models/event.py
index 29ecc4213c..b2126723c3 100644
--- a/src/sentry/models/event.py
+++ b/src/sentry/models/event.py
@@ -157,13 +157,13 @@ class Event(Model):
             return hashes
         return filter(None, [x.get_hash() for x in self.get_grouping_variants().values()])
 
-    def get_grouping_variants(self):
+    def get_grouping_variants(self, force_config=None):
         """
         This is similar to `get_hashes` but will instead return the
         grouping components for each variant in a dictionary.
         """
         from sentry.grouping.api import get_grouping_variants_for_event
-        return get_grouping_variants_for_event(self)
+        return get_grouping_variants_for_event(self, config_name=force_config)
 
     def get_primary_hash(self):
         # TODO: This *might* need to be protected from an IndexError?
diff --git a/tests/sentry/grouping/fixtures/actix.json b/tests/sentry/grouping/configs/legacy:v1/actix.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/actix.json
rename to tests/sentry/grouping/configs/legacy:v1/actix.json
diff --git a/tests/sentry/grouping/fixtures/actix.out b/tests/sentry/grouping/configs/legacy:v1/actix.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/actix.out
rename to tests/sentry/grouping/configs/legacy:v1/actix.out
diff --git a/tests/sentry/grouping/fixtures/aspnetcore.json b/tests/sentry/grouping/configs/legacy:v1/aspnetcore.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/aspnetcore.json
rename to tests/sentry/grouping/configs/legacy:v1/aspnetcore.json
diff --git a/tests/sentry/grouping/fixtures/aspnetcore.out b/tests/sentry/grouping/configs/legacy:v1/aspnetcore.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/aspnetcore.out
rename to tests/sentry/grouping/configs/legacy:v1/aspnetcore.out
diff --git a/tests/sentry/grouping/fixtures/connection-error.json b/tests/sentry/grouping/configs/legacy:v1/connection-error.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/connection-error.json
rename to tests/sentry/grouping/configs/legacy:v1/connection-error.json
diff --git a/tests/sentry/grouping/fixtures/connection-error.out b/tests/sentry/grouping/configs/legacy:v1/connection-error.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/connection-error.out
rename to tests/sentry/grouping/configs/legacy:v1/connection-error.out
diff --git a/tests/sentry/grouping/fixtures/csp-img-src.json b/tests/sentry/grouping/configs/legacy:v1/csp-img-src.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-img-src.json
rename to tests/sentry/grouping/configs/legacy:v1/csp-img-src.json
diff --git a/tests/sentry/grouping/fixtures/csp-img-src.out b/tests/sentry/grouping/configs/legacy:v1/csp-img-src.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-img-src.out
rename to tests/sentry/grouping/configs/legacy:v1/csp-img-src.out
diff --git a/tests/sentry/grouping/fixtures/csp-no-blocked-uri.json b/tests/sentry/grouping/configs/legacy:v1/csp-no-blocked-uri.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-no-blocked-uri.json
rename to tests/sentry/grouping/configs/legacy:v1/csp-no-blocked-uri.json
diff --git a/tests/sentry/grouping/fixtures/csp-no-blocked-uri.out b/tests/sentry/grouping/configs/legacy:v1/csp-no-blocked-uri.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-no-blocked-uri.out
rename to tests/sentry/grouping/configs/legacy:v1/csp-no-blocked-uri.out
diff --git a/tests/sentry/grouping/fixtures/csp-script-data-uri.json b/tests/sentry/grouping/configs/legacy:v1/csp-script-data-uri.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-script-data-uri.json
rename to tests/sentry/grouping/configs/legacy:v1/csp-script-data-uri.json
diff --git a/tests/sentry/grouping/fixtures/csp-script-data-uri.out b/tests/sentry/grouping/configs/legacy:v1/csp-script-data-uri.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-script-data-uri.out
rename to tests/sentry/grouping/configs/legacy:v1/csp-script-data-uri.out
diff --git a/tests/sentry/grouping/fixtures/csp-script-src-uri.json b/tests/sentry/grouping/configs/legacy:v1/csp-script-src-uri.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-script-src-uri.json
rename to tests/sentry/grouping/configs/legacy:v1/csp-script-src-uri.json
diff --git a/tests/sentry/grouping/fixtures/csp-script-src-uri.out b/tests/sentry/grouping/configs/legacy:v1/csp-script-src-uri.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-script-src-uri.out
rename to tests/sentry/grouping/configs/legacy:v1/csp-script-src-uri.out
diff --git a/tests/sentry/grouping/fixtures/csp-style-src-elem.json b/tests/sentry/grouping/configs/legacy:v1/csp-style-src-elem.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-style-src-elem.json
rename to tests/sentry/grouping/configs/legacy:v1/csp-style-src-elem.json
diff --git a/tests/sentry/grouping/fixtures/csp-style-src-elem.out b/tests/sentry/grouping/configs/legacy:v1/csp-style-src-elem.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp-style-src-elem.out
rename to tests/sentry/grouping/configs/legacy:v1/csp-style-src-elem.out
diff --git a/tests/sentry/grouping/fixtures/csp.json b/tests/sentry/grouping/configs/legacy:v1/csp.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp.json
rename to tests/sentry/grouping/configs/legacy:v1/csp.json
diff --git a/tests/sentry/grouping/fixtures/csp.out b/tests/sentry/grouping/configs/legacy:v1/csp.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/csp.out
rename to tests/sentry/grouping/configs/legacy:v1/csp.out
diff --git a/tests/sentry/grouping/fixtures/custom-fingerprint.json b/tests/sentry/grouping/configs/legacy:v1/custom-fingerprint.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/custom-fingerprint.json
rename to tests/sentry/grouping/configs/legacy:v1/custom-fingerprint.json
diff --git a/tests/sentry/grouping/fixtures/custom-fingerprint.out b/tests/sentry/grouping/configs/legacy:v1/custom-fingerprint.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/custom-fingerprint.out
rename to tests/sentry/grouping/configs/legacy:v1/custom-fingerprint.out
diff --git a/tests/sentry/grouping/fixtures/empty.json b/tests/sentry/grouping/configs/legacy:v1/empty.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/empty.json
rename to tests/sentry/grouping/configs/legacy:v1/empty.json
diff --git a/tests/sentry/grouping/fixtures/empty.out b/tests/sentry/grouping/configs/legacy:v1/empty.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/empty.out
rename to tests/sentry/grouping/configs/legacy:v1/empty.out
diff --git a/tests/sentry/grouping/fixtures/exception-comput-hashes.json b/tests/sentry/grouping/configs/legacy:v1/exception-comput-hashes.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-comput-hashes.json
rename to tests/sentry/grouping/configs/legacy:v1/exception-comput-hashes.json
diff --git a/tests/sentry/grouping/fixtures/exception-comput-hashes.out b/tests/sentry/grouping/configs/legacy:v1/exception-comput-hashes.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-comput-hashes.out
rename to tests/sentry/grouping/configs/legacy:v1/exception-comput-hashes.out
diff --git a/tests/sentry/grouping/fixtures/exception-compute-hashes-2.json b/tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes-2.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-compute-hashes-2.json
rename to tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes-2.json
diff --git a/tests/sentry/grouping/fixtures/exception-compute-hashes-2.out b/tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes-2.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-compute-hashes-2.out
rename to tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes-2.out
diff --git a/tests/sentry/grouping/fixtures/exception-compute-hashes-3.json b/tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes-3.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-compute-hashes-3.json
rename to tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes-3.json
diff --git a/tests/sentry/grouping/fixtures/exception-compute-hashes-3.out b/tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes-3.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-compute-hashes-3.out
rename to tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes-3.out
diff --git a/tests/sentry/grouping/fixtures/exception-compute-hashes.json b/tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-compute-hashes.json
rename to tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes.json
diff --git a/tests/sentry/grouping/fixtures/exception-compute-hashes.out b/tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-compute-hashes.out
rename to tests/sentry/grouping/configs/legacy:v1/exception-compute-hashes.out
diff --git a/tests/sentry/grouping/fixtures/exception-without-type.json b/tests/sentry/grouping/configs/legacy:v1/exception-without-type.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-without-type.json
rename to tests/sentry/grouping/configs/legacy:v1/exception-without-type.json
diff --git a/tests/sentry/grouping/fixtures/exception-without-type.out b/tests/sentry/grouping/configs/legacy:v1/exception-without-type.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-without-type.out
rename to tests/sentry/grouping/configs/legacy:v1/exception-without-type.out
diff --git a/tests/sentry/grouping/fixtures/exception-without-value.json b/tests/sentry/grouping/configs/legacy:v1/exception-without-value.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-without-value.json
rename to tests/sentry/grouping/configs/legacy:v1/exception-without-value.json
diff --git a/tests/sentry/grouping/fixtures/exception-without-value.out b/tests/sentry/grouping/configs/legacy:v1/exception-without-value.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/exception-without-value.out
rename to tests/sentry/grouping/configs/legacy:v1/exception-without-value.out
diff --git a/tests/sentry/grouping/fixtures/expectct.json b/tests/sentry/grouping/configs/legacy:v1/expectct.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/expectct.json
rename to tests/sentry/grouping/configs/legacy:v1/expectct.json
diff --git a/tests/sentry/grouping/fixtures/expectct.out b/tests/sentry/grouping/configs/legacy:v1/expectct.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/expectct.out
rename to tests/sentry/grouping/configs/legacy:v1/expectct.out
diff --git a/tests/sentry/grouping/fixtures/frame-comput-hashes-ignores-ENHANCED-clojure-classes.json b/tests/sentry/grouping/configs/legacy:v1/frame-comput-hashes-ignores-ENHANCED-clojure-classes.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-comput-hashes-ignores-ENHANCED-clojure-classes.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-comput-hashes-ignores-ENHANCED-clojure-classes.json
diff --git a/tests/sentry/grouping/fixtures/frame-comput-hashes-ignores-ENHANCED-clojure-classes.out b/tests/sentry/grouping/configs/legacy:v1/frame-comput-hashes-ignores-ENHANCED-clojure-classes.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-comput-hashes-ignores-ENHANCED-clojure-classes.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-comput-hashes-ignores-ENHANCED-clojure-classes.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-ENHANCED-spring-classes.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-ENHANCED-spring-classes.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-ENHANCED-spring-classes.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-ENHANCED-spring-classes.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-ENHANCED-spring-classes.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-ENHANCED-spring-classes.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-ENHANCED-spring-classes.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-ENHANCED-spring-classes.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-extra-ENHANCED-clojure-classes.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-extra-ENHANCED-clojure-classes.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-extra-ENHANCED-clojure-classes.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-extra-ENHANCED-clojure-classes.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-extra-ENHANCED-clojure-classes.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-extra-ENHANCED-clojure-classes.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-extra-ENHANCED-clojure-classes.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-extra-ENHANCED-clojure-classes.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-extra-ENHANCED-spring-classes.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-extra-ENHANCED-spring-classes.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-extra-ENHANCED-spring-classes.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-extra-ENHANCED-spring-classes.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-extra-ENHANCED-spring-classes.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-extra-ENHANCED-spring-classes.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-extra-ENHANCED-spring-classes.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-extra-ENHANCED-spring-classes.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-filename-if-abs-path-is-http.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-abs-path-is-http.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-filename-if-abs-path-is-http.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-abs-path-is-http.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-filename-if-abs-path-is-http.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-abs-path-is-http.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-filename-if-abs-path-is-http.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-abs-path-is-http.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-filename-if-blob.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-blob.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-filename-if-blob.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-blob.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-filename-if-blob.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-blob.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-filename-if-blob.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-blob.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-filename-if-http.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-http.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-filename-if-http.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-http.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-filename-if-http.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-http.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-filename-if-http.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-http.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-filename-if-https.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-https.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-filename-if-https.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-https.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-filename-if-https.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-https.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-filename-if-https.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-filename-if-https.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-java8-lambda-function.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-java8-lambda-function.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-java8-lambda-function.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-java8-lambda-function.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-java8-lambda-function.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-java8-lambda-function.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-java8-lambda-function.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-java8-lambda-function.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-java8-lambda-module.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-java8-lambda-module.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-java8-lambda-module.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-java8-lambda-module.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-java8-lambda-module.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-java8-lambda-module.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-java8-lambda-module.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-java8-lambda-module.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-javassist-2.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist-2.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-javassist-2.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist-2.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-javassist-2.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist-2.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-javassist-2.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist-2.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-javassist-3.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist-3.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-javassist-3.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist-3.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-javassist-3.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist-3.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-javassist-3.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist-3.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-javassist.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-javassist.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-javassist.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-javassist.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-javassist.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-module-if-page-url-2.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-module-if-page-url-2.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-module-if-page-url-2.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-module-if-page-url-2.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-module-if-page-url-2.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-module-if-page-url-2.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-module-if-page-url-2.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-module-if-page-url-2.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-module-if-page-url.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-module-if-page-url.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-module-if-page-url.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-module-if-page-url.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-module-if-page-url.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-module-if-page-url.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-module-if-page-url.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-module-if-page-url.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-safari-native-code.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-safari-native-code.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-safari-native-code.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-safari-native-code.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-safari-native-code.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-safari-native-code.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-safari-native-code.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-safari-native-code.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-constructors-2.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-constructors-2.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-constructors-2.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-constructors-2.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-constructors-2.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-constructors-2.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-constructors-2.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-constructors-2.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-constructors.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-constructors.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-constructors.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-constructors.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-constructors.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-constructors.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-constructors.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-constructors.out
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-methods.json b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-methods.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-methods.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-methods.json
diff --git a/tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-methods.out b/tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-methods.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-ignores-sun-java-generated-methods.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-ignores-sun-java-generated-methods.out
diff --git a/tests/sentry/grouping/fixtures/frame-sanitizes-block-functions.json b/tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-block-functions.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-sanitizes-block-functions.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-block-functions.json
diff --git a/tests/sentry/grouping/fixtures/frame-sanitizes-block-functions.out b/tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-block-functions.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-sanitizes-block-functions.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-block-functions.out
diff --git a/tests/sentry/grouping/fixtures/frame-sanitizes-erb-templates.json b/tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-erb-templates.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-sanitizes-erb-templates.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-erb-templates.json
diff --git a/tests/sentry/grouping/fixtures/frame-sanitizes-erb-templates.out b/tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-erb-templates.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-sanitizes-erb-templates.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-erb-templates.out
diff --git a/tests/sentry/grouping/fixtures/frame-sanitizes-versioned-filenames-2.json b/tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-versioned-filenames-2.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-sanitizes-versioned-filenames-2.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-versioned-filenames-2.json
diff --git a/tests/sentry/grouping/fixtures/frame-sanitizes-versioned-filenames-2.out b/tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-versioned-filenames-2.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-sanitizes-versioned-filenames-2.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-versioned-filenames-2.out
diff --git a/tests/sentry/grouping/fixtures/frame-sanitizes-versioned-filenames.json b/tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-versioned-filenames.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-sanitizes-versioned-filenames.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-versioned-filenames.json
diff --git a/tests/sentry/grouping/fixtures/frame-sanitizes-versioned-filenames.out b/tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-versioned-filenames.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-sanitizes-versioned-filenames.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-sanitizes-versioned-filenames.out
diff --git a/tests/sentry/grouping/fixtures/frame-skips-symbol-if-unknown.json b/tests/sentry/grouping/configs/legacy:v1/frame-skips-symbol-if-unknown.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-skips-symbol-if-unknown.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-skips-symbol-if-unknown.json
diff --git a/tests/sentry/grouping/fixtures/frame-skips-symbol-if-unknown.out b/tests/sentry/grouping/configs/legacy:v1/frame-skips-symbol-if-unknown.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-skips-symbol-if-unknown.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-skips-symbol-if-unknown.out
diff --git a/tests/sentry/grouping/fixtures/frame-uses-context-line-over-function.json b/tests/sentry/grouping/configs/legacy:v1/frame-uses-context-line-over-function.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-uses-context-line-over-function.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-uses-context-line-over-function.json
diff --git a/tests/sentry/grouping/fixtures/frame-uses-context-line-over-function.out b/tests/sentry/grouping/configs/legacy:v1/frame-uses-context-line-over-function.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-uses-context-line-over-function.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-uses-context-line-over-function.out
diff --git a/tests/sentry/grouping/fixtures/frame-uses-function-over-lineno.json b/tests/sentry/grouping/configs/legacy:v1/frame-uses-function-over-lineno.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-uses-function-over-lineno.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-uses-function-over-lineno.json
diff --git a/tests/sentry/grouping/fixtures/frame-uses-function-over-lineno.out b/tests/sentry/grouping/configs/legacy:v1/frame-uses-function-over-lineno.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-uses-function-over-lineno.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-uses-function-over-lineno.out
diff --git a/tests/sentry/grouping/fixtures/frame-uses-module-over-filename.json b/tests/sentry/grouping/configs/legacy:v1/frame-uses-module-over-filename.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-uses-module-over-filename.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-uses-module-over-filename.json
diff --git a/tests/sentry/grouping/fixtures/frame-uses-module-over-filename.out b/tests/sentry/grouping/configs/legacy:v1/frame-uses-module-over-filename.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-uses-module-over-filename.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-uses-module-over-filename.out
diff --git a/tests/sentry/grouping/fixtures/frame-uses-symbol-instead-of-function.json b/tests/sentry/grouping/configs/legacy:v1/frame-uses-symbol-instead-of-function.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-uses-symbol-instead-of-function.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-uses-symbol-instead-of-function.json
diff --git a/tests/sentry/grouping/fixtures/frame-uses-symbol-instead-of-function.out b/tests/sentry/grouping/configs/legacy:v1/frame-uses-symbol-instead-of-function.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-uses-symbol-instead-of-function.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-uses-symbol-instead-of-function.out
diff --git a/tests/sentry/grouping/fixtures/frame-with-only-required-vars.json b/tests/sentry/grouping/configs/legacy:v1/frame-with-only-required-vars.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-with-only-required-vars.json
rename to tests/sentry/grouping/configs/legacy:v1/frame-with-only-required-vars.json
diff --git a/tests/sentry/grouping/fixtures/frame-with-only-required-vars.out b/tests/sentry/grouping/configs/legacy:v1/frame-with-only-required-vars.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/frame-with-only-required-vars.out
rename to tests/sentry/grouping/configs/legacy:v1/frame-with-only-required-vars.out
diff --git a/tests/sentry/grouping/fixtures/hpkp.json b/tests/sentry/grouping/configs/legacy:v1/hpkp.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/hpkp.json
rename to tests/sentry/grouping/configs/legacy:v1/hpkp.json
diff --git a/tests/sentry/grouping/fixtures/hpkp.out b/tests/sentry/grouping/configs/legacy:v1/hpkp.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/hpkp.out
rename to tests/sentry/grouping/configs/legacy:v1/hpkp.out
diff --git a/tests/sentry/grouping/fixtures/java-chained.json b/tests/sentry/grouping/configs/legacy:v1/java-chained.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/java-chained.json
rename to tests/sentry/grouping/configs/legacy:v1/java-chained.json
diff --git a/tests/sentry/grouping/fixtures/java-chained.out b/tests/sentry/grouping/configs/legacy:v1/java-chained.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/java-chained.out
rename to tests/sentry/grouping/configs/legacy:v1/java-chained.out
diff --git a/tests/sentry/grouping/fixtures/java-minimal.json b/tests/sentry/grouping/configs/legacy:v1/java-minimal.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/java-minimal.json
rename to tests/sentry/grouping/configs/legacy:v1/java-minimal.json
diff --git a/tests/sentry/grouping/fixtures/java-minimal.out b/tests/sentry/grouping/configs/legacy:v1/java-minimal.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/java-minimal.out
rename to tests/sentry/grouping/configs/legacy:v1/java-minimal.out
diff --git a/tests/sentry/grouping/fixtures/javascript-exception-no-in-app.json b/tests/sentry/grouping/configs/legacy:v1/javascript-exception-no-in-app.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/javascript-exception-no-in-app.json
rename to tests/sentry/grouping/configs/legacy:v1/javascript-exception-no-in-app.json
diff --git a/tests/sentry/grouping/fixtures/javascript-exception-no-in-app.out b/tests/sentry/grouping/configs/legacy:v1/javascript-exception-no-in-app.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/javascript-exception-no-in-app.out
rename to tests/sentry/grouping/configs/legacy:v1/javascript-exception-no-in-app.out
diff --git a/tests/sentry/grouping/fixtures/javascript-message.json b/tests/sentry/grouping/configs/legacy:v1/javascript-message.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/javascript-message.json
rename to tests/sentry/grouping/configs/legacy:v1/javascript-message.json
diff --git a/tests/sentry/grouping/fixtures/javascript-message.out b/tests/sentry/grouping/configs/legacy:v1/javascript-message.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/javascript-message.out
rename to tests/sentry/grouping/configs/legacy:v1/javascript-message.out
diff --git a/tests/sentry/grouping/fixtures/laravel.json b/tests/sentry/grouping/configs/legacy:v1/laravel.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/laravel.json
rename to tests/sentry/grouping/configs/legacy:v1/laravel.json
diff --git a/tests/sentry/grouping/fixtures/laravel.out b/tests/sentry/grouping/configs/legacy:v1/laravel.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/laravel.out
rename to tests/sentry/grouping/configs/legacy:v1/laravel.out
diff --git a/tests/sentry/grouping/fixtures/logentry-prefers-message.json b/tests/sentry/grouping/configs/legacy:v1/logentry-prefers-message.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/logentry-prefers-message.json
rename to tests/sentry/grouping/configs/legacy:v1/logentry-prefers-message.json
diff --git a/tests/sentry/grouping/fixtures/logentry-prefers-message.out b/tests/sentry/grouping/configs/legacy:v1/logentry-prefers-message.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/logentry-prefers-message.out
rename to tests/sentry/grouping/configs/legacy:v1/logentry-prefers-message.out
diff --git a/tests/sentry/grouping/fixtures/logentry-uses-formatted.json b/tests/sentry/grouping/configs/legacy:v1/logentry-uses-formatted.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/logentry-uses-formatted.json
rename to tests/sentry/grouping/configs/legacy:v1/logentry-uses-formatted.json
diff --git a/tests/sentry/grouping/fixtures/logentry-uses-formatted.out b/tests/sentry/grouping/configs/legacy:v1/logentry-uses-formatted.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/logentry-uses-formatted.out
rename to tests/sentry/grouping/configs/legacy:v1/logentry-uses-formatted.out
diff --git a/tests/sentry/grouping/fixtures/message-prefers-message.json b/tests/sentry/grouping/configs/legacy:v1/message-prefers-message.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/message-prefers-message.json
rename to tests/sentry/grouping/configs/legacy:v1/message-prefers-message.json
diff --git a/tests/sentry/grouping/fixtures/message-prefers-message.out b/tests/sentry/grouping/configs/legacy:v1/message-prefers-message.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/message-prefers-message.out
rename to tests/sentry/grouping/configs/legacy:v1/message-prefers-message.out
diff --git a/tests/sentry/grouping/fixtures/message-uses-formatted.json b/tests/sentry/grouping/configs/legacy:v1/message-uses-formatted.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/message-uses-formatted.json
rename to tests/sentry/grouping/configs/legacy:v1/message-uses-formatted.json
diff --git a/tests/sentry/grouping/fixtures/message-uses-formatted.out b/tests/sentry/grouping/configs/legacy:v1/message-uses-formatted.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/message-uses-formatted.out
rename to tests/sentry/grouping/configs/legacy:v1/message-uses-formatted.out
diff --git a/tests/sentry/grouping/fixtures/minified-javascript.json b/tests/sentry/grouping/configs/legacy:v1/minified-javascript.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/minified-javascript.json
rename to tests/sentry/grouping/configs/legacy:v1/minified-javascript.json
diff --git a/tests/sentry/grouping/fixtures/minified-javascript.out b/tests/sentry/grouping/configs/legacy:v1/minified-javascript.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/minified-javascript.out
rename to tests/sentry/grouping/configs/legacy:v1/minified-javascript.out
diff --git a/tests/sentry/grouping/fixtures/node-exception-weird.json b/tests/sentry/grouping/configs/legacy:v1/node-exception-weird.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/node-exception-weird.json
rename to tests/sentry/grouping/configs/legacy:v1/node-exception-weird.json
diff --git a/tests/sentry/grouping/fixtures/node-exception-weird.out b/tests/sentry/grouping/configs/legacy:v1/node-exception-weird.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/node-exception-weird.out
rename to tests/sentry/grouping/configs/legacy:v1/node-exception-weird.out
diff --git a/tests/sentry/grouping/fixtures/python-exception-base.json b/tests/sentry/grouping/configs/legacy:v1/python-exception-base.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/python-exception-base.json
rename to tests/sentry/grouping/configs/legacy:v1/python-exception-base.json
diff --git a/tests/sentry/grouping/fixtures/python-exception-base.out b/tests/sentry/grouping/configs/legacy:v1/python-exception-base.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/python-exception-base.out
rename to tests/sentry/grouping/configs/legacy:v1/python-exception-base.out
diff --git a/tests/sentry/grouping/fixtures/python-http-error.json b/tests/sentry/grouping/configs/legacy:v1/python-http-error.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/python-http-error.json
rename to tests/sentry/grouping/configs/legacy:v1/python-http-error.json
diff --git a/tests/sentry/grouping/fixtures/python-http-error.out b/tests/sentry/grouping/configs/legacy:v1/python-http-error.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/python-http-error.out
rename to tests/sentry/grouping/configs/legacy:v1/python-http-error.out
diff --git a/tests/sentry/grouping/fixtures/react-native.json b/tests/sentry/grouping/configs/legacy:v1/react-native.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/react-native.json
rename to tests/sentry/grouping/configs/legacy:v1/react-native.json
diff --git a/tests/sentry/grouping/fixtures/react-native.out b/tests/sentry/grouping/configs/legacy:v1/react-native.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/react-native.out
rename to tests/sentry/grouping/configs/legacy:v1/react-native.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-cocoa.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-cocoa.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-cocoa.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-cocoa.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-cocoa.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-cocoa.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-cocoa.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-cocoa.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-collapse-recursion.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-collapse-recursion.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-collapse-recursion.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-collapse-recursion.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-collapse-recursion.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-collapse-recursion.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-collapse-recursion.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-collapse-recursion.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-compute-hashes.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-compute-hashes.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-compute-hashes.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-compute-hashes.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-compute-hashes.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-compute-hashes.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-compute-hashes.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-compute-hashes.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-discards-seemingly-useless-stack.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-discards-seemingly-useless-stack.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-discards-seemingly-useless-stack.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-discards-seemingly-useless-stack.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-discards-seemingly-useless-stack.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-discards-seemingly-useless-stack.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-discards-seemingly-useless-stack.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-discards-seemingly-useless-stack.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-does-not-discard-non-urls.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-does-not-discard-non-urls.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-does-not-discard-non-urls.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-does-not-discard-non-urls.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-does-not-discard-non-urls.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-does-not-discard-non-urls.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-does-not-discard-non-urls.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-does-not-discard-non-urls.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-does-not-group-different-js-errors.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-does-not-group-different-js-errors.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-does-not-group-different-js-errors.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-does-not-group-different-js-errors.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-does-not-group-different-js-errors.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-does-not-group-different-js-errors.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-does-not-group-different-js-errors.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-does-not-group-different-js-errors.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-excludes-single-frame-urls.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-excludes-single-frame-urls.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-excludes-single-frame-urls.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-excludes-single-frame-urls.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-excludes-single-frame-urls.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-excludes-single-frame-urls.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-excludes-single-frame-urls.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-excludes-single-frame-urls.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-hash-without-system-frames.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-hash-without-system-frames.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-hash-without-system-frames.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-hash-without-system-frames.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-hash-without-system-frames.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-hash-without-system-frames.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-hash-without-system-frames.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-hash-without-system-frames.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-ignores-singular-anonymous-frame.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-ignores-singular-anonymous-frame.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-ignores-singular-anonymous-frame.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-ignores-singular-anonymous-frame.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-ignores-singular-anonymous-frame.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-ignores-singular-anonymous-frame.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-ignores-singular-anonymous-frame.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-ignores-singular-anonymous-frame.out
diff --git a/tests/sentry/grouping/fixtures/stacktrace-with-minimal-app-frames.json b/tests/sentry/grouping/configs/legacy:v1/stacktrace-with-minimal-app-frames.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-with-minimal-app-frames.json
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-with-minimal-app-frames.json
diff --git a/tests/sentry/grouping/fixtures/stacktrace-with-minimal-app-frames.out b/tests/sentry/grouping/configs/legacy:v1/stacktrace-with-minimal-app-frames.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/stacktrace-with-minimal-app-frames.out
rename to tests/sentry/grouping/configs/legacy:v1/stacktrace-with-minimal-app-frames.out
diff --git a/tests/sentry/grouping/fixtures/template-compute-hashes.json b/tests/sentry/grouping/configs/legacy:v1/template-compute-hashes.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/template-compute-hashes.json
rename to tests/sentry/grouping/configs/legacy:v1/template-compute-hashes.json
diff --git a/tests/sentry/grouping/fixtures/template-compute-hashes.out b/tests/sentry/grouping/configs/legacy:v1/template-compute-hashes.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/template-compute-hashes.out
rename to tests/sentry/grouping/configs/legacy:v1/template-compute-hashes.out
diff --git a/tests/sentry/grouping/fixtures/threads-compute-hashes.json b/tests/sentry/grouping/configs/legacy:v1/threads-compute-hashes.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/threads-compute-hashes.json
rename to tests/sentry/grouping/configs/legacy:v1/threads-compute-hashes.json
diff --git a/tests/sentry/grouping/fixtures/threads-compute-hashes.out b/tests/sentry/grouping/configs/legacy:v1/threads-compute-hashes.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/threads-compute-hashes.out
rename to tests/sentry/grouping/configs/legacy:v1/threads-compute-hashes.out
diff --git a/tests/sentry/grouping/fixtures/threads-no-hash.json b/tests/sentry/grouping/configs/legacy:v1/threads-no-hash.json
similarity index 100%
rename from tests/sentry/grouping/fixtures/threads-no-hash.json
rename to tests/sentry/grouping/configs/legacy:v1/threads-no-hash.json
diff --git a/tests/sentry/grouping/fixtures/threads-no-hash.out b/tests/sentry/grouping/configs/legacy:v1/threads-no-hash.out
similarity index 100%
rename from tests/sentry/grouping/fixtures/threads-no-hash.out
rename to tests/sentry/grouping/configs/legacy:v1/threads-no-hash.out
diff --git a/tests/sentry/grouping/test_variants.py b/tests/sentry/grouping/test_variants.py
index 379257887d..c049942c2a 100644
--- a/tests/sentry/grouping/test_variants.py
+++ b/tests/sentry/grouping/test_variants.py
@@ -46,16 +46,30 @@ def dump_variant(variant, lines=None, indent=0):
     return lines
 
 
-_fixture_path = os.path.join(os.path.dirname(__file__), 'fixtures')
+_fixture_path = os.path.join(os.path.dirname(__file__), 'configs')
 
 
-@pytest.mark.parametrize('infile', list(x[:-5] for x in os.listdir(_fixture_path)
-                                        if x.endswith('.json')))
-def test_event_hash_variant(infile):
-    with open(os.path.join(_fixture_path, infile + '.json')) as f:
+def load_configs():
+    configs = os.listdir(_fixture_path)
+
+    rv = []
+    for config in configs:
+        folder = os.path.join(_fixture_path, config)
+        for filename in os.listdir(folder):
+            if filename.endswith('.json'):
+                rv.append((config, filename[:-5]))
+
+    rv.sort()
+
+    return rv
+
+
+@pytest.mark.parametrize('config_name,test_name', load_configs())
+def test_event_hash_variant(config_name, test_name):
+    with open(os.path.join(_fixture_path, config_name, test_name + '.json')) as f:
         input = json.load(f)
     try:
-        with open(os.path.join(_fixture_path, infile + '.out')) as f:
+        with open(os.path.join(_fixture_path, config_name, test_name + '.out')) as f:
             refval = f.read().decode('utf-8').rstrip()
     except IOError:
         refval = ''
@@ -76,7 +90,4 @@ def test_event_hash_variant(infile):
         log(output)
     log(repr(evt.get_hashes()))
 
-    assert sorted(evt.get_hashes()) == sorted(
-        filter(None, [x.get_hash() for x in evt.get_grouping_variants().values()]))
-
     assert refval == output
