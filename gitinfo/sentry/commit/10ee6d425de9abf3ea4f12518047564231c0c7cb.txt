commit 10ee6d425de9abf3ea4f12518047564231c0c7cb
Author: Gabe Smedresman <gabesmed@yahoo.com>
Date:   Mon Jan 11 11:46:30 2010 -0800

    Bugfix in logging error type in ErrorBatch and add bulk resolve option in admin screen

diff --git a/djangodblog/admin.py b/djangodblog/admin.py
index efb4baa884..e18764c36e 100644
--- a/djangodblog/admin.py
+++ b/djangodblog/admin.py
@@ -6,6 +6,18 @@ class ErrorBatchAdmin(admin.ModelAdmin):
     list_display    = ('logger', 'class_name', 'status', 'message', 'last_seen', 'times_seen', 'url', 'server_name')
     list_filter     = ('logger', 'class_name', 'server_name', 'status')
     ordering        = ('status', '-last_seen')
+    actions         = ['resolve_errorbatch']
+
+    def resolve_errorbatch(self, request, queryset):
+        rows_updated = queryset.update(status=1)
+        
+        if rows_updated == 1:
+            message_bit = "1 error batch was"
+        else:
+            message_bit = "%s error batches were" % rows_updated
+        self.message_user(request, "%s resolved." % message_bit)
+        
+    resolve_errorbatch.short_description = 'Resolve selected error batches'
 
 class ErrorAdmin(admin.ModelAdmin):
     list_display    = ('logger', 'class_name', 'message', 'datetime', 'url', 'server_name')
diff --git a/djangodblog/manager.py b/djangodblog/manager.py
index 7041d94dd4..dca820cf23 100644
--- a/djangodblog/manager.py
+++ b/djangodblog/manager.py
@@ -131,6 +131,7 @@ class DBLogManager(models.Manager):
                 **defaults
             )
             batch, created = ErrorBatch.objects.get_or_create(
+                class_name = class_name,
                 server_name = server_name,
                 checksum = checksum,
                 defaults = defaults
