commit 4cff3789d5e5cf4b4fb0be06dd68f714b9260500
Author: Matt Robenolt <matt@ydekproductions.com>
Date:   Wed Jan 25 16:53:10 2017 -0800

    config: provide helper for extracting environment variables

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 34289fd5bb..b1883758f4 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -18,6 +18,7 @@ import sys
 import tempfile
 
 import sentry
+from sentry.utils.types import type_from_value
 
 from datetime import timedelta
 from six.moves.urllib.parse import urlparse
@@ -26,6 +27,24 @@ gettext_noop = lambda s: s
 
 socket.setdefaulttimeout(5)
 
+
+def env(key, default='', type=None):
+    "Extract an environment variable for use in configuration"
+
+    if 'SENTRY_RUNNING_UWSGI' in os.environ:
+        # We do this so when the process forks off into uwsgi
+        # we want to actually be popping off values. This is so that
+        # at runtime, the variables aren't actually available.
+        fn = os.environ.pop
+    else:
+        fn = os.environ.get
+
+    if type is None:
+        type = type_from_value(default)
+
+    return type(fn(key, default))
+
+
 DEBUG = False
 TEMPLATE_DEBUG = True
 MAINTENANCE = False
