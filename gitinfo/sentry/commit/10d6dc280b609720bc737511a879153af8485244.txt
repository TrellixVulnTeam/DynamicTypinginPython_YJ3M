commit 10d6dc280b609720bc737511a879153af8485244
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Thu May 2 14:36:11 2019 -0700

    feat: Drop project ID param from group absolute URL (#13041)
    
    Group urls do not need a project ID as part of a URL. We display a locked project
    state in the UI so this link should make sense without it. The downside of
    this is that navigating away from this page will preserve whatever
    project selection a user had previously active.
    
    This came up in SEN-515

diff --git a/src/sentry/models/group.py b/src/sentry/models/group.py
index ff4e15b509..ba96189df4 100644
--- a/src/sentry/models/group.py
+++ b/src/sentry/models/group.py
@@ -318,8 +318,6 @@ class Group(Model):
         from sentry import features
         if features.has('organizations:sentry10', self.organization):
             url = reverse('sentry-organization-issue', args=[self.organization.slug, self.id])
-            params = {} if params is None else params
-            params['project'] = self.project.id
         else:
             url = reverse('sentry-group', args=[self.organization.slug, self.project.slug, self.id])
         if params:
diff --git a/tests/fixtures/emails/assigned.txt b/tests/fixtures/emails/assigned.txt
index 2d63f6b339..9bcbb3a4d0 100644
--- a/tests/fixtures/emails/assigned.txt
+++ b/tests/fixtures/emails/assigned.txt
@@ -7,7 +7,7 @@ foo@example.com assigned an issue to foo@example.com
 
 ornare elit pulvinar nisl integer cum ad massa
 
-http://testserver/organizations/organization/issues/1/?project=1&amp;referrer=AssignedActivityEmail
+http://testserver/organizations/organization/issues/1/?referrer=AssignedActivityEmail
 
 
 Unsubscribe: javascript:alert("This is a preview page, what did you expect to happen?");
diff --git a/tests/fixtures/emails/assigned_self.txt b/tests/fixtures/emails/assigned_self.txt
index 70e63f46fa..deee7d638f 100644
--- a/tests/fixtures/emails/assigned_self.txt
+++ b/tests/fixtures/emails/assigned_self.txt
@@ -7,7 +7,7 @@ foo@example.com assigned an issue to themselves
 
 ornare elit pulvinar nisl integer cum ad massa
 
-http://testserver/organizations/organization/issues/1/?project=1&amp;referrer=AssignedActivityEmail
+http://testserver/organizations/organization/issues/1/?referrer=AssignedActivityEmail
 
 
 Unsubscribe: javascript:alert("This is a preview page, what did you expect to happen?");
diff --git a/tests/fixtures/emails/note.txt b/tests/fixtures/emails/note.txt
index 69e7c621b1..a6646f374a 100644
--- a/tests/fixtures/emails/note.txt
+++ b/tests/fixtures/emails/note.txt
@@ -9,6 +9,6 @@ metus volutpat
 
 ornare elit pulvinar nisl integer cum ad massa
 
-http://testserver/organizations/organization/issues/1/activity/?project=1&amp;referrer=NoteActivityEmail
+http://testserver/organizations/organization/issues/1/activity/?referrer=NoteActivityEmail
 
 Unsubscribe: javascript:alert("This is a preview page, what did you expect to happen?");
diff --git a/tests/fixtures/emails/regression.txt b/tests/fixtures/emails/regression.txt
index c0359c333b..69704fc090 100644
--- a/tests/fixtures/emails/regression.txt
+++ b/tests/fixtures/emails/regression.txt
@@ -7,7 +7,7 @@ Sentry marked an issue as a regression
 
 ornare elit pulvinar nisl integer cum ad massa
 
-http://testserver/organizations/organization/issues/1/?project=1&amp;referrer=RegressionActivityEmail
+http://testserver/organizations/organization/issues/1/?referrer=RegressionActivityEmail
 
 
 Unsubscribe: javascript:alert("This is a preview page, what did you expect to happen?");
diff --git a/tests/fixtures/emails/regression_with_version.txt b/tests/fixtures/emails/regression_with_version.txt
index ea5733ab2d..fda9a8d078 100644
--- a/tests/fixtures/emails/regression_with_version.txt
+++ b/tests/fixtures/emails/regression_with_version.txt
@@ -7,7 +7,7 @@ Sentry marked an issue as a regression in abcdef
 
 ornare elit pulvinar nisl integer cum ad massa
 
-http://testserver/organizations/organization/issues/1/?project=1&amp;referrer=RegressionActivityEmail
+http://testserver/organizations/organization/issues/1/?referrer=RegressionActivityEmail
 
 
 Unsubscribe: javascript:alert("This is a preview page, what did you expect to happen?");
diff --git a/tests/fixtures/emails/resolved.txt b/tests/fixtures/emails/resolved.txt
index 29b95a0eae..6377f00f6c 100644
--- a/tests/fixtures/emails/resolved.txt
+++ b/tests/fixtures/emails/resolved.txt
@@ -7,7 +7,7 @@ Sentry marked an issue as resolved
 
 ornare elit pulvinar nisl integer cum ad massa
 
-http://testserver/organizations/organization/issues/1/?project=1&amp;referrer=ResolvedActivityEmail
+http://testserver/organizations/organization/issues/1/?referrer=ResolvedActivityEmail
 
 
 Unsubscribe: javascript:alert("This is a preview page, what did you expect to happen?");
diff --git a/tests/fixtures/emails/resolved_in_release.txt b/tests/fixtures/emails/resolved_in_release.txt
index 88524d86c4..a8acdbac96 100644
--- a/tests/fixtures/emails/resolved_in_release.txt
+++ b/tests/fixtures/emails/resolved_in_release.txt
@@ -7,7 +7,7 @@ Sentry marked an issue as resolved in abcdef
 
 ornare elit pulvinar nisl integer cum ad massa
 
-http://testserver/organizations/organization/issues/1/?project=1&amp;referrer=ResolvedInReleaseActivityEmail
+http://testserver/organizations/organization/issues/1/?referrer=ResolvedInReleaseActivityEmail
 
 
 Unsubscribe: javascript:alert("This is a preview page, what did you expect to happen?");
diff --git a/tests/fixtures/emails/resolved_in_release_upcoming.txt b/tests/fixtures/emails/resolved_in_release_upcoming.txt
index d4edf50daf..7496a2f265 100644
--- a/tests/fixtures/emails/resolved_in_release_upcoming.txt
+++ b/tests/fixtures/emails/resolved_in_release_upcoming.txt
@@ -7,7 +7,7 @@ Sentry marked an issue as resolved in an upcoming release
 
 ornare elit pulvinar nisl integer cum ad massa
 
-http://testserver/organizations/organization/issues/1/?project=1&amp;referrer=ResolvedInReleaseActivityEmail
+http://testserver/organizations/organization/issues/1/?referrer=ResolvedInReleaseActivityEmail
 
 
 Unsubscribe: javascript:alert("This is a preview page, what did you expect to happen?");
diff --git a/tests/fixtures/emails/unassigned.txt b/tests/fixtures/emails/unassigned.txt
index 31a7105ef6..37315d5f31 100644
--- a/tests/fixtures/emails/unassigned.txt
+++ b/tests/fixtures/emails/unassigned.txt
@@ -7,7 +7,7 @@ foo@example.com unassigned an issue
 
 ornare elit pulvinar nisl integer cum ad massa
 
-http://testserver/organizations/organization/issues/1/?project=1&amp;referrer=UnassignedActivityEmail
+http://testserver/organizations/organization/issues/1/?referrer=UnassignedActivityEmail
 
 
 Unsubscribe: javascript:alert("This is a preview page, what did you expect to happen?");
diff --git a/tests/sentry/models/test_group.py b/tests/sentry/models/test_group.py
index 10eff9a170..15ab701152 100644
--- a/tests/sentry/models/test_group.py
+++ b/tests/sentry/models/test_group.py
@@ -232,10 +232,10 @@ class GroupTest(TestCase):
         assert group.get_email_subject() == '%s - %s' % (group.qualified_short_id, group.title)
 
     def test_get_absolute_url(self):
-        project = self.create_project(name='pumped-quagga')
-        group = self.create_group(project=project)
+        with self.feature('organizations:sentry10'):
+            project = self.create_project(name='pumped-quagga')
+            group = self.create_group(project=project)
 
-        result = group.get_absolute_url({'environment': u'd\u00E9v'})
-        assert result == u'http://testserver/baz/{}/issues/{}/?environment=d%C3%A9v'.format(
-            project.slug,
-            group.id)
+            result = group.get_absolute_url({'environment': u'd\u00E9v'})
+            assert result == u'http://testserver/organizations/baz/issues/{}/?environment=d%C3%A9v'.format(
+                group.id)
