commit 4c61ae677a8b2ab100c0b9972d5a3968efef1154
Author: Chris Jennings <chriskjennings@gmail.com>
Date:   Thu Jun 20 15:23:28 2019 -0700

    ref(ui): incidents design pass (#13728)
    
    * incident index updates
    
    * Have index metrics match detail metrics
    
    * Fix stylelint test
    
    * Update src/sentry/static/sentry/app/views/organizationIncidents/details/header.jsx
    
    Co-Authored-By: Billy Vong <billyvg@users.noreply.github.com>
    
    * Address feedback

diff --git a/src/sentry/static/sentry/app/components/dropdownControl.jsx b/src/sentry/static/sentry/app/components/dropdownControl.jsx
index aff8743e12..b581c16eab 100644
--- a/src/sentry/static/sentry/app/components/dropdownControl.jsx
+++ b/src/sentry/static/sentry/app/components/dropdownControl.jsx
@@ -104,7 +104,6 @@ const StyledDropdownButton = styled(
 )`
   z-index: ${p => p.theme.zIndex.dropdownAutocomplete.actor};
   white-space: nowrap;
-  font-weight: normal;
 `;
 
 const MenuContainer = styled(DropdownBubble.withComponent('ul'))`
diff --git a/src/sentry/static/sentry/app/components/seenByList.jsx b/src/sentry/static/sentry/app/components/seenByList.jsx
index 223fe60911..9aeb2711e9 100644
--- a/src/sentry/static/sentry/app/components/seenByList.jsx
+++ b/src/sentry/static/sentry/app/components/seenByList.jsx
@@ -72,7 +72,7 @@ export default class SeenByList extends React.Component {
         />
         <IconWrapper>
           <Tooltip title={iconTooltip}>
-            <EyeIcon className="icon-eye" />
+            <EyeIcon className="icon-eye" iconPosition={iconPosition} />
           </Tooltip>
         </IconWrapper>
       </SeenByWrapper>
@@ -94,7 +94,7 @@ const IconWrapper = styled('div')`
   width: 28px;
   line-height: 26px;
   text-align: center;
-  margin-right: 10px;
+  ${p => (p.iconPosition === 'left' ? 'margin-right: 10px' : '')};
 `;
 
 const EyeIcon = styled('span')`
diff --git a/src/sentry/static/sentry/app/views/organizationIncidents/details/body.jsx b/src/sentry/static/sentry/app/views/organizationIncidents/details/body.jsx
index e0f749665e..7880e9f811 100644
--- a/src/sentry/static/sentry/app/views/organizationIncidents/details/body.jsx
+++ b/src/sentry/static/sentry/app/views/organizationIncidents/details/body.jsx
@@ -29,7 +29,6 @@ export default class DetailsBody extends React.Component {
 
     // Considered loading when there is no incident object
     const loading = !incident;
-
     return (
       <StyledPageContent>
         <Main>
@@ -108,6 +107,12 @@ const Sidebar = styled('div')`
   width: 40%;
   border-left: 1px solid ${p => p.theme.borderLight};
   background-color: ${p => p.theme.white};
+
+  /* stylelint-disable-next-line no-duplicate-selectors */
+  ${PageContent} {
+    padding-top: ${space(3)};
+  }
+
   @media (max-width: ${theme.breakpoints[0]}) {
     width: 100%;
     border: 0;
@@ -125,9 +130,11 @@ const StyledPageContent = styled(PageContent)`
 const StyledNavTabs = styled(NavTabs)`
   display: flex;
 `;
+
 const SeenByTab = styled('li')`
   flex: 1;
   margin-left: ${space(2)};
+  margin-right: 0;
 
   .nav-tabs > & {
     margin-right: 0;
diff --git a/src/sentry/static/sentry/app/views/organizationIncidents/details/header.jsx b/src/sentry/static/sentry/app/views/organizationIncidents/details/header.jsx
index d009f8ce55..9e1d109431 100644
--- a/src/sentry/static/sentry/app/views/organizationIncidents/details/header.jsx
+++ b/src/sentry/static/sentry/app/views/organizationIncidents/details/header.jsx
@@ -9,6 +9,7 @@ import {t} from 'app/locale';
 import Access from 'app/components/acl/access';
 import Count from 'app/components/count';
 import DropdownControl from 'app/components/dropdownControl';
+import Duration from 'app/components/duration';
 import InlineSvg from 'app/components/inlineSvg';
 import LoadingError from 'app/components/loadingError';
 import MenuItem from 'app/components/menuItem';
@@ -16,6 +17,7 @@ import PageHeading from 'app/components/pageHeading';
 import SentryTypes from 'app/sentryTypes';
 import SubscribeButton from 'app/components/subscribeButton';
 import space from 'app/styles/space';
+import getDynamicText from 'app/utils/getDynamicText';
 
 import {isOpen} from '../utils';
 import Status from '../status';
@@ -44,7 +46,7 @@ export default class DetailsHeader extends React.Component {
           label={incident && <Status incident={incident} />}
           menuWidth="160px"
           alignRight
-          buttonProps={!incident ? {disabled: true} : null}
+          buttonProps={{size: 'small', disabled: !incident}}
         >
           <StyledMenuItem onSelect={onStatusChange}>
             {isIncidentOpen ? t('Close this incident') : t('Reopen this incident')}
@@ -67,6 +69,13 @@ export default class DetailsHeader extends React.Component {
       },
     };
     const dateStarted = incident && moment(incident.dateStarted).format('LL');
+    const duration =
+      incident &&
+      moment
+        .duration(
+          moment(incident.dateClosed || new Date()).diff(moment(incident.dateStarted))
+        )
+        .as('seconds');
 
     return (
       <Header>
@@ -97,13 +106,10 @@ export default class DetailsHeader extends React.Component {
               <ItemValue>{this.renderStatus()}</ItemValue>
             </HeaderItem>
             <HeaderItem>
-              <ItemTitle>{t('Event count')}</ItemTitle>
+              <ItemTitle>{t('Duration')}</ItemTitle>
               {isIncidentReady && (
                 <ItemValue>
-                  <Count value={incident.totalEvents} />
-                  <OpenLink to={eventLink}>
-                    <InlineSvg src="icon-open" />
-                  </OpenLink>
+                  <Duration seconds={getDynamicText({value: duration, fixed: 1200})} />
                 </ItemValue>
               )}
             </HeaderItem>
@@ -115,6 +121,17 @@ export default class DetailsHeader extends React.Component {
                 </ItemValue>
               )}
             </HeaderItem>
+            <HeaderItem>
+              <ItemTitle>{t('Total events')}</ItemTitle>
+              {isIncidentReady && (
+                <ItemValue>
+                  <Count value={incident.totalEvents} />
+                  <OpenLink to={eventLink}>
+                    <InlineSvg src="icon-open" size="14" />
+                  </OpenLink>
+                </ItemValue>
+              )}
+            </HeaderItem>
             <HeaderItem>
               <ItemTitle>{t('Notifications')}</ItemTitle>
               <ItemValue>
@@ -122,6 +139,7 @@ export default class DetailsHeader extends React.Component {
                   disabled={!isIncidentReady}
                   isSubscribed={incident && !!incident.isSubscribed}
                   onClick={onSubscriptionChange}
+                  size="small"
                 />
               </ItemValue>
             </HeaderItem>
@@ -153,7 +171,8 @@ const GroupedHeaderItems = styled('div')`
 `;
 
 const HeaderItem = styled('div')`
-  padding: 0 ${space(3)};
+  padding: 0 ${space(4)};
+  min-width: 0; /* Prevent text from horizontally stretching flexbox */
 `;
 
 const ItemTitle = styled('h6')`
@@ -168,13 +187,14 @@ const ItemValue = styled('div')`
   display: flex;
   justify-content: flex-end;
   align-items: center;
-  font-size: ${p => p.theme.headerFontSize};
+  font-size: ${p => p.theme.fontSizeExtraLarge};
   height: 40px; /* This is the height of the Status dropdown */
 `;
 
 const Breadcrumb = styled('div')`
   display: flex;
   align-items: center;
+  font-size: ${p => p.theme.fontSizeLarge};
   margin-bottom: ${space(1)};
 `;
 
diff --git a/src/sentry/static/sentry/app/views/organizationIncidents/list/index.jsx b/src/sentry/static/sentry/app/views/organizationIncidents/list/index.jsx
index 6d3420ab46..062e581879 100644
--- a/src/sentry/static/sentry/app/views/organizationIncidents/list/index.jsx
+++ b/src/sentry/static/sentry/app/views/organizationIncidents/list/index.jsx
@@ -61,13 +61,12 @@ class OrganizationIncidentsList extends AsyncComponent {
             {started.format('LL')}
             <LightDuration seconds={getDynamicText({value: duration, fixed: 1200})} />
           </div>
-
-          <div>
+          <NumericColumn>
             <Count value={incident.uniqueUsers} />
-          </div>
-          <div>
+          </NumericColumn>
+          <NumericColumn>
             <Count value={incident.totalEvents} />
-          </div>
+          </NumericColumn>
         </TableLayout>
       </IncidentPanelItem>
     );
@@ -76,7 +75,7 @@ class OrganizationIncidentsList extends AsyncComponent {
   renderEmpty() {
     return (
       <EmptyStateWarning>
-        <p>{t("You don't have any incidents yet")}</p>
+        <p>{t("You don't have any Incidents yet")}</p>
       </EmptyStateWarning>
     );
   }
@@ -96,8 +95,8 @@ class OrganizationIncidentsList extends AsyncComponent {
               <div>{t('Incident')}</div>
               <div>{t('Status')}</div>
               <div>{t('Started')}</div>
-              <div>{t('Users affected')}</div>
-              <div>{t('Total events')}</div>
+              <NumericColumn>{t('Users affected')}</NumericColumn>
+              <NumericColumn>{t('Total events')}</NumericColumn>
             </TableLayout>
           </PanelHeader>
 
@@ -133,7 +132,7 @@ class OrganizationIncidentsListContainer extends React.Component {
       <DocumentTitle title={`Incidents - ${orgId} - Sentry`}>
         <PageContent>
           <PageHeader>
-            <PageHeading withMargins>
+            <PageHeading>
               {t('Incidents')} <BetaTag />
             </PageHeading>
 
@@ -168,7 +167,7 @@ class OrganizationIncidentsListContainer extends React.Component {
             icon="icon-circle-info"
           >
             {tct(
-              'To create a new incident, select one or more issues from the Issues view. Then, click the [create:Create Incident] button.',
+              'To create a new Incident, select one or more issues from the Issues view. Then, click the [create:Create Incident] button.',
               {create: <em />}
             )}
           </AlertLink>
@@ -198,10 +197,15 @@ const TitleAndSparkLine = styled('div')`
   display: flex;
   justify-content: space-between;
   align-items: center;
+  padding-right: ${space(2)};
 `;
 
 const IncidentPanelItem = styled(PanelItem)`
   padding: ${space(1)} ${space(2)};
 `;
 
+const NumericColumn = styled('div')`
+  text-align: right;
+`;
+
 export default OrganizationIncidentsListContainer;
diff --git a/tests/js/spec/views/organizationIncidents/details/index.spec.jsx b/tests/js/spec/views/organizationIncidents/details/index.spec.jsx
index f2affdcd65..b13f0dfdae 100644
--- a/tests/js/spec/views/organizationIncidents/details/index.spec.jsx
+++ b/tests/js/spec/views/organizationIncidents/details/index.spec.jsx
@@ -64,7 +64,7 @@ describe('IncidentDetails', function() {
     expect(
       wrapper
         .find('ItemValue')
-        .at(1)
+        .at(3)
         .text()
     ).toBe('100');
     expect(
diff --git a/tests/js/spec/views/organizationIncidents/list/index.spec.jsx b/tests/js/spec/views/organizationIncidents/list/index.spec.jsx
index f35d275056..9a6156d9ce 100644
--- a/tests/js/spec/views/organizationIncidents/list/index.spec.jsx
+++ b/tests/js/spec/views/organizationIncidents/list/index.spec.jsx
@@ -45,8 +45,8 @@ describe('OrganizationIncidentsList', function() {
       <OrganizationIncidentsList params={{orgId: 'org-slug'}} location={{query: {}}} />,
       routerContext
     );
-    expect(wrapper.find('IncidentPanelItem')).toHaveLength(0);
-    expect(wrapper.text()).toContain("You don't have any incidents yet");
+    expect(wrapper.find('PanelItem')).toHaveLength(0);
+    expect(wrapper.text()).toContain("You don't have any Incidents yet");
   });
 
   it('toggles all/open', function() {
