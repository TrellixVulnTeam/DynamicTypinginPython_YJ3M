commit 03f01adeb49b50d380455541454073a90080a9fc
Author: Billy Vong <billyvg@gmail.com>
Date:   Wed Jun 28 16:02:58 2017 -0700

    Add to project selector empty state options to join/create team

diff --git a/src/sentry/static/sentry/app/components/projectHeader/projectSelector.jsx b/src/sentry/static/sentry/app/components/projectHeader/projectSelector.jsx
index ea3c0e2913..0dcc6b723d 100644
--- a/src/sentry/static/sentry/app/components/projectHeader/projectSelector.jsx
+++ b/src/sentry/static/sentry/app/components/projectHeader/projectSelector.jsx
@@ -80,6 +80,11 @@ const ProjectSelector = React.createClass({
     }, 200);
   },
 
+  urlPrefix() {
+    let org = this.props.organization;
+    return `/organizations/${org.slug}`;
+  },
+
   close() {
     this.setState({
       filter: '',
@@ -271,6 +276,10 @@ const ProjectSelector = React.createClass({
   renderProjectList({organization: org, projects, filter, hasProjectWrite}) {
     const hasFilter = !!filter;
     const hasProjects = projects && projects.length;
+    const teams = org && org.teams;
+    const hasTeams = teams.length > 0;
+    // Will always need to show divider
+    const showDivider = !hasFilter;
 
     if (hasProjects) {
       return projects;
@@ -286,15 +295,33 @@ const ProjectSelector = React.createClass({
             {!hasFilter && t('You have no projects.')}
           </div>
         </MenuItem>,
-        !hasFilter && hasProjectWrite ? <MenuItem key="divider" divider /> : null,
+        showDivider ? <MenuItem key="divider" divider /> : null,
         !hasFilter && hasProjectWrite
           ? <MenuItem key="create-project" className="empty-projects-item" noAnchor>
               <a
                 className="btn btn-primary btn-block"
-                href={`/organizations/${org.slug}/projects/new/`}>
+                href={`${this.urlPrefix()}/projects/new/`}>
                 {t('Create project')}
               </a>
             </MenuItem>
+          : null,
+        !hasFilter && hasTeams
+          ? <MenuItem key="join-team" className="empty-projects-item" noAnchor>
+              <Link
+                className="btn btn-primary btn-block"
+                to={`${this.urlPrefix()}/all-teams/`}>
+                {t('Join team')}
+              </Link>
+            </MenuItem>
+          : null,
+        !hasFilter && (!hasTeams || hasProjectWrite)
+          ? <MenuItem key="create-team" className="empty-projects-item" noAnchor>
+              <Link
+                className="btn btn-primary btn-block"
+                to={`${this.urlPrefix()}/teams/new/`}>
+                {t('Create team')}
+              </Link>{' '}
+            </MenuItem>
           : null
       ];
     }
@@ -357,7 +384,6 @@ const ProjectSelector = React.createClass({
             {this.renderProjectList({
               organization: org,
               hasProjectWrite: access.has('project:write'),
-              hasTeamWrite: access.has('team:write'),
               projects: children,
               filter: this.state.filter
             })}
diff --git a/src/sentry/static/sentry/less/shared-components.less b/src/sentry/static/sentry/less/shared-components.less
index d94d487c1c..ebfc4b0e8a 100644
--- a/src/sentry/static/sentry/less/shared-components.less
+++ b/src/sentry/static/sentry/less/shared-components.less
@@ -1371,7 +1371,11 @@ table.integrations {
   &.is-empty {
     .dropdown-menu {
       li.empty-projects-item {
-        padding: 0 5px;
+        padding: 0 5px 5px;
+
+        &:last-child {
+          padding-bottom: 0;
+        }
 
         // need to override bootstrap for <a> in dropdown-menu
         a {
diff --git a/tests/js/spec/components/projectHeader/__snapshots__/projectSelector.spec.jsx.snap b/tests/js/spec/components/projectHeader/__snapshots__/projectSelector.spec.jsx.snap
index 4be1ce2e04..c54b50cbd1 100644
--- a/tests/js/spec/components/projectHeader/__snapshots__/projectSelector.spec.jsx.snap
+++ b/tests/js/spec/components/projectHeader/__snapshots__/projectSelector.spec.jsx.snap
@@ -255,14 +255,72 @@ exports[`ProjectSelector render() can filter projects by team name/project name
 </ProjectSelector>
 `;
 
-exports[`ProjectSelector render() has no filter and empty message with no projects and has no project:write access 1`] = `
+exports[`ProjectSelector render() lists projects and has filter 1`] = `
+<div
+  className="project-select"
+>
+  <h3>
+    <Link
+      className="home-crumb"
+      to="/org/"
+    >
+      <span
+        className="icon-home"
+      />
+    </Link>
+    Select a project
+    <DropdownLink
+      caret={true}
+      disabled={false}
+      onClose={[Function]}
+      onOpen={[Function]}
+      title=""
+      topLevelClasses="project-dropdown"
+    >
+      <li
+        className="project-filter"
+      >
+        <input
+          onBlur={[Function]}
+          onChange={[Function]}
+          onKeyDown={[Function]}
+          onKeyUp={[Function]}
+          placeholder="Filter projects"
+          type="text"
+          value=""
+        />
+      </li>
+      <MenuItem
+        className=""
+        href="/org/another-project/"
+        linkClassName=""
+      >
+        <span>
+          Another Project
+        </span>
+      </MenuItem>
+      <MenuItem
+        className=""
+        href="/org/test-project/"
+        linkClassName=""
+      >
+        <span>
+          Test Project
+        </span>
+      </MenuItem>
+    </DropdownLink>
+  </h3>
+</div>
+`;
+
+exports[`ProjectSelector render() should show empty message with no projects message and create team buttons, when no teams, no projects, and has no project:write access 1`] = `
 <div
   className="project-select"
 >
   <h3>
     <Link
       className="home-crumb"
-      to="/undefined/"
+      to="/org-slug/"
     >
       <span
         className="icon-home"
@@ -287,19 +345,34 @@ exports[`ProjectSelector render() has no filter and empty message with no projec
           You have no projects.
         </div>
       </MenuItem>
+      <MenuItem
+        divider={true}
+      />
+      <MenuItem
+        className="empty-projects-item"
+        noAnchor={true}
+      >
+        <Link
+          className="btn btn-primary btn-block"
+          to="/organizations/org-slug/teams/new/"
+        >
+          Create team
+        </Link>
+         
+      </MenuItem>
     </DropdownLink>
   </h3>
 </div>
 `;
 
-exports[`ProjectSelector render() has no filter and empty message with no projects and has project:write access 1`] = `
+exports[`ProjectSelector render() should show empty message with no projects, create project, and create team buttons, when no teams, no projects, and has project:write access 1`] = `
 <div
   className="project-select"
 >
   <h3>
     <Link
       className="home-crumb"
-      to="/undefined/"
+      to="/org-slug/"
     >
       <span
         className="icon-home"
@@ -333,24 +406,36 @@ exports[`ProjectSelector render() has no filter and empty message with no projec
       >
         <a
           className="btn btn-primary btn-block"
-          href="/organizations/undefined/projects/new/"
+          href="/organizations/org-slug/projects/new/"
         >
           Create project
         </a>
       </MenuItem>
+      <MenuItem
+        className="empty-projects-item"
+        noAnchor={true}
+      >
+        <Link
+          className="btn btn-primary btn-block"
+          to="/organizations/org-slug/teams/new/"
+        >
+          Create team
+        </Link>
+         
+      </MenuItem>
     </DropdownLink>
   </h3>
 </div>
 `;
 
-exports[`ProjectSelector render() lists projects and has filter 1`] = `
+exports[`ProjectSelector render() should show empty message with no projects, create project, and create team buttons, when no teams, no projects, and has project:write access 2`] = `
 <div
   className="project-select"
 >
   <h3>
     <Link
       className="home-crumb"
-      to="/org/"
+      to="/org-slug/"
     >
       <span
         className="icon-home"
@@ -363,38 +448,94 @@ exports[`ProjectSelector render() lists projects and has filter 1`] = `
       onClose={[Function]}
       onOpen={[Function]}
       title=""
-      topLevelClasses="project-dropdown"
+      topLevelClasses="project-dropdown is-empty"
     >
-      <li
-        className="project-filter"
+      <MenuItem
+        className="empty-projects-item"
+        noAnchor={true}
       >
-        <input
-          onBlur={[Function]}
-          onChange={[Function]}
-          onKeyDown={[Function]}
-          onKeyUp={[Function]}
-          placeholder="Filter projects"
-          type="text"
-          value=""
-        />
-      </li>
+        <div
+          className="empty-message"
+        >
+          You have no projects.
+        </div>
+      </MenuItem>
       <MenuItem
-        className=""
-        href="/org/another-project/"
-        linkClassName=""
+        divider={true}
+      />
+      <MenuItem
+        className="empty-projects-item"
+        noAnchor={true}
       >
-        <span>
-          Another Project
-        </span>
+        <a
+          className="btn btn-primary btn-block"
+          href="/organizations/org-slug/projects/new/"
+        >
+          Create project
+        </a>
       </MenuItem>
       <MenuItem
-        className=""
-        href="/org/test-project/"
-        linkClassName=""
+        className="empty-projects-item"
+        noAnchor={true}
       >
-        <span>
-          Test Project
-        </span>
+        <Link
+          className="btn btn-primary btn-block"
+          to="/organizations/org-slug/teams/new/"
+        >
+          Create team
+        </Link>
+         
+      </MenuItem>
+    </DropdownLink>
+  </h3>
+</div>
+`;
+
+exports[`ProjectSelector render() shows "Join team" only when a team exists 1`] = `
+<div
+  className="project-select"
+>
+  <h3>
+    <Link
+      className="home-crumb"
+      to="/org-slug/"
+    >
+      <span
+        className="icon-home"
+      />
+    </Link>
+    Select a project
+    <DropdownLink
+      caret={true}
+      disabled={false}
+      onClose={[Function]}
+      onOpen={[Function]}
+      title=""
+      topLevelClasses="project-dropdown is-empty"
+    >
+      <MenuItem
+        className="empty-projects-item"
+        noAnchor={true}
+      >
+        <div
+          className="empty-message"
+        >
+          You have no projects.
+        </div>
+      </MenuItem>
+      <MenuItem
+        divider={true}
+      />
+      <MenuItem
+        className="empty-projects-item"
+        noAnchor={true}
+      >
+        <Link
+          className="btn btn-primary btn-block"
+          to="/organizations/org-slug/all-teams/"
+        >
+          Join team
+        </Link>
       </MenuItem>
     </DropdownLink>
   </h3>
diff --git a/tests/js/spec/components/projectHeader/projectSelector.spec.jsx b/tests/js/spec/components/projectHeader/projectSelector.spec.jsx
index c8b51e469f..80bb5dd777 100644
--- a/tests/js/spec/components/projectHeader/projectSelector.spec.jsx
+++ b/tests/js/spec/components/projectHeader/projectSelector.spec.jsx
@@ -28,11 +28,12 @@ describe('ProjectSelector', function() {
     access: []
   };
   describe('render()', function() {
-    it('has no filter and empty message with no projects and has no project:write access', function() {
+    it('should show empty message with no projects message and create team buttons, when no teams, no projects, and has no project:write access', function() {
       let wrapper = shallow(
         <ProjectSelector
           organization={{
             id: 'org',
+            slug: 'org-slug',
             teams: [],
             access: []
           }}
@@ -45,11 +46,47 @@ describe('ProjectSelector', function() {
       expect(toJson(wrapper)).toMatchSnapshot();
     });
 
-    it('has no filter and empty message with no projects and has project:write access', function() {
+    it('should show empty message with no projects, create project, and create team buttons, when no teams, no projects, and has project:write access', function() {
       let wrapper = shallow(
         <ProjectSelector
           organization={{
             id: 'org',
+            slug: 'org-slug',
+            teams: [],
+            access: ['project:write']
+          }}
+          projectId=""
+        />,
+        {
+          context: {router: TestStubs.router()}
+        }
+      );
+      expect(toJson(wrapper)).toMatchSnapshot();
+    });
+
+    it('shows "Join team" only when a team exists', function() {
+      let wrapper = shallow(
+        <ProjectSelector
+          organization={{
+            id: 'org',
+            slug: 'org-slug',
+            teams: [{}]
+          }}
+          projectId=""
+        />,
+        {
+          context: {router: TestStubs.router()}
+        }
+      );
+      expect(toJson(wrapper)).toMatchSnapshot();
+    });
+
+    it('should show empty message with no projects, create project, and create team buttons, when no teams, no projects, and has project:write access', function() {
+      let wrapper = shallow(
+        <ProjectSelector
+          organization={{
+            id: 'org',
+            slug: 'org-slug',
             teams: [],
             access: ['project:write']
           }}
