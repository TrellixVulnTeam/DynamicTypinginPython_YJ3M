commit e5ea78751b8606ffed6d242a328d46d22a0086f0
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Feb 9 13:33:45 2013 -0800

    Tests for search projects

diff --git a/tests/sentry/web/api/tests.py b/tests/sentry/web/api/tests.py
index 0fb329e6f8..71404c749e 100644
--- a/tests/sentry/web/api/tests.py
+++ b/tests/sentry/web/api/tests.py
@@ -5,7 +5,7 @@ from __future__ import absolute_import
 import mock
 from django.contrib.auth.models import User
 from django.core.urlresolvers import reverse
-from sentry.models import Project, TeamMember, AccessGroup
+from sentry.models import Team, Project, TeamMember, AccessGroup
 from sentry.testutils import TestCase, fixture, before
 from sentry.utils import json
 
@@ -184,3 +184,39 @@ class SearchUsersTest(TestCase):
         assert json.loads(resp.content) == {
             'results': []
         }
+
+
+class SearchProjectsTest(TestCase):
+    @fixture
+    def path(self):
+        return reverse('sentry-api-search-projects', args=[self.team.slug])
+
+    @before
+    def login_user(self):
+        self.login()
+
+    def test_finds_projects_from_team(self):
+        project = Project.objects.create(team=self.team, name='Sample')
+        resp = self.client.get(self.path, {'query': 'sample'})
+
+        assert resp.status_code == 200
+        assert resp['Content-Type'] == 'application/json'
+        assert json.loads(resp.content) == {
+            'results': [{
+                'id': project.id,
+                'slug': project.slug,
+                'name': project.name,
+            }]
+        }
+
+    def test_does_not_include_projects_from_other_teams(self):
+        team = Team.objects.create(owner=self.user, name='Sample')
+        Project.objects.create(team=team, name='Sample')
+
+        resp = self.client.get(self.path, {'query': 'sample'})
+
+        assert resp.status_code == 200
+        assert resp['Content-Type'] == 'application/json'
+        assert json.loads(resp.content) == {
+            'results': []
+        }
