commit 592b963dfc1909a0bba8c3feaa7811ab6be6a22f
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Sep 6 12:53:53 2010 -0700

    Added status filter

diff --git a/example_project/settings.py b/example_project/settings.py
index 4a1d48da9d..be60ac01f6 100644
--- a/example_project/settings.py
+++ b/example_project/settings.py
@@ -111,6 +111,7 @@ logging.basicConfig(level=logging.DEBUG)
 SENTRY_THRASHING_TIMEOUT = 0
 
 SENTRY_FILTERS = (
+    'sentry.filters.StatusFilter',
     'sentry.filters.LoggerFilter',
     'sentry.filters.LevelFilter',
     'sentry.filters.ServerNameFilter',
diff --git a/sentry/filters/__init__.py b/sentry/filters/__init__.py
index b3136d1d65..15eec2cbd5 100644
--- a/sentry/filters/__init__.py
+++ b/sentry/filters/__init__.py
@@ -91,6 +91,16 @@ class SentryFilter(object):
         widget = self.get_widget()
         return widget.render(self.get_value())
 
+class StatusFilter(SentryFilter):
+    label = 'status'
+    column = 'status'
+
+    def get_choices(self):
+        return SortedDict([
+            (0, 'Unresolved'),
+            (1, 'Resolved'),
+        ])
+
 class LoggerFilter(SentryFilter):
     label = 'Logger'
     column = 'logger'
diff --git a/sentry/settings.py b/sentry/settings.py
index a4e94fb8a3..1131ee2a1f 100644
--- a/sentry/settings.py
+++ b/sentry/settings.py
@@ -14,6 +14,7 @@ THRASHING_TIMEOUT = getattr(settings, 'SENTRY_THRASHING_TIMEOUT', 60)
 THRASHING_LIMIT = getattr(settings, 'SENTRY_THRASHING_LIMIT', 10)
 
 FILTERS = getattr(settings, 'SENTRY_FILTERS', (
+    'sentry.filters.StatusFilter',
     'sentry.filters.LoggerFilter',
     'sentry.filters.LevelFilter',
     'sentry.filters.ServerNameFilter',
diff --git a/sentry/templates/sentry/index.html b/sentry/templates/sentry/index.html
index 41c5be5725..7ca9deffa9 100644
--- a/sentry/templates/sentry/index.html
+++ b/sentry/templates/sentry/index.html
@@ -31,7 +31,7 @@
 						<h2>Last 24 Hours</h2>
 						<img src="{{ chart_url }}" class="chart" alt="chart"/>
 					{% endif %}
-
+					
 					{% for filter in filters %}
 						<h2>{{ filter.label }}</h2>
 						<form method="get" action="{{ filter.get_query_string|safe }}">
diff --git a/sentry/views.py b/sentry/views.py
index cefc602273..f1836bbf5e 100644
--- a/sentry/views.py
+++ b/sentry/views.py
@@ -99,9 +99,7 @@ def index(request):
         page = 1
 
     # this only works in postgres
-    message_list = GroupedMessage.objects.filter(
-        status=0,
-    ).extra(
+    message_list = GroupedMessage.objects.extra(
         select={
             'score': GroupedMessage.get_score_clause(),
         }
@@ -127,39 +125,11 @@ def index(request):
 def ajax_handler(request):
     op = request.REQUEST.get('op')
     if op == 'poll':
-        logger_names = SortedDict((l, l) for l in GroupedMessage.objects.values_list('logger', flat=True).distinct())
-        server_names = SortedDict((l, l) for l in Message.objects.values_list('server_name', flat=True).distinct())
-        level_names = SortedDict((str(k), v) for k, v in settings.LOG_LEVELS)
-
-        logger = request.GET.get('logger')
-        server_name = request.GET.get('server_name') or ''
-        level = request.GET.get('level') or ''
-
-        if logger not in logger_names:
-            logger = ''
-
-        if server_name not in server_names:
-            server_name = ''
-
-        if level not in level_names:
-            level = ''
-        
-        message_list = GroupedMessage.objects.filter(
-            status=0,
-        ).extra(
+        message_list = GroupedMessage.objects.extra(
             select={
                 'score': GroupedMessage.get_score_clause(),
             }
         ).order_by('-score', '-last_seen')
-
-        if logger:
-            message_list = message_list.filter(logger=logger)
-
-        if level:
-            message_list = message_list.filter(level=level)
-
-        if server_name:
-            message_list = message_list.filter(message_set__server_name=server_name).distinct()
         
         data = [
             (m.pk, {
