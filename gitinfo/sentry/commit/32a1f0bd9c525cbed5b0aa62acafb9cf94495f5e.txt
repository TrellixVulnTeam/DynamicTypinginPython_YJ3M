commit 32a1f0bd9c525cbed5b0aa62acafb9cf94495f5e
Author: Mark Story <mark@sentry.io>
Date:   Mon Aug 12 14:08:36 2019 -0400

    fix(tests) Make transaction sample events dynamic (#14350)
    
    Update the transaction sample event so that it stays fresh and the
    timestamp data matches up.

diff --git a/src/sentry/data/samples/transaction.json b/src/sentry/data/samples/transaction.json
index 1cb8f8f236..bddc3febbd 100644
--- a/src/sentry/data/samples/transaction.json
+++ b/src/sentry/data/samples/transaction.json
@@ -136,13 +136,11 @@
    },
    "spans": [
       {
-         "start_timestamp": 1562681591.0,
          "same_process_as_parent":true,
          "description": "Django: SELECT \"countries\".\"id\", \"countries\".\"name\", \"countries\".\"continent\", \"countries\".\"region\", \"countries\".\"surface_area\", \"coun...'CAN'",
          "tags": {
             "error":false
          },
-         "timestamp":1562681591.0,
          "parent_span_id": "babaae0d4b7512d9",
          "trace_id": "a7d67cf796774551a95be6543cacd459",
          "op": "db",
@@ -150,7 +148,6 @@
          "span_id": "b048b4c8fdc5168c"
       }
    ],
-   "start_timestamp": 1562681591.0,
    "transaction": "/country_by_code/",
    "type": "transaction",
    "user": {
diff --git a/src/sentry/utils/samples.py b/src/sentry/utils/samples.py
index 9c2fae808a..74531b980c 100644
--- a/src/sentry/utils/samples.py
+++ b/src/sentry/utils/samples.py
@@ -3,6 +3,7 @@ from __future__ import absolute_import
 import os.path
 import random
 from datetime import datetime, timedelta
+from django.utils import timezone
 
 import six
 
@@ -10,6 +11,7 @@ from sentry.constants import DATA_ROOT, INTEGRATION_ID_TO_PLATFORM_DATA
 from sentry.event_manager import EventManager
 from sentry.interfaces.user import User as UserInterface
 from sentry.utils import json
+from sentry.utils.dates import to_timestamp
 from sentry.utils.canonical import CanonicalKeyDict
 
 epoch = datetime.utcfromtimestamp(0)
@@ -132,9 +134,20 @@ def load_data(platform, default=None, sample_name=None):
         return
 
     data = CanonicalKeyDict(data)
-    if platform in ('transaction', 'csp', 'hkpk', 'expectct', 'expectstaple'):
+    if platform in ('csp', 'hkpk', 'expectct', 'expectstaple'):
         return data
 
+    # Transaction events need timestamp data set to something current.
+    if platform == 'transaction':
+        now = timezone.now()
+        now_time = to_timestamp(now)
+        start_time = to_timestamp(now - timedelta(seconds=-2))
+        data.setdefault('timestamp', now_time)
+        data.setdefault('start_timestamp', start_time)
+        for span in data['spans']:
+            span.setdefault('timestamp', now_time)
+            span.setdefault('start_timestamp', start_time)
+
     data['platform'] = platform
     # XXX: Message is a legacy alias for logentry. Do not overwrite if set.
     if 'message' not in data:
