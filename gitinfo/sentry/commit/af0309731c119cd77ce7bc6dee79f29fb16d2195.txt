commit af0309731c119cd77ce7bc6dee79f29fb16d2195
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Jun 7 09:24:09 2014 -0400

    Title-case headers in Http interface

diff --git a/src/sentry/interfaces/http.py b/src/sentry/interfaces/http.py
index 1bbc14f3f7..c762351705 100644
--- a/src/sentry/interfaces/http.py
+++ b/src/sentry/interfaces/http.py
@@ -18,6 +18,13 @@ from sentry.utils.safe import trim, trim_dict
 from sentry.web.helpers import render_to_string
 
 
+def format_headers(value):
+    return dict(
+        (k.title(), v)
+        for k, v in value.iteritems()
+    )
+
+
 class Http(Interface):
     """
     The Request information is stored in the Http interface. Two arguments
@@ -91,6 +98,7 @@ class Http(Interface):
         # strip them out
         headers = data.get('headers')
         if headers:
+            headers = format_headers(headers)
             if 'Cookie' in headers and not cookies:
                 cookies = headers.pop('Cookie')
             headers = trim_dict(headers)
diff --git a/tests/sentry/interfaces/test_http.py b/tests/sentry/interfaces/test_http.py
index 74376a0f20..eea4cdc323 100644
--- a/tests/sentry/interfaces/test_http.py
+++ b/tests/sentry/interfaces/test_http.py
@@ -40,7 +40,7 @@ class HttpTest(TestCase):
             url='http://example.com',
             query_string='foo=bar',
             fragment='foobar',
-            headers={'biz': 'baz'},
+            headers={'x-foo-bar': 'baz'},
             cookies={'foo': 'bar'},
             env={'bing': 'bong'},
             data='hello world',
@@ -49,7 +49,7 @@ class HttpTest(TestCase):
         assert result.query_string == 'foo=bar'
         assert result.fragment == 'foobar'
         assert result.cookies == {'foo': 'bar'}
-        assert result.headers == {'biz': 'baz'}
+        assert result.headers == {'X-Foo-Bar': 'baz'}
         assert result.env == {'bing': 'bong'}
         assert result.data == 'hello world'
 
