commit 1b420cbdf640b31379cffd3ae7fa4d4fb48b8bf3
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Apr 15 12:25:37 2015 -0700

    Initial work on rendering full team list

diff --git a/src/sentry/models/organization.py b/src/sentry/models/organization.py
index 95e5efe208..6fe19c277c 100644
--- a/src/sentry/models/organization.py
+++ b/src/sentry/models/organization.py
@@ -84,6 +84,10 @@ class Organization(Model):
     date_added = models.DateTimeField(default=timezone.now)
     members = models.ManyToManyField(settings.AUTH_USER_MODEL, through='sentry.OrganizationMember', related_name='org_memberships')
 
+    # flags = BitField(flags=(
+    #     ('allow_joinleave', 'Allow members to join and leave teams without requiring approval.'),
+    # ), default=0)
+
     objects = OrganizationManager(cache_fields=(
         'pk',
         'slug',
diff --git a/src/sentry/templates/sentry/organization-home.html b/src/sentry/templates/sentry/organization-home.html
index 521c0d4434..e983cfc8f4 100644
--- a/src/sentry/templates/sentry/organization-home.html
+++ b/src/sentry/templates/sentry/organization-home.html
@@ -20,11 +20,14 @@
   </ul>
   <div class="tab-content">
     <div class="tab-pane active" id="my-teams">
-    {% if not team_list %}
-      <p>You don't have any teams for this organization yet. Get started by <a href="{% url 'sentry-create-team' organization.slug %}">creating your first team</a>.</p>
+    {% if not active_teams %}
+      <p>You don't have access to any teams for this organization yet.</p>
+      {% if ACCESS.org_write %}
+        <p>Get started by <a href="{% url 'sentry-create-team' organization.slug %}">creating your first team</a>.</p>
+      {% endif %}
     {% else %}
       <ul class="team-list">
-        {% for team, project_list in team_list %}
+        {% for team, project_list in active_teams %}
           <li>
             <h3><div class="pull-right actions">
               {% if ACCESS.team_write %}
@@ -51,30 +54,18 @@
     </div>
     <div class="tab-pane" id="all-teams">
       <table class="table simple-list table-bordered">
-        <tr>
-          <td><h4>Captain Planet</h4></td>
-          <td style="text-align: right">
-            <a class="btn btn-default">Leave Team</a>
-          </td>
-        </tr>
-        <tr>
-          <td><h4>Massive Dynamic</h4></td>
-          <td style="text-align: right">
-            <a class="btn btn-default">Leave Team</a>
-          </td>
-        </tr>
-        <tr>
-          <td><h4>The Good Guys</h4></td>
-          <td style="text-align: right">
-            <a class="btn btn-primary">Request Access</a>
-          </td>
-        </tr>
-        <tr>
-          <td><h4>The Bad Guys</h4></td>
-          <td style="text-align: right">
-            <a class="btn btn-primary">Request Access</a>
-          </td>
-        </tr>
+        {% for team, is_member in all_teams %}
+          <tr>
+            <td><h4>{{ team.name }}</h4></td>
+            <td style="text-align: right">
+              {% if is_member %}
+                <a class="btn btn-default">Leave Team</a>
+              {% else %}
+                <a class="btn btn-default">Request Access</a>
+              {% endif %}
+            </td>
+          </tr>
+        {% endfor %}
       </table>
     </div>
   </div>
diff --git a/src/sentry/web/frontend/organization_home.py b/src/sentry/web/frontend/organization_home.py
index ca15c28265..e5444e4053 100644
--- a/src/sentry/web/frontend/organization_home.py
+++ b/src/sentry/web/frontend/organization_home.py
@@ -6,14 +6,21 @@ from sentry.web.frontend.base import OrganizationView
 
 class OrganizationHomeView(OrganizationView):
     def get(self, request, organization):
-        team_list = Team.objects.get_for_user(
+        active_teams = Team.objects.get_for_user(
             organization=organization,
             user=request.user,
             with_projects=True,
         )
 
+        active_team_set = set([t.id for t, _ in active_teams])
+
+        all_teams = []
+        for team in Team.objects.filter(organization=organization).order_by('name'):
+            all_teams.append((team, team.id in active_team_set))
+
         context = {
-            'team_list': team_list,
+            'active_teams': active_teams,
+            'all_teams': all_teams,
         }
 
         return self.respond('sentry/organization-home.html', context)
