commit 3a26a30d5e39828fcad61006dcfee065299b89f3
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Jan 3 12:01:40 2015 -0800

    Correct handling of legacy annotations

diff --git a/src/sentry/templates/sentry/partial/_group.html b/src/sentry/templates/sentry/partial/_group.html
index 60999af114..ecfd1d87c4 100644
--- a/src/sentry/templates/sentry/partial/_group.html
+++ b/src/sentry/templates/sentry/partial/_group.html
@@ -13,6 +13,9 @@
         </h3>
         <p class="message" title="{{ group.message }}">
             <a href="{% url 'sentry-stream' group.organization.slug group.project.slug %}?logger={{ group.logger }}" class="tag tag-logger">{{ group.logger }}</a>
+            {% for annotation in group|get_legacy_annotations:request %}
+                <span class="tag">{{ annotation }}</span>
+            {% endfor %}
             {% for annotation in group|get_annotations:request %}
                 {% if annotation.url %}
                     <a href="{{ annotation.url }}" class="tag">{{ annotation.label }}</a>
diff --git a/src/sentry/templatetags/sentry_plugins.py b/src/sentry/templatetags/sentry_plugins.py
index 76ae684240..025d6970c3 100644
--- a/src/sentry/templatetags/sentry_plugins.py
+++ b/src/sentry/templatetags/sentry_plugins.py
@@ -63,7 +63,7 @@ def get_widgets(group, request):
 
 
 @register.filter
-def get_annotations(group, request=None):
+def get_legacy_annotations(group, request=None):
     project = group.project
 
     annotation_list = []
@@ -75,7 +75,14 @@ def get_annotations(group, request=None):
 
         annotation_list = results
 
-    annotation_list = [Annotation(*tag) for tag in annotation_list]
+    return annotation_list
+
+
+@register.filter
+def get_annotations(group, request=None):
+    project = group.project
+
+    annotation_list = []
     for plugin in plugins.for_project(project, version=2):
         for value in (safe_execute(plugin.get_annotations, request, group) or ()):
             annotation = safe_execute(Annotation, **value)
