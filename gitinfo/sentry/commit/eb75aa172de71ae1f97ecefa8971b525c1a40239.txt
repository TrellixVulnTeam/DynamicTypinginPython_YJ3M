commit eb75aa172de71ae1f97ecefa8971b525c1a40239
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Thu Apr 16 17:21:33 2020 -0700

    fix(onboarding): Allow members to mark tasks as complete (#18326)
    
    Fixes: JAVASCRIPT-REQUESTS-3KG

diff --git a/src/sentry/api/endpoints/organization_onboarding_tasks.py b/src/sentry/api/endpoints/organization_onboarding_tasks.py
index d72e3c447b..98362be744 100644
--- a/src/sentry/api/endpoints/organization_onboarding_tasks.py
+++ b/src/sentry/api/endpoints/organization_onboarding_tasks.py
@@ -3,12 +3,18 @@ from __future__ import absolute_import
 from django.utils import timezone
 from rest_framework.response import Response
 
-from sentry.api.bases.organization import OrganizationEndpoint
+from sentry.api.bases.organization import OrganizationEndpoint, OrganizationPermission
 from sentry.models import OnboardingTaskStatus, OrganizationOnboardingTask
 from sentry.receivers import try_mark_onboarding_complete
 
 
+class OnboardingTaskPermission(OrganizationPermission):
+    scope_map = {"POST": ["org:read"]}
+
+
 class OrganizationOnboardingTaskEndpoint(OrganizationEndpoint):
+    permission_classes = (OnboardingTaskPermission,)
+
     def post(self, request, organization):
         try:
             task_id = OrganizationOnboardingTask.TASK_LOOKUP_BY_KEY[request.data["task"]]
diff --git a/tests/sentry/api/endpoints/test_organization_onboarding_tasks.py b/tests/sentry/api/endpoints/test_organization_onboarding_tasks.py
index f8981ea150..3604ab8385 100644
--- a/tests/sentry/api/endpoints/test_organization_onboarding_tasks.py
+++ b/tests/sentry/api/endpoints/test_organization_onboarding_tasks.py
@@ -9,12 +9,13 @@ from sentry.testutils import APITestCase
 class OrganizationOnboardingTaskEndpointTest(APITestCase):
     def setUp(self):
         self.user = self.create_user()
+        self.member_user = self.create_user()
         self.org = self.create_organization(owner=self.user)
+        self.create_member(organization=self.org, user=self.member_user)
         self.login_as(user=self.user)
         self.path = reverse("sentry-api-0-organization-onboardingtasks", args=[self.org.slug])
 
     def test_mark_complete(self):
-
         response = self.client.post(self.path, {"task": "create_project", "status": "complete"})
 
         assert response.status_code == 204, response.content
@@ -41,6 +42,22 @@ class OrganizationOnboardingTaskEndpointTest(APITestCase):
 
         assert task.completion_seen is not None
 
+    def test_mark_completion_seen_as_member(self):
+        self.login_as(self.member_user)
+
+        response = self.client.post(self.path, {"task": "create_project", "status": "complete"})
+        assert response.status_code == 204, response.content
+
+        response = self.client.post(self.path, {"task": "create_project", "completionSeen": True})
+
+        assert response.status_code == 204, response.content
+
+        task = OrganizationOnboardingTask.objects.get(
+            organization=self.org, task=OnboardingTask.FIRST_PROJECT
+        )
+
+        assert task.completion_seen is not None
+
     def test_cannot_skip_unskippable(self):
         response = self.client.post(self.path, {"task": "create_project", "status": "skipped"})
 
