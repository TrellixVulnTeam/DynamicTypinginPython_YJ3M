commit 4e57f2bf603cf79143b24963781c5fefea93538a
Author: Evan Purkhiser <evanpurkhiser@gmail.com>
Date:   Thu Mar 12 14:58:45 2020 -0700

    feat(onboarding): Serialize onboarding task user with UserSerializer (#17600)

diff --git a/src/sentry/api/serializers/models/organization.py b/src/sentry/api/serializers/models/organization.py
index e1ae3ed2d1..52d45d653e 100644
--- a/src/sentry/api/serializers/models/organization.py
+++ b/src/sentry/api/serializers/models/organization.py
@@ -7,6 +7,7 @@ from django.conf import settings
 from sentry import roles
 from sentry.app import quotas
 from sentry.api.serializers import Serializer, register, serialize
+from sentry.api.serializers.models import UserSerializer
 from sentry.constants import LEGACY_RATE_LIMIT_OPTIONS
 from sentry.lang.native.utils import convert_crashreport_count
 from sentry.models import (
@@ -109,11 +110,22 @@ class OrganizationSerializer(Serializer):
 
 
 class OnboardingTasksSerializer(Serializer):
+    def get_attrs(self, item_list, user, **kwargs):
+        # Unique user list
+        users = {item.user for item in item_list if item.user}
+        serialized_users = serialize(users, user, UserSerializer())
+        user_map = {user["id"]: user for user in serialized_users}
+
+        data = {}
+        for item in item_list:
+            data[item] = {"user": user_map.get(six.text_type(item.user_id))}
+        return data
+
     def serialize(self, obj, attrs, user):
         return {
             "task": OrganizationOnboardingTask.TASK_KEY_MAP.get(obj.task),
             "status": OrganizationOnboardingTask.STATUS_KEY_MAP.get(obj.status),
-            "user": obj.user.name if obj.user else None,
+            "user": attrs.get("user"),
             "completionSeen": obj.completion_seen,
             "dateCompleted": obj.date_completed,
             "data": obj.data,
diff --git a/src/sentry/static/sentry/app/components/onboardingWizard/toDoItem.tsx b/src/sentry/static/sentry/app/components/onboardingWizard/toDoItem.tsx
index 83f49b29e0..0ca077223a 100644
--- a/src/sentry/static/sentry/app/components/onboardingWizard/toDoItem.tsx
+++ b/src/sentry/static/sentry/app/components/onboardingWizard/toDoItem.tsx
@@ -84,19 +84,19 @@ class TodoItem extends React.Component<Props, State> {
     switch (task.status) {
       case 'complete':
         description = tct('[user] completed [dateCompleted]', {
-          user: task.user,
+          user: task.user?.name,
           dateCompleted: moment(task.dateCompleted).fromNow(),
         });
         break;
       case 'pending':
         description = tct('[user] kicked off [dateCompleted]', {
-          user: task.user,
+          user: task.user?.name,
           dateCompleted: moment(task.dateCompleted).fromNow(),
         });
         break;
       case 'skipped':
         description = tct('[user] skipped [dateCompleted]', {
-          user: task.user,
+          user: task.user?.name,
           dateCompleted: moment(task.dateCompleted).fromNow(),
         });
         break;
diff --git a/src/sentry/static/sentry/app/types/index.tsx b/src/sentry/static/sentry/app/types/index.tsx
index 63bf15781d..3ccfb9fc21 100644
--- a/src/sentry/static/sentry/app/types/index.tsx
+++ b/src/sentry/static/sentry/app/types/index.tsx
@@ -951,7 +951,7 @@ export type OnboardingTaskDescriptor = {
 export type OnboardingTaskStatus = {
   task: OnboardingTaskKey;
   status: 'skipped' | 'pending' | 'complete';
-  user?: string | null;
+  user?: AvatarUser | null;
   dateCompleted?: string;
   completionSeen?: string;
   data?: object;
