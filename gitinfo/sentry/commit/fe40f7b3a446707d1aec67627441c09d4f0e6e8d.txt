commit fe40f7b3a446707d1aec67627441c09d4f0e6e8d
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Jun 26 14:19:18 2013 -0700

    Cache bad source lookups

diff --git a/src/sentry/tasks/fetch_source.py b/src/sentry/tasks/fetch_source.py
index b2ee47b21d..938502db96 100644
--- a/src/sentry/tasks/fetch_source.py
+++ b/src/sentry/tasks/fetch_source.py
@@ -129,16 +129,14 @@ def fetch_url(url, logger=None):
     cache_key = 'fetch_url:v2:%s' % (
         hashlib.md5(url.encode('utf-8')).hexdigest(),)
     result = cache.get(cache_key)
-    if result is not None:
-        return UrlResult(*result)
+    if result is None:
+        result = fetch_url_content(url, logger)
 
-    result = fetch_url_content(url, logger)
+        cache.set(cache_key, result, 60 * 5)
 
     if result == BAD_SOURCE:
         return result
 
-    cache.set(cache_key, result, 60 * 5)
-
     return UrlResult(*result)
 
 
