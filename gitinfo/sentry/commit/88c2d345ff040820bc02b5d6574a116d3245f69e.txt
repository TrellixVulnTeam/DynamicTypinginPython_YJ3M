commit 88c2d345ff040820bc02b5d6574a116d3245f69e
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Sun Jun 12 21:18:32 2016 +0200

    Properly flip the expired flag and improve messaging on reset

diff --git a/src/sentry/models/user.py b/src/sentry/models/user.py
index 1d977f435f..e2e69bbad6 100644
--- a/src/sentry/models/user.py
+++ b/src/sentry/models/user.py
@@ -181,3 +181,4 @@ class User(BaseModel, AbstractBaseUser):
     def set_password(self, raw_password):
         super(User, self).set_password(raw_password)
         self.last_password_change = timezone.now()
+        self.is_password_expired = False
diff --git a/src/sentry/templates/sentry/account/recover/expired.html b/src/sentry/templates/sentry/account/recover/expired.html
new file mode 100644
index 0000000000..add76c4bdd
--- /dev/null
+++ b/src/sentry/templates/sentry/account/recover/expired.html
@@ -0,0 +1,14 @@
+{% extends "sentry/bases/auth.html" %}
+
+{% load crispy_forms_tags %}
+{% load i18n %}
+
+{% block title %}{% trans "Password Expired" %} | {{ block.super }}{% endblock %}
+
+{% block auth_main %}
+
+  <h2>{% trans "Password Expired" %}</h2>
+  <p>{% blocktrans %}The password on your account expired.{% endblocktrans %}</p>
+
+	<p>{% blocktrans %}We have sent an email to the address registered with this account containing further instructions to reset your password.{% endblocktrans %}</p>
+{% endblock %}
diff --git a/src/sentry/templates/sentry/account/recover/sent.html b/src/sentry/templates/sentry/account/recover/sent.html
index 9360941cfe..a0de9428d0 100644
--- a/src/sentry/templates/sentry/account/recover/sent.html
+++ b/src/sentry/templates/sentry/account/recover/sent.html
@@ -8,9 +8,5 @@
 {% block auth_main %}
 	<h2>{% trans "Recover Account" %}</h2>
 
-  {% if expired %}
-  <p>{% blocktrans %}The password on your account expired.  We sent you a link to reset your password to the address registered with this account containing further instructions.{% endblocktrans %}</p>
-  {% endif %}
-
 	<p>{% blocktrans %}We have sent an email to the address registered with this account containing further instructions to reset your password.{% endblocktrans %}</p>
 {% endblock %}
diff --git a/src/sentry/web/frontend/accounts.py b/src/sentry/web/frontend/accounts.py
index 8859f8f3ba..55cd646b10 100644
--- a/src/sentry/web/frontend/accounts.py
+++ b/src/sentry/web/frontend/accounts.py
@@ -53,9 +53,8 @@ def login_redirect(request):
 
 def expired(request, user):
     password_hash = send_password_recovery_mail(user)
-    return render_to_response('sentry/account/recover/sent.html', {
+    return render_to_response('sentry/account/recover/expired.html', {
         'email': password_hash.user.email,
-        'expired': True,
     }, request)
 
 
@@ -68,7 +67,6 @@ def recover(request):
 
         return render_to_response('sentry/account/recover/sent.html', {
             'email': password_hash.user.email,
-            'expired': False,
         }, request)
 
     elif request.POST and not request.session.get('needs_captcha'):
