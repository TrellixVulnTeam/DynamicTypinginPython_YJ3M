commit b07eb91cdab7129b233436654d0b4542cf02bbf1
Author: Lyn Nagara <lyn.nagara@gmail.com>
Date:   Thu Sep 13 15:53:28 2018 -0700

    fix(discover): Add 1px buffer to column width calculation (#9765)
    
    The canvas measureText sometimes slightly underestimates text width by small amounts. We'll add 1px to the calulated value in order to prevent text from breaking to the next line unnecessarily.

diff --git a/src/sentry/static/sentry/app/views/organizationDiscover/result/table.jsx b/src/sentry/static/sentry/app/views/organizationDiscover/result/table.jsx
index 400da7e2fc..c371459e0a 100644
--- a/src/sentry/static/sentry/app/views/organizationDiscover/result/table.jsx
+++ b/src/sentry/static/sentry/app/views/organizationDiscover/result/table.jsx
@@ -152,7 +152,10 @@ export default class ResultTable extends React.Component {
     }
     const context = this.canvas.getContext('2d');
     context.font = isHeader ? 'bold 14px Rubik' : 'normal 14px Rubik';
-    return Math.ceil(context.measureText(text).width);
+
+    // The measureText function sometimes slightly miscalculates text width.
+    // Add 1px to compensate since we want to avoid rows breaking unnecessarily.
+    return Math.ceil(context.measureText(text).width) + 1;
   };
 
   renderTable() {
diff --git a/tests/js/spec/views/organizationDiscover/result/table.spec.jsx b/tests/js/spec/views/organizationDiscover/result/table.spec.jsx
index a9aa9f58ae..f4d3cfd535 100644
--- a/tests/js/spec/views/organizationDiscover/result/table.spec.jsx
+++ b/tests/js/spec/views/organizationDiscover/result/table.spec.jsx
@@ -30,6 +30,6 @@ describe('ResultTable', function() {
       query: {fields: ['col1'], aggregations: []},
     });
     const widths = wrapper.instance().getColumnWidths(500);
-    expect(widths).toEqual([340, 40, 118]);
+    expect(widths).toEqual([341, 40, 117]);
   });
 });
