commit 7566e3b40912a751de088bfb4fb68372499f4b21
Author: Jess MacQueen <jessmacqueen@gmail.com>
Date:   Mon Sep 10 11:55:45 2018 -0700

    fix(integrations): Update repo provider during migration

diff --git a/src/sentry/integrations/bitbucket/integration.py b/src/sentry/integrations/bitbucket/integration.py
index a0d114e17b..7b3bcd0471 100644
--- a/src/sentry/integrations/bitbucket/integration.py
+++ b/src/sentry/integrations/bitbucket/integration.py
@@ -124,7 +124,10 @@ class BitbucketIntegrationProvider(IntegrationProvider):
             .get_unmigratable_repositories()
 
         for repo in filter(lambda r: r not in unmigrateable_repos, repos):
-            repo.update(integration_id=integration.id)
+            repo.update(
+                integration_id=integration.id,
+                provider='integrations:bitbucket',
+            )
 
         PluginMigrator(integration, organization).call()
 
diff --git a/src/sentry/integrations/vsts/integration.py b/src/sentry/integrations/vsts/integration.py
index 7fb744fca0..9642d0a6f9 100644
--- a/src/sentry/integrations/vsts/integration.py
+++ b/src/sentry/integrations/vsts/integration.py
@@ -278,7 +278,10 @@ class VstsIntegrationProvider(IntegrationProvider):
         )
 
         for repo in repos:
-            repo.update(integration_id=integration.id)
+            repo.update(
+                integration_id=integration.id,
+                provider='integrations:vsts',
+            )
 
         PluginMigrator(integration, organization).call()
 
diff --git a/src/sentry/tasks/integrations.py b/src/sentry/tasks/integrations.py
index 8eac6fee4d..6829a1e945 100644
--- a/src/sentry/tasks/integrations.py
+++ b/src/sentry/tasks/integrations.py
@@ -172,6 +172,7 @@ def migrate_repo(repo_id, integration_id, organization_id):
     repo = Repository.objects.get(id=repo_id)
     if installation.has_repo_access(repo):
         repo.integration_id = integration_id
+        repo.provider = 'integrations:github'
         repo.save()
 
         PluginMigrator(
