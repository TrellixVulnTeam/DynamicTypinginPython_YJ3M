commit fd8c75673f1421566c9737313026d2088888c285
Author: Armin Ronacher <armin.ronacher@active-4.com>
Date:   Thu Nov 19 11:59:10 2015 +0100

    Addd support for merging translator comments

diff --git a/Makefile b/Makefile
index d2123c66f1..bbab4c4770 100644
--- a/Makefile
+++ b/Makefile
@@ -57,7 +57,7 @@ locale: build/javascript.po
 	./bin/merge-catalogs en
 	cd src/sentry && sentry compilemessages
 
-update-transifex:
+update-transifex: build/javascript.po
 	pip install transifex-client
 	cd src/sentry && sentry makemessages -i static -l en
 	./bin/merge-catalogs en
diff --git a/bin/merge-catalogs b/bin/merge-catalogs
index b86b4841ad..d8bca6a5cf 100755
--- a/bin/merge-catalogs
+++ b/bin/merge-catalogs
@@ -9,9 +9,13 @@ from babel.messages.pofile import read_po, write_po
 JS_EXTENSIONS = ('.js', '.jsx')
 
 
-def merge_locations(locations, frontend_locations):
-    return [(fn, lineno) for fn, lineno in locations
-            if not fn.endswith(JS_EXTENSIONS)] + frontend_locations
+def merge_message(msg, frontend_msg):
+    msg.locations = [
+        (fn, lineno) for fn, lineno in msg.locations
+        if not fn.endswith(JS_EXTENSIONS)
+    ] + frontend_msg.locations
+    if not msg.user_comments and frontend_msg.user_comments:
+        msg.user_comments = frontend_msg.usr_comments
 
 
 @click.command()
@@ -39,8 +43,7 @@ def cli(locale):
         # Otherwise merge the record.  Locations are merged by removing
         # all javascript locations and inserting new ones.
         else:
-            msg.locations = merge_locations(
-                msg.locations, frontend_msg.locations)
+            merge_message(msg, frontend_msg)
         catalog[msg.id] = msg
 
     with open(catalog_file, 'w') as f:
