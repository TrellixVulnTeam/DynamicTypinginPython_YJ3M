commit c7f67335ffd7014f527a13c3ad1fb9d383f38c1d
Author: Ben Vinegar <ben@benv.ca>
Date:   Fri Aug 28 16:45:02 2015 -0700

    Show raw JSON string if cannot be parsed

diff --git a/src/sentry/static/sentry/app/components/interfaces/richHttpContent.jsx b/src/sentry/static/sentry/app/components/interfaces/richHttpContent.jsx
index f81b99c2b7..386be879c4 100644
--- a/src/sentry/static/sentry/app/components/interfaces/richHttpContent.jsx
+++ b/src/sentry/static/sentry/app/components/interfaces/richHttpContent.jsx
@@ -31,10 +31,15 @@ var RichHttpContent = React.createClass({
 
   getBodySection(data) {
     let contentType = data.headers.find(h => h[0] === 'Content-Type');
+    contentType = contentType && contentType[1];
 
-    switch (contentType && contentType[1]) {
+    switch (contentType) {
       case 'application/json':
-        return <ContextData data={JSON.parse(data.data)} />;
+        try {
+          // Sentry API abbreviates long JSON strings, which cannot be parsed ...
+          return <ContextData data={JSON.parse(data.data)} />;
+        } catch (e) { /* do nothing */ }
+        return <pre>{data.data}</pre>
       case 'application/x-www-form-urlencoded':
         return <DefinitionList data={this.objectToTupleArray(queryString.parse(data.data))}/>
       default:
diff --git a/tests/js/spec/components/interfaces/richHttpContent.spec.jsx b/tests/js/spec/components/interfaces/richHttpContent.spec.jsx
index 15809618d2..87a8257cef 100644
--- a/tests/js/spec/components/interfaces/richHttpContent.spec.jsx
+++ b/tests/js/spec/components/interfaces/richHttpContent.spec.jsx
@@ -91,5 +91,17 @@ describe("RichHttpContent", function () {
         foo: 'bar'
       });
     });
+
+    it("should return plain-text when JSON is not parseable", function () {
+      let out = this.elem.getBodySection({
+        headers: [
+          ['lol' , 'no'],
+          ['Content-Type', 'application/json']
+        ],
+        data: 'lol not json'
+      });
+
+      expect(out.type).to.eql('pre');
+    });
   });
 });
