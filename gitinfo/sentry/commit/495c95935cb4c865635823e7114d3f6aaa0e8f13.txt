commit 495c95935cb4c865635823e7114d3f6aaa0e8f13
Author: Ted Kaemming <ted@kaemming.com>
Date:   Wed Nov 11 15:49:19 2015 -0800

    Check feature flag before digest delivery.
    
    (This is for forwards compatibility.)

diff --git a/src/sentry/tasks/digests.py b/src/sentry/tasks/digests.py
index 23825f22d2..bd3472a33f 100644
--- a/src/sentry/tasks/digests.py
+++ b/src/sentry/tasks/digests.py
@@ -1,7 +1,9 @@
 from __future__ import absolute_import
 
+import logging
 import time
 
+from sentry import features
 from sentry.digests.notifications import (
     build_digest,
     split_key,
@@ -9,6 +11,9 @@ from sentry.digests.notifications import (
 from sentry.tasks.base import instrumented_task
 
 
+logger = logging.getLogger(__name__)
+
+
 @instrumented_task(
     name='sentry.tasks.digests.schedule_digests',
     queue='digests.scheduling')
@@ -42,5 +47,9 @@ def deliver_digest(key, schedule_timestamp=None):
     with digests.digest(key) as records:
         digest = build_digest(project, records)
 
+    if not features.has('projects:digests', project):
+        logger.info('Skipping %r, digests are disabled for %r.', digest, project)
+        return
+
     if digest:
         plugin.notify_digest(project, digest)
