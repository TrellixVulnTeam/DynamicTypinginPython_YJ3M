commit 9eb3157729d89c25ef62ca7c014f462df3bed858
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Apr 4 21:35:26 2013 -0700

    Move stacktrace context into Stacktrace.get_context

diff --git a/src/sentry/interfaces.py b/src/sentry/interfaces.py
index b2c2aed4ac..c65e6177f8 100644
--- a/src/sentry/interfaces.py
+++ b/src/sentry/interfaces.py
@@ -499,10 +499,7 @@ class Stacktrace(Interface):
 
         return newest_first
 
-    def to_html(self, event, is_public=False, **kwargs):
-        if not self.frames:
-            return ''
-
+    def get_context(self, event, is_public=False, **kwargs):
         system_frames = 0
         frames = []
         for frame in self.frames:
@@ -523,14 +520,18 @@ class Stacktrace(Interface):
         if newest_first:
             frames = frames[::-1]
 
-        return render_to_string('sentry/partial/interfaces/stacktrace.html', {
+        return {
             'is_public': is_public,
             'newest_first': newest_first,
             'system_frames': system_frames,
             'event': event,
             'frames': frames,
             'stacktrace': self.get_traceback(event, newest_first=newest_first),
-        })
+        }
+
+    def to_html(self, event, is_public=False, **kwargs):
+        context = self.get_context(event=event, is_public=is_public, **kwargs)
+        return render_to_string('sentry/partial/interfaces/stacktrace.html', context)
 
     def to_string(self, event, is_public=False, **kwargs):
         return self.get_stacktrace(event, system_frames=False, max_frames=5)
