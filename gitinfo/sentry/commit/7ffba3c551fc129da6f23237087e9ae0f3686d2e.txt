commit 7ffba3c551fc129da6f23237087e9ae0f3686d2e
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Sep 20 17:34:26 2010 -0700

    Optimize querysets if you dont select on server_name

diff --git a/sentry/filters/__init__.py b/sentry/filters/__init__.py
index 82dfdae75f..1b207ff9af 100644
--- a/sentry/filters/__init__.py
+++ b/sentry/filters/__init__.py
@@ -115,7 +115,7 @@ class ServerNameFilter(SentryFilter):
     column = 'server_name'
 
     def get_query_set(self, queryset):
-        return queryset.filter(message_set__server_name=self.get_value())
+        return queryset.filter(message_set__server_name=self.get_value()).distinct()
 
 class LevelFilter(SentryFilter):
     label = 'Level'
diff --git a/sentry/views.py b/sentry/views.py
index 1f29a19321..27c0ea334b 100644
--- a/sentry/views.py
+++ b/sentry/views.py
@@ -121,7 +121,7 @@ def index(request):
         message_list = message_list.order_by('-first_seen')
     else:
         sort = 'priority'
-        message_list = message_list.order_by('-score', '-last_seen').distinct()
+        message_list = message_list.order_by('-score', '-last_seen')
 
     
     any_filter = False
@@ -159,7 +159,7 @@ def ajax_handler(request):
             message_list = message_list.order_by('-first_seen')
         else:
             sort = 'priority'
-            message_list = message_list.order_by('-score', '-last_seen').distinct()
+            message_list = message_list.order_by('-score', '-last_seen')
         
         for filter_ in filters:
             if not filter_.is_set():
