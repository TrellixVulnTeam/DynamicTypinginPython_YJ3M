commit 275f7bf1b1a36035118bf3ceffe8cb488c2c9054
Author: Jess MacQueen <jessmacqueen@gmail.com>
Date:   Wed Sep 19 12:17:09 2018 -0700

    fix(integrations): Ensure external issues are deleted with organization

diff --git a/src/sentry/deletions/defaults/organization.py b/src/sentry/deletions/defaults/organization.py
index 7ebc145c13..c3ca662999 100644
--- a/src/sentry/deletions/defaults/organization.py
+++ b/src/sentry/deletions/defaults/organization.py
@@ -8,7 +8,7 @@ class OrganizationDeletionTask(ModelDeletionTask):
         from sentry.models import (
             OrganizationMember, Commit, CommitAuthor, CommitFileChange, Environment, Release,
             ReleaseCommit, ReleaseEnvironment, ReleaseFile, Distribution, ReleaseHeadCommit,
-            Repository, Team, Project, PullRequest, DiscoverSavedQuery,
+            Repository, Team, Project, PullRequest, DiscoverSavedQuery, ExternalIssue
         )
 
         # Team must come first
@@ -32,6 +32,7 @@ class OrganizationDeletionTask(ModelDeletionTask):
             Distribution,
             ReleaseHeadCommit,
             DiscoverSavedQuery,
+            ExternalIssue,
         )
         relations.extend([ModelRelation(m, {'organization_id': instance.id}) for m in model_list])
 
diff --git a/tests/sentry/deletions/test_organization.py b/tests/sentry/deletions/test_organization.py
index 0713db9983..4bbdd2537c 100644
--- a/tests/sentry/deletions/test_organization.py
+++ b/tests/sentry/deletions/test_organization.py
@@ -1,8 +1,9 @@
 from __future__ import absolute_import
 
 from sentry.models import (
-    Commit, CommitAuthor, Environment, Organization, PullRequest, Release,
-    ReleaseCommit, ReleaseEnvironment, Repository, ScheduledDeletion
+    Commit, CommitAuthor, Environment, ExternalIssue, Organization,
+    PullRequest, Release, ReleaseCommit, ReleaseEnvironment, Repository,
+    ScheduledDeletion
 )
 from sentry.tasks.deletion import run_deletion
 from sentry.testutils import TestCase
@@ -51,6 +52,12 @@ class DeleteOrganizationTest(TestCase):
             organization_id=org.id, project_id=4, release_id=release.id, environment_id=env.id
         )
 
+        external_issue = ExternalIssue.objects.create(
+            organization_id=org.id,
+            integration_id=5,
+            key='12345',
+        )
+
         deletion = ScheduledDeletion.schedule(org, days=0)
         deletion.update(in_progress=True)
 
@@ -68,3 +75,4 @@ class DeleteOrganizationTest(TestCase):
         assert not CommitAuthor.objects.filter(id=commit_author.id).exists()
         assert not Commit.objects.filter(id=commit.id).exists()
         assert not PullRequest.objects.filter(id=pull_request.id).exists()
+        assert not ExternalIssue.objects.filter(id=external_issue.id).exists()
