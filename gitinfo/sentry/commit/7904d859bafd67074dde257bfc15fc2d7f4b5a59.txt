commit 7904d859bafd67074dde257bfc15fc2d7f4b5a59
Author: David Cramer <dcramer@gmail.com>
Date:   Sun Sep 15 14:17:15 2013 +0900

    Add set/create tests and ensure create returns node id

diff --git a/src/sentry/nodestore/base.py b/src/sentry/nodestore/base.py
index 094aafdaeb..1cc47f6ecd 100644
--- a/src/sentry/nodestore/base.py
+++ b/src/sentry/nodestore/base.py
@@ -14,7 +14,8 @@ import uuid
 class NodeStorage(object):
     def create(self, data, timestamp=None):
         node_id = uuid.uuid4().hex
-        return self.set(node_id, data, timestamp)
+        self.set(node_id, data, timestamp)
+        return node_id
 
     def get(self, id):
         raise NotImplementedError
diff --git a/tests/sentry/nodestore/django/backend/tests.py b/tests/sentry/nodestore/django/backend/tests.py
index 6c16e35f6a..58689095c6 100644
--- a/tests/sentry/nodestore/django/backend/tests.py
+++ b/tests/sentry/nodestore/django/backend/tests.py
@@ -42,3 +42,19 @@ class DjangoNodeStorageTest(TestCase):
             'd2502ebbd7df41ceba8d3275595cac33', '5394aa025b8e401ca6bc3ddee3130edc'
         ])
         assert result == dict((n.id, n.data) for n in nodes)
+
+    def test_set(self):
+        self.ns.set('d2502ebbd7df41ceba8d3275595cac33', {
+            'foo': 'bar',
+        })
+        assert Node.objects.get(id='d2502ebbd7df41ceba8d3275595cac33').data == {
+            'foo': 'bar',
+        }
+
+    def test_create(self):
+        node_id = self.ns.create({
+            'foo': 'bar',
+        })
+        assert Node.objects.get(id=node_id).data == {
+            'foo': 'bar',
+        }
