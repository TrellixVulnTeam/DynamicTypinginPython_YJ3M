commit 26b3d87c341ee0afb9733c7509cc208453faf011
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Feb 5 00:23:45 2013 -0800

    Initial work on access group details page

diff --git a/src/sentry/templates/sentry/teams/groups/details.html b/src/sentry/templates/sentry/teams/groups/details.html
new file mode 100644
index 0000000000..481f74f3b4
--- /dev/null
+++ b/src/sentry/templates/sentry/teams/groups/details.html
@@ -0,0 +1,96 @@
+{% extends "sentry/teams/groups/list.html" %}
+
+{% block title %}
+    {{ group.name }} | {{ block.super }}
+{% endblock %}
+
+{% load i18n %}
+{% load sentry_helpers %}
+
+{% block breadcrumb %}
+    {{ block.super }}
+    <li class="divider"></li>
+    <li><a href="{% url sentry-edit-access-group team.slug group.id %}">{{ group.name }}</a></li>
+{% endblock %}
+
+{% block bodyclass %}{% endblock %}
+
+{% block inner %}
+    <div class="page-header">
+        <h2>{{ group.name }}</h2>
+    </div>
+
+    <div class="row-fluid">
+        <div class="span4">
+            <h3>Settings</h3>
+            {% include "sentry/partial/_form.html" %}
+        </div>
+        <div class="span4">
+            <div class="pull-right">
+                <a href="#" class="btn btn-small btn-primary">Add Project</a>
+            </div>
+            <h3>Projects</h3>
+            {% if group_list %}
+                <table class="table table-striped">
+                    <colgroup>
+                        <col/>
+                        <col width="100px"/>
+                        <col width="100px"/>
+                    </colgroup>
+                    <thead>
+                        <tr>
+                            <th>{% trans "Name" %}</th>
+                            <th style="text-align:center;">{% trans "Access Type" %}</th>
+                            <th style="text-align:center">{% trans "Actions" %}</th>
+                        </tr>
+                    </thead>
+                    <tbody>
+                        {% for group in group_list %}
+                            <tr>
+                                <td><a href="{% url sentry-edit-access-group team.slug group.id %}">{{ group.name }}</a>{% if group.managed %} ({% trans "automatically managed" %}){% endif %}</td>
+                                <td style="text-align:center">{{ group.get_type_display }}</td>
+                                <td style="text-align:center"><a href="#" class="btn">{% trans "Remove" %}</a></td>
+                            </tr>
+                        {% endfor %}
+                    </tbody>
+                </table>
+            {% else %}
+                <p>{% trans "You have not created any access groups yet." %}</p>
+            {% endif %}
+        </div>
+
+        <div class="span4">
+            <div class="pull-right">
+                <a href="#" class="btn btn-small btn-primary">Add Member</a>
+            </div>
+            <h3>Members</h3>
+            {% if group_list %}
+                <table class="table table-striped">
+                    <colgroup>
+                        <col/>
+                        <col width="100px"/>
+                        <col width="100px"/>
+                    </colgroup>
+                    <thead>
+                        <tr>
+                            <th>{% trans "Name" %}</th>
+                            <th style="text-align:center;">{% trans "Access Type" %}</th>
+                            <th style="text-align:center">{% trans "Actions" %}</th>
+                        </tr>
+                    </thead>
+                    <tbody>
+                        {% for group in group_list %}
+                            <tr>
+                                <td><a href="{% url sentry-edit-access-group team.slug group.id %}">{{ group.name }}</a>{% if group.managed %} ({% trans "automatically managed" %}){% endif %}</td>
+                                <td style="text-align:center">{{ group.get_type_display }}</td>
+                                <td style="text-align:center"><a href="#" class="btn">{% trans "Remove" %}</a></td>
+                            </tr>
+                        {% endfor %}
+                    </tbody>
+                </table>
+            {% else %}
+                <p>{% trans "You have not created any access groups yet." %}</p>
+            {% endif %}
+        </div>
+    </div>
+{% endblock %}
diff --git a/src/sentry/templates/sentry/teams/groups/list.html b/src/sentry/templates/sentry/teams/groups/list.html
index 087ed72170..05e9fc834f 100644
--- a/src/sentry/templates/sentry/teams/groups/list.html
+++ b/src/sentry/templates/sentry/teams/groups/list.html
@@ -28,14 +28,14 @@
             <thead>
                 <tr>
                     <th>{% trans "Name" %}</th>
-                    <th style="text-align:center;">{% trans "Access" %}</th>
+                    <th style="text-align:center;">{% trans "Access Type" %}</th>
                     <th style="text-align:center">{% trans "Actions" %}</th>
                 </tr>
             </thead>
             <tbody>
                 {% for group in group_list %}
                     <tr>
-                        <td><a href="#">{{ group.name }}</a>{% if group.managed %} ({% trans "automatically managed" %}){% endif %}</td>
+                        <td><a href="{% url sentry-edit-access-group team.slug group.id %}">{{ group.name }}</a>{% if group.managed %} ({% trans "automatically managed" %}){% endif %}</td>
                         <td style="text-align:center">{{ group.get_type_display }}</td>
                         <td style="text-align:center"><a href="#" class="btn">{% trans "Remove" %}</a></td>
                     </tr>
diff --git a/src/sentry/web/forms/teams.py b/src/sentry/web/forms/teams.py
index 40744c5aab..ed0ea2d9d1 100644
--- a/src/sentry/web/forms/teams.py
+++ b/src/sentry/web/forms/teams.py
@@ -118,7 +118,7 @@ class AcceptInviteForm(forms.Form):
     pass
 
 
-class NewAccessGroupForm(forms.ModelForm):
+class BaseAccessGroupForm(forms.ModelForm):
     name = forms.CharField(label=_('Group Name'), max_length=200,
         widget=forms.TextInput(attrs={'placeholder': _('API Team')}))
     type = forms.ChoiceField(label=_('Access Type'), choices=MEMBER_TYPES,
@@ -127,3 +127,11 @@ class NewAccessGroupForm(forms.ModelForm):
     class Meta:
         fields = ('name', 'type')
         model = AccessGroup
+
+
+class NewAccessGroupForm(BaseAccessGroupForm):
+    pass
+
+
+class EditAccessGroupForm(BaseAccessGroupForm):
+    pass
diff --git a/src/sentry/web/frontend/teams.py b/src/sentry/web/frontend/teams.py
index 6e60422507..d5dafad9d8 100644
--- a/src/sentry/web/frontend/teams.py
+++ b/src/sentry/web/frontend/teams.py
@@ -20,7 +20,8 @@ from sentry.plugins import plugins
 from sentry.web.decorators import login_required, has_access
 from sentry.web.forms.teams import (NewTeamForm, NewTeamAdminForm,
     EditTeamForm, EditTeamAdminForm, EditTeamMemberForm, NewTeamMemberForm,
-    InviteTeamMemberForm, RemoveTeamForm, AcceptInviteForm, NewAccessGroupForm)
+    InviteTeamMemberForm, RemoveTeamForm, AcceptInviteForm, NewAccessGroupForm,
+    EditAccessGroupForm)
 from sentry.web.helpers import render_to_response
 
 
@@ -471,10 +472,6 @@ def create_new_team_project(request, team):
 @has_access(MEMBER_OWNER)
 @csrf_protect
 def manage_access_groups(request, team):
-    result = plugins.first('has_perm', request.user, 'edit_team', team)
-    if result is False and not request.user.has_perm('sentry.can_change_team'):
-        return HttpResponseRedirect(reverse('sentry'))
-
     context = csrf(request)
     context.update({
         'can_add_group': True,
@@ -511,3 +508,29 @@ def new_access_group(request, team):
     })
 
     return render_to_response('sentry/teams/groups/new.html', context, request)
+
+
+@has_access(MEMBER_OWNER)
+@csrf_protect
+def access_group_details(request, team, group_id):
+    try:
+        group = AccessGroup.objects.get(team=team, id=group_id)
+    except AccessGroup.DoesNotExist:
+        return HttpResponseRedirect(reverse('sentry-manage-access-groups', args=[team.slug]))
+
+    form = EditAccessGroupForm(request.POST or None, instance=group)
+    if form.is_valid():
+        form.save()
+
+    context = csrf(request)
+    context.update({
+        'team': team,
+        'group': group,
+        'form': form,
+        'projects': group.projects.all(),
+        'members': group.members.all(),
+        'SECTION': 'team',
+        'SUBSECTION': 'groups',
+    })
+
+    return render_to_response('sentry/teams/groups/details.html', context, request)
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index 1026ab47fb..77e5469874 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -58,6 +58,8 @@ urlpatterns = patterns('',
         name='sentry-manage-access-groups'),
     url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/new/$', teams.new_access_group,
         name='sentry-new-access-group'),
+    url(r'^account/teams/(?P<team_slug>[\w_-]+)/groups/(?P<group_id>\d+)/edit/$', teams.access_group_details,
+        name='sentry-edit-access-group'),
     url(r'^account/teams/(?P<team_slug>[\w_-]+)/members/$', teams.manage_team_members,
         name='sentry-manage-team-members'),
     url(r'^account/teams/(?P<team_slug>[\w_-]+)/members/new/$', teams.new_team_member,
