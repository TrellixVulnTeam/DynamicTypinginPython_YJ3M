commit d88a1831b53c2c5009df9c83d56203ba34e0d6d6
Author: ted kaemming <ted@kaemming.com>
Date:   Tue May 22 15:19:23 2018 -0700

    fix(search): `has:x` queries should not take precedence over `x:value` queries (#8520)
    
    Fixes SENTRY-6NX.

diff --git a/src/sentry/search/utils.py b/src/sentry/search/utils.py
index c49d94bce5..6fdce8314e 100644
--- a/src/sentry/search/utils.py
+++ b/src/sentry/search/utils.py
@@ -364,7 +364,9 @@ def parse_query(project, query, user):
                     value = 'sentry:user'
                 elif value == 'release':
                     value = 'sentry:release'
-                results['tags'][value] = ANY
+                # `has:x` query should not take precedence over `x:value` queries
+                if value not in results['tags']:
+                    results['tags'][value] = ANY
             elif key in ('age', 'firstSeen'):
                 results.update(get_date_params(value, 'age_from', 'age_to'))
             elif key in ('last_seen', 'lastSeen'):
diff --git a/tests/sentry/search/test_utils.py b/tests/sentry/search/test_utils.py
index 022dac62fd..c7d0d29879 100644
--- a/tests/sentry/search/test_utils.py
+++ b/tests/sentry/search/test_utils.py
@@ -404,6 +404,9 @@ class ParseQueryTest(TestCase):
         result = self.parse_query('has:foo')
         assert result['tags']['foo'] == ANY
 
+        result = self.parse_query('has:foo foo:value')
+        assert result['tags']['foo'] == 'value'
+
     def test_has_user(self):
         result = self.parse_query('has:user')
         assert result['tags']['sentry:user'] == ANY
