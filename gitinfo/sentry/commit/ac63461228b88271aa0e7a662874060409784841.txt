commit ac63461228b88271aa0e7a662874060409784841
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Jul 31 13:50:29 2015 -0700

    Correct behavior of project notification settings (Fixes GH-1668)

diff --git a/src/sentry/templates/sentry/account/notifications.html b/src/sentry/templates/sentry/account/notifications.html
index 4498d62253..96fb846ad1 100644
--- a/src/sentry/templates/sentry/account/notifications.html
+++ b/src/sentry/templates/sentry/account/notifications.html
@@ -19,20 +19,6 @@
         padding-bottom: 10px;
     }
     </style>
-    <script>
-    $('form a[data-toggle=change-target-value]').click(function(){
-        var $this = $(this);
-        var $target = $('#' + $this.data('target'));
-        var result = window.prompt('Enter an email address', $target.val());
-        $target.val(result || '');
-        if (result !== null) {
-            $this.text(result);
-        } else {
-            $this.html('<em>default</em>');
-        }
-    });
-    </script>
-
     <form action="" method="post">
         {% csrf_token %}
 
@@ -66,7 +52,8 @@
                         <table class="table table-bordered table-striped" style="margin-bottom: 20px">
                             <thead>
                                 <tr>
-                                    <th style="width:31px"><input type="checkbox" onclick="$('tbody input[type=checkbox]', $(this).parents('table')).attr('checked', this.checked)"></th>
+                                    <th style="width:31px">
+                                        <input type="checkbox" data-action="check-all-projects"></th>
                                     <th>{% trans "Project Name" %}</th>
                                     <th style="width:150px;overflow:hidden;text-align:right">
                                         {% trans "Email Address" %}</th>
@@ -78,7 +65,9 @@
                         <td>{{ form.alert }}</td>
                         <td><label for="{{ form.alert.auto_id }}">{{ project.name }}</label></td>
                         <td style="text-align:right">
-                            <a href="javascript:void(0)" data-target="{{ form.email.auto_id }}" data-toggle="change-target-value">{% if form.email.value %}{{ form.email.value }}{% else %}Default{% endif %}</a>
+                            <a href="javascript:void(0)" data-target="{{ form.email.auto_id }}" data-toggle="change-target-value">
+                                {% if form.email.value %}{{ form.email.value }}{% else %}<em>Default</em>{% endif %}
+                            </a>
                             {{ form.email }}
                         </td>
                     </tr>
@@ -102,4 +91,22 @@
             <button type="submit" class="btn btn-primary">{% trans "Save Changes" %}</button>
         </fieldset>
     </form>
+    <script>
+    $(function(){
+        $('form a[data-toggle="change-target-value"]').click(function(){
+            var $this = $(this);
+            var $target = $('#' + $this.data('target'));
+            var result = window.prompt('Enter an email address', $target.val());
+            $target.val(result || '');
+            if (result) {
+                $this.text(result);
+            } else {
+                $this.html('<em>Default</em>');
+            }
+        });
+        $('input[data-action="check-all-projects"').click(function(){
+            $(this).parents('table').find('tbody input[type=checkbox]').prop('checked', $(this).prop('checked'))
+        });
+    });
+    </script>
 {% endblock %}
