commit c358b3f34e8c1591bef05fd68442d71add30a012
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Jan 10 20:56:16 2012 -0800

    Basic test for project.merge_to

diff --git a/tests/models/__init__.py b/tests/models/__init__.py
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/tests/models/tests.py b/tests/models/tests.py
new file mode 100644
index 0000000000..bddf469023
--- /dev/null
+++ b/tests/models/tests.py
@@ -0,0 +1,31 @@
+from __future__ import absolute_import
+
+
+from sentry.models import Project, Group, Event, \
+  MessageFilterValue, MessageCountByMinute, FilterValue
+
+from tests.base import TestCase
+
+
+class ProjectTest(TestCase):
+    fixtures = ['tests/fixtures/views.json']
+
+    def setUp(self):
+        self.project = Project.objects.get(id=1)
+
+    def test_migrate(self):
+        project2 = Project.objects.create(name='Test')
+        self.project.merge_to(project2)
+
+        self.assertFalse(Project.objects.filter(pk=1).exists())
+        self.assertFalse(Group.objects.filter(project__isnull=True).exists())
+        self.assertFalse(Event.objects.filter(project__isnull=True).exists())
+        self.assertFalse(MessageFilterValue.objects.filter(project__isnull=True).exists())
+        self.assertFalse(MessageCountByMinute.objects.filter(project__isnull=True).exists())
+        self.assertFalse(FilterValue.objects.filter(project__isnull=True).exists())
+
+        self.assertEquals(project2.group_set.count(), 4)
+        self.assertEquals(project2.event_set.count(), 10)
+        self.assertEquals(project2.messagefiltervalue_set.count(), 0)
+        self.assertEquals(project2.messagecountbyminute_set.count(), 0)
+        self.assertEquals(project2.filtervalue_set.count(), 0)
