commit 86514c5e8f2ec3d5cad0d2b0c5cf5e5d52686f33
Author: Dan Fuller <dfuller@sentry.io>
Date:   Wed May 8 17:38:43 2019 -0700

    feat(api): Add Incident models to deletion code

diff --git a/src/sentry/deletions/defaults/group.py b/src/sentry/deletions/defaults/group.py
index 71eec40464..75812a8be7 100644
--- a/src/sentry/deletions/defaults/group.py
+++ b/src/sentry/deletions/defaults/group.py
@@ -6,6 +6,7 @@ from ..base import ModelDeletionTask, ModelRelation
 class GroupDeletionTask(ModelDeletionTask):
     def get_child_relations(self, instance):
         from sentry import models
+        from sentry.incidents.models import IncidentGroup
 
         relations = []
 
@@ -30,6 +31,7 @@ class GroupDeletionTask(ModelDeletionTask):
             models.GroupSubscription,
             models.UserReport,
             models.EventAttachment,
+            IncidentGroup,
             # Event is last as its the most time consuming
             models.Event,
         )
diff --git a/src/sentry/deletions/defaults/organization.py b/src/sentry/deletions/defaults/organization.py
index 984fe114c7..38f8296305 100644
--- a/src/sentry/deletions/defaults/organization.py
+++ b/src/sentry/deletions/defaults/organization.py
@@ -10,6 +10,7 @@ class OrganizationDeletionTask(ModelDeletionTask):
             ReleaseCommit, ReleaseEnvironment, ReleaseFile, Distribution, ReleaseHeadCommit,
             Repository, Team, Project, PullRequest, Dashboard, DiscoverSavedQuery, ExternalIssue, PromptsActivity
         )
+        from sentry.incidents.models import Incident
 
         # Team must come first
         relations = [
@@ -35,6 +36,7 @@ class OrganizationDeletionTask(ModelDeletionTask):
             DiscoverSavedQuery,
             ExternalIssue,
             PromptsActivity,
+            Incident,
         )
         relations.extend([ModelRelation(m, {'organization_id': instance.id}) for m in model_list])
 
diff --git a/src/sentry/deletions/defaults/project.py b/src/sentry/deletions/defaults/project.py
index 9c25f30ae8..4ac5e034ad 100644
--- a/src/sentry/deletions/defaults/project.py
+++ b/src/sentry/deletions/defaults/project.py
@@ -6,6 +6,7 @@ from ..base import (BulkModelDeletionTask, ModelDeletionTask, ModelRelation)
 class ProjectDeletionTask(ModelDeletionTask):
     def get_child_relations(self, instance):
         from sentry import models
+        from sentry.incidents.models import IncidentProject
 
         relations = [
             # ProjectKey gets revoked immediately, in bulk
@@ -19,7 +20,7 @@ class ProjectDeletionTask(ModelDeletionTask):
             models.GroupHash, models.GroupRelease, models.GroupRuleStatus, models.GroupSeen,
             models.GroupShare, models.GroupSubscription, models.ProjectBookmark, models.ProjectKey,
             models.ProjectTeam, models.PromptsActivity, models.SavedSearchUserDefault, models.SavedSearch,
-            models.ServiceHook, models.UserReport, models.DiscoverSavedQueryProject,
+            models.ServiceHook, models.UserReport, models.DiscoverSavedQueryProject, IncidentProject
         )
 
         relations.extend(
