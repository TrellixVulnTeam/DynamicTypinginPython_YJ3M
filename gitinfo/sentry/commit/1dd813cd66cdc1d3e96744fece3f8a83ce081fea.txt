commit 1dd813cd66cdc1d3e96744fece3f8a83ce081fea
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Dec 10 17:02:52 2015 -0800

    Add test to cover grouping regression

diff --git a/tests/sentry/test_event_manager.py b/tests/sentry/test_event_manager.py
index cb5c97d33c..1b3da85421 100644
--- a/tests/sentry/test_event_manager.py
+++ b/tests/sentry/test_event_manager.py
@@ -35,6 +35,18 @@ class EventManagerTest(TransactionTestCase):
         result.update(kwargs)
         return result
 
+    def test_similar_message_prefix_doesnt_group(self):
+        # we had a regression which caused the default hash to just be
+        # 'event.message' instead of '[event.message]' which caused it to
+        # generate a hash per letter
+        manager = EventManager(self.make_event(message='foo bar'))
+        event1 = manager.save(1)
+
+        manager = EventManager(self.make_event(message='foo baz'))
+        event2 = manager.save(1)
+
+        assert event1.group_id != event2.group_id
+
     @patch('sentry.signals.regression_signal.send')
     def test_broken_regression_signal(self, send):
         send.side_effect = Exception()
