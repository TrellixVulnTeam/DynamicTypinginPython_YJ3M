commit 99686a6e2ee5cbaf8538b71f42b23e1588443d1d
Author: Danny Lee <dlee@sentry.io>
Date:   Mon Jan 13 14:46:12 2020 -0800

    feat(discover2): Add button in Issue to Discover (#16346)

diff --git a/src/sentry/static/sentry/app/views/organizationGroupDetails/actions.jsx b/src/sentry/static/sentry/app/views/organizationGroupDetails/actions.jsx
index 0993364190..93fbce4ffb 100644
--- a/src/sentry/static/sentry/app/views/organizationGroupDetails/actions.jsx
+++ b/src/sentry/static/sentry/app/views/organizationGroupDetails/actions.jsx
@@ -3,26 +3,29 @@ import PropTypes from 'prop-types';
 import React from 'react';
 import createReactClass from 'create-react-class';
 
-import {analytics} from 'app/utils/analytics';
+import GroupActions from 'app/actions/groupActions';
 import {openModal} from 'app/actionCreators/modal';
 import {t} from 'app/locale';
+import SentryTypes from 'app/sentryTypes';
+import IndicatorStore from 'app/stores/indicatorStore';
+import {analytics} from 'app/utils/analytics';
+import {uniqueId} from 'app/utils/guid';
 import withApi from 'app/utils/withApi';
-import Button from 'app/components/button';
-import DropdownLink from 'app/components/dropdownLink';
+import withOrganization from 'app/utils/withOrganization';
+import EventView from 'app/views/eventsV2/eventView';
+
 import Feature from 'app/components/acl/feature';
 import FeatureDisabled from 'app/components/acl/featureDisabled';
-import GroupActions from 'app/actions/groupActions';
-import GuideAnchor from 'app/components/assistant/guideAnchor';
 import IgnoreActions from 'app/components/actions/ignore';
-import IndicatorStore from 'app/stores/indicatorStore';
+import ResolveActions from 'app/components/actions/resolve';
+import GuideAnchor from 'app/components/assistant/guideAnchor';
+import Button from 'app/components/button';
+import DropdownLink from 'app/components/dropdownLink';
+import Link from 'app/components/links/link';
 import LinkWithConfirmation from 'app/components/links/linkWithConfirmation';
 import MenuItem from 'app/components/menuItem';
-import ResolveActions from 'app/components/actions/resolve';
-import SentryTypes from 'app/sentryTypes';
 import ShareIssue from 'app/components/shareIssue';
 import space from 'app/styles/space';
-import {uniqueId} from 'app/utils/guid';
-import withOrganization from 'app/utils/withOrganization';
 
 class DeleteActions extends React.Component {
   static propTypes = {
@@ -133,6 +136,30 @@ const GroupDetailsActions = createReactClass({
     return `${protocol}//${host}${path}`;
   },
 
+  getDiscoverUrl() {
+    const {group, project, organization} = this.props;
+
+    const discoverQuery = {
+      id: undefined,
+      name: group.title || group.type,
+      fields: ['title', 'url', 'count(id)', 'project', 'last_seen'],
+      widths: [400, 200, -1, 200, -1],
+      orderby: '-count_id',
+      query: `issue.id:${group.id}`,
+      tags: ['environment', 'release', 'event.type', 'user.email'],
+      projects: [project.id],
+      version: 2,
+      range: '24h',
+    };
+
+    const discoverView = EventView.fromSavedQuery(discoverQuery);
+
+    return {
+      pathname: `/organizations/${organization.slug}/eventsv2/results/`,
+      query: discoverView.generateQueryStringObject(),
+    };
+  },
+
   onDelete() {
     const {group, project, organization} = this.props;
     const loadingIndicator = IndicatorStore.add(t('Delete event..'));
@@ -232,7 +259,8 @@ const GroupDetailsActions = createReactClass({
     const {group, project, organization} = this.props;
     const orgFeatures = new Set(organization.features);
 
-    let bookmarkClassName = 'group-bookmark btn btn-default btn-sm';
+    const buttonClassName = 'btn btn-default btn-sm';
+    let bookmarkClassName = `group-bookmark ${buttonClassName}`;
     if (group.isBookmarked) {
       bookmarkClassName += ' active';
     }
@@ -253,17 +281,19 @@ const GroupDetailsActions = createReactClass({
           isResolved={isResolved}
           isAutoResolved={isResolved && group.statusDetails.autoResolved}
         />
+
         <IgnoreActions isIgnored={isIgnored} onUpdate={this.onUpdate} />
 
         <div className="btn-group">
-          <a
+          <div
             className={bookmarkClassName}
             title={t('Bookmark')}
             onClick={this.onToggleBookmark}
           >
             <span className="icon-star-solid" />
-          </a>
+          </div>
         </div>
+
         <DeleteActions
           organization={organization}
           project={project}
@@ -283,6 +313,18 @@ const GroupDetailsActions = createReactClass({
             />
           </div>
         )}
+
+        {orgFeatures.has('events-v2') && (
+          <div className="btn-group">
+            <Link
+              className={buttonClassName}
+              title={t('Open in Discover')}
+              to={this.getDiscoverUrl()}
+            >
+              {t('Open in Discover')}
+            </Link>
+          </div>
+        )}
       </div>
     );
   },
