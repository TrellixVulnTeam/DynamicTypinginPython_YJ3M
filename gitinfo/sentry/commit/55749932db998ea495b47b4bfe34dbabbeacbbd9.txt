commit 55749932db998ea495b47b4bfe34dbabbeacbbd9
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Apr 3 12:32:09 2015 -0700

    Allow quotas to be disabled via feature flag
    
    This currently does not completely disable the setting (i.e. if a value was already present).

diff --git a/src/sentry/conf/server.py b/src/sentry/conf/server.py
index 908b04c517..02668aea9e 100644
--- a/src/sentry/conf/server.py
+++ b/src/sentry/conf/server.py
@@ -539,6 +539,7 @@ SENTRY_FEATURES = {
     'social-auth:register': True,
     'organizations:create': True,
     'organizations:sso': False,
+    'projects:quotas': True,
     'teams:create': True,
 }
 
diff --git a/src/sentry/features/__init__.py b/src/sentry/features/__init__.py
index 2235c54402..288d5fa9c5 100644
--- a/src/sentry/features/__init__.py
+++ b/src/sentry/features/__init__.py
@@ -11,6 +11,7 @@ default_manager.add('social-auth:register')
 default_manager.add('organizations:create')
 default_manager.add('organizations:sso', OrganizationFeature)
 default_manager.add('teams:create', OrganizationFeature)
+default_manager.add('projects:quotas', ProjectFeature)
 
 # expose public api
 add = default_manager.add
diff --git a/src/sentry/features/base.py b/src/sentry/features/base.py
index 69be622ef0..8f232e8b7d 100644
--- a/src/sentry/features/base.py
+++ b/src/sentry/features/base.py
@@ -1,6 +1,6 @@
 from __future__ import absolute_import
 
-__all__ = ['Feature', 'OrganizationFeature']
+__all__ = ['Feature', 'OrganizationFeature', 'ProjectFeature']
 
 
 class Feature(object):
@@ -22,3 +22,9 @@ class OrganizationFeature(Feature):
     def __init__(self, name, organization):
         self.name = name
         self.organization = organization
+
+
+class ProjectFeature(Feature):
+    def __init__(self, name, project):
+        self.name = name
+        self.project = project
diff --git a/src/sentry/templates/sentry/projects/manage.html b/src/sentry/templates/sentry/projects/manage.html
index 6016be265b..00858a098c 100644
--- a/src/sentry/templates/sentry/projects/manage.html
+++ b/src/sentry/templates/sentry/projects/manage.html
@@ -2,6 +2,7 @@
 
 {% load crispy_forms_tags %}
 {% load i18n %}
+{% load sentry_features %}
 {% load sentry_helpers %}
 {% load sentry_plugins %}
 
@@ -77,9 +78,11 @@
         <li{% if page == 'notifications' %} class="active"{% endif %}>
             <a href="{% url 'sentry-project-notifications' project.organization.slug project.slug %}">{% trans "Notifications" %}</a>
         </li>
+        {% feature projects:quotas project %}
         <li{% if page == 'quotas' %} class="active"{% endif %}>
             <a href="{% url 'sentry-manage-project-quotas' project.organization.slug project.slug %}">{% trans "Rate Limits" %}</a>
         </li>
+        {% endfeature %}
         <li{% if page == 'rules' %} class="active"{% endif %}>
             <a href="{% url 'sentry-project-rules' project.organization.slug project.slug %}">{% trans "Rules" %}</a>
         </li>
diff --git a/src/sentry/web/frontend/projects/quotas.py b/src/sentry/web/frontend/projects/quotas.py
index 02c382f424..3806fc2d64 100644
--- a/src/sentry/web/frontend/projects/quotas.py
+++ b/src/sentry/web/frontend/projects/quotas.py
@@ -12,16 +12,27 @@ from django.core.urlresolvers import reverse
 from django.http import HttpResponseRedirect
 from django.utils.translation import ugettext_lazy as _
 
-from sentry import app
+from sentry import app, features
 from sentry.constants import MEMBER_ADMIN
+from sentry.quotas.base import Quota
 from sentry.web.decorators import has_access
 from sentry.web.forms.projects import ProjectQuotasForm
 from sentry.web.helpers import render_to_response
 
 
+ERR_NO_SSO = _('The quotas feature is not enabled for this project.')
+
+
 @has_access(MEMBER_ADMIN)
 def manage_project_quotas(request, organization, project):
-    from sentry.quotas.base import Quota
+    if not features.has('projects:quotas', project, actor=request.user):
+        messages.add_message(
+            request, messages.ERROR,
+            ERR_NO_SSO,
+        )
+        redirect = reverse('sentry-manage-project',
+                           args=[organization.slug, project.slug])
+        return HttpResponseRedirect(redirect)
 
     form = ProjectQuotasForm(project, request.POST or None)
 
