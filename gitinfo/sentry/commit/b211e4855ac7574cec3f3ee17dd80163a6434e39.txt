commit b211e4855ac7574cec3f3ee17dd80163a6434e39
Author: David Cramer <dcramer@gmail.com>
Date:   Thu Apr 30 12:24:36 2015 -0700

    Dont store inlined sourcemaps as url

diff --git a/src/sentry/lang/javascript/processor.py b/src/sentry/lang/javascript/processor.py
index 02dc75ad04..d0f71fc0bf 100644
--- a/src/sentry/lang/javascript/processor.py
+++ b/src/sentry/lang/javascript/processor.py
@@ -467,13 +467,19 @@ class SourceProcessor(object):
             if sourcemap_idx and frame.colno is not None:
                 last_state = state
                 state = find_source(sourcemap_idx, frame.lineno, frame.colno)
+
+                if is_data_uri(sourcemap_url):
+                    sourcemap_label = frame.abs_path
+                else:
+                    sourcemap_label = sourcemap_url
+
                 abs_path = urljoin(sourcemap_url, state.src)
 
                 logger.debug('Mapping compressed source %r to mapping in %r', frame.abs_path, abs_path)
                 source = cache.get(abs_path)
                 if not source:
                     frame.data = {
-                        'sourcemap': sourcemap_url,
+                        'sourcemap': sourcemap_label,
                     }
                     errors = cache.get_errors(abs_path)
                     if errors:
@@ -490,7 +496,7 @@ class SourceProcessor(object):
                     'orig_function': frame.function,
                     'orig_abs_path': frame.abs_path,
                     'orig_filename': frame.filename,
-                    'sourcemap': sourcemap_url,
+                    'sourcemap': sourcemap_label,
                 }
 
                 # SourceMap's return zero-indexed lineno's
diff --git a/tests/sentry/lang/javascript/test_plugin.py b/tests/sentry/lang/javascript/test_plugin.py
index 859a9c176b..18b7bc3d9a 100644
--- a/tests/sentry/lang/javascript/test_plugin.py
+++ b/tests/sentry/lang/javascript/test_plugin.py
@@ -119,6 +119,7 @@ class JavascriptIntegrationTest(TestCase):
         assert not frame.pre_context
         assert frame.context_line == 'console.log("hello, World!")'
         assert not frame.post_context
+        assert frame.data['sourcemap'] == 'http://example.com/test.min.js'
 
     @responses.activate
     def test_sourcemap_source_expansion(self):
