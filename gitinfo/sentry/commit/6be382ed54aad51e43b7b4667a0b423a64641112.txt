commit 6be382ed54aad51e43b7b4667a0b423a64641112
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Dec 26 06:19:23 2011 -0800

    Dashboard now shows sparklines for each project

diff --git a/bootstrap/lib/sentry.less b/bootstrap/lib/sentry.less
index 83605e6277..56008a0a4d 100644
--- a/bootstrap/lib/sentry.less
+++ b/bootstrap/lib/sentry.less
@@ -88,7 +88,7 @@
 
 // Sparkline (page header)
 
-.sparkline {
+.main-header .sparkline {
   left: 0;
   position: absolute;
   width: 100%;
@@ -154,4 +154,23 @@ table.vars {
 }
 .module-content table pre {
   margin-bottom: 0;
-}
\ No newline at end of file
+}
+
+// Sparkline grid
+
+.innerColumn(@columnSpan: 1) {
+  width: ((@gridColumnWidth) * @columnSpan) + (@gridGutterWidth * (@columnSpan - 1)) - 10;
+}
+
+.sparkline-grid {
+  .media-grid;
+  a {
+    .innerColumn(4);
+    height: 160px;
+    display: inline-block;
+    text-align: center;
+  }
+  .sparkline {
+    height: 120px;
+  }
+}
diff --git a/sentry/static/styles/bootstrap.css b/sentry/static/styles/bootstrap.css
index 26d84516dd..b656304d74 100644
--- a/sentry/static/styles/bootstrap.css
+++ b/sentry/static/styles/bootstrap.css
@@ -6,7 +6,7 @@
  * http://www.apache.org/licenses/LICENSE-2.0
  *
  * Designed and built with all the love in the world @twitter by @mdo and @fat.
- * Date: Mon Dec 26 06:01:56 PST 2011
+ * Date: Mon Dec 26 06:19:02 PST 2011
  */
 /* Reset.less
  * Props to Eric Meyer (meyerweb.com) for his CSS reset file. We're using an adapted version here	that cuts out some of the reset HTML elements we will never need here (i.e., dfn, samp, etc).
@@ -2612,7 +2612,7 @@ button.btn::-moz-focus-inner, input[type=submit].btn::-moz-focus-inner {
 .main-header h1 {
   margin-bottom: 8px;
 }
-.sparkline {
+.main-header .sparkline {
   left: 0;
   position: absolute;
   width: 100%;
@@ -2674,3 +2674,49 @@ table.vars th, table.vars td {
 .module-content table pre {
   margin-bottom: 0;
 }
+.sparkline-grid {
+  margin-left: -20px;
+  margin-bottom: 0;
+  zoom: 1;
+}
+.sparkline-grid:before, .sparkline-grid:after {
+  display: table;
+  content: "";
+  zoom: 1;
+}
+.sparkline-grid:after {
+  clear: both;
+}
+.sparkline-grid li {
+  display: inline;
+}
+.sparkline-grid a {
+  float: left;
+  padding: 4px;
+  margin: 0 0 18px 20px;
+  border: 1px solid #ddd;
+  -webkit-border-radius: 4px;
+  -moz-border-radius: 4px;
+  border-radius: 4px;
+  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075);
+  -moz-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075);
+  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075);
+}
+.sparkline-grid a img {
+  display: block;
+}
+.sparkline-grid a:hover {
+  border-color: #0069d6;
+  -webkit-box-shadow: 0 1px 4px rgba(0, 105, 214, 0.25);
+  -moz-box-shadow: 0 1px 4px rgba(0, 105, 214, 0.25);
+  box-shadow: 0 1px 4px rgba(0, 105, 214, 0.25);
+}
+.sparkline-grid a {
+  width: 250px;
+  height: 160px;
+  display: inline-block;
+  text-align: center;
+}
+.sparkline-grid .sparkline {
+  height: 120px;
+}
diff --git a/sentry/static/styles/bootstrap.min.css b/sentry/static/styles/bootstrap.min.css
index ac650a1d06..b277991cfe 100644
--- a/sentry/static/styles/bootstrap.min.css
+++ b/sentry/static/styles/bootstrap.min.css
@@ -374,7 +374,7 @@ button.btn::-moz-focus-inner,input[type=submit].btn::-moz-focus-inner{padding:0;
 .topbar input:hover{background-color:#444;background-color:rgba(255, 255, 255, 0.3);color:#404040;}
 .topbar input:focus,.topbar input.focused{background-color:#444;background-color:rgba(255, 255, 255, 0.3);font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:normal;font-weight:13px;line-height:1;padding:4px 9px;color:#ffffff;color:rgba(255, 255, 255, 0.75);border:1px solid #111;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;-webkit-box-shadow:inset 0 1px 2px rgba(0, 0, 0, 0.1),0 1px 0px rgba(255, 255, 255, 0.25);-moz-box-shadow:inset 0 1px 2px rgba(0, 0, 0, 0.1),0 1px 0px rgba(255, 255, 255, 0.25);box-shadow:inset 0 1px 2px rgba(0, 0, 0, 0.1),0 1px 0px rgba(255, 255, 255, 0.25);-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none;transition:none;color:#bfbfbf;text-shadow:none;}
 .main-header{background-color:#f5f5f5;padding:10px 20px 0px;margin:-20px -20px 20px;border-bottom:1px solid #ddd;-webkit-box-shadow:0 1px 0 rgba(255, 255, 255, 0.5);-moz-box-shadow:0 1px 0 rgba(255, 255, 255, 0.5);box-shadow:0 1px 0 rgba(255, 255, 255, 0.5);position:relative;}.main-header h1{margin-bottom:8px;}
-.sparkline{left:0;position:absolute;width:100%;filter:alpha(opacity=60);-khtml-opacity:0.6;-moz-opacity:0.6;opacity:0.6;}
+.main-header .sparkline{left:0;position:absolute;width:100%;filter:alpha(opacity=60);-khtml-opacity:0.6;-moz-opacity:0.6;opacity:0.6;}
 ol.context{margin:0;list-style-position:inside;border:1px solid #ccc;border:1px solid rgba(0, 0, 0, 0.15);-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;}ol.context>li{padding-left:20px;font-family:monospace;white-space:pre;color:rgba(0, 0, 0, 0.75);background-color:#f5f5f5;}ol.context>li>pre{background-color:inherit;color:rgba(0, 0, 0, 0.5);margin:0;padding:0;border:0;display:block;line-height:18px;font-size:12px;white-space:pre;white-space:pre-wrap;word-wrap:break-word;}
 ol.context>li.active{background-color:#ddd;}ol.context>li.active pre{color:#000000;}
 ol.context-line>li>span{float:right;}
@@ -382,3 +382,10 @@ ol.context-line>li>span{float:right;}
 table.vars th,table.vars td{padding:5px 5px 4px;}
 .module{margin-bottom:20px;}
 .module-content table pre{margin-bottom:0;}
+.sparkline-grid{margin-left:-20px;margin-bottom:0;zoom:1;}.sparkline-grid:before,.sparkline-grid:after{display:table;content:"";zoom:1;}
+.sparkline-grid:after{clear:both;}
+.sparkline-grid li{display:inline;}
+.sparkline-grid a{float:left;padding:4px;margin:0 0 18px 20px;border:1px solid #ddd;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;-webkit-box-shadow:0 1px 1px rgba(0, 0, 0, 0.075);-moz-box-shadow:0 1px 1px rgba(0, 0, 0, 0.075);box-shadow:0 1px 1px rgba(0, 0, 0, 0.075);}.sparkline-grid a img{display:block;}
+.sparkline-grid a:hover{border-color:#0069d6;-webkit-box-shadow:0 1px 4px rgba(0, 105, 214, 0.25);-moz-box-shadow:0 1px 4px rgba(0, 105, 214, 0.25);box-shadow:0 1px 4px rgba(0, 105, 214, 0.25);}
+.sparkline-grid a{width:250px;height:160px;display:inline-block;text-align:center;}
+.sparkline-grid .sparkline{height:120px;}
diff --git a/sentry/templates/sentry/dashboard.html b/sentry/templates/sentry/dashboard.html
index 3a62d30e30..537d872b43 100644
--- a/sentry/templates/sentry/dashboard.html
+++ b/sentry/templates/sentry/dashboard.html
@@ -8,11 +8,73 @@
 
 {% block content %}
     <div class="span16">
-        <p>Select a project to view the stream of events...</p>
-        <ul>
+        <div class="alert-message info">Select a project to view the stream of events...</div>
+        <ul class="sparkline-grid">
             {% for project in project_list.itervalues %}
-                <li><a href="{% url sentry project.pk %}">{{ project.name }}</a></li>
+                <li>
+                    <a href="{% url sentry project.pk %}">
+                        <h3>{{ project.name }}</h3>
+                        <div class="sparkline" data-project="{{ project.pk }}" data-api-url="{% url sentry-ajax project.pk %}"></div>
+                    </a>
+                </li>
             {% endfor %}
         </ul>
     </div>
 {% endblock %}
+
+
+{% block content_after %}
+    <script type="text/javascript">
+    $(document).ready(function() {
+        $('.sparkline-grid .sparkline').each(function(_, el){
+            var $el = $(el);
+
+            $.ajax({
+                url: $el.attr('data-api-url'),
+                type: 'get',
+                dataType: 'json',
+                data: {
+                    op: 'chart',
+                    days: 1
+                },
+                success: function(data){
+                    if (!data.length) {
+                        return;
+                    }
+
+                    var start = new Date().getTime() - data.length * 3600000;
+                    var pairs = [];
+                    // for (var i=0; i<1000; i++) {
+                    //     pairs.push([start + (3600 * 1000) * i, Math.random()*1000]);
+                    // }
+                    for (var i=0; i<data.length; i++) {
+                        pairs.push([start + (3600 * 1000) * i, data[i]]);
+                    }
+                    $.plot($el, [
+                        {
+                            data: pairs,
+                            color: '#3079d0',
+                            shadowSize: 0,
+                            lines: {
+                                lineWidth: 1,
+                                show: true,
+                                fill: true
+                            },
+                        }
+                    ], {
+                        xaxis: {
+                           mode: "time"
+                        },
+                        grid: {
+                            show: false,
+                            backgroundColor: '#eeeeee'
+                        },
+                        lines: { show: false }
+
+                    });
+                }
+            });
+        });
+    });
+    </script>
+{% endblock %}
\ No newline at end of file
