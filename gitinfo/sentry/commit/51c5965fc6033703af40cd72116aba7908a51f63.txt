commit 51c5965fc6033703af40cd72116aba7908a51f63
Author: Bruno Garcia <github@brunogarcia.com>
Date:   Mon Nov 12 14:26:03 2018 +0100

    fix: Work with minidump as buffer (#10527)

diff --git a/src/sentry/lang/native/minidump.py b/src/sentry/lang/native/minidump.py
index 31af177ce3..5580f1901b 100644
--- a/src/sentry/lang/native/minidump.py
+++ b/src/sentry/lang/native/minidump.py
@@ -1,6 +1,5 @@
 from __future__ import absolute_import
 
-import six
 from django.core.files.uploadedfile import InMemoryUploadedFile, TemporaryUploadedFile
 
 from symbolic import arch_from_breakpad, ProcessState, id_from_breakpad
@@ -29,10 +28,8 @@ def process_minidump(minidump, cfi=None):
         return ProcessState.from_minidump_buffer(minidump.read(), cfi)
     elif isinstance(minidump, TemporaryUploadedFile):
         return ProcessState.from_minidump(minidump.temporary_file_path(), cfi)
-    elif isinstance(minidump, six.binary_type) and minidump.startswith('MDMP'):
-        return ProcessState.from_minidump_buffer(minidump, cfi)
     else:
-        return ProcessState.from_minidump(minidump, cfi)
+        return ProcessState.from_minidump_buffer(minidump, cfi)
 
 
 def merge_minidump_event(data, minidump, cfi=None):
diff --git a/tests/sentry/lang/native/test_minidump.py b/tests/sentry/lang/native/test_minidump.py
index 7dbac54887..4ef1eaf463 100644
--- a/tests/sentry/lang/native/test_minidump.py
+++ b/tests/sentry/lang/native/test_minidump.py
@@ -57,7 +57,8 @@ def test_is_minidump():
 def test_minidump_linux():
     event = {'release': 'test-1.0.0'}
     minidump = os.path.join(os.path.dirname(__file__), 'fixtures', 'linux.dmp')
-    merge_minidump_event(event, minidump)
+    with open(minidump, 'rb') as f:
+        merge_minidump_event(event, f.read())
 
     assert event == {
         'contexts': {
@@ -287,7 +288,8 @@ def test_minidump_linux():
 def test_minidump_macos():
     event = {'release': 'test-1.0.0'}
     minidump = os.path.join(os.path.dirname(__file__), 'fixtures', 'macos.dmp')
-    merge_minidump_event(event, minidump)
+    with open(minidump, 'rb') as f:
+        merge_minidump_event(event, f.read())
 
     assert event == {
         'contexts': {
@@ -678,7 +680,8 @@ def test_minidump_macos():
 def test_minidump_windows():
     event = {'release': 'test-1.0.0'}
     minidump = os.path.join(os.path.dirname(__file__), 'fixtures', 'windows.dmp')
-    merge_minidump_event(event, minidump)
+    with open(minidump, 'rb') as f:
+        merge_minidump_event(event, f.read())
 
     assert event == {
         'contexts': {
