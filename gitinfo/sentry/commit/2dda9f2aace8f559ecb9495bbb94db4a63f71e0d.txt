commit 2dda9f2aace8f559ecb9495bbb94db4a63f71e0d
Author: William Mak <william@wmak.io>
Date:   Wed Nov 20 17:47:46 2019 -0500

    fix(projects): Allow subject prefix to be blank (#15698)
    
    * fix(projects): Allow subject prefix to be blank
    
    - This allows the field to be emptied again
        - currently the field starts empty, but if you enter text and empty
          it again the field will error.

diff --git a/src/sentry/api/endpoints/project_details.py b/src/sentry/api/endpoints/project_details.py
index 426c723722..986e740bea 100644
--- a/src/sentry/api/endpoints/project_details.py
+++ b/src/sentry/api/endpoints/project_details.py
@@ -94,7 +94,7 @@ class ProjectAdminSerializer(ProjectMemberSerializer):
     team = serializers.RegexField(r"^[a-z0-9_\-]+$", max_length=50)
     digestsMinDelay = serializers.IntegerField(min_value=60, max_value=3600)
     digestsMaxDelay = serializers.IntegerField(min_value=60, max_value=3600)
-    subjectPrefix = serializers.CharField(max_length=200)
+    subjectPrefix = serializers.CharField(max_length=200, allow_blank=True)
     subjectTemplate = serializers.CharField(max_length=200)
     securityToken = serializers.RegexField(
         r"^[-a-zA-Z0-9+/=\s]+$", max_length=255, allow_blank=True
diff --git a/tests/sentry/api/endpoints/test_project_details.py b/tests/sentry/api/endpoints/test_project_details.py
index 5ce63d88d5..ae62dcfd9d 100644
--- a/tests/sentry/api/endpoints/test_project_details.py
+++ b/tests/sentry/api/endpoints/test_project_details.py
@@ -102,6 +102,18 @@ class ProjectUpdateTest(APITestCase):
         )
         self.login_as(user=self.user)
 
+    def test_blank_subject_prefix(self):
+        project = Project.objects.get(id=self.project.id)
+        options = {"mail:subject_prefix": "[Sentry]"}
+        resp = self.client.put(self.path, data={"options": options})
+        assert resp.status_code == 200, resp.content
+        assert project.get_option("mail:subject_prefix") == "[Sentry]"
+
+        options["mail:subject_prefix"] = ""
+        resp = self.client.put(self.path, data={"options": options})
+        assert resp.status_code == 200, resp.content
+        assert project.get_option("mail:subject_prefix") == ""
+
     def test_team_changes_deprecated(self):
         project = self.create_project()
         team = self.create_team(members=[self.user])
