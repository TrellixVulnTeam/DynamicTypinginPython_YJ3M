commit 6d8102c2219715b5869cfb928c3450e923cd5322
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Sep 24 19:04:38 2010 -0700

    Fix output of data with transform and types

diff --git a/sentry/client/base.py b/sentry/client/base.py
index a9b75d553a..cb3c02c8f6 100644
--- a/sentry/client/base.py
+++ b/sentry/client/base.py
@@ -39,7 +39,8 @@ class SentryClient(object):
             kwargs = filter_(None).process(kwargs) or kwargs
         
         # Make sure all additional data is coerced
-        kwargs['data'] = transform(kwargs['data'])
+        if 'data' in kwargs:
+            kwargs['data'] = transform(kwargs['data'])
 
         return self.send(**kwargs)
 
diff --git a/sentry/helpers.py b/sentry/helpers.py
index 085d2ba163..80188cb3df 100644
--- a/sentry/helpers.py
+++ b/sentry/helpers.py
@@ -59,10 +59,8 @@ def transform(value):
     elif isinstance(value, dict):
         return dict((k, transform(v)) for k, v in value.iteritems())
     elif not isinstance(value, (int, bool, basestring)) and value is not None:
-        return unicode(value)
-    else:
-        # return the type of the object since we cant guarantee we're able to pickle it
-        return type(value)
+        return unicode(type(value))
+    return value
 
 def get_installed_apps():
     """
diff --git a/sentry/tests/tests.py b/sentry/tests/tests.py
index 4bd96c3982..564747e9fc 100644
--- a/sentry/tests/tests.py
+++ b/sentry/tests/tests.py
@@ -728,7 +728,7 @@ class SentryMailTest(TestCase):
         out = mail.outbox[0]
 
         self.assertTrue('Traceback (most recent call last):' in out.body)
-        self.assertTrue("COOKIES:{'commenter_name': 'admin'," in out.body)
+        self.assertTrue("COOKIES:{'commenter_name': 'admin'," in out.body, out.body)
         self.assertEquals(out.subject, '[Django] Error (EXTERNAL IP): /group/1')
 
     def test_mail_on_creation(self):
