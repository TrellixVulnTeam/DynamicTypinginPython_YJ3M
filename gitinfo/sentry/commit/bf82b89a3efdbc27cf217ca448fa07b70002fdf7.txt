commit bf82b89a3efdbc27cf217ca448fa07b70002fdf7
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Dec 23 19:38:55 2014 -0800

    Correct NotifyEventService action

diff --git a/src/sentry/rules/actions/notify_event_service.py b/src/sentry/rules/actions/notify_event_service.py
index 58d79f05de..1599a14d18 100644
--- a/src/sentry/rules/actions/notify_event_service.py
+++ b/src/sentry/rules/actions/notify_event_service.py
@@ -11,6 +11,7 @@ from __future__ import absolute_import
 from django import forms
 
 from sentry.plugins import plugins
+from sentry.plugins.bases.notify import Notification
 from sentry.rules.actions.base import EventAction
 
 
@@ -51,7 +52,8 @@ class NotifyEventServiceAction(EventAction):
             self.logger.info('Rule failed should_notify check')
             return
 
-        plugin.notify_users(group=group, event=event)
+        notification = Notification(event=event, rule=self.rule)
+        plugin.notify(notification)
 
     def get_plugins(self):
         from sentry.plugins.bases.notify import NotificationPlugin
diff --git a/tests/sentry/rules/actions/test_notify_event_service.py b/tests/sentry/rules/actions/test_notify_event_service.py
index 505a506911..d85fa6b1c3 100644
--- a/tests/sentry/rules/actions/test_notify_event_service.py
+++ b/tests/sentry/rules/actions/test_notify_event_service.py
@@ -7,8 +7,8 @@ from sentry.rules.actions.notify_event_service import NotifyEventServiceAction
 class NotifyEventServiceActionTest(RuleTestCase):
     rule_cls = NotifyEventServiceAction
 
-    @patch('sentry.plugins.sentry_mail.models.MailPlugin.notify_users')
-    def test_applies_correctly(self, mail_notify_users):
+    @patch('sentry.plugins.sentry_mail.models.MailPlugin.notify')
+    def test_applies_correctly(self, mail_notify):
         event = self.get_event()
 
         rule = self.get_rule({
@@ -16,4 +16,4 @@ class NotifyEventServiceActionTest(RuleTestCase):
         })
         rule.after(event=event, state=self.get_state())
 
-        mail_notify_users.assert_called_once_with(group=event.group, event=event)
+        mail_notify.assert_called_once()
