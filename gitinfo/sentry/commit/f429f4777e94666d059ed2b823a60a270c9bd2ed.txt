commit f429f4777e94666d059ed2b823a60a270c9bd2ed
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Sep 7 16:46:42 2016 -0700

    Configurable phantomjs path

diff --git a/setup.cfg b/setup.cfg
index 69cf1291b5..868d2ae3e2 100644
--- a/setup.cfg
+++ b/setup.cfg
@@ -4,6 +4,7 @@ addopts = --tb=native -p no:doctest
 norecursedirs = bin dist docs htmlcov script hooks node_modules .* {args}
 looponfailroots = src/sentry tests
 selenium_driver = phantomjs
+phantomjs_path = node_modules/phantomjs-prebuilt/bin/phantomjs
 
 [flake8]
 ignore = F999,E501,E128,E124,E402,W503,E731,C901
diff --git a/src/sentry/utils/pytest/selenium.py b/src/sentry/utils/pytest/selenium.py
index ebca0daee3..fd78a3abd5 100644
--- a/src/sentry/utils/pytest/selenium.py
+++ b/src/sentry/utils/pytest/selenium.py
@@ -127,6 +127,9 @@ def pytest_addoption(parser):
     group._addoption('--selenium-driver',
                      dest='selenium_driver',
                      help='selenium driver (phantomjs or firefox)')
+    group._addoption('--phantomjs-path',
+                     dest='phantomjs_path',
+                     help='path to phantomjs driver')
 
 
 def pytest_configure(config):
@@ -161,12 +164,14 @@ def browser(request, percy, live_server):
     if driver_type == 'firefox':
         driver = webdriver.Firefox()
     elif driver_type == 'phantomjs':
-        phantomjs_path = os.path.join(
-            settings.NODE_MODULES_ROOT,
-            'phantomjs-prebuilt',
-            'bin',
-            'phantomjs',
-        )
+        phantomjs_path = request.config.getoption('phantomjs_path')
+        if not phantomjs_path:
+            phantomjs_path = os.path.join(
+                'node_modules',
+                'phantomjs-prebuilt',
+                'bin',
+                'phantomjs',
+            )
         driver = webdriver.PhantomJS(executable_path=phantomjs_path)
         driver.set_window_size(1280, 800)
     else:
