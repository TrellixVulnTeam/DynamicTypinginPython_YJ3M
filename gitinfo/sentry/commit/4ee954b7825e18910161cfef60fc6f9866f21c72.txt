commit 4ee954b7825e18910161cfef60fc6f9866f21c72
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Feb 15 11:45:56 2016 -0800

    Handle bulk delete on release objects

diff --git a/src/sentry/tasks/deletion.py b/src/sentry/tasks/deletion.py
index 9daea1631b..7073f19152 100644
--- a/src/sentry/tasks/deletion.py
+++ b/src/sentry/tasks/deletion.py
@@ -94,8 +94,8 @@ def delete_project(object_id, continuous=True, **kwargs):
         Activity, EventMapping, Group, GroupAssignee, GroupBookmark,
         GroupEmailThread, GroupHash, GroupMeta, GroupResolution,
         GroupRuleStatus, GroupSeen, GroupTagKey, GroupTagValue, Project,
-        ProjectKey, ProjectStatus, SavedSearchUserDefault, SavedSearch, TagKey,
-        TagValue, UserReport
+        ProjectKey, ProjectStatus, Release, ReleaseFile, SavedSearchUserDefault,
+        SavedSearch, TagKey, TagValue, UserReport
     )
 
     try:
@@ -140,13 +140,16 @@ def delete_project(object_id, continuous=True, **kwargs):
             delete_project.delay(object_id=object_id, countdown=15)
         return
 
-    model_list = (Group,)
+    # Release needs to handle deletes after Group is cleaned up as the foreign
+    # key is protected
+    model_list = (Group, ReleaseFile, Release)
     for model in model_list:
         has_more = bulk_delete_objects(model, project_id=p.id, logger=logger)
         if has_more:
             if continuous:
                 delete_project.delay(object_id=object_id, countdown=15)
             return
+
     p.delete()
 
 
