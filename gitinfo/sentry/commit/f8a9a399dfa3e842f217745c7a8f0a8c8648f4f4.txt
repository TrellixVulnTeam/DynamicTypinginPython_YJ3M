commit f8a9a399dfa3e842f217745c7a8f0a8c8648f4f4
Author: David Cramer <dcramer@gmail.com>
Date:   Sat Nov 24 11:26:15 2012 -0800

    Add crossdomain.xml index

diff --git a/src/sentry/web/api.py b/src/sentry/web/api.py
index 800422075b..421d06443d 100644
--- a/src/sentry/web/api.py
+++ b/src/sentry/web/api.py
@@ -570,6 +570,14 @@ def search_tags(request, project):
     return response
 
 
+def crossdomain_xml_index(request):
+    response = HttpResponse("""<cross-domain-policy>
+        <site-control permitted-cross-domain-policies="all"></site-control>
+    </cross-domain-policy>""")
+    response['Content-Type'] = 'application/xml'
+    return response
+
+
 @has_access
 def crossdomain_xml(request, project):
     origin_list = get_origins(project)
diff --git a/src/sentry/web/urls.py b/src/sentry/web/urls.py
index ae6f566ffe..2c4c6ed973 100644
--- a/src/sentry/web/urls.py
+++ b/src/sentry/web/urls.py
@@ -118,7 +118,7 @@ urlpatterns = patterns('',
     url(r'^manage/plugins/(?P<slug>[\w_-]+)/$', admin.configure_plugin, name='sentry-admin-configure-plugin'),
 
     # API / JS
-
+    url(r'^crossdomain\.xml$', api.crossdomain_xml_index, name='sentry-api-crossdomain-xml-index'),
     url(r'^api/store/$', api.StoreView.as_view(), name='sentry-api-store'),
     url(r'^api/notification/$', api.notification, name='sentry-api-notification'),
     url(r'^api/(?P<project_id>[\w_-]+)/crossdomain\.xml$', api.crossdomain_xml, name='sentry-api-crossdomain-xml'),
diff --git a/tests/sentry/web/api/tests.py b/tests/sentry/web/api/tests.py
index 5712dbf273..07d128a8f4 100644
--- a/tests/sentry/web/api/tests.py
+++ b/tests/sentry/web/api/tests.py
@@ -54,3 +54,15 @@ class CrossDomainXmlTest(TestCase):
         self.assertEquals(resp['Content-Type'], 'application/xml')
         self.assertTemplateUsed(resp, 'sentry/crossdomain.xml')
         self.assertIn('<allow-http-request-headers-from domain="*" headers="X-Sentry-Auth" secure="true"></allow-http-request-headers-from>', resp.content)
+
+
+class CrossDomainXmlIndexTest(TestCase):
+    @fixture
+    def path(self):
+        return reverse('sentry-api-crossdomain-xml-index')
+
+    def test_permits_policies(self):
+        resp = self.client.get(self.path)
+        self.assertEquals(resp.status_code, 200)
+        self.assertEquals(resp['Content-Type'], 'application/xml')
+        self.assertIn('<site-control permitted-cross-domain-policies="all"></site-control>', resp.content)
