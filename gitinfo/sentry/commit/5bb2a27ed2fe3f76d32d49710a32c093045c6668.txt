commit 5bb2a27ed2fe3f76d32d49710a32c093045c6668
Author: David Cramer <dcramer@gmail.com>
Date:   Fri Nov 13 11:06:03 2015 -0800

    Fail gracefully on files without storage

diff --git a/src/sentry/migrations/0213_migrate_file_blobs.py b/src/sentry/migrations/0213_migrate_file_blobs.py
index d17690a475..1c10c1f74c 100644
--- a/src/sentry/migrations/0213_migrate_file_blobs.py
+++ b/src/sentry/migrations/0213_migrate_file_blobs.py
@@ -15,6 +15,9 @@ class Migration(DataMigration):
 
         lock_key = 'fileblob:convert:{}'.format(file.checksum)
         with Lock(lock_key, timeout=60):
+            if not file.storage:
+                continue
+
             blob, created = FileBlob.objects.get_or_create(
                 checksum=file.checksum,
                 defaults={
