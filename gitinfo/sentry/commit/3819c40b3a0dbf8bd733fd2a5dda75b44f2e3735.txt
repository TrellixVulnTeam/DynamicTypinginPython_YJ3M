commit 3819c40b3a0dbf8bd733fd2a5dda75b44f2e3735
Author: David Cramer <dcramer@gmail.com>
Date:   Tue Oct 30 22:54:30 2012 -0700

    Move helper tests

diff --git a/tests/sentry/utils/db/__init__.py b/tests/sentry/utils/db/__init__.py
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/tests/sentry/utils/db/tests.py b/tests/sentry/utils/db/tests.py
new file mode 100644
index 0000000000..97015a96ca
--- /dev/null
+++ b/tests/sentry/utils/db/tests.py
@@ -0,0 +1,16 @@
+# -*- coding: utf-8 -*-
+
+from __future__ import absolute_import
+
+from sentry.utils.db import get_db_engine
+from tests.base import TestCase
+
+
+class GetDbEngineTest(TestCase):
+    def test_with_dotted_path(self):
+        with self.Settings(DATABASES={'default': {'ENGINE': 'blah.sqlite3'}}):
+            self.assertEquals(get_db_engine(), 'sqlite3')
+
+    def test_no_path(self):
+        with self.Settings(DATABASES={'default': {'ENGINE': 'mysql'}}):
+            self.assertEquals(get_db_engine(), 'mysql')
diff --git a/tests/sentry/web/frontend/tests.py b/tests/sentry/web/frontend/tests.py
index 9596d8850d..9a7e14e291 100644
--- a/tests/sentry/web/frontend/tests.py
+++ b/tests/sentry/web/frontend/tests.py
@@ -5,7 +5,6 @@ from __future__ import absolute_import
 import logging
 import json
 
-from django.conf import settings as django_settings
 from django.contrib.auth.models import User
 from django.core.urlresolvers import reverse
 
@@ -13,7 +12,6 @@ from sentry.conf import settings
 from sentry.constants import MEMBER_USER
 from sentry.models import Group, Project, TeamMember, Team
 from sentry.testutils import fixture
-from sentry.web.helpers import get_login_url
 
 from tests.base import TestCase
 
@@ -458,37 +456,3 @@ class SentrySearchTest(TestCase):
             self.assertEquals(len(context['event_list']), 2)
             self.assertTrue(g1 in context['event_list'])
             self.assertTrue(g2 in context['event_list'])
-
-
-class SentryHelpersTest(TestCase):
-    def test_get_db_engine(self):
-        from sentry.utils.db import get_db_engine
-        _databases = getattr(django_settings, 'DATABASES', {}).copy()
-
-        django_settings.DATABASES['default'] = {'ENGINE': 'blah.sqlite3'}
-
-        self.assertEquals(get_db_engine(), 'sqlite3')
-
-        django_settings.DATABASES['default'] = {'ENGINE': 'blah.mysql'}
-
-        self.assertEquals(get_db_engine(), 'mysql')
-
-        django_settings.DATABASES = _databases
-
-    def test_get_login_url(self):
-        with self.Settings(LOGIN_URL='/really-a-404'):
-            url = get_login_url(True)
-            self.assertEquals(url, reverse('sentry-login'))
-
-        with self.Settings(LOGIN_URL=reverse('sentry-fake-login')):
-            url = get_login_url(True)
-            self.assertEquals(url, reverse('sentry-fake-login'))
-
-        # should still be cached
-        with self.Settings(LOGIN_URL='/really-a-404'):
-            url = get_login_url(False)
-            self.assertEquals(url, reverse('sentry-fake-login'))
-
-        with self.Settings(SENTRY_LOGIN_URL=None):
-            url = get_login_url(True)
-            self.assertEquals(url, reverse('sentry-login'))
diff --git a/tests/sentry/web/helpers/tests.py b/tests/sentry/web/helpers/tests.py
index b9bece71af..4cd4ced189 100644
--- a/tests/sentry/web/helpers/tests.py
+++ b/tests/sentry/web/helpers/tests.py
@@ -5,9 +5,10 @@ from __future__ import absolute_import
 import mock
 
 from django.contrib.auth.models import User
+from django.core.urlresolvers import reverse
 from sentry.constants import MEMBER_USER
 from sentry.models import Project
-from sentry.web.helpers import get_project_list
+from sentry.web.helpers import get_project_list, get_login_url
 from tests.base import TestCase
 
 
@@ -45,3 +46,26 @@ class GetProjectListTEst(TestCase):
         get_for_user.assert_called_once_with(self.user, MEMBER_USER)
         self.assertEquals(len(project_list), 1)
         self.assertIn(self.project2.id, project_list)
+
+
+class GetLoginUrlTest(TestCase):
+    def test_as_path(self):
+        with self.Settings(LOGIN_URL='/really-a-404'):
+            url = get_login_url(True)
+            self.assertEquals(url, reverse('sentry-login'))
+
+    def test_as_lazy_url(self):
+        with self.Settings(LOGIN_URL=reverse('sentry-fake-login')):
+            url = get_login_url(True)
+            self.assertEquals(url, reverse('sentry-fake-login'))
+
+    def test_cached(self):
+        # should still be cached
+        with self.Settings(LOGIN_URL='/really-a-404'):
+            url = get_login_url(False)
+            self.assertNotEquals(url, '/really-a-404')
+
+    def test_no_value(self):
+        with self.Settings(SENTRY_LOGIN_URL=None):
+            url = get_login_url(True)
+            self.assertEquals(url, reverse('sentry-login'))
