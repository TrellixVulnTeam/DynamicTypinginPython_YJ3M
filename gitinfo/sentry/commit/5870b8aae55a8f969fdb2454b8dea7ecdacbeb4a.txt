commit 5870b8aae55a8f969fdb2454b8dea7ecdacbeb4a
Author: Mike Clarke <mike.k.clarke@gmail.com>
Date:   Mon Apr 23 15:57:17 2018 -0700

    refs(newsletter): Subscribe to all default lists when granting consent (#8151)

diff --git a/src/sentry/api/endpoints/user_subscriptions.py b/src/sentry/api/endpoints/user_subscriptions.py
index 14f2ce0173..b1a2dfd25e 100644
--- a/src/sentry/api/endpoints/user_subscriptions.py
+++ b/src/sentry/api/endpoints/user_subscriptions.py
@@ -96,14 +96,14 @@ class UserSubscriptionsEndpoint(UserEndpoint):
         kwargs = {
             'subscribed': result['subscribed'],
             'verified': email.is_verified,
-            'list_id': newsletter.get_default_list_id(),
+            'list_ids': newsletter.get_default_list_ids(),
         }
         if not result['subscribed']:
             kwargs['unsubscribed_date'] = timezone.now()
         else:
             kwargs['subscribed_date'] = timezone.now()
 
-        newsletter.create_or_update_subscription(user, **kwargs)
+        newsletter.create_or_update_subscriptions(user, **kwargs)
 
         user.update(
             flags=F('flags').bitand(~User.flags.newsletter_consent_prompt),
diff --git a/src/sentry/web/forms/accounts.py b/src/sentry/web/forms/accounts.py
index fac650ff12..d4cfc3ddc0 100644
--- a/src/sentry/web/forms/accounts.py
+++ b/src/sentry/web/forms/accounts.py
@@ -243,7 +243,7 @@ class RegistrationForm(forms.ModelForm):
         if commit:
             user.save()
             if self.cleaned_data.get('subscribe'):
-                newsletter.create_or_update_subscription(user, list_id=newsletter.get_default_list_id())
+                newsletter.create_or_update_subscriptions(user, list_ids=newsletter.get_default_list_ids())
         return user
 
 
