commit 74b18dd32116c18b6db7dd4ad9da04150ae0e052
Author: David Cramer <dcramer@gmail.com>
Date:   Wed Apr 18 14:28:14 2012 -0700

    Ensure all json is escaped correctly (fixes GH-440)

diff --git a/sentry/templates/sentry/groups/details.html b/sentry/templates/sentry/groups/details.html
index 25f79519e5..0defd2f880 100644
--- a/sentry/templates/sentry/groups/details.html
+++ b/sentry/templates/sentry/groups/details.html
@@ -70,13 +70,13 @@
                 <ul class="actions">
                     <li>
                         {% if group.status == 0 %}
-                            <a href="javascript:void(0)" class="tip" onclick="Sentry.stream.resolve('{{ group.project.slug|to_json }}', {{ group.pk|to_json }}, false);" rel="tooltip" title="{% trans "Mark as Resolved" %}">&#10003;</a>
+                            <a href="javascript:void(0)" class="tip" onclick="Sentry.stream.resolve({{ group.project.slug|to_json|safe }}, {{ group.pk|to_json|safe }}, false);" rel="tooltip" title="{% trans "Mark as Resolved" %}">&#10003;</a>
                         {% else %}
                             <a href="javascript:void(0)" class="tip disabled" rel="tooltip" title="{% trans "Already Resolved" %}">&#10003;</a>
                         {% endif %}
                     </li>
                     {% if request.user.is_authenticated %}
-                        <li><a href="javascript:void(0)" onclick="Sentry.stream.bookmark('{{ group.project.slug|to_json }}', {{ group.pk|to_json }}, this);" class="tip bookmark{% if is_bookmarked %} checked{% endif %}" rel="tooltip" title="{% trans "Bookmark" %}">&#9829;</a></li>
+                        <li><a href="javascript:void(0)" onclick="Sentry.stream.bookmark({{ group.project.slug|to_json|safe }}, {{ group.pk|to_json|safe }}, this);" class="tip bookmark{% if is_bookmarked %} checked{% endif %}" rel="tooltip" title="{% trans "Bookmark" %}">&#9829;</a></li>
                     {% endif %}
                 </ul>
             </div>
diff --git a/sentry/templates/sentry/groups/group_list.html b/sentry/templates/sentry/groups/group_list.html
index 58e32b216c..decbe05aca 100644
--- a/sentry/templates/sentry/groups/group_list.html
+++ b/sentry/templates/sentry/groups/group_list.html
@@ -9,8 +9,8 @@
     <script>
     {% if has_realtime %}
         Sentry.realtime.config({
-            projectId: {{ project.slug|to_json }},
-            viewId: {% if view %}{{ view.pk|to_json }}{% else %}null{% endif %}
+            projectId: {{ project.slug|to_json|safe }},
+            viewId: {% if view %}{{ view.pk|to_json|safe }}{% else %}null{% endif %}
         })
         Sentry.realtime.enable();
     {% endif %}
@@ -57,7 +57,7 @@
 
     <div class="btn-toolbar">
         <div class="btn-group">
-            <a class="btn" href="javascript:void(0)" id="sentry-resolve-feed" onclick="Sentry.stream.clear({{ project.slug|to_json }});">{% trans "Resolve Feed" %}</a>
+            <a class="btn" href="javascript:void(0)" id="sentry-resolve-feed" onclick="Sentry.stream.clear({{ project.slug|to_json|safe }});">{% trans "Resolve Feed" %}</a>
         </div>
         <div class="btn-group">
             <a class="btn realtime-play" href="javascript:void(0)" id="sentry-realtime" onclick="Sentry.realtime.toggle();">{% trans "Pause Feed" %}</a>
diff --git a/sentry/templates/sentry/layout.html b/sentry/templates/sentry/layout.html
index bbb9e0ece3..00ff6343c7 100644
--- a/sentry/templates/sentry/layout.html
+++ b/sentry/templates/sentry/layout.html
@@ -17,7 +17,7 @@
         <script type="text/javascript">
         Sentry.client.config({
             server: '{% url sentry-api-store %}',
-            projectId: '{{ PROJECT_ID }}',
+            projectId: {{ PROJECT_ID|to_json|safe }},
             logger: 'sentry.errors.javascript'
         })
         Sentry.client.registerGlobalHandler();
@@ -34,7 +34,7 @@
         <script type="text/javascript" src="{% url sentry-media "scripts/global.min.js" %}"></script>
         <script type="text/javascript">
         Sentry.config({
-            urlPrefix: '{{ URL_PREFIX }}',
+            urlPrefix: {{ URL_PREFIX|to_json|safe }},
             mediaUrl: '{% url sentry-media '' %}',
             defaultImage: '{% url sentry-media 'images/sentry.png' %}',
             popupCss: '{% url sentry-media 'styles/popup.css' %}'
diff --git a/sentry/templates/sentry/partial/_group.html b/sentry/templates/sentry/partial/_group.html
index 9d6ac8d267..ad0263c20e 100644
--- a/sentry/templates/sentry/partial/_group.html
+++ b/sentry/templates/sentry/partial/_group.html
@@ -33,13 +33,13 @@
         <ul class="actions">
             <li>
                 {% if group.status == 0 %}
-                    <a href="javascript:void(0)" class="tip" onclick="Sentry.stream.resolve({{ group.project.slug|to_json }}, {{ group.pk|to_json }}, this);" rel="tooltip" title="{% trans "Mark as Resolved" %}">&#10003;</a>
+                    <a href="javascript:void(0)" class="tip" onclick="Sentry.stream.resolve({{ group.project.slug|to_json|safe }}, {{ group.pk|to_json|safe }}, this);" rel="tooltip" title="{% trans "Mark as Resolved" %}">&#10003;</a>
                 {% else %}
                     <a href="javascript:void(0)" class="tip disabled" rel="tooltip" title="{% trans "Already Resolved" %}">&#10003;</a>
                 {% endif %}
             </li>
             {% if request.user.is_authenticated %}
-                <li><a href="javascript:void(0)" onclick="Sentry.stream.bookmark({{ group.project.slug|to_json }}, {{ group.pk|to_json }}, this);" class="tip bookmark{% if is_bookmarked %} checked{% endif %}" rel="tooltip" title="{% trans "Bookmark" %}">&#9829;</a></li>
+                <li><a href="javascript:void(0)" onclick="Sentry.stream.bookmark({{ group.project.slug|to_json|safe }}, {{ group.pk|to_json|safe }}, this);" class="tip bookmark{% if is_bookmarked %} checked{% endif %}" rel="tooltip" title="{% trans "Bookmark" %}">&#9829;</a></li>
             {% endif %}
         </ul>
     </div>
