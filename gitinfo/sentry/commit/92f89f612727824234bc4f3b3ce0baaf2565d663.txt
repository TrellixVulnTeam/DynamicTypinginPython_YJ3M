commit 92f89f612727824234bc4f3b3ce0baaf2565d663
Author: David Cramer <dcramer@gmail.com>
Date:   Mon Oct 18 13:33:10 2010 -0700

    Support other database engines with date trunc

diff --git a/sentry/templatetags/sentry_helpers.py b/sentry/templatetags/sentry_helpers.py
index 8bf40da898..fdaee232fc 100644
--- a/sentry/templatetags/sentry_helpers.py
+++ b/sentry/templatetags/sentry_helpers.py
@@ -47,10 +47,13 @@ def chart_data(group, max_days=90):
     
     today = datetime.datetime.now()
 
-    if get_db_engine().startswith('postgresql'):
-        method = "date_trunc('hour', datetime)"
+    if hasattr(group, '_state'):
+        from django.db import connections
+        conn = connections[group._state.db]
     else:
-        return {}
+        from django.db import connection as conn
+
+    method = conn.ops.date_trunc_sql('hour', 'datetime')
 
     chart_qs = list(group.message_set.all()\
                       .filter(datetime__gte=datetime.datetime.now() - datetime.timedelta(hours=hours))\
