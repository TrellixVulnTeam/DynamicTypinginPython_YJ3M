<html>
<head>
<meta charset="utf-8">
<title>/home/xxm/Desktop/EMSE/dataset/sentry/src/sentry/search/snuba/executors.py</title>
<style type='text/css'>
body { color: #666666; }
a {
    text-decoration: none; color: #5AA2A7;
    border: solid 1px rgba(255,255,255,0);
}
a.active {
    background: -webkit-linear-gradient(top,rgba(255, 255, 200, 0.35) 0,rgba(255, 255, 200, 0.55) 100%);
    border: solid 1px #E5E600;
}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #cccccc;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px solid orange; padding-bottom: 1px}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted;

function highlight(xid)
{
    var elms = document.querySelectorAll('[xid="' + xid + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "active";
    }
    highlighted = xid;
}

function clearHighlight() {
    var elms = document.querySelectorAll('[xid="' + highlighted + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "";
    }
}

window.onload =
    function (e) {
        var tags = document.getElementsByTagName("A")
        for (var i = 0; i < tags.length; i++) {
            tags[i].onmouseover =
                function (e) {
                    clearHighlight();
                    var xid = e.toElement.getAttribute('xid');
                    highlight(xid);
                }
        }
    }</script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter'>get_search_filter</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta'>ABCMeta</a><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.TABLE_ALIAS', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.TABLE_ALIAS'>TABLE_ALIAS</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs'>aggregation_defs</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dependency_aggregations', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dependency_aggregations'>dependency_aggregations</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.empty_result', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.empty_result'>empty_result</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dataset', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dataset'>dataset</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query'>query</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search'>snuba_search</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter'>_transform_converted_filter</a></li></ul>
</li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor'>PostgresSnubaQueryExecutor</a><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.ISSUE_FIELD_NAME', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.ISSUE_FIELD_NAME'>ISSUE_FIELD_NAME</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.logger', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.logger'>logger</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dependency_aggregations', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dependency_aggregations'>dependency_aggregations</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.postgres_only_fields', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.postgres_only_fields'>postgres_only_fields</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.sort_strategies', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.sort_strategies'>sort_strategies</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.aggregation_defs', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.aggregation_defs'>aggregation_defs</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dataset', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dataset'>dataset</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query'>query</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits'>calculate_hits</a></li></ul>
</li></ul>
</td><td><pre><span class='lineno'>   1</span> from __future__ import absolute_import
<span class='lineno'>   2</span> 
<span class='lineno'>   3</span> from abc import ABCMeta, abstractmethod, abstractproperty
<span class='lineno'>   4</span> 
<span class='lineno'>   5</span> import logging
<span class='lineno'>   6</span> import time
<span class='lineno'>   7</span> import six
<span class='lineno'>   8</span> import sentry_sdk
<span class='lineno'>   9</span> from datetime import timedelta
<span class='lineno'>  10</span> from hashlib import md5
<span class='lineno'>  11</span> 
<span class='lineno'>  12</span> from django.utils import timezone
<span class='lineno'>  13</span> 
<span class='lineno'>  14</span> from sentry import options
<span class='lineno'>  15</span> from sentry.api.event_search import convert_search_filter_to_snuba_query
<span class='lineno'>  16</span> from sentry.api.paginator import DateTimePaginator, SequencePaginator, Paginator
<span class='lineno'>  17</span> from sentry.constants import ALLOWED_FUTURE_DELTA
<span class='lineno'>  18</span> from sentry.models import Group
<span class='lineno'>  19</span> from sentry.utils import snuba, metrics
<span class='lineno'>  20</span> 
<span class='lineno'>  21</span> 
<span class='lineno'>  22</span> def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter', title='(?, ?, ?) -> int / (?, str, str) -> int'>get_search_filter</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filters', title='?'>search_filters</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.name', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.name', title='str'>name</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.operator', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.operator', title='str'>operator</a>):
<span class='lineno'>  23</span>     &quot;&quot;&quot;
<span class='lineno'>  24</span>     Finds the value of a search filter with the passed name and operator. If
<span class='lineno'>  25</span>     multiple values are found, returns the most restrictive value
<span class='lineno'>  26</span>     :param search_filters: collection of `SearchFilter` objects
<span class='lineno'>  27</span>     :param name: Name of the field to find
<span class='lineno'>  28</span>     :param operator: &#39;&lt;&#39; or &#39;&gt;&#39;
<span class='lineno'>  29</span>     :return: The value of the field if found, else None
<span class='lineno'>  30</span>     &quot;&quot;&quot;
<span class='lineno'>  31</span>     assert <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.operator', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.operator', title='str'>operator</a> in (&quot;&lt;&quot;, &quot;&gt;&quot;)
<span class='lineno'>  32</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.comparator', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.comparator', title='? -> int'>comparator</a> = max if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.operator', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.operator', title='str'>operator</a>.startswith(&quot;&gt;&quot;) else min
<span class='lineno'>  33</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', title='None'>found_val</a> = None
<span class='lineno'>  34</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filter', title='?'>search_filter</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filters', title='?'>search_filters</a>:
<span class='lineno'>  35</span>         # Note that we check operator with `startswith` here so that we handle
<span class='lineno'>  36</span>         # &lt;, &lt;=, &gt;, &gt;=
<span class='lineno'>  37</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filter', title='?'>search_filter</a>.key.name == <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.name', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.name', title='str'>name</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filter', title='?'>search_filter</a>.operator.startswith(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.operator', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.operator', title='str'>operator</a>):
<span class='lineno'>  38</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.val', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.val', title='?'>val</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.search_filter', title='?'>search_filter</a>.value.raw_value
<span class='lineno'>  39</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', title='int'>found_val</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.comparator', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.comparator', title='? -> int'>comparator</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.val', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.val', title='?'>val</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', title='int'>found_val</a>) if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', title='int'>found_val</a> else <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.val', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.val', title='?'>val</a>
<span class='lineno'>  40</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter.found_val', title='int'>found_val</a>
<span class='lineno'>  41</span> 
<span class='lineno'>  42</span> 
<span class='lineno'>  43</span> @six.add_metaclass(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta', title='<ABCMeta>'>ABCMeta</a>)
<span class='lineno'>  44</span> class AbstractQueryExecutor:
<span class='lineno'>  45</span>     &quot;&quot;&quot;This class serves as a template for Query Executors.
<span class='lineno'>  46</span>     We subclass it in order to implement query methods (we use it to implement two classes: joined Postgres+Snuba queries, and Snuba only queries)
<span class='lineno'>  47</span>     It&#39;s used to keep the query logic out of the actual search backend,
<span class='lineno'>  48</span>     which can now just build query parameters and use the appropriate query executor to run the query
<span class='lineno'>  49</span>     &quot;&quot;&quot;
<span class='lineno'>  50</span> 
<span class='lineno'>  51</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.TABLE_ALIAS', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.TABLE_ALIAS', title='str'>TABLE_ALIAS</a> = &quot;&quot;
<span class='lineno'>  52</span> 
<span class='lineno'>  53</span>     @abstractproperty
<span class='lineno'>  54</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs', title='ABCMeta -> None'>aggregation_defs</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs.self', title='ABCMeta'>self</a>):
<span class='lineno'>  55</span>         &quot;&quot;&quot;This method should return a dict of key:value
<span class='lineno'>  56</span>         where key is a field name for your aggregation
<span class='lineno'>  57</span>         and value is the aggregation function&quot;&quot;&quot;
<span class='lineno'>  58</span>         raise NotImplementedError
<span class='lineno'>  59</span> 
<span class='lineno'>  60</span>     @abstractproperty
<span class='lineno'>  61</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dependency_aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dependency_aggregations', title='ABCMeta -> None'>dependency_aggregations</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dependency_aggregations.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dependency_aggregations.self', title='ABCMeta'>self</a>):
<span class='lineno'>  62</span>         &quot;&quot;&quot;This method should return a dict of key:value
<span class='lineno'>  63</span>         where key is an aggregation_def field name
<span class='lineno'>  64</span>         and value is a list of aggregation field names that the &#39;key&#39; aggregation requires.&quot;&quot;&quot;
<span class='lineno'>  65</span>         raise NotImplementedError
<span class='lineno'>  66</span> 
<span class='lineno'>  67</span>     @property
<span class='lineno'>  68</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.empty_result', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.empty_result', title='ABCMeta -> ?'>empty_result</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.empty_result.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.empty_result.self', title='ABCMeta'>self</a>):
<span class='lineno'>  69</span>         return Paginator(Group.objects.none()).get_result()
<span class='lineno'>  70</span> 
<span class='lineno'>  71</span>     @property
<span class='lineno'>  72</span>     @abstractmethod
<span class='lineno'>  73</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dataset', title='ABCMeta -> None'>dataset</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dataset.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dataset.self', title='ABCMeta'>self</a>):
<span class='lineno'>  74</span>         &quot;&quot;&quot;&quot;This function should return an enum from snuba.Dataset (like snuba.Dataset.Events)&quot;&quot;&quot;
<span class='lineno'>  75</span>         raise NotImplementedError
<span class='lineno'>  76</span> 
<span class='lineno'>  77</span>     @abstractmethod
<span class='lineno'>  78</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query', title='(ABCMeta, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) -> None'>query</a>(
<span class='lineno'>  79</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.self', title='ABCMeta'>self</a>,
<span class='lineno'>  80</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.projects', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.projects', title='?'>projects</a>,
<span class='lineno'>  81</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.retention_window_start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.retention_window_start', title='?'>retention_window_start</a>,
<span class='lineno'>  82</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.group_queryset', title='?'>group_queryset</a>,
<span class='lineno'>  83</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.environments', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.environments', title='?'>environments</a>,
<span class='lineno'>  84</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.sort_by', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.sort_by', title='?'>sort_by</a>,
<span class='lineno'>  85</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.limit', title='?'>limit</a>,
<span class='lineno'>  86</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.cursor', title='?'>cursor</a>,
<span class='lineno'>  87</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.count_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.count_hits', title='?'>count_hits</a>,
<span class='lineno'>  88</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.paginator_options', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.paginator_options', title='?'>paginator_options</a>,
<span class='lineno'>  89</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.search_filters', title='?'>search_filters</a>,
<span class='lineno'>  90</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.date_from', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.date_from', title='?'>date_from</a>,
<span class='lineno'>  91</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.date_to', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.query.date_to', title='?'>date_to</a>,
<span class='lineno'>  92</span>     ):
<span class='lineno'>  93</span>         &quot;&quot;&quot;This function runs your actual query and returns the results
<span class='lineno'>  94</span>         We usually return a paginator object, which contains the results and the number of hits&quot;&quot;&quot;
<span class='lineno'>  95</span>         raise NotImplementedError
<span class='lineno'>  96</span> 
<span class='lineno'>  97</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search', title='(ABCMeta, ?, ?, ?, ?, ?, None, None, None, int, bool, None) -> ([(?, ?)], ?)'>snuba_search</a>(
<span class='lineno'>  98</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', title='ABCMeta'>self</a>,
<span class='lineno'>  99</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.start', title='?'>start</a>,
<span class='lineno'> 100</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.end', title='?'>end</a>,
<span class='lineno'> 101</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.project_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.project_ids', title='?'>project_ids</a>,
<span class='lineno'> 102</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.environment_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.environment_ids', title='?'>environment_ids</a>,
<span class='lineno'> 103</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', title='?'>sort_field</a>,
<span class='lineno'> 104</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.cursor', title='None'>cursor</a>=None,
<span class='lineno'> 105</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.group_ids', title='None'>group_ids</a>=None,
<span class='lineno'> 106</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.limit', title='None'>limit</a>=None,
<span class='lineno'> 107</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.offset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.offset', title='int'>offset</a>=0,
<span class='lineno'> 108</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.get_sample', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.get_sample', title='bool'>get_sample</a>=False,
<span class='lineno'> 109</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filters', title='None'>search_filters</a>=None,
<span class='lineno'> 110</span>     ):
<span class='lineno'> 111</span>         &quot;&quot;&quot;
<span class='lineno'> 112</span>         Returns a tuple of:
<span class='lineno'> 113</span>         * a sorted list of (group_id, group_score) tuples sorted descending by score,
<span class='lineno'> 114</span>         * the count of total results (rows) available for this query.
<span class='lineno'> 115</span>         &quot;&quot;&quot;
<span class='lineno'> 116</span> 
<span class='lineno'> 117</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.filters', title='dict'>filters</a> = {&quot;project_id&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.project_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.project_ids', title='?'>project_ids</a>}
<span class='lineno'> 118</span> 
<span class='lineno'> 119</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.environment_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.environment_ids', title='?'>environment_ids</a> is not None:
<span class='lineno'> 120</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.filters', title='dict'>filters</a>[&quot;environment&quot;] = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.environment_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.environment_ids', title='?'>environment_ids</a>
<span class='lineno'> 121</span> 
<span class='lineno'> 122</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.group_ids', title='None'>group_ids</a>:
<span class='lineno'> 123</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.filters', title='dict'>filters</a>[&quot;group_id&quot;] = sorted(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.group_ids', title='None'>group_ids</a>)
<span class='lineno'> 124</span> 
<span class='lineno'> 125</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.conditions', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.conditions', title='[None]'>conditions</a> = []
<span class='lineno'> 126</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', title='[{(?, str, ?) | None}]'>having</a> = []
<span class='lineno'> 127</span>         for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', title='?'>search_filter</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filters', title='None'>search_filters</a>:
<span class='lineno'> 128</span>             if (
<span class='lineno'> 129</span>                 # Don&#39;t filter on postgres fields here, they&#39;re not available
<span class='lineno'> 130</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', title='?'>search_filter</a>.key.name in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', title='ABCMeta'>self</a>.postgres_only_fields
<span class='lineno'> 131</span>                 or
<span class='lineno'> 132</span>                 # We special case date
<span class='lineno'> 133</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', title='?'>search_filter</a>.key.name == &quot;date&quot;
<span class='lineno'> 134</span>             ):
<span class='lineno'> 135</span>                 continue
<span class='lineno'> 136</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', title='?'>converted_filter</a> = convert_search_filter_to_snuba_query(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', title='?'>search_filter</a>)
<span class='lineno'> 137</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', title='None'>converted_filter</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', title='ABCMeta'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter', title='(ABCMeta, ?, ?, ?, None) -> None / (ABCMeta, ?, ?, ?, ?) -> None'>_transform_converted_filter</a>(
<span class='lineno'> 138</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', title='?'>search_filter</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', title='?'>converted_filter</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.project_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.project_ids', title='?'>project_ids</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.environment_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.environment_ids', title='?'>environment_ids</a>
<span class='lineno'> 139</span>             )
<span class='lineno'> 140</span>             if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', title='None'>converted_filter</a> is not None:
<span class='lineno'> 141</span>                 # Ensure that no user-generated tags that clashes with aggregation_defs is added to having
<span class='lineno'> 142</span>                 if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', title='?'>search_filter</a>.key.name in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', title='ABCMeta'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs', title='ABCMeta -> None'>aggregation_defs</a> and not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.search_filter', title='?'>search_filter</a>.key.is_tag:
<span class='lineno'> 143</span>                     <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', title='[{(?, str, ?) | None}]'>having</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', title='None'>converted_filter</a>)
<span class='lineno'> 144</span>                 else:
<span class='lineno'> 145</span>                     <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.conditions', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.conditions', title='[None]'>conditions</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.converted_filter', title='None'>converted_filter</a>)
<span class='lineno'> 146</span> 
<span class='lineno'> 147</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.extra_aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.extra_aggregations', title='?'>extra_aggregations</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', title='ABCMeta'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dependency_aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dependency_aggregations', title='ABCMeta -> None'>dependency_aggregations</a>.get(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', title='?'>sort_field</a>, [])
<span class='lineno'> 148</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.required_aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.required_aggregations', title='?'>required_aggregations</a> = set([<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', title='?'>sort_field</a>, &quot;total&quot;] + <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.extra_aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.extra_aggregations', title='?'>extra_aggregations</a>)
<span class='lineno'> 149</span>         for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.h', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.h', title='None'>h</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', title='[{(?, str, ?) | None}]'>having</a>:
<span class='lineno'> 150</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', title='?'>alias</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.h', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.h', title='None'>h</a>[0]
<span class='lineno'> 151</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.required_aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.required_aggregations', title='?'>required_aggregations</a>.add(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', title='?'>alias</a>)
<span class='lineno'> 152</span> 
<span class='lineno'> 153</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.aggregations', title='[[?]]'>aggregations</a> = []
<span class='lineno'> 154</span>         for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', title='?'>alias</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.required_aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.required_aggregations', title='?'>required_aggregations</a>:
<span class='lineno'> 155</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.aggregations', title='[[?]]'>aggregations</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', title='ABCMeta'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.aggregation_defs', title='ABCMeta -> None'>aggregation_defs</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', title='?'>alias</a>] + [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.alias', title='?'>alias</a>])
<span class='lineno'> 156</span> 
<span class='lineno'> 157</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.cursor', title='None'>cursor</a> is not None:
<span class='lineno'> 158</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', title='[{(?, str, ?) | None}]'>having</a>.append((<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', title='?'>sort_field</a>, &quot;&gt;=&quot; if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.cursor', title='None'>cursor</a>.is_prev else &quot;&lt;=&quot;, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.cursor', title='None'>cursor</a>.value))
<span class='lineno'> 159</span> 
<span class='lineno'> 160</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.selected_columns', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.selected_columns', title='[(str, (str, str), str)]'>selected_columns</a> = []
<span class='lineno'> 161</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.get_sample', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.get_sample', title='bool'>get_sample</a>:
<span class='lineno'> 162</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.query_hash', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.query_hash', title='?'>query_hash</a> = md5(repr(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.conditions', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.conditions', title='[None]'>conditions</a>)).hexdigest()[:8]
<span class='lineno'> 163</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.selected_columns', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.selected_columns', title='[(str, (str, str), str)]'>selected_columns</a>.append(
<span class='lineno'> 164</span>                 (&quot;cityHash64&quot;, (&quot;&#39;{}&#39;&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.query_hash', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.query_hash', title='?'>query_hash</a>), &quot;group_id&quot;), &quot;sample&quot;)
<span class='lineno'> 165</span>             )
<span class='lineno'> 166</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', title='str'>sort_field</a> = &quot;sample&quot;
<span class='lineno'> 167</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.orderby', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.orderby', title='[str]'>orderby</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', title='str'>sort_field</a>]
<span class='lineno'> 168</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.referrer', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.referrer', title='str'>referrer</a> = &quot;search_sample&quot;
<span class='lineno'> 169</span>         else:
<span class='lineno'> 170</span>             # Get the top matching groups by score, i.e. the actual search results
<span class='lineno'> 171</span>             # in the order that we want them.
<span class='lineno'> 172</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.orderby', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.orderby', title='[str]'>orderby</a> = [
<span class='lineno'> 173</span>                 &quot;-{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', title='?'>sort_field</a>),
<span class='lineno'> 174</span>                 &quot;group_id&quot;,
<span class='lineno'> 175</span>             ]  # ensure stable sort within the same score
<span class='lineno'> 176</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.referrer', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.referrer', title='str'>referrer</a> = &quot;search&quot;
<span class='lineno'> 177</span> 
<span class='lineno'> 178</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.snuba_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.snuba_results', title='?'>snuba_results</a> = snuba.aliased_query(
<span class='lineno'> 179</span>             dataset=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.self', title='ABCMeta'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.dataset', title='ABCMeta -> None'>dataset</a>,
<span class='lineno'> 180</span>             start=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.start', title='?'>start</a>,
<span class='lineno'> 181</span>             end=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.end', title='?'>end</a>,
<span class='lineno'> 182</span>             selected_columns=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.selected_columns', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.selected_columns', title='[(str, (str, str), str)]'>selected_columns</a>,
<span class='lineno'> 183</span>             groupby=[&quot;group_id&quot;],
<span class='lineno'> 184</span>             conditions=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.conditions', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.conditions', title='[None]'>conditions</a>,
<span class='lineno'> 185</span>             having=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.having', title='[{(?, str, ?) | None}]'>having</a>,
<span class='lineno'> 186</span>             filter_keys=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.filters', title='dict'>filters</a>,
<span class='lineno'> 187</span>             aggregations=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.aggregations', title='[[?]]'>aggregations</a>,
<span class='lineno'> 188</span>             orderby=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.orderby', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.orderby', title='[str]'>orderby</a>,
<span class='lineno'> 189</span>             referrer=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.referrer', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.referrer', title='str'>referrer</a>,
<span class='lineno'> 190</span>             limit=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.limit', title='None'>limit</a>,
<span class='lineno'> 191</span>             offset=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.offset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.offset', title='int'>offset</a>,
<span class='lineno'> 192</span>             totals=True,  # Needs to have totals_mode=after_having_exclusive so we get groups matching HAVING only
<span class='lineno'> 193</span>             turbo=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.get_sample', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.get_sample', title='bool'>get_sample</a>,  # Turn off FINAL when in sampling mode
<span class='lineno'> 194</span>             sample=1,  # Don&#39;t use clickhouse sampling, even when in turbo mode.
<span class='lineno'> 195</span>             condition_resolver=snuba.get_snuba_column_name,
<span class='lineno'> 196</span>         )
<span class='lineno'> 197</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.rows', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.rows', title='?'>rows</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.snuba_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.snuba_results', title='?'>snuba_results</a>[&quot;data&quot;]
<span class='lineno'> 198</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.total', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.total', title='?'>total</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.snuba_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.snuba_results', title='?'>snuba_results</a>[&quot;totals&quot;][&quot;total&quot;]
<span class='lineno'> 199</span> 
<span class='lineno'> 200</span>         if not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.get_sample', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.get_sample', title='bool'>get_sample</a>:
<span class='lineno'> 201</span>             metrics.timing(&quot;snuba.search.num_result_groups&quot;, len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.rows', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.rows', title='?'>rows</a>))
<span class='lineno'> 202</span> 
<span class='lineno'> 203</span>         return [(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.row', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.row', title='?'>row</a>[&quot;group_id&quot;], <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.row', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.row', title='?'>row</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.sort_field', title='str'>sort_field</a>]) for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.row', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.row', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.row', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.row', title='?'>row</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.rows', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.rows', title='?'>rows</a>], <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.total', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta.snuba_search.total', title='?'>total</a>
<span class='lineno'> 204</span> 
<span class='lineno'> 205</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter', title='(ABCMeta, ?, ?, ?, None) -> None / (ABCMeta, ?, ?, ?, ?) -> None'>_transform_converted_filter</a>(
<span class='lineno'> 206</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.self', title='ABCMeta'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.search_filter', title='?'>search_filter</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.converted_filter', title='?'>converted_filter</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.project_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.project_ids', title='?'>project_ids</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.environment_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.environment_ids', title='None'>environment_ids</a>=None
<span class='lineno'> 207</span>     ):
<span class='lineno'> 208</span>         &quot;&quot;&quot;This method serves as a hook - after we convert the search_filter into a snuba compatible filter (which converts it in a general dataset ambigious method),
<span class='lineno'> 209</span>             we may want to transform the query - maybe change the value (time formats, translate value into id (like turning Release `version` into `id`) or vice versa),  alias fields, etc.
<span class='lineno'> 210</span>             By default, no transformation is done.
<span class='lineno'> 211</span>         &quot;&quot;&quot;
<span class='lineno'> 212</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.converted_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.ABCMeta._transform_converted_filter.converted_filter', title='?'>converted_filter</a>
<span class='lineno'> 213</span> 
<span class='lineno'> 214</span> 
<span class='lineno'> 215</span> class <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor', title='<PostgresSnubaQueryExecutor>'>PostgresSnubaQueryExecutor</a>(AbstractQueryExecutor):
<span class='lineno'> 216</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.ISSUE_FIELD_NAME', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.ISSUE_FIELD_NAME', title='str'>ISSUE_FIELD_NAME</a> = &quot;group_id&quot;
<span class='lineno'> 217</span> 
<span class='lineno'> 218</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.logger', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.logger', title='?'>logger</a> = logging.getLogger(&quot;sentry.search.postgressnuba&quot;)
<span class='lineno'> 219</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dependency_aggregations', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dependency_aggregations', title='dict'>dependency_aggregations</a> = {&quot;priority&quot;: [&quot;last_seen&quot;, &quot;times_seen&quot;]}
<span class='lineno'> 220</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.postgres_only_fields', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.postgres_only_fields', title='?'>postgres_only_fields</a> = set(
<span class='lineno'> 221</span>         [
<span class='lineno'> 222</span>             &quot;query&quot;,
<span class='lineno'> 223</span>             &quot;status&quot;,
<span class='lineno'> 224</span>             &quot;bookmarked_by&quot;,
<span class='lineno'> 225</span>             &quot;assigned_to&quot;,
<span class='lineno'> 226</span>             &quot;unassigned&quot;,
<span class='lineno'> 227</span>             &quot;subscribed_by&quot;,
<span class='lineno'> 228</span>             &quot;active_at&quot;,
<span class='lineno'> 229</span>             &quot;first_release&quot;,
<span class='lineno'> 230</span>             &quot;first_seen&quot;,
<span class='lineno'> 231</span>         ]
<span class='lineno'> 232</span>     )
<span class='lineno'> 233</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.sort_strategies', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.sort_strategies', title='dict'>sort_strategies</a> = {
<span class='lineno'> 234</span>         &quot;date&quot;: &quot;last_seen&quot;,
<span class='lineno'> 235</span>         &quot;freq&quot;: &quot;times_seen&quot;,
<span class='lineno'> 236</span>         &quot;new&quot;: &quot;first_seen&quot;,
<span class='lineno'> 237</span>         &quot;priority&quot;: &quot;priority&quot;,
<span class='lineno'> 238</span>         &quot;user&quot;: &quot;user_count&quot;,
<span class='lineno'> 239</span>     }
<span class='lineno'> 240</span> 
<span class='lineno'> 241</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.aggregation_defs', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.aggregation_defs', title='dict'>aggregation_defs</a> = {
<span class='lineno'> 242</span>         &quot;times_seen&quot;: [&quot;count()&quot;, &quot;&quot;],
<span class='lineno'> 243</span>         &quot;first_seen&quot;: [&quot;multiply(toUInt64(min(timestamp)), 1000)&quot;, &quot;&quot;],
<span class='lineno'> 244</span>         &quot;last_seen&quot;: [&quot;multiply(toUInt64(max(timestamp)), 1000)&quot;, &quot;&quot;],
<span class='lineno'> 245</span>         # https://github.com/getsentry/sentry/blob/804c85100d0003cfdda91701911f21ed5f66f67c/src/sentry/event_manager.py#L241-L271
<span class='lineno'> 246</span>         &quot;priority&quot;: [&quot;toUInt64(plus(multiply(log(times_seen), 600), last_seen))&quot;, &quot;&quot;],
<span class='lineno'> 247</span>         # Only makes sense with WITH TOTALS, returns 1 for an individual group.
<span class='lineno'> 248</span>         &quot;total&quot;: [&quot;uniq&quot;, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.ISSUE_FIELD_NAME', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.ISSUE_FIELD_NAME', title='str'>ISSUE_FIELD_NAME</a>],
<span class='lineno'> 249</span>         &quot;user_count&quot;: [&quot;uniq&quot;, &quot;tags[sentry:user]&quot;],
<span class='lineno'> 250</span>     }
<span class='lineno'> 251</span> 
<span class='lineno'> 252</span>     @property
<span class='lineno'> 253</span>     @abstractmethod
<span class='lineno'> 254</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dataset', title='PostgresSnubaQueryExecutor -> ?'>dataset</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dataset.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.dataset.self', title='PostgresSnubaQueryExecutor'>self</a>):
<span class='lineno'> 255</span>         return snuba.Dataset.Events
<span class='lineno'> 256</span> 
<span class='lineno'> 257</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query', title='(PostgresSnubaQueryExecutor, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) -> None'>query</a>(
<span class='lineno'> 258</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>,
<span class='lineno'> 259</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.projects', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.projects', title='?'>projects</a>,
<span class='lineno'> 260</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_window_start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_window_start', title='?'>retention_window_start</a>,
<span class='lineno'> 261</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', title='?'>group_queryset</a>,
<span class='lineno'> 262</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', title='?'>environments</a>,
<span class='lineno'> 263</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_by', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_by', title='?'>sort_by</a>,
<span class='lineno'> 264</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', title='?'>limit</a>,
<span class='lineno'> 265</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', title='?'>cursor</a>,
<span class='lineno'> 266</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', title='?'>count_hits</a>,
<span class='lineno'> 267</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_options', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_options', title='?'>paginator_options</a>,
<span class='lineno'> 268</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', title='?'>search_filters</a>,
<span class='lineno'> 269</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.date_from', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.date_from', title='?'>date_from</a>,
<span class='lineno'> 270</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.date_to', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.date_to', title='?'>date_to</a>,
<span class='lineno'> 271</span>     ):
<span class='lineno'> 272</span> 
<span class='lineno'> 273</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.now', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.now', title='?'>now</a> = timezone.now()
<span class='lineno'> 274</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='None'>end</a> = None
<span class='lineno'> 275</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end_params', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end_params', title='[int]'>end_params</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='int'>_f</a> for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='int'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='int'>_f</a></a> in [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.date_to', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.date_to', title='?'>date_to</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter', title='(?, ?, ?) -> int / (?, str, str) -> int'>get_search_filter</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', title='?'>search_filters</a>, &quot;date&quot;, &quot;&lt;&quot;)] if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='int'>_f</a>]
<span class='lineno'> 276</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end_params', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end_params', title='[int]'>end_params</a>:
<span class='lineno'> 277</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='int'>end</a> = min(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end_params', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end_params', title='[int]'>end_params</a>)
<span class='lineno'> 278</span> 
<span class='lineno'> 279</span>         if not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='int'>end</a>:
<span class='lineno'> 280</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='?'>end</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.now', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.now', title='?'>now</a> + ALLOWED_FUTURE_DELTA
<span class='lineno'> 281</span> 
<span class='lineno'> 282</span>             # This search is for some time window that ends with &quot;now&quot;,
<span class='lineno'> 283</span>             # so if the requested sort is `date` (`last_seen`) and there
<span class='lineno'> 284</span>             # are no other Snuba-based search predicates, we can simply
<span class='lineno'> 285</span>             # return the results from Postgres.
<span class='lineno'> 286</span>             if (
<span class='lineno'> 287</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', title='?'>cursor</a> is None
<span class='lineno'> 288</span>                 and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_by', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_by', title='?'>sort_by</a> == &quot;date&quot;
<span class='lineno'> 289</span>                 and not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', title='?'>environments</a>
<span class='lineno'> 290</span>                 and
<span class='lineno'> 291</span>                 # This handles tags and date parameters for search filters.
<span class='lineno'> 292</span>                 not [
<span class='lineno'> 293</span>                     <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sf', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sf', title='?'>sf</a>
<span class='lineno'> 294</span>                     for <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sf', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sf', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sf', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sf', title='?'>sf</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', title='?'>search_filters</a>
<span class='lineno'> 295</span>                     if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sf', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sf', title='?'>sf</a>.key.name not in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.postgres_only_fields', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.postgres_only_fields', title='?'>postgres_only_fields</a>.union([&quot;date&quot;])
<span class='lineno'> 296</span>                 ]
<span class='lineno'> 297</span>             ):
<span class='lineno'> 298</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', title='?'>group_queryset</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', title='?'>group_queryset</a>.order_by(&quot;-last_seen&quot;)
<span class='lineno'> 299</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator', title='?'>paginator</a> = DateTimePaginator(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', title='?'>group_queryset</a>, &quot;-last_seen&quot;, **paginator_options)
<span class='lineno'> 300</span>                 # When its a simple django-only search, we count_hits like normal
<span class='lineno'> 301</span>                 return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator', title='?'>paginator</a>.get_result(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', title='?'>limit</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', title='?'>cursor</a>, count_hits=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', title='?'>count_hits</a>)
<span class='lineno'> 302</span> 
<span class='lineno'> 303</span>         # TODO: Presumably we only want to search back to the project&#39;s max
<span class='lineno'> 304</span>         # retention date, which may be closer than 90 days in the past, but
<span class='lineno'> 305</span>         # apparently `retention_window_start` can be None(?), so we need a
<span class='lineno'> 306</span>         # fallback.
<span class='lineno'> 307</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', title='int'>retention_date</a> = max(
<span class='lineno'> 308</span>             [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='timedelta'>_f</a> for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='timedelta'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='timedelta'>_f</a></a> in [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_window_start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_window_start', title='?'>retention_window_start</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.now', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.now', title='?'>now</a> - timedelta(days=90)] if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='timedelta'>_f</a>]
<span class='lineno'> 309</span>         )
<span class='lineno'> 310</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start_params', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start_params', title='[int]'>start_params</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.date_from', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.date_from', title='?'>date_from</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', title='int'>retention_date</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.get_search_filter', title='(?, ?, ?) -> int / (?, str, str) -> int'>get_search_filter</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', title='?'>search_filters</a>, &quot;date&quot;, &quot;&gt;&quot;)]
<span class='lineno'> 311</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', title='int'>start</a> = max([<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='int'>_f</a> for <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='int'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='int'>_f</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start_params', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start_params', title='[int]'>start_params</a> if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._f', title='int'>_f</a>])
<span class='lineno'> 312</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='int'>end</a> = max([<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', title='int'>retention_date</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='int'>end</a>])
<span class='lineno'> 313</span> 
<span class='lineno'> 314</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', title='int'>start</a> == <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', title='int'>retention_date</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='int'>end</a> == <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_date', title='int'>retention_date</a>:
<span class='lineno'> 315</span>             # Both `start` and `end` must have been trimmed to `retention_date`,
<span class='lineno'> 316</span>             # so this entire search was against a time range that is outside of
<span class='lineno'> 317</span>             # retention. We&#39;ll return empty results to maintain backwards compatibility
<span class='lineno'> 318</span>             # with Django search (for now).
<span class='lineno'> 319</span>             return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>.empty_result
<span class='lineno'> 320</span> 
<span class='lineno'> 321</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', title='int'>start</a> &gt;= <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='int'>end</a>:
<span class='lineno'> 322</span>             # TODO: This maintains backwards compatibility with Django search, but
<span class='lineno'> 323</span>             # in the future we should find a way to notify the user that their search
<span class='lineno'> 324</span>             # is invalid.
<span class='lineno'> 325</span>             return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>.empty_result
<span class='lineno'> 326</span> 
<span class='lineno'> 327</span>         # Here we check if all the django filters reduce the set of groups down
<span class='lineno'> 328</span>         # to something that we can send down to Snuba in a `group_id IN (...)`
<span class='lineno'> 329</span>         # clause.
<span class='lineno'> 330</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_candidates', title='?'>max_candidates</a> = options.get(&quot;snuba.search.max-pre-snuba-candidates&quot;)
<span class='lineno'> 331</span> 
<span class='lineno'> 332</span>         with sentry_sdk.start_span(op=&quot;snuba_group_query&quot;) as <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.span', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.span', title='?'>span</a>:
<span class='lineno'> 333</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='list'>group_ids</a> = list(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', title='?'>group_queryset</a>.values_list(&quot;id&quot;, flat=True)[: <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_candidates', title='?'>max_candidates</a> + 1])
<span class='lineno'> 334</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.span', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.span', title='?'>span</a>.set_data(&quot;Max Candidates&quot;, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_candidates', title='?'>max_candidates</a>)
<span class='lineno'> 335</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.span', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.span', title='?'>span</a>.set_data(&quot;Result Size&quot;, len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='list'>group_ids</a>))
<span class='lineno'> 336</span>         metrics.timing(&quot;snuba.search.num_candidates&quot;, len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='list'>group_ids</a>))
<span class='lineno'> 337</span> 
<span class='lineno'> 338</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.too_many_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.too_many_candidates', title='bool'>too_many_candidates</a> = False
<span class='lineno'> 339</span>         if not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='list'>group_ids</a>:
<span class='lineno'> 340</span>             # no matches could possibly be found from this point on
<span class='lineno'> 341</span>             metrics.incr(&quot;snuba.search.no_candidates&quot;, skip_internal=False)
<span class='lineno'> 342</span>             return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>.empty_result
<span class='lineno'> 343</span>         elif len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='list'>group_ids</a>) &gt; <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_candidates', title='?'>max_candidates</a>:
<span class='lineno'> 344</span>             # If the pre-filter query didn&#39;t include anything to significantly
<span class='lineno'> 345</span>             # filter down the number of results (from &#39;first_release&#39;, &#39;query&#39;,
<span class='lineno'> 346</span>             # &#39;status&#39;, &#39;bookmarked_by&#39;, &#39;assigned_to&#39;, &#39;unassigned&#39;,
<span class='lineno'> 347</span>             # &#39;subscribed_by&#39;, &#39;active_at_from&#39;, or &#39;active_at_to&#39;) then it
<span class='lineno'> 348</span>             # might have surpassed the `max_candidates`. In this case,
<span class='lineno'> 349</span>             # we *don&#39;t* want to pass candidates down to Snuba, and instead we
<span class='lineno'> 350</span>             # want Snuba to do all the filtering/sorting it can and *then* apply
<span class='lineno'> 351</span>             # this queryset to the results from Snuba, which we call
<span class='lineno'> 352</span>             # post-filtering.
<span class='lineno'> 353</span>             metrics.incr(&quot;snuba.search.too_many_candidates&quot;, skip_internal=False)
<span class='lineno'> 354</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.too_many_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.too_many_candidates', title='bool'>too_many_candidates</a> = True
<span class='lineno'> 355</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='[?]'>group_ids</a> = []
<span class='lineno'> 356</span> 
<span class='lineno'> 357</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_field', title='str'>sort_field</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.sort_strategies', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.sort_strategies', title='dict'>sort_strategies</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_by', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_by', title='?'>sort_by</a>]
<span class='lineno'> 358</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_growth', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_growth', title='?'>chunk_growth</a> = options.get(&quot;snuba.search.chunk-growth-rate&quot;)
<span class='lineno'> 359</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_chunk_size', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_chunk_size', title='?'>max_chunk_size</a> = options.get(&quot;snuba.search.max-chunk-size&quot;)
<span class='lineno'> 360</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', title='?'>chunk_limit</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', title='?'>limit</a>
<span class='lineno'> 361</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', title='int'>offset</a> = 0
<span class='lineno'> 362</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.num_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.num_chunks', title='int'>num_chunks</a> = 0
<span class='lineno'> 363</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', title='int'>hits</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits', title='(PostgresSnubaQueryExecutor, {[?] | list}, bool, str, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, int, int) -> int / (PostgresSnubaQueryExecutor, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) -> int'>calculate_hits</a>(
<span class='lineno'> 364</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='{[?] | list}'>group_ids</a>,
<span class='lineno'> 365</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.too_many_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.too_many_candidates', title='bool'>too_many_candidates</a>,
<span class='lineno'> 366</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_field', title='str'>sort_field</a>,
<span class='lineno'> 367</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.projects', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.projects', title='?'>projects</a>,
<span class='lineno'> 368</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_window_start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.retention_window_start', title='?'>retention_window_start</a>,
<span class='lineno'> 369</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', title='?'>group_queryset</a>,
<span class='lineno'> 370</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', title='?'>environments</a>,
<span class='lineno'> 371</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_by', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_by', title='?'>sort_by</a>,
<span class='lineno'> 372</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', title='?'>limit</a>,
<span class='lineno'> 373</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', title='?'>cursor</a>,
<span class='lineno'> 374</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', title='?'>count_hits</a>,
<span class='lineno'> 375</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_options', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_options', title='?'>paginator_options</a>,
<span class='lineno'> 376</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', title='?'>search_filters</a>,
<span class='lineno'> 377</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', title='int'>start</a>,
<span class='lineno'> 378</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='int'>end</a>,
<span class='lineno'> 379</span>         )
<span class='lineno'> 380</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', title='?'>count_hits</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', title='int'>hits</a> == 0:
<span class='lineno'> 381</span>             return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>.empty_result
<span class='lineno'> 382</span> 
<span class='lineno'> 383</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>.empty_result
<span class='lineno'> 384</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_groups', title='[(?, ?)]'>result_groups</a> = []
<span class='lineno'> 385</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_group_ids', title='?'>result_group_ids</a> = set()
<span class='lineno'> 386</span> 
<span class='lineno'> 387</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_time', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_time', title='?'>max_time</a> = options.get(&quot;snuba.search.max-total-chunk-time-seconds&quot;)
<span class='lineno'> 388</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.time_start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.time_start', title='int'>time_start</a> = time.time()
<span class='lineno'> 389</span> 
<span class='lineno'> 390</span>         # Do smaller searches in chunks until we have enough results
<span class='lineno'> 391</span>         # to answer the query (or hit the end of possible results). We do
<span class='lineno'> 392</span>         # this because a common case for search is to return 100 groups
<span class='lineno'> 393</span>         # sorted by `last_seen`, and we want to avoid returning all of
<span class='lineno'> 394</span>         # a project&#39;s groups and then post-sorting them all in Postgres
<span class='lineno'> 395</span>         # when typically the first N results will do.
<span class='lineno'> 396</span>         while (time.time() - <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.time_start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.time_start', title='int'>time_start</a>) &lt; <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_time', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_time', title='?'>max_time</a>:
<span class='lineno'> 397</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.num_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.num_chunks', title='int'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.num_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.num_chunks', title='int'>num_chunks</a></a> += 1
<span class='lineno'> 398</span> 
<span class='lineno'> 399</span>             # grow the chunk size on each iteration to account for huge projects
<span class='lineno'> 400</span>             # and weird queries, up to a max size
<span class='lineno'> 401</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', title='int'>chunk_limit</a> = min(int(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', title='int'>chunk_limit</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_growth', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_growth', title='?'>chunk_growth</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_chunk_size', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.max_chunk_size', title='?'>max_chunk_size</a>)
<span class='lineno'> 402</span>             # but if we have group_ids always query for at least that many items
<span class='lineno'> 403</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', title='int'>chunk_limit</a> = max(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', title='int'>chunk_limit</a>, len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='{[?] | list}'>group_ids</a>))
<span class='lineno'> 404</span> 
<span class='lineno'> 405</span>             # {group_id: group_score, ...}
<span class='lineno'> 406</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', title='?'>snuba_groups</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.total', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.total', title='?'>total</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.self', title='PostgresSnubaQueryExecutor'>self</a>.snuba_search(
<span class='lineno'> 407</span>                 start=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.start', title='int'>start</a>,
<span class='lineno'> 408</span>                 end=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.end', title='int'>end</a>,
<span class='lineno'> 409</span>                 project_ids=[<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.p', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.p', title='?'>p</a>.id for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.p', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.p', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.p', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.p', title='?'>p</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.projects', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.projects', title='?'>projects</a>],
<span class='lineno'> 410</span>                 environment_ids=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', title='?'>environments</a> and [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environment', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environment', title='?'>environment</a>.id for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environment', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environment', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environment', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environment', title='?'>environment</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.environments', title='?'>environments</a>],
<span class='lineno'> 411</span>                 sort_field=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.sort_field', title='str'>sort_field</a>,
<span class='lineno'> 412</span>                 cursor=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', title='?'>cursor</a>,
<span class='lineno'> 413</span>                 group_ids=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='{[?] | list}'>group_ids</a>,
<span class='lineno'> 414</span>                 limit=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.chunk_limit', title='int'>chunk_limit</a>,
<span class='lineno'> 415</span>                 offset=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', title='int'>offset</a>,
<span class='lineno'> 416</span>                 search_filters=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.search_filters', title='?'>search_filters</a>,
<span class='lineno'> 417</span>             )
<span class='lineno'> 418</span>             metrics.timing(&quot;snuba.search.num_snuba_results&quot;, len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', title='?'>snuba_groups</a>))
<span class='lineno'> 419</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count', title='int'>count</a> = len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', title='?'>snuba_groups</a>)
<span class='lineno'> 420</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.more_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.more_results', title='bool'>more_results</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count', title='int'>count</a> &gt;= <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', title='?'>limit</a> and (<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', title='int'>offset</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', title='?'>limit</a>) &lt; <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.total', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.total', title='?'>total</a>
<span class='lineno'> 421</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', title='int'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.offset', title='int'>offset</a></a> += len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', title='?'>snuba_groups</a>)
<span class='lineno'> 422</span> 
<span class='lineno'> 423</span>             if not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', title='?'>snuba_groups</a>:
<span class='lineno'> 424</span>                 break
<span class='lineno'> 425</span> 
<span class='lineno'> 426</span>             if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='{[?] | list}'>group_ids</a>:
<span class='lineno'> 427</span>                 # pre-filtered candidates were passed down to Snuba, so we&#39;re
<span class='lineno'> 428</span>                 # finished with filtering and these are the only results. Note
<span class='lineno'> 429</span>                 # that because we set the chunk size to at least the size of
<span class='lineno'> 430</span>                 # the group_ids, we know we got all of them (ie there are
<span class='lineno'> 431</span>                 # no more chunks after the first)
<span class='lineno'> 432</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_groups', title='?'>result_groups</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', title='?'>snuba_groups</a>
<span class='lineno'> 433</span>                 if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.count_hits', title='?'>count_hits</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', title='int'>hits</a> is None:
<span class='lineno'> 434</span>                     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', title='int'>hits</a> = len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', title='?'>snuba_groups</a>)
<span class='lineno'> 435</span>             else:
<span class='lineno'> 436</span>                 # pre-filtered candidates were *not* passed down to Snuba,
<span class='lineno'> 437</span>                 # so we need to do post-filtering to verify Sentry DB predicates
<span class='lineno'> 438</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.filtered_group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.filtered_group_ids', title='?'>filtered_group_ids</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_queryset', title='?'>group_queryset</a>.filter(
<span class='lineno'> 439</span>                     id__in=[<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.gid', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.gid', title='?'>gid</a> for <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.gid', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.gid', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.gid', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.gid', title='?'>gid</a></a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query._', title='?'>_</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', title='?'>snuba_groups</a>]
<span class='lineno'> 440</span>                 ).values_list(&quot;id&quot;, flat=True)
<span class='lineno'> 441</span> 
<span class='lineno'> 442</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_to_score', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_to_score', title='dict'>group_to_score</a> = dict(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.snuba_groups', title='?'>snuba_groups</a>)
<span class='lineno'> 443</span>                 for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', title='?'>group_id</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.filtered_group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.filtered_group_ids', title='?'>filtered_group_ids</a>:
<span class='lineno'> 444</span>                     if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', title='?'>group_id</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_group_ids', title='?'>result_group_ids</a>:
<span class='lineno'> 445</span>                         # because we&#39;re doing multiple Snuba queries, which
<span class='lineno'> 446</span>                         # happen outside of a transaction, there is a small possibility
<span class='lineno'> 447</span>                         # of groups moving around in the sort scoring underneath us,
<span class='lineno'> 448</span>                         # so we at least want to protect against duplicates
<span class='lineno'> 449</span>                         continue
<span class='lineno'> 450</span> 
<span class='lineno'> 451</span>                     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_score', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_score', title='?'>group_score</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_to_score', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_to_score', title='dict'>group_to_score</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', title='?'>group_id</a>]
<span class='lineno'> 452</span>                     <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_group_ids', title='?'>result_group_ids</a>.add(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', title='?'>group_id</a>)
<span class='lineno'> 453</span>                     <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_groups', title='[(?, ?)]'>result_groups</a>.append((<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_id', title='?'>group_id</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_score', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_score', title='?'>group_score</a>))
<span class='lineno'> 454</span> 
<span class='lineno'> 455</span>             # break the query loop for one of three reasons:
<span class='lineno'> 456</span>             # * we started with Postgres candidates and so only do one Snuba query max
<span class='lineno'> 457</span>             # * the paginator is returning enough results to satisfy the query (&gt;= the limit)
<span class='lineno'> 458</span>             # * there are no more groups in Snuba to post-filter
<span class='lineno'> 459</span>             # TODO do we actually have to rebuild this SequencePaginator every time
<span class='lineno'> 460</span>             # or can we just make it after we&#39;ve broken out of the loop?
<span class='lineno'> 461</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a> = SequencePaginator(
<span class='lineno'> 462</span>                 [(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.score', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.score', title='?'>score</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.id', title='?'>id</a>) for (<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.id', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.id', title='?'>id</a></a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.score', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.score', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.score', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.score', title='?'>score</a></a>) in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.result_groups', title='[(?, ?)]'>result_groups</a>], reverse=True, **paginator_options
<span class='lineno'> 463</span>             ).get_result(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', title='?'>limit</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', title='?'>cursor</a>, known_hits=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.hits', title='int'>hits</a>)
<span class='lineno'> 464</span> 
<span class='lineno'> 465</span>             if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.group_ids', title='{[?] | list}'>group_ids</a> or len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a>.results) &gt;= <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', title='?'>limit</a> or not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.more_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.more_results', title='bool'>more_results</a>:
<span class='lineno'> 466</span>                 break
<span class='lineno'> 467</span> 
<span class='lineno'> 468</span>         # HACK: We&#39;re using the SequencePaginator to mask the complexities of going
<span class='lineno'> 469</span>         # back and forth between two databases. This causes a problem with pagination
<span class='lineno'> 470</span>         # because we&#39;re &#39;lying&#39; to the SequencePaginator (it thinks it has the entire
<span class='lineno'> 471</span>         # result set in memory when it does not). For this reason we need to make some
<span class='lineno'> 472</span>         # best guesses as to whether the `prev` and `next` cursors have more results.
<span class='lineno'> 473</span> 
<span class='lineno'> 474</span>         if len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a>.results) == <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.limit', title='?'>limit</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.more_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.more_results', title='bool'>more_results</a>:
<span class='lineno'> 475</span>             # Because we are going back and forth between DBs there is a small
<span class='lineno'> 476</span>             # chance that we will hand the SequencePaginator exactly `limit`
<span class='lineno'> 477</span>             # items. In this case the paginator will assume there are no more
<span class='lineno'> 478</span>             # results, so we need to override the `next` cursor&#39;s results.
<span class='lineno'> 479</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a>.next.has_results = True
<span class='lineno'> 480</span> 
<span class='lineno'> 481</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', title='?'>cursor</a> is not None and (not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.cursor', title='?'>cursor</a>.is_prev or len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a>.results) &gt; 0):
<span class='lineno'> 482</span>             # If the user passed a cursor, and it isn&#39;t already a 0 result `is_prev`
<span class='lineno'> 483</span>             # cursor, then it&#39;s worth allowing them to go back a page to check for
<span class='lineno'> 484</span>             # more results.
<span class='lineno'> 485</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a>.prev.has_results = True
<span class='lineno'> 486</span> 
<span class='lineno'> 487</span>         metrics.timing(&quot;snuba.search.num_chunks&quot;, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.num_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.num_chunks', title='int'>num_chunks</a>)
<span class='lineno'> 488</span> 
<span class='lineno'> 489</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.groups', title='?'>groups</a> = Group.objects.in_bulk(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a>.results)
<span class='lineno'> 490</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a>.results = [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.groups', title='?'>groups</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.k', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.k', title='?'>k</a>] for <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.k', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.k', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.k', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.k', title='?'>k</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a>.results if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.k', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.k', title='?'>k</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.groups', title='?'>groups</a>]
<span class='lineno'> 491</span> 
<span class='lineno'> 492</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.query.paginator_results', title='?'>paginator_results</a>
<span class='lineno'> 493</span> 
<span class='lineno'> 494</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits', title='(PostgresSnubaQueryExecutor, {[?] | list}, bool, str, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, int, int) -> int / (PostgresSnubaQueryExecutor, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) -> int'>calculate_hits</a>(
<span class='lineno'> 495</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.self', title='PostgresSnubaQueryExecutor'>self</a>,
<span class='lineno'> 496</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.group_ids', title='{[?] | list}'>group_ids</a>,
<span class='lineno'> 497</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.too_many_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.too_many_candidates', title='bool'>too_many_candidates</a>,
<span class='lineno'> 498</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sort_field', title='str'>sort_field</a>,
<span class='lineno'> 499</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.projects', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.projects', title='?'>projects</a>,
<span class='lineno'> 500</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.retention_window_start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.retention_window_start', title='?'>retention_window_start</a>,
<span class='lineno'> 501</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.group_queryset', title='?'>group_queryset</a>,
<span class='lineno'> 502</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environments', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environments', title='?'>environments</a>,
<span class='lineno'> 503</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sort_by', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sort_by', title='?'>sort_by</a>,
<span class='lineno'> 504</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.limit', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.limit', title='?'>limit</a>,
<span class='lineno'> 505</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.cursor', title='?'>cursor</a>,
<span class='lineno'> 506</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.count_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.count_hits', title='?'>count_hits</a>,
<span class='lineno'> 507</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.paginator_options', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.paginator_options', title='?'>paginator_options</a>,
<span class='lineno'> 508</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.search_filters', title='?'>search_filters</a>,
<span class='lineno'> 509</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.start', title='int'>start</a>,
<span class='lineno'> 510</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.end', title='int'>end</a>,
<span class='lineno'> 511</span>     ):
<span class='lineno'> 512</span>         &quot;&quot;&quot;
<span class='lineno'> 513</span>         This method should return an integer representing the number of hits (results) of your search.
<span class='lineno'> 514</span>         It will return 0 if hits were calculated and there are none.
<span class='lineno'> 515</span>         It will return None if hits were not calculated.
<span class='lineno'> 516</span>         &quot;&quot;&quot;
<span class='lineno'> 517</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.count_hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.count_hits', title='?'>count_hits</a> is False:
<span class='lineno'> 518</span>             return None
<span class='lineno'> 519</span>         elif <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.too_many_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.too_many_candidates', title='bool'>too_many_candidates</a> or <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.cursor', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.cursor', title='?'>cursor</a> is not None:
<span class='lineno'> 520</span>             # If we had too many candidates to reasonably pass down to snuba,
<span class='lineno'> 521</span>             # or if we have a cursor that bisects the overall result set (such
<span class='lineno'> 522</span>             # that our query only sees results on one side of the cursor) then
<span class='lineno'> 523</span>             # we need an alternative way to figure out the total hits that this
<span class='lineno'> 524</span>             # query has.
<span class='lineno'> 525</span> 
<span class='lineno'> 526</span>             # To do this, we get a sample of groups matching the snuba side of
<span class='lineno'> 527</span>             # the query, and see how many of those pass the post-filter in
<span class='lineno'> 528</span>             # postgres. This should give us an estimate of the total number of
<span class='lineno'> 529</span>             # snuba matches that will be overall matches, which we can use to
<span class='lineno'> 530</span>             # get an estimate for X-Hits.
<span class='lineno'> 531</span> 
<span class='lineno'> 532</span>             # The sampling is not simple random sampling. It will return *all*
<span class='lineno'> 533</span>             # matching groups if there are less than N groups matching the
<span class='lineno'> 534</span>             # query, or it will return a random, deterministic subset of N of
<span class='lineno'> 535</span>             # the groups if there are more than N overall matches. This means
<span class='lineno'> 536</span>             # that the &quot;estimate&quot; is actually an accurate result when there are
<span class='lineno'> 537</span>             # less than N matching groups.
<span class='lineno'> 538</span> 
<span class='lineno'> 539</span>             # The number of samples required to achieve a certain error bound
<span class='lineno'> 540</span>             # with a certain confidence interval can be calculated from a
<span class='lineno'> 541</span>             # rearrangement of the normal approximation (Wald) confidence
<span class='lineno'> 542</span>             # interval formula:
<span class='lineno'> 543</span>             #
<span class='lineno'> 544</span>             # https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval
<span class='lineno'> 545</span>             #
<span class='lineno'> 546</span>             # Effectively if we want the estimate to be within +/- 10% of the
<span class='lineno'> 547</span>             # real value with 95% confidence, we would need (1.96^2 * p*(1-p))
<span class='lineno'> 548</span>             # / 0.1^2 samples. With a starting assumption of p=0.5 (this
<span class='lineno'> 549</span>             # requires the most samples) we would need 96 samples to achieve
<span class='lineno'> 550</span>             # +/-10% @ 95% confidence.
<span class='lineno'> 551</span> 
<span class='lineno'> 552</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sample_size', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sample_size', title='?'>sample_size</a> = options.get(&quot;snuba.search.hits-sample-size&quot;)
<span class='lineno'> 553</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.kwargs', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.kwargs', title='dict'>kwargs</a> = dict(
<span class='lineno'> 554</span>                 start=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.start', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.start', title='int'>start</a>,
<span class='lineno'> 555</span>                 end=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.end', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.end', title='int'>end</a>,
<span class='lineno'> 556</span>                 project_ids=[<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.p', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.p', title='?'>p</a>.id for <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.p', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.p', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.p', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.p', title='?'>p</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.projects', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.projects', title='?'>projects</a>],
<span class='lineno'> 557</span>                 environment_ids=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environments', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environments', title='?'>environments</a> and [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environment', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environment', title='?'>environment</a>.id for <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environment', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environment', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environment', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environment', title='?'>environment</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environments', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.environments', title='?'>environments</a>],
<span class='lineno'> 558</span>                 sort_field=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sort_field', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sort_field', title='str'>sort_field</a>,
<span class='lineno'> 559</span>                 limit=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sample_size', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.sample_size', title='?'>sample_size</a>,
<span class='lineno'> 560</span>                 offset=0,
<span class='lineno'> 561</span>                 get_sample=True,
<span class='lineno'> 562</span>                 search_filters=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.search_filters', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.search_filters', title='?'>search_filters</a>,
<span class='lineno'> 563</span>             )
<span class='lineno'> 564</span>             if not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.too_many_candidates', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.too_many_candidates', title='bool'>too_many_candidates</a>:
<span class='lineno'> 565</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.kwargs', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.kwargs', title='dict'>kwargs</a>[&quot;group_ids&quot;] = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.group_ids', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.group_ids', title='{[?] | list}'>group_ids</a>
<span class='lineno'> 566</span> 
<span class='lineno'> 567</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_groups', title='?'>snuba_groups</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_total', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_total', title='?'>snuba_total</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.self', title='PostgresSnubaQueryExecutor'>self</a>.snuba_search(**kwargs)
<span class='lineno'> 568</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_count', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_count', title='int'>snuba_count</a> = len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_groups', title='?'>snuba_groups</a>)
<span class='lineno'> 569</span>             if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_count', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_count', title='int'>snuba_count</a> == 0:
<span class='lineno'> 570</span>                 # Maybe check for 0 hits and return EMPTY_RESULT in ::query? self.empty_result
<span class='lineno'> 571</span>                 return 0
<span class='lineno'> 572</span>             else:
<span class='lineno'> 573</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.filtered_count', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.filtered_count', title='?'>filtered_count</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.group_queryset', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.group_queryset', title='?'>group_queryset</a>.filter(
<span class='lineno'> 574</span>                     id__in=[<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.gid', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.gid', title='?'>gid</a> for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.gid', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.gid', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.gid', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.gid', title='?'>gid</a></a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits._', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits._', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits._', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits._', title='?'>_</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_groups', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_groups', title='?'>snuba_groups</a>]
<span class='lineno'> 575</span>                 ).count()
<span class='lineno'> 576</span> 
<span class='lineno'> 577</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.hit_ratio', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.hit_ratio', title='float'>hit_ratio</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.filtered_count', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.filtered_count', title='?'>filtered_count</a> / float(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_count', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_count', title='int'>snuba_count</a>)
<span class='lineno'> 578</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.hits', title='int'>hits</a> = int(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.hit_ratio', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.hit_ratio', title='float'>hit_ratio</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_total', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.snuba_total', title='?'>snuba_total</a>)
<span class='lineno'> 579</span>                 return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.hits', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.search.snuba.executors.PostgresSnubaQueryExecutor.calculate_hits.hits', title='int'>hits</a>
<span class='lineno'> 580</span> 
<span class='lineno'> 581</span>         return None
</pre></td></tr></table></body></html>