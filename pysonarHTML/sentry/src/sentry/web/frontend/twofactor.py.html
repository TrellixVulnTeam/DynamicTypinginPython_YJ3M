<html>
<head>
<meta charset="utf-8">
<title>/home/xxm/Desktop/EMSE/dataset/sentry/src/sentry/web/frontend/twofactor.py</title>
<style type='text/css'>
body { color: #666666; }
a {
    text-decoration: none; color: #5AA2A7;
    border: solid 1px rgba(255,255,255,0);
}
a.active {
    background: -webkit-linear-gradient(top,rgba(255, 255, 200, 0.35) 0,rgba(255, 255, 200, 0.55) 100%);
    border: solid 1px #E5E600;
}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #cccccc;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px solid orange; padding-bottom: 1px}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted;

function highlight(xid)
{
    var elms = document.querySelectorAll('[xid="' + xid + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "active";
    }
    highlighted = xid;
}

function clearHighlight() {
    var elms = document.querySelectorAll('[xid="' + highlighted + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "";
    }
}

window.onload =
    function (e) {
        var tags = document.getElementsByTagName("A")
        for (var i = 0; i < tags.length; i++) {
            tags[i].onmouseover =
                function (e) {
                    clearHighlight();
                    var xid = e.toElement.getAttribute('xid');
                    highlight(xid);
                }
        }
    }</script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_NAME', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_NAME'>COOKIE_NAME</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_MAX_AGE', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_MAX_AGE'>COOKIE_MAX_AGE</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView'>TwoFactorAuthView</a><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.auth_required', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.auth_required'>auth_required</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin'>perform_signin</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin'>fail_signin</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface'>negotiate_interface</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces'>get_other_interfaces</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp'>validate_otp</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle'>handle</a></li></ul>
</li><li><a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid', xid='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid'>u2f_appid</a></li></ul>
</td><td><pre><span class='lineno'>   1</span> from __future__ import absolute_import
<span class='lineno'>   2</span> 
<span class='lineno'>   3</span> import six
<span class='lineno'>   4</span> import time
<span class='lineno'>   5</span> 
<span class='lineno'>   6</span> from django.http import HttpResponseRedirect, HttpResponse
<span class='lineno'>   7</span> from django.utils.translation import ugettext as _
<span class='lineno'>   8</span> 
<span class='lineno'>   9</span> from sentry import options
<span class='lineno'>  10</span> from sentry.app import ratelimiter
<span class='lineno'>  11</span> from sentry.web.frontend.base import BaseView
<span class='lineno'>  12</span> from sentry.web.forms.accounts import TwoFactorForm
<span class='lineno'>  13</span> from sentry.web.helpers import render_to_response
<span class='lineno'>  14</span> from sentry.utils import auth, json
<span class='lineno'>  15</span> from sentry.models import Authenticator
<span class='lineno'>  16</span> 
<span class='lineno'>  17</span> <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_NAME', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_NAME', title='str'>COOKIE_NAME</a> = &quot;s2fai&quot;
<span class='lineno'>  18</span> <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_MAX_AGE', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_MAX_AGE', title='int'>COOKIE_MAX_AGE</a> = 60 * 60 * 24 * 31
<span class='lineno'>  19</span> 
<span class='lineno'>  20</span> 
<span class='lineno'>  21</span> class <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView', title='<TwoFactorAuthView>'>TwoFactorAuthView</a>(BaseView):
<span class='lineno'>  22</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.auth_required', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.auth_required', title='bool'>auth_required</a> = False
<span class='lineno'>  23</span> 
<span class='lineno'>  24</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin', title='(TwoFactorAuthView, ?, ?, None) -> None'>perform_signin</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.self', title='TwoFactorAuthView'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.request', title='?'>request</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.user', title='?'>user</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', title='None'>interface</a>=None):
<span class='lineno'>  25</span>         assert auth.login(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.request', title='?'>request</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.user', title='?'>user</a>, passed_2fa=True)
<span class='lineno'>  26</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.rv', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.rv', title='?'>rv</a> = HttpResponseRedirect(auth.get_login_redirect(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.request', title='?'>request</a>))
<span class='lineno'>  27</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', title='None'>interface</a> is not None:
<span class='lineno'>  28</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', title='None'>interface</a>.authenticator.mark_used()
<span class='lineno'>  29</span>             if not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', title='None'>interface</a>.is_backup_interface:
<span class='lineno'>  30</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.rv', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.rv', title='?'>rv</a>.set_cookie(
<span class='lineno'>  31</span>                     <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_NAME', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_NAME', title='str'>COOKIE_NAME</a>,
<span class='lineno'>  32</span>                     six.text_type(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.interface', title='None'>interface</a>.type).encode(&quot;utf-8&quot;),
<span class='lineno'>  33</span>                     max_age=<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_MAX_AGE', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_MAX_AGE', title='int'>COOKIE_MAX_AGE</a>,
<span class='lineno'>  34</span>                     path=&quot;/&quot;,
<span class='lineno'>  35</span>                 )
<span class='lineno'>  36</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.rv', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin.rv', title='?'>rv</a>
<span class='lineno'>  37</span> 
<span class='lineno'>  38</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin', title='(TwoFactorAuthView, ?, ?, ?) -> None'>fail_signin</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.self', title='TwoFactorAuthView'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.request', title='?'>request</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.user', title='?'>user</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.form', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.form', title='?'>form</a>):
<span class='lineno'>  39</span>         # Ladies and gentlemen: the world&#39;s shittiest bruteforce
<span class='lineno'>  40</span>         # prevention.
<span class='lineno'>  41</span>         time.sleep(2.0)
<span class='lineno'>  42</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.form', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin.form', title='?'>form</a>.errors[&quot;__all__&quot;] = [_(&quot;Invalid confirmation code. Try again.&quot;)]
<span class='lineno'>  43</span> 
<span class='lineno'>  44</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface', title='(TwoFactorAuthView, ?, ?) -> None'>negotiate_interface</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.self', title='TwoFactorAuthView'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.request', title='?'>request</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', title='?'>interfaces</a>):
<span class='lineno'>  45</span>         # If there is only one interface, just pick that one.
<span class='lineno'>  46</span>         if len(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', title='?'>interfaces</a>) == 1:
<span class='lineno'>  47</span>             return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', title='?'>interfaces</a>[0]
<span class='lineno'>  48</span> 
<span class='lineno'>  49</span>         # Next option is to go with the interface that was selected in the
<span class='lineno'>  50</span>         # URL.
<span class='lineno'>  51</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_id', title='?'>interface_id</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.request', title='?'>request</a>.GET.get(&quot;interface&quot;)
<span class='lineno'>  52</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_id', title='?'>interface_id</a>:
<span class='lineno'>  53</span>             for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', title='?'>interface</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', title='?'>interfaces</a>:
<span class='lineno'>  54</span>                 if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', title='?'>interface</a>.interface_id == <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_id', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_id', title='?'>interface_id</a>:
<span class='lineno'>  55</span>                     return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', title='?'>interface</a>
<span class='lineno'>  56</span> 
<span class='lineno'>  57</span>         # Fallback case an interface was remembered in a cookie, go with that
<span class='lineno'>  58</span>         # one first.
<span class='lineno'>  59</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_type', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_type', title='?'>interface_type</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.request', title='?'>request</a>.COOKIES.get(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_NAME', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.COOKIE_NAME', title='str'>COOKIE_NAME</a>)
<span class='lineno'>  60</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_type', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_type', title='?'>interface_type</a>:
<span class='lineno'>  61</span>             for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', title='?'>interface</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', title='?'>interfaces</a>:
<span class='lineno'>  62</span>                 if six.text_type(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', title='?'>interface</a>.type) == <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_type', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface_type', title='?'>interface_type</a>:
<span class='lineno'>  63</span>                     return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interface', title='?'>interface</a>
<span class='lineno'>  64</span> 
<span class='lineno'>  65</span>         # Fallback is to go the highest ranked as default.  This will be
<span class='lineno'>  66</span>         # the most common path for first time users.
<span class='lineno'>  67</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface.interfaces', title='?'>interfaces</a>[0]
<span class='lineno'>  68</span> 
<span class='lineno'>  69</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces', title='(TwoFactorAuthView, None, ?) -> [None] / (TwoFactorAuthView, ?, ?) -> [None]'>get_other_interfaces</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.self', title='TwoFactorAuthView'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.selected', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.selected', title='None'>selected</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.all', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.all', title='?'>all</a>):
<span class='lineno'>  70</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.rv', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.rv', title='[None]'>rv</a> = []
<span class='lineno'>  71</span> 
<span class='lineno'>  72</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.can_validate_otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.can_validate_otp', title='?'>can_validate_otp</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.selected', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.selected', title='None'>selected</a>.can_validate_otp
<span class='lineno'>  73</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', title='None'>backup_interface</a> = None
<span class='lineno'>  74</span> 
<span class='lineno'>  75</span>         for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.idx', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.idx', title='?'>idx</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', title='?'>interface</a> in enumerate(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.all', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.all', title='?'>all</a>):
<span class='lineno'>  76</span>             if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', title='?'>interface</a>.interface_id == <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.selected', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.selected', title='None'>selected</a>.interface_id:
<span class='lineno'>  77</span>                 continue
<span class='lineno'>  78</span>             if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.idx', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.idx', title='?'>idx</a> == 0 or <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', title='?'>interface</a>.requires_activation:
<span class='lineno'>  79</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.rv', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.rv', title='[None]'>rv</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', title='?'>interface</a>)
<span class='lineno'>  80</span>                 if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', title='?'>interface</a>.can_validate_otp:
<span class='lineno'>  81</span>                     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.can_validate_otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.can_validate_otp', title='bool'>can_validate_otp</a> = True
<span class='lineno'>  82</span>             if (
<span class='lineno'>  83</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', title='None'>backup_interface</a> is None
<span class='lineno'>  84</span>                 and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', title='?'>interface</a>.can_validate_otp
<span class='lineno'>  85</span>                 and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', title='?'>interface</a>.is_backup_interface
<span class='lineno'>  86</span>             ):
<span class='lineno'>  87</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', title='?'>backup_interface</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.interface', title='?'>interface</a>
<span class='lineno'>  88</span> 
<span class='lineno'>  89</span>         if not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.can_validate_otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.can_validate_otp', title='bool'>can_validate_otp</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', title='None'>backup_interface</a> is not None:
<span class='lineno'>  90</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.rv', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.rv', title='[None]'>rv</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.backup_interface', title='None'>backup_interface</a>)
<span class='lineno'>  91</span> 
<span class='lineno'>  92</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.rv', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces.rv', title='[None]'>rv</a>
<span class='lineno'>  93</span> 
<span class='lineno'>  94</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp', title='(TwoFactorAuthView, ?, None, ?) -> None / (TwoFactorAuthView, ?, ?, None) -> None'>validate_otp</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.self', title='TwoFactorAuthView'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.otp', title='?'>otp</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.selected_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.selected_interface', title='None'>selected_interface</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.all_interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.all_interfaces', title='None'>all_interfaces</a>=None):
<span class='lineno'>  95</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.selected_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.selected_interface', title='None'>selected_interface</a>.validate_otp(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.otp', title='?'>otp</a>):
<span class='lineno'>  96</span>             return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.selected_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.selected_interface', title='None'>selected_interface</a>
<span class='lineno'>  97</span>         for <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', title='?'>interface</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.all_interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.all_interfaces', title='None'>all_interfaces</a> or ():
<span class='lineno'>  98</span>             if (
<span class='lineno'>  99</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', title='?'>interface</a>.interface_id != <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.selected_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.selected_interface', title='None'>selected_interface</a>.interface_id
<span class='lineno'> 100</span>                 and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', title='?'>interface</a>.is_backup_interface
<span class='lineno'> 101</span>                 and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', title='?'>interface</a>.validate_otp(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.otp', title='?'>otp</a>)
<span class='lineno'> 102</span>             ):
<span class='lineno'> 103</span>                 return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp.interface', title='?'>interface</a>
<span class='lineno'> 104</span> 
<span class='lineno'> 105</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle', title='(TwoFactorAuthView, ?) -> None'>handle</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', title='TwoFactorAuthView'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>):
<span class='lineno'> 106</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', title='?'>user</a> = auth.get_pending_2fa_user(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>)
<span class='lineno'> 107</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', title='?'>user</a> is None:
<span class='lineno'> 108</span>             return HttpResponseRedirect(auth.get_login_url())
<span class='lineno'> 109</span> 
<span class='lineno'> 110</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', title='?'>interfaces</a> = Authenticator.objects.all_interfaces_for_user(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', title='?'>user</a>)
<span class='lineno'> 111</span> 
<span class='lineno'> 112</span>         # If for whatever reason we ended up here but the user has no 2FA
<span class='lineno'> 113</span>         # enabled, we just continue successfully.
<span class='lineno'> 114</span>         if not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', title='?'>interfaces</a>:
<span class='lineno'> 115</span>             return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', title='TwoFactorAuthView'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin', title='(TwoFactorAuthView, ?, ?, None) -> None'>perform_signin</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', title='?'>user</a>)
<span class='lineno'> 116</span> 
<span class='lineno'> 117</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', title='None'>challenge</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', title='None'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', title='None'>activation</a></a> = None
<span class='lineno'> 118</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', title='None'>interface</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', title='TwoFactorAuthView'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.negotiate_interface', title='(TwoFactorAuthView, ?, ?) -> None'>negotiate_interface</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', title='?'>interfaces</a>)
<span class='lineno'> 119</span> 
<span class='lineno'> 120</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>.method == &quot;POST&quot; and ratelimiter.is_limited(
<span class='lineno'> 121</span>             u&quot;auth-2fa:user:{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', title='?'>user</a>.id), limit=5, window=60
<span class='lineno'> 122</span>         ):
<span class='lineno'> 123</span>             # TODO: Maybe email the account owner or do something to notify someone
<span class='lineno'> 124</span>             # This would probably be good for them to know.
<span class='lineno'> 125</span>             return HttpResponse(
<span class='lineno'> 126</span>                 &quot;You have made too many 2FA attempts. Please try again later.&quot;,
<span class='lineno'> 127</span>                 content_type=&quot;text/plain&quot;,
<span class='lineno'> 128</span>                 status=429,
<span class='lineno'> 129</span>             )
<span class='lineno'> 130</span> 
<span class='lineno'> 131</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>.method == &quot;GET&quot;:
<span class='lineno'> 132</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', title='?'>activation</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', title='None'>interface</a>.activate(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>)
<span class='lineno'> 133</span>             if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', title='?'>activation</a> is not None and <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', title='?'>activation</a>.type == &quot;challenge&quot;:
<span class='lineno'> 134</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', title='?'>challenge</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', title='?'>activation</a>.challenge
<span class='lineno'> 135</span>         elif &quot;challenge&quot; in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>.POST:
<span class='lineno'> 136</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', title='?'>challenge</a> = json.loads(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>.POST[&quot;challenge&quot;])
<span class='lineno'> 137</span> 
<span class='lineno'> 138</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.form', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.form', title='?'>form</a> = TwoFactorForm()
<span class='lineno'> 139</span> 
<span class='lineno'> 140</span>         # If an OTP response was supplied, we try to make it pass.
<span class='lineno'> 141</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.otp', title='?'>otp</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>.POST.get(&quot;otp&quot;)
<span class='lineno'> 142</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.otp', title='?'>otp</a>:
<span class='lineno'> 143</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.used_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.used_interface', title='None'>used_interface</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', title='TwoFactorAuthView'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.validate_otp', title='(TwoFactorAuthView, ?, None, ?) -> None / (TwoFactorAuthView, ?, ?, None) -> None'>validate_otp</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.otp', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.otp', title='?'>otp</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', title='None'>interface</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', title='?'>interfaces</a>)
<span class='lineno'> 144</span>             if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.used_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.used_interface', title='None'>used_interface</a> is not None:
<span class='lineno'> 145</span>                 return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', title='TwoFactorAuthView'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin', title='(TwoFactorAuthView, ?, ?, None) -> None'>perform_signin</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', title='?'>user</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.used_interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.used_interface', title='None'>used_interface</a>)
<span class='lineno'> 146</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', title='TwoFactorAuthView'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin', title='(TwoFactorAuthView, ?, ?, ?) -> None'>fail_signin</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', title='?'>user</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.form', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.form', title='?'>form</a>)
<span class='lineno'> 147</span> 
<span class='lineno'> 148</span>         # If a challenge and response exists, validate
<span class='lineno'> 149</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', title='None'>challenge</a>:
<span class='lineno'> 150</span>             <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', title='?'>response</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>.POST.get(&quot;response&quot;)
<span class='lineno'> 151</span>             if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', title='?'>response</a>:
<span class='lineno'> 152</span>                 <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', title='?'>response</a> = json.loads(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', title='?'>response</a>)
<span class='lineno'> 153</span>                 if <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', title='None'>interface</a>.validate_response(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.challenge', title='None'>challenge</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.response', title='?'>response</a>):
<span class='lineno'> 154</span>                     return <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', title='TwoFactorAuthView'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.perform_signin', title='(TwoFactorAuthView, ?, ?, None) -> None'>perform_signin</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', title='?'>user</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', title='None'>interface</a>)
<span class='lineno'> 155</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', title='TwoFactorAuthView'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.fail_signin', title='(TwoFactorAuthView, ?, ?, ?) -> None'>fail_signin</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.user', title='?'>user</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.form', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.form', title='?'>form</a>)
<span class='lineno'> 156</span> 
<span class='lineno'> 157</span>         return render_to_response(
<span class='lineno'> 158</span>             [&quot;sentry/twofactor_%s.html&quot; % <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', title='None'>interface</a>.interface_id, &quot;sentry/twofactor.html&quot;],
<span class='lineno'> 159</span>             {
<span class='lineno'> 160</span>                 &quot;form&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.form', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.form', title='?'>form</a>,
<span class='lineno'> 161</span>                 &quot;interface&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', title='None'>interface</a>,
<span class='lineno'> 162</span>                 &quot;other_interfaces&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.self', title='TwoFactorAuthView'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.get_other_interfaces', title='(TwoFactorAuthView, None, ?) -> [None] / (TwoFactorAuthView, ?, ?) -> [None]'>get_other_interfaces</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interface', title='None'>interface</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.interfaces', title='?'>interfaces</a>),
<span class='lineno'> 163</span>                 &quot;activation&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.activation', title='None'>activation</a>,
<span class='lineno'> 164</span>             },
<span class='lineno'> 165</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.TwoFactorAuthView.handle.request', title='?'>request</a>,
<span class='lineno'> 166</span>             status=200,
<span class='lineno'> 167</span>         )
<span class='lineno'> 168</span> 
<span class='lineno'> 169</span> 
<span class='lineno'> 170</span> def <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid', title='? -> None'>u2f_appid</a>(<a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.request', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.request', title='?'>request</a>):
<span class='lineno'> 171</span>     <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.facets', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.facets', title='?'>facets</a> = options.get(&quot;u2f.facets&quot;)
<span class='lineno'> 172</span>     if not <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.facets', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.facets', title='?'>facets</a>:
<span class='lineno'> 173</span>         <a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.facets', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.facets', title='[?]'>facets</a> = [options.get(&quot;system.url-prefix&quot;)]
<span class='lineno'> 174</span>     return HttpResponse(
<span class='lineno'> 175</span>         json.dumps(
<span class='lineno'> 176</span>             {
<span class='lineno'> 177</span>                 &quot;trustedFacets&quot;: [
<span class='lineno'> 178</span>                     {&quot;version&quot;: {&quot;major&quot;: 1, &quot;minor&quot;: 0}, &quot;ids&quot;: [<a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.x', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.x', title='?'>x</a>.rstrip(&quot;/&quot;) for <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.x', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.x', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.x', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.x', title='?'>x</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.facets', xid ='.home.xxm.Desktop.EMSE.dataset.sentry.src.sentry.web.frontend.twofactor.u2f_appid.facets', title='[?]'>facets</a>]}
<span class='lineno'> 179</span>                 ]
<span class='lineno'> 180</span>             }
<span class='lineno'> 181</span>         ),
<span class='lineno'> 182</span>         content_type=&quot;application/fido.trusted-apps+json&quot;,
<span class='lineno'> 183</span>     )
</pre></td></tr></table></body></html>