<html>
<head>
<meta charset="utf-8">
<title>/home/xxm/Desktop/EMSE/dataset/faceswap/lib/vgg_face.py</title>
<style type='text/css'>
body { color: #666666; }
a {
    text-decoration: none; color: #5AA2A7;
    border: solid 1px rgba(255,255,255,0);
}
a.active {
    background: -webkit-linear-gradient(top,rgba(255, 255, 200, 0.35) 0,rgba(255, 255, 200, 0.55) 100%);
    border: solid 1px #E5E600;
}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #cccccc;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px solid orange; padding-bottom: 1px}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted;

function highlight(xid)
{
    var elms = document.querySelectorAll('[xid="' + xid + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "active";
    }
    highlighted = xid;
}

function clearHighlight() {
    var elms = document.querySelectorAll('[xid="' + highlighted + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "";
    }
}

window.onload =
    function (e) {
        var tags = document.getElementsByTagName("A")
        for (var i = 0; i < tags.length; i++) {
            tags[i].onmouseover =
                function (e) {
                    clearHighlight();
                    var xid = e.toElement.getAttribute('xid');
                    highlight(xid);
                }
        }
    }</script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger'>logger</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace'>VGGFace</a><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__'>__init__</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model'>get_model</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend'>get_backend</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict'>predict</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face'>resize_face</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity'>find_cosine_similiarity</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity'>sorted_similarity</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation'>seriation</a></li></ul>
</li></ul>
</td><td><pre><span class='lineno'>   1</span> #!/usr/bin python3
<span class='lineno'>   2</span> &quot;&quot;&quot; VGG_Face inference using OpenCV-DNN
<span class='lineno'>   3</span> Model from: https://www.robots.ox.ac.uk/~vgg/software/vgg_face/
<span class='lineno'>   4</span> 
<span class='lineno'>   5</span> Licensed under Creative Commons Attribution License.
<span class='lineno'>   6</span> https://creativecommons.org/licenses/by-nc/4.0/
<span class='lineno'>   7</span> &quot;&quot;&quot;
<span class='lineno'>   8</span> 
<span class='lineno'>   9</span> import logging
<span class='lineno'>  10</span> import sys
<span class='lineno'>  11</span> import os
<span class='lineno'>  12</span> 
<span class='lineno'>  13</span> import cv2
<span class='lineno'>  14</span> import numpy as np
<span class='lineno'>  15</span> from fastcluster import linkage
<span class='lineno'>  16</span> 
<span class='lineno'>  17</span> from <a href='__init__.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib', title='lib'>lib</a>.<a href='utils.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils', title='utils'>utils</a> import <a href='utils.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel', title='<GetModel>'>GetModel</a>
<span class='lineno'>  18</span> 
<span class='lineno'>  19</span> <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', title='?'>logger</a> = logging.getLogger(__name__)  # pylint: disable=invalid-name
<span class='lineno'>  20</span> 
<span class='lineno'>  21</span> 
<span class='lineno'>  22</span> class <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace', title='<VGGFace>'>VGGFace</a>():
<span class='lineno'>  23</span>     &quot;&quot;&quot; VGG Face feature extraction.
<span class='lineno'>  24</span>         Input images should be in BGR Order &quot;&quot;&quot;
<span class='lineno'>  25</span> 
<span class='lineno'>  26</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__', title='? -> ?'>__init__</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', title='VGGFace'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.backend', title='str'>backend</a>=&quot;CPU&quot;):
<span class='lineno'>  27</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', title='?'>logger</a>.debug(&quot;Initializing %s: (backend: %s)&quot;, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', title='VGGFace'>self</a>.__class__.__name__, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.backend', title='str'>backend</a>)
<span class='lineno'>  28</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.git_model_id', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.git_model_id', title='int'>git_model_id</a> = 7
<span class='lineno'>  29</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.model_filename', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.model_filename', title='[str]'>model_filename</a> = [&quot;vgg_face_v1.caffemodel&quot;, &quot;vgg_face_v1.prototxt&quot;]
<span class='lineno'>  30</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', title='int'><a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', title='int'>input_size</a></a> = 224
<span class='lineno'>  31</span>         # Average image provided in http://www.robots.ox.ac.uk/~vgg/software/vgg_face/
<span class='lineno'>  32</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', title='VGGFace'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.average_img', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.average_img', title='[float]'><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.average_img', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.average_img', title='[float]'>average_img</a></a> = [129.1863, 104.7624, 93.5940]
<span class='lineno'>  33</span> 
<span class='lineno'>  34</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', title='VGGFace'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.model', title='None'><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.model', title='None'>model</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model', title='(VGGFace, ?, ?, ?) -> None / (VGGFace, int, [str], str) -> None'>get_model</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.git_model_id', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.git_model_id', title='int'>git_model_id</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.model_filename', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.model_filename', title='[str]'>model_filename</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.backend', title='str'>backend</a>)
<span class='lineno'>  35</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', title='?'>logger</a>.debug(&quot;Initialized %s&quot;, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.__init__.self', title='VGGFace'>self</a>.__class__.__name__)
<span class='lineno'>  36</span> 
<span class='lineno'>  37</span>     # &lt;&lt;&lt; GET MODEL &gt;&gt;&gt; #
<span class='lineno'>  38</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model', title='(VGGFace, ?, ?, ?) -> None / (VGGFace, int, [str], str) -> None'>get_model</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.self', title='VGGFace'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.git_model_id', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.git_model_id', title='int'>git_model_id</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model_filename', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model_filename', title='[str]'>model_filename</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.backend', title='str'>backend</a>):
<span class='lineno'>  39</span>         &quot;&quot;&quot; Check if model is available, if not, download and unzip it &quot;&quot;&quot;
<span class='lineno'>  40</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.root_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.root_path', title='str'>root_path</a> = os.path.abspath(os.path.dirname(sys.argv[0]))
<span class='lineno'>  41</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.cache_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.cache_path', title='str'>cache_path</a> = os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.root_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.root_path', title='str'>root_path</a>, &quot;plugins&quot;, &quot;extract&quot;, &quot;recognition&quot;, &quot;.cache&quot;)
<span class='lineno'>  42</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', title='GetModel -> {[str] | str}'>model</a> = <a href='utils.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel', title='<GetModel>'>GetModel</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model_filename', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model_filename', title='[str]'>model_filename</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.cache_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.cache_path', title='str'>cache_path</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.git_model_id', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.git_model_id', title='int'>git_model_id</a>).<a href='utils.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel.model_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel.model_path', title='GetModel -> {[str] | str}'>model_path</a>
<span class='lineno'>  43</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', title='?'>model</a> = cv2.dnn.readNetFromCaffe(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', title='GetModel -> {[str] | str}'>model</a>[1], <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', title='GetModel -> {[str] | str}'>model</a>[0])
<span class='lineno'>  44</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', title='?'>model</a>.setPreferableTarget(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend', title='? -> None / str -> None'>get_backend</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.backend', title='str'>backend</a>))
<span class='lineno'>  45</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_model.model', title='?'>model</a>
<span class='lineno'>  46</span> 
<span class='lineno'>  47</span>     @staticmethod
<span class='lineno'>  48</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend', title='? -> None / str -> None'>get_backend</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.backend', title='str'>backend</a>):
<span class='lineno'>  49</span>         &quot;&quot;&quot; Return the cv2 DNN backend &quot;&quot;&quot;
<span class='lineno'>  50</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.backend', title='str'>backend</a> == &quot;OPENCL&quot;:
<span class='lineno'>  51</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', title='?'>logger</a>.info(&quot;Using OpenCL backend. If the process runs, you can safely ignore any of &quot;
<span class='lineno'>  52</span>                         &quot;the failure messages.&quot;)
<span class='lineno'>  53</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.retval', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.retval', title='?'>retval</a> = getattr(cv2.dnn, &quot;DNN_TARGET_{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.backend', title='str'>backend</a>))
<span class='lineno'>  54</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.retval', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.get_backend.retval', title='?'>retval</a>
<span class='lineno'>  55</span> 
<span class='lineno'>  56</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict', title='(VGGFace, ?) -> None'>predict</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', title='VGGFace'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', title='?'>face</a>):
<span class='lineno'>  57</span>         &quot;&quot;&quot; Return encodings for given image from vgg_face &quot;&quot;&quot;
<span class='lineno'>  58</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', title='?'>face</a>.shape[0] != <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', title='int'>input_size</a>:
<span class='lineno'>  59</span>             <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', title='None'>face</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face', title='(VGGFace, ?) -> None'>resize_face</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', title='?'>face</a>)
<span class='lineno'>  60</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.blob', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.blob', title='?'>blob</a> = cv2.dnn.blobFromImage(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.face', title='None'>face</a>[..., :3],
<span class='lineno'>  61</span>                                      1.0,
<span class='lineno'>  62</span>                                      (<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', title='int'>input_size</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', title='int'>input_size</a>),
<span class='lineno'>  63</span>                                      <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.average_img', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.average_img', title='[float]'>average_img</a>,
<span class='lineno'>  64</span>                                      False,
<span class='lineno'>  65</span>                                      False)
<span class='lineno'>  66</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.model', title='None'>model</a>.setInput(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.blob', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.blob', title='?'>blob</a>)
<span class='lineno'>  67</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.preds', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.preds', title='?'>preds</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.model', title='None'>model</a>.forward(&quot;fc7&quot;)[0, :]
<span class='lineno'>  68</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.preds', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.predict.preds', title='?'>preds</a>
<span class='lineno'>  69</span> 
<span class='lineno'>  70</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face', title='(VGGFace, ?) -> None'>resize_face</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.self', title='VGGFace'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', title='?'>face</a>):
<span class='lineno'>  71</span>         &quot;&quot;&quot; Resize incoming face to model_input_size &quot;&quot;&quot;
<span class='lineno'>  72</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.sizes', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.sizes', title='(int, int)'>sizes</a> = (<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', title='int'>input_size</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', title='int'>input_size</a>)
<span class='lineno'>  73</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.interpolation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.interpolation', title='?'>interpolation</a> = cv2.INTER_CUBIC if <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', title='?'>face</a>.shape[0] &lt; <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.input_size', title='int'>input_size</a> else cv2.INTER_AREA
<span class='lineno'>  74</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', title='?'>face</a> = cv2.resize(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', title='?'>face</a>, dsize=<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.sizes', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.sizes', title='(int, int)'>sizes</a>, interpolation=<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.interpolation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.interpolation', title='?'>interpolation</a>)
<span class='lineno'>  75</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.resize_face.face', title='?'>face</a>
<span class='lineno'>  76</span> 
<span class='lineno'>  77</span>     @staticmethod
<span class='lineno'>  78</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity', title='(?, ?) -> int / (?, None) -> int'>find_cosine_similiarity</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.source_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.source_face', title='?'>source_face</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.test_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.test_face', title='None'>test_face</a>):
<span class='lineno'>  79</span>         &quot;&quot;&quot; Find the cosine similarity between a source face and a test face &quot;&quot;&quot;
<span class='lineno'>  80</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_a', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_a', title='?'>var_a</a> = np.matmul(np.transpose(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.source_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.source_face', title='?'>source_face</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.test_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.test_face', title='None'>test_face</a>)
<span class='lineno'>  81</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_b', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_b', title='?'>var_b</a> = np.sum(np.multiply(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.source_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.source_face', title='?'>source_face</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.source_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.source_face', title='?'>source_face</a>))
<span class='lineno'>  82</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_c', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_c', title='?'>var_c</a> = np.sum(np.multiply(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.test_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.test_face', title='None'>test_face</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.test_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.test_face', title='None'>test_face</a>))
<span class='lineno'>  83</span>         return 1 - (<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_a', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_a', title='?'>var_a</a> / (np.sqrt(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_b', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_b', title='?'>var_b</a>) * np.sqrt(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_c', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.find_cosine_similiarity.var_c', title='?'>var_c</a>)))
<span class='lineno'>  84</span> 
<span class='lineno'>  85</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity', title='(VGGFace, ?, str) -> [int]'>sorted_similarity</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.self', title='VGGFace'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.predictions', title='?'>predictions</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.method', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.method', title='str'>method</a>=&quot;ward&quot;):
<span class='lineno'>  86</span>         &quot;&quot;&quot; Sort a matrix of predictions by similarity Adapted from:
<span class='lineno'>  87</span>             https://gmarti.gitlab.io/ml/2017/09/07/how-to-sort-distance-matrix.html
<span class='lineno'>  88</span>         input:
<span class='lineno'>  89</span>             - predictions is a stacked matrix of vgg_face predictions shape: (x, 4096)
<span class='lineno'>  90</span>             - method = [&quot;ward&quot;,&quot;single&quot;,&quot;average&quot;,&quot;complete&quot;]
<span class='lineno'>  91</span>         output:
<span class='lineno'>  92</span>             - result_order is a list of indices with the order implied by the hierarhical tree
<span class='lineno'>  93</span> 
<span class='lineno'>  94</span>         sorted_similarity transforms a distance matrix into a sorted distance matrix according to
<span class='lineno'>  95</span>         the order implied by the hierarchical tree (dendrogram)
<span class='lineno'>  96</span>         &quot;&quot;&quot;
<span class='lineno'>  97</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.logger', title='?'>logger</a>.info(&quot;Sorting face distances. Depending on your dataset this may take some time...&quot;)
<span class='lineno'>  98</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.num_predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.num_predictions', title='?'>num_predictions</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.predictions', title='?'>predictions</a>.shape[0]
<span class='lineno'>  99</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.result_linkage', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.result_linkage', title='?'>result_linkage</a> = linkage(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.predictions', title='?'>predictions</a>, method=<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.method', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.method', title='str'>method</a>, preserve_input=False)
<span class='lineno'> 100</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.result_order', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.result_order', title='[int]'>result_order</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation', title='(VGGFace, ?, ?, int) -> [int] / (VGGFace, ?, ?, ?) -> {[?] | [int]}'>seriation</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.result_linkage', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.result_linkage', title='?'>result_linkage</a>,
<span class='lineno'> 101</span>                                       <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.num_predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.num_predictions', title='?'>num_predictions</a>,
<span class='lineno'> 102</span>                                       <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.num_predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.num_predictions', title='?'>num_predictions</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.num_predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.num_predictions', title='?'>num_predictions</a> - 2)
<span class='lineno'> 103</span> 
<span class='lineno'> 104</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.result_order', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.sorted_similarity.result_order', title='[int]'>result_order</a>
<span class='lineno'> 105</span> 
<span class='lineno'> 106</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation', title='(VGGFace, ?, ?, int) -> [int] / (VGGFace, ?, ?, ?) -> {[?] | [int]}'>seriation</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.self', title='VGGFace'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', title='?'>tree</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', title='?'>points</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', title='int'>current_index</a>):
<span class='lineno'> 107</span>         &quot;&quot;&quot; Seriation method for sorted similarity
<span class='lineno'> 108</span>             input:
<span class='lineno'> 109</span>                 - tree is a hierarchical tree (dendrogram)
<span class='lineno'> 110</span>                 - points is the number of points given to the clustering process
<span class='lineno'> 111</span>                 - current_index is the position in the tree for the recursive traversal
<span class='lineno'> 112</span>             output:
<span class='lineno'> 113</span>                 - order implied by the hierarchical tree
<span class='lineno'> 114</span> 
<span class='lineno'> 115</span>             seriation computes the order implied by a hierarchical tree (dendrogram)
<span class='lineno'> 116</span>         &quot;&quot;&quot;
<span class='lineno'> 117</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', title='int'>current_index</a> &lt; <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', title='?'>points</a>:
<span class='lineno'> 118</span>             return [<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', title='int'>current_index</a>]
<span class='lineno'> 119</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.left', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.left', title='int'>left</a> = int(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', title='?'>tree</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', title='int'>current_index</a>-<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', title='?'>points</a>, 0])
<span class='lineno'> 120</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.right', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.right', title='int'>right</a> = int(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', title='?'>tree</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.current_index', title='int'>current_index</a>-<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', title='?'>points</a>, 1])
<span class='lineno'> 121</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation', title='(VGGFace, ?, ?, int) -> [int] / (VGGFace, ?, ?, ?) -> {[?] | [int]}'>seriation</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', title='?'>tree</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', title='?'>points</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.left', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.left', title='int'>left</a>) + <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.self', title='VGGFace'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation', title='(VGGFace, ?, ?, int) -> [int] / (VGGFace, ?, ?, ?) -> {[?] | [int]}'>seriation</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.tree', title='?'>tree</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.points', title='?'>points</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.right', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face.VGGFace.seriation.right', title='int'>right</a>)
</pre></td></tr></table></body></html>