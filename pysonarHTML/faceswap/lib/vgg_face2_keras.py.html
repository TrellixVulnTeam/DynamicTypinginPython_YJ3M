<html>
<head>
<meta charset="utf-8">
<title>/home/xxm/Desktop/EMSE/dataset/faceswap/lib/vgg_face2_keras.py</title>
<style type='text/css'>
body { color: #666666; }
a {
    text-decoration: none; color: #5AA2A7;
    border: solid 1px rgba(255,255,255,0);
}
a.active {
    background: -webkit-linear-gradient(top,rgba(255, 255, 200, 0.35) 0,rgba(255, 255, 200, 0.55) 100%);
    border: solid 1px #E5E600;
}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #cccccc;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px solid orange; padding-bottom: 1px}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted;

function highlight(xid)
{
    var elms = document.querySelectorAll('[xid="' + xid + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "active";
    }
    highlighted = xid;
}

function clearHighlight() {
    var elms = document.querySelectorAll('[xid="' + highlighted + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "";
    }
}

window.onload =
    function (e) {
        var tags = document.getElementsByTagName("A")
        for (var i = 0; i < tags.length; i++) {
            tags[i].onmouseover =
                function (e) {
                    clearHighlight();
                    var xid = e.toElement.getAttribute('xid');
                    highlight(xid);
                }
        }
    }</script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger'>logger</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2'>VGGFace2</a><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__'>__init__</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model'>_get_model</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict'>predict</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face'>_resize_face</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity'>find_cosine_similiarity</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity'>sorted_similarity</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage'>_use_vector_linkage</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation', xid='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation'>_seriation</a></li></ul>
</li></ul>
</td><td><pre><span class='lineno'>   1</span> #!/usr/bin python3
<span class='lineno'>   2</span> &quot;&quot;&quot; VGG_Face2 inference and sorting &quot;&quot;&quot;
<span class='lineno'>   3</span> 
<span class='lineno'>   4</span> import logging
<span class='lineno'>   5</span> import sys
<span class='lineno'>   6</span> import os
<span class='lineno'>   7</span> import psutil
<span class='lineno'>   8</span> 
<span class='lineno'>   9</span> import cv2
<span class='lineno'>  10</span> import numpy as np
<span class='lineno'>  11</span> from fastcluster import linkage, linkage_vector
<span class='lineno'>  12</span> from <a href='__init__.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib', title='lib'>lib</a>.<a href='utils.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils', title='utils'>utils</a> import <a href='utils.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel', title='<GetModel>'>GetModel</a>, <a href='utils.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.FaceswapError', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.FaceswapError', title='<FaceswapError>'>FaceswapError</a>
<span class='lineno'>  13</span> 
<span class='lineno'>  14</span> <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', title='?'>logger</a> = logging.getLogger(__name__)  # pylint: disable=invalid-name
<span class='lineno'>  15</span> 
<span class='lineno'>  16</span> 
<span class='lineno'>  17</span> class <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2', title='<VGGFace2>'>VGGFace2</a>():
<span class='lineno'>  18</span>     &quot;&quot;&quot; VGG Face feature extraction.
<span class='lineno'>  19</span> 
<span class='lineno'>  20</span>     Extracts feature vectors from faces in order to compare similarity.
<span class='lineno'>  21</span> 
<span class='lineno'>  22</span>     Parameters
<span class='lineno'>  23</span>     ----------
<span class='lineno'>  24</span>     backend: [&#39;GPU&#39;, &#39;CPU&#39;]
<span class='lineno'>  25</span>         Whether to run inference on a GPU or on the CPU
<span class='lineno'>  26</span>     loglevel: [&#39;INFO&#39;, &#39;VERBODE&#39;, &#39;DEBUG&#39;, &#39;TRACE&#39;]
<span class='lineno'>  27</span>         The system log level
<span class='lineno'>  28</span> 
<span class='lineno'>  29</span>     Notes
<span class='lineno'>  30</span>     -----
<span class='lineno'>  31</span>     Input images should be in BGR Order
<span class='lineno'>  32</span> 
<span class='lineno'>  33</span>     Model exported from: https://github.com/WeidiXie/Keras-VGGFace2-ResNet50 which is based on:
<span class='lineno'>  34</span>     https://www.robots.ox.ac.uk/~vgg/software/vgg_face/
<span class='lineno'>  35</span> 
<span class='lineno'>  36</span> 
<span class='lineno'>  37</span>     Licensed under Creative Commons Attribution License.
<span class='lineno'>  38</span>     https://creativecommons.org/licenses/by-nc/4.0/
<span class='lineno'>  39</span>     &quot;&quot;&quot;
<span class='lineno'>  40</span> 
<span class='lineno'>  41</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__', title='? -> ?'>__init__</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', title='VGGFace2'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', title='str'>backend</a>=&quot;GPU&quot;, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.loglevel', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.loglevel', title='str'>loglevel</a>=&quot;INFO&quot;):
<span class='lineno'>  42</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', title='?'>logger</a>.debug(&quot;Initializing %s: (backend: %s, loglevel: %s)&quot;,
<span class='lineno'>  43</span>                      <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', title='VGGFace2'>self</a>.__class__.__name__, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', title='str'>backend</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.loglevel', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.loglevel', title='str'>loglevel</a>)
<span class='lineno'>  44</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', title='str'>backend</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', title='str'>backend</a>.upper()
<span class='lineno'>  45</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.git_model_id', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.git_model_id', title='int'>git_model_id</a> = 10
<span class='lineno'>  46</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.model_filename', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.model_filename', title='[str]'>model_filename</a> = [&quot;vggface2_resnet50_v2.h5&quot;]
<span class='lineno'>  47</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', title='VGGFace2'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', title='int'>input_size</a> = 224
<span class='lineno'>  48</span>         # Average image provided in https://github.com/ox-vgg/vgg_face2
<span class='lineno'>  49</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', title='VGGFace2'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.average_img', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.average_img', title='?'>average_img</a> = np.array([91.4953, 103.8827, 131.0912])
<span class='lineno'>  50</span> 
<span class='lineno'>  51</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', title='VGGFace2'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.model', title='None'>model</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model', title='(int, [str], str) -> None / (?, ?, ?) -> None'>_get_model</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.git_model_id', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.git_model_id', title='int'>git_model_id</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.model_filename', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.model_filename', title='[str]'>model_filename</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.backend', title='str'>backend</a>)
<span class='lineno'>  52</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', title='?'>logger</a>.debug(&quot;Initialized %s&quot;, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.__init__.self', title='VGGFace2'>self</a>.__class__.__name__)
<span class='lineno'>  53</span> 
<span class='lineno'>  54</span>     # &lt;&lt;&lt; GET MODEL &gt;&gt;&gt; #
<span class='lineno'>  55</span>     @staticmethod
<span class='lineno'>  56</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model', title='(int, [str], str) -> None / (?, ?, ?) -> None'>_get_model</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.git_model_id', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.git_model_id', title='int'>git_model_id</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model_filename', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model_filename', title='[str]'>model_filename</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.backend', title='str'>backend</a>):
<span class='lineno'>  57</span>         &quot;&quot;&quot; Check if model is available, if not, download and unzip it
<span class='lineno'>  58</span> 
<span class='lineno'>  59</span>         Parameters
<span class='lineno'>  60</span>         ----------
<span class='lineno'>  61</span>         git_model_id: int
<span class='lineno'>  62</span>             The second digit in the github tag that identifies this model. See
<span class='lineno'>  63</span>             https://github.com/deepfakes-models/faceswap-models for more information
<span class='lineno'>  64</span>         model_filename: str
<span class='lineno'>  65</span>             The name of the model to be loaded (see :class:`lib.utils.GetModel` for more
<span class='lineno'>  66</span>             information)
<span class='lineno'>  67</span>         backend: [&#39;GPU&#39;, &#39;CPU&#39;]
<span class='lineno'>  68</span>             Whether to run inference on a GPU or on the CPU
<span class='lineno'>  69</span> 
<span class='lineno'>  70</span>         See Also
<span class='lineno'>  71</span>         --------
<span class='lineno'>  72</span>         lib.utils.GetModel: The model downloading and allocation class.
<span class='lineno'>  73</span>         &quot;&quot;&quot;
<span class='lineno'>  74</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.root_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.root_path', title='str'>root_path</a> = os.path.abspath(os.path.dirname(sys.argv[0]))
<span class='lineno'>  75</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.cache_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.cache_path', title='str'>cache_path</a> = os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.root_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.root_path', title='str'>root_path</a>, &quot;plugins&quot;, &quot;extract&quot;, &quot;recognition&quot;, &quot;.cache&quot;)
<span class='lineno'>  76</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model', title='GetModel -> {[str] | str}'>model</a> = <a href='utils.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel', title='<GetModel>'>GetModel</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model_filename', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model_filename', title='[str]'>model_filename</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.cache_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.cache_path', title='str'>cache_path</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.git_model_id', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.git_model_id', title='int'>git_model_id</a>).<a href='utils.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel.model_path', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.utils.GetModel.model_path', title='GetModel -> {[str] | str}'>model_path</a>
<span class='lineno'>  77</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.backend', title='str'>backend</a> == &quot;CPU&quot;:
<span class='lineno'>  78</span>             if os.environ.get(&quot;KERAS_BACKEND&quot;, &quot;&quot;) == &quot;plaidml.keras.backend&quot;:
<span class='lineno'>  79</span>                 <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', title='?'>logger</a>.info(&quot;Switching to tensorflow backend.&quot;)
<span class='lineno'>  80</span>                 os.environ[&quot;KERAS_BACKEND&quot;] = &quot;tensorflow&quot;
<span class='lineno'>  81</span>         import keras
<span class='lineno'>  82</span>         from <a href='__init__.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib', title='lib'>lib</a>.<a href='model/__init__.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model', title='model'>model</a>.<a href='model/layers.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model.layers', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model.layers', title='layers'>layers</a> import <a href='model/layers.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model.layers.L2_normalize', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model.layers.L2_normalize', title='<L2_normalize>'>L2_normalize</a>
<span class='lineno'>  83</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.backend', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.backend', title='str'>backend</a> == &quot;CPU&quot;:
<span class='lineno'>  84</span>             with keras.backend.tf.device(&quot;/cpu:0&quot;):
<span class='lineno'>  85</span>                 return keras.models.load_model(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model', title='GetModel -> {[str] | str}'>model</a>, {
<span class='lineno'>  86</span>                     &quot;L2_normalize&quot;:  <a href='model/layers.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model.layers.L2_normalize', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model.layers.L2_normalize', title='<L2_normalize>'>L2_normalize</a>
<span class='lineno'>  87</span>                 })
<span class='lineno'>  88</span>         else:
<span class='lineno'>  89</span>             return keras.models.load_model(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._get_model.model', title='GetModel -> {[str] | str}'>model</a>, {
<span class='lineno'>  90</span>                 &quot;L2_normalize&quot;:  <a href='model/layers.py.html#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model.layers.L2_normalize', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.model.layers.L2_normalize', title='<L2_normalize>'>L2_normalize</a>
<span class='lineno'>  91</span>             })
<span class='lineno'>  92</span> 
<span class='lineno'>  93</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict', title='(VGGFace2, ?) -> None'>predict</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', title='VGGFace2'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', title='?'>face</a>):
<span class='lineno'>  94</span>         &quot;&quot;&quot; Return encodings for given image from vgg_face2.
<span class='lineno'>  95</span> 
<span class='lineno'>  96</span>         Parameters
<span class='lineno'>  97</span>         ----------
<span class='lineno'>  98</span>         face: numpy.ndarray
<span class='lineno'>  99</span>             The face to be fed through the predictor. Should be in BGR channel order
<span class='lineno'> 100</span> 
<span class='lineno'> 101</span>         Returns
<span class='lineno'> 102</span>         -------
<span class='lineno'> 103</span>         numpy.ndarray
<span class='lineno'> 104</span>             The encodings for the face
<span class='lineno'> 105</span>         &quot;&quot;&quot;
<span class='lineno'> 106</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', title='?'>face</a>.shape[0] != <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', title='int'>input_size</a>:
<span class='lineno'> 107</span>             <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', title='None'>face</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face', title='(VGGFace2, ?) -> None'>_resize_face</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', title='?'>face</a>)
<span class='lineno'> 108</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', title='?'>face</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', title='None'>face</a>[None, :, :, :3] - <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.average_img', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.average_img', title='?'>average_img</a>
<span class='lineno'> 109</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.preds', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.preds', title='?'>preds</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.model', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.model', title='None'>model</a>.predict(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.face', title='?'>face</a>)
<span class='lineno'> 110</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.preds', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.predict.preds', title='?'>preds</a>[0, :]
<span class='lineno'> 111</span> 
<span class='lineno'> 112</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face', title='(VGGFace2, ?) -> None'>_resize_face</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.self', title='VGGFace2'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', title='?'>face</a>):
<span class='lineno'> 113</span>         &quot;&quot;&quot; Resize incoming face to model_input_size.
<span class='lineno'> 114</span> 
<span class='lineno'> 115</span>         Parameters
<span class='lineno'> 116</span>         ----------
<span class='lineno'> 117</span>         face: numpy.ndarray
<span class='lineno'> 118</span>             The face to be fed through the predictor. Should be in BGR channel order
<span class='lineno'> 119</span> 
<span class='lineno'> 120</span>         Returns
<span class='lineno'> 121</span>         -------
<span class='lineno'> 122</span>         numpy.ndarray
<span class='lineno'> 123</span>             The face resized to model input size
<span class='lineno'> 124</span>         &quot;&quot;&quot;
<span class='lineno'> 125</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.sizes', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.sizes', title='(int, int)'>sizes</a> = (<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', title='int'>input_size</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', title='int'>input_size</a>)
<span class='lineno'> 126</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.interpolation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.interpolation', title='?'>interpolation</a> = cv2.INTER_CUBIC if <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', title='?'>face</a>.shape[0] &lt; <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.input_size', title='int'>input_size</a> else cv2.INTER_AREA
<span class='lineno'> 127</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', title='?'>face</a> = cv2.resize(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', title='?'>face</a>, dsize=<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.sizes', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.sizes', title='(int, int)'>sizes</a>, interpolation=<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.interpolation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.interpolation', title='?'>interpolation</a>)
<span class='lineno'> 128</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._resize_face.face', title='?'>face</a>
<span class='lineno'> 129</span> 
<span class='lineno'> 130</span>     @staticmethod
<span class='lineno'> 131</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity', title='(?, ?) -> int'>find_cosine_similiarity</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.source_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.source_face', title='?'>source_face</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.test_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.test_face', title='?'>test_face</a>):
<span class='lineno'> 132</span>         &quot;&quot;&quot; Find the cosine similarity between two faces.
<span class='lineno'> 133</span> 
<span class='lineno'> 134</span>         Parameters
<span class='lineno'> 135</span>         ----------
<span class='lineno'> 136</span>         source_face: numpy.ndarray
<span class='lineno'> 137</span>             The first face to test against :attr:`test_face`
<span class='lineno'> 138</span>         test_face: numpy.ndarray
<span class='lineno'> 139</span>             The second face to test against :attr:`source_face`
<span class='lineno'> 140</span> 
<span class='lineno'> 141</span>         Returns
<span class='lineno'> 142</span>         -------
<span class='lineno'> 143</span>         float:
<span class='lineno'> 144</span>             The cosine similarity between the two faces
<span class='lineno'> 145</span>         &quot;&quot;&quot;
<span class='lineno'> 146</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_a', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_a', title='?'>var_a</a> = np.matmul(np.transpose(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.source_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.source_face', title='?'>source_face</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.test_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.test_face', title='?'>test_face</a>)
<span class='lineno'> 147</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_b', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_b', title='?'>var_b</a> = np.sum(np.multiply(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.source_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.source_face', title='?'>source_face</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.source_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.source_face', title='?'>source_face</a>))
<span class='lineno'> 148</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_c', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_c', title='?'>var_c</a> = np.sum(np.multiply(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.test_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.test_face', title='?'>test_face</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.test_face', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.test_face', title='?'>test_face</a>))
<span class='lineno'> 149</span>         return 1 - (<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_a', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_a', title='?'>var_a</a> / (np.sqrt(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_b', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_b', title='?'>var_b</a>) * np.sqrt(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_c', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.find_cosine_similiarity.var_c', title='?'>var_c</a>)))
<span class='lineno'> 150</span> 
<span class='lineno'> 151</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity', title='(VGGFace2, ?, str) -> [int]'>sorted_similarity</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.self', title='VGGFace2'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.predictions', title='?'>predictions</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.method', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.method', title='str'>method</a>=&quot;ward&quot;):
<span class='lineno'> 152</span>         &quot;&quot;&quot; Sort a matrix of predictions by similarity.
<span class='lineno'> 153</span> 
<span class='lineno'> 154</span>         Transforms a distance matrix into a sorted distance matrix according to the order implied
<span class='lineno'> 155</span>         by the hierarchical tree (dendrogram).
<span class='lineno'> 156</span> 
<span class='lineno'> 157</span>         Parameters
<span class='lineno'> 158</span>         ----------
<span class='lineno'> 159</span>         predictions: numpy.ndarray
<span class='lineno'> 160</span>             A stacked matrix of vgg_face2 predictions of the shape (`N`, `D`) where `N` is the
<span class='lineno'> 161</span>             number of observations and `D` are the number of dimensions.  NB: The given
<span class='lineno'> 162</span>             :attr:`predictions` will be overwritten to save memory. If you still require the
<span class='lineno'> 163</span>             original values you should take a copy prior to running this method
<span class='lineno'> 164</span>         method: [&#39;single&#39;,&#39;centroid&#39;,&#39;median&#39;,&#39;ward&#39;]
<span class='lineno'> 165</span>             The clustering method to use.
<span class='lineno'> 166</span> 
<span class='lineno'> 167</span>         Returns
<span class='lineno'> 168</span>         -------
<span class='lineno'> 169</span>         list:
<span class='lineno'> 170</span>             List of indices with the order implied by the hierarchical tree
<span class='lineno'> 171</span>         &quot;&quot;&quot;
<span class='lineno'> 172</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', title='?'>logger</a>.info(&quot;Sorting face distances. Depending on your dataset this may take some time...&quot;)
<span class='lineno'> 173</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', title='?'>num_predictions</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.dims', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.dims', title='?'>dims</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.predictions', title='?'>predictions</a>.shape
<span class='lineno'> 174</span> 
<span class='lineno'> 175</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.kwargs', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.kwargs', title='dict'>kwargs</a> = dict(method=<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.method', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.method', title='str'>method</a>)
<span class='lineno'> 176</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage', title='(?, ?) -> bool'>_use_vector_linkage</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', title='?'>num_predictions</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.dims', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.dims', title='?'>dims</a>):
<span class='lineno'> 177</span>             <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.func', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.func', title='?'>func</a> = linkage_vector
<span class='lineno'> 178</span>         else:
<span class='lineno'> 179</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.kwargs', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.kwargs', title='dict'>kwargs</a>[&quot;preserve_input&quot;] = False
<span class='lineno'> 180</span>             <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.func', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.func', title='?'>func</a> = linkage
<span class='lineno'> 181</span> 
<span class='lineno'> 182</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.result_linkage', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.result_linkage', title='?'>result_linkage</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.func', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.func', title='?'>func</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.predictions', title='?'>predictions</a>, **kwargs)
<span class='lineno'> 183</span>         <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.result_order', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.result_order', title='[int]'>result_order</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.self', title='VGGFace2'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation', title='(VGGFace2, ?, ?, int) -> [int] / (VGGFace2, ?, ?, ?) -> {[?] | [int]}'>_seriation</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.result_linkage', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.result_linkage', title='?'>result_linkage</a>,
<span class='lineno'> 184</span>                                        <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', title='?'>num_predictions</a>,
<span class='lineno'> 185</span>                                        <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', title='?'>num_predictions</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.num_predictions', title='?'>num_predictions</a> - 2)
<span class='lineno'> 186</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.result_order', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2.sorted_similarity.result_order', title='[int]'>result_order</a>
<span class='lineno'> 187</span> 
<span class='lineno'> 188</span>     @staticmethod
<span class='lineno'> 189</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage', title='(?, ?) -> bool'>_use_vector_linkage</a>(<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.item_count', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.item_count', title='?'>item_count</a>, <a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.dims', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.dims', title='?'>dims</a>):
<span class='lineno'> 190</span>         &quot;&quot;&quot; Calculate the RAM that will be required to sort these images and select the appropriate
<span class='lineno'> 191</span>         clustering method.
<span class='lineno'> 192</span> 
<span class='lineno'> 193</span>         From fastcluster documentation:
<span class='lineno'> 194</span>             &quot;While the linkage method requires Θ(N:sup:`2`) memory for clustering of N points, this
<span class='lineno'> 195</span>             [vector] method needs Θ(N D)for N points in RD, which is usually much smaller.&quot;
<span class='lineno'> 196</span>             also:
<span class='lineno'> 197</span>             &quot;half the memory can be saved by specifying :attr:`preserve_input`=``False``&quot;
<span class='lineno'> 198</span> 
<span class='lineno'> 199</span>         To avoid under calculating we divide the memory calculation by 1.8 instead of 2
<span class='lineno'> 200</span> 
<span class='lineno'> 201</span>         Parameters
<span class='lineno'> 202</span>         ----------
<span class='lineno'> 203</span>         item_count: int
<span class='lineno'> 204</span>             The number of images that are to be processed
<span class='lineno'> 205</span>         dims: int
<span class='lineno'> 206</span>             The number of dimensions in the vgg_face output
<span class='lineno'> 207</span> 
<span class='lineno'> 208</span>         Returns
<span class='lineno'> 209</span>         -------
<span class='lineno'> 210</span>             bool:
<span class='lineno'> 211</span>                 ``True`` if vector_linkage should be used. ``False`` if linkage should be used
<span class='lineno'> 212</span>         &quot;&quot;&quot;
<span class='lineno'> 213</span>         np<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.np_float', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.np_float', title='int'>_float =</a> 24  # bytes size of a numpy float
<span class='lineno'> 214</span>         di<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.divider', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.divider', title='int'>vider =</a> 1024 * 1024  # bytes to MB
<span class='lineno'> 215</span> 
<span class='lineno'> 216</span>         fr<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', title='int'>ee_ram =</a> psutil.virtual_memory().available / di<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.divider', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.divider', title='int'>vider
<span class='lineno'> 217</span>  </a>       li<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.linkage_required', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.linkage_required', title='int'>nkage_required =</a> (((it<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.item_count', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.item_count', title='?'>em_count *</a>* 2) * np<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.np_float', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.np_float', title='int'>_float) </a>/ 1.8) / di<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.divider', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.divider', title='int'>vider
<span class='lineno'> 218</span>  </a>       ve<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.vector_required', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.vector_required', title='int'>ctor_required =</a> ((it<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.item_count', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.item_count', title='?'>em_count *</a> di<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.dims', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.dims', title='?'>ms) </a>* np<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.np_float', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.np_float', title='int'>_float) </a>/ di<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.divider', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.divider', title='int'>vider
<span class='lineno'> 219</span>  </a>       lo<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', title='?'>gger.d</a>ebug(&quot;free_ram: %sMB, linkage_required: %sMB, vector_required: %sMB&quot;,
<span class='lineno'> 220</span>                      int(fr<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', title='int'>ee_ram),</a> int(li<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.linkage_required', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.linkage_required', title='int'>nkage_required),</a> int(ve<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.vector_required', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.vector_required', title='int'>ctor_required))</a>
<span class='lineno'> 221</span> 
<span class='lineno'> 222</span>         if li<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.linkage_required', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.linkage_required', title='int'>nkage_required &lt;</a> fr<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', title='int'>ee_ram:
<span class='lineno'> 223</span> </a>            lo<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', title='?'>gger.v</a>erbose(&quot;Using linkage method&quot;)
<span class='lineno'> 224</span>             re<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.retval', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.retval', title='bool'>tval =</a> False
<span class='lineno'> 225</span>         elif ve<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.vector_required', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.vector_required', title='int'>ctor_required &lt;</a> fr<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', title='int'>ee_ram:
<span class='lineno'> 226</span> </a>            lo<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', title='?'>gger.w</a>arning(&quot;Not enough RAM to perform linkage clustering. Using vector &quot;
<span class='lineno'> 227</span>                            &quot;clustering. This will be significantly slower. Free RAM: %sMB. &quot;
<span class='lineno'> 228</span>                            &quot;Required for linkage method: %sMB&quot;,
<span class='lineno'> 229</span>                            int(fr<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.free_ram', title='int'>ee_ram),</a> int(li<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.linkage_required', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.linkage_required', title='int'>nkage_required))</a>
<span class='lineno'> 230</span>             re<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.retval', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.retval', title='bool'>tval =</a> True
<span class='lineno'> 231</span>         else:
<span class='lineno'> 232</span>             raise FaceswapError(&quot;Not enough RAM available to sort faces. Try reducing &quot;
<span class='lineno'> 233</span>                                 &quot;the size of  your dataset. Free RAM: {}MB. &quot;
<span class='lineno'> 234</span>                                 &quot;Required RAM: {}MB&quot;.format(int(free_ram), int(vector_required)))
<span class='lineno'> 235</span>         lo<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.logger', title='?'>gger.d</a>ebug(re<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.retval', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.retval', title='bool'>tval)
<span class='lineno'> 236</span> </a>        return re<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.retval', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._use_vector_linkage.retval', title='bool'>tval
<span class='lineno'> 237</span> 
<span class='lineno'> 238</span> </a>    def _s<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation', title='(VGGFace2, ?, ?, int) -> [int] / (VGGFace2, ?, ?, ?) -> {[?] | [int]}'>eriation(s</a>e<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.self', title='VGGFace2'>lf, </a>tr<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', title='?'>ee, </a>po<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', title='?'>ints, </a>cu<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', title='int'>rrent_index):</a>
<span class='lineno'> 239</span>         &quot;&quot;&quot; Seriation method for sorted similarity.
<span class='lineno'> 240</span> 
<span class='lineno'> 241</span>         Seriation computes the order implied by a hierarchical tree (dendrogram).
<span class='lineno'> 242</span> 
<span class='lineno'> 243</span>         Parameters
<span class='lineno'> 244</span>         ----------
<span class='lineno'> 245</span>         tree: numpy.ndarray
<span class='lineno'> 246</span>            A hierarchical tree (dendrogram)
<span class='lineno'> 247</span>         points: int
<span class='lineno'> 248</span>             The number of points given to the clustering process
<span class='lineno'> 249</span>         current_index: int
<span class='lineno'> 250</span>             The position in the tree for the recursive traversal
<span class='lineno'> 251</span> 
<span class='lineno'> 252</span>         Returns
<span class='lineno'> 253</span>         -------
<span class='lineno'> 254</span>         list:
<span class='lineno'> 255</span>             The indices in the order implied by the hierarchical tree
<span class='lineno'> 256</span>         &quot;&quot;&quot;
<span class='lineno'> 257</span>         if cu<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', title='int'>rrent_index &lt;</a> po<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', title='?'>ints:
<span class='lineno'> 258</span> </a>            return [cu<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', title='int'>rrent_index]
<span class='lineno'> 259</span> </a>        le<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.left', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.left', title='int'>ft =</a> int(tr<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', title='?'>ee[c</a>u<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', title='int'>rrent_index-p</a>o<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', title='?'>ints, </a>0])
<span class='lineno'> 260</span>         ri<a name='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.right', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.right', title='int'>ght =</a> int(tr<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', title='?'>ee[c</a>u<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.current_index', title='int'>rrent_index-p</a>o<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', title='?'>ints, </a>1])
<span class='lineno'> 261</span>         return se<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.self', title='VGGFace2'>lf._</a>s<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation', title='(VGGFace2, ?, ?, int) -> [int] / (VGGFace2, ?, ?, ?) -> {[?] | [int]}'>eriation(t</a>r<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', title='?'>ee, </a>po<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', title='?'>ints, </a>le<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.left', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.left', title='int'>ft) </a>+ se<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.self', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.self', title='VGGFace2'>lf._</a>s<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation', title='(VGGFace2, ?, ?, int) -> [int] / (VGGFace2, ?, ?, ?) -> {[?] | [int]}'>eriation(t</a>r<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.tree', title='?'>ee, </a>po<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.points', title='?'>ints, </a>ri<a href='#.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.right', xid ='.home.xxm.Desktop.EMSE.dataset.faceswap.lib.vgg_face2_keras.VGGFace2._seriation.right', title='int'>ght)
<span class='lineno'> 262</span> </a>
</pre></td></tr></table></body></html>