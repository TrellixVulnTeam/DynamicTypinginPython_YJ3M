<html>
<head>
<meta charset="utf-8">
<title>/home/xxm/Desktop/EMSE/dataset/models/research/steve/valuerl.py</title>
<style type='text/css'>
body { color: #666666; }
a {
    text-decoration: none; color: #5AA2A7;
    border: solid 1px rgba(255,255,255,0);
}
a.active {
    background: -webkit-linear-gradient(top,rgba(255, 255, 200, 0.35) 0,rgba(255, 255, 200, 0.55) 100%);
    border: solid 1px #E5E600;
}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #cccccc;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px solid orange; padding-bottom: 1px}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted;

function highlight(xid)
{
    var elms = document.querySelectorAll('[xid="' + xid + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "active";
    }
    highlighted = xid;
}

function clearHighlight() {
    var elms = document.querySelectorAll('[xid="' + highlighted + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "";
    }
}

window.onload =
    function (e) {
        var tags = document.getElementsByTagName("A")
        for (var i = 0; i < tags.length; i++) {
            tags[i].onmouseover =
                function (e) {
                    clearHighlight();
                    var xid = e.toElement.getAttribute('xid');
                    highlight(xid);
                }
        }
    }</script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL', xid='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL'>ValueRL</a><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.saveid', xid='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.saveid'>saveid</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params', xid='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params'>create_params</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch', xid='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch'>update_epoch</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old', xid='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old'>copy_to_old</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', xid='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph'>build_evalution_graph</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph', xid='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph'>build_training_graph</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph', xid='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph'>build_Q_expansion_graph</a></li></ul>
</li></ul>
</td><td><pre><span class='lineno'>   1</span> from __future__ import division
<span class='lineno'>   2</span> from builtins import zip
<span class='lineno'>   3</span> # Copyright 2018 The TensorFlow Authors All Rights Reserved.
<span class='lineno'>   4</span> #
<span class='lineno'>   5</span> # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
<span class='lineno'>   6</span> # you may not use this file except in compliance with the License.
<span class='lineno'>   7</span> # You may obtain a copy of the License at
<span class='lineno'>   8</span> #
<span class='lineno'>   9</span> #     http://www.apache.org/licenses/LICENSE-2.0
<span class='lineno'>  10</span> #
<span class='lineno'>  11</span> # Unless required by applicable law or agreed to in writing, software
<span class='lineno'>  12</span> # distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
<span class='lineno'>  13</span> # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
<span class='lineno'>  14</span> # See the License for the specific language governing permissions and
<span class='lineno'>  15</span> # limitations under the License.
<span class='lineno'>  16</span> # ==============================================================================
<span class='lineno'>  17</span> 
<span class='lineno'>  18</span> import tensorflow as tf
<span class='lineno'>  19</span> import numpy as np
<span class='lineno'>  20</span> import <a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', title='nn'>nn</a>
<span class='lineno'>  21</span> import <a href='util.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.util', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.util', title='util'>util</a>
<span class='lineno'>  22</span> from <a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.learner', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.learner', title='learner'>learner</a> import <a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.learner.CoreModel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.learner.CoreModel', title='<CoreModel>'>CoreModel</a>
<span class='lineno'>  23</span> 
<span class='lineno'>  24</span> 
<span class='lineno'>  25</span> class <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL', title='<ValueRL>'>ValueRL</a>(<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.learner.CoreModel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.learner.CoreModel', title='<CoreModel>'>CoreModel</a>):
<span class='lineno'>  26</span>   &quot;&quot;&quot;
<span class='lineno'>  27</span>   Learn a state-action value function and its corresponding policy.
<span class='lineno'>  28</span>   &quot;&quot;&quot;
<span class='lineno'>  29</span> 
<span class='lineno'>  30</span>   @property
<span class='lineno'>  31</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.saveid', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.saveid', title='ValueRL -> str'>saveid</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.saveid.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.saveid.self', title='ValueRL'>self</a>):
<span class='lineno'>  32</span>     return &quot;valuerl&quot;
<span class='lineno'>  33</span> 
<span class='lineno'>  34</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params', title='(ValueRL, ?, ?) -> None'>create_params</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', title='?'>env_config</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', title='?'>learner_config</a>):
<span class='lineno'>  35</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', title='?'>obs_dim</a> = np.prod(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', title='?'>env_config</a>[&quot;obs_dims&quot;])
<span class='lineno'>  36</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', title='?'>action_dim</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', title='?'>env_config</a>[&quot;action_dim&quot;]
<span class='lineno'>  37</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.reward_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.reward_scale', title='?'>reward_scale</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', title='?'>env_config</a>[&quot;reward_scale&quot;]
<span class='lineno'>  38</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.discount', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.discount', title='?'>discount</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.env_config', title='?'>env_config</a>[&quot;discount&quot;]
<span class='lineno'>  39</span> 
<span class='lineno'>  40</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', title='?'>hidden_dim</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', title='?'>learner_config</a>[&quot;hidden_dim&quot;]
<span class='lineno'>  41</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', title='?'>learner_config</a>[&quot;bayesian&quot;]
<span class='lineno'>  42</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.value_expansion', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.value_expansion', title='?'>value_expansion</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', title='?'>learner_config</a>[&quot;value_expansion&quot;]
<span class='lineno'>  43</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.explore_chance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.explore_chance', title='?'>explore_chance</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.learner_config', title='?'>learner_config</a>[&quot;ddpg_explore_chance&quot;]
<span class='lineno'>  44</span> 
<span class='lineno'>  45</span>     with tf.variable_scope(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.name', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.name', title='?'>name</a>):
<span class='lineno'>  46</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.policy', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.policy', title='FeedForwardNet'>policy</a> = <a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', title='nn'>nn</a>.<a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet', title='<FeedForwardNet>'>FeedForwardNet</a>(&#39;policy&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', title='?'>obs_dim</a>, [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', title='?'>action_dim</a>], layers=4, hidden_dim=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', title='?'>hidden_dim</a>, get_uncertainty=False)
<span class='lineno'>  47</span> 
<span class='lineno'>  48</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a>:
<span class='lineno'>  49</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q', title='{EnsembleFeedForwardNet | FeedForwardNet}'>Q</a> = <a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', title='nn'>nn</a>.<a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.EnsembleFeedForwardNet', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.EnsembleFeedForwardNet', title='<EnsembleFeedForwardNet>'>EnsembleFeedForwardNet</a>(&#39;Q&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', title='?'>obs_dim</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', title='?'>action_dim</a>, [], layers=4, hidden_dim=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', title='?'>hidden_dim</a>, get_uncertainty=True, ensemble_size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a>[&quot;ensemble_size&quot;], train_sample_count=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a>[&quot;train_sample_count&quot;], eval_sample_count=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a>[&quot;eval_sample_count&quot;])
<span class='lineno'>  50</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.old_Q', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.old_Q', title='{EnsembleFeedForwardNet | FeedForwardNet}'>old_Q</a> = <a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', title='nn'>nn</a>.<a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.EnsembleFeedForwardNet', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.EnsembleFeedForwardNet', title='<EnsembleFeedForwardNet>'>EnsembleFeedForwardNet</a>(&#39;old_q&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', title='?'>obs_dim</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', title='?'>action_dim</a>, [], layers=4, hidden_dim=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', title='?'>hidden_dim</a>, get_uncertainty=True, ensemble_size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a>[&quot;ensemble_size&quot;], train_sample_count=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a>[&quot;train_sample_count&quot;], eval_sample_count=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a>[&quot;eval_sample_count&quot;])
<span class='lineno'>  51</span>       else:
<span class='lineno'>  52</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q', title='{EnsembleFeedForwardNet | FeedForwardNet}'>Q</a> = <a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', title='nn'>nn</a>.<a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet', title='<FeedForwardNet>'>FeedForwardNet</a>(&#39;Q&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', title='?'>obs_dim</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', title='?'>action_dim</a>, [], layers=4, hidden_dim=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', title='?'>hidden_dim</a>, get_uncertainty=True)
<span class='lineno'>  53</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.old_Q', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.old_Q', title='{EnsembleFeedForwardNet | FeedForwardNet}'>old_Q</a> = <a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn', title='nn'>nn</a>.<a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet', title='<FeedForwardNet>'>FeedForwardNet</a>(&#39;old_q&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', title='?'>obs_dim</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', title='?'>action_dim</a>, [], layers=4, hidden_dim=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hidden_dim', title='?'>hidden_dim</a>, get_uncertainty=True)
<span class='lineno'>  54</span> 
<span class='lineno'>  55</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.policy_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.policy_params', title='[?]'>policy_params</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', title='?'>v</a> for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', title='?'>v</a></a> in tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, scope=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.name', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.name', title='?'>name</a>) if &quot;policy&quot; in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', title='?'>v</a>.name]
<span class='lineno'>  56</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q_params', title='[?]'>Q_params</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', title='?'>v</a> for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', title='?'>v</a></a> in tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, scope=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.name', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.name', title='?'>name</a>) if &quot;Q&quot; in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.v', title='?'>v</a>.name]
<span class='lineno'>  57</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.agent_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.agent_params', title='?'>agent_params</a> = tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, scope=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.name', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.name', title='?'>name</a>)
<span class='lineno'>  58</span> 
<span class='lineno'>  59</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old_ops', title='[?]'>copy_to_old_ops</a> = [tf.assign(p_old, p) for p_old, p in zip(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.old_Q', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.old_Q', title='{EnsembleFeedForwardNet | FeedForwardNet}'>old_Q</a>.<a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet.params_list', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet.params_list', title='[?]'>params_list</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q', title='{EnsembleFeedForwardNet | FeedForwardNet}'>Q</a>.<a href='nn.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet.params_list', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.nn.FeedForwardNet.params_list', title='[?]'>params_list</a>)]
<span class='lineno'>  60</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.assign_epoch_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.assign_epoch_op', title='[?]'>assign_epoch_op</a> = [tf.assign(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.epoch_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.epoch_n', title='?'>epoch_n</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.epoch_n_placeholder', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.epoch_n_placeholder', title='?'>epoch_n_placeholder</a>), tf.assign(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_n', title='?'>update_n</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_n_placeholder', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_n_placeholder', title='?'>update_n_placeholder</a>), tf.assign(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.frame_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.frame_n', title='?'>frame_n</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.frame_n_placeholder', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.frame_n_placeholder', title='?'>frame_n_placeholder</a>), tf.assign(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hours', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hours', title='?'>hours</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.create_params.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hours_placeholder', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hours_placeholder', title='?'>hours_placeholder</a>)]
<span class='lineno'>  61</span> 
<span class='lineno'>  62</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch', title='(ValueRL, ?, ?, ?, ?, ?) -> None'>update_epoch</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', title='ValueRL'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.sess', title='?'>sess</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.epoch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.epoch', title='?'>epoch</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.updates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.updates', title='?'>updates</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.frames', title='?'>frames</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.hours', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.hours', title='?'>hours</a>):
<span class='lineno'>  63</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.assign_epoch_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.assign_epoch_op', title='[?]'>assign_epoch_op</a>, feed_dict={<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.epoch_n_placeholder', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.epoch_n_placeholder', title='?'>epoch_n_placeholder</a>: int(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.epoch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.epoch', title='?'>epoch</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_n_placeholder', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_n_placeholder', title='?'>update_n_placeholder</a>: int(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.updates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.updates', title='?'>updates</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.frame_n_placeholder', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.frame_n_placeholder', title='?'>frame_n_placeholder</a>: int(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.frames', title='?'>frames</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.self', title='ValueRL'>self</a>.<a href='learner.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hours_placeholder', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.hours_placeholder', title='?'>hours_placeholder</a>: float(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.hours', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.update_epoch.hours', title='?'>hours</a>)})
<span class='lineno'>  64</span> 
<span class='lineno'>  65</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old', title='(ValueRL, ?) -> None'>copy_to_old</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old.self', title='ValueRL'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old.sess', title='?'>sess</a>):
<span class='lineno'>  66</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.copy_to_old.self', title='ValueRL'>self</a>.copy_to_old_ops)
<span class='lineno'>  67</span> 
<span class='lineno'>  68</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', title='(ValueRL, ?, bool, str, int) -> (?, ?)'>build_evalution_graph</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.self', title='ValueRL'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.obs', title='?'>obs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.get_full_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.get_full_info', title='bool'>get_full_info</a>=False, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', title='str'>mode</a>=&quot;regular&quot;, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.n_samples', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.n_samples', title='int'>n_samples</a>=1):
<span class='lineno'>  69</span>     assert <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', title='str'>mode</a> in {&quot;regular&quot;, &quot;explore&quot;, &quot;exploit&quot;}
<span class='lineno'>  70</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', title='?'>policy_actions_pretanh</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.policy', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.policy', title='FeedForwardNet'>policy</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.obs', title='?'>obs</a>)
<span class='lineno'>  71</span> 
<span class='lineno'>  72</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', title='str'>mode</a> == &quot;regular&quot; or <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', title='str'>mode</a> == &quot;exploit&quot;:
<span class='lineno'>  73</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions', title='?'>policy_actions</a> = tf.tanh(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', title='?'>policy_actions_pretanh</a>)
<span class='lineno'>  74</span>     elif <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.mode', title='str'>mode</a> == &quot;explore&quot;:
<span class='lineno'>  75</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph._', title='?'>_</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph._', title='float'>_</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.exploring_policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.exploring_policy_actions', title='?'>exploring_policy_actions</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph._', title='float'>_</a> = <a href='util.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.util', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.util', title='util'>util</a>.<a href='util.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.util.tanh_sample_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.util.tanh_sample_info', title='(?, ?, bool, int) -> (?, float, ?, float)'>tanh_sample_info</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', title='?'>policy_actions_pretanh</a>, tf.zeros_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', title='?'>policy_actions_pretanh</a>), n_samples=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.n_samples', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.n_samples', title='int'>n_samples</a>)
<span class='lineno'>  76</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions', title='?'>policy_actions</a> = tf.where(tf.random_uniform(tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.exploring_policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.exploring_policy_actions', title='?'>exploring_policy_actions</a>)) &lt; <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.explore_chance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.explore_chance', title='?'>explore_chance</a>, x=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.exploring_policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.exploring_policy_actions', title='?'>exploring_policy_actions</a>, y=tf.tanh(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', title='?'>policy_actions_pretanh</a>))
<span class='lineno'>  77</span>     else: raise Exception(&#39;this should never happen&#39;)
<span class='lineno'>  78</span> 
<span class='lineno'>  79</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.get_full_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.get_full_info', title='bool'>get_full_info</a>:     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions_pretanh', title='?'>policy_actions_pretanh</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions', title='?'>policy_actions</a>
<span class='lineno'>  80</span>     else:                 return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph.policy_actions', title='?'>policy_actions</a>
<span class='lineno'>  81</span> 
<span class='lineno'>  82</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph', title='(ValueRL, ?, ?, ?, ?, ?, ?, None) -> ((float, ?), (?, ?, float, float))'>build_training_graph</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', title='?'>obs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_obs', title='?'>next_obs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_actions', title='?'>empirical_actions</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.rewards', title='?'>rewards</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.dones', title='?'>dones</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.data_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.data_size', title='?'>data_size</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.worldmodel', title='None'>worldmodel</a>=None):
<span class='lineno'>  83</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.average_model_use', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.average_model_use', title='?'>average_model_use</a> = tf.constant(0.)
<span class='lineno'>  84</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_Q_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_Q_info', title='?'>empirical_Q_info</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', title='?'>obs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_actions', title='?'>empirical_actions</a>], 1)
<span class='lineno'>  85</span> 
<span class='lineno'>  86</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.worldmodel', title='None'>worldmodel</a> is None:
<span class='lineno'>  87</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_action_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_action_pretanh', title='?'>policy_action_pretanh</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_actions', title='?'>policy_actions</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', title='(ValueRL, ?, bool, str, int) -> (?, ?)'>build_evalution_graph</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', title='?'>obs</a>, get_full_info=True)
<span class='lineno'>  88</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_Q_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_Q_info', title='?'>policy_Q_info</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', title='?'>obs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_actions', title='?'>policy_actions</a>], 1)
<span class='lineno'>  89</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.state_value_estimate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.state_value_estimate', title='?'>state_value_estimate</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.Q(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_Q_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_Q_info', title='?'>policy_Q_info</a>, reduce_mode=&quot;mean&quot;)
<span class='lineno'>  90</span> 
<span class='lineno'>  91</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_policy_actions', title='(?, ?)'>next_policy_actions</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', title='(ValueRL, ?, bool, str, int) -> (?, ?)'>build_evalution_graph</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_obs', title='?'>next_obs</a>)
<span class='lineno'>  92</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_next_Q_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_next_Q_info', title='?'>policy_next_Q_info</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_obs', title='?'>next_obs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_policy_actions', title='(?, ?)'>next_policy_actions</a>], 1)
<span class='lineno'>  93</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_Q_estimate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_Q_estimate', title='?'>next_Q_estimate</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.old_Q(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_next_Q_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_next_Q_info', title='?'>policy_next_Q_info</a>, reduce_mode=&quot;mean&quot;)
<span class='lineno'>  94</span> 
<span class='lineno'>  95</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', title='?'>Q_guess</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.Q(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_Q_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_Q_info', title='?'>empirical_Q_info</a>, is_eval=False, reduce_mode=&quot;random&quot;)
<span class='lineno'>  96</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', title='float'>Q_target</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.rewards', title='?'>rewards</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.reward_scale + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.discount * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_Q_estimate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_Q_estimate', title='?'>next_Q_estimate</a> * (1. - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.dones', title='?'>dones</a>)
<span class='lineno'>  97</span> 
<span class='lineno'>  98</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_losses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_losses', title='?'>policy_losses</a> = -<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.state_value_estimate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.state_value_estimate', title='?'>state_value_estimate</a>
<span class='lineno'>  99</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', title='float'>Q_losses</a> = .5 * tf.square( <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', title='?'>Q_guess</a> - tf.stop_gradient(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', title='float'>Q_target</a>) )
<span class='lineno'> 100</span> 
<span class='lineno'> 101</span>     else:
<span class='lineno'> 102</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', title='?'>targets</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.confidence', title='float'>confidence</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guesses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guesses', title='None'>Q_guesses</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', title='None'>reach_probs</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph', title='(ValueRL, ?, ?, ?, None, int, bool) -> (?, float, None, None) / (ValueRL, ?, ?, ?, DeterministicWorldModel, int, bool) -> (?, float, None, None)'>build_Q_expansion_graph</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.next_obs', title='?'>next_obs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.rewards', title='?'>rewards</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.dones', title='?'>dones</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.worldmodel', title='None'>worldmodel</a>, rollout_len=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;rollout_len&quot;], model_ensembling=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.worldmodel', title='None'>worldmodel</a>.bayesian_config is not False)
<span class='lineno'> 103</span> 
<span class='lineno'> 104</span>       # targets is a 3D matrix: [batch_i, start_timestep, end_timestep]. here, we reduce out the last dimension, turning
<span class='lineno'> 105</span>       # it into a [batch_i, start_timestep] matrix. in other words, we are taking a bunch of candidate targets and reducing
<span class='lineno'> 106</span>       # them into a single target. the four options here correspond to the four ways to do that reduction.
<span class='lineno'> 107</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;mean_k_return&quot;]:
<span class='lineno'> 108</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.target_counts', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.target_counts', title='int'>target_counts</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;rollout_len&quot;]+1 - tf.reshape(tf.range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;rollout_len&quot;]+1), [1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;rollout_len&quot;]+1])
<span class='lineno'> 109</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', title='?'>k_returns</a> = tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', title='?'>targets</a>, 2) / tf.cast(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.target_counts', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.target_counts', title='int'>target_counts</a>, tf.float32)
<span class='lineno'> 110</span>       elif <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;lambda_return&quot;]:
<span class='lineno'> 111</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.cont_coeffs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.cont_coeffs', title='?'>cont_coeffs</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;lambda_return&quot;] ** tf.cast(tf.reshape(tf.range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;rollout_len&quot;]+1), [1,1,<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;rollout_len&quot;]+1]), tf.float32)
<span class='lineno'> 112</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.stop_coeffs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.stop_coeffs', title='?'>stop_coeffs</a> = tf.concat([(1 - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;lambda_return&quot;]) * tf.ones_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', title='?'>targets</a>)[:,:,:-1], tf.ones_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', title='?'>targets</a>)[:,:,-1:]], 2)
<span class='lineno'> 113</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', title='?'>k_returns</a> = tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', title='?'>targets</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.stop_coeffs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.stop_coeffs', title='?'>stop_coeffs</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.cont_coeffs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.cont_coeffs', title='?'>cont_coeffs</a>, 2)
<span class='lineno'> 114</span>       elif <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;steve_reweight&quot;]:
<span class='lineno'> 115</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', title='?'>k_returns</a> = tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', title='?'>targets</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.confidence', title='float'>confidence</a>, 2)
<span class='lineno'> 116</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.average_model_use', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.average_model_use', title='float'>average_model_use</a> = 1. - tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.confidence', title='float'>confidence</a>[:,0,0])
<span class='lineno'> 117</span>       else:
<span class='lineno'> 118</span>         # MVE objective: just take the last one
<span class='lineno'> 119</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', title='?'>k_returns</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.targets', title='?'>targets</a>[:,:,-1]
<span class='lineno'> 120</span> 
<span class='lineno'> 121</span>       # now we have [batch_i, start_timestep]. if we are using the TDK trick, then we want to use all of the targets,
<span class='lineno'> 122</span>       # so we construct a corresponding [batch_i, start_timestep] matrix of guesses. otherwise, we just take the targets
<span class='lineno'> 123</span>       # for the first timestep.
<span class='lineno'> 124</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', title='?'>Q_guess</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.Q(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_Q_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.empirical_Q_info', title='?'>empirical_Q_info</a>, is_eval=False, reduce_mode=&quot;random&quot;)
<span class='lineno'> 125</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;tdk_trick&quot;]:
<span class='lineno'> 126</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', title='?'>Q_guess</a> = tf.concat([tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', title='?'>Q_guess</a>, 1), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guesses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guesses', title='None'>Q_guesses</a>], 1)
<span class='lineno'> 127</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', title='?'>reach_probs</a> = tf.concat([tf.expand_dims(tf.ones_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', title='None'>reach_probs</a>[:,0]), 1), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', title='None'>reach_probs</a>[:,:-1]], 1)
<span class='lineno'> 128</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', title='?'>Q_target</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', title='?'>k_returns</a>
<span class='lineno'> 129</span>       else:
<span class='lineno'> 130</span>         # non-TDK trick means we just take the first one
<span class='lineno'> 131</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', title='?'>Q_target</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.k_returns', title='?'>k_returns</a>[:,0]
<span class='lineno'> 132</span> 
<span class='lineno'> 133</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_action_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_action_pretanh', title='?'>policy_action_pretanh</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_actions', title='?'>policy_actions</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', title='(ValueRL, ?, bool, str, int) -> (?, ?)'>build_evalution_graph</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', title='?'>obs</a>, get_full_info=True)
<span class='lineno'> 134</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_Q_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_Q_info', title='?'>policy_Q_info</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.obs', title='?'>obs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_actions', title='?'>policy_actions</a>], 1)
<span class='lineno'> 135</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.state_value_estimate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.state_value_estimate', title='?'>state_value_estimate</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.Q(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_Q_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_Q_info', title='?'>policy_Q_info</a>, stop_params_gradient=True, reduce_mode=&quot;mean&quot;)
<span class='lineno'> 136</span> 
<span class='lineno'> 137</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_losses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_losses', title='?'>policy_losses</a> = -<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.state_value_estimate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.state_value_estimate', title='?'>state_value_estimate</a>
<span class='lineno'> 138</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', title='float'>Q_losses</a> = .5 * tf.square( <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_guess', title='?'>Q_guess</a> - tf.stop_gradient(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_target', title='?'>Q_target</a>) )
<span class='lineno'> 139</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.self', title='ValueRL'>self</a>.value_expansion[&quot;tdk_trick&quot;]: <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', title='float'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', title='float'>Q_losses</a></a> *= <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.reach_probs', title='None'>reach_probs</a> # we downscale the various TDK-trick losses by
<span class='lineno'> 140</span>                                                                     # the likelihood of actually reaching the state
<span class='lineno'> 141</span>                                                                     # from which the guess was made
<span class='lineno'> 142</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_loss', title='?'>policy_loss</a> = tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_losses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_losses', title='?'>policy_losses</a>)
<span class='lineno'> 143</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_loss', title='?'>Q_loss</a> = tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_losses', title='float'>Q_losses</a>)
<span class='lineno'> 144</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_reg_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_reg_loss', title='float'>policy_reg_loss</a> = tf.reduce_mean(tf.square(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_action_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_action_pretanh', title='?'>policy_action_pretanh</a>)) * .001 # a small regularization to make sure the
<span class='lineno'> 145</span>                                                                               # tanh does not saturate
<span class='lineno'> 146</span> 
<span class='lineno'> 147</span>     # anything in inspect gets logged
<span class='lineno'> 148</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.inspect', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.inspect', title='(?, ?, float, float)'>inspect</a> = (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_loss', title='?'>policy_loss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_loss', title='?'>Q_loss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_reg_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_reg_loss', title='float'>policy_reg_loss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.average_model_use', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.average_model_use', title='float'>average_model_use</a>)
<span class='lineno'> 149</span> 
<span class='lineno'> 150</span>     return (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_loss', title='?'>policy_loss</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_reg_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.policy_reg_loss', title='float'>policy_reg_loss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.Q_loss', title='?'>Q_loss</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.inspect', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_training_graph.inspect', title='(?, ?, float, float)'>inspect</a>
<span class='lineno'> 151</span> 
<span class='lineno'> 152</span> 
<span class='lineno'> 153</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph', title='(ValueRL, ?, ?, ?, None, int, bool) -> (?, float, None, None) / (ValueRL, ?, ?, ?, DeterministicWorldModel, int, bool) -> (?, float, None, None)'>build_Q_expansion_graph</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', title='?'>obs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', title='?'>first_rewards</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', title='?'>first_done</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', title='DeterministicWorldModel'>worldmodel</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a>=1, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.model_ensembling', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.model_ensembling', title='bool'>model_ensembling</a>=False):
<span class='lineno'> 154</span>     ### this sets up the machinery for having multiple parallel rollouts, each of which has a single consistent transition
<span class='lineno'> 155</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ensemble_idxs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ensemble_idxs', title='None'>ensemble_idxs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_sample_n', title='int'>reward_sample_n</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', title='DeterministicWorldModel'>worldmodel</a>.<a href='worldmodel.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.get_ensemble_idx_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.get_ensemble_idx_info', title='DeterministicWorldModel -> (None, int, int)'>get_ensemble_idx_info</a>()
<span class='lineno'> 156</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.q_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.q_sample_n', title='int'>q_sample_n</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a>[&quot;eval_sample_count&quot;] if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.bayesian_config', title='?'>bayesian_config</a> is not False else 1
<span class='lineno'> 157</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', title='?'>first_rewards</a> = tf.tile(tf.expand_dims(tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', title='?'>first_rewards</a>,1),1), [1,<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>,<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_sample_n', title='int'>reward_sample_n</a>])
<span class='lineno'> 158</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', title='?'>first_rewards</a>.set_shape([None, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_sample_n', title='int'>reward_sample_n</a>])
<span class='lineno'> 159</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.model_ensembling', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.model_ensembling', title='bool'>model_ensembling</a>:
<span class='lineno'> 160</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', title='?'>obs</a> = tf.tile(tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', title='?'>obs</a>,1), [1,<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>,1])
<span class='lineno'> 161</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', title='?'>obs</a>.set_shape([None, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', title='?'>obs_dim</a>])
<span class='lineno'> 162</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', title='?'>first_done</a> = tf.tile(tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', title='?'>first_done</a>, 1), [1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>])
<span class='lineno'> 163</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', title='?'>first_done</a>.set_shape([None, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>])
<span class='lineno'> 164</span> 
<span class='lineno'> 165</span>     ### below, we use a while loop to actually do the iterative model rollout
<span class='lineno'> 166</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info', title='?'>extra_info</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', title='DeterministicWorldModel'>worldmodel</a>.<a href='worldmodel.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.init_extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.init_extra_info', title='(DeterministicWorldModel, ?) -> ?'>init_extra_info</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', title='?'>obs</a>)
<span class='lineno'> 167</span> 
<span class='lineno'> 168</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.action_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.action_ta', title='?'>action_ta</a> = tf.TensorArray(size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a>, dynamic_size=False, dtype=tf.float32)
<span class='lineno'> 169</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs_ta', title='?'>obs_ta</a> =       tf.TensorArray(size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a>, dynamic_size=False, dtype=tf.float32)
<span class='lineno'> 170</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.done_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.done_ta', title='?'>done_ta</a> =     tf.TensorArray(size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a>, dynamic_size=False, dtype=tf.float32)
<span class='lineno'> 171</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info_ta', title='?'>extra_info_ta</a> =tf.TensorArray(size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a>, dynamic_size=False, dtype=tf.float32)
<span class='lineno'> 172</span> 
<span class='lineno'> 173</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body', title='(?, ?) -> (int, (?, ?, ?, ?, ?, ?, ?))'>rollout_loop_body</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', title='?'>r_i</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.xxx_todo_changeme', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.xxx_todo_changeme', title='?'>xxx_todo_changeme</a>):
<span class='lineno'> 174</span>       (<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', title='?'>obs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.done', title='?'>done</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info', title='?'>extra_info</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_ta', title='?'>action_ta</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs_ta', title='?'>obs_ta</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.dones_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.dones_ta', title='?'>dones_ta</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info_ta', title='?'>extra_info_ta</a>) = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.xxx_todo_changeme', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.xxx_todo_changeme', title='?'>xxx_todo_changeme</a>
<span class='lineno'> 175</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_pretanh', title='?'>action_pretanh</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action', title='?'>action</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', title='(ValueRL, ?, bool, str, int) -> (?, ?)'>build_evalution_graph</a>(tf.stop_gradient(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', title='?'>obs</a>), get_full_info=True)
<span class='lineno'> 176</span> 
<span class='lineno'> 177</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.model_ensembling', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.model_ensembling', title='bool'>model_ensembling</a>:
<span class='lineno'> 178</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', title='?'>next_obs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', title='?'>next_dones</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_extra_info', title='?'>next_extra_info</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', title='DeterministicWorldModel'>worldmodel</a>.<a href='worldmodel.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.transition', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.transition', title='(DeterministicWorldModel, ?, ?, ?, None, None) -> (?, ?, ?)'>transition</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', title='?'>obs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action', title='?'>action</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info', title='?'>extra_info</a>, ensemble_idxs=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ensemble_idxs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ensemble_idxs', title='None'>ensemble_idxs</a>)
<span class='lineno'> 179</span>       else:
<span class='lineno'> 180</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', title='?'>next_obs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', title='?'>next_dones</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_extra_info', title='?'>next_extra_info</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', title='DeterministicWorldModel'>worldmodel</a>.<a href='worldmodel.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.transition', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.transition', title='(DeterministicWorldModel, ?, ?, ?, None, None) -> (?, ?, ?)'>transition</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', title='?'>obs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action', title='?'>action</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info', title='?'>extra_info</a>)
<span class='lineno'> 181</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', title='?'>next_obs</a> = tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', title='?'>next_obs</a>, -2)
<span class='lineno'> 182</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', title='?'>next_dones</a> = tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', title='?'>next_dones</a>, -1)
<span class='lineno'> 183</span> 
<span class='lineno'> 184</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_ta', title='?'>action_ta</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_ta', title='?'>action_ta</a>.write(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', title='?'>r_i</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action', title='?'>action</a>)
<span class='lineno'> 185</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs_ta', title='?'>obs_ta</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs_ta', title='?'>obs_ta</a>.write(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', title='?'>r_i</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs', title='?'>obs</a>)
<span class='lineno'> 186</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.dones_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.dones_ta', title='?'>dones_ta</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.dones_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.dones_ta', title='?'>dones_ta</a>.write(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', title='?'>r_i</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.done', title='?'>done</a>)
<span class='lineno'> 187</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info_ta', title='?'>extra_info_ta</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info_ta', title='?'>extra_info_ta</a>.write(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', title='?'>r_i</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info', title='?'>extra_info</a>)
<span class='lineno'> 188</span>       return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.r_i', title='?'>r_i</a>+1, (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_obs', title='?'>next_obs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_dones', title='?'>next_dones</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.next_extra_info', title='?'>next_extra_info</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.action_ta', title='?'>action_ta</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.obs_ta', title='?'>obs_ta</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.dones_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.dones_ta', title='?'>dones_ta</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body.extra_info_ta', title='?'>extra_info_ta</a>)
<span class='lineno'> 189</span> 
<span class='lineno'> 190</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph._', title='?'>_</a>, (<a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', title='?'>final_obs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_done', title='?'>final_done</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_extra_info', title='?'>final_extra_info</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.action_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.action_ta', title='?'>action_ta</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs_ta', title='?'>obs_ta</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.done_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.done_ta', title='?'>done_ta</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info_ta', title='?'>extra_info_ta</a>) = tf.while_loop(
<span class='lineno'> 191</span>         lambda <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.lambda%92.r_i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.lambda%92.r_i', title='?'>r_i</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.lambda%92._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.lambda%92._', title='?'>_</a>: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.lambda%92.r_i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.lambda%92.r_i', title='?'>r_i</a> &lt; <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a>,
<span class='lineno'> 192</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_loop_body', title='(?, ?) -> (int, (?, ?, ?, ?, ?, ?, ?))'>rollout_loop_body</a>,
<span class='lineno'> 193</span>         [0, (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs', title='?'>obs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_done', title='?'>first_done</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info', title='?'>extra_info</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.action_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.action_ta', title='?'>action_ta</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs_ta', title='?'>obs_ta</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.done_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.done_ta', title='?'>done_ta</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.extra_info_ta', title='?'>extra_info_ta</a>)]
<span class='lineno'> 194</span>     )
<span class='lineno'> 195</span> 
<span class='lineno'> 196</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action_pretanh', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action_pretanh', title='?'>final_action_pretanh</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action', title='?'>final_action</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_evalution_graph', title='(ValueRL, ?, bool, str, int) -> (?, ?)'>build_evalution_graph</a>(tf.stop_gradient(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', title='?'>final_obs</a>), get_full_info=True)
<span class='lineno'> 197</span> 
<span class='lineno'> 198</span>     ### compile the TensorArrays into useful tensors
<span class='lineno'> 199</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', title='?'>obss</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obs_ta', title='?'>obs_ta</a>.stack()
<span class='lineno'> 200</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', title='?'>obss</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', title='?'>obss</a>, tf.stack([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a>, -1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', title='?'>obs_dim</a>]))
<span class='lineno'> 201</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', title='?'>obss</a> = tf.transpose(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', title='?'>obss</a>, [1, 0, 2, 3])
<span class='lineno'> 202</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', title='?'>final_obs</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', title='?'>final_obs</a>, tf.stack([-1, 1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.obs_dim', title='?'>obs_dim</a>]))
<span class='lineno'> 203</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_obss', title='?'>all_obss</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', title='?'>obss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_obs', title='?'>final_obs</a>],1)
<span class='lineno'> 204</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.next_obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.next_obss', title='?'>next_obss</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_obss', title='?'>all_obss</a>[:,1:]
<span class='lineno'> 205</span> 
<span class='lineno'> 206</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', title='?'>dones</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.done_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.done_ta', title='?'>done_ta</a>.stack()
<span class='lineno'> 207</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', title='?'>dones</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', title='?'>dones</a>, tf.stack([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a>, -1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>]))
<span class='lineno'> 208</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', title='?'>dones</a> = tf.transpose(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', title='?'>dones</a>, [1, 0, 2])
<span class='lineno'> 209</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_done', title='?'>final_done</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_done', title='?'>final_done</a>, tf.stack([-1, 1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>]))
<span class='lineno'> 210</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_dones', title='?'>all_dones</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.dones', title='?'>dones</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_done', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_done', title='?'>final_done</a>],1)
<span class='lineno'> 211</span> 
<span class='lineno'> 212</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', title='?'>actions</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.action_ta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.action_ta', title='?'>action_ta</a>.stack()
<span class='lineno'> 213</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', title='?'>actions</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', title='?'>actions</a>, tf.stack([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a>, -1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', title='?'>action_dim</a>]))
<span class='lineno'> 214</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', title='?'>actions</a> = tf.transpose(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', title='?'>actions</a> , [1, 0, 2, 3])
<span class='lineno'> 215</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action', title='?'>final_action</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action', title='?'>final_action</a>, tf.stack([-1, 1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.action_dim', title='?'>action_dim</a>]))
<span class='lineno'> 216</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_actions', title='?'>all_actions</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', title='?'>actions</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.final_action', title='?'>final_action</a>],1)
<span class='lineno'> 217</span> 
<span class='lineno'> 218</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', title='?'>continue_probs</a> = tf.cumprod(1. - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_dones', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_dones', title='?'>all_dones</a>, axis=1)
<span class='lineno'> 219</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', title='None'>rewards</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.worldmodel', title='DeterministicWorldModel'>worldmodel</a>.<a href='worldmodel.py.html#.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.get_rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.worldmodel.DeterministicWorldModel.get_rewards', title='(DeterministicWorldModel, ?, ?, ?) -> None'>get_rewards</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', title='?'>obss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', title='?'>actions</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.next_obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.next_obss', title='?'>next_obss</a>)
<span class='lineno'> 220</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rawrew', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rawrew', title='?'>rawrew</a> = <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', title='?'>rewards</a></a> = tf.concat([tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.first_rewards', title='?'>first_rewards</a>, 1), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', title='None'>rewards</a>],1)
<span class='lineno'> 221</span> 
<span class='lineno'> 222</span>     ### TDK trick means we have to guess at every timestep
<span class='lineno'> 223</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.value_expansion', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.value_expansion', title='?'>value_expansion</a>[&quot;tdk_trick&quot;]:
<span class='lineno'> 224</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.guess_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.guess_info', title='?'>guess_info</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.obss', title='?'>obss</a>,<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.actions', title='?'>actions</a>], -1)
<span class='lineno'> 225</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', title='?'>Q_guesses</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.Q', title='{EnsembleFeedForwardNet | FeedForwardNet}'>Q</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.guess_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.guess_info', title='?'>guess_info</a>, reduce_mode=&quot;random&quot;)
<span class='lineno'> 226</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', title='?'>Q_guesses</a> = tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', title='?'>Q_guesses</a>, -1) # make it so there&#39;s only one guess per rollout length, which is the mean of the guesses under all the various model rollouts
<span class='lineno'> 227</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reached_this_point_to_guess_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reached_this_point_to_guess_prob', title='?'>reached_this_point_to_guess_prob</a> = tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', title='?'>continue_probs</a>, -1)
<span class='lineno'> 228</span>     else:
<span class='lineno'> 229</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', title='None'>Q_guesses</a> = None
<span class='lineno'> 230</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reached_this_point_to_guess_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reached_this_point_to_guess_prob', title='None'>reached_this_point_to_guess_prob</a> = None
<span class='lineno'> 231</span> 
<span class='lineno'> 232</span>     ### use the Q function at every timestep to get value estimates
<span class='lineno'> 233</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_info', title='?'>target_info</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_obss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_obss', title='?'>all_obss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.all_actions', title='?'>all_actions</a>], -1)
<span class='lineno'> 234</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_targets', title='?'>Q_targets</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.old_Q', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.old_Q', title='{EnsembleFeedForwardNet | FeedForwardNet}'>old_Q</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_info', title='?'>target_info</a>, reduce_mode=&quot;none&quot;)
<span class='lineno'> 235</span> 
<span class='lineno'> 236</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_len', title='int'>rollout_len</a> + 1 # if we take N steps, we have N+1 frames
<span class='lineno'> 237</span> 
<span class='lineno'> 238</span>     ### create &quot;decay-exponent matrix&quot; of size [1,ROLLOUT_FRAMES,ROLLOUT_FRAMES,1]. the first ROLLOUT_FRAMES corresponds to the index of the source, the second to the target.
<span class='lineno'> 239</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ts_count_mat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ts_count_mat', title='?'>ts_count_mat</a> = (tf.cast(tf.reshape(tf.range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>), [1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>]) - tf.reshape(tf.range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>), [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, 1]), tf.float32))
<span class='lineno'> 240</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_coeff_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_coeff_matrix', title='?'>reward_coeff_matrix</a> = tf.matrix_band_part(tf.ones([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>]), 0, -1) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.discount', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.discount', title='?'>discount</a> ** <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ts_count_mat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ts_count_mat', title='?'>ts_count_mat</a>
<span class='lineno'> 241</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_coeff_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_coeff_matrix', title='float'>value_coeff_matrix</a> = tf.matrix_band_part(tf.ones([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>]), 0, -1) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.discount', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.discount', title='?'>discount</a> ** (1. + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ts_count_mat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.ts_count_mat', title='?'>ts_count_mat</a>)
<span class='lineno'> 242</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_coeff_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_coeff_matrix', title='?'>reward_coeff_matrix</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_coeff_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_coeff_matrix', title='?'>reward_coeff_matrix</a>, [1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, 1, 1])
<span class='lineno'> 243</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_coeff_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_coeff_matrix', title='?'>value_coeff_matrix</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_coeff_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_coeff_matrix', title='float'>value_coeff_matrix</a>, [1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, 1, 1])
<span class='lineno'> 244</span> 
<span class='lineno'> 245</span>     ### similarly, create a &quot;done&quot; matrix
<span class='lineno'> 246</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.shifted_continue_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.shifted_continue_probs', title='?'>shifted_continue_probs</a> = tf.concat([tf.expand_dims(tf.ones_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', title='?'>continue_probs</a>[:,0]),1), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', title='?'>continue_probs</a>[:,:-1]], 1)
<span class='lineno'> 247</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_continue_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_continue_matrix', title='?'>reward_continue_matrix</a> = tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.shifted_continue_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.shifted_continue_probs', title='?'>shifted_continue_probs</a>, 1) / tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.shifted_continue_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.shifted_continue_probs', title='?'>shifted_continue_probs</a>+1e-8, 2)
<span class='lineno'> 248</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_continue_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_continue_matrix', title='?'>value_continue_matrix</a> = tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.continue_probs', title='?'>continue_probs</a>, 1) / tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.shifted_continue_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.shifted_continue_probs', title='?'>shifted_continue_probs</a>+1e-8, 2)
<span class='lineno'> 249</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_continue_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_continue_matrix', title='?'>reward_continue_matrix</a> = tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_continue_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_continue_matrix', title='?'>reward_continue_matrix</a>, -1)
<span class='lineno'> 250</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_continue_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_continue_matrix', title='?'>value_continue_matrix</a> = tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_continue_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_continue_matrix', title='?'>value_continue_matrix</a>, -1)
<span class='lineno'> 251</span> 
<span class='lineno'> 252</span>     ### apply the discounting factors to the rewards and values
<span class='lineno'> 253</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', title='?'>rewards</a> = tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', title='?'>rewards</a>, 1) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_coeff_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_coeff_matrix', title='?'>reward_coeff_matrix</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_continue_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_continue_matrix', title='?'>reward_continue_matrix</a>
<span class='lineno'> 254</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', title='?'>rewards</a> = tf.cumsum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', title='?'>rewards</a>, axis=2)
<span class='lineno'> 255</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.values', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.values', title='?'>values</a> = tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_targets', title='?'>Q_targets</a>, 1) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_coeff_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_coeff_matrix', title='?'>value_coeff_matrix</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_continue_matrix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.value_continue_matrix', title='?'>value_continue_matrix</a>
<span class='lineno'> 256</span> 
<span class='lineno'> 257</span>     ### compute the targets using the Bellman equation
<span class='lineno'> 258</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', title='?'>sampled_targets</a> = tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rewards', title='?'>rewards</a>,-2) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.reward_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.reward_scale', title='?'>reward_scale</a> + tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.values', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.values', title='?'>values</a>,-1)
<span class='lineno'> 259</span> 
<span class='lineno'> 260</span>     ### flatten out the various sources of variance (transition, reward, and Q-function ensembles) to get a set of estimates for each candidate target
<span class='lineno'> 261</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', title='?'>sampled_targets</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', title='?'>sampled_targets</a>, tf.stack([-1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.transition_sample_n', title='int'>transition_sample_n</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reward_sample_n', title='int'>reward_sample_n</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.q_sample_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.q_sample_n', title='int'>q_sample_n</a>]))
<span class='lineno'> 262</span> 
<span class='lineno'> 263</span>     ### compute the mean and variance for each candidate target
<span class='lineno'> 264</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_means', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_means', title='?'>target_means</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_variances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_variances', title='?'>target_variances</a> = tf.nn.moments(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', title='?'>sampled_targets</a>, 3)
<span class='lineno'> 265</span> 
<span class='lineno'> 266</span>     ### compute the confidence, either using the full covariance matrix, or approximating all the estimators as independent
<span class='lineno'> 267</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.self', title='ValueRL'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.value_expansion', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.value_expansion', title='?'>value_expansion</a>[&quot;covariances&quot;]:
<span class='lineno'> 268</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.targetdiffs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.targetdiffs', title='?'>targetdiffs</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.sampled_targets', title='?'>sampled_targets</a> - tf.expand_dims(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_means', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_means', title='?'>target_means</a>,3)
<span class='lineno'> 269</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_covariances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_covariances', title='?'>target_covariances</a> = tf.einsum(&quot;abij,abjk-&gt;abik&quot;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.targetdiffs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.targetdiffs', title='?'>targetdiffs</a>, tf.transpose(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.targetdiffs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.targetdiffs', title='?'>targetdiffs</a>, [0,1,3,2]))
<span class='lineno'> 270</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', title='?'>target_confidence</a> = tf.squeeze(tf.matrix_solve(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_covariances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_covariances', title='?'>target_covariances</a> + tf.expand_dims(tf.expand_dims(tf.matrix_band_part(tf.ones(tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_covariances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_covariances', title='?'>target_covariances</a>)[-2:]),0,0) * 1e-3,0),0), tf.ones(tf.concat([tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_covariances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_covariances', title='?'>target_covariances</a>)[:-1], tf.constant([1])],0))),-1)
<span class='lineno'> 271</span>     else:
<span class='lineno'> 272</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', title='float'>target_confidence</a> = 1./(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_variances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_variances', title='?'>target_variances</a> + 1e-8)
<span class='lineno'> 273</span> 
<span class='lineno'> 274</span>     ### normalize so weights sum to 1
<span class='lineno'> 275</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', title='float'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', title='float'>target_confidence</a></a> *= tf.matrix_band_part(tf.ones([1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.rollout_frames', title='int'>rollout_frames</a>]), 0, -1)
<span class='lineno'> 276</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', title='float'>target_confidence</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', title='float'>target_confidence</a> / tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', title='float'>target_confidence</a>, axis=2, keepdims=True)
<span class='lineno'> 277</span> 
<span class='lineno'> 278</span>     ### below here is a bunch of debugging Print statements that I use as a sanity check:
<span class='lineno'> 279</span>     # target_confidence = tf.Print(target_confidence, [], message=&quot;raw rewards&quot;)
<span class='lineno'> 280</span>     # target_confidence = tf.Print(target_confidence, [rawrew[0,:,0,0]], summarize=rollout_len+1)
<span class='lineno'> 281</span>     # target_means = tf.Print(target_means, [], message=&quot;\n&quot;, summarize=rollout_len+1)
<span class='lineno'> 282</span>     # target_means = tf.Print(target_means, [(1. - all_dones)[0,:,0]], message=&quot;contin&quot;, summarize=rollout_len+1)
<span class='lineno'> 283</span>     # target_means = tf.Print(target_means, [continue_probs[0,:,0]], message=&quot;cum_contin&quot;, summarize=rollout_len+1)
<span class='lineno'> 284</span>     # target_means = tf.Print(target_means, [shifted_continue_probs[0,:,0]], message=&quot;shifted contin&quot;, summarize=rollout_len+1)
<span class='lineno'> 285</span>     # target_means = tf.Print(target_means, [], message=&quot;reward_coeff&quot;)
<span class='lineno'> 286</span>     # for i in range(rollout_len+1): target_means = tf.Print(target_means, [reward_coeff_matrix[0,i,:,0,0]], summarize=rollout_len+1)
<span class='lineno'> 287</span>     # target_means = tf.Print(target_means, [], message=&quot;reward_continue&quot;)
<span class='lineno'> 288</span>     # for i in range(rollout_len+1): target_means = tf.Print(target_means, [reward_continue_matrix[0,i,:,0,0]], summarize=rollout_len+1)
<span class='lineno'> 289</span>     # target_means = tf.Print(target_means, [], message=&quot;value_coeff&quot;)
<span class='lineno'> 290</span>     # for i in range(rollout_len+1): target_means = tf.Print(target_means, [value_coeff_matrix[0,i,:,0,0]], summarize=rollout_len+1)
<span class='lineno'> 291</span>     # target_means = tf.Print(target_means, [], message=&quot;value_continue&quot;)
<span class='lineno'> 292</span>     # for i in range(rollout_len+1): target_means = tf.Print(target_means, [value_continue_matrix[0,i,:,0,0]], summarize=rollout_len+1)
<span class='lineno'> 293</span>     # target_confidence = tf.Print(target_confidence, [], message=&quot;rewards&quot;)
<span class='lineno'> 294</span>     # for i in range(rollout_len+1): target_confidence = tf.Print(target_confidence, [rewards[0,i,:,0,0]], summarize=rollout_len+1)
<span class='lineno'> 295</span>     # target_confidence = tf.Print(target_confidence, [], message=&quot;target Qs&quot;)
<span class='lineno'> 296</span>     # target_confidence = tf.Print(target_confidence, [Q_targets[0,:,0,0]], summarize=rollout_len+1)
<span class='lineno'> 297</span>     # target_confidence = tf.Print(target_confidence, [], message=&quot;values&quot;)
<span class='lineno'> 298</span>     # for i in range(rollout_len+1): target_confidence = tf.Print(target_confidence, [values[0,i,:,0,0]], summarize=rollout_len+1)
<span class='lineno'> 299</span>     # target_confidence = tf.Print(target_confidence, [], message=&quot;target_means&quot;)
<span class='lineno'> 300</span>     # for i in range(rollout_len+1): target_confidence = tf.Print(target_confidence, [target_means[0,i,:]], summarize=rollout_len+1)
<span class='lineno'> 301</span>     # target_confidence = tf.Print(target_confidence, [], message=&quot;target_variance&quot;)
<span class='lineno'> 302</span>     # for i in range(rollout_len+1): target_confidence = tf.Print(target_confidence, [target_variances[0,i,:]], summarize=rollout_len+1)
<span class='lineno'> 303</span>     # target_confidence = tf.Print(target_confidence, [], message=&quot;target_confidence&quot;)
<span class='lineno'> 304</span>     # for i in range(rollout_len+1): target_confidence = tf.Print(target_confidence, [target_confidence[0,i,:]], summarize=rollout_len+1)
<span class='lineno'> 305</span>     # target_means = tf.Print(target_means, [target_confidence, action_lls, tf.shape(Q_targets)], message=&quot;\n\n&quot;, summarize=10)
<span class='lineno'> 306</span> 
<span class='lineno'> 307</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_means', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_means', title='?'>target_means</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.target_confidence', title='float'>target_confidence</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.Q_guesses', title='None'>Q_guesses</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reached_this_point_to_guess_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.steve.valuerl.ValueRL.build_Q_expansion_graph.reached_this_point_to_guess_prob', title='None'>reached_this_point_to_guess_prob</a>
</pre></td></tr></table></body></html>