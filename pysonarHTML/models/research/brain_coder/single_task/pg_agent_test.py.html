<html>
<head>
<meta charset="utf-8">
<title>/home/xxm/Desktop/EMSE/dataset/models/research/brain_coder/single_task/pg_agent_test.py</title>
<style type='text/css'>
body { color: #666666; }
a {
    text-decoration: none; color: #5AA2A7;
    border: solid 1px rgba(255,255,255,0);
}
a.active {
    background: -webkit-linear-gradient(top,rgba(255, 255, 200, 0.35) 0,rgba(255, 255, 200, 0.55) 100%);
    border: solid 1px #E5E600;
}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #cccccc;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px solid orange; padding-bottom: 1px}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted;

function highlight(xid)
{
    var elms = document.querySelectorAll('[xid="' + xid + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "active";
    }
    highlighted = xid;
}

function clearHighlight() {
    var elms = document.querySelectorAll('[xid="' + highlighted + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "";
    }
}

window.onload =
    function (e) {
        var tags = document.getElementsByTagName("A")
        for (var i = 0; i < tags.length; i++) {
            tags[i].onmouseover =
                function (e) {
                    clearHighlight();
                    var xid = e.toElement.getAttribute('xid');
                    highlight(xid);
                }
        }
    }</script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', xid='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape'>smape</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot', xid='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot'>onehot</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence', xid='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence'>random_sequence</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad', xid='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad'>repeat_and_pad</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest', xid='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest'>AgentTest</a><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes', xid='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes'>testProcessEpisodes</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates', xid='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates'>testVarUpdates</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients', xid='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients'>testMonteCarloGradients</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking', xid='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking'>testNumericalGradChecking</a></li></ul>
</li></ul>
</td><td><pre><span class='lineno'>   1</span> from __future__ import absolute_import
<span class='lineno'>   2</span> from __future__ import division
<span class='lineno'>   3</span> from __future__ import print_function
<span class='lineno'>   4</span> 
<span class='lineno'>   5</span> &quot;&quot;&quot;Tests for pg_agent.&quot;&quot;&quot;
<span class='lineno'>   6</span> 
<span class='lineno'>   7</span> from collections import Counter
<span class='lineno'>   8</span> 
<span class='lineno'>   9</span> from absl import logging
<span class='lineno'>  10</span> import numpy as np
<span class='lineno'>  11</span> from six.moves import xrange
<span class='lineno'>  12</span> import tensorflow as tf
<span class='lineno'>  13</span> 
<span class='lineno'>  14</span> from common import utils  # brain coder
<span class='lineno'>  15</span> from single_task import data  # brain coder
<span class='lineno'>  16</span> from single_task import defaults  # brain coder
<span class='lineno'>  17</span> from single_task import misc  # brain coder
<span class='lineno'>  18</span> from single_task import pg_agent as agent_lib  # brain coder
<span class='lineno'>  19</span> from single_task import pg_train  # brain coder
<span class='lineno'>  20</span> 
<span class='lineno'>  21</span> 
<span class='lineno'>  22</span> # Symmetric mean absolute percentage error (SMAPE).
<span class='lineno'>  23</span> # https://en.wikipedia.org/wiki/Symmetric_mean_absolute_percentage_error
<span class='lineno'>  24</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', title='(?, ?) -> float / (float, ?) -> float'>smape</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.a', title='float'>a</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.b', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.b', title='?'>b</a>):
<span class='lineno'>  25</span>   return 2.0 * abs(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.a', title='float'>a</a> - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.b', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.b', title='?'>b</a>) / float(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.a', title='float'>a</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.b', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape.b', title='?'>b</a>)
<span class='lineno'>  26</span> 
<span class='lineno'>  27</span> 
<span class='lineno'>  28</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot', title='(int, ?) -> None / (?, ?) -> None'>onehot</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.dim', title='int'>dim</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.num_dims', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.num_dims', title='?'>num_dims</a>):
<span class='lineno'>  29</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.value', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.value', title='?'>value</a> = np.zeros(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.num_dims', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.num_dims', title='?'>num_dims</a>, dtype=np.float32)
<span class='lineno'>  30</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.value', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.value', title='?'>value</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.dim', title='int'>dim</a>] = 1
<span class='lineno'>  31</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.value', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot.value', title='?'>value</a>
<span class='lineno'>  32</span> 
<span class='lineno'>  33</span> 
<span class='lineno'>  34</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence', title='(int, int, int) -> None / (?, ?, int) -> None'>random_sequence</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.max_length', title='int'>max_length</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.num_tokens', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.num_tokens', title='int'>num_tokens</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.eos', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.eos', title='int'>eos</a>=0):
<span class='lineno'>  35</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.length', title='?'>length</a> = np.random.randint(1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.max_length', title='int'>max_length</a> - 1)
<span class='lineno'>  36</span>   return np.append(np.random.randint(1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.num_tokens', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.num_tokens', title='int'>num_tokens</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.length', title='?'>length</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.eos', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence.eos', title='int'>eos</a>)
<span class='lineno'>  37</span> 
<span class='lineno'>  38</span> 
<span class='lineno'>  39</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad', title='(?, ?, ?) -> ? / (?, int, int) -> ? / (?, ?, int) -> [?]'>repeat_and_pad</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.v', title='?'>v</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.rep', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.rep', title='int'>rep</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.total_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.total_len', title='int'>total_len</a>):
<span class='lineno'>  40</span>   return [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.v', title='?'>v</a>] * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.rep', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.rep', title='int'>rep</a> + [0.0] * (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.total_len', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.total_len', title='int'>total_len</a> - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.rep', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad.rep', title='int'>rep</a>)
<span class='lineno'>  41</span> 
<span class='lineno'>  42</span> 
<span class='lineno'>  43</span> class <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest', title='<AgentTest>'>AgentTest</a>(tf.test.TestCase):
<span class='lineno'>  44</span> 
<span class='lineno'>  45</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes', title='AgentTest -> None'>testProcessEpisodes</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.self', title='AgentTest'>self</a>):
<span class='lineno'>  46</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_size', title='int'>batch_size</a> = 3
<span class='lineno'>  47</span> 
<span class='lineno'>  48</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn', title='? -> ?'>reward_fn</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.code_string', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.code_string', title='?'>code_string</a>):
<span class='lineno'>  49</span>       return misc.RewardInfo(
<span class='lineno'>  50</span>           episode_rewards=[float(ord(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.c', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.c', title='?'>c</a>)) for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.c', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.c', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.c', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.c', title='?'>c</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.code_string', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn.code_string', title='?'>code_string</a>],
<span class='lineno'>  51</span>           input_case=[],
<span class='lineno'>  52</span>           correct_output=[],
<span class='lineno'>  53</span>           code_output=[],
<span class='lineno'>  54</span>           input_type=misc.IOType.integer,
<span class='lineno'>  55</span>           output_type=misc.IOType.integer,
<span class='lineno'>  56</span>           reason=&#39;none&#39;)
<span class='lineno'>  57</span> 
<span class='lineno'>  58</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.rl_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.rl_batch', title='?'>rl_batch</a> = data.RLBatch(
<span class='lineno'>  59</span>         reward_fns=[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.reward_fn', title='? -> ?'>reward_fn</a> for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes._', title='int'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes._', title='int'>_</a></a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_size', title='int'>batch_size</a>)],
<span class='lineno'>  60</span>         batch_size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_size', title='int'>batch_size</a>,
<span class='lineno'>  61</span>         good_reward=10.0)
<span class='lineno'>  62</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_actions', title='?'>batch_actions</a> = np.asarray([
<span class='lineno'>  63</span>         [4, 5, 3, 6, 8, 1, 0, 0],
<span class='lineno'>  64</span>         [1, 2, 3, 4, 0, 0, 0, 0],
<span class='lineno'>  65</span>         [8, 7, 6, 5, 4, 3, 2, 1]], dtype=np.int32)
<span class='lineno'>  66</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_values', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_values', title='?'>batch_values</a> = np.asarray([
<span class='lineno'>  67</span>         [0, 1, 2, 1, 0, 1, 1, 0],
<span class='lineno'>  68</span>         [0, 2, 1, 2, 1, 0, 0, 0],
<span class='lineno'>  69</span>         [0, 1, 1, 0, 0, 0, 1, 1]], dtype=np.float32)
<span class='lineno'>  70</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.episode_lengths', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.episode_lengths', title='?'>episode_lengths</a> = np.asarray([7, 5, 8], dtype=np.int32)
<span class='lineno'>  71</span> 
<span class='lineno'>  72</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.scores', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.scores', title='?'>scores</a> = agent_lib.compute_rewards(
<span class='lineno'>  73</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.rl_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.rl_batch', title='?'>rl_batch</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_actions', title='?'>batch_actions</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.episode_lengths', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.episode_lengths', title='?'>episode_lengths</a>)
<span class='lineno'>  74</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_targets', title='?'>batch_targets</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_returns', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_returns', title='?'>batch_returns</a> = agent_lib.process_episodes(
<span class='lineno'>  75</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.scores', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.scores', title='?'>scores</a>.batch_rewards, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.episode_lengths', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.episode_lengths', title='?'>episode_lengths</a>, a2c=True,
<span class='lineno'>  76</span>         batch_values=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_values', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_values', title='?'>batch_values</a>)
<span class='lineno'>  77</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.self', title='AgentTest'>self</a>.assertEqual(
<span class='lineno'>  78</span>         [[473.0, 428.0, 337.0, 294.0, 201.0, 157.0, 95.0, 0.0],
<span class='lineno'>  79</span>          [305.0, 243.0, 183.0, 140.0, 95.0, 0.0, 0.0, 0.0],
<span class='lineno'>  80</span>          [484.0, 440.0, 394.0, 301.0, 210.0, 165.0, 122.0, 62.0]],
<span class='lineno'>  81</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_returns', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_returns', title='?'>batch_returns</a>.tolist())
<span class='lineno'>  82</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.self', title='AgentTest'>self</a>.assertEqual(
<span class='lineno'>  83</span>         [[473.0, 427.0, 335.0, 293.0, 201.0, 156.0, 94.0, 0.0],
<span class='lineno'>  84</span>          [305.0, 241.0, 182.0, 138.0, 94.0, 0.0, 0.0, 0.0],
<span class='lineno'>  85</span>          [484.0, 439.0, 393.0, 301.0, 210.0, 165.0, 121.0, 61.0]],
<span class='lineno'>  86</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_targets', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testProcessEpisodes.batch_targets', title='?'>batch_targets</a>.tolist())
<span class='lineno'>  87</span> 
<span class='lineno'>  88</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates', title='AgentTest -> None'>testVarUpdates</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', title='AgentTest'>self</a>):
<span class='lineno'>  89</span>     &quot;&quot;&quot;Tests that variables get updated as expected.
<span class='lineno'>  90</span> 
<span class='lineno'>  91</span>     For the RL update, check that gradients are non-zero and that the global
<span class='lineno'>  92</span>     model gets updated.
<span class='lineno'>  93</span>     &quot;&quot;&quot;
<span class='lineno'>  94</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.config', title='?'>config</a> = defaults.default_config_with_updates(
<span class='lineno'>  95</span>         &#39;env=c(task=&quot;reverse&quot;),&#39;
<span class='lineno'>  96</span>         &#39;agent=c(algorithm=&quot;pg&quot;,eos_token=True,optimizer=&quot;sgd&quot;,lr=1.0)&#39;)
<span class='lineno'>  97</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.lr', title='?'>lr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.config', title='?'>config</a>.agent.lr
<span class='lineno'>  98</span> 
<span class='lineno'>  99</span>     tf.reset_default_graph()
<span class='lineno'> 100</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a> = pg_train.AsyncTrainer(
<span class='lineno'> 101</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.config', title='?'>config</a>, task_id=0, ps_tasks=0, num_workers=1)
<span class='lineno'> 102</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_init_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_init_op', title='?'>global_init_op</a> = tf.variables_initializer(
<span class='lineno'> 103</span>         tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, &#39;global&#39;))
<span class='lineno'> 104</span>     with tf.Session() as <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>:
<span class='lineno'> 105</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_init_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_init_op', title='?'>global_init_op</a>)  # Initialize global copy.
<span class='lineno'> 106</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.initialize(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>)
<span class='lineno'> 107</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', title='?'>model</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.model
<span class='lineno'> 108</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_vars', title='?'>global_vars</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.global_model.trainable_variables)
<span class='lineno'> 109</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', title='?'>local_vars</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', title='?'>model</a>.trainable_variables)
<span class='lineno'> 110</span> 
<span class='lineno'> 111</span>       # Make sure names match.
<span class='lineno'> 112</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.g_prefix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.g_prefix', title='str'>g_prefix</a> = &#39;global/&#39;
<span class='lineno'> 113</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.l_prefix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.l_prefix', title='str'>l_prefix</a> = &#39;local/&#39;
<span class='lineno'> 114</span>       for g, l in zip(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.global_model.trainable_variables,
<span class='lineno'> 115</span>                       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', title='?'>model</a>.trainable_variables):
<span class='lineno'> 116</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', title='AgentTest'>self</a>.assertEqual(g.name[len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.g_prefix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.g_prefix', title='str'>g_prefix</a>):], l.name[len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.l_prefix', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.l_prefix', title='str'>l_prefix</a>):])
<span class='lineno'> 117</span> 
<span class='lineno'> 118</span>       # Assert that shapes and values are the same between global and local
<span class='lineno'> 119</span>       # models.
<span class='lineno'> 120</span>       for g, l in zip(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_vars', title='?'>global_vars</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', title='?'>local_vars</a>):
<span class='lineno'> 121</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', title='AgentTest'>self</a>.assertEqual(g.shape, l.shape)
<span class='lineno'> 122</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', title='AgentTest'>self</a>.assertTrue(np.array_equal(g, l))
<span class='lineno'> 123</span> 
<span class='lineno'> 124</span>       # Make all gradients dense tensors.
<span class='lineno'> 125</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.param', title='?'>param</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', title='?'>grad</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', title='?'>model</a>.gradients_dict.items():
<span class='lineno'> 126</span>         if isinstance(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', title='?'>grad</a></a>, tf.IndexedSlices):
<span class='lineno'> 127</span>           # Converts to dense tensor.
<span class='lineno'> 128</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', title='?'>model</a>.gradients_dict[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.param', title='?'>param</a>] = tf.multiply(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', title='?'>grad</a>, 1.0)
<span class='lineno'> 129</span> 
<span class='lineno'> 130</span>       # Perform update.
<span class='lineno'> 131</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.results', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.results', title='?'>results</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', title='?'>model</a>.update_step(
<span class='lineno'> 132</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.data_manager.sample_rl_batch(), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.train_op,
<span class='lineno'> 133</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.global_step, return_gradients=True)
<span class='lineno'> 134</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grads_dict', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grads_dict', title='?'>grads_dict</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.results', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.results', title='?'>results</a>.gradients_dict
<span class='lineno'> 135</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', title='?'>grad</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grads_dict', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grads_dict', title='?'>grads_dict</a>.values():
<span class='lineno'> 136</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', title='AgentTest'>self</a>.assertIsNotNone(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', title='?'>grad</a>)
<span class='lineno'> 137</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', title='AgentTest'>self</a>.assertTrue(np.count_nonzero(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grad', title='?'>grad</a>) &gt; 0)
<span class='lineno'> 138</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_update', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_update', title='?'>global_update</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.global_model.trainable_variables)
<span class='lineno'> 139</span>       for tf_var, var_before, var_after in zip(
<span class='lineno'> 140</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', title='?'>model</a>.trainable_variables, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', title='?'>local_vars</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_update', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_update', title='?'>global_update</a>):
<span class='lineno'> 141</span>         # Check that the params were updated.
<span class='lineno'> 142</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', title='AgentTest'>self</a>.assertTrue(np.allclose(
<span class='lineno'> 143</span>             var_after,
<span class='lineno'> 144</span>             var_before - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grads_dict', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.grads_dict', title='?'>grads_dict</a>[tf_var] * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.lr', title='?'>lr</a>))
<span class='lineno'> 145</span> 
<span class='lineno'> 146</span>       # Test that global to local sync works.
<span class='lineno'> 147</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.sync_op)
<span class='lineno'> 148</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_vars', title='?'>global_vars</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.trainer', title='?'>trainer</a>.global_model.trainable_variables)
<span class='lineno'> 149</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', title='?'>local_vars</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.model', title='?'>model</a>.trainable_variables)
<span class='lineno'> 150</span>       for l, g in zip(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.local_vars', title='?'>local_vars</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.global_vars', title='?'>global_vars</a>):
<span class='lineno'> 151</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testVarUpdates.self', title='AgentTest'>self</a>.assertTrue(np.allclose(l, g))
<span class='lineno'> 152</span> 
<span class='lineno'> 153</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients', title='AgentTest -> None'>testMonteCarloGradients</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', title='AgentTest'>self</a>):
<span class='lineno'> 154</span>     &quot;&quot;&quot;Test Monte Carlo estimate of REINFORCE gradient.
<span class='lineno'> 155</span> 
<span class='lineno'> 156</span>     Test that the Monte Carlo estimate of the REINFORCE gradient is
<span class='lineno'> 157</span>     approximately equal to the true gradient. We compute the true gradient for a
<span class='lineno'> 158</span>     toy environment with a very small action space.
<span class='lineno'> 159</span> 
<span class='lineno'> 160</span>     Similar to section 5 of https://arxiv.org/pdf/1505.00521.pdf.
<span class='lineno'> 161</span>     &quot;&quot;&quot;
<span class='lineno'> 162</span>     # Test may have different outcome on different machines due to different
<span class='lineno'> 163</span>     # rounding behavior of float arithmetic.
<span class='lineno'> 164</span>     tf.reset_default_graph()
<span class='lineno'> 165</span>     tf.set_random_seed(12345678987654321)
<span class='lineno'> 166</span>     np.random.seed(1294024302)
<span class='lineno'> 167</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', title='int'>max_length</a> = 2
<span class='lineno'> 168</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.num_tokens', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.num_tokens', title='?'>num_tokens</a> = misc.bf_num_tokens()
<span class='lineno'> 169</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.eos', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.eos', title='?'>eos</a> = misc.BF_EOS_INT
<span class='lineno'> 170</span>     assert <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.eos', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.eos', title='?'>eos</a> == 0
<span class='lineno'> 171</span>     def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator', title='int -> None'>sequence_iterator</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.max_length', title='int'>max_length</a>):
<span class='lineno'> 172</span>       &quot;&quot;&quot;Iterates through all sequences up to the given length.&quot;&quot;&quot;
<span class='lineno'> 173</span>       yield [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.eos', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.eos', title='?'>eos</a>]
<span class='lineno'> 174</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.a', title='int'>a</a> in xrange(1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.num_tokens', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.num_tokens', title='?'>num_tokens</a>):
<span class='lineno'> 175</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.max_length', title='int'>max_length</a> &gt; 1:
<span class='lineno'> 176</span>           for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.sub_seq', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.sub_seq', title='?'>sub_seq</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator', title='int -> None'>sequence_iterator</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.max_length', title='int'>max_length</a> - 1):
<span class='lineno'> 177</span>             yield [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.a', title='int'>a</a>] + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.sub_seq', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.sub_seq', title='?'>sub_seq</a>
<span class='lineno'> 178</span>         else:
<span class='lineno'> 179</span>           yield [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator.a', title='int'>a</a>]
<span class='lineno'> 180</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions', title='list'>actions</a> = list(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sequence_iterator', title='int -> None'>sequence_iterator</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', title='int'>max_length</a>))
<span class='lineno'> 181</span> 
<span class='lineno'> 182</span>     # This batch contains all possible episodes up to max_length.
<span class='lineno'> 183</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', title='?'>actions_batch</a> = utils.stack_pad(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions', title='list'>actions</a>, 0)
<span class='lineno'> 184</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_batch', title='[int]'>lengths_batch</a> = [len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.s', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.s', title='<list>'>s</a>) for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.s', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.s', title='<list>'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.s', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.s', title='<list>'>s</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions', title='list'>actions</a>]
<span class='lineno'> 185</span> 
<span class='lineno'> 186</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', title='dict'>reward_map</a> = {tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>): np.random.randint(-1, 7) for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', title='?'>actions_batch</a>}
<span class='lineno'> 187</span>     # reward_map = {tuple(a): np.random.normal(3, 1)
<span class='lineno'> 188</span>     #               for a in actions_batch}  # normal distribution
<span class='lineno'> 189</span>     # reward_map = {tuple(a): 1.0
<span class='lineno'> 190</span>     #               for a in actions_batch}  # expected reward is 1
<span class='lineno'> 191</span> 
<span class='lineno'> 192</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.n', title='int'>n</a> = 100000  # MC sample size.
<span class='lineno'> 193</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.config', title='?'>config</a> = defaults.default_config_with_updates(
<span class='lineno'> 194</span>         &#39;env=c(task=&quot;print&quot;),&#39;
<span class='lineno'> 195</span>         &#39;agent=c(algorithm=&quot;pg&quot;,optimizer=&quot;sgd&quot;,lr=1.0,ema_baseline_decay=0.99,&#39;
<span class='lineno'> 196</span>         &#39;entropy_beta=0.0,topk_loss_hparam=0.0,regularizer=0.0,&#39;
<span class='lineno'> 197</span>         &#39;policy_lstm_sizes=[10],eos_token=True),&#39;
<span class='lineno'> 198</span>         &#39;batch_size=&#39;+str(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.n', title='int'>n</a>)+&#39;,timestep_limit=&#39;+str(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', title='int'>max_length</a>))
<span class='lineno'> 199</span> 
<span class='lineno'> 200</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.dtype', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.dtype', title='?'>dtype</a> = tf.float64
<span class='lineno'> 201</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.trainer', title='?'>trainer</a> = pg_train.AsyncTrainer(
<span class='lineno'> 202</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.config', title='?'>config</a>, task_id=0, ps_tasks=0, num_workers=1, dtype=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.dtype', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.dtype', title='?'>dtype</a>)
<span class='lineno'> 203</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.trainer', title='?'>trainer</a>.model
<span class='lineno'> 204</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_ph', title='?'>actions_ph</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.actions
<span class='lineno'> 205</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_ph', title='?'>lengths_ph</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.adjusted_lengths
<span class='lineno'> 206</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.multipliers_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.multipliers_ph', title='?'>multipliers_ph</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.policy_multipliers
<span class='lineno'> 207</span> 
<span class='lineno'> 208</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.global_init_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.global_init_op', title='?'>global_init_op</a> = tf.variables_initializer(
<span class='lineno'> 209</span>         tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, &#39;global&#39;))
<span class='lineno'> 210</span>     with tf.Session() as <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', title='?'>sess</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', title='?'>sess</a>.graph.as_default():
<span class='lineno'> 211</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.global_init_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.global_init_op', title='?'>global_init_op</a>)  # Initialize global copy.
<span class='lineno'> 212</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.trainer', title='?'>trainer</a>.initialize(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', title='?'>sess</a>)
<span class='lineno'> 213</span> 
<span class='lineno'> 214</span>       # Compute exact gradients.
<span class='lineno'> 215</span>       # exact_grads = sum(P(a) * grad(log P(a)) * R(a) for a in actions_batch)
<span class='lineno'> 216</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss_unnormalized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss_unnormalized', title='float'>true_loss_unnormalized</a> = 0.0
<span class='lineno'> 217</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', title='[?]'>exact_grads</a> = [np.zeros(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', title='?'>v</a>.shape) for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', title='?'>v</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.trainable_variables]
<span class='lineno'> 218</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', title='dict'>episode_probs_map</a> = {}
<span class='lineno'> 219</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_map', title='dict'>grads_map</a> = {}
<span class='lineno'> 220</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', title='int'>a_idx</a> in xrange(len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', title='?'>actions_batch</a>)):
<span class='lineno'> 221</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', title='?'>actions_batch</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', title='int'>a_idx</a>]
<span class='lineno'> 222</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_result', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_result', title='?'>grads_result</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.probs_result', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.probs_result', title='?'>probs_result</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss', title='?'>loss</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', title='?'>sess</a>.run(
<span class='lineno'> 223</span>             [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.dense_unclipped_grads, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.chosen_probs, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.loss],
<span class='lineno'> 224</span>             {<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_ph', title='?'>actions_ph</a>: [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>],
<span class='lineno'> 225</span>              <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_ph', title='?'>lengths_ph</a>: [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_batch', title='[int]'>lengths_batch</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', title='int'>a_idx</a>]],
<span class='lineno'> 226</span>              <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.multipliers_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.multipliers_ph', title='?'>multipliers_ph</a>: [
<span class='lineno'> 227</span>                  <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad', title='(?, ?, ?) -> ? / (?, int, int) -> ? / (?, ?, int) -> [?]'>repeat_and_pad</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', title='dict'>reward_map</a>[tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>)],
<span class='lineno'> 228</span>                                 <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_batch', title='[int]'>lengths_batch</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', title='int'>a_idx</a>],
<span class='lineno'> 229</span>                                 <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', title='int'>max_length</a>)]})
<span class='lineno'> 230</span>         # Take product over time axis.
<span class='lineno'> 231</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_result', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_result', title='?'>episode_probs_result</a> = np.prod(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.probs_result', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.probs_result', title='?'>probs_result</a>[0, :<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_batch', title='[int]'>lengths_batch</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a_idx', title='int'>a_idx</a>]])
<span class='lineno'> 232</span>         for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a> in range(0, len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', title='[?]'>exact_grads</a>)):
<span class='lineno'> 233</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', title='[?]'>exact_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>] += <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_result', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_result', title='?'>grads_result</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>] * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_result', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_result', title='?'>episode_probs_result</a>
<span class='lineno'> 234</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', title='dict'>episode_probs_map</a>[tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>)] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_result', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_result', title='?'>episode_probs_result</a>
<span class='lineno'> 235</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', title='dict'>reward_map</a>[tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>)] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', title='dict'>reward_map</a>[tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>)]
<span class='lineno'> 236</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_map', title='dict'>grads_map</a>[tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>)] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_result', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_result', title='?'>grads_result</a>
<span class='lineno'> 237</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss_unnormalized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss_unnormalized', title='float'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss_unnormalized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss_unnormalized', title='float'>true_loss_unnormalized</a></a> += <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss', title='?'>loss</a>
<span class='lineno'> 238</span>       # Normalize loss. Since each episode is feed into the model one at a time,
<span class='lineno'> 239</span>       # normalization needs to be done manually.
<span class='lineno'> 240</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss', title='float'>true_loss</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss_unnormalized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss_unnormalized', title='float'>true_loss_unnormalized</a> / float(len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_batch', title='?'>actions_batch</a>))
<span class='lineno'> 241</span> 
<span class='lineno'> 242</span>       # Compute Monte Carlo gradients.
<span class='lineno'> 243</span>       # E_a~P[grad(log P(a)) R(a)] is aprox. eq. to
<span class='lineno'> 244</span>       # sum(grad(log P(a)) R(a) for a in actions_sampled_from_P) / n
<span class='lineno'> 245</span>       # where len(actions_sampled_from_P) == n.
<span class='lineno'> 246</span>       #
<span class='lineno'> 247</span>       # In other words, sample from the policy and compute the gradients of the
<span class='lineno'> 248</span>       # log probs weighted by the returns. This will excersize the code in
<span class='lineno'> 249</span>       # agent.py
<span class='lineno'> 250</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', title='?'>sampled_actions</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_lengths', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_lengths', title='?'>sampled_lengths</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', title='?'>sess</a>.run(
<span class='lineno'> 251</span>           [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.sampled_tokens, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.episode_lengths])
<span class='lineno'> 252</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.pi_multipliers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.pi_multipliers', title='[[?]]'>pi_multipliers</a> = [
<span class='lineno'> 253</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.repeat_and_pad', title='(?, ?, ?) -> ? / (?, int, int) -> ? / (?, ?, int) -> [?]'>repeat_and_pad</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', title='dict'>reward_map</a>[tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>)], l, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.max_length', title='int'>max_length</a>)
<span class='lineno'> 254</span>           for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>, l in zip(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', title='?'>sampled_actions</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_lengths', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_lengths', title='?'>sampled_lengths</a>)]
<span class='lineno'> 255</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_unnormalized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_unnormalized', title='?'>mc_grads_unnormalized</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_probs', title='?'>sampled_probs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_loss_unnormalized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_loss_unnormalized', title='?'>mc_loss_unnormalized</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sess', title='?'>sess</a>.run(
<span class='lineno'> 256</span>           [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.dense_unclipped_grads, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.chosen_probs, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.loss],
<span class='lineno'> 257</span>           {<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.actions_ph', title='?'>actions_ph</a>: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', title='?'>sampled_actions</a>,
<span class='lineno'> 258</span>            <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.multipliers_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.multipliers_ph', title='?'>multipliers_ph</a>: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.pi_multipliers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.pi_multipliers', title='[[?]]'>pi_multipliers</a>,
<span class='lineno'> 259</span>            <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.lengths_ph', title='?'>lengths_ph</a>: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_lengths', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_lengths', title='?'>sampled_lengths</a>})
<span class='lineno'> 260</span>       # Loss is already normalized across the minibatch, so no normalization
<span class='lineno'> 261</span>       # is needed.
<span class='lineno'> 262</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', title='?'>mc_grads</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_unnormalized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_unnormalized', title='?'>mc_grads_unnormalized</a>
<span class='lineno'> 263</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_loss', title='?'>mc_loss</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_loss_unnormalized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_loss_unnormalized', title='?'>mc_loss_unnormalized</a>
<span class='lineno'> 264</span> 
<span class='lineno'> 265</span>     # Make sure true loss and MC loss are similar.
<span class='lineno'> 266</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss_error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss_error', title='float'>loss_error</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', title='(?, ?) -> float / (float, ?) -> float'>smape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_loss', title='float'>true_loss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_loss', title='?'>mc_loss</a>)
<span class='lineno'> 267</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', title='AgentTest'>self</a>.assertTrue(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss_error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss_error', title='float'>loss_error</a> &lt; 0.15, msg=&#39;actual: %s&#39; % <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss_error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.loss_error', title='float'>loss_error</a>)
<span class='lineno'> 268</span> 
<span class='lineno'> 269</span>     # Check that probs computed for episodes sampled from the model are the same
<span class='lineno'> 270</span>     # as the recorded true probs.
<span class='lineno'> 271</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a> in range(100):
<span class='lineno'> 272</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', title='tuple'>acs</a> = tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', title='?'>sampled_actions</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>].tolist())
<span class='lineno'> 273</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_prob', title='?'>sampled_prob</a> = np.prod(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_probs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_probs', title='?'>sampled_probs</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>, :<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_lengths', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_lengths', title='?'>sampled_lengths</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>]])
<span class='lineno'> 274</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', title='AgentTest'>self</a>.assertTrue(np.isclose(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', title='dict'>episode_probs_map</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', title='tuple'>acs</a>], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_prob', title='?'>sampled_prob</a>))
<span class='lineno'> 275</span> 
<span class='lineno'> 276</span>     # Make sure MC estimates of true probs are close.
<span class='lineno'> 277</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.counter', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.counter', title='?'>counter</a> = Counter(tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.e', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.e', title='?'>e</a>) for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.e', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.e', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.e', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.e', title='?'>e</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', title='?'>sampled_actions</a>)
<span class='lineno'> 278</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', title='?'>acs</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.count', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.count', title='?'>count</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.counter', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.counter', title='?'>counter</a>.iteritems():
<span class='lineno'> 279</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_prob', title='float'>mc_prob</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.count', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.count', title='?'>count</a> / float(len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', title='?'>sampled_actions</a>))
<span class='lineno'> 280</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_prob', title='?'>true_prob</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', title='dict'>episode_probs_map</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', title='?'>acs</a>]
<span class='lineno'> 281</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', title='float'>error</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', title='(?, ?) -> float / (float, ?) -> float'>smape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_prob', title='float'>mc_prob</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_prob', title='?'>true_prob</a>)
<span class='lineno'> 282</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', title='AgentTest'>self</a>.assertTrue(
<span class='lineno'> 283</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', title='float'>error</a> &lt; 0.15,
<span class='lineno'> 284</span>           msg=&#39;actual: %s; count: %s; mc_prob: %s; true_prob: %s&#39;
<span class='lineno'> 285</span>           % (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', title='float'>error</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.count', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.count', title='?'>count</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_prob', title='float'>mc_prob</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_prob', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.true_prob', title='?'>true_prob</a>))
<span class='lineno'> 286</span> 
<span class='lineno'> 287</span>     # Manually recompute MC gradients and make sure they match MC gradients
<span class='lineno'> 288</span>     # computed in TF.
<span class='lineno'> 289</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', title='[?]'>mc_grads_recompute</a> = [np.zeros(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', title='?'>v</a>.shape) for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v', title='?'>v</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.model', title='?'>model</a>.trainable_variables]
<span class='lineno'> 290</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.n', title='int'>n</a>):
<span class='lineno'> 291</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', title='tuple'>acs</a> = tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', title='?'>sampled_actions</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>].tolist())
<span class='lineno'> 292</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a> in range(0, len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', title='[?]'>mc_grads_recompute</a>)):
<span class='lineno'> 293</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', title='[?]'>mc_grads_recompute</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>] += <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.grads_map', title='dict'>grads_map</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.acs', title='tuple'>acs</a>][<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>]
<span class='lineno'> 294</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a> in range(0, len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', title='[?]'>mc_grads_recompute</a>)):
<span class='lineno'> 295</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', title='AgentTest'>self</a>.assertTrue(np.allclose(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', title='?'>mc_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads_recompute', title='[?]'>mc_grads_recompute</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.i', title='int'>i</a>] / <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.n', title='int'>n</a>))
<span class='lineno'> 296</span> 
<span class='lineno'> 297</span>     # Check angle between gradients as fraction of pi.
<span class='lineno'> 298</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', title='int'>index</a> in range(len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', title='?'>mc_grads</a>)):
<span class='lineno'> 299</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1', title='?'>v1</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', title='?'>mc_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', title='int'>index</a>].reshape(-1)
<span class='lineno'> 300</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2', title='?'>v2</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', title='[?]'>exact_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', title='int'>index</a>].reshape(-1)
<span class='lineno'> 301</span>       # angle = arccos(v1 . v2 / (|v1|*|v2|))
<span class='lineno'> 302</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_rad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_rad', title='?'>angle_rad</a> = np.arccos(
<span class='lineno'> 303</span>           np.dot(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1', title='?'>v1</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2', title='?'>v2</a>) / (np.linalg.norm(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1', title='?'>v1</a>) * np.linalg.norm(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2', title='?'>v2</a>)))
<span class='lineno'> 304</span>       logging.info(&#39;angle / pi: %s&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_rad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_rad', title='?'>angle_rad</a> / np.pi)
<span class='lineno'> 305</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_frac', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_frac', title='?'>angle_frac</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_rad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_rad', title='?'>angle_rad</a> / np.pi
<span class='lineno'> 306</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', title='AgentTest'>self</a>.assertTrue(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_frac', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_frac', title='?'>angle_frac</a> &lt; 0.02, msg=&#39;actual: %s&#39; % <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_frac', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_frac', title='?'>angle_frac</a>)
<span class='lineno'> 307</span>     # Check norms.
<span class='lineno'> 308</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', title='int'>index</a> in range(len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', title='?'>mc_grads</a>)):
<span class='lineno'> 309</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1_norm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1_norm', title='?'>v1_norm</a> = np.linalg.norm(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_grads', title='?'>mc_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', title='int'>index</a>].reshape(-1))
<span class='lineno'> 310</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2_norm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2_norm', title='?'>v2_norm</a> = np.linalg.norm(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_grads', title='[?]'>exact_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.index', title='int'>index</a>].reshape(-1))
<span class='lineno'> 311</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', title='float'>error</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', title='(?, ?) -> float / (float, ?) -> float'>smape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1_norm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v1_norm', title='?'>v1_norm</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2_norm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.v2_norm', title='?'>v2_norm</a>)
<span class='lineno'> 312</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', title='AgentTest'>self</a>.assertTrue(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', title='float'>error</a> &lt; 0.02, msg=&#39;actual: %s&#39; % <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', title='float'>error</a>)
<span class='lineno'> 313</span> 
<span class='lineno'> 314</span>     # Check expected rewards.
<span class='lineno'> 315</span>     # E_a~P[R(a)] approx eq sum(P(a) * R(a) for a in actions)
<span class='lineno'> 316</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_expected_reward', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_expected_reward', title='?'>mc_expected_reward</a> = np.mean(
<span class='lineno'> 317</span>         [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', title='dict'>reward_map</a>[tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a>)] for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.a', title='?'>a</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.sampled_actions', title='?'>sampled_actions</a>])
<span class='lineno'> 318</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_expected_reward', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_expected_reward', title='?'>exact_expected_reward</a> = np.sum(
<span class='lineno'> 319</span>         [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.episode_probs_map', title='dict'>episode_probs_map</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.k', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.k', title='?'>k</a>] * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', title='dict'>reward_map</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.k', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.k', title='?'>k</a>] for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.k', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.k', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.k', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.k', title='?'>k</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.reward_map', title='dict'>reward_map</a>])
<span class='lineno'> 320</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', title='float'>error</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.smape', title='(?, ?) -> float / (float, ?) -> float'>smape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_expected_reward', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.mc_expected_reward', title='?'>mc_expected_reward</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_expected_reward', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.exact_expected_reward', title='?'>exact_expected_reward</a>)
<span class='lineno'> 321</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.self', title='AgentTest'>self</a>.assertTrue(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.error', title='float'>error</a> &lt; 0.005, msg=&#39;actual: %s&#39; % <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_frac', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testMonteCarloGradients.angle_frac', title='?'>angle_frac</a>)
<span class='lineno'> 322</span> 
<span class='lineno'> 323</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking', title='AgentTest -> None'>testNumericalGradChecking</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.self', title='AgentTest'>self</a>):
<span class='lineno'> 324</span>     # Similar to
<span class='lineno'> 325</span>     # http://ufldl.stanford.edu/wiki/index.php/Gradient_checking_and_advanced_optimization.
<span class='lineno'> 326</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.epsilon', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.epsilon', title='float'>epsilon</a> = 1e-4
<span class='lineno'> 327</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.eos', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.eos', title='?'>eos</a> = misc.BF_EOS_INT
<span class='lineno'> 328</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.self', title='AgentTest'>self</a>.assertEqual(0, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.eos', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.eos', title='?'>eos</a>)
<span class='lineno'> 329</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.config', title='?'>config</a> = defaults.default_config_with_updates(
<span class='lineno'> 330</span>         &#39;env=c(task=&quot;print&quot;),&#39;
<span class='lineno'> 331</span>         &#39;agent=c(algorithm=&quot;pg&quot;,optimizer=&quot;sgd&quot;,lr=1.0,ema_baseline_decay=0.99,&#39;
<span class='lineno'> 332</span>         &#39;entropy_beta=0.0,topk_loss_hparam=0.0,policy_lstm_sizes=[10],&#39;
<span class='lineno'> 333</span>         &#39;eos_token=True),&#39;
<span class='lineno'> 334</span>         &#39;batch_size=64&#39;)
<span class='lineno'> 335</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.dtype', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.dtype', title='?'>dtype</a> = tf.float64
<span class='lineno'> 336</span>     tf.reset_default_graph()
<span class='lineno'> 337</span>     tf.set_random_seed(12345678987654321)
<span class='lineno'> 338</span>     np.random.seed(1294024302)
<span class='lineno'> 339</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.trainer', title='?'>trainer</a> = pg_train.AsyncTrainer(
<span class='lineno'> 340</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.config', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.config', title='?'>config</a>, task_id=0, ps_tasks=0, num_workers=1, dtype=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.dtype', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.dtype', title='?'>dtype</a>)
<span class='lineno'> 341</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.trainer', title='?'>trainer</a>.model
<span class='lineno'> 342</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_ph', title='?'>actions_ph</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.actions
<span class='lineno'> 343</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.lengths_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.lengths_ph', title='?'>lengths_ph</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.adjusted_lengths
<span class='lineno'> 344</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.multipliers_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.multipliers_ph', title='?'>multipliers_ph</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.policy_multipliers
<span class='lineno'> 345</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.loss', title='?'>loss</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.pi_loss
<span class='lineno'> 346</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.global_init_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.global_init_op', title='?'>global_init_op</a> = tf.variables_initializer(
<span class='lineno'> 347</span>         tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, &#39;global&#39;))
<span class='lineno'> 348</span> 
<span class='lineno'> 349</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', title='?'>assign_add_placeholders</a> = [None] * len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.trainable_variables)
<span class='lineno'> 350</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', title='?'>assign_add_ops</a> = [None] * len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.trainable_variables)
<span class='lineno'> 351</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', title='?'>param_shapes</a> = [None] * len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.trainable_variables)
<span class='lineno'> 352</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param', title='?'>param</a> in enumerate(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.trainable_variables):
<span class='lineno'> 353</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', title='?'>param_shapes</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param', title='?'>param</a>.get_shape().as_list()
<span class='lineno'> 354</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', title='?'>assign_add_placeholders</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>] = tf.placeholder(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.dtype', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.dtype', title='?'>dtype</a>,
<span class='lineno'> 355</span>                                                   np.prod(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', title='?'>param_shapes</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>]))
<span class='lineno'> 356</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', title='?'>assign_add_ops</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param', title='?'>param</a>.assign_add(
<span class='lineno'> 357</span>           tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', title='?'>assign_add_placeholders</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', title='?'>param_shapes</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>]))
<span class='lineno'> 358</span> 
<span class='lineno'> 359</span>     with tf.Session() as <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', title='?'>sess</a>:
<span class='lineno'> 360</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.global_init_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.global_init_op', title='?'>global_init_op</a>)  # Initialize global copy.
<span class='lineno'> 361</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.trainer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.trainer', title='?'>trainer</a>.initialize(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', title='?'>sess</a>)
<span class='lineno'> 362</span> 
<span class='lineno'> 363</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_raw', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_raw', title='[None]'>actions_raw</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.random_sequence', title='(int, int, int) -> None / (?, ?, int) -> None'>random_sequence</a>(10, 9) for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking._', title='int'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking._', title='int'>_</a></a> in xrange(16)]
<span class='lineno'> 364</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_batch', title='?'>actions_batch</a> = utils.stack_pad(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_raw', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_raw', title='[None]'>actions_raw</a>, 0)
<span class='lineno'> 365</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.lengths_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.lengths_batch', title='[int]'>lengths_batch</a> = [len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.l', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.l', title='None'>l</a>) for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.l', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.l', title='None'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.l', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.l', title='None'>l</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_raw', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_raw', title='[None]'>actions_raw</a>]
<span class='lineno'> 366</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.feed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.feed', title='dict'>feed</a> = {<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_ph', title='?'>actions_ph</a>: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_batch', title='?'>actions_batch</a>,
<span class='lineno'> 367</span>               <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.multipliers_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.multipliers_ph', title='?'>multipliers_ph</a>: np.ones_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.actions_batch', title='?'>actions_batch</a>),
<span class='lineno'> 368</span>               <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.lengths_ph', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.lengths_ph', title='?'>lengths_ph</a>: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.lengths_batch', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.lengths_batch', title='[int]'>lengths_batch</a>}
<span class='lineno'> 369</span> 
<span class='lineno'> 370</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', title='?'>estimated_grads</a> = [None] * len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.trainable_variables)
<span class='lineno'> 371</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param', title='?'>param</a> in enumerate(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.trainable_variables):
<span class='lineno'> 372</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_size', title='?'>param_size</a> = np.prod(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', title='?'>param_shapes</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>])
<span class='lineno'> 373</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', title='?'>estimated_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>] = np.zeros(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_size', title='?'>param_size</a>, dtype=np.float64)
<span class='lineno'> 374</span>         for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.index', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.index', title='int'>index</a> in xrange(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_size', title='?'>param_size</a>):
<span class='lineno'> 375</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.e', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.e', title='?'>e</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.onehot', title='(int, ?) -> None / (?, ?) -> None'>onehot</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.index', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.index', title='int'>index</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_size', title='?'>param_size</a>) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.epsilon', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.epsilon', title='float'>epsilon</a>
<span class='lineno'> 376</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', title='?'>assign_add_ops</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>],
<span class='lineno'> 377</span>                    {<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', title='?'>assign_add_placeholders</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>]: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.e', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.e', title='?'>e</a>})
<span class='lineno'> 378</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.j_plus', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.j_plus', title='?'>j_plus</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.loss', title='?'>loss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.feed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.feed', title='dict'>feed</a>)
<span class='lineno'> 379</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', title='?'>assign_add_ops</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>],
<span class='lineno'> 380</span>                    {<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', title='?'>assign_add_placeholders</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>]: -2 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.e', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.e', title='?'>e</a>})
<span class='lineno'> 381</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.j_minus', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.j_minus', title='?'>j_minus</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.loss', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.loss', title='?'>loss</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.feed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.feed', title='dict'>feed</a>)
<span class='lineno'> 382</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_ops', title='?'>assign_add_ops</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>],
<span class='lineno'> 383</span>                    {<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.assign_add_placeholders', title='?'>assign_add_placeholders</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>]: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.e', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.e', title='?'>e</a>})
<span class='lineno'> 384</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', title='?'>estimated_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>][<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.index', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.index', title='int'>index</a>] = (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.j_plus', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.j_plus', title='?'>j_plus</a> - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.j_minus', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.j_minus', title='?'>j_minus</a>) / (2 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.epsilon', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.epsilon', title='float'>epsilon</a>)
<span class='lineno'> 385</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', title='?'>estimated_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', title='?'>estimated_grads</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>].reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.param_shapes', title='?'>param_shapes</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.i', title='?'>i</a>])
<span class='lineno'> 386</span> 
<span class='lineno'> 387</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.analytic_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.analytic_grads', title='?'>analytic_grads</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.sess', title='?'>sess</a>.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.model', title='?'>model</a>.dense_unclipped_grads, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.feed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.feed', title='dict'>feed</a>)
<span class='lineno'> 388</span> 
<span class='lineno'> 389</span>       for g1, g2 in zip(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.estimated_grads', title='?'>estimated_grads</a>[1:], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.analytic_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.analytic_grads', title='?'>analytic_grads</a>[1:]):
<span class='lineno'> 390</span>         logging.info(&#39;norm (g1-g2): %s&#39;, np.abs(g1 - g2).mean())
<span class='lineno'> 391</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.brain_coder.single_task.pg_agent_test.AgentTest.testNumericalGradChecking.self', title='AgentTest'>self</a>.assertTrue(np.allclose(g1, g2))
<span class='lineno'> 392</span> 
<span class='lineno'> 393</span> 
<span class='lineno'> 394</span> if __name__ == &#39;__main__&#39;:
<span class='lineno'> 395</span>   tf.test.main()
</pre></td></tr></table></body></html>