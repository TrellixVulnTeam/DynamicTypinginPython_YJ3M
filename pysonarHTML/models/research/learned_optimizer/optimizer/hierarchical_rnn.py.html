<html>
<head>
<meta charset="utf-8">
<title>/home/xxm/Desktop/EMSE/dataset/models/research/learned_optimizer/optimizer/hierarchical_rnn.py</title>
<style type='text/css'>
body { color: #666666; }
a {
    text-decoration: none; color: #5AA2A7;
    border: solid 1px rgba(255,255,255,0);
}
a.active {
    background: -webkit-linear-gradient(top,rgba(255, 255, 200, 0.35) 0,rgba(255, 255, 200, 0.55) 100%);
    border: solid 1px #E5E600;
}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #cccccc;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px solid orange; padding-bottom: 1px}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted;

function highlight(xid)
{
    var elms = document.querySelectorAll('[xid="' + xid + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "active";
    }
    highlighted = xid;
}

function clearHighlight() {
    var elms = document.querySelectorAll('[xid="' + highlighted + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "";
    }
}

window.onload =
    function (e) {
        var tags = document.getElementsByTagName("A")
        for (var i = 0; i < tags.length; i++) {
            tags[i].onmouseover =
                function (e) {
                    clearHighlight();
                    var xid = e.toElement.getAttribute('xid');
                    highlight(xid);
                }
        }
    }</script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS'>FLAGS</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN'>HierarchicalRNN</a><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__'>__init__</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells'>_initialize_rnn_cells</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay'>_initialize_scale_decay</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay'>_initialize_input_decay</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr'>_initialize_lr</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state'>_initialize_state</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state'>_initialize_global_state</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates'>_compute_updates</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr'>_compute_mean_log_lr</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads'>_compute_scaled_and_ms_grads</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input'>_extend_rnn_input</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells'>_update_rnn_cells</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections'>_compute_rnn_state_projections</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate'>_compute_new_learning_rate</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state'>_compute_updated_global_state</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients', xid='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients'>apply_gradients</a></li></ul>
</li></ul>
</td><td><pre><span class='lineno'>   1</span> # Copyright 2017 Google, Inc. All Rights Reserved.
<span class='lineno'>   2</span> #
<span class='lineno'>   3</span> # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
<span class='lineno'>   4</span> # you may not use this file except in compliance with the License.
<span class='lineno'>   5</span> # You may obtain a copy of the License at
<span class='lineno'>   6</span> #
<span class='lineno'>   7</span> #     http://www.apache.org/licenses/LICENSE-2.0
<span class='lineno'>   8</span> #
<span class='lineno'>   9</span> # Unless required by applicable law or agreed to in writing, software
<span class='lineno'>  10</span> # distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
<span class='lineno'>  11</span> # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
<span class='lineno'>  12</span> # See the License for the specific language governing permissions and
<span class='lineno'>  13</span> # limitations under the License.
<span class='lineno'>  14</span> # ==============================================================================
<span class='lineno'>  15</span> 
<span class='lineno'>  16</span> &quot;&quot;&quot;Collection of trainable optimizers for meta-optimization.&quot;&quot;&quot;
<span class='lineno'>  17</span> 
<span class='lineno'>  18</span> from __future__ import absolute_import
<span class='lineno'>  19</span> from __future__ import division
<span class='lineno'>  20</span> from __future__ import print_function
<span class='lineno'>  21</span> 
<span class='lineno'>  22</span> import math
<span class='lineno'>  23</span> 
<span class='lineno'>  24</span> import numpy as np
<span class='lineno'>  25</span> import tensorflow as tf
<span class='lineno'>  26</span> 
<span class='lineno'>  27</span> from tensorflow.python.ops import state_ops
<span class='lineno'>  28</span> from learned_optimizer.optimizer import rnn_cells
<span class='lineno'>  29</span> from learned_optimizer.optimizer import trainable_optimizer as opt
<span class='lineno'>  30</span> from learned_optimizer.optimizer import utils
<span class='lineno'>  31</span> 
<span class='lineno'>  32</span> # Default was 0.1
<span class='lineno'>  33</span> tf.app.flags.DEFINE_float(&quot;biasgrucell_scale&quot;, 0.5,
<span class='lineno'>  34</span>                           &quot;&quot;&quot;The scale for the internal BiasGRUCell vars.&quot;&quot;&quot;)
<span class='lineno'>  35</span> # Default was 0
<span class='lineno'>  36</span> tf.app.flags.DEFINE_float(&quot;biasgrucell_gate_bias_init&quot;, 2.2,
<span class='lineno'>  37</span>                           &quot;&quot;&quot;The bias for the internal BiasGRUCell reset and
<span class='lineno'>  38</span>                              update gate variables.&quot;&quot;&quot;)
<span class='lineno'>  39</span> # Default was 1e-3
<span class='lineno'>  40</span> tf.app.flags.DEFINE_float(&quot;hrnn_rnn_readout_scale&quot;, 0.5,
<span class='lineno'>  41</span>                           &quot;&quot;&quot;The initialization scale for the RNN readouts.&quot;&quot;&quot;)
<span class='lineno'>  42</span> tf.app.flags.DEFINE_float(&quot;hrnn_default_decay_var_init&quot;, 2.2,
<span class='lineno'>  43</span>                           &quot;&quot;&quot;The default initializer value for any decay/
<span class='lineno'>  44</span>                              momentum style variables and constants.
<span class='lineno'>  45</span>                              sigmoid(2.2) ~ 0.9, sigmoid(-2.2) ~ 0.01.&quot;&quot;&quot;)
<span class='lineno'>  46</span> # Default was 2.2
<span class='lineno'>  47</span> tf.app.flags.DEFINE_float(&quot;scale_decay_bias_init&quot;, 3.2,
<span class='lineno'>  48</span>                           &quot;&quot;&quot;The initialization for the scale decay bias. This
<span class='lineno'>  49</span>                              is the initial bias for the timescale for the
<span class='lineno'>  50</span>                              exponential avg of the mean square gradients.&quot;&quot;&quot;)
<span class='lineno'>  51</span> tf.app.flags.DEFINE_float(&quot;learning_rate_momentum_logit_init&quot;, 3.2,
<span class='lineno'>  52</span>                           &quot;&quot;&quot;Initialization for the learning rate momentum.&quot;&quot;&quot;)
<span class='lineno'>  53</span> # Default was 0.1
<span class='lineno'>  54</span> tf.app.flags.DEFINE_float(&quot;hrnn_affine_scale&quot;, 0.5,
<span class='lineno'>  55</span>                           &quot;&quot;&quot;The initialization scale for the weight matrix of
<span class='lineno'>  56</span>                              the bias variables in layer0 and 1 of the hrnn.&quot;&quot;&quot;)
<span class='lineno'>  57</span> 
<span class='lineno'>  58</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a> = tf.flags.FLAGS
<span class='lineno'>  59</span> 
<span class='lineno'>  60</span> 
<span class='lineno'>  61</span> class <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN', title='<HierarchicalRNN>'>HierarchicalRNN</a>(opt.TrainableOptimizer):
<span class='lineno'>  62</span>   &quot;&quot;&quot;3 level hierarchical RNN.
<span class='lineno'>  63</span> 
<span class='lineno'>  64</span>   Optionally uses second order gradient information and has decoupled evaluation
<span class='lineno'>  65</span>   and update locations.
<span class='lineno'>  66</span>   &quot;&quot;&quot;
<span class='lineno'>  67</span> 
<span class='lineno'>  68</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__', title='? -> ?'>__init__</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', title='?'>level_sizes</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', title='(float, float)'>init_lr_range</a>=(1e-6, 1e-2),
<span class='lineno'>  69</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_decay', title='bool'>learnable_decay</a>=True, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.dynamic_output_scale', title='bool'>dynamic_output_scale</a>=True,
<span class='lineno'>  70</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_attention', title='bool'>use_attention</a>=False, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_objective', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_objective', title='bool'>use_log_objective</a>=True,
<span class='lineno'>  71</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.num_gradient_scales', title='int'>num_gradient_scales</a>=4, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.zero_init_lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.zero_init_lr_weights', title='bool'>zero_init_lr_weights</a>=True,
<span class='lineno'>  72</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_means_squared', title='bool'>use_log_means_squared</a>=True, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_relative_lr', title='bool'>use_relative_lr</a>=True,
<span class='lineno'>  73</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_extreme_indicator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_extreme_indicator', title='bool'>use_extreme_indicator</a>=False, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.max_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.max_log_lr', title='int'>max_log_lr</a>=33,
<span class='lineno'>  74</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.obj_train_max_multiplier', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.obj_train_max_multiplier', title='int'>obj_train_max_multiplier</a>=-1, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_problem_lr_mean', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_problem_lr_mean', title='bool'>use_problem_lr_mean</a>=False,
<span class='lineno'>  75</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_gradient_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_gradient_shortcut', title='bool'>use_gradient_shortcut</a>=False, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_lr_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_lr_shortcut', title='bool'>use_lr_shortcut</a>=False,
<span class='lineno'>  76</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_grad_products', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_grad_products', title='bool'>use_grad_products</a>=False, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_multiple_scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_multiple_scale_decays', title='bool'>use_multiple_scale_decays</a>=False,
<span class='lineno'>  77</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_inp_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_inp_decay', title='bool'>learnable_inp_decay</a>=True, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_rnn_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_rnn_init', title='bool'>learnable_rnn_init</a>=True,
<span class='lineno'>  78</span>                <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.random_seed', title='None'>random_seed</a>=None, **kwargs):
<span class='lineno'>  79</span>     &quot;&quot;&quot;Initializes the RNN per-parameter optimizer.
<span class='lineno'>  80</span> 
<span class='lineno'>  81</span>     The hierarchy consists of up to three levels:
<span class='lineno'>  82</span>     Level 0: per parameter RNN
<span class='lineno'>  83</span>     Level 1: per tensor RNN
<span class='lineno'>  84</span>     Level 2: global RNN
<span class='lineno'>  85</span> 
<span class='lineno'>  86</span>     Args:
<span class='lineno'>  87</span>       level_sizes: list or tuple with 1, 2, or 3 integers, the number of units
<span class='lineno'>  88</span>           in each RNN in the hierarchy (level0, level1, level2).
<span class='lineno'>  89</span>           length 1: only coordinatewise rnn&#39;s will be used
<span class='lineno'>  90</span>           length 2: coordinatewise and tensor-level rnn&#39;s will be used
<span class='lineno'>  91</span>           length 3: a single global-level rnn will be used in addition to
<span class='lineno'>  92</span>              coordinatewise and tensor-level
<span class='lineno'>  93</span>       init_lr_range: the range in which to initialize the learning rates
<span class='lineno'>  94</span>       learnable_decay: whether to learn weights that dynamically modulate the
<span class='lineno'>  95</span>           input scale via RMS style decay
<span class='lineno'>  96</span>       dynamic_output_scale: whether to learn weights that dynamically modulate
<span class='lineno'>  97</span>           the output scale
<span class='lineno'>  98</span>       use_attention: whether to use attention to train the optimizer
<span class='lineno'>  99</span>       use_log_objective: whether to train on the log of the objective
<span class='lineno'> 100</span>       num_gradient_scales: the number of scales to use for gradient history
<span class='lineno'> 101</span>       zero_init_lr_weights: whether to initialize the lr weights to zero
<span class='lineno'> 102</span>       use_log_means_squared: whether to track the log of the means_squared,
<span class='lineno'> 103</span>           used as a measure of signal vs. noise in gradient.
<span class='lineno'> 104</span>       use_relative_lr: whether to use the relative learning rate as an
<span class='lineno'> 105</span>           input during training (requires learnable_decay=True)
<span class='lineno'> 106</span>       use_extreme_indicator: whether to use the extreme indicator for learning
<span class='lineno'> 107</span>           rates as an input during training (requires learnable_decay=True)
<span class='lineno'> 108</span>       max_log_lr: the maximum log learning rate allowed during train or test
<span class='lineno'> 109</span>       obj_train_max_multiplier: max objective increase during a training run
<span class='lineno'> 110</span>       use_problem_lr_mean: whether to use the mean over all learning rates in
<span class='lineno'> 111</span>           the problem when calculating the relative learning rate as opposed to
<span class='lineno'> 112</span>           the per-tensor mean
<span class='lineno'> 113</span>       use_gradient_shortcut: Whether to add a learned affine projection of the
<span class='lineno'> 114</span>           gradient to the update delta in addition to the gradient function
<span class='lineno'> 115</span>           computed by the RNN
<span class='lineno'> 116</span>       use_lr_shortcut: Whether to add as input the difference between the log lr
<span class='lineno'> 117</span>           and the desired log lr (1e-3)
<span class='lineno'> 118</span>       use_grad_products: Whether to use gradient products in the rnn input.
<span class='lineno'> 119</span>           Only applicable if num_gradient_scales &gt; 1
<span class='lineno'> 120</span>       use_multiple_scale_decays: Whether to use multiple scales for the scale
<span class='lineno'> 121</span>           decay, as with input decay
<span class='lineno'> 122</span>       learnable_inp_decay: Whether to learn the input decay weights and bias.
<span class='lineno'> 123</span>       learnable_rnn_init: Whether to learn the RNN state initialization.
<span class='lineno'> 124</span>       random_seed: Random seed for random variable initializers. (Default: None)
<span class='lineno'> 125</span>       **kwargs: args passed to TrainableOptimizer&#39;s constructor
<span class='lineno'> 126</span> 
<span class='lineno'> 127</span>     Raises:
<span class='lineno'> 128</span>       ValueError: If level_sizes is not a length 1, 2, or 3 list.
<span class='lineno'> 129</span>       ValueError: If there are any non-integer sizes in level_sizes.
<span class='lineno'> 130</span>       ValueError: If the init lr range is not of length 2.
<span class='lineno'> 131</span>       ValueError: If the init lr range is not a valid range (min &gt; max).
<span class='lineno'> 132</span>     &quot;&quot;&quot;
<span class='lineno'> 133</span>     if len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', title='?'>level_sizes</a>) not in [1, 2, 3]:
<span class='lineno'> 134</span>       raise ValueError(&quot;HierarchicalRNN only supports 1, 2, or 3 levels in the &quot;
<span class='lineno'> 135</span>                        &quot;hierarchy, but {} were requested.&quot;.format(
<span class='lineno'> 136</span>                            len(level_sizes)))
<span class='lineno'> 137</span>     if any(not isinstance(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level', title='?'>level</a>, int) for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level', title='?'>level</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', title='?'>level_sizes</a>):
<span class='lineno'> 138</span>       raise ValueError(&quot;Level sizes must be integer values, were {}&quot;.format(
<span class='lineno'> 139</span>           level_sizes))
<span class='lineno'> 140</span>     if len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', title='(float, float)'>init_lr_range</a>) != 2:
<span class='lineno'> 141</span>       raise ValueError(
<span class='lineno'> 142</span>           &quot;Initial LR range must be len 2, was {}&quot;.format(len(init_lr_range)))
<span class='lineno'> 143</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', title='(float, float)'>init_lr_range</a>[0] &gt; <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', title='(float, float)'>init_lr_range</a>[1]:
<span class='lineno'> 144</span>       raise ValueError(&quot;Initial LR range min is greater than max.&quot;)
<span class='lineno'> 145</span> 
<span class='lineno'> 146</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_decay', title='bool'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_decay', title='bool'>learnable_decay</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_decay', title='bool'>learnable_decay</a>
<span class='lineno'> 147</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'>dynamic_output_scale</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.dynamic_output_scale', title='bool'>dynamic_output_scale</a>
<span class='lineno'> 148</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', title='bool'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', title='bool'>use_attention</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_attention', title='bool'>use_attention</a>
<span class='lineno'> 149</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_objective', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_objective', title='bool'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_objective', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_objective', title='bool'>use_log_objective</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_objective', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_objective', title='bool'>use_log_objective</a>
<span class='lineno'> 150</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.num_gradient_scales', title='int'>num_gradient_scales</a>
<span class='lineno'> 151</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.zero_init_lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.zero_init_lr_weights', title='bool'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.zero_init_lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.zero_init_lr_weights', title='bool'>zero_init_lr_weights</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.zero_init_lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.zero_init_lr_weights', title='bool'>zero_init_lr_weights</a>
<span class='lineno'> 152</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_means_squared', title='bool'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_means_squared', title='bool'>use_log_means_squared</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_means_squared', title='bool'>use_log_means_squared</a>
<span class='lineno'> 153</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', title='bool'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', title='bool'>use_relative_lr</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_relative_lr', title='bool'>use_relative_lr</a>
<span class='lineno'> 154</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_extreme_indicator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_extreme_indicator', title='bool'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_extreme_indicator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_extreme_indicator', title='bool'>use_extreme_indicator</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_extreme_indicator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_extreme_indicator', title='bool'>use_extreme_indicator</a>
<span class='lineno'> 155</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.max_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.max_log_lr', title='int'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.max_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.max_log_lr', title='int'>max_log_lr</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.max_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.max_log_lr', title='int'>max_log_lr</a>
<span class='lineno'> 156</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_problem_lr_mean', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_problem_lr_mean', title='bool'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_problem_lr_mean', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_problem_lr_mean', title='bool'>use_problem_lr_mean</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_problem_lr_mean', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_problem_lr_mean', title='bool'>use_problem_lr_mean</a>
<span class='lineno'> 157</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_gradient_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_gradient_shortcut', title='bool'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_gradient_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_gradient_shortcut', title='bool'>use_gradient_shortcut</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_gradient_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_gradient_shortcut', title='bool'>use_gradient_shortcut</a>
<span class='lineno'> 158</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_lr_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_lr_shortcut', title='bool'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_lr_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_lr_shortcut', title='bool'>use_lr_shortcut</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_lr_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_lr_shortcut', title='bool'>use_lr_shortcut</a>
<span class='lineno'> 159</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_grad_products', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_grad_products', title='bool'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_grad_products', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_grad_products', title='bool'>use_grad_products</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_grad_products', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_grad_products', title='bool'>use_grad_products</a>
<span class='lineno'> 160</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_multiple_scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_multiple_scale_decays', title='bool'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_multiple_scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_multiple_scale_decays', title='bool'>use_multiple_scale_decays</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_multiple_scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_multiple_scale_decays', title='bool'>use_multiple_scale_decays</a>
<span class='lineno'> 161</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_inp_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_inp_decay', title='bool'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_inp_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_inp_decay', title='bool'>learnable_inp_decay</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_inp_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_inp_decay', title='bool'>learnable_inp_decay</a>
<span class='lineno'> 162</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_rnn_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_rnn_init', title='bool'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_rnn_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_rnn_init', title='bool'>learnable_rnn_init</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_rnn_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.learnable_rnn_init', title='bool'>learnable_rnn_init</a>
<span class='lineno'> 163</span> 
<span class='lineno'> 164</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.random_seed', title='None'>random_seed</a>
<span class='lineno'> 165</span> 
<span class='lineno'> 166</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'>num_layers</a></a> = len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', title='?'>level_sizes</a>)
<span class='lineno'> 167</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_lr_range', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_lr_range', title='(float, float)'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_lr_range', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_lr_range', title='(float, float)'>init_lr_range</a></a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.init_lr_range', title='(float, float)'>init_lr_range</a>
<span class='lineno'> 168</span> 
<span class='lineno'> 169</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_vars', title='bool'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_vars', title='bool'>reuse_vars</a></a> = None
<span class='lineno'> 170</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', title='bool'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', title='bool'>reuse_global_state</a></a> = None
<span class='lineno'> 171</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', title='[?]'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', title='[?]'>cells</a></a> = []
<span class='lineno'> 172</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', title='[?]'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', title='[?]'>init_vectors</a></a> = []
<span class='lineno'> 173</span> 
<span class='lineno'> 174</span>     with tf.variable_scope(opt.OPTIMIZER_SCOPE):
<span class='lineno'> 175</span> 
<span class='lineno'> 176</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells', title='(HierarchicalRNN, ?) -> None'>_initialize_rnn_cells</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', title='?'>level_sizes</a>)
<span class='lineno'> 177</span> 
<span class='lineno'> 178</span>       # get the cell size for the per-parameter RNN (Level 0)
<span class='lineno'> 179</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', title='?'>cell_size</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.level_sizes', title='?'>level_sizes</a>[0]
<span class='lineno'> 180</span> 
<span class='lineno'> 181</span>       # Random normal initialization scaled by the output size. This is the
<span class='lineno'> 182</span>       # scale for the RNN *readouts*. RNN internal weight scale is set in the
<span class='lineno'> 183</span>       # BiasGRUCell call.
<span class='lineno'> 184</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scale_factor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scale_factor', title='int'>scale_factor</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a>.hrnn_rnn_readout_scale / math.sqrt(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', title='?'>cell_size</a>)
<span class='lineno'> 185</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', title='?'>scaled_init</a> = tf.random_normal_initializer(0., <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scale_factor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scale_factor', title='int'>scale_factor</a>,
<span class='lineno'> 186</span>                                                  seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>)
<span class='lineno'> 187</span> 
<span class='lineno'> 188</span>       # weights for projecting the hidden state to a parameter update
<span class='lineno'> 189</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', title='?'>update_weights</a></a> = tf.get_variable(&quot;update_weights&quot;,
<span class='lineno'> 190</span>                                             shape=(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', title='?'>cell_size</a>, 1),
<span class='lineno'> 191</span>                                             initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', title='?'>scaled_init</a>)
<span class='lineno'> 192</span> 
<span class='lineno'> 193</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', title='bool'>use_attention</a>:
<span class='lineno'> 194</span>         # weights for projecting the hidden state to the location at which the
<span class='lineno'> 195</span>         # gradient is attended
<span class='lineno'> 196</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.attention_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.attention_weights', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.attention_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.attention_weights', title='?'>attention_weights</a></a> = tf.get_variable(
<span class='lineno'> 197</span>             &quot;attention_weights&quot;,
<span class='lineno'> 198</span>             initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', title='?'>update_weights</a>.initialized_value())
<span class='lineno'> 199</span> 
<span class='lineno'> 200</span>       # weights for projecting the hidden state to the RMS decay term
<span class='lineno'> 201</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay', title='(HierarchicalRNN, ?, ?) -> None / (HierarchicalRNN, (?, int), ?) -> None'>_initialize_scale_decay</a>((<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', title='?'>cell_size</a>, 1), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', title='?'>scaled_init</a>)
<span class='lineno'> 202</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay', title='(HierarchicalRNN, ?, ?) -> None / (HierarchicalRNN, (?, int), ?) -> None'>_initialize_input_decay</a>((<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', title='?'>cell_size</a>, 1), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', title='?'>scaled_init</a>)
<span class='lineno'> 203</span> 
<span class='lineno'> 204</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr', title='(HierarchicalRNN, ?, ?) -> None / (HierarchicalRNN, (?, int), ?) -> None'>_initialize_lr</a>((<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.cell_size', title='?'>cell_size</a>, 1), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.scaled_init', title='?'>scaled_init</a>)
<span class='lineno'> 205</span> 
<span class='lineno'> 206</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', title='[str]'>state_keys</a> = [&quot;parameter&quot;, &quot;layer&quot;, &quot;scl_decay&quot;, &quot;inp_decay&quot;, &quot;true_param&quot;]
<span class='lineno'> 207</span> 
<span class='lineno'> 208</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'>dynamic_output_scale</a>:
<span class='lineno'> 209</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', title='[str]'>state_keys</a>.append(&quot;log_learning_rate&quot;)
<span class='lineno'> 210</span> 
<span class='lineno'> 211</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.i', title='int'>i</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a>):
<span class='lineno'> 212</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', title='[str]'>state_keys</a>.append(&quot;grad_accum{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.i', title='int'>i</a> + 1))
<span class='lineno'> 213</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', title='[str]'>state_keys</a>.append(&quot;ms{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.i', title='int'>i</a> + 1))
<span class='lineno'> 214</span> 
<span class='lineno'> 215</span>     super(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN', title='<HierarchicalRNN>'>HierarchicalRNN</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.self', title='HierarchicalRNN'>self</a>).__init__(
<span class='lineno'> 216</span>         &quot;hRNN&quot;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.state_keys', title='[str]'>state_keys</a>, use_attention=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_attention', title='bool'>use_attention</a>,
<span class='lineno'> 217</span>         use_log_objective=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_objective', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.use_log_objective', title='bool'>use_log_objective</a>,
<span class='lineno'> 218</span>         obj_train_max_multiplier=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.obj_train_max_multiplier', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.__init__.obj_train_max_multiplier', title='int'>obj_train_max_multiplier</a>, **kwargs)
<span class='lineno'> 219</span> 
<span class='lineno'> 220</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells', title='(HierarchicalRNN, ?) -> None'>_initialize_rnn_cells</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level_sizes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level_sizes', title='?'>level_sizes</a>):
<span class='lineno'> 221</span>     &quot;&quot;&quot;Initializes the RNN cells to use in the hierarchical RNN.&quot;&quot;&quot;
<span class='lineno'> 222</span> 
<span class='lineno'> 223</span>     # RNN Cell layers (0 -&gt; lowest, 1 -&gt; middle, 2 -&gt; global)
<span class='lineno'> 224</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level', title='int'>level</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'>num_layers</a>):
<span class='lineno'> 225</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.scope', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.scope', title='str'>scope</a> = &quot;Level{}_RNN&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level', title='int'>level</a>)
<span class='lineno'> 226</span>       with tf.variable_scope(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.scope', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.scope', title='str'>scope</a>):
<span class='lineno'> 227</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.hcell', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.hcell', title='?'>hcell</a> = rnn_cells.BiasGRUCell(
<span class='lineno'> 228</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level_sizes', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level_sizes', title='?'>level_sizes</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.level', title='int'>level</a>],
<span class='lineno'> 229</span>             scale=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a>.biasgrucell_scale,
<span class='lineno'> 230</span>             gate_bias_init=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a>.biasgrucell_gate_bias_init,
<span class='lineno'> 231</span>             random_seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>)
<span class='lineno'> 232</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', title='[?]'>cells</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.hcell', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.hcell', title='?'>hcell</a>)
<span class='lineno'> 233</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_rnn_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_rnn_init', title='bool'>learnable_rnn_init</a>:
<span class='lineno'> 234</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', title='[?]'>init_vectors</a>.append(tf.Variable(
<span class='lineno'> 235</span>               tf.random_uniform([1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.hcell', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.hcell', title='?'>hcell</a>.state_size], -1., 1.,
<span class='lineno'> 236</span>                                 seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>),
<span class='lineno'> 237</span>               name=&quot;init_vector&quot;))
<span class='lineno'> 238</span>         else:
<span class='lineno'> 239</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', title='[?]'>init_vectors</a>.append(
<span class='lineno'> 240</span>               tf.random_uniform([1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.hcell', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.hcell', title='?'>hcell</a>.state_size], -1., 1.,
<span class='lineno'> 241</span>                                 seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>))
<span class='lineno'> 242</span> 
<span class='lineno'> 243</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay', title='(HierarchicalRNN, ?, ?) -> None / (HierarchicalRNN, (?, int), ?) -> None'>_initialize_scale_decay</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.weights_tensor_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.weights_tensor_shape', title='(?, int)'>weights_tensor_shape</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.scaled_init', title='?'>scaled_init</a>):
<span class='lineno'> 244</span>     &quot;&quot;&quot;Initializes the scale decay weights and bias variables or tensors.
<span class='lineno'> 245</span> 
<span class='lineno'> 246</span>     Args:
<span class='lineno'> 247</span>       weights_tensor_shape: The shape the weight tensor should take.
<span class='lineno'> 248</span>       scaled_init: The scaled initialization for the weights tensor.
<span class='lineno'> 249</span>     &quot;&quot;&quot;
<span class='lineno'> 250</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_decay', title='bool'>learnable_decay</a>:
<span class='lineno'> 251</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_weights', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_weights', title='?'>scl_decay_weights</a></a> = tf.get_variable(&quot;scl_decay_weights&quot;,
<span class='lineno'> 252</span>                                                shape=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.weights_tensor_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.weights_tensor_shape', title='(?, int)'>weights_tensor_shape</a>,
<span class='lineno'> 253</span>                                                initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.scaled_init', title='?'>scaled_init</a>)
<span class='lineno'> 254</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.scl_decay_bias_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.scl_decay_bias_init', title='?'>scl_decay_bias_init</a> = tf.constant_initializer(
<span class='lineno'> 255</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a>.scale_decay_bias_init)
<span class='lineno'> 256</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_bias', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_bias', title='?'>scl_decay_bias</a></a> = tf.get_variable(&quot;scl_decay_bias&quot;,
<span class='lineno'> 257</span>                                             shape=(1,),
<span class='lineno'> 258</span>                                             initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.scl_decay_bias_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.scl_decay_bias_init', title='?'>scl_decay_bias_init</a>)
<span class='lineno'> 259</span>     else:
<span class='lineno'> 260</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_weights', title='?'>scl_decay_weights</a> = tf.zeros_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', title='?'>update_weights</a>)
<span class='lineno'> 261</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_scale_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_bias', title='?'>scl_decay_bias</a> = tf.log(0.93 / (1. - 0.93))
<span class='lineno'> 262</span> 
<span class='lineno'> 263</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay', title='(HierarchicalRNN, ?, ?) -> None / (HierarchicalRNN, (?, int), ?) -> None'>_initialize_input_decay</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.weights_tensor_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.weights_tensor_shape', title='(?, int)'>weights_tensor_shape</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.scaled_init', title='?'>scaled_init</a>):
<span class='lineno'> 264</span>     &quot;&quot;&quot;Initializes the input scale decay weights and bias variables or tensors.
<span class='lineno'> 265</span> 
<span class='lineno'> 266</span>     Args:
<span class='lineno'> 267</span>       weights_tensor_shape: The shape the weight tensor should take.
<span class='lineno'> 268</span>       scaled_init: The scaled initialization for the weights tensor.
<span class='lineno'> 269</span>     &quot;&quot;&quot;
<span class='lineno'> 270</span>     if (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_decay', title='bool'>learnable_decay</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a> &gt; 1 and
<span class='lineno'> 271</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_inp_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.learnable_inp_decay', title='bool'>learnable_inp_decay</a>):
<span class='lineno'> 272</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', title='HierarchicalRNN'>self</a>.<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_weights', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_weights', title='?'>inp_decay_weights</a></a> = tf.get_variable(&quot;inp_decay_weights&quot;,
<span class='lineno'> 273</span>                                                shape=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.weights_tensor_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.weights_tensor_shape', title='(?, int)'>weights_tensor_shape</a>,
<span class='lineno'> 274</span>                                                initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.scaled_init', title='?'>scaled_init</a>)
<span class='lineno'> 275</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.inp_decay_bias_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.inp_decay_bias_init', title='?'>inp_decay_bias_init</a> = tf.constant_initializer(
<span class='lineno'> 276</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a>.hrnn_default_decay_var_init)
<span class='lineno'> 277</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_bias', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_bias', title='?'>inp_decay_bias</a></a> = tf.get_variable(&quot;inp_decay_bias&quot;,
<span class='lineno'> 278</span>                                             shape=(1,),
<span class='lineno'> 279</span>                                             initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.inp_decay_bias_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.inp_decay_bias_init', title='?'>inp_decay_bias_init</a>)
<span class='lineno'> 280</span>     else:
<span class='lineno'> 281</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_weights', title='?'>inp_decay_weights</a> = tf.zeros_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', title='?'>update_weights</a>)
<span class='lineno'> 282</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_input_decay.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_bias', title='?'>inp_decay_bias</a> = tf.log(0.89 / (1. - 0.89))
<span class='lineno'> 283</span> 
<span class='lineno'> 284</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr', title='(HierarchicalRNN, ?, ?) -> None / (HierarchicalRNN, (?, int), ?) -> None'>_initialize_lr</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.weights_tensor_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.weights_tensor_shape', title='(?, int)'>weights_tensor_shape</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.scaled_init', title='?'>scaled_init</a>):
<span class='lineno'> 285</span>     &quot;&quot;&quot;Initializes the learning rate weights and bias variables or tensors.
<span class='lineno'> 286</span> 
<span class='lineno'> 287</span>     Args:
<span class='lineno'> 288</span>       weights_tensor_shape: The shape the weight tensor should take.
<span class='lineno'> 289</span>       scaled_init: The scaled initialization for the weights tensor.
<span class='lineno'> 290</span>     &quot;&quot;&quot;
<span class='lineno'> 291</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'>dynamic_output_scale</a>:
<span class='lineno'> 292</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.zero_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.zero_init', title='?'>zero_init</a> = tf.constant_initializer(0.)
<span class='lineno'> 293</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.wt_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.wt_init', title='?'>wt_init</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.zero_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.zero_init', title='?'>zero_init</a> if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.zero_init_lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.zero_init_lr_weights', title='bool'>zero_init_lr_weights</a> else <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.scaled_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.scaled_init', title='?'>scaled_init</a>
<span class='lineno'> 294</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', title='?'>lr_weights</a></a> = tf.get_variable(&quot;learning_rate_weights&quot;,
<span class='lineno'> 295</span>                                         shape=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.weights_tensor_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.weights_tensor_shape', title='(?, int)'>weights_tensor_shape</a>,
<span class='lineno'> 296</span>                                         initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.wt_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.wt_init', title='?'>wt_init</a>)
<span class='lineno'> 297</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', title='?'>lr_bias</a></a> = tf.get_variable(&quot;learning_rate_bias&quot;, shape=(1,),
<span class='lineno'> 298</span>                                      initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.zero_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.zero_init', title='?'>zero_init</a>)
<span class='lineno'> 299</span>     else:
<span class='lineno'> 300</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', title='?'>lr_weights</a> = tf.zeros_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', title='?'>update_weights</a>)
<span class='lineno'> 301</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_lr.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', title='?'>lr_bias</a> = tf.zeros([1, 1])
<span class='lineno'> 302</span> 
<span class='lineno'> 303</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state', title='(HierarchicalRNN, ?) -> dict'>_initialize_state</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var', title='?'>var</a>):
<span class='lineno'> 304</span>     &quot;&quot;&quot;Return a dictionary mapping names of state variables to their values.&quot;&quot;&quot;
<span class='lineno'> 305</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', title='?'>var_vectorized</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var', title='?'>var</a>, [-1, 1])
<span class='lineno'> 306</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.ndim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.ndim', title='?'>ndim</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', title='?'>var_vectorized</a>.get_shape().as_list()[0]
<span class='lineno'> 307</span> 
<span class='lineno'> 308</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', title='dict'>state</a> = {
<span class='lineno'> 309</span>         # parameter init tensor is [var_ndim x layer0_cell_size]
<span class='lineno'> 310</span>         &quot;parameter&quot;: tf.ones([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.ndim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.ndim', title='?'>ndim</a>, 1]) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', title='[?]'>init_vectors</a>[0],
<span class='lineno'> 311</span>         &quot;scl_decay&quot;: tf.zeros_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', title='?'>var_vectorized</a>),
<span class='lineno'> 312</span>         &quot;inp_decay&quot;: tf.zeros_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', title='?'>var_vectorized</a>),
<span class='lineno'> 313</span>         &quot;true_param&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var', title='?'>var</a>,
<span class='lineno'> 314</span>     }
<span class='lineno'> 315</span> 
<span class='lineno'> 316</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'>num_layers</a> &gt; 1:
<span class='lineno'> 317</span>       # layer init tensor is [1 x layer1_cell_size]
<span class='lineno'> 318</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', title='dict'>state</a>[&quot;layer&quot;] = tf.ones([1, 1]) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', title='[?]'>init_vectors</a>[1]
<span class='lineno'> 319</span> 
<span class='lineno'> 320</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'>dynamic_output_scale</a>:
<span class='lineno'> 321</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', title='float'>min_lr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_lr_range', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_lr_range', title='(float, float)'>init_lr_range</a>[0]
<span class='lineno'> 322</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.max_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.max_lr', title='float'>max_lr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_lr_range', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_lr_range', title='(float, float)'>init_lr_range</a>[1]
<span class='lineno'> 323</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', title='float'>min_lr</a> == <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.max_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.max_lr', title='float'>max_lr</a>:
<span class='lineno'> 324</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.log_init_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.log_init_lr', title='?'>log_init_lr</a> = tf.log(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', title='float'>min_lr</a> * tf.ones_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', title='?'>var_vectorized</a>))
<span class='lineno'> 325</span>       else:
<span class='lineno'> 326</span>         # Use a random offset to increase the likelihood that the average of the
<span class='lineno'> 327</span>         # LRs for this variable is different from the LRs for other variables.
<span class='lineno'> 328</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.actual_vals', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.actual_vals', title='?'>actual_vals</a> = tf.random_uniform(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', title='?'>var_vectorized</a>.get_shape().as_list(),
<span class='lineno'> 329</span>                                         np.log(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', title='float'>min_lr</a>) / 2.,
<span class='lineno'> 330</span>                                         np.log(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.max_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.max_lr', title='float'>max_lr</a>) / 2.,
<span class='lineno'> 331</span>                                         seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>)
<span class='lineno'> 332</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.offset', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.offset', title='?'>offset</a> = tf.random_uniform((), np.log(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.min_lr', title='float'>min_lr</a>) / 2., np.log(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.max_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.max_lr', title='float'>max_lr</a>) / 2.,
<span class='lineno'> 333</span>                                    seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>)
<span class='lineno'> 334</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.log_init_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.log_init_lr', title='?'>log_init_lr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.actual_vals', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.actual_vals', title='?'>actual_vals</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.offset', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.offset', title='?'>offset</a>
<span class='lineno'> 335</span>       # Clip the log learning rate to the flag at the top end, and to
<span class='lineno'> 336</span>       # (log(min int32) - 1) at the bottom
<span class='lineno'> 337</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.clipped', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.clipped', title='?'>clipped</a> = tf.clip_by_value(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.log_init_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.log_init_lr', title='?'>log_init_lr</a>, -33, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.max_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.max_log_lr', title='int'>max_log_lr</a>)
<span class='lineno'> 338</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', title='dict'>state</a>[&quot;log_learning_rate&quot;] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.clipped', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.clipped', title='?'>clipped</a>
<span class='lineno'> 339</span> 
<span class='lineno'> 340</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.i', title='int'>i</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a>):
<span class='lineno'> 341</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', title='dict'>state</a>[&quot;grad_accum{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.i', title='int'>i</a> + 1)] = tf.zeros_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', title='?'>var_vectorized</a>)
<span class='lineno'> 342</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', title='dict'>state</a>[&quot;ms{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.i', title='int'>i</a> + 1)] = tf.zeros_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.var_vectorized', title='?'>var_vectorized</a>)
<span class='lineno'> 343</span> 
<span class='lineno'> 344</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_state.state', title='dict'>state</a>
<span class='lineno'> 345</span> 
<span class='lineno'> 346</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state', title='HierarchicalRNN -> [?]'>_initialize_global_state</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.self', title='HierarchicalRNN'>self</a>):
<span class='lineno'> 347</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'>num_layers</a> &lt; 3:
<span class='lineno'> 348</span>       return []
<span class='lineno'> 349</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.rnn_global_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.rnn_global_init', title='?'>rnn_global_init</a> = tf.ones([1, 1]) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.init_vectors', title='[?]'>init_vectors</a>[2]
<span class='lineno'> 350</span>     return [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.rnn_global_init', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state.rnn_global_init', title='?'>rnn_global_init</a>]
<span class='lineno'> 351</span> 
<span class='lineno'> 352</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates', title='(HierarchicalRNN, ?, ?, ?, ?) -> ([?], [dict], [[?]], [?]) / (HierarchicalRNN, ?, ?, [dict], [?]) -> ([?], [dict], [[?]], [?])'>_compute_updates</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.params', title='?'>params</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads', title='?'>grads</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.states', title='[dict]'>states</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.global_state', title='[?]'>global_state</a>):
<span class='lineno'> 353</span>     # Store the updated parameters and states.
<span class='lineno'> 354</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_params', title='[?]'>updated_params</a> = []
<span class='lineno'> 355</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_attention', title='[?]'>updated_attention</a> = []
<span class='lineno'> 356</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_states', title='[dict]'>updated_states</a> = []
<span class='lineno'> 357</span> 
<span class='lineno'> 358</span>     with tf.variable_scope(opt.OPTIMIZER_SCOPE):
<span class='lineno'> 359</span> 
<span class='lineno'> 360</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_log_lr', title='float'>mean_log_lr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr', title='(HierarchicalRNN, [dict]) -> float / (HierarchicalRNN, ?) -> float'>_compute_mean_log_lr</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.states', title='[dict]'>states</a>)
<span class='lineno'> 361</span> 
<span class='lineno'> 362</span>       # Iterate over the layers.
<span class='lineno'> 363</span>       for param, grad_unflat, state in zip(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.params', title='?'>params</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads', title='?'>grads</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.states', title='[dict]'>states</a>):
<span class='lineno'> 364</span> 
<span class='lineno'> 365</span>         with tf.variable_scope(&quot;PerTensor&quot;, reuse=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_vars', title='bool'>reuse_vars</a>):
<span class='lineno'> 366</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_vars', title='bool'>reuse_vars</a> = True
<span class='lineno'> 367</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grad', title='?'>grad</a> = tf.reshape(grad_unflat, [-1, 1])
<span class='lineno'> 368</span> 
<span class='lineno'> 369</span>           # Create the RNN input. We will optionally extend it with additional
<span class='lineno'> 370</span>           # features such as curvature and gradient signal vs. noise.
<span class='lineno'> 371</span>           (<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', title='[?]'>grads_scaled</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_squared_gradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_squared_gradients', title='[?]'>mean_squared_gradients</a>,
<span class='lineno'> 372</span>            <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_accum', title='[float]'>grads_accum</a>) = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads', title='(HierarchicalRNN, ?, ?) -> ([?], [?], [float])'>_compute_scaled_and_ms_grads</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grad', title='?'>grad</a>, state)
<span class='lineno'> 373</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input', title='[float]'>rnn_input</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.g', title='?'>g</a> for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.g', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.g', title='?'>g</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', title='[?]'>grads_scaled</a>]
<span class='lineno'> 374</span> 
<span class='lineno'> 375</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input', title='(HierarchicalRNN, ?, ?, ?, ?, ?) -> None / (HierarchicalRNN, [float], ?, [?], [?], float) -> None'>_extend_rnn_input</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input', title='[float]'>rnn_input</a>, state, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', title='[?]'>grads_scaled</a>,
<span class='lineno'> 376</span>                                  <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_squared_gradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_squared_gradients', title='[?]'>mean_squared_gradients</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_log_lr', title='float'>mean_log_lr</a>)
<span class='lineno'> 377</span> 
<span class='lineno'> 378</span>           # Concatenate any features we&#39;ve collected.
<span class='lineno'> 379</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input_tensor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input_tensor', title='?'>rnn_input_tensor</a> = tf.concat(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input', title='[float]'>rnn_input</a>, 1)
<span class='lineno'> 380</span> 
<span class='lineno'> 381</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.layer_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.layer_state', title='None'>layer_state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_param_state', title='?'>new_param_state</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells', title='(HierarchicalRNN, ?, ?, ?, ?) -> (None, ?) / (HierarchicalRNN, ?, [?], ?, bool) -> (None, ?) / (HierarchicalRNN, ?, ?, ?, bool) -> (None, ?)'>_update_rnn_cells</a>(
<span class='lineno'> 382</span>               state, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.global_state', title='[?]'>global_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input_tensor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input_tensor', title='?'>rnn_input_tensor</a>,
<span class='lineno'> 383</span>               len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.rnn_input', title='[float]'>rnn_input</a>) != len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', title='[?]'>grads_scaled</a>))
<span class='lineno'> 384</span> 
<span class='lineno'> 385</span>           (<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.scl_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.scl_decay', title='?'>scl_decay</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.inp_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.inp_decay', title='?'>inp_decay</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_log_lr', title='float'>new_log_lr</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.update_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.update_step', title='?'>update_step</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.lr_attend', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.lr_attend', title='float'>lr_attend</a>,
<span class='lineno'> 386</span>            <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.attention_delta', title='None'>attention_delta</a>) = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections', title='(HierarchicalRNN, ?, ?, ?) -> (?, ?, float, ?, float, None) / (HierarchicalRNN, ?, ?, [?]) -> (?, ?, float, ?, float, None)'>_compute_rnn_state_projections</a>(
<span class='lineno'> 387</span>                state, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_param_state', title='?'>new_param_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_scaled', title='[?]'>grads_scaled</a>)
<span class='lineno'> 388</span> 
<span class='lineno'> 389</span>           # Apply updates and store state variables.
<span class='lineno'> 390</span>           if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', title='bool'>use_attention</a>:
<span class='lineno'> 391</span>             <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.truth', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.truth', title='?'>truth</a> = state[&quot;true_param&quot;]
<span class='lineno'> 392</span>             <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', title='?'>updated_param</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.truth', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.truth', title='?'>truth</a> - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.update_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.update_step', title='?'>update_step</a>
<span class='lineno'> 393</span>             <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.attention_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.attention_step', title='?'>attention_step</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.lr_attend', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.lr_attend', title='float'>lr_attend</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.attention_delta', title='None'>attention_delta</a>,
<span class='lineno'> 394</span>                                         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.truth', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.truth', title='?'>truth</a>.get_shape())
<span class='lineno'> 395</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_attention', title='[?]'>updated_attention</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.truth', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.truth', title='?'>truth</a> - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.attention_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.attention_step', title='?'>attention_step</a>)
<span class='lineno'> 396</span>           else:
<span class='lineno'> 397</span>             <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', title='?'>updated_param</a> = param - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.update_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.update_step', title='?'>update_step</a>
<span class='lineno'> 398</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_attention', title='[?]'>updated_attention</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', title='?'>updated_param</a>)
<span class='lineno'> 399</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_params', title='[?]'>updated_params</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', title='?'>updated_param</a>)
<span class='lineno'> 400</span> 
<span class='lineno'> 401</span>           # Collect the new state.
<span class='lineno'> 402</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', title='dict'>new_state</a> = {
<span class='lineno'> 403</span>               &quot;parameter&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_param_state', title='?'>new_param_state</a>,
<span class='lineno'> 404</span>               &quot;scl_decay&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.scl_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.scl_decay', title='?'>scl_decay</a>,
<span class='lineno'> 405</span>               &quot;inp_decay&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.inp_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.inp_decay', title='?'>inp_decay</a>,
<span class='lineno'> 406</span>               &quot;true_param&quot;: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_param', title='?'>updated_param</a>,
<span class='lineno'> 407</span>           }
<span class='lineno'> 408</span>           if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.layer_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.layer_state', title='None'>layer_state</a> is not None:
<span class='lineno'> 409</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', title='dict'>new_state</a>[&quot;layer&quot;] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.layer_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.layer_state', title='None'>layer_state</a>
<span class='lineno'> 410</span> 
<span class='lineno'> 411</span>           if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'>dynamic_output_scale</a>:
<span class='lineno'> 412</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', title='dict'>new_state</a>[&quot;log_learning_rate&quot;] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_log_lr', title='float'>new_log_lr</a>
<span class='lineno'> 413</span> 
<span class='lineno'> 414</span>           for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', title='int'>i</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a>):
<span class='lineno'> 415</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', title='dict'>new_state</a>[&quot;grad_accum{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', title='int'>i</a> + 1)] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.grads_accum', title='[float]'>grads_accum</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', title='int'>i</a>]
<span class='lineno'> 416</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', title='dict'>new_state</a>[&quot;ms{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', title='int'>i</a> + 1)] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_squared_gradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.mean_squared_gradients', title='[?]'>mean_squared_gradients</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.i', title='int'>i</a>]
<span class='lineno'> 417</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_states', title='[dict]'>updated_states</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.new_state', title='dict'>new_state</a>)
<span class='lineno'> 418</span> 
<span class='lineno'> 419</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_global_state', title='[?]'>updated_global_state</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state', title='(HierarchicalRNN, ?, ?) -> [?] / (HierarchicalRNN, [None], [?]) -> [?] / (HierarchicalRNN, [None], ?) -> [?]'>_compute_updated_global_state</a>([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.layer_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.layer_state', title='None'>layer_state</a>],
<span class='lineno'> 420</span>                                                                 <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.global_state', title='[?]'>global_state</a>)
<span class='lineno'> 421</span> 
<span class='lineno'> 422</span>     return (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_params', title='[?]'>updated_params</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_states', title='[dict]'>updated_states</a>, [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_global_state', title='[?]'>updated_global_state</a>],
<span class='lineno'> 423</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates.updated_attention', title='[?]'>updated_attention</a>)
<span class='lineno'> 424</span> 
<span class='lineno'> 425</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr', title='(HierarchicalRNN, [dict]) -> float / (HierarchicalRNN, ?) -> float'>_compute_mean_log_lr</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.states', title='[dict]'>states</a>):
<span class='lineno'> 426</span>     &quot;&quot;&quot;Computes the mean log learning rate across all variables.&quot;&quot;&quot;
<span class='lineno'> 427</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_problem_lr_mean', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_problem_lr_mean', title='bool'>use_problem_lr_mean</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', title='bool'>use_relative_lr</a>:
<span class='lineno'> 428</span> 
<span class='lineno'> 429</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.sum_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.sum_log_lr', title='float'>sum_log_lr</a> = 0.
<span class='lineno'> 430</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.count_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.count_log_lr', title='float'>count_log_lr</a> = 0.
<span class='lineno'> 431</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.state', title='dict'>state</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.states', title='[dict]'>states</a>:
<span class='lineno'> 432</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.sum_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.sum_log_lr', title='float'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.sum_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.sum_log_lr', title='float'>sum_log_lr</a></a> += tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.state', title='dict'>state</a>[&quot;log_learning_rate&quot;])
<span class='lineno'> 433</span>         # Note: get_shape().num_elements()=num elements in the original tensor.
<span class='lineno'> 434</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.count_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.count_log_lr', title='float'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.count_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.count_log_lr', title='float'>count_log_lr</a></a> += <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.state', title='dict'>state</a>[&quot;log_learning_rate&quot;].get_shape().num_elements()
<span class='lineno'> 435</span>       return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.sum_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.sum_log_lr', title='float'>sum_log_lr</a> / <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.count_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_mean_log_lr.count_log_lr', title='float'>count_log_lr</a>
<span class='lineno'> 436</span> 
<span class='lineno'> 437</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads', title='(HierarchicalRNN, ?, ?) -> ([?], [?], [float])'>_compute_scaled_and_ms_grads</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad', title='?'>grad</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', title='?'>state</a>):
<span class='lineno'> 438</span>     &quot;&quot;&quot;Computes the scaled gradient and the mean squared gradients.
<span class='lineno'> 439</span> 
<span class='lineno'> 440</span>     Gradients are also accumulated across different timescales if appropriate.
<span class='lineno'> 441</span> 
<span class='lineno'> 442</span>     Args:
<span class='lineno'> 443</span>       grad: The gradient tensor for this layer.
<span class='lineno'> 444</span>       state: The optimizer state for this layer.
<span class='lineno'> 445</span> 
<span class='lineno'> 446</span>     Returns:
<span class='lineno'> 447</span>       The scaled gradients, mean squared gradients, and accumulated gradients.
<span class='lineno'> 448</span>     &quot;&quot;&quot;
<span class='lineno'> 449</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.input_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.input_decays', title='[?]'>input_decays</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', title='?'>state</a>[&quot;inp_decay&quot;]]
<span class='lineno'> 450</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.scale_decays', title='[?]'>scale_decays</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', title='?'>state</a>[&quot;scl_decay&quot;]]
<span class='lineno'> 451</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_multiple_scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_multiple_scale_decays', title='bool'>use_multiple_scale_decays</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a> &gt; 1:
<span class='lineno'> 452</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', title='int'>i</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a> - 1):
<span class='lineno'> 453</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.scale_decays', title='[?]'>scale_decays</a>.append(tf.sqrt(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.scale_decays', title='[?]'>scale_decays</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', title='int'>i</a>]))
<span class='lineno'> 454</span> 
<span class='lineno'> 455</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', title='int'>i</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a> - 1):
<span class='lineno'> 456</span>       # Each accumulator on twice the timescale of the one before.
<span class='lineno'> 457</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.input_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.input_decays', title='[?]'>input_decays</a>.append(tf.sqrt(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.input_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.input_decays', title='[?]'>input_decays</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', title='int'>i</a>]))
<span class='lineno'> 458</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_accum', title='[float]'>grads_accum</a> = []
<span class='lineno'> 459</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_scaled', title='[?]'>grads_scaled</a> = []
<span class='lineno'> 460</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.mean_squared_gradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.mean_squared_gradients', title='[?]'>mean_squared_gradients</a> = []
<span class='lineno'> 461</span> 
<span class='lineno'> 462</span>     # populate the scaled gradients and associated mean_squared values
<span class='lineno'> 463</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a> &gt; 0:
<span class='lineno'> 464</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', title='?'>i</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.decay', title='?'>decay</a> in enumerate(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.input_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.input_decays', title='[?]'>input_decays</a>):
<span class='lineno'> 465</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a> == 1:
<span class='lineno'> 466</span>           # We don&#39;t accumulate if no scales, just take the current gradient.
<span class='lineno'> 467</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_accum', title='?'>grad_accum</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad', title='?'>grad</a>
<span class='lineno'> 468</span>         else:
<span class='lineno'> 469</span>           # The state vars are 1-indexed.
<span class='lineno'> 470</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.old_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.old_accum', title='?'>old_accum</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', title='?'>state</a>[&quot;grad_accum{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', title='?'>i</a> + 1)]
<span class='lineno'> 471</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_accum', title='float'>grad_accum</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad', title='?'>grad</a> * (1. - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.decay', title='?'>decay</a>) + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.old_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.old_accum', title='?'>old_accum</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.decay', title='?'>decay</a>
<span class='lineno'> 472</span> 
<span class='lineno'> 473</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_accum', title='[float]'>grads_accum</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_accum', title='float'>grad_accum</a>)
<span class='lineno'> 474</span> 
<span class='lineno'> 475</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.sd', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.sd', title='?'>sd</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.scale_decays', title='[?]'>scale_decays</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', title='?'>i</a> if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_multiple_scale_decays', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_multiple_scale_decays', title='bool'>use_multiple_scale_decays</a> else 0]
<span class='lineno'> 476</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_scaled', title='?'>grad_scaled</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.ms', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.ms', title='?'>ms</a> = utils.rms_scaling(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_accum', title='float'>grad_accum</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.sd', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.sd', title='?'>sd</a>,
<span class='lineno'> 477</span>                                             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.state', title='?'>state</a>[&quot;ms{}&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.i', title='?'>i</a> + 1)],
<span class='lineno'> 478</span>                                             update_ms=True)
<span class='lineno'> 479</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_scaled', title='[?]'>grads_scaled</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grad_scaled', title='?'>grad_scaled</a>)
<span class='lineno'> 480</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.mean_squared_gradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.mean_squared_gradients', title='[?]'>mean_squared_gradients</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.ms', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.ms', title='?'>ms</a>)
<span class='lineno'> 481</span> 
<span class='lineno'> 482</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_scaled', title='[?]'>grads_scaled</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.mean_squared_gradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.mean_squared_gradients', title='[?]'>mean_squared_gradients</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_accum', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_scaled_and_ms_grads.grads_accum', title='[float]'>grads_accum</a>
<span class='lineno'> 483</span> 
<span class='lineno'> 484</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input', title='(HierarchicalRNN, ?, ?, ?, ?, ?) -> None / (HierarchicalRNN, [float], ?, [?], [?], float) -> None'>_extend_rnn_input</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', title='[float]'>rnn_input</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.state', title='?'>state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grads_scaled', title='[?]'>grads_scaled</a>,
<span class='lineno'> 485</span>                         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_squared_gradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_squared_gradients', title='[?]'>mean_squared_gradients</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_log_lr', title='float'>mean_log_lr</a>):
<span class='lineno'> 486</span>     &quot;&quot;&quot;Computes additional rnn inputs and adds them to the rnn_input list.&quot;&quot;&quot;
<span class='lineno'> 487</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_gradient_scales', title='int'>num_gradient_scales</a> &gt; 1 and <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_grad_products', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_grad_products', title='bool'>use_grad_products</a>:
<span class='lineno'> 488</span>       # This gives a measure of curvature relative to input averaging
<span class='lineno'> 489</span>       # lengthscale and to the learning rate
<span class='lineno'> 490</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grad_products', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grad_products', title='[?]'>grad_products</a> = [a * b for a, b in
<span class='lineno'> 491</span>                        zip(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grads_scaled', title='[?]'>grads_scaled</a>[:-1], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grads_scaled', title='[?]'>grads_scaled</a>[1:])]
<span class='lineno'> 492</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', title='[float]'>rnn_input</a>.extend([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.g', title='?'>g</a> for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.g', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.g', title='?'>g</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grad_products', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.grad_products', title='[?]'>grad_products</a>])
<span class='lineno'> 493</span> 
<span class='lineno'> 494</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_log_means_squared', title='bool'>use_log_means_squared</a>:
<span class='lineno'> 495</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_means_squared', title='[?]'>log_means_squared</a> = [tf.log(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.ms', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.ms', title='?'>ms</a> + 1e-16)
<span class='lineno'> 496</span>                            for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.ms', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.ms', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.ms', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.ms', title='?'>ms</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_squared_gradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_squared_gradients', title='[?]'>mean_squared_gradients</a>]
<span class='lineno'> 497</span> 
<span class='lineno'> 498</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.avg', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.avg', title='?'>avg</a> = tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_means_squared', title='[?]'>log_means_squared</a>, axis=0)
<span class='lineno'> 499</span>       # This gives a measure of the signal vs. noise contribution to the
<span class='lineno'> 500</span>       # gradient, at the current averaging lengthscale. If all the noise
<span class='lineno'> 501</span>       # is averaged out, and if updates are small, these will be 0.
<span class='lineno'> 502</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_log_means_squared', title='[?]'>mean_log_means_squared</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', title='?'>m</a> - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.avg', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.avg', title='?'>avg</a> for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', title='?'>m</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_means_squared', title='[?]'>log_means_squared</a>]
<span class='lineno'> 503</span> 
<span class='lineno'> 504</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', title='[float]'>rnn_input</a>.extend([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', title='?'>m</a> for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.m', title='?'>m</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_log_means_squared', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_log_means_squared', title='[?]'>mean_log_means_squared</a>])
<span class='lineno'> 505</span> 
<span class='lineno'> 506</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', title='bool'>use_relative_lr</a> or <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_extreme_indicator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_extreme_indicator', title='bool'>use_extreme_indicator</a>:
<span class='lineno'> 507</span>       if not <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'>dynamic_output_scale</a>:
<span class='lineno'> 508</span>         raise Exception(&quot;Relative LR and Extreme Indicator features &quot;
<span class='lineno'> 509</span>                         &quot;require dynamic_output_scale to be set to True.&quot;)
<span class='lineno'> 510</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', title='?'>log_lr_vec</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.state', title='?'>state</a>[&quot;log_learning_rate&quot;], [-1, 1])
<span class='lineno'> 511</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_relative_lr', title='bool'>use_relative_lr</a>:
<span class='lineno'> 512</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_problem_lr_mean', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_problem_lr_mean', title='bool'>use_problem_lr_mean</a>:
<span class='lineno'> 513</span>           # Learning rate of this dimension vs. rest of target problem.
<span class='lineno'> 514</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.relative_lr', title='float'>relative_lr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', title='?'>log_lr_vec</a> - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.mean_log_lr', title='float'>mean_log_lr</a>
<span class='lineno'> 515</span>         else:
<span class='lineno'> 516</span>           # Learning rate of this dimension vs. rest of tensor.
<span class='lineno'> 517</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.relative_lr', title='?'>relative_lr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', title='?'>log_lr_vec</a> - tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', title='?'>log_lr_vec</a>)
<span class='lineno'> 518</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', title='[float]'>rnn_input</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.relative_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.relative_lr', title='float'>relative_lr</a>)
<span class='lineno'> 519</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_extreme_indicator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_extreme_indicator', title='bool'>use_extreme_indicator</a>:
<span class='lineno'> 520</span>         # Indicator of extremely large or extremely small learning rate.
<span class='lineno'> 521</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.extreme_indicator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.extreme_indicator', title='?'>extreme_indicator</a> = (tf.nn.relu(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', title='?'>log_lr_vec</a> - tf.log(1.)) -
<span class='lineno'> 522</span>                              tf.nn.relu(tf.log(1e-6) - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', title='?'>log_lr_vec</a>))
<span class='lineno'> 523</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', title='[float]'>rnn_input</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.extreme_indicator', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.extreme_indicator', title='?'>extreme_indicator</a>)
<span class='lineno'> 524</span> 
<span class='lineno'> 525</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_lr_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_lr_shortcut', title='bool'>use_lr_shortcut</a>:
<span class='lineno'> 526</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', title='?'>log_lr_vec</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.state', title='?'>state</a>[&quot;log_learning_rate&quot;], [-1, 1])
<span class='lineno'> 527</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.rnn_input', title='[float]'>rnn_input</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._extend_rnn_input.log_lr_vec', title='?'>log_lr_vec</a> - tf.log(1e-3))
<span class='lineno'> 528</span> 
<span class='lineno'> 529</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells', title='(HierarchicalRNN, ?, ?, ?, ?) -> (None, ?) / (HierarchicalRNN, ?, [?], ?, bool) -> (None, ?) / (HierarchicalRNN, ?, ?, ?, bool) -> (None, ?)'>_update_rnn_cells</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', title='?'>state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_state', title='[?]'>global_state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.rnn_input_tensor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.rnn_input_tensor', title='?'>rnn_input_tensor</a>,
<span class='lineno'> 530</span>                         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.use_additional_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.use_additional_features', title='bool'>use_additional_features</a>):
<span class='lineno'> 531</span>     &quot;&quot;&quot;Updates the component RNN cells with the given state and tensor.
<span class='lineno'> 532</span> 
<span class='lineno'> 533</span>     Args:
<span class='lineno'> 534</span>       state: The current state of the optimizer.
<span class='lineno'> 535</span>       global_state: The current global RNN state.
<span class='lineno'> 536</span>       rnn_input_tensor: The input tensor to the RNN.
<span class='lineno'> 537</span>       use_additional_features: Whether the rnn input tensor contains additional
<span class='lineno'> 538</span>           features beyond the scaled gradients (affects whether the rnn input
<span class='lineno'> 539</span>           tensor is used as input to the RNN.)
<span class='lineno'> 540</span> 
<span class='lineno'> 541</span>     Returns:
<span class='lineno'> 542</span>       layer_state: The new state of the per-tensor RNN.
<span class='lineno'> 543</span>       new_param_state: The new state of the per-parameter RNN.
<span class='lineno'> 544</span>     &quot;&quot;&quot;
<span class='lineno'> 545</span>     # lowest level (per parameter)
<span class='lineno'> 546</span>     #   input -&gt; gradient for this parameter
<span class='lineno'> 547</span>     #   bias -&gt; output from the layer RNN
<span class='lineno'> 548</span>     with tf.variable_scope(&quot;Layer0_RNN&quot;):
<span class='lineno'> 549</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', title='None'>total_bias</a> = None
<span class='lineno'> 550</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'>num_layers</a> &gt; 1:
<span class='lineno'> 551</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', title='int'>sz</a> = 3 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', title='[?]'>cells</a>[0].state_size    # size of the concatenated bias
<span class='lineno'> 552</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.param_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.param_bias', title='?'>param_bias</a> = utils.affine([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', title='?'>state</a>[&quot;layer&quot;]], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', title='int'>sz</a>,
<span class='lineno'> 553</span>                                   scope=&quot;Param/Affine&quot;,
<span class='lineno'> 554</span>                                   scale=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a>.hrnn_affine_scale,
<span class='lineno'> 555</span>                                   random_seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>)
<span class='lineno'> 556</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', title='?'>total_bias</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.param_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.param_bias', title='?'>param_bias</a>
<span class='lineno'> 557</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'>num_layers</a> == 3:
<span class='lineno'> 558</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_bias', title='?'>global_bias</a> = utils.affine(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_state', title='[?]'>global_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', title='int'>sz</a>,
<span class='lineno'> 559</span>                                      scope=&quot;Global/Affine&quot;,
<span class='lineno'> 560</span>                                      scale=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a>.hrnn_affine_scale,
<span class='lineno'> 561</span>                                      random_seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>)
<span class='lineno'> 562</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', title='?'>total_bias</a></a> += <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_bias', title='?'>global_bias</a>
<span class='lineno'> 563</span> 
<span class='lineno'> 564</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.new_param_state', title='?'>new_param_state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells._', title='?'>_</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', title='[?]'>cells</a>[0](
<span class='lineno'> 565</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.rnn_input_tensor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.rnn_input_tensor', title='?'>rnn_input_tensor</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', title='?'>state</a>[&quot;parameter&quot;], bias=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.total_bias', title='None'>total_bias</a>)
<span class='lineno'> 566</span> 
<span class='lineno'> 567</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'>num_layers</a> &gt; 1:
<span class='lineno'> 568</span>       # middle level (per layer)
<span class='lineno'> 569</span>       #   input -&gt; average hidden state from each parameter in this layer
<span class='lineno'> 570</span>       #   bias -&gt; output from the RNN at the global level
<span class='lineno'> 571</span>       with tf.variable_scope(&quot;Layer1_RNN&quot;):
<span class='lineno'> 572</span>         if not <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.use_additional_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.use_additional_features', title='bool'>use_additional_features</a>:
<span class='lineno'> 573</span>           # Restore old behavior and only add the mean of the new params.
<span class='lineno'> 574</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_input', title='?'>layer_input</a> = tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.new_param_state', title='?'>new_param_state</a>, 0, keep_dims=True)
<span class='lineno'> 575</span>         else:
<span class='lineno'> 576</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_input', title='?'>layer_input</a> = tf.reduce_mean(
<span class='lineno'> 577</span>               tf.concat((<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.new_param_state', title='?'>new_param_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.rnn_input_tensor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.rnn_input_tensor', title='?'>rnn_input_tensor</a>), 1), 0,
<span class='lineno'> 578</span>               keep_dims=True)
<span class='lineno'> 579</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'>num_layers</a> == 3:
<span class='lineno'> 580</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', title='int'>sz</a> = 3 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', title='[?]'>cells</a>[1].state_size
<span class='lineno'> 581</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_bias', title='?'>layer_bias</a> = utils.affine(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.global_state', title='[?]'>global_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.sz', title='int'>sz</a>,
<span class='lineno'> 582</span>                                     scale=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a>.hrnn_affine_scale,
<span class='lineno'> 583</span>                                     random_seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>)
<span class='lineno'> 584</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_state', title='?'>layer_state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells._', title='?'>_</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', title='[?]'>cells</a>[1](
<span class='lineno'> 585</span>               <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_input', title='?'>layer_input</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', title='?'>state</a>[&quot;layer&quot;], bias=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_bias', title='?'>layer_bias</a>)
<span class='lineno'> 586</span>         else:
<span class='lineno'> 587</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_state', title='?'>layer_state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells._', title='?'>_</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', title='[?]'>cells</a>[1](<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_input', title='?'>layer_input</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.state', title='?'>state</a>[&quot;layer&quot;])
<span class='lineno'> 588</span>     else:
<span class='lineno'> 589</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_state', title='None'>layer_state</a> = None
<span class='lineno'> 590</span> 
<span class='lineno'> 591</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.layer_state', title='None'>layer_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._update_rnn_cells.new_param_state', title='?'>new_param_state</a>
<span class='lineno'> 592</span> 
<span class='lineno'> 593</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections', title='(HierarchicalRNN, ?, ?, ?) -> (?, ?, float, ?, float, None) / (HierarchicalRNN, ?, ?, [?]) -> (?, ?, float, ?, float, None)'>_compute_rnn_state_projections</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.state', title='?'>state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', title='?'>new_param_state</a>,
<span class='lineno'> 594</span>                                      <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled', title='[?]'>grads_scaled</a>):
<span class='lineno'> 595</span>     &quot;&quot;&quot;Computes the RNN state-based updates to parameters and update steps.&quot;&quot;&quot;
<span class='lineno'> 596</span>     # Compute the update direction (a linear projection of the RNN output).
<span class='lineno'> 597</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_weights', title='?'>update_weights</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.update_weights', title='?'>update_weights</a>
<span class='lineno'> 598</span> 
<span class='lineno'> 599</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', title='?'>update_delta</a> = utils.project(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', title='?'>new_param_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_weights', title='?'>update_weights</a>)
<span class='lineno'> 600</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_gradient_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_gradient_shortcut', title='bool'>use_gradient_shortcut</a>:
<span class='lineno'> 601</span>       # Include an affine projection of just the direction of the gradient
<span class='lineno'> 602</span>       # so that RNN hidden states are freed up to store more complex
<span class='lineno'> 603</span>       # functions of the gradient and other parameters.
<span class='lineno'> 604</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled_tensor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled_tensor', title='?'>grads_scaled_tensor</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.g', title='?'>g</a> for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.g', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.g', title='?'>g</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled', title='[?]'>grads_scaled</a>], 1)
<span class='lineno'> 605</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', title='?'>update_delta</a></a> += utils.affine(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled_tensor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled_tensor', title='?'>grads_scaled_tensor</a>, 1,
<span class='lineno'> 606</span>                                    scope=&quot;GradsToDelta&quot;,
<span class='lineno'> 607</span>                                    include_bias=False,
<span class='lineno'> 608</span>                                    vec_mean=1. / len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled', title='[?]'>grads_scaled</a>),
<span class='lineno'> 609</span>                                    random_seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>)
<span class='lineno'> 610</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'>dynamic_output_scale</a>:
<span class='lineno'> 611</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.denom', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.denom', title='?'>denom</a> = tf.sqrt(tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', title='?'>update_delta</a> ** 2) + 1e-16)
<span class='lineno'> 612</span> 
<span class='lineno'> 613</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', title='?'>update_delta</a></a> /= <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.denom', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.denom', title='?'>denom</a>
<span class='lineno'> 614</span> 
<span class='lineno'> 615</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', title='bool'>use_attention</a>:
<span class='lineno'> 616</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_weights', title='?'>attention_weights</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.attention_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.attention_weights', title='?'>attention_weights</a>
<span class='lineno'> 617</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', title='?'>attention_delta</a> = utils.project(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', title='?'>new_param_state</a>,
<span class='lineno'> 618</span>                                       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_weights', title='?'>attention_weights</a>)
<span class='lineno'> 619</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_gradient_shortcut', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_gradient_shortcut', title='bool'>use_gradient_shortcut</a>:
<span class='lineno'> 620</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', title='?'>attention_delta</a></a> += utils.affine(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled_tensor', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled_tensor', title='?'>grads_scaled_tensor</a>, 1,
<span class='lineno'> 621</span>                                         scope=&quot;GradsToAttnDelta&quot;,
<span class='lineno'> 622</span>                                         include_bias=False,
<span class='lineno'> 623</span>                                         vec_mean=1. / len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.grads_scaled', title='[?]'>grads_scaled</a>),
<span class='lineno'> 624</span>                                         random_seed=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.random_seed', title='None'>random_seed</a>)
<span class='lineno'> 625</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'>dynamic_output_scale</a>:
<span class='lineno'> 626</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', title='?'>attention_delta</a></a> /= tf.sqrt(
<span class='lineno'> 627</span>             tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', title='?'>attention_delta</a> ** 2) + 1e-16)
<span class='lineno'> 628</span>     else:
<span class='lineno'> 629</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', title='None'>attention_delta</a> = None
<span class='lineno'> 630</span> 
<span class='lineno'> 631</span>     # The updated decay is an affine projection of the hidden state.
<span class='lineno'> 632</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.scl_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.scl_decay', title='?'>scl_decay</a> = utils.project(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', title='?'>new_param_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_weights', title='?'>scl_decay_weights</a>,
<span class='lineno'> 633</span>                               bias=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.scl_decay_bias', title='?'>scl_decay_bias</a>,
<span class='lineno'> 634</span>                               activation=tf.nn.sigmoid)
<span class='lineno'> 635</span>     # This is only used if learnable_decay and num_gradient_scales &gt; 1
<span class='lineno'> 636</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.inp_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.inp_decay', title='?'>inp_decay</a> = utils.project(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', title='?'>new_param_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_weights', title='?'>inp_decay_weights</a>,
<span class='lineno'> 637</span>                               bias=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.inp_decay_bias', title='?'>inp_decay_bias</a>,
<span class='lineno'> 638</span>                               activation=tf.nn.sigmoid)
<span class='lineno'> 639</span> 
<span class='lineno'> 640</span>     # Also update the learning rate.
<span class='lineno'> 641</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.lr_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.lr_param', title='float'>lr_param</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.lr_attend', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.lr_attend', title='float'>lr_attend</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_log_lr', title='float'>new_log_lr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate', title='(HierarchicalRNN, ?, ?) -> (float, float, float)'>_compute_new_learning_rate</a>(
<span class='lineno'> 642</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.state', title='?'>state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_param_state', title='?'>new_param_state</a>)
<span class='lineno'> 643</span> 
<span class='lineno'> 644</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_step', title='?'>update_step</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.lr_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.lr_param', title='float'>lr_param</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_delta', title='?'>update_delta</a>,
<span class='lineno'> 645</span>                              <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.state', title='?'>state</a>[&quot;true_param&quot;].get_shape())
<span class='lineno'> 646</span> 
<span class='lineno'> 647</span>     return (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.scl_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.scl_decay', title='?'>scl_decay</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.inp_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.inp_decay', title='?'>inp_decay</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.new_log_lr', title='float'>new_log_lr</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.update_step', title='?'>update_step</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.lr_attend', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.lr_attend', title='float'>lr_attend</a>,
<span class='lineno'> 648</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_rnn_state_projections.attention_delta', title='None'>attention_delta</a>)
<span class='lineno'> 649</span> 
<span class='lineno'> 650</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate', title='(HierarchicalRNN, ?, ?) -> (float, float, float)'>_compute_new_learning_rate</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.state', title='?'>state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_param_state', title='?'>new_param_state</a>):
<span class='lineno'> 651</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.dynamic_output_scale', title='bool'>dynamic_output_scale</a>:
<span class='lineno'> 652</span>       # Compute the change in learning rate (an affine projection of the
<span class='lineno'> 653</span>       # RNN state, passed through a sigmoid or log depending on flags).
<span class='lineno'> 654</span>       # Update the learning rate, w/ momentum.
<span class='lineno'> 655</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_change', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_change', title='?'>lr_change</a> = utils.project(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_param_state', title='?'>new_param_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', title='?'>lr_weights</a>,
<span class='lineno'> 656</span>                                 bias=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', title='?'>lr_bias</a>)
<span class='lineno'> 657</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', title='?'>step_log_lr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.state', title='?'>state</a>[&quot;log_learning_rate&quot;] + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_change', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_change', title='?'>lr_change</a>
<span class='lineno'> 658</span> 
<span class='lineno'> 659</span>       # Clip the log learning rate to the flag at the top end, and to
<span class='lineno'> 660</span>       # (log(min int32) - 1) at the bottom
<span class='lineno'> 661</span> 
<span class='lineno'> 662</span>       # Check out this hack: we want to be able to compute the gradient
<span class='lineno'> 663</span>       # of the downstream result w.r.t lr weights and bias, even if the
<span class='lineno'> 664</span>       # value of step_log_lr is outside the clip range. So we clip,
<span class='lineno'> 665</span>       # subtract off step_log_lr, and wrap all that in a stop_gradient so
<span class='lineno'> 666</span>       # TF never tries to take the gradient of the clip... or the
<span class='lineno'> 667</span>       # subtraction. Then we add BACK step_log_lr so that downstream still
<span class='lineno'> 668</span>       # receives the clipped value. But the GRADIENT of step_log_lr will
<span class='lineno'> 669</span>       # be the gradient of the unclipped value, which we added back in
<span class='lineno'> 670</span>       # after stop_gradients.
<span class='lineno'> 671</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', title='?'>step_log_lr</a></a> += tf.stop_gradient(
<span class='lineno'> 672</span>           tf.clip_by_value(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', title='?'>step_log_lr</a>, -33, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.max_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.max_log_lr', title='int'>max_log_lr</a>)
<span class='lineno'> 673</span>           - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', title='?'>step_log_lr</a>)
<span class='lineno'> 674</span> 
<span class='lineno'> 675</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_momentum_logit', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_momentum_logit', title='?'>lr_momentum_logit</a> = tf.get_variable(
<span class='lineno'> 676</span>           &quot;learning_rate_momentum_logit&quot;,
<span class='lineno'> 677</span>           initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.FLAGS', title='?'>FLAGS</a>.learning_rate_momentum_logit_init)
<span class='lineno'> 678</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lrm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lrm', title='?'>lrm</a> = tf.nn.sigmoid(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_momentum_logit', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_momentum_logit', title='?'>lr_momentum_logit</a>)
<span class='lineno'> 679</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_log_lr', title='float'>new_log_lr</a> = (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lrm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lrm', title='?'>lrm</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.state', title='?'>state</a>[&quot;log_learning_rate&quot;] +
<span class='lineno'> 680</span>                     (1. - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lrm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lrm', title='?'>lrm</a>) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', title='?'>step_log_lr</a>)
<span class='lineno'> 681</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.param_stepsize_offset', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.param_stepsize_offset', title='?'>param_stepsize_offset</a> = tf.get_variable(&quot;param_stepsize_offset&quot;,
<span class='lineno'> 682</span>                                               initializer=-1.)
<span class='lineno'> 683</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', title='?'>lr_param</a> = tf.exp(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', title='?'>step_log_lr</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.param_stepsize_offset', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.param_stepsize_offset', title='?'>param_stepsize_offset</a>)
<span class='lineno'> 684</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_attend', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_attend', title='?'>lr_attend</a> = tf.exp(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.step_log_lr', title='?'>step_log_lr</a>) if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', title='bool'>use_attention</a> else <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', title='?'>lr_param</a>
<span class='lineno'> 685</span>     else:
<span class='lineno'> 686</span>       # Dynamic output scale is off, LR param is always 1.
<span class='lineno'> 687</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', title='float'>lr_param</a> = 2. * utils.project(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_param_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_param_state', title='?'>new_param_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_weights', title='?'>lr_weights</a>,
<span class='lineno'> 688</span>                                     bias=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.lr_bias', title='?'>lr_bias</a>,
<span class='lineno'> 689</span>                                     activation=tf.nn.sigmoid)
<span class='lineno'> 690</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_log_lr', title='None'>new_log_lr</a> = None
<span class='lineno'> 691</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_attend', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_attend', title='float'>lr_attend</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', title='float'>lr_param</a>
<span class='lineno'> 692</span> 
<span class='lineno'> 693</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_param', title='float'>lr_param</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_attend', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.lr_attend', title='float'>lr_attend</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_log_lr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_new_learning_rate.new_log_lr', title='float'>new_log_lr</a>
<span class='lineno'> 694</span> 
<span class='lineno'> 695</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state', title='(HierarchicalRNN, ?, ?) -> [?] / (HierarchicalRNN, [None], [?]) -> [?] / (HierarchicalRNN, [None], ?) -> [?]'>_compute_updated_global_state</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.layer_states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.layer_states', title='[None]'>layer_states</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.global_state', title='[?]'>global_state</a>):
<span class='lineno'> 696</span>     &quot;&quot;&quot;Computes the new global state gives the layers states and old state.
<span class='lineno'> 697</span> 
<span class='lineno'> 698</span>     Args:
<span class='lineno'> 699</span>       layer_states: The current layer states.
<span class='lineno'> 700</span>       global_state: The old global state.
<span class='lineno'> 701</span> 
<span class='lineno'> 702</span>     Returns:
<span class='lineno'> 703</span>       The updated global state.
<span class='lineno'> 704</span>     &quot;&quot;&quot;
<span class='lineno'> 705</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.updated_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.updated_global_state', title='[?]'>updated_global_state</a> = []
<span class='lineno'> 706</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.num_layers', title='int'>num_layers</a> == 3:
<span class='lineno'> 707</span>       # highest (global) layer
<span class='lineno'> 708</span>       #   input -&gt; average hidden state from each layer-specific RNN
<span class='lineno'> 709</span>       #   bias -&gt; None
<span class='lineno'> 710</span>       with tf.variable_scope(&quot;Layer2_RNN&quot;, reuse=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', title='bool'>reuse_global_state</a>):
<span class='lineno'> 711</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', title='bool'>reuse_global_state</a> = True
<span class='lineno'> 712</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.global_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.global_input', title='?'>global_input</a> = tf.reduce_mean(tf.concat(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.layer_states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.layer_states', title='[None]'>layer_states</a>, 0), 0,
<span class='lineno'> 713</span>                                       keep_dims=True)
<span class='lineno'> 714</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.updated_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.updated_global_state', title='?'>updated_global_state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state._', title='?'>_</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.cells', title='[?]'>cells</a>[2](<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.global_input', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.global_input', title='?'>global_input</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.global_state', title='[?]'>global_state</a>[0])
<span class='lineno'> 715</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.updated_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updated_global_state.updated_global_state', title='[?]'>updated_global_state</a>
<span class='lineno'> 716</span> 
<span class='lineno'> 717</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients', title='(HierarchicalRNN, ?, None, None) -> (?, [?])'>apply_gradients</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', title='?'>grads_and_vars</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_step', title='None'>global_step</a>=None, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', title='None'>name</a>=None):
<span class='lineno'> 718</span>     &quot;&quot;&quot;Overwrites the tf.train.Optimizer interface for applying gradients.&quot;&quot;&quot;
<span class='lineno'> 719</span> 
<span class='lineno'> 720</span>     # Pull out the variables.
<span class='lineno'> 721</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', title='tuple'>grads_and_vars</a> = tuple(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', title='?'>grads_and_vars</a>)  # Make sure repeat iteration works.
<span class='lineno'> 722</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', title='?'>g</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', title='?'>v</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', title='tuple'>grads_and_vars</a>:
<span class='lineno'> 723</span>       if not isinstance(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', title='?'>g</a>, (tf.Tensor, tf.IndexedSlices, type(None))):
<span class='lineno'> 724</span>         raise TypeError(
<span class='lineno'> 725</span>             &quot;Gradient must be a Tensor, IndexedSlices, or None: %s&quot; % g)
<span class='lineno'> 726</span>       if not isinstance(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', title='?'>v</a>, tf.Variable):
<span class='lineno'> 727</span>         raise TypeError(
<span class='lineno'> 728</span>             &quot;Variable must be a tf.Variable: %s&quot; % v)
<span class='lineno'> 729</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', title='?'>g</a> is not None:
<span class='lineno'> 730</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>._assert_valid_dtypes([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', title='?'>g</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', title='?'>v</a>])
<span class='lineno'> 731</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', title='[?]'>var_list</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', title='?'>v</a> for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', title='?'>g</a></a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.v', title='?'>v</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', title='tuple'>grads_and_vars</a> if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.g', title='?'>g</a> is not None]
<span class='lineno'> 732</span>     if not <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', title='[?]'>var_list</a>:
<span class='lineno'> 733</span>       raise ValueError(&quot;No gradients provided for any variable: %s&quot; %
<span class='lineno'> 734</span>                        (grads_and_vars,))
<span class='lineno'> 735</span> 
<span class='lineno'> 736</span>     # Create slots for the variables.
<span class='lineno'> 737</span>     with tf.control_dependencies(None):
<span class='lineno'> 738</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>._create_slots(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', title='[?]'>var_list</a>)
<span class='lineno'> 739</span> 
<span class='lineno'> 740</span>     # Store update ops in this list.
<span class='lineno'> 741</span>     with tf.op_scope([], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', title='None'>name</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>._name) as <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', title='?'>name</a>:
<span class='lineno'> 742</span> 
<span class='lineno'> 743</span>       # Prepare the global state.
<span class='lineno'> 744</span>       with tf.variable_scope(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>._name, reuse=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.reuse_global_state', title='bool'>reuse_global_state</a>):
<span class='lineno'> 745</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', title='[?]'>gs</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._initialize_global_state', title='HierarchicalRNN -> [?]'>_initialize_global_state</a>()
<span class='lineno'> 746</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', title='[?]'>gs</a>:
<span class='lineno'> 747</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_state', title='[?]'>global_state</a> = [tf.get_variable(&quot;global_state&quot;, initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', title='[?]'>gs</a>[0])]
<span class='lineno'> 748</span>         else:
<span class='lineno'> 749</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_state', title='[?]'>global_state</a> = []
<span class='lineno'> 750</span> 
<span class='lineno'> 751</span>       # Get the states for each variable in the list.
<span class='lineno'> 752</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.states', title='[dict]'>states</a> = [{<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', title='?'>key</a>: <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>.get_slot(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', title='?'>var</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', title='?'>key</a>) for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', title='?'>key</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>.get_slot_names()}
<span class='lineno'> 753</span>                 for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', title='?'>var</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', title='[?]'>var_list</a>]
<span class='lineno'> 754</span> 
<span class='lineno'> 755</span>       # Compute updated values.
<span class='lineno'> 756</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads', title='?'>grads</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.params', title='?'>params</a> = zip(*<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads_and_vars', title='tuple'>grads_and_vars</a>)
<span class='lineno'> 757</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.args', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.args', title='(?, ?, [dict], [?])'>args</a> = (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.params', title='?'>params</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.grads', title='?'>grads</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.states', title='[dict]'>states</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_state', title='[?]'>global_state</a>)
<span class='lineno'> 758</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.updates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.updates', title='([?], [dict], [[?]], [?])'>updates</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN._compute_updates', title='(HierarchicalRNN, ?, ?, ?, ?) -> ([?], [dict], [[?]], [?]) / (HierarchicalRNN, ?, ?, [dict], [?]) -> ([?], [dict], [[?]], [?])'>_compute_updates</a>(*<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.args', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.args', title='(?, ?, [dict], [?])'>args</a>)
<span class='lineno'> 759</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_params', title='[?]'>new_params</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_states', title='[dict]'>new_states</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_global_state', title='[[?]]'>new_global_state</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_attention', title='[?]'>new_attention</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.updates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.updates', title='([?], [dict], [[?]], [?])'>updates</a>
<span class='lineno'> 760</span>       # Assign op for new global state.
<span class='lineno'> 761</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.update_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.update_ops', title='[?]'>update_ops</a> = [tf.assign(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', title='[?]'>gs</a>, ngs)
<span class='lineno'> 762</span>                     for <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.gs', title='[?]'>gs</a>, ngs in zip(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_state', title='[?]'>global_state</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_global_state', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_global_state', title='[[?]]'>new_global_state</a>)]
<span class='lineno'> 763</span> 
<span class='lineno'> 764</span>       # Create the assign ops for the params and state variables.
<span class='lineno'> 765</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.args', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.args', title='(?, [dict], [?], [?], [dict])'>args</a> = (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.params', title='?'>params</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.states', title='[dict]'>states</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_params', title='[?]'>new_params</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_attention', title='[?]'>new_attention</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_states', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.new_states', title='[dict]'>new_states</a>)
<span class='lineno'> 766</span>       for var, state, new_var, new_var_attend, new_state in zip(*<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.args', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.args', title='(?, [dict], [?], [?], [dict])'>args</a>):
<span class='lineno'> 767</span>         # Assign updates to the state variables.
<span class='lineno'> 768</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_assign_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_assign_ops', title='[?]'>state_assign_ops</a> = [tf.assign(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_var', title='?'>state_var</a>, new_state[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', title='?'>key</a>])
<span class='lineno'> 769</span>                             for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.key', title='?'>key</a></a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_var', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_var', title='?'>state_var</a></a> in state.items()]
<span class='lineno'> 770</span> 
<span class='lineno'> 771</span>         # Update the parameter.
<span class='lineno'> 772</span>         with tf.control_dependencies(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_assign_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.state_assign_ops', title='[?]'>state_assign_ops</a>):
<span class='lineno'> 773</span>           if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>.<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.use_attention', title='bool'>use_attention</a>:
<span class='lineno'> 774</span>             # Assign to the attended location, rather than the actual location
<span class='lineno'> 775</span>             # so that the gradients are computed where attention is.
<span class='lineno'> 776</span>             <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.param_update_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.param_update_op', title='?'>param_update_op</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', title='?'>var</a>.assign(new_var_attend)
<span class='lineno'> 777</span>           else:
<span class='lineno'> 778</span>             <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.param_update_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.param_update_op', title='?'>param_update_op</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', title='?'>var</a>.assign(new_var)
<span class='lineno'> 779</span> 
<span class='lineno'> 780</span>         with tf.name_scope(&quot;update_&quot; + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', title='?'>var</a>.op.name):   #, tf.colocate_with(var):
<span class='lineno'> 781</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.update_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.update_ops', title='[?]'>update_ops</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.param_update_op', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.param_update_op', title='?'>param_update_op</a>)
<span class='lineno'> 782</span> 
<span class='lineno'> 783</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.real_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.real_params', title='[?]'>real_params</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>.get_slot(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', title='?'>var</a>, &quot;true_param&quot;) for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var', title='?'>var</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.var_list', title='[?]'>var_list</a>]
<span class='lineno'> 784</span> 
<span class='lineno'> 785</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_step', title='None'>global_step</a> is None:
<span class='lineno'> 786</span>         # NOTE: if using the optimizer in a non-test-optimizer setting (e.g.
<span class='lineno'> 787</span>         # on Inception), remove the real_params return value. Otherwise
<span class='lineno'> 788</span>         # the code will throw an error.
<span class='lineno'> 789</span>         return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>._finish(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.update_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.update_ops', title='[?]'>update_ops</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', title='?'>name</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.real_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.real_params', title='[?]'>real_params</a>
<span class='lineno'> 790</span>       else:
<span class='lineno'> 791</span>         with tf.control_dependencies([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.self', title='HierarchicalRNN'>self</a>._finish(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.update_ops', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.update_ops', title='[?]'>update_ops</a>, &quot;update&quot;)]):
<span class='lineno'> 792</span>           return state_ops.assign_add(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_step', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.global_step', title='None'>global_step</a>, 1, name=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.name', title='?'>name</a>).op, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.real_params', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.learned_optimizer.optimizer.hierarchical_rnn.HierarchicalRNN.apply_gradients.real_params', title='[?]'>real_params</a>
</pre></td></tr></table></body></html>