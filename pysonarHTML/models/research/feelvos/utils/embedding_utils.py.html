<html>
<head>
<meta charset="utf-8">
<title>/home/xxm/Desktop/EMSE/dataset/models/research/feelvos/utils/embedding_utils.py</title>
<style type='text/css'>
body { color: #666666; }
a {
    text-decoration: none; color: #5AA2A7;
    border: solid 1px rgba(255,255,255,0);
}
a.active {
    background: -webkit-linear-gradient(top,rgba(255, 255, 200, 0.35) 0,rgba(255, 255, 200, 0.55) 100%);
    border: solid 1px #E5E600;
}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #cccccc;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px solid orange; padding-bottom: 1px}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted;

function highlight(xid)
{
    var elms = document.querySelectorAll('[xid="' + xid + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "active";
    }
    highlighted = xid;
}

function clearHighlight() {
    var elms = document.querySelectorAll('[xid="' + highlighted + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "";
    }
}

window.onload =
    function (e) {
        var tags = document.getElementsByTagName("A")
        for (var i = 0; i < tags.length; i++) {
            tags[i].onmouseover =
                function (e) {
                    clearHighlight();
                    var xid = e.toElement.getAttribute('xid');
                    highlight(xid);
                }
        }
    }</script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim'>slim</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape'>resolve_shape</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.WRONG_LABEL_PADDING_DISTANCE', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.WRONG_LABEL_PADDING_DISTANCE'>WRONG_LABEL_PADDING_DISTANCE</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST'>USE_CORRELATION_COST</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances'>pairwise_distances</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2'>pairwise_distances2</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate'>cross_correlate</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances'>local_pairwise_distances</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2'>local_pairwise_distances2</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote'>majority_vote</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors'>assign_labels_by_nearest_neighbors</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances'>flattened_pairwise_distances</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object'>nearest_neighbor_features_per_object</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks'>_nearest_neighbor_features_per_object_in_chunks</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk'>_nn_features_per_object_for_chunk</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features'>create_embedding_segmentation_features</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries'>add_image_summaries</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings'>get_embeddings</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching'>get_logits_with_matching</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels'>subsample_reference_embeddings_and_labels</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask'>_create_subsampling_mask</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer'>conv2d_identity_initializer</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer'>split_separable_conv2d_with_identity_initializer</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels'>create_initial_softmax_from_labels</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object', xid='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object'>local_previous_frame_nearest_neighbor_features_per_object</a></li></ul>
</td><td><pre><span class='lineno'>   1</span> # Copyright 2018 The TensorFlow Authors All Rights Reserved.
<span class='lineno'>   2</span> #
<span class='lineno'>   3</span> # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
<span class='lineno'>   4</span> # you may not use this file except in compliance with the License.
<span class='lineno'>   5</span> # You may obtain a copy of the License at
<span class='lineno'>   6</span> #
<span class='lineno'>   7</span> #     http://www.apache.org/licenses/LICENSE-2.0
<span class='lineno'>   8</span> #
<span class='lineno'>   9</span> # Unless required by applicable law or agreed to in writing, software
<span class='lineno'>  10</span> # distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
<span class='lineno'>  11</span> # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
<span class='lineno'>  12</span> # See the License for the specific language governing permissions and
<span class='lineno'>  13</span> # limitations under the License.
<span class='lineno'>  14</span> # ==============================================================================
<span class='lineno'>  15</span> 
<span class='lineno'>  16</span> &quot;&quot;&quot;Utilities for the instance embedding for segmentation.&quot;&quot;&quot;
<span class='lineno'>  17</span> 
<span class='lineno'>  18</span> import numpy as np
<span class='lineno'>  19</span> import tensorflow as tf
<span class='lineno'>  20</span> from deeplab import model
<span class='lineno'>  21</span> from deeplab.core import preprocess_utils
<span class='lineno'>  22</span> from feelvos.utils import mask_damaging
<span class='lineno'>  23</span> 
<span class='lineno'>  24</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim', title='?'>slim</a> = tf.contrib.slim
<span class='lineno'>  25</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a> = preprocess_utils.resolve_shape
<span class='lineno'>  26</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.WRONG_LABEL_PADDING_DISTANCE', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.WRONG_LABEL_PADDING_DISTANCE', title='float'>WRONG_LABEL_PADDING_DISTANCE</a> = 1e20
<span class='lineno'>  27</span> 
<span class='lineno'>  28</span> # With correlation_cost local matching will be much faster. But we provide a
<span class='lineno'>  29</span> # slow fallback for convenience.
<span class='lineno'>  30</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', title='bool'>USE_CORRELATION_COST</a> = False
<span class='lineno'>  31</span> if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', title='bool'>USE_CORRELATION_COST</a>:
<span class='lineno'>  32</span>   # pylint: disable=g-import-not-at-top
<span class='lineno'>  33</span>   from correlation_cost.python.ops import correlation_cost_op
<span class='lineno'>  34</span> 
<span class='lineno'>  35</span> 
<span class='lineno'>  36</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances', title='(?, ?) -> int'>pairwise_distances</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.x', title='?'>x</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.y', title='?'>y</a>):
<span class='lineno'>  37</span>   &quot;&quot;&quot;Computes pairwise squared l2 distances between tensors x and y.
<span class='lineno'>  38</span> 
<span class='lineno'>  39</span>   Args:
<span class='lineno'>  40</span>     x: Tensor of shape [n, feature_dim].
<span class='lineno'>  41</span>     y: Tensor of shape [m, feature_dim].
<span class='lineno'>  42</span> 
<span class='lineno'>  43</span>   Returns:
<span class='lineno'>  44</span>     Float32 distances tensor of shape [n, m].
<span class='lineno'>  45</span>   &quot;&quot;&quot;
<span class='lineno'>  46</span>   # d[i,j] = (x[i] - y[j]) * (x[i] - y[j])&#39;
<span class='lineno'>  47</span>   # = sum(x[i]^2, 1) + sum(y[j]^2, 1) - 2 * x[i] * y[j]&#39;
<span class='lineno'>  48</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.xs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.xs', title='?'>xs</a> = tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.x', title='?'>x</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.x', title='?'>x</a>, axis=1)[:, tf.newaxis]
<span class='lineno'>  49</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.ys', title='?'>ys</a> = tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.y', title='?'>y</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.y', title='?'>y</a>, axis=1)[tf.newaxis, :]
<span class='lineno'>  50</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.d', title='int'>d</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.xs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.xs', title='?'>xs</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.ys', title='?'>ys</a> - 2 * tf.matmul(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.x', title='?'>x</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.y', title='?'>y</a>, transpose_b=True)
<span class='lineno'>  51</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances.d', title='int'>d</a>
<span class='lineno'>  52</span> 
<span class='lineno'>  53</span> 
<span class='lineno'>  54</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2', title='(?, ?) -> None'>pairwise_distances2</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2.x', title='?'>x</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2.y', title='?'>y</a>):
<span class='lineno'>  55</span>   &quot;&quot;&quot;Computes pairwise squared l2 distances between tensors x and y.
<span class='lineno'>  56</span> 
<span class='lineno'>  57</span>   Naive implementation, high memory use. Could be useful to test the more
<span class='lineno'>  58</span>   efficient implementation.
<span class='lineno'>  59</span> 
<span class='lineno'>  60</span>   Args:
<span class='lineno'>  61</span>     x: Tensor of shape [n, feature_dim].
<span class='lineno'>  62</span>     y: Tensor of shape [m, feature_dim].
<span class='lineno'>  63</span> 
<span class='lineno'>  64</span>   Returns:
<span class='lineno'>  65</span>     distances of shape [n, m].
<span class='lineno'>  66</span>   &quot;&quot;&quot;
<span class='lineno'>  67</span>   return tf.reduce_sum(tf.squared_difference(
<span class='lineno'>  68</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2.x', title='?'>x</a>[:, tf.newaxis], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances2.y', title='?'>y</a>[tf.newaxis, :]), axis=-1)
<span class='lineno'>  69</span> 
<span class='lineno'>  70</span> 
<span class='lineno'>  71</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate', title='(?, ?, int) -> None'>cross_correlate</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.x', title='?'>x</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.y', title='?'>y</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.max_distance', title='int'>max_distance</a>=9):
<span class='lineno'>  72</span>   &quot;&quot;&quot;Efficiently computes the cross correlation of x and y.
<span class='lineno'>  73</span> 
<span class='lineno'>  74</span>   Optimized implementation using correlation_cost.
<span class='lineno'>  75</span>   Note that we do not normalize by the feature dimension.
<span class='lineno'>  76</span> 
<span class='lineno'>  77</span>   Args:
<span class='lineno'>  78</span>     x: Float32 tensor of shape [height, width, feature_dim].
<span class='lineno'>  79</span>     y: Float32 tensor of shape [height, width, feature_dim].
<span class='lineno'>  80</span>     max_distance: Integer, the maximum distance in pixel coordinates
<span class='lineno'>  81</span>       per dimension which is considered to be in the search window.
<span class='lineno'>  82</span> 
<span class='lineno'>  83</span>   Returns:
<span class='lineno'>  84</span>     Float32 tensor of shape [height, width, (2 * max_distance + 1) ** 2].
<span class='lineno'>  85</span>   &quot;&quot;&quot;
<span class='lineno'>  86</span>   with tf.name_scope(&#39;cross_correlation&#39;):
<span class='lineno'>  87</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', title='?'>corr</a> = correlation_cost_op.correlation_cost(
<span class='lineno'>  88</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.x', title='?'>x</a>[tf.newaxis], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.y', title='?'>y</a>[tf.newaxis], kernel_size=1,
<span class='lineno'>  89</span>         max_displacement=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.max_distance', title='int'>max_distance</a>, stride_1=1, stride_2=1,
<span class='lineno'>  90</span>         pad=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.max_distance', title='int'>max_distance</a>)
<span class='lineno'>  91</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', title='?'>corr</a> = tf.squeeze(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', title='?'>corr</a>, axis=0)
<span class='lineno'>  92</span>     # This correlation implementation takes the mean over the feature_dim,
<span class='lineno'>  93</span>     # but we want sum here, so multiply by feature_dim.
<span class='lineno'>  94</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.feature_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.feature_dim', title='?'>feature_dim</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.x', title='?'>x</a>)[-1]
<span class='lineno'>  95</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', title='?'>corr</a></a> *= <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.feature_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.feature_dim', title='?'>feature_dim</a>
<span class='lineno'>  96</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate.corr', title='?'>corr</a>
<span class='lineno'>  97</span> 
<span class='lineno'>  98</span> 
<span class='lineno'>  99</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances', title='(?, ?, int) -> None'>local_pairwise_distances</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.x', title='?'>x</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.y', title='?'>y</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.max_distance', title='int'>max_distance</a>=9):
<span class='lineno'> 100</span>   &quot;&quot;&quot;Computes pairwise squared l2 distances using a local search window.
<span class='lineno'> 101</span> 
<span class='lineno'> 102</span>   Optimized implementation using correlation_cost.
<span class='lineno'> 103</span> 
<span class='lineno'> 104</span>   Args:
<span class='lineno'> 105</span>     x: Float32 tensor of shape [height, width, feature_dim].
<span class='lineno'> 106</span>     y: Float32 tensor of shape [height, width, feature_dim].
<span class='lineno'> 107</span>     max_distance: Integer, the maximum distance in pixel coordinates
<span class='lineno'> 108</span>       per dimension which is considered to be in the search window.
<span class='lineno'> 109</span> 
<span class='lineno'> 110</span>   Returns:
<span class='lineno'> 111</span>     Float32 distances tensor of shape
<span class='lineno'> 112</span>       [height, width, (2 * max_distance + 1) ** 2].
<span class='lineno'> 113</span>   &quot;&quot;&quot;
<span class='lineno'> 114</span>   with tf.name_scope(&#39;local_pairwise_distances&#39;):
<span class='lineno'> 115</span>     # d[i,j] = (x[i] - y[j]) * (x[i] - y[j])&#39;
<span class='lineno'> 116</span>     # = sum(x[i]^2, -1) + sum(y[j]^2, -1) - 2 * x[i] * y[j]&#39;
<span class='lineno'> 117</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.corr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.corr', title='None'>corr</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate', title='(?, ?, int) -> None'>cross_correlate</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.x', title='?'>x</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.y', title='?'>y</a>, max_distance=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.max_distance', title='int'>max_distance</a>)
<span class='lineno'> 118</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.xs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.xs', title='?'>xs</a> = tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.x', title='?'>x</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.x', title='?'>x</a>, axis=2)[..., tf.newaxis]
<span class='lineno'> 119</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', title='?'>ys</a> = tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.y', title='?'>y</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.y', title='?'>y</a>, axis=2)[..., tf.newaxis]
<span class='lineno'> 120</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ones_ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ones_ys', title='?'>ones_ys</a> = tf.ones_like(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', title='?'>ys</a>)
<span class='lineno'> 121</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', title='None'>ys</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate', title='(?, ?, int) -> None'>cross_correlate</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ones_ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ones_ys', title='?'>ones_ys</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', title='?'>ys</a>, max_distance=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.max_distance', title='int'>max_distance</a>)
<span class='lineno'> 122</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', title='?'>d</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.xs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.xs', title='?'>xs</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ys', title='None'>ys</a> - 2 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.corr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.corr', title='None'>corr</a>
<span class='lineno'> 123</span>     # Boundary should be set to Inf.
<span class='lineno'> 124</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.boundary', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.boundary', title='?'>boundary</a> = tf.equal(
<span class='lineno'> 125</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.cross_correlate', title='(?, ?, int) -> None'>cross_correlate</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ones_ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ones_ys', title='?'>ones_ys</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ones_ys', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.ones_ys', title='?'>ones_ys</a>, max_distance=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.max_distance', title='int'>max_distance</a>), 0)
<span class='lineno'> 126</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', title='?'>d</a> = tf.where(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.boundary', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.boundary', title='?'>boundary</a>, tf.fill(tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', title='?'>d</a>), tf.constant(np.float(&#39;inf&#39;))),
<span class='lineno'> 127</span>                  <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', title='?'>d</a>)
<span class='lineno'> 128</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances.d', title='?'>d</a>
<span class='lineno'> 129</span> 
<span class='lineno'> 130</span> 
<span class='lineno'> 131</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2', title='(?, ?, int) -> None'>local_pairwise_distances2</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x', title='?'>x</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y', title='?'>y</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', title='int'>max_distance</a>=9):
<span class='lineno'> 132</span>   &quot;&quot;&quot;Computes pairwise squared l2 distances using a local search window.
<span class='lineno'> 133</span> 
<span class='lineno'> 134</span>   Naive implementation using map_fn.
<span class='lineno'> 135</span>   Used as a slow fallback for when correlation_cost is not available.
<span class='lineno'> 136</span> 
<span class='lineno'> 137</span>   Args:
<span class='lineno'> 138</span>     x: Float32 tensor of shape [height, width, feature_dim].
<span class='lineno'> 139</span>     y: Float32 tensor of shape [height, width, feature_dim].
<span class='lineno'> 140</span>     max_distance: Integer, the maximum distance in pixel coordinates
<span class='lineno'> 141</span>       per dimension which is considered to be in the search window.
<span class='lineno'> 142</span> 
<span class='lineno'> 143</span>   Returns:
<span class='lineno'> 144</span>     Float32 distances tensor of shape
<span class='lineno'> 145</span>       [height, width, (2 * max_distance + 1) ** 2].
<span class='lineno'> 146</span>   &quot;&quot;&quot;
<span class='lineno'> 147</span>   with tf.name_scope(&#39;local_pairwise_distances2&#39;):
<span class='lineno'> 148</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.padding_val', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.padding_val', title='float'>padding_val</a> = 1e20
<span class='lineno'> 149</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.padded_y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.padded_y', title='?'>padded_y</a> = tf.pad(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y', title='?'>y</a>, [[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', title='int'>max_distance</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', title='int'>max_distance</a>],
<span class='lineno'> 150</span>                           [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', title='int'>max_distance</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', title='int'>max_distance</a>], [0, 0]],
<span class='lineno'> 151</span>                       constant_values=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.padding_val', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.padding_val', title='float'>padding_val</a>)
<span class='lineno'> 152</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.height', title='?'>height</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.width', title='?'>width</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2._', title='?'>_</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x', title='?'>x</a>)
<span class='lineno'> 153</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', title='[?]'>dists</a> = []
<span class='lineno'> 154</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_start', title='int'>y_start</a> in range(2 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', title='int'>max_distance</a> + 1):
<span class='lineno'> 155</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_end', title='int'>y_end</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_start', title='int'>y_start</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.height', title='?'>height</a>
<span class='lineno'> 156</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_slice', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_slice', title='?'>y_slice</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.padded_y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.padded_y', title='?'>padded_y</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_start', title='int'>y_start</a>:<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_end', title='int'>y_end</a>]
<span class='lineno'> 157</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_start', title='int'>x_start</a> in range(2 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.max_distance', title='int'>max_distance</a> + 1):
<span class='lineno'> 158</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_end', title='int'>x_end</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_start', title='int'>x_start</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.width', title='?'>width</a>
<span class='lineno'> 159</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.offset_y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.offset_y', title='?'>offset_y</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_slice', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.y_slice', title='?'>y_slice</a>[:, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_start', title='int'>x_start</a>:<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x_end', title='int'>x_end</a>]
<span class='lineno'> 160</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dist', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dist', title='?'>dist</a> = tf.reduce_sum(tf.squared_difference(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.x', title='?'>x</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.offset_y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.offset_y', title='?'>offset_y</a>), axis=2)
<span class='lineno'> 161</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', title='[?]'>dists</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dist', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dist', title='?'>dist</a>)
<span class='lineno'> 162</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', title='?'>dists</a> = tf.stack(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', title='[?]'>dists</a>, axis=2)
<span class='lineno'> 163</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2.dists', title='?'>dists</a>
<span class='lineno'> 164</span> 
<span class='lineno'> 165</span> 
<span class='lineno'> 166</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote', title='? -> None'>majority_vote</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.labels', title='?'>labels</a>):
<span class='lineno'> 167</span>   &quot;&quot;&quot;Performs a label majority vote along axis 1.
<span class='lineno'> 168</span> 
<span class='lineno'> 169</span>   Second try, hopefully this time more efficient.
<span class='lineno'> 170</span>   We assume that the labels are contiguous starting from 0.
<span class='lineno'> 171</span>   It will also work for non-contiguous labels, but be inefficient.
<span class='lineno'> 172</span> 
<span class='lineno'> 173</span>   Args:
<span class='lineno'> 174</span>     labels: Int tensor of shape [n, k]
<span class='lineno'> 175</span> 
<span class='lineno'> 176</span>   Returns:
<span class='lineno'> 177</span>     The majority of labels along axis 1
<span class='lineno'> 178</span>   &quot;&quot;&quot;
<span class='lineno'> 179</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.max_label', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.max_label', title='?'>max_label</a> = tf.reduce_max(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.labels', title='?'>labels</a>)
<span class='lineno'> 180</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.one_hot', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.one_hot', title='?'>one_hot</a> = tf.one_hot(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.labels', title='?'>labels</a>, depth=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.max_label', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.max_label', title='?'>max_label</a> + 1)
<span class='lineno'> 181</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.summed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.summed', title='?'>summed</a> = tf.reduce_sum(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.one_hot', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.one_hot', title='?'>one_hot</a>, axis=1)
<span class='lineno'> 182</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.majority', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.majority', title='?'>majority</a> = tf.argmax(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.summed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.summed', title='?'>summed</a>, axis=1)
<span class='lineno'> 183</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.majority', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote.majority', title='?'>majority</a>
<span class='lineno'> 184</span> 
<span class='lineno'> 185</span> 
<span class='lineno'> 186</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors', title='(?, ?, ?, int) -> None'>assign_labels_by_nearest_neighbors</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_embeddings', title='?'>reference_embeddings</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.query_embeddings', title='?'>query_embeddings</a>,
<span class='lineno'> 187</span>                                        <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_labels', title='?'>reference_labels</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', title='int'>k</a>=1):
<span class='lineno'> 188</span>   &quot;&quot;&quot;Segments by nearest neighbor query wrt the reference frame.
<span class='lineno'> 189</span> 
<span class='lineno'> 190</span>   Args:
<span class='lineno'> 191</span>     reference_embeddings: Tensor of shape [height, width, embedding_dim],
<span class='lineno'> 192</span>       the embedding vectors for the reference frame
<span class='lineno'> 193</span>     query_embeddings: Tensor of shape [n_query_images, height, width,
<span class='lineno'> 194</span>       embedding_dim], the embedding vectors for the query frames
<span class='lineno'> 195</span>     reference_labels: Tensor of shape [height, width, 1], the class labels of
<span class='lineno'> 196</span>       the reference frame
<span class='lineno'> 197</span>     k: Integer, the number of nearest neighbors to use
<span class='lineno'> 198</span> 
<span class='lineno'> 199</span>   Returns:
<span class='lineno'> 200</span>     The labels of the nearest neighbors as [n_query_frames, height, width, 1]
<span class='lineno'> 201</span>     tensor
<span class='lineno'> 202</span> 
<span class='lineno'> 203</span>   Raises:
<span class='lineno'> 204</span>     ValueError: If k &lt; 1.
<span class='lineno'> 205</span>   &quot;&quot;&quot;
<span class='lineno'> 206</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', title='int'>k</a> &lt; 1:
<span class='lineno'> 207</span>     raise ValueError(&#39;k must be at least 1&#39;)
<span class='lineno'> 208</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.dists', title='int'>dists</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances', title='(?, ?) -> int'>flattened_pairwise_distances</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_embeddings', title='?'>reference_embeddings</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.query_embeddings', title='?'>query_embeddings</a>)
<span class='lineno'> 209</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', title='int'>k</a> == 1:
<span class='lineno'> 210</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_indices', title='?'>nn_indices</a> = tf.argmin(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.dists', title='int'>dists</a>, axis=1)[..., tf.newaxis]
<span class='lineno'> 211</span>   else:
<span class='lineno'> 212</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors._', title='?'>_</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_indices', title='?'>nn_indices</a> = tf.nn.top_k(-<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.dists', title='int'>dists</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', title='int'>k</a>, sorted=False)
<span class='lineno'> 213</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_labels', title='?'>reference_labels</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_labels', title='?'>reference_labels</a>, [-1])
<span class='lineno'> 214</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', title='?'>nn_labels</a> = tf.gather(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_labels', title='?'>reference_labels</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_indices', title='?'>nn_indices</a>)
<span class='lineno'> 215</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.k', title='int'>k</a> == 1:
<span class='lineno'> 216</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', title='?'>nn_labels</a> = tf.squeeze(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', title='?'>nn_labels</a>, axis=1)
<span class='lineno'> 217</span>   else:
<span class='lineno'> 218</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', title='None'>nn_labels</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.majority_vote', title='? -> None'>majority_vote</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', title='?'>nn_labels</a>)
<span class='lineno'> 219</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.height', title='?'>height</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_embeddings', title='?'>reference_embeddings</a>)[0]
<span class='lineno'> 220</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.width', title='?'>width</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.reference_embeddings', title='?'>reference_embeddings</a>)[1]
<span class='lineno'> 221</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.n_query_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.n_query_frames', title='?'>n_query_frames</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.query_embeddings', title='?'>query_embeddings</a>.shape[0]
<span class='lineno'> 222</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', title='?'>nn_labels</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', title='None'>nn_labels</a>, [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.n_query_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.n_query_frames', title='?'>n_query_frames</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.height', title='?'>height</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.width', title='?'>width</a>, 1])
<span class='lineno'> 223</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.assign_labels_by_nearest_neighbors.nn_labels', title='?'>nn_labels</a>
<span class='lineno'> 224</span> 
<span class='lineno'> 225</span> 
<span class='lineno'> 226</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances', title='(?, ?) -> int'>flattened_pairwise_distances</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.reference_embeddings', title='?'>reference_embeddings</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', title='?'>query_embeddings</a>):
<span class='lineno'> 227</span>   &quot;&quot;&quot;Calculates flattened tensor of pairwise distances between ref and query.
<span class='lineno'> 228</span> 
<span class='lineno'> 229</span>   Args:
<span class='lineno'> 230</span>     reference_embeddings: Tensor of shape [..., embedding_dim],
<span class='lineno'> 231</span>       the embedding vectors for the reference frame
<span class='lineno'> 232</span>     query_embeddings: Tensor of shape [n_query_images, height, width,
<span class='lineno'> 233</span>       embedding_dim], the embedding vectors for the query frames.
<span class='lineno'> 234</span> 
<span class='lineno'> 235</span>   Returns:
<span class='lineno'> 236</span>     A distance tensor of shape [reference_embeddings.size / embedding_dim,
<span class='lineno'> 237</span>     query_embeddings.size / embedding_dim]
<span class='lineno'> 238</span>   &quot;&quot;&quot;
<span class='lineno'> 239</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.embedding_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.embedding_dim', title='?'>embedding_dim</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', title='?'>query_embeddings</a>)[-1]
<span class='lineno'> 240</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.reference_embeddings', title='?'>reference_embeddings</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.reference_embeddings', title='?'>reference_embeddings</a>, [-1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.embedding_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.embedding_dim', title='?'>embedding_dim</a>])
<span class='lineno'> 241</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.first_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.first_dim', title='int'>first_dim</a> = -1
<span class='lineno'> 242</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', title='?'>query_embeddings</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', title='?'>query_embeddings</a>, [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.first_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.first_dim', title='int'>first_dim</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.embedding_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.embedding_dim', title='?'>embedding_dim</a>])
<span class='lineno'> 243</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.dists', title='int'>dists</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.pairwise_distances', title='(?, ?) -> int'>pairwise_distances</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.query_embeddings', title='?'>query_embeddings</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.reference_embeddings', title='?'>reference_embeddings</a>)
<span class='lineno'> 244</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances.dists', title='int'>dists</a>
<span class='lineno'> 245</span> 
<span class='lineno'> 246</span> 
<span class='lineno'> 247</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object', title='(?, ?, ?, ?, ?, None, int) -> (?, None) / (?, ?, ?, int, int, None, int) -> (?, None) / (?, ?, None, int, int, None, int) -> (?, None)'>nearest_neighbor_features_per_object</a>(
<span class='lineno'> 248</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings', title='?'>reference_embeddings</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings', title='?'>query_embeddings</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels', title='None'>reference_labels</a>,
<span class='lineno'> 249</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.max_neighbors_per_object', title='int'>max_neighbors_per_object</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>=None, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.n_chunks', title='int'>n_chunks</a>=100):
<span class='lineno'> 250</span>   &quot;&quot;&quot;Calculates the distance to the nearest neighbor per object.
<span class='lineno'> 251</span> 
<span class='lineno'> 252</span>   For every pixel of query_embeddings calculate the distance to the
<span class='lineno'> 253</span>   nearest neighbor in the (possibly subsampled) reference_embeddings per object.
<span class='lineno'> 254</span> 
<span class='lineno'> 255</span>   Args:
<span class='lineno'> 256</span>     reference_embeddings: Tensor of shape [height, width, embedding_dim],
<span class='lineno'> 257</span>       the embedding vectors for the reference frame.
<span class='lineno'> 258</span>     query_embeddings: Tensor of shape [n_query_images, height, width,
<span class='lineno'> 259</span>       embedding_dim], the embedding vectors for the query frames.
<span class='lineno'> 260</span>     reference_labels: Tensor of shape [height, width, 1], the class labels of
<span class='lineno'> 261</span>       the reference frame.
<span class='lineno'> 262</span>     max_neighbors_per_object: Integer, the maximum number of candidates
<span class='lineno'> 263</span>       for the nearest neighbor query per object after subsampling,
<span class='lineno'> 264</span>       or 0 for no subsampling.
<span class='lineno'> 265</span>     k_nearest_neighbors: Integer, the number of nearest neighbors to use.
<span class='lineno'> 266</span>     gt_ids: Int tensor of shape [n_objs] of the sorted unique ground truth
<span class='lineno'> 267</span>       ids in the first frame. If None, it will be derived from
<span class='lineno'> 268</span>       reference_labels.
<span class='lineno'> 269</span>     n_chunks: Integer, the number of chunks to use to save memory
<span class='lineno'> 270</span>       (set to 1 for no chunking).
<span class='lineno'> 271</span> 
<span class='lineno'> 272</span>   Returns:
<span class='lineno'> 273</span>     nn_features: A float32 tensor of nearest neighbor features of shape
<span class='lineno'> 274</span>       [n_query_images, height, width, n_objects, feature_dim].
<span class='lineno'> 275</span>     gt_ids: An int32 tensor of the unique sorted object ids present
<span class='lineno'> 276</span>       in the reference labels.
<span class='lineno'> 277</span>   &quot;&quot;&quot;
<span class='lineno'> 278</span>   with tf.name_scope(&#39;nn_features_per_object&#39;):
<span class='lineno'> 279</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', title='?'>reference_labels_flat</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels', title='None'>reference_labels</a>, [-1])
<span class='lineno'> 280</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a> is None:
<span class='lineno'> 281</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.ref_obj_ids', title='?'>ref_obj_ids</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object._', title='?'>_</a> = tf.unique(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', title='?'>reference_labels_flat</a>)
<span class='lineno'> 282</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.ref_obj_ids', title='?'>ref_obj_ids</a> = tf.contrib.framework.sort(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.ref_obj_ids', title='?'>ref_obj_ids</a>)
<span class='lineno'> 283</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', title='?'>gt_ids</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.ref_obj_ids', title='?'>ref_obj_ids</a>
<span class='lineno'> 284</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.embedding_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.embedding_dim', title='?'>embedding_dim</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings', title='?'>reference_embeddings</a>)[-1]
<span class='lineno'> 285</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings_flat', title='?'>reference_embeddings_flat</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings', title='?'>reference_embeddings</a>,
<span class='lineno'> 286</span>                                            [-1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.embedding_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.embedding_dim', title='?'>embedding_dim</a>])
<span class='lineno'> 287</span> 
<span class='lineno'> 288</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings_flat', title='?'>reference_embeddings_flat</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', title='?'>reference_labels_flat</a> = (
<span class='lineno'> 289</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels', title='(?, ?, None, ?) -> (?, ?) / (?, ?, ?, ?) -> (?, ?) / (?, ?, None, int) -> (?, ?)'>subsample_reference_embeddings_and_labels</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings_flat', title='?'>reference_embeddings_flat</a>,
<span class='lineno'> 290</span>                                                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', title='?'>reference_labels_flat</a>,
<span class='lineno'> 291</span>                                                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>,
<span class='lineno'> 292</span>                                                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.max_neighbors_per_object', title='int'>max_neighbors_per_object</a>))
<span class='lineno'> 293</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.shape', title='?'>shape</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings', title='?'>query_embeddings</a>)
<span class='lineno'> 294</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings_flat', title='?'>query_embeddings_flat</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings', title='?'>query_embeddings</a>, [-1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.embedding_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.embedding_dim', title='?'>embedding_dim</a>])
<span class='lineno'> 295</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features', title='None'>nn_features</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks', title='(?, ?, ?, None, ?, int) -> None / (?, ?, ?, None, int, int) -> None / (?, ?, ?, ?, ?, ?) -> None'>_nearest_neighbor_features_per_object_in_chunks</a>(
<span class='lineno'> 296</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_embeddings_flat', title='?'>reference_embeddings_flat</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.query_embeddings_flat', title='?'>query_embeddings_flat</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.reference_labels_flat', title='?'>reference_labels_flat</a>,
<span class='lineno'> 297</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.n_chunks', title='int'>n_chunks</a>)
<span class='lineno'> 298</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features_dim', title='?'>nn_features_dim</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features', title='None'>nn_features</a>)[-1]
<span class='lineno'> 299</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features_reshaped', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features_reshaped', title='?'>nn_features_reshaped</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features', title='None'>nn_features</a>,
<span class='lineno'> 300</span>                                       tf.stack(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.shape', title='?'>shape</a>[:3] + [tf.size(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>),
<span class='lineno'> 301</span>                                                             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features_dim', title='?'>nn_features_dim</a>]))
<span class='lineno'> 302</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features_reshaped', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.nn_features_reshaped', title='?'>nn_features_reshaped</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>
<span class='lineno'> 303</span> 
<span class='lineno'> 304</span> 
<span class='lineno'> 305</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks', title='(?, ?, ?, None, ?, int) -> None / (?, ?, ?, None, int, int) -> None / (?, ?, ?, ?, ?, ?) -> None'>_nearest_neighbor_features_per_object_in_chunks</a>(
<span class='lineno'> 306</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.reference_embeddings_flat', title='?'>reference_embeddings_flat</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat', title='?'>query_embeddings_flat</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.reference_labels_flat', title='?'>reference_labels_flat</a>,
<span class='lineno'> 307</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.ref_obj_ids', title='None'>ref_obj_ids</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', title='int'>n_chunks</a>):
<span class='lineno'> 308</span>   &quot;&quot;&quot;Calculates the nearest neighbor features per object in chunks to save mem.
<span class='lineno'> 309</span> 
<span class='lineno'> 310</span>   Uses chunking to bound the memory use.
<span class='lineno'> 311</span> 
<span class='lineno'> 312</span>   Args:
<span class='lineno'> 313</span>     reference_embeddings_flat: Tensor of shape [n, embedding_dim],
<span class='lineno'> 314</span>       the embedding vectors for the reference frame.
<span class='lineno'> 315</span>     query_embeddings_flat: Tensor of shape [m, embedding_dim], the embedding
<span class='lineno'> 316</span>       vectors for the query frames.
<span class='lineno'> 317</span>     reference_labels_flat: Tensor of shape [n], the class labels of the
<span class='lineno'> 318</span>       reference frame.
<span class='lineno'> 319</span>     ref_obj_ids: int tensor of unique object ids in the reference labels.
<span class='lineno'> 320</span>     k_nearest_neighbors: Integer, the number of nearest neighbors to use.
<span class='lineno'> 321</span>     n_chunks: Integer, the number of chunks to use to save memory
<span class='lineno'> 322</span>       (set to 1 for no chunking).
<span class='lineno'> 323</span> 
<span class='lineno'> 324</span>   Returns:
<span class='lineno'> 325</span>     nn_features: A float32 tensor of nearest neighbor features of shape
<span class='lineno'> 326</span>       [m, n_objects, feature_dim].
<span class='lineno'> 327</span>   &quot;&quot;&quot;
<span class='lineno'> 328</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_size', title='?'>chunk_size</a> = tf.cast(tf.ceil(tf.cast(tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat', title='?'>query_embeddings_flat</a>)[0],
<span class='lineno'> 329</span>                                        tf.float32) / <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', title='int'>n_chunks</a>), tf.int32)
<span class='lineno'> 330</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.wrong_label_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.wrong_label_mask', title='?'>wrong_label_mask</a> = tf.not_equal(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.reference_labels_flat', title='?'>reference_labels_flat</a>,
<span class='lineno'> 331</span>                                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.ref_obj_ids', title='None'>ref_obj_ids</a>[:, tf.newaxis])
<span class='lineno'> 332</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', title='[None]'>all_features</a> = []
<span class='lineno'> 333</span>   for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n', title='int'>n</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', title='int'>n_chunks</a>):
<span class='lineno'> 334</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', title='int'>n_chunks</a> == 1:
<span class='lineno'> 335</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat_chunk', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat_chunk', title='?'>query_embeddings_flat_chunk</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat', title='?'>query_embeddings_flat</a>
<span class='lineno'> 336</span>     else:
<span class='lineno'> 337</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_start', title='int'>chunk_start</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n', title='int'>n</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_size', title='?'>chunk_size</a>
<span class='lineno'> 338</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_end', title='int'>chunk_end</a> = (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n', title='int'>n</a> + 1) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_size', title='?'>chunk_size</a>
<span class='lineno'> 339</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat_chunk', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat_chunk', title='?'>query_embeddings_flat_chunk</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat', title='?'>query_embeddings_flat</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_start', title='int'>chunk_start</a>:<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.chunk_end', title='int'>chunk_end</a>]
<span class='lineno'> 340</span>     # Use control dependencies to make sure that the chunks are not processed
<span class='lineno'> 341</span>     # in parallel which would prevent any peak memory savings.
<span class='lineno'> 342</span>     with tf.control_dependencies(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', title='[None]'>all_features</a>):
<span class='lineno'> 343</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.features', title='None'>features</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk', title='(?, ?, ?, ?) -> None / (?, ?, ?, int) -> None'>_nn_features_per_object_for_chunk</a>(
<span class='lineno'> 344</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.reference_embeddings_flat', title='?'>reference_embeddings_flat</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat_chunk', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.query_embeddings_flat_chunk', title='?'>query_embeddings_flat_chunk</a>,
<span class='lineno'> 345</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.wrong_label_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.wrong_label_mask', title='?'>wrong_label_mask</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>
<span class='lineno'> 346</span>       )
<span class='lineno'> 347</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', title='[None]'>all_features</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.features', title='None'>features</a>)
<span class='lineno'> 348</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.n_chunks', title='int'>n_chunks</a> == 1:
<span class='lineno'> 349</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.nn_features', title='None'>nn_features</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', title='[None]'>all_features</a>[0]
<span class='lineno'> 350</span>   else:
<span class='lineno'> 351</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.nn_features', title='?'>nn_features</a> = tf.concat(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.all_features', title='[None]'>all_features</a>, axis=0)
<span class='lineno'> 352</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nearest_neighbor_features_per_object_in_chunks.nn_features', title='None'>nn_features</a>
<span class='lineno'> 353</span> 
<span class='lineno'> 354</span> 
<span class='lineno'> 355</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk', title='(?, ?, ?, ?) -> None / (?, ?, ?, int) -> None'>_nn_features_per_object_for_chunk</a>(
<span class='lineno'> 356</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.reference_embeddings', title='?'>reference_embeddings</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.query_embeddings', title='?'>query_embeddings</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.wrong_label_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.wrong_label_mask', title='?'>wrong_label_mask</a>,
<span class='lineno'> 357</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>):
<span class='lineno'> 358</span>   &quot;&quot;&quot;Extracts features for each object using nearest neighbor attention.
<span class='lineno'> 359</span> 
<span class='lineno'> 360</span>   Args:
<span class='lineno'> 361</span>     reference_embeddings: Tensor of shape [n_chunk, embedding_dim],
<span class='lineno'> 362</span>       the embedding vectors for the reference frame.
<span class='lineno'> 363</span>     query_embeddings: Tensor of shape [m_chunk, embedding_dim], the embedding
<span class='lineno'> 364</span>       vectors for the query frames.
<span class='lineno'> 365</span>     wrong_label_mask:
<span class='lineno'> 366</span>     k_nearest_neighbors: Integer, the number of nearest neighbors to use.
<span class='lineno'> 367</span> 
<span class='lineno'> 368</span>   Returns:
<span class='lineno'> 369</span>     nn_features: A float32 tensor of nearest neighbor features of shape
<span class='lineno'> 370</span>       [m_chunk, n_objects, feature_dim].
<span class='lineno'> 371</span>   &quot;&quot;&quot;
<span class='lineno'> 372</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.reference_embeddings_key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.reference_embeddings_key', title='?'>reference_embeddings_key</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.reference_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.reference_embeddings', title='?'>reference_embeddings</a>
<span class='lineno'> 373</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.query_embeddings_key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.query_embeddings_key', title='?'>query_embeddings_key</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.query_embeddings', title='?'>query_embeddings</a>
<span class='lineno'> 374</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='int'>dists</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.flattened_pairwise_distances', title='(?, ?) -> int'>flattened_pairwise_distances</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.reference_embeddings_key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.reference_embeddings_key', title='?'>reference_embeddings_key</a>,
<span class='lineno'> 375</span>                                        <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.query_embeddings_key', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.query_embeddings_key', title='?'>query_embeddings_key</a>)
<span class='lineno'> 376</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='float'>dists</a> = (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='int'>dists</a>[:, tf.newaxis, :] +
<span class='lineno'> 377</span>            tf.cast(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.wrong_label_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.wrong_label_mask', title='?'>wrong_label_mask</a>[tf.newaxis, :, :], tf.float32) *
<span class='lineno'> 378</span>            <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.WRONG_LABEL_PADDING_DISTANCE', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.WRONG_LABEL_PADDING_DISTANCE', title='float'>WRONG_LABEL_PADDING_DISTANCE</a>)
<span class='lineno'> 379</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.k_nearest_neighbors', title='int'>k_nearest_neighbors</a> == 1:
<span class='lineno'> 380</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.features', title='?'>features</a> = tf.reduce_min(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='float'>dists</a>, axis=2, keepdims=True)
<span class='lineno'> 381</span>   else:
<span class='lineno'> 382</span>     # Find the closest k and combine them according to attention_feature_type
<span class='lineno'> 383</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='?'>dists</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk._', title='?'>_</a> = tf.nn.top_k(-<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='float'>dists</a>, k=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>)
<span class='lineno'> 384</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='?'>dists</a> = -<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='?'>dists</a>
<span class='lineno'> 385</span>     # If not enough real neighbors were found, pad with the farthest real
<span class='lineno'> 386</span>     # neighbor.
<span class='lineno'> 387</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.valid_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.valid_mask', title='?'>valid_mask</a> = tf.less(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='?'>dists</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.WRONG_LABEL_PADDING_DISTANCE', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.WRONG_LABEL_PADDING_DISTANCE', title='float'>WRONG_LABEL_PADDING_DISTANCE</a>)
<span class='lineno'> 388</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.masked_dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.masked_dists', title='?'>masked_dists</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='?'>dists</a> * tf.cast(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.valid_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.valid_mask', title='?'>valid_mask</a>, tf.float32)
<span class='lineno'> 389</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.pad_dist', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.pad_dist', title='?'>pad_dist</a> = tf.tile(tf.reduce_max(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.masked_dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.masked_dists', title='?'>masked_dists</a>, axis=2)[..., tf.newaxis],
<span class='lineno'> 390</span>                        multiples=[1, 1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>])
<span class='lineno'> 391</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='?'>dists</a> = tf.where(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.valid_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.valid_mask', title='?'>valid_mask</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='?'>dists</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.pad_dist', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.pad_dist', title='?'>pad_dist</a>)
<span class='lineno'> 392</span>     # take mean of distances
<span class='lineno'> 393</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.features', title='?'>features</a> = tf.reduce_mean(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.dists', title='?'>dists</a>, axis=2, keepdims=True)
<span class='lineno'> 394</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._nn_features_per_object_for_chunk.features', title='?'>features</a>
<span class='lineno'> 395</span> 
<span class='lineno'> 396</span> 
<span class='lineno'> 397</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features', title='(?, int, int, int, bool, None) -> None / (?, ?, ?, ?, ?, None) -> None'>create_embedding_segmentation_features</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.features', title='?'>features</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.feature_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.feature_dimension', title='int'>feature_dimension</a>,
<span class='lineno'> 398</span>                                            <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n_layers', title='int'>n_layers</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.kernel_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.kernel_size', title='int'>kernel_size</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.reuse', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.reuse', title='bool'>reuse</a>,
<span class='lineno'> 399</span>                                            <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', title='None'>atrous_rates</a>=None):
<span class='lineno'> 400</span>   &quot;&quot;&quot;Extracts features which can be used to estimate the final segmentation.
<span class='lineno'> 401</span> 
<span class='lineno'> 402</span>   Args:
<span class='lineno'> 403</span>     features: input features of shape [batch, height, width, features]
<span class='lineno'> 404</span>     feature_dimension: Integer, the dimensionality used in the segmentation
<span class='lineno'> 405</span>       head layers.
<span class='lineno'> 406</span>     n_layers: Integer, the number of layers in the segmentation head.
<span class='lineno'> 407</span>     kernel_size: Integer, the kernel size used in the segmentation head.
<span class='lineno'> 408</span>     reuse: reuse mode for the variable_scope.
<span class='lineno'> 409</span>     atrous_rates: List of integers of length n_layers, the atrous rates to use.
<span class='lineno'> 410</span> 
<span class='lineno'> 411</span>   Returns:
<span class='lineno'> 412</span>     Features to be used to estimate the segmentation labels of shape
<span class='lineno'> 413</span>       [batch, height, width, embedding_seg_feat_dim].
<span class='lineno'> 414</span>   &quot;&quot;&quot;
<span class='lineno'> 415</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', title='None'>atrous_rates</a> is None or not <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', title='None'>atrous_rates</a>:
<span class='lineno'> 416</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', title='[int]'>atrous_rates</a> = [1 for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features._', title='int'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features._', title='int'>_</a></a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n_layers', title='int'>n_layers</a>)]
<span class='lineno'> 417</span>   assert len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', title='[int]'>atrous_rates</a>) == <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n_layers', title='int'>n_layers</a>
<span class='lineno'> 418</span>   with tf.variable_scope(&#39;embedding_seg&#39;, reuse=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.reuse', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.reuse', title='bool'>reuse</a>):
<span class='lineno'> 419</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n', title='int'>n</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n_layers', title='int'>n_layers</a>):
<span class='lineno'> 420</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.features', title='?'>features</a> = model.split_separable_conv2d(
<span class='lineno'> 421</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.features', title='?'>features</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.feature_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.feature_dimension', title='int'>feature_dimension</a>, kernel_size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.kernel_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.kernel_size', title='int'>kernel_size</a>,
<span class='lineno'> 422</span>           rate=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.atrous_rates', title='[int]'>atrous_rates</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n', title='int'>n</a>], scope=&#39;split_separable_conv2d_{}&#39;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.n', title='int'>n</a>))
<span class='lineno'> 423</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features.features', title='?'>features</a>
<span class='lineno'> 424</span> 
<span class='lineno'> 425</span> 
<span class='lineno'> 426</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries', title='(?, ?, ?, ?, None) -> None / (?, float, ?, int, None) -> None'>add_image_summaries</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.images', title='?'>images</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.nn_features', title='float'>nn_features</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.logits', title='?'>logits</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', title='int'>batch_size</a>,
<span class='lineno'> 427</span>                         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', title='None'>prev_frame_nn_features</a>=None):
<span class='lineno'> 428</span>   &quot;&quot;&quot;Adds image summaries of input images, attention features and logits.
<span class='lineno'> 429</span> 
<span class='lineno'> 430</span>   Args:
<span class='lineno'> 431</span>     images: Image tensor of shape [batch, height, width, channels].
<span class='lineno'> 432</span>     nn_features: Nearest neighbor attention features of shape
<span class='lineno'> 433</span>       [batch_size, height, width, n_objects, 1].
<span class='lineno'> 434</span>     logits: Float32 tensor of logits.
<span class='lineno'> 435</span>     batch_size: Integer, the number of videos per clone per mini-batch.
<span class='lineno'> 436</span>     prev_frame_nn_features: Nearest neighbor attention features wrt. the
<span class='lineno'> 437</span>       last frame of shape [batch_size, height, width, n_objects, 1].
<span class='lineno'> 438</span>       Can be None.
<span class='lineno'> 439</span>   &quot;&quot;&quot;
<span class='lineno'> 440</span>   # Separate reference and query images.
<span class='lineno'> 441</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reshaped_images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reshaped_images', title='?'>reshaped_images</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.images', title='?'>images</a>, tf.stack(
<span class='lineno'> 442</span>       [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', title='int'>batch_size</a>, -1] + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.images', title='?'>images</a>)[1:]))
<span class='lineno'> 443</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reference_images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reference_images', title='?'>reference_images</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reshaped_images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reshaped_images', title='?'>reshaped_images</a>[:, 0]
<span class='lineno'> 444</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.query_images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.query_images', title='?'>query_images</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reshaped_images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reshaped_images', title='?'>reshaped_images</a>[:, 1:]
<span class='lineno'> 445</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.query_images_reshaped', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.query_images_reshaped', title='?'>query_images_reshaped</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.query_images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.query_images', title='?'>query_images</a>, tf.stack(
<span class='lineno'> 446</span>       [-1] + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.images', title='?'>images</a>)[1:]))
<span class='lineno'> 447</span>   tf.summary.image(&#39;ref_images&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reference_images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.reference_images', title='?'>reference_images</a>, max_outputs=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', title='int'>batch_size</a>)
<span class='lineno'> 448</span>   tf.summary.image(&#39;query_images&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.query_images_reshaped', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.query_images_reshaped', title='?'>query_images_reshaped</a>, max_outputs=10)
<span class='lineno'> 449</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.predictions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.predictions', title='?'>predictions</a> = tf.cast(
<span class='lineno'> 450</span>       tf.argmax(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.logits', title='?'>logits</a>, axis=-1), tf.uint8)[..., tf.newaxis]
<span class='lineno'> 451</span>   # Scale up so that we can actually see something.
<span class='lineno'> 452</span>   tf.summary.image(&#39;predictions&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.predictions', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.predictions', title='?'>predictions</a> * 32, max_outputs=10)
<span class='lineno'> 453</span>   # We currently only show the first dimension of the features for background
<span class='lineno'> 454</span>   # and the first foreground object.
<span class='lineno'> 455</span>   tf.summary.image(&#39;nn_fg_features&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.nn_features', title='float'>nn_features</a>[..., 0:1, 0],
<span class='lineno'> 456</span>                    max_outputs=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', title='int'>batch_size</a>)
<span class='lineno'> 457</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', title='None'>prev_frame_nn_features</a> is not None:
<span class='lineno'> 458</span>     tf.summary.image(&#39;nn_fg_features_prev&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', title='None'>prev_frame_nn_features</a>[..., 0:1, 0],
<span class='lineno'> 459</span>                      max_outputs=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', title='int'>batch_size</a>)
<span class='lineno'> 460</span>   tf.summary.image(&#39;nn_bg_features&#39;, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.nn_features', title='float'>nn_features</a>[..., 1:2, 0],
<span class='lineno'> 461</span>                    max_outputs=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', title='int'>batch_size</a>)
<span class='lineno'> 462</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', title='None'>prev_frame_nn_features</a> is not None:
<span class='lineno'> 463</span>     tf.summary.image(&#39;nn_bg_features_prev&#39;,
<span class='lineno'> 464</span>                      <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.prev_frame_nn_features', title='None'>prev_frame_nn_features</a>[..., 1:2, 0],
<span class='lineno'> 465</span>                      max_outputs=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries.batch_size', title='int'>batch_size</a>)
<span class='lineno'> 466</span> 
<span class='lineno'> 467</span> 
<span class='lineno'> 468</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings', title='(?, ?, ?) -> None'>get_embeddings</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.images', title='?'>images</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', title='?'>model_options</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.embedding_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.embedding_dimension', title='?'>embedding_dimension</a>):
<span class='lineno'> 469</span>   &quot;&quot;&quot;Extracts embedding vectors for images. Should only be used for inference.
<span class='lineno'> 470</span> 
<span class='lineno'> 471</span>   Args:
<span class='lineno'> 472</span>     images: A tensor of shape [batch, height, width, channels].
<span class='lineno'> 473</span>     model_options: A ModelOptions instance to configure models.
<span class='lineno'> 474</span>     embedding_dimension: Integer, the dimension of the embedding.
<span class='lineno'> 475</span> 
<span class='lineno'> 476</span>   Returns:
<span class='lineno'> 477</span>     embeddings: A tensor of shape [batch, height, width, embedding_dimension].
<span class='lineno'> 478</span>   &quot;&quot;&quot;
<span class='lineno'> 479</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.features', title='?'>features</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.end_points', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.end_points', title='?'>end_points</a> = model.extract_features(
<span class='lineno'> 480</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.images', title='?'>images</a>,
<span class='lineno'> 481</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', title='?'>model_options</a>,
<span class='lineno'> 482</span>       is_training=False)
<span class='lineno'> 483</span> 
<span class='lineno'> 484</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', title='?'>model_options</a>.decoder_output_stride is not None:
<span class='lineno'> 485</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.decoder_output_stride', title='int'>decoder_output_stride</a> = min(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', title='?'>model_options</a>.decoder_output_stride)
<span class='lineno'> 486</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', title='?'>model_options</a>.crop_size is None:
<span class='lineno'> 487</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.height', title='?'>height</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.images', title='?'>images</a>)[1]
<span class='lineno'> 488</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.width', title='?'>width</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.images', title='?'>images</a>)[2]
<span class='lineno'> 489</span>     else:
<span class='lineno'> 490</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.height', title='?'>height</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.width', title='?'>width</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', title='?'>model_options</a>.crop_size
<span class='lineno'> 491</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.features', title='?'>features</a> = model.refine_by_decoder(
<span class='lineno'> 492</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.features', title='?'>features</a>,
<span class='lineno'> 493</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.end_points', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.end_points', title='?'>end_points</a>,
<span class='lineno'> 494</span>         crop_size=[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.height', title='?'>height</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.width', title='?'>width</a>],
<span class='lineno'> 495</span>         decoder_output_stride=[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.decoder_output_stride', title='int'>decoder_output_stride</a>],
<span class='lineno'> 496</span>         decoder_use_separable_conv=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', title='?'>model_options</a>.decoder_use_separable_conv,
<span class='lineno'> 497</span>         model_variant=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.model_options', title='?'>model_options</a>.model_variant,
<span class='lineno'> 498</span>         is_training=False)
<span class='lineno'> 499</span> 
<span class='lineno'> 500</span>   with tf.variable_scope(&#39;embedding&#39;):
<span class='lineno'> 501</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.embeddings', title='None'>embeddings</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer', title='(?, None, int, int, float, None) -> None / (?, ?, int, int, float, None) -> None'>split_separable_conv2d_with_identity_initializer</a>(
<span class='lineno'> 502</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.features', title='?'>features</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.embedding_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.embedding_dimension', title='?'>embedding_dimension</a>, scope=&#39;split_separable_conv2d&#39;)
<span class='lineno'> 503</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_embeddings.embeddings', title='None'>embeddings</a>
<span class='lineno'> 504</span> 
<span class='lineno'> 505</span> 
<span class='lineno'> 506</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching', title='(?, ?, float, None, bool, bool, None, None, None, None, int, int, bool, None, int, int, int, None, bool, bool, bool, bool, int, bool, bool, None) -> {(dict, ?) | dict}'>get_logits_with_matching</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', title='?'>images</a>,
<span class='lineno'> 507</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>,
<span class='lineno'> 508</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.weight_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.weight_decay', title='float'>weight_decay</a>=0.0001,
<span class='lineno'> 509</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', title='None'>reuse</a>=None,
<span class='lineno'> 510</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.is_training', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.is_training', title='bool'>is_training</a>=False,
<span class='lineno'> 511</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.fine_tune_batch_norm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.fine_tune_batch_norm', title='bool'>fine_tune_batch_norm</a>=False,
<span class='lineno'> 512</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_labels', title='None'>reference_labels</a>=None,
<span class='lineno'> 513</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', title='None'>batch_size</a>=None,
<span class='lineno'> 514</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', title='None'>num_frames_per_video</a>=None,
<span class='lineno'> 515</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_dimension', title='None'>embedding_dimension</a>=None,
<span class='lineno'> 516</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.max_neighbors_per_object', title='int'>max_neighbors_per_object</a>=0,
<span class='lineno'> 517</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>=1,
<span class='lineno'> 518</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', title='bool'>use_softmax_feedback</a>=True,
<span class='lineno'> 519</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback', title='None'>initial_softmax_feedback</a>=None,
<span class='lineno'> 520</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_feature_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_feature_dimension', title='int'>embedding_seg_feature_dimension</a>=256,
<span class='lineno'> 521</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_n_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_n_layers', title='int'>embedding_seg_n_layers</a>=4,
<span class='lineno'> 522</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_kernel_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_kernel_size', title='int'>embedding_seg_kernel_size</a>=7,
<span class='lineno'> 523</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_atrous_rates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_atrous_rates', title='None'>embedding_seg_atrous_rates</a>=None,
<span class='lineno'> 524</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.normalize_nearest_neighbor_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.normalize_nearest_neighbor_distances', title='bool'>normalize_nearest_neighbor_distances</a>=True,
<span class='lineno'> 525</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', title='bool'>also_attend_to_previous_frame</a>=True,
<span class='lineno'> 526</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.damage_initial_previous_frame_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.damage_initial_previous_frame_mask', title='bool'>damage_initial_previous_frame_mask</a>=False,
<span class='lineno'> 527</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_local_previous_frame_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_local_previous_frame_attention', title='bool'>use_local_previous_frame_attention</a>=True,
<span class='lineno'> 528</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.previous_frame_attention_window_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.previous_frame_attention_window_size', title='int'>previous_frame_attention_window_size</a>=15,
<span class='lineno'> 529</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_first_frame_matching', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_first_frame_matching', title='bool'>use_first_frame_matching</a>=True,
<span class='lineno'> 530</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_return_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_return_embeddings', title='bool'>also_return_embeddings</a>=False,
<span class='lineno'> 531</span>                              <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', title='None'>ref_embeddings</a>=None):
<span class='lineno'> 532</span>   &quot;&quot;&quot;Gets the logits by atrous/image spatial pyramid pooling using attention.
<span class='lineno'> 533</span> 
<span class='lineno'> 534</span>   Args:
<span class='lineno'> 535</span>     images: A tensor of size [batch, height, width, channels].
<span class='lineno'> 536</span>     model_options: A ModelOptions instance to configure models.
<span class='lineno'> 537</span>     weight_decay: The weight decay for model variables.
<span class='lineno'> 538</span>     reuse: Reuse the model variables or not.
<span class='lineno'> 539</span>     is_training: Is training or not.
<span class='lineno'> 540</span>     fine_tune_batch_norm: Fine-tune the batch norm parameters or not.
<span class='lineno'> 541</span>     reference_labels: The segmentation labels of the reference frame on which
<span class='lineno'> 542</span>       attention is applied.
<span class='lineno'> 543</span>     batch_size: Integer, the number of videos on a batch
<span class='lineno'> 544</span>     num_frames_per_video: Integer, the number of frames per video
<span class='lineno'> 545</span>     embedding_dimension: Integer, the dimension of the embedding
<span class='lineno'> 546</span>     max_neighbors_per_object: Integer, the maximum number of candidates
<span class='lineno'> 547</span>       for the nearest neighbor query per object after subsampling.
<span class='lineno'> 548</span>       Can be 0 for no subsampling.
<span class='lineno'> 549</span>     k_nearest_neighbors: Integer, the number of nearest neighbors to use.
<span class='lineno'> 550</span>     use_softmax_feedback: Boolean, whether to give the softmax predictions of
<span class='lineno'> 551</span>       the last frame as additional input to the segmentation head.
<span class='lineno'> 552</span>     initial_softmax_feedback: List of Float32 tensors, or None. Can be used to
<span class='lineno'> 553</span>       initialize the softmax predictions used for the feedback loop.
<span class='lineno'> 554</span>       Only has an effect if use_softmax_feedback is True.
<span class='lineno'> 555</span>     embedding_seg_feature_dimension: Integer, the dimensionality used in the
<span class='lineno'> 556</span>       segmentation head layers.
<span class='lineno'> 557</span>     embedding_seg_n_layers: Integer, the number of layers in the segmentation
<span class='lineno'> 558</span>       head.
<span class='lineno'> 559</span>     embedding_seg_kernel_size: Integer, the kernel size used in the
<span class='lineno'> 560</span>       segmentation head.
<span class='lineno'> 561</span>     embedding_seg_atrous_rates: List of integers of length
<span class='lineno'> 562</span>       embedding_seg_n_layers, the atrous rates to use for the segmentation head.
<span class='lineno'> 563</span>     normalize_nearest_neighbor_distances: Boolean, whether to normalize the
<span class='lineno'> 564</span>       nearest neighbor distances to [0,1] using sigmoid, scale and shift.
<span class='lineno'> 565</span>     also_attend_to_previous_frame: Boolean, whether to also use nearest
<span class='lineno'> 566</span>       neighbor attention with respect to the previous frame.
<span class='lineno'> 567</span>     damage_initial_previous_frame_mask: Boolean, whether to artificially damage
<span class='lineno'> 568</span>       the initial previous frame mask. Only has an effect if
<span class='lineno'> 569</span>       also_attend_to_previous_frame is True.
<span class='lineno'> 570</span>     use_local_previous_frame_attention: Boolean, whether to restrict the
<span class='lineno'> 571</span>       previous frame attention to a local search window.
<span class='lineno'> 572</span>       Only has an effect, if also_attend_to_previous_frame is True.
<span class='lineno'> 573</span>     previous_frame_attention_window_size: Integer, the window size used for
<span class='lineno'> 574</span>       local previous frame attention, if use_local_previous_frame_attention
<span class='lineno'> 575</span>       is True.
<span class='lineno'> 576</span>     use_first_frame_matching: Boolean, whether to extract features by matching
<span class='lineno'> 577</span>       to the reference frame. This should always be true except for ablation
<span class='lineno'> 578</span>       experiments.
<span class='lineno'> 579</span>     also_return_embeddings: Boolean, whether to return the embeddings as well.
<span class='lineno'> 580</span>     ref_embeddings: Tuple of
<span class='lineno'> 581</span>       (first_frame_embeddings, previous_frame_embeddings),
<span class='lineno'> 582</span>       each of shape [batch, height, width, embedding_dimension], or None.
<span class='lineno'> 583</span>   Returns:
<span class='lineno'> 584</span>     outputs_to_logits: A map from output_type to logits.
<span class='lineno'> 585</span>     If also_return_embeddings is True, it will also return an embeddings
<span class='lineno'> 586</span>       tensor of shape [batch, height, width, embedding_dimension].
<span class='lineno'> 587</span>   &quot;&quot;&quot;
<span class='lineno'> 588</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.end_points', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.end_points', title='?'>end_points</a> = model.extract_features(
<span class='lineno'> 589</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', title='?'>images</a>,
<span class='lineno'> 590</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>,
<span class='lineno'> 591</span>       weight_decay=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.weight_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.weight_decay', title='float'>weight_decay</a>,
<span class='lineno'> 592</span>       reuse=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', title='None'>reuse</a>,
<span class='lineno'> 593</span>       is_training=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.is_training', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.is_training', title='bool'>is_training</a>,
<span class='lineno'> 594</span>       fine_tune_batch_norm=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.fine_tune_batch_norm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.fine_tune_batch_norm', title='bool'>fine_tune_batch_norm</a>)
<span class='lineno'> 595</span> 
<span class='lineno'> 596</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.decoder_output_stride:
<span class='lineno'> 597</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_output_stride', title='int'>decoder_output_stride</a> = min(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.decoder_output_stride)
<span class='lineno'> 598</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.crop_size is None:
<span class='lineno'> 599</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.height', title='?'>height</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', title='?'>images</a>)[1]
<span class='lineno'> 600</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.width', title='?'>width</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', title='?'>images</a>)[2]
<span class='lineno'> 601</span>     else:
<span class='lineno'> 602</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.height', title='?'>height</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.width', title='?'>width</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.crop_size
<span class='lineno'> 603</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_height', title='?'>decoder_height</a> = model.scale_dimension(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.height', title='?'>height</a>, 1.0 / <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_output_stride', title='int'>decoder_output_stride</a>)
<span class='lineno'> 604</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_width', title='?'>decoder_width</a> = model.scale_dimension(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.width', title='?'>width</a>, 1.0 / <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_output_stride', title='int'>decoder_output_stride</a>)
<span class='lineno'> 605</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a> = model.refine_by_decoder(
<span class='lineno'> 606</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a>,
<span class='lineno'> 607</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.end_points', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.end_points', title='?'>end_points</a>,
<span class='lineno'> 608</span>         crop_size=[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.height', title='?'>height</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.width', title='?'>width</a>],
<span class='lineno'> 609</span>         decoder_output_stride=[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_output_stride', title='int'>decoder_output_stride</a>],
<span class='lineno'> 610</span>         decoder_use_separable_conv=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.decoder_use_separable_conv,
<span class='lineno'> 611</span>         model_variant=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.model_variant,
<span class='lineno'> 612</span>         weight_decay=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.weight_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.weight_decay', title='float'>weight_decay</a>,
<span class='lineno'> 613</span>         reuse=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', title='None'>reuse</a>,
<span class='lineno'> 614</span>         is_training=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.is_training', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.is_training', title='bool'>is_training</a>,
<span class='lineno'> 615</span>         fine_tune_batch_norm=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.fine_tune_batch_norm', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.fine_tune_batch_norm', title='bool'>fine_tune_batch_norm</a>)
<span class='lineno'> 616</span> 
<span class='lineno'> 617</span>   with tf.variable_scope(&#39;embedding&#39;, reuse=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', title='None'>reuse</a>):
<span class='lineno'> 618</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', title='None'>embeddings</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer', title='(?, None, int, int, float, None) -> None / (?, ?, int, int, float, None) -> None'>split_separable_conv2d_with_identity_initializer</a>(
<span class='lineno'> 619</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_dimension', title='None'>embedding_dimension</a>, scope=&#39;split_separable_conv2d&#39;)
<span class='lineno'> 620</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', title='?'>embeddings</a> = tf.identity(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', title='None'>embeddings</a>, name=&#39;embeddings&#39;)
<span class='lineno'> 621</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.scaled_reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.scaled_reference_labels', title='?'>scaled_reference_labels</a> = tf.image.resize_nearest_neighbor(
<span class='lineno'> 622</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_labels', title='None'>reference_labels</a>,
<span class='lineno'> 623</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', title='?'>embeddings</a>, 4)[1:3],
<span class='lineno'> 624</span>       align_corners=True)
<span class='lineno'> 625</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', title='?'>h</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', title='?'>w</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_height', title='?'>decoder_height</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.decoder_width', title='?'>decoder_width</a>
<span class='lineno'> 626</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', title='None'>num_frames_per_video</a> is None:
<span class='lineno'> 627</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', title='None'>num_frames_per_video</a> = tf.size(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', title='?'>embeddings</a>) // (
<span class='lineno'> 628</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', title='None'>batch_size</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', title='?'>h</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', title='?'>w</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_dimension', title='None'>embedding_dimension</a>)
<span class='lineno'> 629</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.new_labels_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.new_labels_shape', title='?'>new_labels_shape</a> = tf.stack([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', title='None'>batch_size</a>, -1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', title='?'>h</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', title='?'>w</a>, 1])
<span class='lineno'> 630</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_reference_labels', title='?'>reshaped_reference_labels</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.scaled_reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.scaled_reference_labels', title='?'>scaled_reference_labels</a>,
<span class='lineno'> 631</span>                                          <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.new_labels_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.new_labels_shape', title='?'>new_labels_shape</a>)
<span class='lineno'> 632</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.new_embeddings_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.new_embeddings_shape', title='?'>new_embeddings_shape</a> = tf.stack([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', title='None'>batch_size</a>,
<span class='lineno'> 633</span>                                    <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', title='None'>num_frames_per_video</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', title='?'>h</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', title='?'>w</a>,
<span class='lineno'> 634</span>                                    <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_dimension', title='None'>embedding_dimension</a>])
<span class='lineno'> 635</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_embeddings', title='?'>reshaped_embeddings</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', title='?'>embeddings</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.new_embeddings_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.new_embeddings_shape', title='?'>new_embeddings_shape</a>)
<span class='lineno'> 636</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_nn_features', title='[float]'>all_nn_features</a> = []
<span class='lineno'> 637</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_ref_obj_ids', title='[None]'>all_ref_obj_ids</a> = []
<span class='lineno'> 638</span>   # To keep things simple, we do all this separate for each sequence for now.
<span class='lineno'> 639</span>   for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', title='None'>batch_size</a>):
<span class='lineno'> 640</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', title='?'>embedding</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_embeddings', title='?'>reshaped_embeddings</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>]
<span class='lineno'> 641</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', title='None'>ref_embeddings</a> is None:
<span class='lineno'> 642</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_chunks', title='int'>n_chunks</a> = 100
<span class='lineno'> 643</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_embedding', title='?'>reference_embedding</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', title='?'>embedding</a>[0]
<span class='lineno'> 644</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', title='bool'>also_attend_to_previous_frame</a> or <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', title='bool'>use_softmax_feedback</a>:
<span class='lineno'> 645</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.queries_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.queries_embedding', title='?'>queries_embedding</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', title='?'>embedding</a>[2:]
<span class='lineno'> 646</span>       else:
<span class='lineno'> 647</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.queries_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.queries_embedding', title='?'>queries_embedding</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', title='?'>embedding</a>[1:]
<span class='lineno'> 648</span>     else:
<span class='lineno'> 649</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', title='bool'>USE_CORRELATION_COST</a>:
<span class='lineno'> 650</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_chunks', title='int'>n_chunks</a> = 20
<span class='lineno'> 651</span>       else:
<span class='lineno'> 652</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_chunks', title='int'>n_chunks</a> = 500
<span class='lineno'> 653</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_embedding', title='?'>reference_embedding</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', title='None'>ref_embeddings</a>[0][<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>]
<span class='lineno'> 654</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.queries_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.queries_embedding', title='?'>queries_embedding</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', title='?'>embedding</a>
<span class='lineno'> 655</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_labels', title='?'>reference_labels</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_reference_labels', title='?'>reshaped_reference_labels</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>][0]
<span class='lineno'> 656</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', title='?'>nn_features_n</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_obj_ids', title='None'>ref_obj_ids</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object', title='(?, ?, ?, ?, ?, None, int) -> (?, None) / (?, ?, ?, int, int, None, int) -> (?, None) / (?, ?, None, int, int, None, int) -> (?, None)'>nearest_neighbor_features_per_object</a>(
<span class='lineno'> 657</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_embedding', title='?'>reference_embedding</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.queries_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.queries_embedding', title='?'>queries_embedding</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reference_labels', title='?'>reference_labels</a>,
<span class='lineno'> 658</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.max_neighbors_per_object', title='int'>max_neighbors_per_object</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>, n_chunks=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_chunks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_chunks', title='int'>n_chunks</a>)
<span class='lineno'> 659</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.normalize_nearest_neighbor_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.normalize_nearest_neighbor_distances', title='bool'>normalize_nearest_neighbor_distances</a>:
<span class='lineno'> 660</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', title='float'>nn_features_n</a> = (tf.nn.sigmoid(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', title='?'>nn_features_n</a>) - 0.5) * 2
<span class='lineno'> 661</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_nn_features', title='[float]'>all_nn_features</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', title='float'>nn_features_n</a>)
<span class='lineno'> 662</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_ref_obj_ids', title='[None]'>all_ref_obj_ids</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_obj_ids', title='None'>ref_obj_ids</a>)
<span class='lineno'> 663</span> 
<span class='lineno'> 664</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.feat_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.feat_dim', title='?'>feat_dim</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a>)[-1]
<span class='lineno'> 665</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a>, tf.stack(
<span class='lineno'> 666</span>       [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', title='None'>batch_size</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', title='None'>num_frames_per_video</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', title='?'>h</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', title='?'>w</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.feat_dim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.feat_dim', title='?'>feat_dim</a>]))
<span class='lineno'> 667</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', title='None'>ref_embeddings</a> is None:
<span class='lineno'> 668</span>     # Strip the features for the reference frame.
<span class='lineno'> 669</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', title='bool'>also_attend_to_previous_frame</a> or <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', title='bool'>use_softmax_feedback</a>:
<span class='lineno'> 670</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a>[:, 2:]
<span class='lineno'> 671</span>     else:
<span class='lineno'> 672</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a>[:, 1:]
<span class='lineno'> 673</span> 
<span class='lineno'> 674</span>   # To keep things simple, we do all this separate for each sequence for now.
<span class='lineno'> 675</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.outputs_to_logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.outputs_to_logits', title='dict'>outputs_to_logits</a> = {<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', title='?'>output</a>: [] for
<span class='lineno'> 676</span>                        <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', title='?'><a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', title='?'>output</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.outputs_to_num_classes}
<span class='lineno'> 677</span>   for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.batch_size', title='None'>batch_size</a>):
<span class='lineno'> 678</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n', title='?'>features_n</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features', title='?'>features</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>]
<span class='lineno'> 679</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', title='float'>nn_features_n</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_nn_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_nn_features', title='[float]'>all_nn_features</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>]
<span class='lineno'> 680</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n_tr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n_tr', title='?'>nn_features_n_tr</a> = tf.transpose(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', title='float'>nn_features_n</a>, [3, 0, 1, 2, 4])
<span class='lineno'> 681</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_objs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_objs', title='?'>n_objs</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n_tr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n_tr', title='?'>nn_features_n_tr</a>)[0]
<span class='lineno'> 682</span>     # Repeat features for every object.
<span class='lineno'> 683</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n_tiled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n_tiled', title='?'>features_n_tiled</a> = tf.tile(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n', title='?'>features_n</a>[tf.newaxis],
<span class='lineno'> 684</span>                                multiples=[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_objs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_objs', title='?'>n_objs</a>, 1, 1, 1, 1])
<span class='lineno'> 685</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', title='None'>prev_frame_labels</a> = None
<span class='lineno'> 686</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', title='bool'>also_attend_to_previous_frame</a>:
<span class='lineno'> 687</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', title='?'>prev_frame_labels</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_reference_labels', title='?'>reshaped_reference_labels</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>, 1]
<span class='lineno'> 688</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.is_training', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.is_training', title='bool'>is_training</a> and <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.damage_initial_previous_frame_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.damage_initial_previous_frame_mask', title='bool'>damage_initial_previous_frame_mask</a>:
<span class='lineno'> 689</span>         # Damage the previous frame masks.
<span class='lineno'> 690</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', title='?'>prev_frame_labels</a> = mask_damaging.damage_masks(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', title='?'>prev_frame_labels</a>,
<span class='lineno'> 691</span>                                                        dilate=False)
<span class='lineno'> 692</span>       tf.summary.image(&#39;prev_frame_labels&#39;,
<span class='lineno'> 693</span>                        tf.cast(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', title='?'>prev_frame_labels</a>[tf.newaxis],
<span class='lineno'> 694</span>                                tf.uint8) * 32)
<span class='lineno'> 695</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', title='None'>initial_softmax_feedback_n</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels', title='(?, ?, None, bool) -> None / (?, ?, ?, ?) -> None'>create_initial_softmax_from_labels</a>(
<span class='lineno'> 696</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', title='?'>prev_frame_labels</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_reference_labels', title='?'>reshaped_reference_labels</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>][0],
<span class='lineno'> 697</span>           decoder_output_stride=None, reduce_labels=True)
<span class='lineno'> 698</span>     elif <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback', title='None'>initial_softmax_feedback</a> is not None:
<span class='lineno'> 699</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', title='?'>initial_softmax_feedback_n</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback', title='None'>initial_softmax_feedback</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>]
<span class='lineno'> 700</span>     else:
<span class='lineno'> 701</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', title='None'>initial_softmax_feedback_n</a> = None
<span class='lineno'> 702</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', title='None'>initial_softmax_feedback_n</a> is None:
<span class='lineno'> 703</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_softmax', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_softmax', title='?'>last_softmax</a> = tf.zeros((<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_objs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_objs', title='?'>n_objs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.h', title='?'>h</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.w', title='?'>w</a>, 1), dtype=tf.float32)
<span class='lineno'> 704</span>     else:
<span class='lineno'> 705</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_softmax', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_softmax', title='?'>last_softmax</a> = tf.transpose(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.initial_softmax_feedback_n', title='None'>initial_softmax_feedback_n</a>, [2, 0, 1])[
<span class='lineno'> 706</span>           ..., tf.newaxis]
<span class='lineno'> 707</span>     assert len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.outputs_to_num_classes) == 1
<span class='lineno'> 708</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', title='?'>output</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.outputs_to_num_classes.keys()[0]
<span class='lineno'> 709</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', title='[?]'>logits</a> = []
<span class='lineno'> 710</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', title='int'>n_ref_frames</a> = 1
<span class='lineno'> 711</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', title='None'>prev_frame_nn_features_n</a> = None
<span class='lineno'> 712</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', title='bool'>also_attend_to_previous_frame</a> or <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', title='bool'>use_softmax_feedback</a>:
<span class='lineno'> 713</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', title='int'><a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', title='int'>n_ref_frames</a></a> += 1
<span class='lineno'> 714</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', title='None'>ref_embeddings</a> is not None:
<span class='lineno'> 715</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', title='int'>n_ref_frames</a> = 0
<span class='lineno'> 716</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', title='int'>t</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', title='None'>num_frames_per_video</a> - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', title='int'>n_ref_frames</a>):
<span class='lineno'> 717</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', title='[?]'>to_concat</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n_tiled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n_tiled', title='?'>features_n_tiled</a>[:, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', title='int'>t</a>]]
<span class='lineno'> 718</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_first_frame_matching', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_first_frame_matching', title='bool'>use_first_frame_matching</a>:
<span class='lineno'> 719</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', title='[?]'>to_concat</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n_tr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n_tr', title='?'>nn_features_n_tr</a>[:, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', title='int'>t</a>])
<span class='lineno'> 720</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_softmax_feedback', title='bool'>use_softmax_feedback</a>:
<span class='lineno'> 721</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', title='[?]'>to_concat</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_softmax', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_softmax', title='?'>last_softmax</a>)
<span class='lineno'> 722</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_attend_to_previous_frame', title='bool'>also_attend_to_previous_frame</a>:
<span class='lineno'> 723</span>         assert <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.normalize_nearest_neighbor_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.normalize_nearest_neighbor_distances', title='bool'>normalize_nearest_neighbor_distances</a>, (
<span class='lineno'> 724</span>             &#39;previous frame attention currently only works when normalized &#39;
<span class='lineno'> 725</span>             &#39;distances are used&#39;)
<span class='lineno'> 726</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', title='?'>embedding</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reshaped_embeddings', title='?'>reshaped_embeddings</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>]
<span class='lineno'> 727</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', title='None'>ref_embeddings</a> is None:
<span class='lineno'> 728</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_frame_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_frame_embedding', title='?'>last_frame_embedding</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', title='?'>embedding</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', title='int'>t</a> + 1]
<span class='lineno'> 729</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', title='?'>query_embeddings</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', title='?'>embedding</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', title='int'>t</a> + 2, tf.newaxis]
<span class='lineno'> 730</span>         else:
<span class='lineno'> 731</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_frame_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_frame_embedding', title='?'>last_frame_embedding</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.ref_embeddings', title='None'>ref_embeddings</a>[1][0]
<span class='lineno'> 732</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', title='?'>query_embeddings</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding', title='?'>embedding</a>
<span class='lineno'> 733</span>         if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_local_previous_frame_attention', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.use_local_previous_frame_attention', title='bool'>use_local_previous_frame_attention</a>:
<span class='lineno'> 734</span>           assert <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', title='?'>query_embeddings</a>.shape[0] == 1
<span class='lineno'> 735</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', title='None'>prev_frame_nn_features_n</a> = (
<span class='lineno'> 736</span>               <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object', title='(?, ?, ?, None, int) -> None / (?, ?, ?, ?, int) -> None / (?, ?, None, None, int) -> None'>local_previous_frame_nearest_neighbor_features_per_object</a>(
<span class='lineno'> 737</span>                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_frame_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_frame_embedding', title='?'>last_frame_embedding</a>,
<span class='lineno'> 738</span>                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', title='?'>query_embeddings</a>[0],
<span class='lineno'> 739</span>                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', title='None'>prev_frame_labels</a>,
<span class='lineno'> 740</span>                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_ref_obj_ids', title='[None]'>all_ref_obj_ids</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>],
<span class='lineno'> 741</span>                   max_distance=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.previous_frame_attention_window_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.previous_frame_attention_window_size', title='int'>previous_frame_attention_window_size</a>)
<span class='lineno'> 742</span>           )
<span class='lineno'> 743</span>         else:
<span class='lineno'> 744</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', title='?'>prev_frame_nn_features_n</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching._', title='None'>_</a> = (
<span class='lineno'> 745</span>               <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.nearest_neighbor_features_per_object', title='(?, ?, ?, ?, ?, None, int) -> (?, None) / (?, ?, ?, int, int, None, int) -> (?, None) / (?, ?, None, int, int, None, int) -> (?, None)'>nearest_neighbor_features_per_object</a>(
<span class='lineno'> 746</span>                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_frame_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_frame_embedding', title='?'>last_frame_embedding</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.query_embeddings', title='?'>query_embeddings</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', title='None'>prev_frame_labels</a>,
<span class='lineno'> 747</span>                   <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.max_neighbors_per_object', title='int'>max_neighbors_per_object</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.k_nearest_neighbors', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.k_nearest_neighbors', title='int'>k_nearest_neighbors</a>,
<span class='lineno'> 748</span>                   gt_ids=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.all_ref_obj_ids', title='[None]'>all_ref_obj_ids</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>]))
<span class='lineno'> 749</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', title='float'>prev_frame_nn_features_n</a> = (tf.nn.sigmoid(
<span class='lineno'> 750</span>               <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', title='?'>prev_frame_nn_features_n</a>) - 0.5) * 2
<span class='lineno'> 751</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n_sq', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n_sq', title='?'>prev_frame_nn_features_n_sq</a> = tf.squeeze(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', title='{None | float}'>prev_frame_nn_features_n</a>,
<span class='lineno'> 752</span>                                                  axis=0)
<span class='lineno'> 753</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n_tr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n_tr', title='?'>prev_frame_nn_features_n_tr</a> = tf.transpose(
<span class='lineno'> 754</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n_sq', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n_sq', title='?'>prev_frame_nn_features_n_sq</a>, [2, 0, 1, 3])
<span class='lineno'> 755</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', title='[?]'>to_concat</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n_tr', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n_tr', title='?'>prev_frame_nn_features_n_tr</a>)
<span class='lineno'> 756</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n_concat_t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n_concat_t', title='?'>features_n_concat_t</a> = tf.concat(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.to_concat', title='[?]'>to_concat</a>, axis=-1)
<span class='lineno'> 757</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_features_n_t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_features_n_t', title='None'>embedding_seg_features_n_t</a> = (
<span class='lineno'> 758</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_embedding_segmentation_features', title='(?, int, int, int, bool, None) -> None / (?, ?, ?, ?, ?, None) -> None'>create_embedding_segmentation_features</a>(
<span class='lineno'> 759</span>               <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n_concat_t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.features_n_concat_t', title='?'>features_n_concat_t</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_feature_dimension', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_feature_dimension', title='int'>embedding_seg_feature_dimension</a>,
<span class='lineno'> 760</span>               <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_n_layers', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_n_layers', title='int'>embedding_seg_n_layers</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_kernel_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_kernel_size', title='int'>embedding_seg_kernel_size</a>,
<span class='lineno'> 761</span>               <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', title='None'>reuse</a> or <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a> &gt; 0, atrous_rates=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_atrous_rates', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_atrous_rates', title='None'>embedding_seg_atrous_rates</a>))
<span class='lineno'> 762</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_t', title='?'>logits_t</a> = model.get_branch_logits(
<span class='lineno'> 763</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_features_n_t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embedding_seg_features_n_t', title='None'>embedding_seg_features_n_t</a>,
<span class='lineno'> 764</span>           1,
<span class='lineno'> 765</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.atrous_rates,
<span class='lineno'> 766</span>           aspp_with_batch_norm=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.aspp_with_batch_norm,
<span class='lineno'> 767</span>           kernel_size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.model_options', title='?'>model_options</a>.logits_kernel_size,
<span class='lineno'> 768</span>           weight_decay=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.weight_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.weight_decay', title='float'>weight_decay</a>,
<span class='lineno'> 769</span>           reuse=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.reuse', title='None'>reuse</a> or <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a> &gt; 0 or <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.t', title='int'>t</a> &gt; 0,
<span class='lineno'> 770</span>           scope_suffix=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', title='?'>output</a>
<span class='lineno'> 771</span>       )
<span class='lineno'> 772</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', title='[?]'>logits</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_t', title='?'>logits_t</a>)
<span class='lineno'> 773</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_labels', title='?'>prev_frame_labels</a> = tf.transpose(tf.argmax(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_t', title='?'>logits_t</a>, axis=0),
<span class='lineno'> 774</span>                                        [2, 0, 1])
<span class='lineno'> 775</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_softmax', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.last_softmax', title='?'>last_softmax</a> = tf.nn.softmax(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_t', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_t', title='?'>logits_t</a>, axis=0)
<span class='lineno'> 776</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', title='?'>logits</a> = tf.stack(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', title='[?]'>logits</a>, axis=1)
<span class='lineno'> 777</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_shape', title='?'>logits_shape</a> = tf.stack(
<span class='lineno'> 778</span>         [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_objs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_objs', title='?'>n_objs</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', title='None'>num_frames_per_video</a> - <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n_ref_frames', title='int'>n_ref_frames</a>] +
<span class='lineno'> 779</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.resolve_shape', title='?'>resolve_shape</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', title='?'>logits</a>)[2:-1])
<span class='lineno'> 780</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_reshaped', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_reshaped', title='?'>logits_reshaped</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits', title='?'>logits</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_shape', title='?'>logits_shape</a>)
<span class='lineno'> 781</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_transposed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_transposed', title='?'>logits_transposed</a> = tf.transpose(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_reshaped', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_reshaped', title='?'>logits_reshaped</a>, [1, 2, 3, 0])
<span class='lineno'> 782</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.outputs_to_logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.outputs_to_logits', title='dict'>outputs_to_logits</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.output', title='?'>output</a>].append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_transposed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_transposed', title='?'>logits_transposed</a>)
<span class='lineno'> 783</span> 
<span class='lineno'> 784</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.add_image_summaries', title='(?, ?, ?, ?, None) -> None / (?, float, ?, int, None) -> None'>add_image_summaries</a>(
<span class='lineno'> 785</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.images', title='?'>images</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a> * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', title='None'>num_frames_per_video</a>: (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.n', title='int'>n</a>+1) * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.num_frames_per_video', title='None'>num_frames_per_video</a>],
<span class='lineno'> 786</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.nn_features_n', title='float'>nn_features_n</a>,
<span class='lineno'> 787</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_transposed', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.logits_transposed', title='?'>logits_transposed</a>,
<span class='lineno'> 788</span>         batch_size=1,
<span class='lineno'> 789</span>         prev_frame_nn_features=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.prev_frame_nn_features_n', title='{None | float}'>prev_frame_nn_features_n</a>)
<span class='lineno'> 790</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_return_embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.also_return_embeddings', title='bool'>also_return_embeddings</a>:
<span class='lineno'> 791</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.outputs_to_logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.outputs_to_logits', title='dict'>outputs_to_logits</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.embeddings', title='?'>embeddings</a>
<span class='lineno'> 792</span>   else:
<span class='lineno'> 793</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.outputs_to_logits', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.get_logits_with_matching.outputs_to_logits', title='dict'>outputs_to_logits</a>
<span class='lineno'> 794</span> 
<span class='lineno'> 795</span> 
<span class='lineno'> 796</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels', title='(?, ?, None, ?) -> (?, ?) / (?, ?, ?, ?) -> (?, ?) / (?, ?, None, int) -> (?, ?)'>subsample_reference_embeddings_and_labels</a>(
<span class='lineno'> 797</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', title='?'>reference_embeddings_flat</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', title='?'>reference_labels_flat</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.ref_obj_ids', title='None'>ref_obj_ids</a>,
<span class='lineno'> 798</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object', title='int'>max_neighbors_per_object</a>):
<span class='lineno'> 799</span>   &quot;&quot;&quot;Subsamples the reference embedding vectors and labels.
<span class='lineno'> 800</span> 
<span class='lineno'> 801</span>   After subsampling, at most max_neighbors_per_object items will remain per
<span class='lineno'> 802</span>     class.
<span class='lineno'> 803</span> 
<span class='lineno'> 804</span>   Args:
<span class='lineno'> 805</span>     reference_embeddings_flat: Tensor of shape [n, embedding_dim],
<span class='lineno'> 806</span>       the embedding vectors for the reference frame.
<span class='lineno'> 807</span>     reference_labels_flat: Tensor of shape [n, 1],
<span class='lineno'> 808</span>       the class labels of the reference frame.
<span class='lineno'> 809</span>     ref_obj_ids: An int32 tensor of the unique object ids present
<span class='lineno'> 810</span>       in the reference labels.
<span class='lineno'> 811</span>     max_neighbors_per_object: Integer, the maximum number of candidates
<span class='lineno'> 812</span>       for the nearest neighbor query per object after subsampling,
<span class='lineno'> 813</span>       or 0 for no subsampling.
<span class='lineno'> 814</span> 
<span class='lineno'> 815</span>   Returns:
<span class='lineno'> 816</span>     reference_embeddings_flat: Tensor of shape [n_sub, embedding_dim],
<span class='lineno'> 817</span>       the subsampled embedding vectors for the reference frame.
<span class='lineno'> 818</span>     reference_labels_flat: Tensor of shape [n_sub, 1],
<span class='lineno'> 819</span>       the class labels of the reference frame.
<span class='lineno'> 820</span>   &quot;&quot;&quot;
<span class='lineno'> 821</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object', title='int'>max_neighbors_per_object</a> == 0:
<span class='lineno'> 822</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', title='?'>reference_embeddings_flat</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', title='?'>reference_labels_flat</a>
<span class='lineno'> 823</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.same_label_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.same_label_mask', title='?'>same_label_mask</a> = tf.equal(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', title='?'>reference_labels_flat</a>[tf.newaxis, :],
<span class='lineno'> 824</span>                              <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.ref_obj_ids', title='None'>ref_obj_ids</a>[:, tf.newaxis])
<span class='lineno'> 825</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object_repeated', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object_repeated', title='?'>max_neighbors_per_object_repeated</a> = tf.tile(
<span class='lineno'> 826</span>       tf.constant(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object', title='int'>max_neighbors_per_object</a>)[tf.newaxis],
<span class='lineno'> 827</span>       multiples=[tf.size(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.ref_obj_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.ref_obj_ids', title='None'>ref_obj_ids</a>)])
<span class='lineno'> 828</span>   # Somehow map_fn on GPU caused trouble sometimes, so let&#39;s put it on CPU
<span class='lineno'> 829</span>   # for now.
<span class='lineno'> 830</span>   with tf.device(&#39;cpu:0&#39;):
<span class='lineno'> 831</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.subsampled_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.subsampled_indices', title='?'>subsampled_indices</a> = tf.map_fn(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask', title='? -> None'>_create_subsampling_mask</a>,
<span class='lineno'> 832</span>                                    (<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.same_label_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.same_label_mask', title='?'>same_label_mask</a>,
<span class='lineno'> 833</span>                                     <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object_repeated', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.max_neighbors_per_object_repeated', title='?'>max_neighbors_per_object_repeated</a>),
<span class='lineno'> 834</span>                                    dtype=tf.int64,
<span class='lineno'> 835</span>                                    name=&#39;subsample_labels_map_fn&#39;,
<span class='lineno'> 836</span>                                    parallel_iterations=1)
<span class='lineno'> 837</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.mask', title='?'>mask</a> = tf.not_equal(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.subsampled_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.subsampled_indices', title='?'>subsampled_indices</a>, tf.constant(-1, dtype=tf.int64))
<span class='lineno'> 838</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.masked_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.masked_indices', title='?'>masked_indices</a> = tf.boolean_mask(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.subsampled_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.subsampled_indices', title='?'>subsampled_indices</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.mask', title='?'>mask</a>)
<span class='lineno'> 839</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', title='?'>reference_embeddings_flat</a> = tf.gather(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', title='?'>reference_embeddings_flat</a>,
<span class='lineno'> 840</span>                                         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.masked_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.masked_indices', title='?'>masked_indices</a>)
<span class='lineno'> 841</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', title='?'>reference_labels_flat</a> = tf.gather(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', title='?'>reference_labels_flat</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.masked_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.masked_indices', title='?'>masked_indices</a>)
<span class='lineno'> 842</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_embeddings_flat', title='?'>reference_embeddings_flat</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.subsample_reference_embeddings_and_labels.reference_labels_flat', title='?'>reference_labels_flat</a>
<span class='lineno'> 843</span> 
<span class='lineno'> 844</span> 
<span class='lineno'> 845</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask', title='? -> None'>_create_subsampling_mask</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.args', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.args', title='?'>args</a>):
<span class='lineno'> 846</span>   &quot;&quot;&quot;Creates boolean mask which can be used to subsample the labels.
<span class='lineno'> 847</span> 
<span class='lineno'> 848</span>   Args:
<span class='lineno'> 849</span>     args: tuple of (label_mask, max_neighbors_per_object), where label_mask
<span class='lineno'> 850</span>       is the mask to be subsampled and max_neighbors_per_object is a int scalar,
<span class='lineno'> 851</span>       the maximum number of neighbors to be retained after subsampling.
<span class='lineno'> 852</span> 
<span class='lineno'> 853</span>   Returns:
<span class='lineno'> 854</span>     The boolean mask for subsampling the labels.
<span class='lineno'> 855</span>   &quot;&quot;&quot;
<span class='lineno'> 856</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.label_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.label_mask', title='?'>label_mask</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.max_neighbors_per_object', title='?'>max_neighbors_per_object</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.args', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.args', title='?'>args</a>
<span class='lineno'> 857</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.indices', title='?'>indices</a> = tf.squeeze(tf.where(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.label_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.label_mask', title='?'>label_mask</a>), axis=1)
<span class='lineno'> 858</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.shuffled_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.shuffled_indices', title='?'>shuffled_indices</a> = tf.random_shuffle(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.indices', title='?'>indices</a>)
<span class='lineno'> 859</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.subsampled_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.subsampled_indices', title='?'>subsampled_indices</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.shuffled_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.shuffled_indices', title='?'>shuffled_indices</a>[:<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.max_neighbors_per_object', title='?'>max_neighbors_per_object</a>]
<span class='lineno'> 860</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.n_pad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.n_pad', title='?'>n_pad</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.max_neighbors_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.max_neighbors_per_object', title='?'>max_neighbors_per_object</a> - tf.size(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.subsampled_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.subsampled_indices', title='?'>subsampled_indices</a>)
<span class='lineno'> 861</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padded_label', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padded_label', title='int'>padded_label</a> = -1
<span class='lineno'> 862</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padding', title='?'>padding</a> = tf.fill((<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.n_pad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.n_pad', title='?'>n_pad</a>,), tf.constant(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padded_label', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padded_label', title='int'>padded_label</a>, dtype=tf.int64))
<span class='lineno'> 863</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padded', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padded', title='?'>padded</a> = tf.concat([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.subsampled_indices', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.subsampled_indices', title='?'>subsampled_indices</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padding', title='?'>padding</a>], axis=0)
<span class='lineno'> 864</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padded', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils._create_subsampling_mask.padded', title='?'>padded</a>
<span class='lineno'> 865</span> 
<span class='lineno'> 866</span> 
<span class='lineno'> 867</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer', title='(float, int, float) -> (?, ?, None) -> None'>conv2d_identity_initializer</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.scale', title='float'>scale</a>=1.0, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.mean', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.mean', title='int'>mean</a>=0, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.stddev', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.stddev', title='float'>stddev</a>=3e-2):
<span class='lineno'> 868</span>   &quot;&quot;&quot;Creates an identity initializer for TensorFlow conv2d.
<span class='lineno'> 869</span> 
<span class='lineno'> 870</span>   We add a small amount of normal noise to the initialization matrix.
<span class='lineno'> 871</span>   Code copied from lcchen@.
<span class='lineno'> 872</span> 
<span class='lineno'> 873</span>   Args:
<span class='lineno'> 874</span>     scale: The scale coefficient for the identity weight matrix.
<span class='lineno'> 875</span>     mean: A 0-D Tensor or Python value of type `dtype`. The mean of the
<span class='lineno'> 876</span>       truncated normal distribution.
<span class='lineno'> 877</span>     stddev: A 0-D Tensor or Python value of type `dtype`. The standard deviation
<span class='lineno'> 878</span>       of the truncated normal distribution.
<span class='lineno'> 879</span> 
<span class='lineno'> 880</span>   Returns:
<span class='lineno'> 881</span>     An identity initializer function for TensorFlow conv2d.
<span class='lineno'> 882</span>   &quot;&quot;&quot;
<span class='lineno'> 883</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer', title='(?, ?, None) -> None'>_initializer</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.dtype', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.dtype', title='?'>dtype</a>=tf.float32, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.partition_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.partition_info', title='None'>partition_info</a>=None):
<span class='lineno'> 884</span>     &quot;&quot;&quot;Returns the identity matrix scaled by `scale`.
<span class='lineno'> 885</span> 
<span class='lineno'> 886</span>     Args:
<span class='lineno'> 887</span>       shape: A tuple of int32 numbers indicating the shape of the initializing
<span class='lineno'> 888</span>          matrix.
<span class='lineno'> 889</span>       dtype: The data type of the initializing matrix.
<span class='lineno'> 890</span>       partition_info: (Optional) variable_scope._PartitionInfo object holding
<span class='lineno'> 891</span>       additional information about how the variable is partitioned. This input
<span class='lineno'> 892</span>         is not used in our case, but is required by TensorFlow.
<span class='lineno'> 893</span> 
<span class='lineno'> 894</span>     Returns:
<span class='lineno'> 895</span>       A identity matrix.
<span class='lineno'> 896</span> 
<span class='lineno'> 897</span>     Raises:
<span class='lineno'> 898</span>       ValueError: If len(shape) != 4, or shape[0] != shape[1], or shape[0] is
<span class='lineno'> 899</span>         not odd, or shape[1] is not odd..
<span class='lineno'> 900</span>     &quot;&quot;&quot;
<span class='lineno'> 901</span>     del <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.partition_info', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.partition_info', title='None'>partition_info</a>
<span class='lineno'> 902</span>     if len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>) != 4:
<span class='lineno'> 903</span>       raise ValueError(&#39;Expect shape length to be 4.&#39;)
<span class='lineno'> 904</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>[0] != <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>[1]:
<span class='lineno'> 905</span>       raise ValueError(&#39;Expect shape[0] = shape[1].&#39;)
<span class='lineno'> 906</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>[0] % 2 != 1:
<span class='lineno'> 907</span>       raise ValueError(&#39;Expect shape[0] to be odd value.&#39;)
<span class='lineno'> 908</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>[1] % 2 != 1:
<span class='lineno'> 909</span>       raise ValueError(&#39;Expect shape[1] to be odd value.&#39;)
<span class='lineno'> 910</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.weights', title='?'>weights</a> = np.zeros(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>, dtype=np.float32)
<span class='lineno'> 911</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.center_y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.center_y', title='int'>center_y</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>[0] / 2
<span class='lineno'> 912</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.center_x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.center_x', title='int'>center_x</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>[1] / 2
<span class='lineno'> 913</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.min_channel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.min_channel', title='int'>min_channel</a> = min(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>[2], <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>[3])
<span class='lineno'> 914</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.i', title='int'>i</a> in range(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.min_channel', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.min_channel', title='int'>min_channel</a>):
<span class='lineno'> 915</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.weights', title='?'>weights</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.center_y', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.center_y', title='int'>center_y</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.center_x', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.center_x', title='int'>center_x</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.i', title='int'>i</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.i', title='int'>i</a>] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.scale', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.scale', title='float'>scale</a>
<span class='lineno'> 916</span>     return tf.constant(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.weights', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.weights', title='?'>weights</a>, dtype=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.dtype', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.dtype', title='?'>dtype</a>) + tf.truncated_normal(
<span class='lineno'> 917</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.shape', title='?'>shape</a>, mean=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.mean', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.mean', title='int'>mean</a>, stddev=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.stddev', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer.stddev', title='float'>stddev</a>, dtype=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.dtype', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer.dtype', title='?'>dtype</a>)
<span class='lineno'> 918</span> 
<span class='lineno'> 919</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer._initializer', title='(?, ?, None) -> None'>_initializer</a>
<span class='lineno'> 920</span> 
<span class='lineno'> 921</span> 
<span class='lineno'> 922</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer', title='(?, None, int, int, float, None) -> None / (?, ?, int, int, float, None) -> None'>split_separable_conv2d_with_identity_initializer</a>(
<span class='lineno'> 923</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.inputs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.inputs', title='?'>inputs</a>,
<span class='lineno'> 924</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.filters', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.filters', title='None'>filters</a>,
<span class='lineno'> 925</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.kernel_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.kernel_size', title='int'>kernel_size</a>=3,
<span class='lineno'> 926</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.rate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.rate', title='int'>rate</a>=1,
<span class='lineno'> 927</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.weight_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.weight_decay', title='float'>weight_decay</a>=0.00004,
<span class='lineno'> 928</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.scope', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.scope', title='None'>scope</a>=None):
<span class='lineno'> 929</span>   &quot;&quot;&quot;Splits a separable conv2d into depthwise and pointwise conv2d.
<span class='lineno'> 930</span> 
<span class='lineno'> 931</span>   This operation differs from `tf.layers.separable_conv2d` as this operation
<span class='lineno'> 932</span>   applies activation function between depthwise and pointwise conv2d.
<span class='lineno'> 933</span> 
<span class='lineno'> 934</span>   Args:
<span class='lineno'> 935</span>     inputs: Input tensor with shape [batch, height, width, channels].
<span class='lineno'> 936</span>     filters: Number of filters in the 1x1 pointwise convolution.
<span class='lineno'> 937</span>     kernel_size: A list of length 2: [kernel_height, kernel_width] of
<span class='lineno'> 938</span>       of the filters. Can be an int if both values are the same.
<span class='lineno'> 939</span>     rate: Atrous convolution rate for the depthwise convolution.
<span class='lineno'> 940</span>     weight_decay: The weight decay to use for regularizing the model.
<span class='lineno'> 941</span>     scope: Optional scope for the operation.
<span class='lineno'> 942</span> 
<span class='lineno'> 943</span>   Returns:
<span class='lineno'> 944</span>     Computed features after split separable conv2d.
<span class='lineno'> 945</span>   &quot;&quot;&quot;
<span class='lineno'> 946</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.initializer', title='(?, ?, None) -> None'>initializer</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.conv2d_identity_initializer', title='(float, int, float) -> (?, ?, None) -> None'>conv2d_identity_initializer</a>()
<span class='lineno'> 947</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.outputs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.outputs', title='?'>outputs</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim', title='?'>slim</a>.separable_conv2d(
<span class='lineno'> 948</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.inputs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.inputs', title='?'>inputs</a>,
<span class='lineno'> 949</span>       None,
<span class='lineno'> 950</span>       kernel_size=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.kernel_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.kernel_size', title='int'>kernel_size</a>,
<span class='lineno'> 951</span>       depth_multiplier=1,
<span class='lineno'> 952</span>       rate=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.rate', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.rate', title='int'>rate</a>,
<span class='lineno'> 953</span>       weights_initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.initializer', title='(?, ?, None) -> None'>initializer</a>,
<span class='lineno'> 954</span>       weights_regularizer=None,
<span class='lineno'> 955</span>       scope=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.scope', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.scope', title='None'>scope</a> + &#39;_depthwise&#39;)
<span class='lineno'> 956</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim', title='?'>slim</a>.conv2d(
<span class='lineno'> 957</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.outputs', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.outputs', title='?'>outputs</a>,
<span class='lineno'> 958</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.filters', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.filters', title='None'>filters</a>,
<span class='lineno'> 959</span>       1,
<span class='lineno'> 960</span>       weights_initializer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.initializer', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.initializer', title='(?, ?, None) -> None'>initializer</a>,
<span class='lineno'> 961</span>       weights_regularizer=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.slim', title='?'>slim</a>.l2_regularizer(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.weight_decay', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.weight_decay', title='float'>weight_decay</a>),
<span class='lineno'> 962</span>       scope=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.scope', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.split_separable_conv2d_with_identity_initializer.scope', title='None'>scope</a> + &#39;_pointwise&#39;)
<span class='lineno'> 963</span> 
<span class='lineno'> 964</span> 
<span class='lineno'> 965</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels', title='(?, ?, None, bool) -> None / (?, ?, ?, ?) -> None'>create_initial_softmax_from_labels</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', title='?'>last_frame_labels</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels', title='?'>reference_labels</a>,
<span class='lineno'> 966</span>                                        <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.decoder_output_stride', title='None'>decoder_output_stride</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reduce_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reduce_labels', title='bool'>reduce_labels</a>):
<span class='lineno'> 967</span>   &quot;&quot;&quot;Creates initial softmax predictions from last frame labels.
<span class='lineno'> 968</span> 
<span class='lineno'> 969</span>   Args:
<span class='lineno'> 970</span>     last_frame_labels: last frame labels of shape [1, height, width, 1].
<span class='lineno'> 971</span>     reference_labels: reference frame labels of shape [1, height, width, 1].
<span class='lineno'> 972</span>     decoder_output_stride: Integer, the stride of the decoder. Can be None, in
<span class='lineno'> 973</span>       this case it&#39;s assumed that the last_frame_labels and reference_labels
<span class='lineno'> 974</span>       are already scaled to the decoder output resolution.
<span class='lineno'> 975</span>     reduce_labels: Boolean, whether to reduce the depth of the softmax one_hot
<span class='lineno'> 976</span>       encoding to the actual number of labels present in the reference frame
<span class='lineno'> 977</span>       (otherwise the depth will be the highest label index + 1).
<span class='lineno'> 978</span> 
<span class='lineno'> 979</span>   Returns:
<span class='lineno'> 980</span>     init_softmax: the initial softmax predictions.
<span class='lineno'> 981</span>   &quot;&quot;&quot;
<span class='lineno'> 982</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.decoder_output_stride', title='None'>decoder_output_stride</a> is None:
<span class='lineno'> 983</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.labels_output_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.labels_output_size', title='?'>labels_output_size</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', title='?'>last_frame_labels</a>
<span class='lineno'> 984</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels_output_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels_output_size', title='?'>reference_labels_output_size</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels', title='?'>reference_labels</a>
<span class='lineno'> 985</span>   else:
<span class='lineno'> 986</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h', title='?'>h</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', title='?'>last_frame_labels</a>)[1]
<span class='lineno'> 987</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w', title='?'>w</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', title='?'>last_frame_labels</a>)[2]
<span class='lineno'> 988</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h_sub', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h_sub', title='?'>h_sub</a> = model.scale_dimension(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h', title='?'>h</a>, 1.0 / <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.decoder_output_stride', title='None'>decoder_output_stride</a>)
<span class='lineno'> 989</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w_sub', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w_sub', title='?'>w_sub</a> = model.scale_dimension(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w', title='?'>w</a>, 1.0 / <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.decoder_output_stride', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.decoder_output_stride', title='None'>decoder_output_stride</a>)
<span class='lineno'> 990</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.labels_output_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.labels_output_size', title='?'>labels_output_size</a> = tf.image.resize_nearest_neighbor(
<span class='lineno'> 991</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.last_frame_labels', title='?'>last_frame_labels</a>, [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h_sub', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h_sub', title='?'>h_sub</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w_sub', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w_sub', title='?'>w_sub</a>], align_corners=True)
<span class='lineno'> 992</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels_output_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels_output_size', title='?'>reference_labels_output_size</a> = tf.image.resize_nearest_neighbor(
<span class='lineno'> 993</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels', title='?'>reference_labels</a>, [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h_sub', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.h_sub', title='?'>h_sub</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w_sub', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.w_sub', title='?'>w_sub</a>], align_corners=True)
<span class='lineno'> 994</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reduce_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reduce_labels', title='bool'>reduce_labels</a>:
<span class='lineno'> 995</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.unique_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.unique_labels', title='?'>unique_labels</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels._', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels._', title='?'>_</a> = tf.unique(tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels_output_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels_output_size', title='?'>reference_labels_output_size</a>, [-1]))
<span class='lineno'> 996</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.depth', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.depth', title='?'>depth</a> = tf.size(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.unique_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.unique_labels', title='?'>unique_labels</a>)
<span class='lineno'> 997</span>   else:
<span class='lineno'> 998</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.depth', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.depth', title='int'>depth</a> = tf.reduce_max(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels_output_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.reference_labels_output_size', title='?'>reference_labels_output_size</a>) + 1
<span class='lineno'> 999</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.one_hot_assertion', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.one_hot_assertion', title='?'>one_hot_assertion</a> = tf.assert_less(tf.reduce_max(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.labels_output_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.labels_output_size', title='?'>labels_output_size</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.depth', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.depth', title='int'>depth</a>)
<span class='lineno'>1000</span>   with tf.control_dependencies([<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.one_hot_assertion', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.one_hot_assertion', title='?'>one_hot_assertion</a>]):
<span class='lineno'>1001</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.init_softmax', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.init_softmax', title='?'>init_softmax</a> = tf.one_hot(tf.squeeze(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.labels_output_size', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.labels_output_size', title='?'>labels_output_size</a>,
<span class='lineno'>1002</span>                                          axis=-1),
<span class='lineno'>1003</span>                               depth=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.depth', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.depth', title='int'>depth</a>,
<span class='lineno'>1004</span>                               dtype=tf.float32)
<span class='lineno'>1005</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.init_softmax', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.create_initial_softmax_from_labels.init_softmax', title='?'>init_softmax</a>
<span class='lineno'>1006</span> 
<span class='lineno'>1007</span> 
<span class='lineno'>1008</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object', title='(?, ?, ?, None, int) -> None / (?, ?, ?, ?, int) -> None / (?, ?, None, None, int) -> None'>local_previous_frame_nearest_neighbor_features_per_object</a>(
<span class='lineno'>1009</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', title='?'>prev_frame_embedding</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.query_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.query_embedding', title='?'>query_embedding</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_labels', title='None'>prev_frame_labels</a>,
<span class='lineno'>1010</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a>=9):
<span class='lineno'>1011</span>   &quot;&quot;&quot;Computes nearest neighbor features while only allowing local matches.
<span class='lineno'>1012</span> 
<span class='lineno'>1013</span>   Args:
<span class='lineno'>1014</span>     prev_frame_embedding: Tensor of shape [height, width, embedding_dim],
<span class='lineno'>1015</span>       the embedding vectors for the last frame.
<span class='lineno'>1016</span>     query_embedding: Tensor of shape [height, width, embedding_dim],
<span class='lineno'>1017</span>       the embedding vectors for the query frames.
<span class='lineno'>1018</span>     prev_frame_labels: Tensor of shape [height, width, 1], the class labels of
<span class='lineno'>1019</span>       the previous frame.
<span class='lineno'>1020</span>     gt_ids: Int Tensor of shape [n_objs] of the sorted unique ground truth
<span class='lineno'>1021</span>       ids in the first frame.
<span class='lineno'>1022</span>     max_distance: Integer, the maximum distance allowed for local matching.
<span class='lineno'>1023</span> 
<span class='lineno'>1024</span>   Returns:
<span class='lineno'>1025</span>     nn_features: A float32 np.array of nearest neighbor features of shape
<span class='lineno'>1026</span>       [1, height, width, n_objects, 1].
<span class='lineno'>1027</span>   &quot;&quot;&quot;
<span class='lineno'>1028</span>   with tf.name_scope(
<span class='lineno'>1029</span>       &#39;local_previous_frame_nearest_neighbor_features_per_object&#39;):
<span class='lineno'>1030</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', title='bool'>USE_CORRELATION_COST</a>:
<span class='lineno'>1031</span>       tf.logging.info(&#39;Using correlation_cost.&#39;)
<span class='lineno'>1032</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', title='None'>d</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances', title='(?, ?, int) -> None'>local_pairwise_distances</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.query_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.query_embedding', title='?'>query_embedding</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', title='?'>prev_frame_embedding</a>,
<span class='lineno'>1033</span>                                    max_distance=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a>)
<span class='lineno'>1034</span>     else:
<span class='lineno'>1035</span>       # Slow fallback in case correlation_cost is not available.
<span class='lineno'>1036</span>       tf.logging.warn(&#39;correlation cost is not available, using slow fallback &#39;
<span class='lineno'>1037</span>                       &#39;implementation.&#39;)
<span class='lineno'>1038</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', title='None'>d</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_pairwise_distances2', title='(?, ?, int) -> None'>local_pairwise_distances2</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.query_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.query_embedding', title='?'>query_embedding</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', title='?'>prev_frame_embedding</a>,
<span class='lineno'>1039</span>                                     max_distance=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a>)
<span class='lineno'>1040</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', title='float'>d</a> = (tf.nn.sigmoid(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', title='None'>d</a>) - 0.5) * 2
<span class='lineno'>1041</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', title='?'>height</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', title='?'>prev_frame_embedding</a>)[0]
<span class='lineno'>1042</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', title='?'>width</a> = tf.shape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_embedding', title='?'>prev_frame_embedding</a>)[1]
<span class='lineno'>1043</span> 
<span class='lineno'>1044</span>     # Create offset versions of the mask.
<span class='lineno'>1045</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.USE_CORRELATION_COST', title='bool'>USE_CORRELATION_COST</a>:
<span class='lineno'>1046</span>       # New, faster code with cross-correlation via correlation_cost.
<span class='lineno'>1047</span>       # Due to padding we have to add 1 to the labels.
<span class='lineno'>1048</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', title='?'>offset_labels</a> = correlation_cost_op.correlation_cost(
<span class='lineno'>1049</span>           tf.ones((1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', title='?'>height</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', title='?'>width</a>, 1)),
<span class='lineno'>1050</span>           tf.cast(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_labels', title='None'>prev_frame_labels</a> + 1, tf.float32)[tf.newaxis],
<span class='lineno'>1051</span>           kernel_size=1,
<span class='lineno'>1052</span>           max_displacement=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a>, stride_1=1, stride_2=1,
<span class='lineno'>1053</span>           pad=<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a>)
<span class='lineno'>1054</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', title='?'>offset_labels</a> = tf.squeeze(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', title='?'>offset_labels</a>, axis=0)[..., tf.newaxis]
<span class='lineno'>1055</span>       # Subtract the 1 again and round.
<span class='lineno'>1056</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', title='?'>offset_labels</a> = tf.round(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', title='?'>offset_labels</a> - 1)
<span class='lineno'>1057</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', title='?'>offset_masks</a> = tf.equal(
<span class='lineno'>1058</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_labels', title='?'>offset_labels</a>,
<span class='lineno'>1059</span>           tf.cast(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>, tf.float32)[tf.newaxis, tf.newaxis, tf.newaxis, :])
<span class='lineno'>1060</span>     else:
<span class='lineno'>1061</span>       # Slower code, without dependency to correlation_cost
<span class='lineno'>1062</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.masks', title='?'>masks</a> = tf.equal(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_labels', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.prev_frame_labels', title='None'>prev_frame_labels</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>[tf.newaxis, tf.newaxis])
<span class='lineno'>1063</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.padded_masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.padded_masks', title='?'>padded_masks</a> = tf.pad(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.masks', title='?'>masks</a>,
<span class='lineno'>1064</span>                             [[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a>],
<span class='lineno'>1065</span>                              [<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a>],
<span class='lineno'>1066</span>                              [0, 0]])
<span class='lineno'>1067</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', title='[?]'>offset_masks</a> = []
<span class='lineno'>1068</span>       for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_start', title='int'>y_start</a> in range(2 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a> + 1):
<span class='lineno'>1069</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_end', title='int'>y_end</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_start', title='int'>y_start</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', title='?'>height</a>
<span class='lineno'>1070</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.masks_slice', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.masks_slice', title='?'>masks_slice</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.padded_masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.padded_masks', title='?'>padded_masks</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_start', title='int'>y_start</a>:<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.y_end', title='int'>y_end</a>]
<span class='lineno'>1071</span>         for <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_start', title='int'>x_start</a> in range(2 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a> + 1):
<span class='lineno'>1072</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_end', title='int'>x_end</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_start', title='int'>x_start</a> + <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', title='?'>width</a>
<span class='lineno'>1073</span>           <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_mask', title='?'>offset_mask</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.masks_slice', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.masks_slice', title='?'>masks_slice</a>[:, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_start', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_start', title='int'>x_start</a>:<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_end', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.x_end', title='int'>x_end</a>]
<span class='lineno'>1074</span>           <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', title='[?]'>offset_masks</a>.append(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_mask', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_mask', title='?'>offset_mask</a>)
<span class='lineno'>1075</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', title='?'>offset_masks</a> = tf.stack(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', title='[?]'>offset_masks</a>, axis=2)
<span class='lineno'>1076</span> 
<span class='lineno'>1077</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.pad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.pad', title='?'>pad</a> = tf.ones((<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', title='?'>height</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', title='?'>width</a>, (2 * <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.max_distance', title='int'>max_distance</a> + 1) ** 2, tf.size(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>)))
<span class='lineno'>1078</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d_tiled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d_tiled', title='?'>d_tiled</a> = tf.tile(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d', title='float'>d</a>[..., tf.newaxis], multiples=(1, 1, 1, tf.size(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>)))
<span class='lineno'>1079</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d_masked', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d_masked', title='?'>d_masked</a> = tf.where(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.offset_masks', title='?'>offset_masks</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d_tiled', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d_tiled', title='?'>d_tiled</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.pad', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.pad', title='?'>pad</a>)
<span class='lineno'>1080</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.dists', title='?'>dists</a> = tf.reduce_min(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d_masked', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.d_masked', title='?'>d_masked</a>, axis=2)
<span class='lineno'>1081</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.dists', title='?'>dists</a> = tf.reshape(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.dists', title='?'>dists</a>, (1, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.height', title='?'>height</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.width', title='?'>width</a>, tf.size(<a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.gt_ids', title='None'>gt_ids</a>), 1))
<span class='lineno'>1082</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.dists', xid ='.home.xxm.Desktop.EMSE.dataset.models.research.feelvos.utils.embedding_utils.local_previous_frame_nearest_neighbor_features_per_object.dists', title='?'>dists</a>
</pre></td></tr></table></body></html>