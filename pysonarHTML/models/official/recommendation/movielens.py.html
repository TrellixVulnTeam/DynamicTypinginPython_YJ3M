<html>
<head>
<meta charset="utf-8">
<title>/home/xxm/Desktop/EMSE/dataset/models/official/recommendation/movielens.py</title>
<style type='text/css'>
body { color: #666666; }
a {
    text-decoration: none; color: #5AA2A7;
    border: solid 1px rgba(255,255,255,0);
}
a.active {
    background: -webkit-linear-gradient(top,rgba(255, 255, 200, 0.35) 0,rgba(255, 255, 200, 0.55) 100%);
    border: solid 1px #E5E600;
}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #cccccc;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px solid orange; padding-bottom: 1px}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted;

function highlight(xid)
{
    var elms = document.querySelectorAll('[xid="' + xid + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "active";
    }
    highlighted = xid;
}

function clearHighlight() {
    var elms = document.querySelectorAll('[xid="' + highlighted + '"]');
    for (k in elms) {
        v = elms[k]
        v.className = "";
    }
}

window.onload =
    function (e) {
        var tags = document.getElementsByTagName("A")
        for (var i = 0; i < tags.length; i++) {
            tags[i].onmouseover =
                function (e) {
                    clearHighlight();
                    var xid = e.toElement.getAttribute('xid');
                    highlight(xid);
                }
        }
    }</script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M'>ML_1M</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M'>ML_20M</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS'>DATASETS</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE'>RATINGS_FILE</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE'>MOVIES_FILE</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._DATA_URL', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._DATA_URL'>_DATA_URL</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN'>GENRE_COLUMN</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN'>ITEM_COLUMN</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN'>RATING_COLUMN</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TIMESTAMP_COLUMN', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TIMESTAMP_COLUMN'>TIMESTAMP_COLUMN</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TITLE_COLUMN', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TITLE_COLUMN'>TITLE_COLUMN</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.USER_COLUMN', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.USER_COLUMN'>USER_COLUMN</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES'>GENRES</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.N_GENRE', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.N_GENRE'>N_GENRE</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMNS', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMNS'>RATING_COLUMNS</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIE_COLUMNS', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIE_COLUMNS'>MOVIE_COLUMNS</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_USER_IDS', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_USER_IDS'>NUM_USER_IDS</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_ITEM_IDS', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_ITEM_IDS'>NUM_ITEM_IDS</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MAX_RATING', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MAX_RATING'>MAX_RATING</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_RATINGS', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_RATINGS'>NUM_RATINGS</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASET_TO_NUM_USERS_AND_ITEMS', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASET_TO_NUM_USERS_AND_ITEMS'>DATASET_TO_NUM_USERS_AND_ITEMS</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean'>_download_and_clean</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv'>_transform_csv</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset'>_regularize_1m_dataset</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset'>_regularize_20m_dataset</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download'>download</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe'>ratings_csv_to_dataframe</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe'>csv_to_joint_dataframe</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres'>integerize_genres</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_flags', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_flags'>define_flags</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_data_download_flags', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_data_download_flags'>define_data_download_flags</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.main', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.main'>main</a></li><li><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.FLAGS', xid='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.FLAGS'>FLAGS</a></li></ul>
</td><td><pre><span class='lineno'>   1</span> # Copyright 2018 The TensorFlow Authors. All Rights Reserved.
<span class='lineno'>   2</span> #
<span class='lineno'>   3</span> # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
<span class='lineno'>   4</span> # you may not use this file except in compliance with the License.
<span class='lineno'>   5</span> # You may obtain a copy of the License at
<span class='lineno'>   6</span> #
<span class='lineno'>   7</span> #     http://www.apache.org/licenses/LICENSE-2.0
<span class='lineno'>   8</span> #
<span class='lineno'>   9</span> # Unless required by applicable law or agreed to in writing, software
<span class='lineno'>  10</span> # distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
<span class='lineno'>  11</span> # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
<span class='lineno'>  12</span> # See the License for the specific language governing permissions and
<span class='lineno'>  13</span> # limitations under the License.
<span class='lineno'>  14</span> # ==============================================================================
<span class='lineno'>  15</span> &quot;&quot;&quot;Download and extract the MovieLens dataset from GroupLens website.
<span class='lineno'>  16</span> 
<span class='lineno'>  17</span> Download the dataset, and perform basic preprocessing.
<span class='lineno'>  18</span> &quot;&quot;&quot;
<span class='lineno'>  19</span> 
<span class='lineno'>  20</span> from __future__ import absolute_import
<span class='lineno'>  21</span> from __future__ import division
<span class='lineno'>  22</span> from __future__ import print_function
<span class='lineno'>  23</span> 
<span class='lineno'>  24</span> import os
<span class='lineno'>  25</span> import sys
<span class='lineno'>  26</span> import tempfile
<span class='lineno'>  27</span> import zipfile
<span class='lineno'>  28</span> 
<span class='lineno'>  29</span> # pylint: disable=g-bad-import-order
<span class='lineno'>  30</span> import numpy as np
<span class='lineno'>  31</span> import pandas as pd
<span class='lineno'>  32</span> import six
<span class='lineno'>  33</span> from six.moves import urllib  # pylint: disable=redefined-builtin
<span class='lineno'>  34</span> from absl import app
<span class='lineno'>  35</span> from absl import flags
<span class='lineno'>  36</span> from absl import logging
<span class='lineno'>  37</span> import tensorflow as tf
<span class='lineno'>  38</span> # pylint: enable=g-bad-import-order
<span class='lineno'>  39</span> 
<span class='lineno'>  40</span> from official.utils.flags import core as flags_core
<span class='lineno'>  41</span> 
<span class='lineno'>  42</span> 
<span class='lineno'>  43</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', title='str'>ML_1M</a> = &quot;ml-1m&quot;
<span class='lineno'>  44</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', title='str'>ML_20M</a> = &quot;ml-20m&quot;
<span class='lineno'>  45</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS', title='[str]'>DATASETS</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', title='str'>ML_1M</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', title='str'>ML_20M</a>]
<span class='lineno'>  46</span> 
<span class='lineno'>  47</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', title='str'>RATINGS_FILE</a> = &quot;ratings.csv&quot;
<span class='lineno'>  48</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', title='str'>MOVIES_FILE</a> = &quot;movies.csv&quot;
<span class='lineno'>  49</span> 
<span class='lineno'>  50</span> # URL to download dataset
<span class='lineno'>  51</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._DATA_URL', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._DATA_URL', title='str'>_DATA_URL</a> = &quot;http://files.grouplens.org/datasets/movielens/&quot;
<span class='lineno'>  52</span> 
<span class='lineno'>  53</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN', title='str'>GENRE_COLUMN</a> = &quot;genres&quot;
<span class='lineno'>  54</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN', title='str'>ITEM_COLUMN</a> = &quot;item_id&quot;  # movies
<span class='lineno'>  55</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN', title='str'>RATING_COLUMN</a> = &quot;rating&quot;
<span class='lineno'>  56</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TIMESTAMP_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TIMESTAMP_COLUMN', title='str'>TIMESTAMP_COLUMN</a> = &quot;timestamp&quot;
<span class='lineno'>  57</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TITLE_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TITLE_COLUMN', title='str'>TITLE_COLUMN</a> = &quot;titles&quot;
<span class='lineno'>  58</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.USER_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.USER_COLUMN', title='str'>USER_COLUMN</a> = &quot;user_id&quot;
<span class='lineno'>  59</span> 
<span class='lineno'>  60</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES', title='[str]'>GENRES</a> = [
<span class='lineno'>  61</span>     &#39;Action&#39;, &#39;Adventure&#39;, &#39;Animation&#39;, &quot;Children&quot;, &#39;Comedy&#39;, &#39;Crime&#39;,
<span class='lineno'>  62</span>     &#39;Documentary&#39;, &#39;Drama&#39;, &#39;Fantasy&#39;, &#39;Film-Noir&#39;, &#39;Horror&#39;, &quot;IMAX&quot;, &#39;Musical&#39;,
<span class='lineno'>  63</span>     &#39;Mystery&#39;, &#39;Romance&#39;, &#39;Sci-Fi&#39;, &#39;Thriller&#39;, &#39;War&#39;, &#39;Western&#39;
<span class='lineno'>  64</span> ]
<span class='lineno'>  65</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.N_GENRE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.N_GENRE', title='int'>N_GENRE</a> = len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES', title='[str]'>GENRES</a>)
<span class='lineno'>  66</span> 
<span class='lineno'>  67</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMNS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMNS', title='[str]'>RATING_COLUMNS</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.USER_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.USER_COLUMN', title='str'>USER_COLUMN</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN', title='str'>ITEM_COLUMN</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN', title='str'>RATING_COLUMN</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TIMESTAMP_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TIMESTAMP_COLUMN', title='str'>TIMESTAMP_COLUMN</a>]
<span class='lineno'>  68</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIE_COLUMNS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIE_COLUMNS', title='[str]'>MOVIE_COLUMNS</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN', title='str'>ITEM_COLUMN</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TITLE_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.TITLE_COLUMN', title='str'>TITLE_COLUMN</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN', title='str'>GENRE_COLUMN</a>]
<span class='lineno'>  69</span> 
<span class='lineno'>  70</span> # Note: Users are indexed [1, k], not [0, k-1]
<span class='lineno'>  71</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_USER_IDS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_USER_IDS', title='dict'>NUM_USER_IDS</a> = {
<span class='lineno'>  72</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', title='str'>ML_1M</a>: 6040,
<span class='lineno'>  73</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', title='str'>ML_20M</a>: 138493,
<span class='lineno'>  74</span> }
<span class='lineno'>  75</span> 
<span class='lineno'>  76</span> # Note: Movies are indexed [1, k], not [0, k-1]
<span class='lineno'>  77</span> # Both the 1m and 20m datasets use the same movie set.
<span class='lineno'>  78</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_ITEM_IDS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_ITEM_IDS', title='int'>NUM_ITEM_IDS</a> = 3952
<span class='lineno'>  79</span> 
<span class='lineno'>  80</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MAX_RATING', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MAX_RATING', title='int'>MAX_RATING</a> = 5
<span class='lineno'>  81</span> 
<span class='lineno'>  82</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_RATINGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.NUM_RATINGS', title='dict'>NUM_RATINGS</a> = {
<span class='lineno'>  83</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', title='str'>ML_1M</a>: 1000209,
<span class='lineno'>  84</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', title='str'>ML_20M</a>: 20000263
<span class='lineno'>  85</span> }
<span class='lineno'>  86</span> 
<span class='lineno'>  87</span> <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASET_TO_NUM_USERS_AND_ITEMS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASET_TO_NUM_USERS_AND_ITEMS', title='dict'>DATASET_TO_NUM_USERS_AND_ITEMS</a> = {<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', title='str'>ML_1M</a>: (6040, 3706), <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', title='str'>ML_20M</a>: (138493, 26744)}
<span class='lineno'>  88</span> 
<span class='lineno'>  89</span> 
<span class='lineno'>  90</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean', title='(str, ?) -> ? / (?, ?) -> ?'>_download_and_clean</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', title='str'>dataset</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_dir', title='?'>data_dir</a>):
<span class='lineno'>  91</span>   &quot;&quot;&quot;Download MovieLens dataset in a standard format.
<span class='lineno'>  92</span> 
<span class='lineno'>  93</span>   This function downloads the specified MovieLens format and coerces it into a
<span class='lineno'>  94</span>   standard format. The only difference between the ml-1m and ml-20m datasets
<span class='lineno'>  95</span>   after this point (other than size, of course) is that the 1m dataset uses
<span class='lineno'>  96</span>   whole number ratings while the 20m dataset allows half integer ratings.
<span class='lineno'>  97</span>   &quot;&quot;&quot;
<span class='lineno'>  98</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', title='str'>dataset</a> not in <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS', title='[str]'>DATASETS</a>:
<span class='lineno'>  99</span>     raise ValueError(&quot;dataset {} is not in {{{}}}&quot;.format(
<span class='lineno'> 100</span>         dataset, &quot;,&quot;.join(DATASETS)))
<span class='lineno'> 101</span> 
<span class='lineno'> 102</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', title='str'>data_subdir</a> = os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_dir', title='?'>data_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', title='str'>dataset</a>)
<span class='lineno'> 103</span> 
<span class='lineno'> 104</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.expected_files', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.expected_files', title='[str]'>expected_files</a> = [&quot;{}.zip&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', title='str'>dataset</a>), <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', title='str'>RATINGS_FILE</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', title='str'>MOVIES_FILE</a>]
<span class='lineno'> 105</span> 
<span class='lineno'> 106</span>   tf.io.gfile.makedirs(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', title='str'>data_subdir</a>)
<span class='lineno'> 107</span>   if set(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.expected_files', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.expected_files', title='[str]'>expected_files</a>).intersection(
<span class='lineno'> 108</span>       tf.io.gfile.listdir(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', title='str'>data_subdir</a>)) == set(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.expected_files', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.expected_files', title='[str]'>expected_files</a>):
<span class='lineno'> 109</span>     logging.info(&quot;Dataset {} has already been downloaded&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', title='str'>dataset</a>))
<span class='lineno'> 110</span>     return
<span class='lineno'> 111</span> 
<span class='lineno'> 112</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.url', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.url', title='str'>url</a> = &quot;{}{}.zip&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._DATA_URL', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._DATA_URL', title='str'>_DATA_URL</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', title='str'>dataset</a>)
<span class='lineno'> 113</span> 
<span class='lineno'> 114</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', title='?'>temp_dir</a> = tempfile.mkdtemp()
<span class='lineno'> 115</span>   try:
<span class='lineno'> 116</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', title='str'>zip_path</a> = os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', title='?'>temp_dir</a>, &quot;{}.zip&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', title='str'>dataset</a>))
<span class='lineno'> 117</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', title='?'>zip_path</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean._', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean._', title='?'>_</a> = urllib.request.urlretrieve(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.url', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.url', title='str'>url</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', title='str'>zip_path</a>)
<span class='lineno'> 118</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.statinfo', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.statinfo', title='[int]'>statinfo</a> = os.stat(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', title='?'>zip_path</a>)
<span class='lineno'> 119</span>     # A new line to clear the carriage return from download progress
<span class='lineno'> 120</span>     # logging.info is not applicable here
<span class='lineno'> 121</span>     print()
<span class='lineno'> 122</span>     logging.info(
<span class='lineno'> 123</span>         &quot;Successfully downloaded {} {} bytes&quot;.format(
<span class='lineno'> 124</span>             <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', title='?'>zip_path</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.statinfo', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.statinfo', title='[int]'>statinfo</a>.st_size))
<span class='lineno'> 125</span> 
<span class='lineno'> 126</span>     zipfile.ZipFile(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.zip_path', title='?'>zip_path</a>, &quot;r&quot;).extractall(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', title='?'>temp_dir</a>)
<span class='lineno'> 127</span> 
<span class='lineno'> 128</span>     if <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.dataset', title='str'>dataset</a> == <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', title='str'>ML_1M</a>:
<span class='lineno'> 129</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset', title='? -> None'>_regularize_1m_dataset</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', title='?'>temp_dir</a>)
<span class='lineno'> 130</span>     else:
<span class='lineno'> 131</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset', title='? -> None'>_regularize_20m_dataset</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', title='?'>temp_dir</a>)
<span class='lineno'> 132</span> 
<span class='lineno'> 133</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', title='?'>fname</a> in tf.io.gfile.listdir(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', title='?'>temp_dir</a>):
<span class='lineno'> 134</span>       if not tf.io.gfile.exists(os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', title='str'>data_subdir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', title='?'>fname</a>)):
<span class='lineno'> 135</span>         tf.io.gfile.copy(os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', title='?'>temp_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', title='?'>fname</a>),
<span class='lineno'> 136</span>                          os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.data_subdir', title='str'>data_subdir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', title='?'>fname</a>))
<span class='lineno'> 137</span>       else:
<span class='lineno'> 138</span>         logging.info(&quot;Skipping copy of {}, as it already exists in the &quot;
<span class='lineno'> 139</span>                      &quot;destination folder.&quot;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.fname', title='?'>fname</a>))
<span class='lineno'> 140</span> 
<span class='lineno'> 141</span>   finally:
<span class='lineno'> 142</span>     tf.io.gfile.rmtree(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean.temp_dir', title='?'>temp_dir</a>)
<span class='lineno'> 143</span> 
<span class='lineno'> 144</span> 
<span class='lineno'> 145</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', title='(?, ?, ?, ?, str) -> None / (str, str, [str], bool, str) -> None'>_transform_csv</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.input_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.input_path', title='str'>input_path</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.output_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.output_path', title='str'>output_path</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.names', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.names', title='[str]'>names</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.skip_first', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.skip_first', title='bool'>skip_first</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.separator', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.separator', title='str'>separator</a>=&quot;,&quot;):
<span class='lineno'> 146</span>   &quot;&quot;&quot;Transform csv to a regularized format.
<span class='lineno'> 147</span> 
<span class='lineno'> 148</span>   Args:
<span class='lineno'> 149</span>     input_path: The path of the raw csv.
<span class='lineno'> 150</span>     output_path: The path of the cleaned csv.
<span class='lineno'> 151</span>     names: The csv column names.
<span class='lineno'> 152</span>     skip_first: Boolean of whether to skip the first line of the raw csv.
<span class='lineno'> 153</span>     separator: Character used to separate fields in the raw csv.
<span class='lineno'> 154</span>   &quot;&quot;&quot;
<span class='lineno'> 155</span>   if six.PY2:
<span class='lineno'> 156</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.names', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.names', title='[?]'>names</a> = [six.ensure_text(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.n', title='str'>n</a>, &quot;utf-8&quot;) for <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.n', title='str'><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.n', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.n', title='str'>n</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.names', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.names', title='[str]'>names</a>]
<span class='lineno'> 157</span> 
<span class='lineno'> 158</span>   with tf.io.gfile.GFile(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.output_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.output_path', title='str'>output_path</a>, &quot;wb&quot;) as <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_out', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_out', title='?'>f_out</a>, \
<span class='lineno'> 159</span>       tf.io.gfile.GFile(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.input_path', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.input_path', title='str'>input_path</a>, &quot;rb&quot;) as <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_in', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_in', title='?'>f_in</a>:
<span class='lineno'> 160</span> 
<span class='lineno'> 161</span>     # Write column names to the csv.
<span class='lineno'> 162</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_out', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_out', title='?'>f_out</a>.write(&quot;,&quot;.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.names', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.names', title='{[?] | [str]}'>names</a>).encode(&quot;utf-8&quot;))
<span class='lineno'> 163</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_out', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_out', title='?'>f_out</a>.write(b&quot;\n&quot;)
<span class='lineno'> 164</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.i', title='?'>i</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.line', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.line', title='?'>line</a> in enumerate(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_in', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_in', title='?'>f_in</a>):
<span class='lineno'> 165</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.i', title='?'>i</a> == 0 and <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.skip_first', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.skip_first', title='bool'>skip_first</a>:
<span class='lineno'> 166</span>         continue  # ignore existing labels in the csv
<span class='lineno'> 167</span> 
<span class='lineno'> 168</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.line', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.line', title='?'>line</a> = six.ensure_text(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.line', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.line', title='?'>line</a>, &quot;utf-8&quot;, errors=&quot;ignore&quot;)
<span class='lineno'> 169</span>       <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.fields', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.fields', title='?'>fields</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.line', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.line', title='?'>line</a>.split(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.separator', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.separator', title='str'>separator</a>)
<span class='lineno'> 170</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.separator', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.separator', title='str'>separator</a> != &quot;,&quot;:
<span class='lineno'> 171</span>         <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.fields', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.fields', title='[str]'>fields</a> = [&#39;&quot;{}&quot;&#39;.format(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', title='?'>field</a>) if &quot;,&quot; in <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', title='?'>field</a> else <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', title='?'>field</a>
<span class='lineno'> 172</span>                   for <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', title='?'><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.field', title='?'>field</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.fields', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.fields', title='?'>fields</a>]
<span class='lineno'> 173</span>       <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_out', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.f_out', title='?'>f_out</a>.write(&quot;,&quot;.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.fields', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv.fields', title='[str]'>fields</a>).encode(&quot;utf-8&quot;))
<span class='lineno'> 174</span> 
<span class='lineno'> 175</span> 
<span class='lineno'> 176</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset', title='? -> None'>_regularize_1m_dataset</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.temp_dir', title='?'>temp_dir</a>):
<span class='lineno'> 177</span>   &quot;&quot;&quot;
<span class='lineno'> 178</span>   ratings.dat
<span class='lineno'> 179</span>     The file has no header row, and each line is in the following format:
<span class='lineno'> 180</span>     UserID::MovieID::Rating::Timestamp
<span class='lineno'> 181</span>       - UserIDs range from 1 and 6040
<span class='lineno'> 182</span>       - MovieIDs range from 1 and 3952
<span class='lineno'> 183</span>       - Ratings are made on a 5-star scale (whole-star ratings only)
<span class='lineno'> 184</span>       - Timestamp is represented in seconds since midnight Coordinated Universal
<span class='lineno'> 185</span>         Time (UTC) of January 1, 1970.
<span class='lineno'> 186</span>       - Each user has at least 20 ratings
<span class='lineno'> 187</span> 
<span class='lineno'> 188</span>   movies.dat
<span class='lineno'> 189</span>     Each line has the following format:
<span class='lineno'> 190</span>     MovieID::Title::Genres
<span class='lineno'> 191</span>       - MovieIDs range from 1 and 3952
<span class='lineno'> 192</span>   &quot;&quot;&quot;
<span class='lineno'> 193</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.working_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.working_dir', title='str'>working_dir</a> = os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.temp_dir', title='?'>temp_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_1M', title='str'>ML_1M</a>)
<span class='lineno'> 194</span> 
<span class='lineno'> 195</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', title='(?, ?, ?, ?, str) -> None / (str, str, [str], bool, str) -> None'>_transform_csv</a>(
<span class='lineno'> 196</span>       input_path=os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.working_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.working_dir', title='str'>working_dir</a>, &quot;ratings.dat&quot;),
<span class='lineno'> 197</span>       output_path=os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.temp_dir', title='?'>temp_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', title='str'>RATINGS_FILE</a>),
<span class='lineno'> 198</span>       names=<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMNS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMNS', title='[str]'>RATING_COLUMNS</a>, skip_first=False, separator=&quot;::&quot;)
<span class='lineno'> 199</span> 
<span class='lineno'> 200</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', title='(?, ?, ?, ?, str) -> None / (str, str, [str], bool, str) -> None'>_transform_csv</a>(
<span class='lineno'> 201</span>       input_path=os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.working_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.working_dir', title='str'>working_dir</a>, &quot;movies.dat&quot;),
<span class='lineno'> 202</span>       output_path=os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.temp_dir', title='?'>temp_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', title='str'>MOVIES_FILE</a>),
<span class='lineno'> 203</span>       names=<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIE_COLUMNS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIE_COLUMNS', title='[str]'>MOVIE_COLUMNS</a>, skip_first=False, separator=&quot;::&quot;)
<span class='lineno'> 204</span> 
<span class='lineno'> 205</span>   tf.io.gfile.rmtree(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.working_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_1m_dataset.working_dir', title='str'>working_dir</a>)
<span class='lineno'> 206</span> 
<span class='lineno'> 207</span> 
<span class='lineno'> 208</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset', title='? -> None'>_regularize_20m_dataset</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.temp_dir', title='?'>temp_dir</a>):
<span class='lineno'> 209</span>   &quot;&quot;&quot;
<span class='lineno'> 210</span>   ratings.csv
<span class='lineno'> 211</span>     Each line of this file after the header row represents one rating of one
<span class='lineno'> 212</span>     movie by one user, and has the following format:
<span class='lineno'> 213</span>     userId,movieId,rating,timestamp
<span class='lineno'> 214</span>     - The lines within this file are ordered first by userId, then, within user,
<span class='lineno'> 215</span>       by movieId.
<span class='lineno'> 216</span>     - Ratings are made on a 5-star scale, with half-star increments
<span class='lineno'> 217</span>       (0.5 stars - 5.0 stars).
<span class='lineno'> 218</span>     - Timestamps represent seconds since midnight Coordinated Universal Time
<span class='lineno'> 219</span>       (UTC) of January 1, 1970.
<span class='lineno'> 220</span>     - All the users had rated at least 20 movies.
<span class='lineno'> 221</span> 
<span class='lineno'> 222</span>   movies.csv
<span class='lineno'> 223</span>     Each line has the following format:
<span class='lineno'> 224</span>     MovieID,Title,Genres
<span class='lineno'> 225</span>       - MovieIDs range from 1 and 3952
<span class='lineno'> 226</span>   &quot;&quot;&quot;
<span class='lineno'> 227</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.working_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.working_dir', title='str'>working_dir</a> = os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.temp_dir', title='?'>temp_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ML_20M', title='str'>ML_20M</a>)
<span class='lineno'> 228</span> 
<span class='lineno'> 229</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', title='(?, ?, ?, ?, str) -> None / (str, str, [str], bool, str) -> None'>_transform_csv</a>(
<span class='lineno'> 230</span>       input_path=os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.working_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.working_dir', title='str'>working_dir</a>, &quot;ratings.csv&quot;),
<span class='lineno'> 231</span>       output_path=os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.temp_dir', title='?'>temp_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', title='str'>RATINGS_FILE</a>),
<span class='lineno'> 232</span>       names=<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMNS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMNS', title='[str]'>RATING_COLUMNS</a>, skip_first=True, separator=&quot;,&quot;)
<span class='lineno'> 233</span> 
<span class='lineno'> 234</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._transform_csv', title='(?, ?, ?, ?, str) -> None / (str, str, [str], bool, str) -> None'>_transform_csv</a>(
<span class='lineno'> 235</span>       input_path=os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.working_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.working_dir', title='str'>working_dir</a>, &quot;movies.csv&quot;),
<span class='lineno'> 236</span>       output_path=os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.temp_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.temp_dir', title='?'>temp_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', title='str'>MOVIES_FILE</a>),
<span class='lineno'> 237</span>       names=<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIE_COLUMNS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIE_COLUMNS', title='[str]'>MOVIE_COLUMNS</a>, skip_first=True, separator=&quot;,&quot;)
<span class='lineno'> 238</span> 
<span class='lineno'> 239</span>   tf.io.gfile.rmtree(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.working_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._regularize_20m_dataset.working_dir', title='str'>working_dir</a>)
<span class='lineno'> 240</span> 
<span class='lineno'> 241</span> 
<span class='lineno'> 242</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download', title='(?, ?) -> None'>download</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.dataset', title='?'>dataset</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.data_dir', title='?'>data_dir</a>):
<span class='lineno'> 243</span>   if <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.dataset', title='?'>dataset</a>:
<span class='lineno'> 244</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean', title='(str, ?) -> ? / (?, ?) -> ?'>_download_and_clean</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.dataset', title='?'>dataset</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.data_dir', title='?'>data_dir</a>)
<span class='lineno'> 245</span>   else:
<span class='lineno'> 246</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download._', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download._', title='[?]'>_</a> = [<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens._download_and_clean', title='(str, ?) -> ? / (?, ?) -> ?'>_download_and_clean</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.d', title='str'>d</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.data_dir', title='?'>data_dir</a>) for <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.d', title='str'><a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.d', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download.d', title='str'>d</a></a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS', title='[str]'>DATASETS</a>]
<span class='lineno'> 247</span> 
<span class='lineno'> 248</span> 
<span class='lineno'> 249</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe', title='(?, ?) -> ?'>ratings_csv_to_dataframe</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.data_dir', title='?'>data_dir</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.dataset', title='?'>dataset</a>):
<span class='lineno'> 250</span>   with tf.io.gfile.GFile(os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.data_dir', title='?'>data_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.dataset', title='?'>dataset</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATINGS_FILE', title='str'>RATINGS_FILE</a>)) as <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.f', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.f', title='?'>f</a>:
<span class='lineno'> 251</span>     return pd.read_csv(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.f', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe.f', title='?'>f</a>, encoding=&quot;utf-8&quot;)
<span class='lineno'> 252</span> 
<span class='lineno'> 253</span> 
<span class='lineno'> 254</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe', title='(?, ?) -> None'>csv_to_joint_dataframe</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.data_dir', title='?'>data_dir</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.dataset', title='?'>dataset</a>):
<span class='lineno'> 255</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.ratings', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.ratings', title='?'>ratings</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ratings_csv_to_dataframe', title='(?, ?) -> ?'>ratings_csv_to_dataframe</a>(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.data_dir', title='?'>data_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.dataset', title='?'>dataset</a>)
<span class='lineno'> 256</span> 
<span class='lineno'> 257</span>   with tf.io.gfile.GFile(os.path.join(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.data_dir', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.data_dir', title='?'>data_dir</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.dataset', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.dataset', title='?'>dataset</a>, <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.MOVIES_FILE', title='str'>MOVIES_FILE</a>)) as <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.f', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.f', title='?'>f</a>:
<span class='lineno'> 258</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.movies', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.movies', title='?'>movies</a> = pd.read_csv(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.f', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.f', title='?'>f</a>, encoding=&quot;utf-8&quot;)
<span class='lineno'> 259</span> 
<span class='lineno'> 260</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.df', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.df', title='?'>df</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.ratings', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.ratings', title='?'>ratings</a>.merge(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.movies', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.movies', title='?'>movies</a>, on=<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.ITEM_COLUMN', title='str'>ITEM_COLUMN</a>)
<span class='lineno'> 261</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.df', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.df', title='?'>df</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN', title='str'>RATING_COLUMN</a>] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.df', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.df', title='?'>df</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.RATING_COLUMN', title='str'>RATING_COLUMN</a>].astype(np.float32)
<span class='lineno'> 262</span> 
<span class='lineno'> 263</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.df', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.csv_to_joint_dataframe.df', title='?'>df</a>
<span class='lineno'> 264</span> 
<span class='lineno'> 265</span> 
<span class='lineno'> 266</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres', title='? -> None'>integerize_genres</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres.dataframe', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres.dataframe', title='?'>dataframe</a>):
<span class='lineno'> 267</span>   &quot;&quot;&quot;Replace genre string with a binary vector.
<span class='lineno'> 268</span> 
<span class='lineno'> 269</span>   Args:
<span class='lineno'> 270</span>     dataframe: a pandas dataframe of movie data.
<span class='lineno'> 271</span> 
<span class='lineno'> 272</span>   Returns:
<span class='lineno'> 273</span>     The transformed dataframe.
<span class='lineno'> 274</span>   &quot;&quot;&quot;
<span class='lineno'> 275</span>   def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn', title='? -> None'>_map_fn</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.entry', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.entry', title='?'>entry</a>):
<span class='lineno'> 276</span>     <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.entry', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.entry', title='?'>entry</a>.replace(&quot;Children&#39;s&quot;, &quot;Children&quot;)  # naming difference.
<span class='lineno'> 277</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.movie_genres', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.movie_genres', title='?'>movie_genres</a> = <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.entry', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.entry', title='?'>entry</a>.split(&quot;|&quot;)
<span class='lineno'> 278</span>     <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.output', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.output', title='?'>output</a> = np.zeros((len(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES', title='[str]'>GENRES</a>),), dtype=np.int64)
<span class='lineno'> 279</span>     for <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.i', title='?'>i</a>, <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.genre', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.genre', title='?'>genre</a> in enumerate(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRES', title='[str]'>GENRES</a>):
<span class='lineno'> 280</span>       if <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.genre', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.genre', title='?'>genre</a> in <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.movie_genres', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.movie_genres', title='?'>movie_genres</a>:
<span class='lineno'> 281</span>         <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.output', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.output', title='?'>output</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.i', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.i', title='?'>i</a>] = 1
<span class='lineno'> 282</span>     return <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.output', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn.output', title='?'>output</a>
<span class='lineno'> 283</span> 
<span class='lineno'> 284</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres.dataframe', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres.dataframe', title='?'>dataframe</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN', title='str'>GENRE_COLUMN</a>] = <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres.dataframe', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres.dataframe', title='?'>dataframe</a>[<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.GENRE_COLUMN', title='str'>GENRE_COLUMN</a>].apply(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres._map_fn', title='? -> None'>_map_fn</a>)
<span class='lineno'> 285</span> 
<span class='lineno'> 286</span>   return <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres.dataframe', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.integerize_genres.dataframe', title='?'>dataframe</a>
<span class='lineno'> 287</span> 
<span class='lineno'> 288</span> 
<span class='lineno'> 289</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_flags', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_flags', title='() -> None'>define_flags</a>():
<span class='lineno'> 290</span>   &quot;&quot;&quot;Add flags specifying data usage arguments.&quot;&quot;&quot;
<span class='lineno'> 291</span>   flags.DEFINE_enum(
<span class='lineno'> 292</span>       name=&quot;dataset&quot;,
<span class='lineno'> 293</span>       default=None,
<span class='lineno'> 294</span>       enum_values=<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.DATASETS', title='[str]'>DATASETS</a>,
<span class='lineno'> 295</span>       case_sensitive=False,
<span class='lineno'> 296</span>       help=flags_core.help_wrap(&quot;Dataset to be trained and evaluated.&quot;))
<span class='lineno'> 297</span> 
<span class='lineno'> 298</span> 
<span class='lineno'> 299</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_data_download_flags', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_data_download_flags', title='() -> None'>define_data_download_flags</a>():
<span class='lineno'> 300</span>   &quot;&quot;&quot;Add flags specifying data download and usage arguments.&quot;&quot;&quot;
<span class='lineno'> 301</span>   flags.DEFINE_string(
<span class='lineno'> 302</span>       name=&quot;data_dir&quot;, default=&quot;/tmp/movielens-data/&quot;,
<span class='lineno'> 303</span>       help=flags_core.help_wrap(
<span class='lineno'> 304</span>           &quot;Directory to download and extract data.&quot;))
<span class='lineno'> 305</span> 
<span class='lineno'> 306</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_flags', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_flags', title='() -> None'>define_flags</a>()
<span class='lineno'> 307</span> 
<span class='lineno'> 308</span> 
<span class='lineno'> 309</span> def <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.main', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.main', title='? -> None'>main</a>(<a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.main._', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.main._', title='?'>_</a>):
<span class='lineno'> 310</span>   &quot;&quot;&quot;Download and extract the data from GroupLens website.&quot;&quot;&quot;
<span class='lineno'> 311</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.download', title='(?, ?) -> None'>download</a>(flags.FLAGS.dataset, flags.FLAGS.data_dir)
<span class='lineno'> 312</span> 
<span class='lineno'> 313</span> 
<span class='lineno'> 314</span> if __name__ == &quot;__main__&quot;:
<span class='lineno'> 315</span>   <a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_data_download_flags', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.define_data_download_flags', title='() -> None'>define_data_download_flags</a>()
<span class='lineno'> 316</span>   <a name='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.FLAGS', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.FLAGS', title='?'>FLAGS</a> = flags.FLAGS
<span class='lineno'> 317</span>   app.run(<a href='#.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.main', xid ='.home.xxm.Desktop.EMSE.dataset.models.official.recommendation.movielens.main', title='? -> None'>main</a>)
</pre></td></tr></table></body></html>